/home/user/anaconda3/envs/engdesign/bin/python /home/user/lib/Capstone_2025/train_clam.py 
/home/user/anaconda3/envs/engdesign/lib/python3.13/site-packages/torch/cuda/__init__.py:129: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 804: forward compatibility was attempted on non supported HW (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() > 0
Preparing data...

Training on 2170 samples

Validation on 264 samples

Test on 264 samples


Preparing model...

Setting tau to 1.0
Setting tau to 1.0
Setting tau to 1.0
Setting tau to 1.0
Done

Setting optimizer...
Done

Training for coarse level...

batch 99, loss: 0.2936, instance_loss: 0.4970, weighted_loss: 0.3547, label: 2, bag_size: 330

batch 199, loss: 0.3573, instance_loss: 0.3454, weighted_loss: 0.3537, label: 2, bag_size: 541

batch 299, loss: 0.2060, instance_loss: 0.2150, weighted_loss: 0.2087, label: 1, bag_size: 831

batch 399, loss: 0.5674, instance_loss: 0.5655, weighted_loss: 0.5668, label: 2, bag_size: 311

batch 499, loss: 0.7503, instance_loss: 0.5232, weighted_loss: 0.6822, label: 1, bag_size: 149

batch 599, loss: 0.7294, instance_loss: 0.2279, weighted_loss: 0.5790, label: 2, bag_size: 345

batch 699, loss: 0.0424, instance_loss: 0.0428, weighted_loss: 0.0426, label: 2, bag_size: 651

batch 799, loss: 0.3016, instance_loss: 0.1322, weighted_loss: 0.2508, label: 2, bag_size: 861

batch 899, loss: 1.2916, instance_loss: 0.5325, weighted_loss: 1.0639, label: 1, bag_size: 433

batch 999, loss: 1.6973, instance_loss: 0.8227, weighted_loss: 1.4349, label: 3, bag_size: 278

batch 1099, loss: 0.0636, instance_loss: 0.0485, weighted_loss: 0.0591, label: 2, bag_size: 246

batch 1199, loss: 1.4133, instance_loss: 0.8202, weighted_loss: 1.2354, label: 1, bag_size: 347

batch 1299, loss: 1.1064, instance_loss: 1.0003, weighted_loss: 1.0745, label: 2, bag_size: 658

batch 1399, loss: 0.1465, instance_loss: 0.2339, weighted_loss: 0.1727, label: 2, bag_size: 1048

batch 1499, loss: 0.6501, instance_loss: 0.3430, weighted_loss: 0.5579, label: 2, bag_size: 850

batch 1599, loss: 1.2783, instance_loss: 0.6401, weighted_loss: 1.0869, label: 1, bag_size: 308

batch 1699, loss: 0.0946, instance_loss: 0.1363, weighted_loss: 0.1071, label: 2, bag_size: 293

batch 1799, loss: 0.0630, instance_loss: 0.0812, weighted_loss: 0.0685, label: 1, bag_size: 490

batch 1899, loss: 0.2168, instance_loss: 0.1882, weighted_loss: 0.2082, label: 1, bag_size: 1172

batch 1999, loss: 0.6549, instance_loss: 0.4560, weighted_loss: 0.5952, label: 2, bag_size: 449

batch 2099, loss: 1.4785, instance_loss: 0.6849, weighted_loss: 1.2404, label: 1, bag_size: 622

Instance Classifier Stats

class 0 clustering acc 0.9824164746543779: correct 68219/69440

class 1 clustering acc 0.3504032258064516: correct 6083/17360


Epoch: 0, train_loss: 0.8635, train_clustering_loss:  0.4386

class 0: acc 0.0, correct 0/44

class 1: acc 0.5613810741687979, correct 439/782

class 2: acc 0.8482060717571297, correct 922/1087

class 3: acc 0.08171206225680934, correct 21/257


Val Set, val_loss: 0.7773, auc: 0.7808

class 0 clustering acc 0.9846117424242424: correct 8318/8448

class 1 clustering acc 0.3934659090909091: correct 831/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6041666666666666, correct 58/96

class 2: acc 0.8208955223880597, correct 110/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.6591

Overall F1 Score: 0.4113

Training for coarse level...

batch 99, loss: 0.0169, instance_loss: 0.0244, weighted_loss: 0.0191, label: 2, bag_size: 488

batch 199, loss: 0.7716, instance_loss: 0.4138, weighted_loss: 0.6643, label: 2, bag_size: 654

batch 299, loss: 1.7447, instance_loss: 0.9605, weighted_loss: 1.5094, label: 0, bag_size: 1736

batch 399, loss: 0.2269, instance_loss: 0.4028, weighted_loss: 0.2797, label: 2, bag_size: 1586

batch 499, loss: 0.4929, instance_loss: 0.2263, weighted_loss: 0.4129, label: 1, bag_size: 1293

batch 599, loss: 0.5331, instance_loss: 0.3388, weighted_loss: 0.4748, label: 2, bag_size: 436

batch 699, loss: 0.9437, instance_loss: 0.5015, weighted_loss: 0.8110, label: 3, bag_size: 239

batch 799, loss: 0.6517, instance_loss: 0.3349, weighted_loss: 0.5567, label: 2, bag_size: 756

batch 899, loss: 0.3719, instance_loss: 0.3408, weighted_loss: 0.3626, label: 1, bag_size: 1256

batch 999, loss: 1.1941, instance_loss: 0.7276, weighted_loss: 1.0542, label: 1, bag_size: 415

batch 1099, loss: 0.0901, instance_loss: 0.0601, weighted_loss: 0.0811, label: 2, bag_size: 874

batch 1199, loss: 0.8997, instance_loss: 0.4238, weighted_loss: 0.7570, label: 2, bag_size: 347

batch 1299, loss: 0.8906, instance_loss: 0.5267, weighted_loss: 0.7814, label: 1, bag_size: 762

batch 1399, loss: 1.1791, instance_loss: 0.6856, weighted_loss: 1.0310, label: 1, bag_size: 187

batch 1499, loss: 0.1175, instance_loss: 0.0461, weighted_loss: 0.0961, label: 1, bag_size: 2239

batch 1599, loss: 0.0434, instance_loss: 0.0532, weighted_loss: 0.0464, label: 2, bag_size: 1064

batch 1699, loss: 0.0200, instance_loss: 0.0170, weighted_loss: 0.0191, label: 2, bag_size: 448

batch 1799, loss: 1.0686, instance_loss: 0.5429, weighted_loss: 0.9109, label: 2, bag_size: 225

batch 1899, loss: 1.6542, instance_loss: 0.7796, weighted_loss: 1.3919, label: 3, bag_size: 581

batch 1999, loss: 0.3921, instance_loss: 0.1792, weighted_loss: 0.3282, label: 1, bag_size: 1860

batch 2099, loss: 1.2327, instance_loss: 0.5864, weighted_loss: 1.0388, label: 1, bag_size: 298

Instance Classifier Stats

class 0 clustering acc 0.9827044930875576: correct 68239/69440

class 1 clustering acc 0.4024769585253456: correct 6987/17360


Epoch: 1, train_loss: 0.7921, train_clustering_loss:  0.4042

class 0: acc 0.0, correct 0/44

class 1: acc 0.5869565217391305, correct 459/782

class 2: acc 0.8702851885924563, correct 946/1087

class 3: acc 0.07782101167315175, correct 20/257


Val Set, val_loss: 0.7793, auc: 0.7749

class 0 clustering acc 0.978811553030303: correct 8269/8448

class 1 clustering acc 0.4408143939393939: correct 931/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.5520833333333334, correct 53/96

class 2: acc 0.8507462686567164, correct 114/134

class 3: acc 0.4666666666666667, correct 14/30

Overall Accuracy: 0.6856

Overall F1 Score: 0.4685

Training for coarse level...

batch 99, loss: 0.1547, instance_loss: 0.1292, weighted_loss: 0.1471, label: 1, bag_size: 567

batch 199, loss: 0.8849, instance_loss: 0.4837, weighted_loss: 0.7645, label: 2, bag_size: 317

batch 299, loss: 1.0793, instance_loss: 0.6282, weighted_loss: 0.9440, label: 1, bag_size: 381

batch 399, loss: 0.1090, instance_loss: 0.0871, weighted_loss: 0.1024, label: 1, bag_size: 981

batch 499, loss: 1.2991, instance_loss: 0.4578, weighted_loss: 1.0467, label: 1, bag_size: 389

batch 599, loss: 1.4161, instance_loss: 0.9669, weighted_loss: 1.2813, label: 3, bag_size: 829

batch 699, loss: 0.0625, instance_loss: 0.0574, weighted_loss: 0.0610, label: 2, bag_size: 217

batch 799, loss: 1.0872, instance_loss: 0.6868, weighted_loss: 0.9671, label: 1, bag_size: 365

batch 899, loss: 1.6193, instance_loss: 0.6531, weighted_loss: 1.3294, label: 1, bag_size: 851

batch 999, loss: 0.0892, instance_loss: 0.0474, weighted_loss: 0.0767, label: 2, bag_size: 353

batch 1099, loss: 0.6276, instance_loss: 0.3432, weighted_loss: 0.5423, label: 2, bag_size: 129

batch 1199, loss: 0.2660, instance_loss: 0.1276, weighted_loss: 0.2245, label: 2, bag_size: 449

batch 1299, loss: 0.2254, instance_loss: 0.1428, weighted_loss: 0.2006, label: 1, bag_size: 2056

batch 1399, loss: 1.0427, instance_loss: 0.4378, weighted_loss: 0.8612, label: 2, bag_size: 847

batch 1499, loss: 0.7255, instance_loss: 0.6413, weighted_loss: 0.7003, label: 1, bag_size: 354

batch 1599, loss: 0.4492, instance_loss: 0.2834, weighted_loss: 0.3995, label: 1, bag_size: 725

batch 1699, loss: 0.0660, instance_loss: 0.0559, weighted_loss: 0.0629, label: 2, bag_size: 364

batch 1799, loss: 2.2760, instance_loss: 0.9237, weighted_loss: 1.8703, label: 2, bag_size: 506

batch 1899, loss: 0.0856, instance_loss: 0.0298, weighted_loss: 0.0688, label: 1, bag_size: 1867

batch 1999, loss: 0.5768, instance_loss: 0.4111, weighted_loss: 0.5271, label: 2, bag_size: 350

batch 2099, loss: 5.2105, instance_loss: 1.4096, weighted_loss: 4.0702, label: 0, bag_size: 1452

Instance Classifier Stats

class 0 clustering acc 0.9829925115207373: correct 68259/69440

class 1 clustering acc 0.41503456221198154: correct 7205/17360


Epoch: 2, train_loss: 0.7643, train_clustering_loss:  0.3962

class 0: acc 0.11363636363636363, correct 5/44

class 1: acc 0.6048593350383632, correct 473/782

class 2: acc 0.8666053357865685, correct 942/1087

class 3: acc 0.17120622568093385, correct 44/257


Val Set, val_loss: 0.7717, auc: 0.7787

class 0 clustering acc 0.9814157196969697: correct 8291/8448

class 1 clustering acc 0.42803030303030304: correct 904/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.59375, correct 57/96

class 2: acc 0.8955223880597015, correct 120/134

class 3: acc 0.13333333333333333, correct 4/30

Overall Accuracy: 0.6856

Overall F1 Score: 0.4140

Training for coarse level...

batch 99, loss: 0.0035, instance_loss: 0.0065, weighted_loss: 0.0044, label: 1, bag_size: 260

batch 199, loss: 1.5817, instance_loss: 0.7469, weighted_loss: 1.3313, label: 0, bag_size: 37

batch 299, loss: 0.0581, instance_loss: 0.0483, weighted_loss: 0.0551, label: 1, bag_size: 1767

batch 399, loss: 0.0110, instance_loss: 0.0238, weighted_loss: 0.0148, label: 2, bag_size: 743

batch 499, loss: 1.6106, instance_loss: 0.6331, weighted_loss: 1.3174, label: 3, bag_size: 249

batch 599, loss: 0.5928, instance_loss: 0.4237, weighted_loss: 0.5421, label: 1, bag_size: 1114

batch 699, loss: 2.5061, instance_loss: 0.9346, weighted_loss: 2.0346, label: 0, bag_size: 207

batch 799, loss: 0.1081, instance_loss: 0.1253, weighted_loss: 0.1133, label: 1, bag_size: 1522

batch 899, loss: 1.1539, instance_loss: 0.6139, weighted_loss: 0.9919, label: 1, bag_size: 792

batch 999, loss: 0.2584, instance_loss: 0.0956, weighted_loss: 0.2095, label: 2, bag_size: 661

batch 1099, loss: 0.1971, instance_loss: 0.1158, weighted_loss: 0.1727, label: 2, bag_size: 1364

batch 1199, loss: 0.2905, instance_loss: 0.2787, weighted_loss: 0.2870, label: 2, bag_size: 249

batch 1299, loss: 0.0203, instance_loss: 0.0449, weighted_loss: 0.0277, label: 1, bag_size: 826

batch 1399, loss: 0.0169, instance_loss: 0.0180, weighted_loss: 0.0172, label: 2, bag_size: 667

batch 1499, loss: 0.0036, instance_loss: 0.0071, weighted_loss: 0.0046, label: 2, bag_size: 686

batch 1599, loss: 0.1326, instance_loss: 0.0288, weighted_loss: 0.1015, label: 1, bag_size: 1867

batch 1699, loss: 0.0139, instance_loss: 0.0297, weighted_loss: 0.0187, label: 2, bag_size: 956

batch 1799, loss: 0.9747, instance_loss: 0.5452, weighted_loss: 0.8459, label: 2, bag_size: 125

batch 1899, loss: 2.3138, instance_loss: 1.0878, weighted_loss: 1.9460, label: 1, bag_size: 360

batch 1999, loss: 0.8548, instance_loss: 0.5136, weighted_loss: 0.7525, label: 2, bag_size: 235

batch 2099, loss: 1.2012, instance_loss: 0.5902, weighted_loss: 1.0179, label: 2, bag_size: 1149

Instance Classifier Stats

class 0 clustering acc 0.9836981566820276: correct 68308/69440

class 1 clustering acc 0.4346774193548387: correct 7546/17360


Epoch: 3, train_loss: 0.7265, train_clustering_loss:  0.3839

class 0: acc 0.1590909090909091, correct 7/44

class 1: acc 0.6278772378516624, correct 491/782

class 2: acc 0.8739650413983441, correct 950/1087

class 3: acc 0.16731517509727625, correct 43/257


Val Set, val_loss: 0.9195, auc: 0.7818

class 0 clustering acc 0.9773910984848485: correct 8257/8448

class 1 clustering acc 0.3721590909090909: correct 786/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.96875, correct 93/96

class 2: acc 0.4552238805970149, correct 61/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.6061

Overall F1 Score: 0.3911

Training for coarse level...

batch 99, loss: 1.0394, instance_loss: 0.6966, weighted_loss: 0.9366, label: 1, bag_size: 517

batch 199, loss: 0.9769, instance_loss: 0.3880, weighted_loss: 0.8003, label: 2, bag_size: 1422

batch 299, loss: 0.0399, instance_loss: 0.0699, weighted_loss: 0.0489, label: 2, bag_size: 835

batch 399, loss: 0.7536, instance_loss: 0.3374, weighted_loss: 0.6288, label: 2, bag_size: 1004

batch 499, loss: 0.0569, instance_loss: 0.0380, weighted_loss: 0.0512, label: 1, bag_size: 2186

batch 599, loss: 0.0285, instance_loss: 0.0885, weighted_loss: 0.0465, label: 2, bag_size: 517

batch 699, loss: 0.1065, instance_loss: 0.2941, weighted_loss: 0.1628, label: 1, bag_size: 177

batch 799, loss: 2.6364, instance_loss: 1.5978, weighted_loss: 2.3248, label: 1, bag_size: 234

batch 899, loss: 0.0500, instance_loss: 0.0896, weighted_loss: 0.0619, label: 1, bag_size: 1087

batch 999, loss: 4.0812, instance_loss: 2.4800, weighted_loss: 3.6008, label: 3, bag_size: 1875

batch 1099, loss: 0.0116, instance_loss: 0.0166, weighted_loss: 0.0131, label: 2, bag_size: 342

batch 1199, loss: 0.5323, instance_loss: 0.3235, weighted_loss: 0.4697, label: 2, bag_size: 565

batch 1299, loss: 0.4866, instance_loss: 0.2885, weighted_loss: 0.4272, label: 2, bag_size: 344

batch 1399, loss: 0.9141, instance_loss: 0.4255, weighted_loss: 0.7675, label: 2, bag_size: 243

batch 1499, loss: 1.6412, instance_loss: 0.8017, weighted_loss: 1.3893, label: 1, bag_size: 348

batch 1599, loss: 0.6241, instance_loss: 0.6509, weighted_loss: 0.6321, label: 2, bag_size: 1796

batch 1699, loss: 1.1959, instance_loss: 0.9010, weighted_loss: 1.1075, label: 1, bag_size: 1667

batch 1799, loss: 0.8127, instance_loss: 0.4057, weighted_loss: 0.6906, label: 2, bag_size: 276

batch 1899, loss: 0.5297, instance_loss: 0.2491, weighted_loss: 0.4455, label: 2, bag_size: 770

batch 1999, loss: 0.0289, instance_loss: 0.0660, weighted_loss: 0.0400, label: 2, bag_size: 312

batch 2099, loss: 0.0643, instance_loss: 0.0558, weighted_loss: 0.0617, label: 2, bag_size: 365

Instance Classifier Stats

class 0 clustering acc 0.9829061059907834: correct 68253/69440

class 1 clustering acc 0.4362327188940092: correct 7573/17360


Epoch: 4, train_loss: 0.6879, train_clustering_loss:  0.3812

class 0: acc 0.20454545454545456, correct 9/44

class 1: acc 0.6777493606138107, correct 530/782

class 2: acc 0.8564857405703772, correct 931/1087

class 3: acc 0.29961089494163423, correct 77/257


Val Set, val_loss: 0.7683, auc: 0.8051

class 0 clustering acc 0.982125946969697: correct 8297/8448

class 1 clustering acc 0.39678030303030304: correct 838/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.59375, correct 57/96

class 2: acc 0.8880597014925373, correct 119/134

class 3: acc 0.16666666666666666, correct 5/30

Overall Accuracy: 0.6856

Overall F1 Score: 0.4213

Training for coarse level...

batch 99, loss: 1.6988, instance_loss: 0.7359, weighted_loss: 1.4099, label: 1, bag_size: 696

batch 199, loss: 0.0015, instance_loss: 0.0175, weighted_loss: 0.0063, label: 2, bag_size: 463

batch 299, loss: 0.5632, instance_loss: 0.5509, weighted_loss: 0.5595, label: 3, bag_size: 149

batch 399, loss: 0.2108, instance_loss: 0.1079, weighted_loss: 0.1799, label: 2, bag_size: 461

batch 499, loss: 0.1264, instance_loss: 0.1223, weighted_loss: 0.1252, label: 1, bag_size: 988

batch 599, loss: 0.1042, instance_loss: 0.0856, weighted_loss: 0.0987, label: 2, bag_size: 795

batch 699, loss: 0.0096, instance_loss: 0.0551, weighted_loss: 0.0233, label: 1, bag_size: 700

batch 799, loss: 0.7139, instance_loss: 0.4488, weighted_loss: 0.6344, label: 2, bag_size: 232

batch 899, loss: 1.1653, instance_loss: 0.4153, weighted_loss: 0.9403, label: 2, bag_size: 367

batch 999, loss: 1.7448, instance_loss: 0.9208, weighted_loss: 1.4976, label: 3, bag_size: 490

batch 1099, loss: 1.1662, instance_loss: 0.7316, weighted_loss: 1.0358, label: 1, bag_size: 262

batch 1199, loss: 0.5928, instance_loss: 0.3503, weighted_loss: 0.5200, label: 2, bag_size: 302

batch 1299, loss: 0.3415, instance_loss: 0.5843, weighted_loss: 0.4144, label: 3, bag_size: 1274

batch 1399, loss: 0.6408, instance_loss: 0.4600, weighted_loss: 0.5866, label: 2, bag_size: 310

batch 1499, loss: 0.1232, instance_loss: 0.0913, weighted_loss: 0.1136, label: 2, bag_size: 1110

batch 1599, loss: 1.0337, instance_loss: 0.8664, weighted_loss: 0.9835, label: 0, bag_size: 482

batch 1699, loss: 0.0450, instance_loss: 0.0161, weighted_loss: 0.0363, label: 1, bag_size: 3332

batch 1799, loss: 1.5137, instance_loss: 0.5923, weighted_loss: 1.2373, label: 2, bag_size: 853

batch 1899, loss: 0.0084, instance_loss: 0.0124, weighted_loss: 0.0096, label: 2, bag_size: 318

batch 1999, loss: 0.0167, instance_loss: 0.0476, weighted_loss: 0.0260, label: 2, bag_size: 632

batch 2099, loss: 0.2712, instance_loss: 0.1460, weighted_loss: 0.2337, label: 2, bag_size: 380

Instance Classifier Stats

class 0 clustering acc 0.9838133640552995: correct 68316/69440

class 1 clustering acc 0.4505184331797235: correct 7821/17360


Epoch: 5, train_loss: 0.6360, train_clustering_loss:  0.3691

class 0: acc 0.3181818181818182, correct 14/44

class 1: acc 0.670076726342711, correct 524/782

class 2: acc 0.8684452621895125, correct 944/1087

class 3: acc 0.35019455252918286, correct 90/257


Val Set, val_loss: 0.8776, auc: 0.7817

class 0 clustering acc 0.9756155303030303: correct 8242/8448

class 1 clustering acc 0.44886363636363635: correct 948/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.7083333333333334, correct 68/96

class 2: acc 0.7238805970149254, correct 97/134

class 3: acc 0.23333333333333334, correct 7/30

Overall Accuracy: 0.6515

Overall F1 Score: 0.4208

Training for coarse level...

batch 99, loss: 0.0684, instance_loss: 0.1302, weighted_loss: 0.0870, label: 1, bag_size: 1667

batch 199, loss: 0.4101, instance_loss: 0.3147, weighted_loss: 0.3815, label: 2, bag_size: 472

batch 299, loss: 3.4111, instance_loss: 1.4563, weighted_loss: 2.8247, label: 1, bag_size: 657

batch 399, loss: 0.2102, instance_loss: 0.1629, weighted_loss: 0.1960, label: 2, bag_size: 954

batch 499, loss: 0.0398, instance_loss: 0.0425, weighted_loss: 0.0406, label: 2, bag_size: 265

batch 599, loss: 0.0431, instance_loss: 0.1066, weighted_loss: 0.0621, label: 1, bag_size: 633

batch 699, loss: 0.0261, instance_loss: 0.0475, weighted_loss: 0.0325, label: 2, bag_size: 502

batch 799, loss: 0.0020, instance_loss: 0.0204, weighted_loss: 0.0075, label: 2, bag_size: 304

batch 899, loss: 0.1557, instance_loss: 0.5663, weighted_loss: 0.2789, label: 3, bag_size: 105

batch 999, loss: 0.1754, instance_loss: 0.1768, weighted_loss: 0.1758, label: 2, bag_size: 335

batch 1099, loss: 0.4078, instance_loss: 0.5273, weighted_loss: 0.4437, label: 2, bag_size: 174

batch 1199, loss: 0.0212, instance_loss: 0.0109, weighted_loss: 0.0181, label: 1, bag_size: 631

batch 1299, loss: 0.1002, instance_loss: 0.3679, weighted_loss: 0.1805, label: 2, bag_size: 252

batch 1399, loss: 0.2393, instance_loss: 0.4211, weighted_loss: 0.2939, label: 2, bag_size: 1426

batch 1499, loss: 3.1373, instance_loss: 1.6526, weighted_loss: 2.6919, label: 2, bag_size: 1331

batch 1599, loss: 1.4450, instance_loss: 0.5922, weighted_loss: 1.1892, label: 1, bag_size: 179

batch 1699, loss: 0.0043, instance_loss: 0.0098, weighted_loss: 0.0059, label: 2, bag_size: 679

batch 1799, loss: 0.0163, instance_loss: 0.0290, weighted_loss: 0.0201, label: 2, bag_size: 887

batch 1899, loss: 1.6588, instance_loss: 0.7308, weighted_loss: 1.3804, label: 3, bag_size: 79

batch 1999, loss: 0.0181, instance_loss: 0.0796, weighted_loss: 0.0365, label: 2, bag_size: 544

batch 2099, loss: 0.0067, instance_loss: 0.0587, weighted_loss: 0.0223, label: 2, bag_size: 409

Instance Classifier Stats

class 0 clustering acc 0.9835973502304147: correct 68301/69440

class 1 clustering acc 0.4754032258064516: correct 8253/17360


Epoch: 6, train_loss: 0.5656, train_clustering_loss:  0.3579

class 0: acc 0.4318181818181818, correct 19/44

class 1: acc 0.7327365728900256, correct 573/782

class 2: acc 0.8822447102115916, correct 959/1087

class 3: acc 0.4046692607003891, correct 104/257


Val Set, val_loss: 0.8449, auc: 0.7825

class 0 clustering acc 0.9786931818181818: correct 8268/8448

class 1 clustering acc 0.4303977272727273: correct 909/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.59375, correct 57/96

class 2: acc 0.8134328358208955, correct 109/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.6515

Overall F1 Score: 0.4094

Training for coarse level...

batch 99, loss: 1.5946, instance_loss: 0.7162, weighted_loss: 1.3311, label: 1, bag_size: 168

batch 199, loss: 0.0288, instance_loss: 0.3925, weighted_loss: 0.1379, label: 1, bag_size: 473

batch 299, loss: 0.8544, instance_loss: 0.7745, weighted_loss: 0.8305, label: 2, bag_size: 563

batch 399, loss: 0.3929, instance_loss: 0.5945, weighted_loss: 0.4534, label: 1, bag_size: 356

batch 499, loss: 0.2088, instance_loss: 0.2202, weighted_loss: 0.2122, label: 2, bag_size: 325

batch 599, loss: 1.1155, instance_loss: 0.6521, weighted_loss: 0.9765, label: 1, bag_size: 347

batch 699, loss: 1.1844, instance_loss: 0.7265, weighted_loss: 1.0470, label: 3, bag_size: 483

batch 799, loss: 0.7055, instance_loss: 0.5561, weighted_loss: 0.6606, label: 1, bag_size: 663

batch 899, loss: 0.0284, instance_loss: 0.4386, weighted_loss: 0.1515, label: 2, bag_size: 276

batch 999, loss: 0.2203, instance_loss: 0.4449, weighted_loss: 0.2877, label: 1, bag_size: 344

batch 1099, loss: 0.3566, instance_loss: 0.4080, weighted_loss: 0.3720, label: 2, bag_size: 294

batch 1199, loss: 1.4045, instance_loss: 1.0563, weighted_loss: 1.3000, label: 3, bag_size: 481

batch 1299, loss: 0.1866, instance_loss: 0.2600, weighted_loss: 0.2086, label: 2, bag_size: 422

batch 1399, loss: 0.0253, instance_loss: 0.0447, weighted_loss: 0.0311, label: 1, bag_size: 724

batch 1499, loss: 0.0171, instance_loss: 0.0100, weighted_loss: 0.0150, label: 1, bag_size: 1460

batch 1599, loss: 0.0023, instance_loss: 0.0089, weighted_loss: 0.0043, label: 1, bag_size: 889

batch 1699, loss: 0.0196, instance_loss: 0.0708, weighted_loss: 0.0349, label: 2, bag_size: 359

batch 1799, loss: 0.0070, instance_loss: 0.0783, weighted_loss: 0.0284, label: 1, bag_size: 182

batch 1899, loss: 0.0193, instance_loss: 0.3673, weighted_loss: 0.1237, label: 2, bag_size: 129

batch 1999, loss: 0.0089, instance_loss: 0.4949, weighted_loss: 0.1547, label: 0, bag_size: 129

batch 2099, loss: 0.0324, instance_loss: 0.0334, weighted_loss: 0.0327, label: 2, bag_size: 334

Instance Classifier Stats

class 0 clustering acc 0.9836837557603687: correct 68307/69440

class 1 clustering acc 0.4847926267281106: correct 8416/17360


Epoch: 7, train_loss: 0.5015, train_clustering_loss:  0.3513

class 0: acc 0.5454545454545454, correct 24/44

class 1: acc 0.7762148337595908, correct 607/782

class 2: acc 0.890524379024839, correct 968/1087

class 3: acc 0.5291828793774319, correct 136/257


Val Set, val_loss: 0.8335, auc: 0.8040

class 0 clustering acc 0.9776278409090909: correct 8259/8448

class 1 clustering acc 0.46117424242424243: correct 974/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6041666666666666, correct 58/96

class 2: acc 0.8208955223880597, correct 110/134

class 3: acc 0.13333333333333333, correct 4/30

Overall Accuracy: 0.6515

Overall F1 Score: 0.3908

Training for coarse level...

batch 99, loss: 0.0198, instance_loss: 0.1050, weighted_loss: 0.0453, label: 1, bag_size: 1616

batch 199, loss: 0.0037, instance_loss: 0.1536, weighted_loss: 0.0487, label: 2, bag_size: 290

batch 299, loss: 0.5287, instance_loss: 0.4881, weighted_loss: 0.5165, label: 1, bag_size: 592

batch 399, loss: 0.2997, instance_loss: 0.3202, weighted_loss: 0.3058, label: 2, bag_size: 732

batch 499, loss: 0.0230, instance_loss: 0.0721, weighted_loss: 0.0377, label: 2, bag_size: 229

batch 599, loss: 0.3236, instance_loss: 0.4436, weighted_loss: 0.3596, label: 2, bag_size: 635

batch 699, loss: 0.0981, instance_loss: 0.0772, weighted_loss: 0.0918, label: 1, bag_size: 1803

batch 799, loss: 0.0204, instance_loss: 0.8048, weighted_loss: 0.2557, label: 0, bag_size: 258

batch 899, loss: 0.7365, instance_loss: 0.6192, weighted_loss: 0.7013, label: 1, bag_size: 621

batch 999, loss: 0.0040, instance_loss: 0.0080, weighted_loss: 0.0052, label: 1, bag_size: 2086

batch 1099, loss: 0.1708, instance_loss: 0.0654, weighted_loss: 0.1392, label: 2, bag_size: 905

batch 1199, loss: 1.0614, instance_loss: 0.8048, weighted_loss: 0.9844, label: 3, bag_size: 435

batch 1299, loss: 0.4758, instance_loss: 0.4022, weighted_loss: 0.4537, label: 1, bag_size: 1739

batch 1399, loss: 0.2818, instance_loss: 0.2894, weighted_loss: 0.2841, label: 2, bag_size: 405

batch 1499, loss: 0.0015, instance_loss: 0.0561, weighted_loss: 0.0178, label: 2, bag_size: 1161

batch 1599, loss: 0.0512, instance_loss: 0.0300, weighted_loss: 0.0448, label: 1, bag_size: 1067

batch 1699, loss: 0.0002, instance_loss: 0.0072, weighted_loss: 0.0023, label: 1, bag_size: 1460

batch 1799, loss: 1.5853, instance_loss: 0.7819, weighted_loss: 1.3443, label: 2, bag_size: 708

batch 1899, loss: 0.1408, instance_loss: 0.1316, weighted_loss: 0.1380, label: 1, bag_size: 774

batch 1999, loss: 0.0018, instance_loss: 0.0032, weighted_loss: 0.0022, label: 1, bag_size: 542

batch 2099, loss: 0.7946, instance_loss: 0.4048, weighted_loss: 0.6777, label: 2, bag_size: 124

Instance Classifier Stats

class 0 clustering acc 0.983366935483871: correct 68285/69440

class 1 clustering acc 0.5037442396313364: correct 8745/17360


Epoch: 8, train_loss: 0.4358, train_clustering_loss:  0.3381

class 0: acc 0.6136363636363636, correct 27/44

class 1: acc 0.8107416879795396, correct 634/782

class 2: acc 0.9153633854645814, correct 995/1087

class 3: acc 0.603112840466926, correct 155/257


Val Set, val_loss: 1.0005, auc: 0.7812

class 0 clustering acc 0.9720643939393939: correct 8212/8448

class 1 clustering acc 0.4578598484848485: correct 967/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.7604166666666666, correct 73/96

class 2: acc 0.6716417910447762, correct 90/134

class 3: acc 0.23333333333333334, correct 7/30

Overall Accuracy: 0.6439

Overall F1 Score: 0.4194

Training for coarse level...

batch 99, loss: 0.5472, instance_loss: 0.5453, weighted_loss: 0.5466, label: 3, bag_size: 661

batch 199, loss: 0.8173, instance_loss: 0.3504, weighted_loss: 0.6773, label: 2, bag_size: 492

batch 299, loss: 0.0236, instance_loss: 0.9250, weighted_loss: 0.2940, label: 1, bag_size: 472

batch 399, loss: 0.3219, instance_loss: 0.4140, weighted_loss: 0.3495, label: 2, bag_size: 253

batch 499, loss: 0.2783, instance_loss: 0.0608, weighted_loss: 0.2130, label: 1, bag_size: 762

batch 599, loss: 0.0001, instance_loss: 0.1341, weighted_loss: 0.0403, label: 1, bag_size: 333

batch 699, loss: 0.0015, instance_loss: 0.0182, weighted_loss: 0.0065, label: 2, bag_size: 456

batch 799, loss: 0.0076, instance_loss: 0.0077, weighted_loss: 0.0076, label: 1, bag_size: 484

batch 899, loss: 1.0722, instance_loss: 0.5821, weighted_loss: 0.9252, label: 1, bag_size: 224

batch 999, loss: 0.2732, instance_loss: 0.4578, weighted_loss: 0.3286, label: 1, bag_size: 50

batch 1099, loss: 0.3139, instance_loss: 0.2393, weighted_loss: 0.2915, label: 2, bag_size: 339

batch 1199, loss: 0.1489, instance_loss: 0.1430, weighted_loss: 0.1471, label: 2, bag_size: 743

batch 1299, loss: 0.0001, instance_loss: 0.0095, weighted_loss: 0.0029, label: 1, bag_size: 1313

batch 1399, loss: 0.0059, instance_loss: 0.0569, weighted_loss: 0.0212, label: 2, bag_size: 202

batch 1499, loss: 0.0057, instance_loss: 0.0456, weighted_loss: 0.0177, label: 1, bag_size: 755

batch 1599, loss: 0.5012, instance_loss: 0.5142, weighted_loss: 0.5051, label: 3, bag_size: 152

batch 1699, loss: 0.0170, instance_loss: 0.0737, weighted_loss: 0.0340, label: 2, bag_size: 875

batch 1799, loss: 1.1561, instance_loss: 1.5043, weighted_loss: 1.2605, label: 3, bag_size: 328

batch 1899, loss: 1.5146, instance_loss: 0.6149, weighted_loss: 1.2447, label: 1, bag_size: 851

batch 1999, loss: 0.1963, instance_loss: 0.5040, weighted_loss: 0.2886, label: 3, bag_size: 619

batch 2099, loss: 0.6859, instance_loss: 0.5180, weighted_loss: 0.6355, label: 1, bag_size: 454

Instance Classifier Stats

class 0 clustering acc 0.9828485023041474: correct 68249/69440

class 1 clustering acc 0.529147465437788: correct 9186/17360


Epoch: 9, train_loss: 0.3615, train_clustering_loss:  0.3282

class 0: acc 0.6590909090909091, correct 29/44

class 1: acc 0.8478260869565217, correct 663/782

class 2: acc 0.9199632014719411, correct 1000/1087

class 3: acc 0.6848249027237354, correct 176/257


Val Set, val_loss: 0.9077, auc: 0.8002

class 0 clustering acc 0.9791666666666666: correct 8272/8448

class 1 clustering acc 0.44554924242424243: correct 941/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.7395833333333334, correct 71/96

class 2: acc 0.6940298507462687, correct 93/134

class 3: acc 0.3333333333333333, correct 10/30

Overall Accuracy: 0.6591

Overall F1 Score: 0.4420

Training for coarse level...

batch 99, loss: 0.1213, instance_loss: 0.3490, weighted_loss: 0.1896, label: 2, bag_size: 595

batch 199, loss: 0.1328, instance_loss: 0.2129, weighted_loss: 0.1568, label: 2, bag_size: 206

batch 299, loss: 0.0938, instance_loss: 0.1605, weighted_loss: 0.1138, label: 2, bag_size: 309

batch 399, loss: 0.1148, instance_loss: 0.4884, weighted_loss: 0.2269, label: 1, bag_size: 193

batch 499, loss: 0.0333, instance_loss: 0.0741, weighted_loss: 0.0455, label: 1, bag_size: 873

batch 599, loss: 0.4183, instance_loss: 0.5800, weighted_loss: 0.4668, label: 1, bag_size: 167

batch 699, loss: 0.0005, instance_loss: 0.0109, weighted_loss: 0.0036, label: 1, bag_size: 758

batch 799, loss: 2.6107, instance_loss: 0.7830, weighted_loss: 2.0623, label: 1, bag_size: 191

batch 899, loss: 0.1536, instance_loss: 0.1755, weighted_loss: 0.1601, label: 2, bag_size: 1049

batch 999, loss: 0.4517, instance_loss: 0.4447, weighted_loss: 0.4496, label: 2, bag_size: 364

batch 1099, loss: 0.0033, instance_loss: 0.0256, weighted_loss: 0.0100, label: 2, bag_size: 706

batch 1199, loss: 0.0256, instance_loss: 0.0915, weighted_loss: 0.0453, label: 1, bag_size: 1211

batch 1299, loss: 0.7790, instance_loss: 0.7599, weighted_loss: 0.7733, label: 1, bag_size: 242

batch 1399, loss: 0.1268, instance_loss: 0.5279, weighted_loss: 0.2471, label: 1, bag_size: 435

batch 1499, loss: 0.0007, instance_loss: 0.0078, weighted_loss: 0.0028, label: 2, bag_size: 834

batch 1599, loss: 0.0123, instance_loss: 0.0124, weighted_loss: 0.0123, label: 2, bag_size: 210

batch 1699, loss: 0.0284, instance_loss: 0.0087, weighted_loss: 0.0225, label: 1, bag_size: 2627

batch 1799, loss: 0.0148, instance_loss: 0.2605, weighted_loss: 0.0885, label: 1, bag_size: 309

batch 1899, loss: 0.0777, instance_loss: 0.4732, weighted_loss: 0.1963, label: 1, bag_size: 84

batch 1999, loss: 0.0002, instance_loss: 0.0105, weighted_loss: 0.0033, label: 2, bag_size: 414

batch 2099, loss: 0.2684, instance_loss: 0.3953, weighted_loss: 0.3064, label: 2, bag_size: 259

Instance Classifier Stats

class 0 clustering acc 0.9824740783410139: correct 68223/69440

class 1 clustering acc 0.534389400921659: correct 9277/17360


Epoch: 10, train_loss: 0.3011, train_clustering_loss:  0.3212

class 0: acc 0.75, correct 33/44

class 1: acc 0.8797953964194374, correct 688/782

class 2: acc 0.9420423183072677, correct 1024/1087

class 3: acc 0.7509727626459144, correct 193/257


Val Set, val_loss: 1.1396, auc: 0.7426

class 0 clustering acc 0.9762073863636364: correct 8247/8448

class 1 clustering acc 0.4266098484848485: correct 901/2112

class 0: acc 0.25, correct 1/4

class 1: acc 0.65625, correct 63/96

class 2: acc 0.6567164179104478, correct 88/134

class 3: acc 0.3, correct 9/30

Overall Accuracy: 0.6098

Overall F1 Score: 0.4530

Training for coarse level...

batch 99, loss: 0.0938, instance_loss: 0.0679, weighted_loss: 0.0860, label: 2, bag_size: 533

batch 199, loss: 0.0003, instance_loss: 0.0051, weighted_loss: 0.0017, label: 2, bag_size: 1044

batch 299, loss: 1.7402, instance_loss: 0.8645, weighted_loss: 1.4775, label: 3, bag_size: 345

batch 399, loss: 1.2487, instance_loss: 0.7971, weighted_loss: 1.1132, label: 1, bag_size: 115

batch 499, loss: 1.0331, instance_loss: 0.4646, weighted_loss: 0.8625, label: 2, bag_size: 833

batch 599, loss: 0.1999, instance_loss: 0.3264, weighted_loss: 0.2378, label: 1, bag_size: 1150

batch 699, loss: 0.0580, instance_loss: 0.1149, weighted_loss: 0.0751, label: 1, bag_size: 1767

batch 799, loss: 0.4164, instance_loss: 0.6381, weighted_loss: 0.4829, label: 2, bag_size: 444

batch 899, loss: 0.6795, instance_loss: 0.5297, weighted_loss: 0.6345, label: 1, bag_size: 127

batch 999, loss: 0.1977, instance_loss: 0.4426, weighted_loss: 0.2711, label: 2, bag_size: 655

batch 1099, loss: 0.0158, instance_loss: 0.2038, weighted_loss: 0.0722, label: 2, bag_size: 466

batch 1199, loss: 0.3296, instance_loss: 0.1991, weighted_loss: 0.2905, label: 2, bag_size: 113

batch 1299, loss: 1.3425, instance_loss: 1.4836, weighted_loss: 1.3848, label: 3, bag_size: 1009

batch 1399, loss: 1.7678, instance_loss: 0.6824, weighted_loss: 1.4422, label: 1, bag_size: 675

batch 1499, loss: 0.2839, instance_loss: 0.5754, weighted_loss: 0.3714, label: 1, bag_size: 57

batch 1599, loss: 0.0066, instance_loss: 0.0201, weighted_loss: 0.0107, label: 2, bag_size: 515

batch 1699, loss: 0.0008, instance_loss: 0.3179, weighted_loss: 0.0959, label: 2, bag_size: 482

batch 1799, loss: 0.0057, instance_loss: 0.0569, weighted_loss: 0.0211, label: 1, bag_size: 1973

batch 1899, loss: 0.2735, instance_loss: 0.3929, weighted_loss: 0.3093, label: 1, bag_size: 235

batch 1999, loss: 0.0115, instance_loss: 0.0291, weighted_loss: 0.0168, label: 2, bag_size: 280

batch 2099, loss: 0.0025, instance_loss: 0.5479, weighted_loss: 0.1661, label: 1, bag_size: 287

Instance Classifier Stats

class 0 clustering acc 0.9817252304147466: correct 68171/69440

class 1 clustering acc 0.5528225806451613: correct 9597/17360


Epoch: 11, train_loss: 0.2630, train_clustering_loss:  0.3160

class 0: acc 0.7954545454545454, correct 35/44

class 1: acc 0.8989769820971867, correct 703/782

class 2: acc 0.9402023919043239, correct 1022/1087

class 3: acc 0.77431906614786, correct 199/257


Val Set, val_loss: 1.2365, auc: 0.7312

class 0 clustering acc 0.9741950757575758: correct 8230/8448

class 1 clustering acc 0.4071969696969697: correct 860/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6979166666666666, correct 67/96

class 2: acc 0.6567164179104478, correct 88/134

class 3: acc 0.3333333333333333, correct 10/30

Overall Accuracy: 0.6250

Overall F1 Score: 0.4137

Training for coarse level...

batch 99, loss: 0.0466, instance_loss: 0.4491, weighted_loss: 0.1673, label: 3, bag_size: 132

batch 199, loss: 0.0052, instance_loss: 0.0923, weighted_loss: 0.0314, label: 1, bag_size: 728

batch 299, loss: 0.0003, instance_loss: 0.0072, weighted_loss: 0.0024, label: 2, bag_size: 1064

batch 399, loss: 0.0053, instance_loss: 0.4318, weighted_loss: 0.1333, label: 2, bag_size: 401

batch 499, loss: 0.0193, instance_loss: 0.2108, weighted_loss: 0.0768, label: 1, bag_size: 165

batch 599, loss: 0.0054, instance_loss: 0.3317, weighted_loss: 0.1033, label: 1, bag_size: 1666

batch 699, loss: 0.0452, instance_loss: 0.0350, weighted_loss: 0.0421, label: 1, bag_size: 389

batch 799, loss: 0.0074, instance_loss: 0.0795, weighted_loss: 0.0290, label: 2, bag_size: 238

batch 899, loss: 0.0226, instance_loss: 0.2533, weighted_loss: 0.0918, label: 2, bag_size: 334

batch 999, loss: 0.0000, instance_loss: 0.0678, weighted_loss: 0.0204, label: 1, bag_size: 334

batch 1099, loss: 0.0917, instance_loss: 0.5632, weighted_loss: 0.2331, label: 1, bag_size: 262

batch 1199, loss: 0.0761, instance_loss: 0.3247, weighted_loss: 0.1507, label: 2, bag_size: 336

batch 1299, loss: 0.1086, instance_loss: 0.1825, weighted_loss: 0.1308, label: 2, bag_size: 376

batch 1399, loss: 2.4152, instance_loss: 1.0117, weighted_loss: 1.9942, label: 1, bag_size: 657

batch 1499, loss: 0.0013, instance_loss: 0.0170, weighted_loss: 0.0060, label: 1, bag_size: 666

batch 1599, loss: 0.0023, instance_loss: 0.0632, weighted_loss: 0.0206, label: 2, bag_size: 466

batch 1699, loss: 0.0218, instance_loss: 0.1640, weighted_loss: 0.0645, label: 2, bag_size: 361

batch 1799, loss: 0.9951, instance_loss: 0.6501, weighted_loss: 0.8916, label: 2, bag_size: 548

batch 1899, loss: 0.0001, instance_loss: 0.0267, weighted_loss: 0.0081, label: 2, bag_size: 369

batch 1999, loss: 1.2373, instance_loss: 0.9544, weighted_loss: 1.1524, label: 1, bag_size: 317

batch 2099, loss: 0.0651, instance_loss: 0.2622, weighted_loss: 0.1242, label: 2, bag_size: 1206

Instance Classifier Stats

class 0 clustering acc 0.9829637096774193: correct 68257/69440

class 1 clustering acc 0.5620967741935484: correct 9758/17360


Epoch: 12, train_loss: 0.2199, train_clustering_loss:  0.3071

class 0: acc 0.7727272727272727, correct 34/44

class 1: acc 0.9130434782608695, correct 714/782

class 2: acc 0.9622815087396505, correct 1046/1087

class 3: acc 0.8365758754863813, correct 215/257


Val Set, val_loss: 1.2402, auc: 0.7775

class 0 clustering acc 0.9650804924242424: correct 8153/8448

class 1 clustering acc 0.4895833333333333: correct 1034/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.625, correct 60/96

class 2: acc 0.7238805970149254, correct 97/134

class 3: acc 0.4, correct 12/30

Overall Accuracy: 0.6402

Overall F1 Score: 0.4319

Training for coarse level...

batch 99, loss: 0.1401, instance_loss: 0.2873, weighted_loss: 0.1842, label: 1, bag_size: 354

batch 199, loss: 0.0002, instance_loss: 0.3627, weighted_loss: 0.1089, label: 3, bag_size: 168

batch 299, loss: 0.0215, instance_loss: 0.0813, weighted_loss: 0.0395, label: 2, bag_size: 328

batch 399, loss: 0.0009, instance_loss: 0.3742, weighted_loss: 0.1129, label: 1, bag_size: 347

batch 499, loss: 0.3964, instance_loss: 0.5952, weighted_loss: 0.4560, label: 3, bag_size: 450

batch 599, loss: 0.0000, instance_loss: 0.0002, weighted_loss: 0.0001, label: 1, bag_size: 2219

batch 699, loss: 0.0033, instance_loss: 0.5788, weighted_loss: 0.1760, label: 1, bag_size: 121

batch 799, loss: 0.5009, instance_loss: 0.4610, weighted_loss: 0.4890, label: 1, bag_size: 618

batch 899, loss: 0.0830, instance_loss: 0.0808, weighted_loss: 0.0823, label: 2, bag_size: 393

batch 999, loss: 0.0012, instance_loss: 0.6051, weighted_loss: 0.1824, label: 3, bag_size: 628

batch 1099, loss: 2.4890, instance_loss: 0.3141, weighted_loss: 1.8365, label: 2, bag_size: 523

batch 1199, loss: 0.0101, instance_loss: 0.1866, weighted_loss: 0.0631, label: 1, bag_size: 559

batch 1299, loss: 0.1099, instance_loss: 0.5130, weighted_loss: 0.2309, label: 2, bag_size: 387

batch 1399, loss: 0.0293, instance_loss: 0.4050, weighted_loss: 0.1420, label: 2, bag_size: 317

batch 1499, loss: 0.0028, instance_loss: 0.4263, weighted_loss: 0.1299, label: 2, bag_size: 1796

batch 1599, loss: 0.1232, instance_loss: 0.2805, weighted_loss: 0.1704, label: 2, bag_size: 206

batch 1699, loss: 0.0000, instance_loss: 0.0038, weighted_loss: 0.0011, label: 1, bag_size: 563

batch 1799, loss: 0.0100, instance_loss: 0.3484, weighted_loss: 0.1115, label: 2, bag_size: 247

batch 1899, loss: 0.0019, instance_loss: 0.0146, weighted_loss: 0.0057, label: 2, bag_size: 712

batch 1999, loss: 0.1530, instance_loss: 0.1591, weighted_loss: 0.1548, label: 2, bag_size: 703

batch 2099, loss: 0.0003, instance_loss: 0.0424, weighted_loss: 0.0130, label: 2, bag_size: 525

Instance Classifier Stats

class 0 clustering acc 0.9829061059907834: correct 68253/69440

class 1 clustering acc 0.5732142857142857: correct 9951/17360


Epoch: 13, train_loss: 0.1843, train_clustering_loss:  0.3023

class 0: acc 0.8409090909090909, correct 37/44

class 1: acc 0.9271099744245525, correct 725/782

class 2: acc 0.9576816927322908, correct 1041/1087

class 3: acc 0.8599221789883269, correct 221/257


Val Set, val_loss: 1.4971, auc: 0.7151

class 0 clustering acc 0.9640151515151515: correct 8144/8448

class 1 clustering acc 0.4479166666666667: correct 946/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.7291666666666666, correct 70/96

class 2: acc 0.6119402985074627, correct 82/134

class 3: acc 0.26666666666666666, correct 8/30

Overall Accuracy: 0.6061

Overall F1 Score: 0.3967

Training for coarse level...

batch 99, loss: 0.0014, instance_loss: 0.0028, weighted_loss: 0.0019, label: 1, bag_size: 788

batch 199, loss: 0.0712, instance_loss: 0.7422, weighted_loss: 0.2725, label: 3, bag_size: 235

batch 299, loss: 0.0033, instance_loss: 0.2803, weighted_loss: 0.0864, label: 1, bag_size: 2625

batch 399, loss: 3.2720, instance_loss: 0.6864, weighted_loss: 2.4963, label: 1, bag_size: 676

batch 499, loss: 0.0089, instance_loss: 0.0203, weighted_loss: 0.0123, label: 1, bag_size: 2107

batch 599, loss: 0.0127, instance_loss: 0.2945, weighted_loss: 0.0972, label: 2, bag_size: 337

batch 699, loss: 0.0062, instance_loss: 0.6796, weighted_loss: 0.2082, label: 2, bag_size: 325

batch 799, loss: 0.0000, instance_loss: 0.3428, weighted_loss: 0.1029, label: 2, bag_size: 288

batch 899, loss: 0.0044, instance_loss: 0.1632, weighted_loss: 0.0521, label: 2, bag_size: 436

batch 999, loss: 0.0411, instance_loss: 0.2212, weighted_loss: 0.0951, label: 2, bag_size: 243

batch 1099, loss: 0.0001, instance_loss: 0.1205, weighted_loss: 0.0362, label: 2, bag_size: 741

batch 1199, loss: 0.0107, instance_loss: 0.5334, weighted_loss: 0.1675, label: 1, bag_size: 421

batch 1299, loss: 0.0009, instance_loss: 0.0043, weighted_loss: 0.0019, label: 2, bag_size: 525

batch 1399, loss: 0.0006, instance_loss: 0.3267, weighted_loss: 0.0984, label: 3, bag_size: 876

batch 1499, loss: 0.4258, instance_loss: 0.2174, weighted_loss: 0.3633, label: 2, bag_size: 1214

batch 1599, loss: 0.0245, instance_loss: 0.3042, weighted_loss: 0.1084, label: 2, bag_size: 316

batch 1699, loss: 0.0036, instance_loss: 0.0466, weighted_loss: 0.0165, label: 1, bag_size: 2154

batch 1799, loss: 1.8886, instance_loss: 0.7958, weighted_loss: 1.5608, label: 1, bag_size: 356

batch 1899, loss: 0.0003, instance_loss: 0.0094, weighted_loss: 0.0030, label: 1, bag_size: 659

batch 1999, loss: 0.0008, instance_loss: 0.2421, weighted_loss: 0.0732, label: 2, bag_size: 814

batch 2099, loss: 0.0050, instance_loss: 0.6631, weighted_loss: 0.2024, label: 3, bag_size: 625

Instance Classifier Stats

class 0 clustering acc 0.9818980414746544: correct 68183/69440

class 1 clustering acc 0.5829493087557603: correct 10120/17360


Epoch: 14, train_loss: 0.1666, train_clustering_loss:  0.3001

class 0: acc 0.8409090909090909, correct 37/44

class 1: acc 0.9347826086956522, correct 731/782

class 2: acc 0.9622815087396505, correct 1046/1087

class 3: acc 0.8910505836575876, correct 229/257


Val Set, val_loss: 1.3715, auc: 0.7645

class 0 clustering acc 0.9630681818181818: correct 8136/8448

class 1 clustering acc 0.47679924242424243: correct 1007/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6875, correct 66/96

class 2: acc 0.664179104477612, correct 89/134

class 3: acc 0.36666666666666664, correct 11/30

Overall Accuracy: 0.6288

Overall F1 Score: 0.4246

Training for coarse level...

batch 99, loss: 0.0467, instance_loss: 0.2809, weighted_loss: 0.1169, label: 2, bag_size: 290

batch 199, loss: 0.0450, instance_loss: 0.1749, weighted_loss: 0.0840, label: 1, bag_size: 835

batch 299, loss: 0.0058, instance_loss: 0.3218, weighted_loss: 0.1006, label: 2, bag_size: 562

batch 399, loss: 1.3814, instance_loss: 0.7139, weighted_loss: 1.1812, label: 3, bag_size: 368

batch 499, loss: 0.0082, instance_loss: 0.4016, weighted_loss: 0.1262, label: 2, bag_size: 708

batch 599, loss: 0.0007, instance_loss: 0.1344, weighted_loss: 0.0408, label: 2, bag_size: 1853

batch 699, loss: 0.0196, instance_loss: 0.5157, weighted_loss: 0.1685, label: 0, bag_size: 113

batch 799, loss: 0.0569, instance_loss: 0.4486, weighted_loss: 0.1744, label: 2, bag_size: 444

batch 899, loss: 0.0002, instance_loss: 0.1075, weighted_loss: 0.0324, label: 1, bag_size: 1628

batch 999, loss: 0.0315, instance_loss: 0.2018, weighted_loss: 0.0826, label: 2, bag_size: 367

batch 1099, loss: 0.3454, instance_loss: 0.3823, weighted_loss: 0.3565, label: 2, bag_size: 112

batch 1199, loss: 0.0000, instance_loss: 0.0265, weighted_loss: 0.0079, label: 2, bag_size: 364

batch 1299, loss: 0.1728, instance_loss: 0.5236, weighted_loss: 0.2780, label: 1, bag_size: 510

batch 1399, loss: 0.0032, instance_loss: 0.0232, weighted_loss: 0.0092, label: 1, bag_size: 1333

batch 1499, loss: 0.0000, instance_loss: 0.2078, weighted_loss: 0.0623, label: 2, bag_size: 291

batch 1599, loss: 0.0557, instance_loss: 0.8327, weighted_loss: 0.2888, label: 3, bag_size: 568

batch 1699, loss: 0.2591, instance_loss: 0.3885, weighted_loss: 0.2979, label: 2, bag_size: 193

batch 1799, loss: 0.0122, instance_loss: 0.4304, weighted_loss: 0.1377, label: 1, bag_size: 378

batch 1899, loss: 0.0516, instance_loss: 0.5783, weighted_loss: 0.2096, label: 2, bag_size: 526

batch 1999, loss: 0.0201, instance_loss: 0.2335, weighted_loss: 0.0841, label: 2, bag_size: 362

batch 2099, loss: 0.3547, instance_loss: 0.8701, weighted_loss: 0.5093, label: 0, bag_size: 244

Instance Classifier Stats

class 0 clustering acc 0.9826036866359447: correct 68232/69440

class 1 clustering acc 0.595852534562212: correct 10344/17360


Epoch: 15, train_loss: 0.1226, train_clustering_loss:  0.2906

class 0: acc 0.9090909090909091, correct 40/44

class 1: acc 0.9514066496163683, correct 744/782

class 2: acc 0.9751609935602575, correct 1060/1087

class 3: acc 0.9066147859922179, correct 233/257


Val Set, val_loss: 1.5049, auc: 0.7160

class 0 clustering acc 0.954782196969697: correct 8066/8448

class 1 clustering acc 0.5118371212121212: correct 1081/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6145833333333334, correct 59/96

class 2: acc 0.7238805970149254, correct 97/134

class 3: acc 0.13333333333333333, correct 4/30

Overall Accuracy: 0.6061

Overall F1 Score: 0.3704

Training for coarse level...

batch 99, loss: 0.0858, instance_loss: 0.2508, weighted_loss: 0.1353, label: 2, bag_size: 322

batch 199, loss: 0.0018, instance_loss: 0.4493, weighted_loss: 0.1361, label: 3, bag_size: 837

batch 299, loss: 0.0010, instance_loss: 0.2306, weighted_loss: 0.0699, label: 2, bag_size: 269

batch 399, loss: 0.0051, instance_loss: 0.0430, weighted_loss: 0.0164, label: 2, bag_size: 640

batch 499, loss: 0.0001, instance_loss: 0.1872, weighted_loss: 0.0562, label: 1, bag_size: 555

batch 599, loss: 0.0197, instance_loss: 0.3033, weighted_loss: 0.1048, label: 2, bag_size: 317

batch 699, loss: 0.4725, instance_loss: 0.3895, weighted_loss: 0.4476, label: 2, bag_size: 266

batch 799, loss: 0.0046, instance_loss: 0.2740, weighted_loss: 0.0854, label: 1, bag_size: 343

batch 899, loss: 0.0118, instance_loss: 0.7880, weighted_loss: 0.2447, label: 1, bag_size: 542

batch 999, loss: 0.0018, instance_loss: 0.3994, weighted_loss: 0.1211, label: 1, bag_size: 568

batch 1099, loss: 0.0000, instance_loss: 0.0449, weighted_loss: 0.0135, label: 2, bag_size: 1246

batch 1199, loss: 0.0106, instance_loss: 0.5727, weighted_loss: 0.1792, label: 1, bag_size: 407

batch 1299, loss: 0.0007, instance_loss: 0.0117, weighted_loss: 0.0040, label: 2, bag_size: 700

batch 1399, loss: 0.1616, instance_loss: 0.4432, weighted_loss: 0.2461, label: 1, bag_size: 248

batch 1499, loss: 0.0382, instance_loss: 0.0553, weighted_loss: 0.0433, label: 2, bag_size: 619

batch 1599, loss: 0.8858, instance_loss: 0.9138, weighted_loss: 0.8942, label: 2, bag_size: 2344

batch 1699, loss: 0.0010, instance_loss: 0.0053, weighted_loss: 0.0023, label: 2, bag_size: 210

batch 1799, loss: 0.0004, instance_loss: 0.1182, weighted_loss: 0.0357, label: 2, bag_size: 422

batch 1899, loss: 0.0017, instance_loss: 0.3202, weighted_loss: 0.0972, label: 2, bag_size: 338

batch 1999, loss: 0.0319, instance_loss: 0.5368, weighted_loss: 0.1833, label: 1, bag_size: 371

batch 2099, loss: 0.2972, instance_loss: 0.6536, weighted_loss: 0.4041, label: 1, bag_size: 2059

Instance Classifier Stats

class 0 clustering acc 0.9810771889400922: correct 68126/69440

class 1 clustering acc 0.5963709677419354: correct 10353/17360


Epoch: 16, train_loss: 0.1117, train_clustering_loss:  0.2961

class 0: acc 0.9545454545454546, correct 42/44

class 1: acc 0.9578005115089514, correct 749/782

class 2: acc 0.9733210671573137, correct 1058/1087

class 3: acc 0.9182879377431906, correct 236/257


Val Set, val_loss: 1.5652, auc: 0.7278

class 0 clustering acc 0.9636600378787878: correct 8141/8448

class 1 clustering acc 0.4815340909090909: correct 1017/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.625, correct 60/96

class 2: acc 0.7238805970149254, correct 97/134

class 3: acc 0.36666666666666664, correct 11/30

Overall Accuracy: 0.6364

Overall F1 Score: 0.4269

Training for coarse level...

batch 99, loss: 0.0264, instance_loss: 0.2486, weighted_loss: 0.0931, label: 2, bag_size: 524

batch 199, loss: 0.0000, instance_loss: 0.3502, weighted_loss: 0.1051, label: 1, bag_size: 304

batch 299, loss: 0.0004, instance_loss: 0.2880, weighted_loss: 0.0867, label: 2, bag_size: 338

batch 399, loss: 0.1145, instance_loss: 0.0641, weighted_loss: 0.0994, label: 2, bag_size: 691

batch 499, loss: 0.0053, instance_loss: 0.3819, weighted_loss: 0.1183, label: 1, bag_size: 250

batch 599, loss: 0.0010, instance_loss: 0.0032, weighted_loss: 0.0016, label: 1, bag_size: 1534

batch 699, loss: 0.3272, instance_loss: 0.6197, weighted_loss: 0.4150, label: 1, bag_size: 407

batch 799, loss: 0.0008, instance_loss: 0.0530, weighted_loss: 0.0164, label: 2, bag_size: 576

batch 899, loss: 0.0056, instance_loss: 0.1201, weighted_loss: 0.0399, label: 2, bag_size: 595

batch 999, loss: 0.0000, instance_loss: 0.0160, weighted_loss: 0.0048, label: 2, bag_size: 1032

batch 1099, loss: 0.0873, instance_loss: 0.5238, weighted_loss: 0.2182, label: 1, bag_size: 248

batch 1199, loss: 0.0048, instance_loss: 0.0412, weighted_loss: 0.0157, label: 2, bag_size: 244

batch 1299, loss: 0.0001, instance_loss: 0.0674, weighted_loss: 0.0203, label: 2, bag_size: 1064

batch 1399, loss: 0.0024, instance_loss: 0.3878, weighted_loss: 0.1180, label: 2, bag_size: 174

batch 1499, loss: 0.0001, instance_loss: 0.7173, weighted_loss: 0.2152, label: 1, bag_size: 472

batch 1599, loss: 0.0064, instance_loss: 0.0252, weighted_loss: 0.0121, label: 2, bag_size: 607

batch 1699, loss: 0.0006, instance_loss: 0.0160, weighted_loss: 0.0052, label: 1, bag_size: 1263

batch 1799, loss: 0.0824, instance_loss: 0.0835, weighted_loss: 0.0828, label: 1, bag_size: 483

batch 1899, loss: 0.0034, instance_loss: 0.0844, weighted_loss: 0.0277, label: 1, bag_size: 490

batch 1999, loss: 0.0000, instance_loss: 0.0186, weighted_loss: 0.0056, label: 1, bag_size: 1627

batch 2099, loss: 1.2396, instance_loss: 0.9984, weighted_loss: 1.1672, label: 0, bag_size: 440

Instance Classifier Stats

class 0 clustering acc 0.982286866359447: correct 68210/69440

class 1 clustering acc 0.5991935483870968: correct 10402/17360


Epoch: 17, train_loss: 0.0957, train_clustering_loss:  0.2886

class 0: acc 0.9545454545454546, correct 42/44

class 1: acc 0.969309462915601, correct 758/782

class 2: acc 0.9816007359705612, correct 1067/1087

class 3: acc 0.9455252918287937, correct 243/257


Val Set, val_loss: 1.7086, auc: 0.7427

class 0 clustering acc 0.9673295454545454: correct 8172/8448

class 1 clustering acc 0.4559659090909091: correct 963/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.71875, correct 69/96

class 2: acc 0.5970149253731343, correct 80/134

class 3: acc 0.26666666666666666, correct 8/30

Overall Accuracy: 0.5947

Overall F1 Score: 0.3907

Training for coarse level...

batch 99, loss: 0.0018, instance_loss: 0.1910, weighted_loss: 0.0586, label: 1, bag_size: 65

batch 199, loss: 0.0000, instance_loss: 0.1967, weighted_loss: 0.0590, label: 2, bag_size: 220

batch 299, loss: 0.2433, instance_loss: 0.5585, weighted_loss: 0.3378, label: 1, bag_size: 792

batch 399, loss: 0.0000, instance_loss: 0.0396, weighted_loss: 0.0119, label: 1, bag_size: 1223

batch 499, loss: 0.0125, instance_loss: 0.0215, weighted_loss: 0.0152, label: 2, bag_size: 658

batch 599, loss: 0.0277, instance_loss: 0.7015, weighted_loss: 0.2298, label: 2, bag_size: 1555

batch 699, loss: 1.5560, instance_loss: 0.4538, weighted_loss: 1.2254, label: 2, bag_size: 229

batch 799, loss: 0.0000, instance_loss: 0.0054, weighted_loss: 0.0016, label: 2, bag_size: 921

batch 899, loss: 0.0409, instance_loss: 0.3630, weighted_loss: 0.1375, label: 3, bag_size: 259

batch 999, loss: 0.0093, instance_loss: 0.4272, weighted_loss: 0.1347, label: 3, bag_size: 119

batch 1099, loss: 0.0002, instance_loss: 0.7446, weighted_loss: 0.2235, label: 3, bag_size: 663

batch 1199, loss: 0.0000, instance_loss: 0.0006, weighted_loss: 0.0002, label: 1, bag_size: 2131

batch 1299, loss: 0.0077, instance_loss: 0.2209, weighted_loss: 0.0716, label: 2, bag_size: 393

batch 1399, loss: 0.0000, instance_loss: 0.0030, weighted_loss: 0.0009, label: 1, bag_size: 378

batch 1499, loss: 0.0101, instance_loss: 0.5457, weighted_loss: 0.1708, label: 2, bag_size: 368

batch 1599, loss: 0.0024, instance_loss: 0.4427, weighted_loss: 0.1345, label: 1, bag_size: 223

batch 1699, loss: 0.0094, instance_loss: 0.0707, weighted_loss: 0.0278, label: 2, bag_size: 1547

batch 1799, loss: 0.0038, instance_loss: 0.2158, weighted_loss: 0.0674, label: 2, bag_size: 448

batch 1899, loss: 0.0004, instance_loss: 0.1962, weighted_loss: 0.0591, label: 2, bag_size: 365

batch 1999, loss: 0.0000, instance_loss: 0.0007, weighted_loss: 0.0002, label: 1, bag_size: 537

batch 2099, loss: 0.0009, instance_loss: 0.4088, weighted_loss: 0.1233, label: 3, bag_size: 720

Instance Classifier Stats

class 0 clustering acc 0.9826324884792627: correct 68234/69440

class 1 clustering acc 0.6074308755760369: correct 10545/17360


Epoch: 18, train_loss: 0.1007, train_clustering_loss:  0.2862

class 0: acc 0.9545454545454546, correct 42/44

class 1: acc 0.9654731457800512, correct 755/782

class 2: acc 0.9770009199632015, correct 1062/1087

class 3: acc 0.9105058365758755, correct 234/257


Val Set, val_loss: 1.5705, auc: 0.6890

class 0 clustering acc 0.9635416666666666: correct 8140/8448

class 1 clustering acc 0.4654356060606061: correct 983/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6145833333333334, correct 59/96

class 2: acc 0.7686567164179104, correct 103/134

class 3: acc 0.3333333333333333, correct 10/30

Overall Accuracy: 0.6515

Overall F1 Score: 0.4317

Training for coarse level...

batch 99, loss: 0.0011, instance_loss: 0.1703, weighted_loss: 0.0519, label: 2, bag_size: 214

batch 199, loss: 0.0129, instance_loss: 0.1265, weighted_loss: 0.0469, label: 2, bag_size: 533

batch 299, loss: 0.0491, instance_loss: 0.3254, weighted_loss: 0.1320, label: 2, bag_size: 1214

batch 399, loss: 0.0002, instance_loss: 0.1006, weighted_loss: 0.0303, label: 1, bag_size: 564

batch 499, loss: 0.0000, instance_loss: 0.0272, weighted_loss: 0.0082, label: 1, bag_size: 265

batch 599, loss: 0.0000, instance_loss: 0.0087, weighted_loss: 0.0026, label: 1, bag_size: 1204

batch 699, loss: 0.4642, instance_loss: 0.2977, weighted_loss: 0.4142, label: 2, bag_size: 286

batch 799, loss: 0.0000, instance_loss: 0.3382, weighted_loss: 0.1015, label: 1, bag_size: 241

batch 899, loss: 0.0170, instance_loss: 0.0655, weighted_loss: 0.0315, label: 2, bag_size: 706

batch 999, loss: 0.0200, instance_loss: 0.6119, weighted_loss: 0.1976, label: 3, bag_size: 450

batch 1099, loss: 0.0000, instance_loss: 0.2050, weighted_loss: 0.0615, label: 3, bag_size: 338

batch 1199, loss: 0.0001, instance_loss: 1.2903, weighted_loss: 0.3872, label: 0, bag_size: 554

batch 1299, loss: 0.0096, instance_loss: 0.0161, weighted_loss: 0.0115, label: 2, bag_size: 965

batch 1399, loss: 0.3568, instance_loss: 0.4462, weighted_loss: 0.3836, label: 1, bag_size: 421

batch 1499, loss: 0.0017, instance_loss: 0.3808, weighted_loss: 0.1155, label: 2, bag_size: 288

batch 1599, loss: 0.0004, instance_loss: 0.1437, weighted_loss: 0.0434, label: 2, bag_size: 394

batch 1699, loss: 0.0737, instance_loss: 0.9320, weighted_loss: 0.3312, label: 1, bag_size: 442

batch 1799, loss: 0.0003, instance_loss: 0.0079, weighted_loss: 0.0026, label: 2, bag_size: 312

batch 1899, loss: 0.0016, instance_loss: 0.1417, weighted_loss: 0.0436, label: 3, bag_size: 481

batch 1999, loss: 0.0012, instance_loss: 0.2428, weighted_loss: 0.0737, label: 2, bag_size: 573

batch 2099, loss: 0.0028, instance_loss: 0.2955, weighted_loss: 0.0906, label: 2, bag_size: 729

Instance Classifier Stats

class 0 clustering acc 0.9819412442396314: correct 68186/69440

class 1 clustering acc 0.6079493087557604: correct 10554/17360


Epoch: 19, train_loss: 0.0940, train_clustering_loss:  0.2884

class 0: acc 0.9090909090909091, correct 40/44

class 1: acc 0.9680306905370843, correct 757/782

class 2: acc 0.9751609935602575, correct 1060/1087

class 3: acc 0.933852140077821, correct 240/257


Val Set, val_loss: 1.7094, auc: 0.7242

class 0 clustering acc 0.9611742424242424: correct 8120/8448

class 1 clustering acc 0.4834280303030303: correct 1021/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.71875, correct 69/96

class 2: acc 0.7089552238805971, correct 95/134

class 3: acc 0.3, correct 9/30

Overall Accuracy: 0.6553

Overall F1 Score: 0.4317

Training for coarse level...

batch 99, loss: 0.1606, instance_loss: 0.5638, weighted_loss: 0.2816, label: 3, bag_size: 386

batch 199, loss: 0.0000, instance_loss: 0.5688, weighted_loss: 0.1707, label: 1, bag_size: 193

batch 299, loss: 0.0042, instance_loss: 0.4598, weighted_loss: 0.1409, label: 3, bag_size: 388

batch 399, loss: 0.0191, instance_loss: 0.0191, weighted_loss: 0.0191, label: 2, bag_size: 712

batch 499, loss: 0.0001, instance_loss: 0.1457, weighted_loss: 0.0438, label: 2, bag_size: 665

batch 599, loss: 0.0007, instance_loss: 0.2948, weighted_loss: 0.0889, label: 3, bag_size: 327

batch 699, loss: 0.0044, instance_loss: 0.3938, weighted_loss: 0.1213, label: 1, bag_size: 155

batch 799, loss: 0.0015, instance_loss: 0.5124, weighted_loss: 0.1547, label: 3, bag_size: 309

batch 899, loss: 0.0003, instance_loss: 0.0194, weighted_loss: 0.0060, label: 2, bag_size: 229

batch 999, loss: 0.0000, instance_loss: 0.0067, weighted_loss: 0.0020, label: 1, bag_size: 826

batch 1099, loss: 0.0004, instance_loss: 0.7273, weighted_loss: 0.2185, label: 3, bag_size: 430

batch 1199, loss: 0.0017, instance_loss: 0.2001, weighted_loss: 0.0612, label: 2, bag_size: 276

batch 1299, loss: 0.0000, instance_loss: 0.0583, weighted_loss: 0.0175, label: 2, bag_size: 377

batch 1399, loss: 0.0012, instance_loss: 0.0189, weighted_loss: 0.0065, label: 1, bag_size: 2121

batch 1499, loss: 0.0498, instance_loss: 0.1307, weighted_loss: 0.0741, label: 2, bag_size: 433

batch 1599, loss: 0.0005, instance_loss: 0.0195, weighted_loss: 0.0062, label: 1, bag_size: 2948

batch 1699, loss: 0.0006, instance_loss: 0.5123, weighted_loss: 0.1542, label: 1, bag_size: 161

batch 1799, loss: 0.0003, instance_loss: 0.1395, weighted_loss: 0.0420, label: 2, bag_size: 701

batch 1899, loss: 0.0000, instance_loss: 0.1239, weighted_loss: 0.0372, label: 2, bag_size: 371

batch 1999, loss: 0.0299, instance_loss: 0.1272, weighted_loss: 0.0591, label: 2, bag_size: 905

batch 2099, loss: 0.0030, instance_loss: 0.2614, weighted_loss: 0.0805, label: 2, bag_size: 422

Instance Classifier Stats

class 0 clustering acc 0.9830213133640553: correct 68261/69440

class 1 clustering acc 0.6220046082949309: correct 10798/17360


Epoch: 20, train_loss: 0.0550, train_clustering_loss:  0.2790

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9833759590792839, correct 769/782

class 2: acc 0.9880404783808647, correct 1074/1087

class 3: acc 0.9688715953307393, correct 249/257


Val Set, val_loss: 1.8415, auc: 0.7681

class 0 clustering acc 0.9618844696969697: correct 8126/8448

class 1 clustering acc 0.4805871212121212: correct 1015/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6354166666666666, correct 61/96

class 2: acc 0.7313432835820896, correct 98/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.6250

Overall F1 Score: 0.3951

Training for coarse level...

batch 99, loss: 0.0062, instance_loss: 0.2162, weighted_loss: 0.0692, label: 2, bag_size: 661

batch 199, loss: 0.0001, instance_loss: 0.0171, weighted_loss: 0.0052, label: 2, bag_size: 576

batch 299, loss: 0.0139, instance_loss: 0.1218, weighted_loss: 0.0463, label: 1, bag_size: 1333

batch 399, loss: 0.0159, instance_loss: 0.4241, weighted_loss: 0.1383, label: 1, bag_size: 326

batch 499, loss: 0.0084, instance_loss: 0.2463, weighted_loss: 0.0798, label: 2, bag_size: 555

batch 599, loss: 0.0000, instance_loss: 0.2896, weighted_loss: 0.0869, label: 2, bag_size: 301

batch 699, loss: 0.0004, instance_loss: 0.2441, weighted_loss: 0.0735, label: 1, bag_size: 405

batch 799, loss: 0.0000, instance_loss: 0.0117, weighted_loss: 0.0035, label: 2, bag_size: 180

batch 899, loss: 0.0000, instance_loss: 0.0017, weighted_loss: 0.0005, label: 2, bag_size: 620

batch 999, loss: 0.0001, instance_loss: 0.2388, weighted_loss: 0.0717, label: 2, bag_size: 308

batch 1099, loss: 0.0184, instance_loss: 0.4539, weighted_loss: 0.1491, label: 1, bag_size: 1727

batch 1199, loss: 0.0000, instance_loss: 0.0001, weighted_loss: 0.0000, label: 1, bag_size: 409

batch 1299, loss: 0.0158, instance_loss: 0.1463, weighted_loss: 0.0550, label: 2, bag_size: 333

batch 1399, loss: 0.0020, instance_loss: 0.1388, weighted_loss: 0.0431, label: 1, bag_size: 1523

batch 1499, loss: 0.0000, instance_loss: 0.3999, weighted_loss: 0.1200, label: 1, bag_size: 317

batch 1599, loss: 0.0765, instance_loss: 0.4918, weighted_loss: 0.2011, label: 1, bag_size: 454

batch 1699, loss: 0.0060, instance_loss: 0.0945, weighted_loss: 0.0326, label: 2, bag_size: 448

batch 1799, loss: 0.0004, instance_loss: 0.0680, weighted_loss: 0.0207, label: 1, bag_size: 2085

batch 1899, loss: 0.0038, instance_loss: 0.9380, weighted_loss: 0.2841, label: 3, bag_size: 378

batch 1999, loss: 0.0000, instance_loss: 0.2794, weighted_loss: 0.0838, label: 2, bag_size: 552

batch 2099, loss: 0.0034, instance_loss: 0.0297, weighted_loss: 0.0113, label: 2, bag_size: 854

Instance Classifier Stats

class 0 clustering acc 0.9824164746543779: correct 68219/69440

class 1 clustering acc 0.6211981566820276: correct 10784/17360


Epoch: 21, train_loss: 0.0722, train_clustering_loss:  0.2794

class 0: acc 0.9318181818181818, correct 41/44

class 1: acc 0.9782608695652174, correct 765/782

class 2: acc 0.984360625574977, correct 1070/1087

class 3: acc 0.9649805447470817, correct 248/257


Val Set, val_loss: 1.7758, auc: 0.7427

class 0 clustering acc 0.9593986742424242: correct 8105/8448

class 1 clustering acc 0.4872159090909091: correct 1029/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6979166666666666, correct 67/96

class 2: acc 0.7089552238805971, correct 95/134

class 3: acc 0.16666666666666666, correct 5/30

Overall Accuracy: 0.6326

Overall F1 Score: 0.3928

Training for coarse level...

batch 99, loss: 0.0001, instance_loss: 0.8908, weighted_loss: 0.2673, label: 1, bag_size: 250

batch 199, loss: 0.0000, instance_loss: 0.0781, weighted_loss: 0.0234, label: 1, bag_size: 600

batch 299, loss: 0.0004, instance_loss: 0.0111, weighted_loss: 0.0036, label: 1, bag_size: 1767

batch 399, loss: 0.0000, instance_loss: 0.0104, weighted_loss: 0.0031, label: 2, bag_size: 368

batch 499, loss: 0.0002, instance_loss: 0.5229, weighted_loss: 0.1570, label: 1, bag_size: 119

batch 599, loss: 0.0041, instance_loss: 0.3626, weighted_loss: 0.1116, label: 2, bag_size: 352

batch 699, loss: 0.0056, instance_loss: 0.3370, weighted_loss: 0.1050, label: 3, bag_size: 13

batch 799, loss: 0.0367, instance_loss: 0.4767, weighted_loss: 0.1687, label: 1, bag_size: 185

batch 899, loss: 0.0132, instance_loss: 0.1252, weighted_loss: 0.0468, label: 1, bag_size: 389

batch 999, loss: 0.0137, instance_loss: 0.6845, weighted_loss: 0.2149, label: 1, bag_size: 540

batch 1099, loss: 0.0825, instance_loss: 0.6657, weighted_loss: 0.2575, label: 2, bag_size: 575

batch 1199, loss: 0.0004, instance_loss: 0.5772, weighted_loss: 0.1735, label: 2, bag_size: 310

batch 1299, loss: 0.0024, instance_loss: 0.8851, weighted_loss: 0.2672, label: 1, bag_size: 374

batch 1399, loss: 0.0001, instance_loss: 0.1405, weighted_loss: 0.0422, label: 2, bag_size: 733

batch 1499, loss: 0.0009, instance_loss: 0.2650, weighted_loss: 0.0801, label: 2, bag_size: 75

batch 1599, loss: 0.5151, instance_loss: 0.6944, weighted_loss: 0.5688, label: 1, bag_size: 622

batch 1699, loss: 0.0000, instance_loss: 0.0142, weighted_loss: 0.0043, label: 1, bag_size: 1632

batch 1799, loss: 0.0029, instance_loss: 0.2889, weighted_loss: 0.0887, label: 2, bag_size: 235

batch 1899, loss: 0.0001, instance_loss: 0.0250, weighted_loss: 0.0076, label: 1, bag_size: 2069

batch 1999, loss: 0.0147, instance_loss: 0.6228, weighted_loss: 0.1971, label: 3, bag_size: 527

batch 2099, loss: 0.0001, instance_loss: 0.0519, weighted_loss: 0.0156, label: 2, bag_size: 789

Instance Classifier Stats

class 0 clustering acc 0.9813220046082949: correct 68143/69440

class 1 clustering acc 0.6222350230414746: correct 10802/17360


Epoch: 22, train_loss: 0.1100, train_clustering_loss:  0.2860

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9654731457800512, correct 755/782

class 2: acc 0.9816007359705612, correct 1067/1087

class 3: acc 0.9066147859922179, correct 233/257


Val Set, val_loss: 1.5919, auc: 0.7541

class 0 clustering acc 0.9672111742424242: correct 8171/8448

class 1 clustering acc 0.4550189393939394: correct 961/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6666666666666666, correct 64/96

class 2: acc 0.7164179104477612, correct 96/134

class 3: acc 0.3333333333333333, correct 10/30

Overall Accuracy: 0.6439

Overall F1 Score: 0.4267

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0047, weighted_loss: 0.0014, label: 2, bag_size: 1064

batch 199, loss: 0.0026, instance_loss: 0.3029, weighted_loss: 0.0927, label: 2, bag_size: 293

batch 299, loss: 0.0017, instance_loss: 0.0199, weighted_loss: 0.0072, label: 2, bag_size: 629

batch 399, loss: 0.0000, instance_loss: 0.0078, weighted_loss: 0.0024, label: 2, bag_size: 1161

batch 499, loss: 0.0003, instance_loss: 0.1130, weighted_loss: 0.0341, label: 2, bag_size: 468

batch 599, loss: 0.0004, instance_loss: 0.0451, weighted_loss: 0.0138, label: 1, bag_size: 589

batch 699, loss: 0.6662, instance_loss: 0.1949, weighted_loss: 0.5248, label: 2, bag_size: 221

batch 799, loss: 0.0662, instance_loss: 0.1438, weighted_loss: 0.0895, label: 1, bag_size: 1663

batch 899, loss: 0.0000, instance_loss: 0.0176, weighted_loss: 0.0053, label: 2, bag_size: 475

batch 999, loss: 0.0000, instance_loss: 0.4012, weighted_loss: 0.1204, label: 2, bag_size: 129

batch 1099, loss: 0.0002, instance_loss: 0.3413, weighted_loss: 0.1026, label: 2, bag_size: 473

batch 1199, loss: 0.0009, instance_loss: 0.3135, weighted_loss: 0.0947, label: 2, bag_size: 1865

batch 1299, loss: 0.0017, instance_loss: 1.0435, weighted_loss: 0.3142, label: 1, bag_size: 393

batch 1399, loss: 0.0072, instance_loss: 0.5124, weighted_loss: 0.1588, label: 1, bag_size: 343

batch 1499, loss: 0.0000, instance_loss: 0.0062, weighted_loss: 0.0019, label: 1, bag_size: 1490

batch 1599, loss: 0.0013, instance_loss: 0.2803, weighted_loss: 0.0850, label: 2, bag_size: 604

batch 1699, loss: 0.0000, instance_loss: 0.0285, weighted_loss: 0.0086, label: 2, bag_size: 875

batch 1799, loss: 0.0023, instance_loss: 0.3245, weighted_loss: 0.0989, label: 1, bag_size: 303

batch 1899, loss: 0.0004, instance_loss: 0.0228, weighted_loss: 0.0071, label: 2, bag_size: 515

batch 1999, loss: 0.0006, instance_loss: 0.0523, weighted_loss: 0.0161, label: 2, bag_size: 1547

batch 2099, loss: 0.0011, instance_loss: 0.4707, weighted_loss: 0.1420, label: 1, bag_size: 142

Instance Classifier Stats

class 0 clustering acc 0.9831509216589862: correct 68270/69440

class 1 clustering acc 0.6290898617511521: correct 10921/17360


Epoch: 23, train_loss: 0.0462, train_clustering_loss:  0.2718

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9820971867007673, correct 768/782

class 2: acc 0.9917203311867525, correct 1078/1087

class 3: acc 0.9766536964980544, correct 251/257


Val Set, val_loss: 1.6983, auc: 0.7435

class 0 clustering acc 0.9609375: correct 8118/8448

class 1 clustering acc 0.4758522727272727: correct 1005/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6979166666666666, correct 67/96

class 2: acc 0.7164179104477612, correct 96/134

class 3: acc 0.26666666666666666, correct 8/30

Overall Accuracy: 0.6477

Overall F1 Score: 0.4222

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.3062, weighted_loss: 0.0919, label: 3, bag_size: 172

batch 199, loss: 0.0001, instance_loss: 0.1051, weighted_loss: 0.0316, label: 3, bag_size: 665

batch 299, loss: 0.0022, instance_loss: 0.5233, weighted_loss: 0.1586, label: 3, bag_size: 829

batch 399, loss: 0.0001, instance_loss: 0.3355, weighted_loss: 0.1007, label: 2, bag_size: 248

batch 499, loss: 0.0000, instance_loss: 0.0028, weighted_loss: 0.0008, label: 2, bag_size: 246

batch 599, loss: 0.4212, instance_loss: 0.5633, weighted_loss: 0.4639, label: 1, bag_size: 675

batch 699, loss: 0.0068, instance_loss: 0.3727, weighted_loss: 0.1166, label: 3, bag_size: 830

batch 799, loss: 0.0559, instance_loss: 0.2785, weighted_loss: 0.1227, label: 2, bag_size: 739

batch 899, loss: 0.0005, instance_loss: 0.3187, weighted_loss: 0.0960, label: 2, bag_size: 431

batch 999, loss: 0.0007, instance_loss: 0.1939, weighted_loss: 0.0586, label: 2, bag_size: 209

batch 1099, loss: 0.0002, instance_loss: 0.2705, weighted_loss: 0.0813, label: 2, bag_size: 729

batch 1199, loss: 0.0000, instance_loss: 0.0074, weighted_loss: 0.0022, label: 1, bag_size: 872

batch 1299, loss: 0.0177, instance_loss: 0.6839, weighted_loss: 0.2176, label: 3, bag_size: 1342

batch 1399, loss: 0.0001, instance_loss: 0.3600, weighted_loss: 0.1081, label: 3, bag_size: 120

batch 1499, loss: 0.0000, instance_loss: 0.0265, weighted_loss: 0.0080, label: 2, bag_size: 1064

batch 1599, loss: 0.0001, instance_loss: 0.0236, weighted_loss: 0.0071, label: 2, bag_size: 902

batch 1699, loss: 0.0001, instance_loss: 0.1722, weighted_loss: 0.0518, label: 2, bag_size: 740

batch 1799, loss: 0.0000, instance_loss: 0.2848, weighted_loss: 0.0854, label: 2, bag_size: 220

batch 1899, loss: 0.0001, instance_loss: 0.1187, weighted_loss: 0.0356, label: 2, bag_size: 334

batch 1999, loss: 0.0000, instance_loss: 0.0092, weighted_loss: 0.0028, label: 2, bag_size: 456

batch 2099, loss: 0.0058, instance_loss: 0.1011, weighted_loss: 0.0344, label: 2, bag_size: 460

Instance Classifier Stats

class 0 clustering acc 0.9824020737327189: correct 68218/69440

class 1 clustering acc 0.6441820276497696: correct 11183/17360


Epoch: 24, train_loss: 0.0275, train_clustering_loss:  0.2647

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9923273657289002, correct 776/782

class 2: acc 0.9963201471941122, correct 1083/1087

class 3: acc 0.9922178988326849, correct 255/257


Val Set, val_loss: 2.1941, auc: 0.7382

class 0 clustering acc 0.9573863636363636: correct 8088/8448

class 1 clustering acc 0.48011363636363635: correct 1014/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.7604166666666666, correct 73/96

class 2: acc 0.5895522388059702, correct 79/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.5985

Overall F1 Score: 0.3814

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0032, weighted_loss: 0.0010, label: 1, bag_size: 1204

batch 199, loss: 0.0011, instance_loss: 0.0854, weighted_loss: 0.0264, label: 1, bag_size: 643

batch 299, loss: 0.1525, instance_loss: 0.2504, weighted_loss: 0.1818, label: 2, bag_size: 2046

batch 399, loss: 0.0115, instance_loss: 0.7495, weighted_loss: 0.2329, label: 3, bag_size: 361

batch 499, loss: 0.0001, instance_loss: 0.0126, weighted_loss: 0.0039, label: 2, bag_size: 455

batch 599, loss: 0.0000, instance_loss: 0.1167, weighted_loss: 0.0350, label: 2, bag_size: 597

batch 699, loss: 0.0000, instance_loss: 0.0914, weighted_loss: 0.0274, label: 2, bag_size: 665

batch 799, loss: 0.0255, instance_loss: 0.5532, weighted_loss: 0.1838, label: 3, bag_size: 681

batch 899, loss: 0.0575, instance_loss: 0.1927, weighted_loss: 0.0980, label: 2, bag_size: 843

batch 999, loss: 0.0019, instance_loss: 0.1379, weighted_loss: 0.0427, label: 1, bag_size: 2104

batch 1099, loss: 0.0000, instance_loss: 0.0531, weighted_loss: 0.0159, label: 2, bag_size: 518

batch 1199, loss: 0.0014, instance_loss: 0.5053, weighted_loss: 0.1526, label: 3, bag_size: 249

batch 1299, loss: 0.0002, instance_loss: 0.1493, weighted_loss: 0.0449, label: 2, bag_size: 1897

batch 1399, loss: 0.0045, instance_loss: 0.3971, weighted_loss: 0.1223, label: 2, bag_size: 182

batch 1499, loss: 0.0002, instance_loss: 0.0828, weighted_loss: 0.0250, label: 2, bag_size: 788

batch 1599, loss: 0.0007, instance_loss: 0.2409, weighted_loss: 0.0727, label: 2, bag_size: 235

batch 1699, loss: 0.0000, instance_loss: 0.0288, weighted_loss: 0.0087, label: 2, bag_size: 541

batch 1799, loss: 0.0000, instance_loss: 0.0267, weighted_loss: 0.0080, label: 1, bag_size: 1445

batch 1899, loss: 0.0846, instance_loss: 0.4767, weighted_loss: 0.2022, label: 2, bag_size: 283

batch 1999, loss: 0.0002, instance_loss: 0.3230, weighted_loss: 0.0971, label: 3, bag_size: 2813

batch 2099, loss: 0.0618, instance_loss: 0.4712, weighted_loss: 0.1846, label: 2, bag_size: 608

Instance Classifier Stats

class 0 clustering acc 0.9824740783410139: correct 68223/69440

class 1 clustering acc 0.6379032258064516: correct 11074/17360


Epoch: 25, train_loss: 0.0498, train_clustering_loss:  0.2700

class 0: acc 0.9318181818181818, correct 41/44

class 1: acc 0.9820971867007673, correct 768/782

class 2: acc 0.9908003679852806, correct 1077/1087

class 3: acc 0.9766536964980544, correct 251/257


Val Set, val_loss: 1.7723, auc: 0.7513

class 0 clustering acc 0.9605823863636364: correct 8115/8448

class 1 clustering acc 0.4678030303030303: correct 988/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6041666666666666, correct 58/96

class 2: acc 0.7388059701492538, correct 99/134

class 3: acc 0.36666666666666664, correct 11/30

Overall Accuracy: 0.6364

Overall F1 Score: 0.4299

Training for coarse level...

batch 99, loss: 0.0007, instance_loss: 0.3625, weighted_loss: 0.1093, label: 3, bag_size: 152

batch 199, loss: 0.0171, instance_loss: 0.4997, weighted_loss: 0.1618, label: 1, bag_size: 304

batch 299, loss: 0.0029, instance_loss: 0.0809, weighted_loss: 0.0263, label: 2, bag_size: 330

batch 399, loss: 0.0004, instance_loss: 0.1660, weighted_loss: 0.0501, label: 3, bag_size: 388

batch 499, loss: 0.0000, instance_loss: 0.2304, weighted_loss: 0.0691, label: 2, bag_size: 1004

batch 599, loss: 0.0545, instance_loss: 0.6081, weighted_loss: 0.2206, label: 2, bag_size: 396

batch 699, loss: 0.0304, instance_loss: 0.2464, weighted_loss: 0.0952, label: 2, bag_size: 649

batch 799, loss: 0.0000, instance_loss: 0.1117, weighted_loss: 0.0335, label: 1, bag_size: 204

batch 899, loss: 0.0000, instance_loss: 0.0582, weighted_loss: 0.0175, label: 2, bag_size: 271

batch 999, loss: 0.0000, instance_loss: 0.0029, weighted_loss: 0.0009, label: 1, bag_size: 3615

batch 1099, loss: 0.0072, instance_loss: 0.2875, weighted_loss: 0.0913, label: 2, bag_size: 480

batch 1199, loss: 0.0000, instance_loss: 0.0000, weighted_loss: 0.0000, label: 1, bag_size: 1104

batch 1299, loss: 0.0000, instance_loss: 0.5105, weighted_loss: 0.1532, label: 3, bag_size: 716

batch 1399, loss: 0.0178, instance_loss: 0.0485, weighted_loss: 0.0270, label: 2, bag_size: 225

batch 1499, loss: 0.0058, instance_loss: 0.0354, weighted_loss: 0.0147, label: 1, bag_size: 1323

batch 1599, loss: 0.0000, instance_loss: 0.0253, weighted_loss: 0.0076, label: 2, bag_size: 361

batch 1699, loss: 0.0000, instance_loss: 0.0005, weighted_loss: 0.0001, label: 1, bag_size: 2272

batch 1799, loss: 0.0001, instance_loss: 0.0297, weighted_loss: 0.0090, label: 2, bag_size: 424

batch 1899, loss: 0.0000, instance_loss: 0.0448, weighted_loss: 0.0135, label: 2, bag_size: 843

batch 1999, loss: 0.0001, instance_loss: 0.4933, weighted_loss: 0.1481, label: 3, bag_size: 172

batch 2099, loss: 0.0016, instance_loss: 0.1135, weighted_loss: 0.0352, label: 2, bag_size: 295

Instance Classifier Stats

class 0 clustering acc 0.9815236175115207: correct 68157/69440

class 1 clustering acc 0.6428571428571429: correct 11160/17360


Epoch: 26, train_loss: 0.0608, train_clustering_loss:  0.2690

class 0: acc 1.0, correct 44/44

class 1: acc 0.979539641943734, correct 766/782

class 2: acc 0.984360625574977, correct 1070/1087

class 3: acc 0.9571984435797666, correct 246/257


Val Set, val_loss: 2.0003, auc: 0.6752

class 0 clustering acc 0.9559659090909091: correct 8076/8448

class 1 clustering acc 0.5033143939393939: correct 1063/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6666666666666666, correct 64/96

class 2: acc 0.6940298507462687, correct 93/134

class 3: acc 0.13333333333333333, correct 4/30

Overall Accuracy: 0.6098

Overall F1 Score: 0.3706

Training for coarse level...

batch 99, loss: 0.0001, instance_loss: 0.0176, weighted_loss: 0.0053, label: 1, bag_size: 1628

batch 199, loss: 1.1742, instance_loss: 0.7667, weighted_loss: 1.0519, label: 3, bag_size: 345

batch 299, loss: 0.0000, instance_loss: 0.0094, weighted_loss: 0.0028, label: 2, bag_size: 412

batch 399, loss: 0.0000, instance_loss: 0.0125, weighted_loss: 0.0037, label: 2, bag_size: 658

batch 499, loss: 0.0000, instance_loss: 0.0250, weighted_loss: 0.0075, label: 2, bag_size: 1048

batch 599, loss: 0.8812, instance_loss: 0.3305, weighted_loss: 0.7160, label: 2, bag_size: 396

batch 699, loss: 0.0000, instance_loss: 0.5372, weighted_loss: 0.1612, label: 1, bag_size: 241

batch 799, loss: 0.0047, instance_loss: 0.0156, weighted_loss: 0.0080, label: 1, bag_size: 778

batch 899, loss: 0.0001, instance_loss: 0.2306, weighted_loss: 0.0693, label: 2, bag_size: 1347

batch 999, loss: 0.0002, instance_loss: 0.4874, weighted_loss: 0.1463, label: 3, bag_size: 444

batch 1099, loss: 0.0037, instance_loss: 0.9450, weighted_loss: 0.2861, label: 3, bag_size: 1529

batch 1199, loss: 0.0000, instance_loss: 0.0581, weighted_loss: 0.0174, label: 2, bag_size: 192

batch 1299, loss: 0.0000, instance_loss: 0.1092, weighted_loss: 0.0328, label: 1, bag_size: 53

batch 1399, loss: 0.0002, instance_loss: 0.0241, weighted_loss: 0.0074, label: 2, bag_size: 462

batch 1499, loss: 0.0003, instance_loss: 0.3146, weighted_loss: 0.0946, label: 0, bag_size: 101

batch 1599, loss: 0.0092, instance_loss: 0.3878, weighted_loss: 0.1227, label: 2, bag_size: 483

batch 1699, loss: 0.0000, instance_loss: 0.0066, weighted_loss: 0.0020, label: 1, bag_size: 504

batch 1799, loss: 0.0024, instance_loss: 0.9031, weighted_loss: 0.2726, label: 3, bag_size: 462

batch 1899, loss: 0.0016, instance_loss: 0.0120, weighted_loss: 0.0047, label: 1, bag_size: 1536

batch 1999, loss: 0.0002, instance_loss: 0.1692, weighted_loss: 0.0509, label: 3, bag_size: 288

batch 2099, loss: 0.0000, instance_loss: 0.4432, weighted_loss: 0.1329, label: 2, bag_size: 614

Instance Classifier Stats

class 0 clustering acc 0.98224366359447: correct 68207/69440

class 1 clustering acc 0.6459677419354839: correct 11214/17360


Epoch: 27, train_loss: 0.0379, train_clustering_loss:  0.2656

class 0: acc 1.0, correct 44/44

class 1: acc 0.9910485933503836, correct 775/782

class 2: acc 0.9908003679852806, correct 1077/1087

class 3: acc 0.980544747081712, correct 252/257


Val Set, val_loss: 1.8823, auc: 0.7485

class 0 clustering acc 0.9608191287878788: correct 8117/8448

class 1 clustering acc 0.48295454545454547: correct 1020/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6979166666666666, correct 67/96

class 2: acc 0.6791044776119403, correct 91/134

class 3: acc 0.3333333333333333, correct 10/30

Overall Accuracy: 0.6364

Overall F1 Score: 0.4279

Training for coarse level...

batch 99, loss: 0.0059, instance_loss: 0.5219, weighted_loss: 0.1607, label: 2, bag_size: 206

batch 199, loss: 0.0000, instance_loss: 0.4547, weighted_loss: 0.1364, label: 1, bag_size: 172

batch 299, loss: 0.0000, instance_loss: 0.0109, weighted_loss: 0.0033, label: 2, bag_size: 859

batch 399, loss: 0.0000, instance_loss: 0.0251, weighted_loss: 0.0075, label: 2, bag_size: 601

batch 499, loss: 0.0010, instance_loss: 0.0874, weighted_loss: 0.0269, label: 1, bag_size: 2601

batch 599, loss: 0.0046, instance_loss: 0.2420, weighted_loss: 0.0758, label: 1, bag_size: 1150

batch 699, loss: 0.0000, instance_loss: 0.6424, weighted_loss: 0.1927, label: 1, bag_size: 317

batch 799, loss: 0.0000, instance_loss: 0.0024, weighted_loss: 0.0007, label: 1, bag_size: 496

batch 899, loss: 0.4365, instance_loss: 0.9108, weighted_loss: 0.5788, label: 1, bag_size: 933

batch 999, loss: 0.0000, instance_loss: 0.0209, weighted_loss: 0.0063, label: 2, bag_size: 414

batch 1099, loss: 0.0196, instance_loss: 0.6829, weighted_loss: 0.2186, label: 0, bag_size: 1736

batch 1199, loss: 0.0003, instance_loss: 0.0555, weighted_loss: 0.0168, label: 1, bag_size: 848

batch 1299, loss: 0.0000, instance_loss: 0.0066, weighted_loss: 0.0020, label: 2, bag_size: 761

batch 1399, loss: 0.0000, instance_loss: 0.0054, weighted_loss: 0.0016, label: 1, bag_size: 1067

batch 1499, loss: 2.4535, instance_loss: 1.3194, weighted_loss: 2.1133, label: 1, bag_size: 98

batch 1599, loss: 0.0000, instance_loss: 0.0923, weighted_loss: 0.0277, label: 1, bag_size: 2154

batch 1699, loss: 0.0089, instance_loss: 0.3525, weighted_loss: 0.1120, label: 1, bag_size: 685

batch 1799, loss: 0.0000, instance_loss: 0.3940, weighted_loss: 0.1182, label: 2, bag_size: 246

batch 1899, loss: 0.0004, instance_loss: 0.0696, weighted_loss: 0.0212, label: 2, bag_size: 113

batch 1999, loss: 0.0000, instance_loss: 0.0096, weighted_loss: 0.0029, label: 2, bag_size: 821

batch 2099, loss: 0.0003, instance_loss: 0.5552, weighted_loss: 0.1667, label: 1, bag_size: 187

Instance Classifier Stats

class 0 clustering acc 0.9827620967741936: correct 68243/69440

class 1 clustering acc 0.6508640552995392: correct 11299/17360


Epoch: 28, train_loss: 0.0328, train_clustering_loss:  0.2600

class 0: acc 0.9545454545454546, correct 42/44

class 1: acc 0.989769820971867, correct 774/782

class 2: acc 0.9917203311867525, correct 1078/1087

class 3: acc 0.9766536964980544, correct 251/257


Val Set, val_loss: 2.1306, auc: 0.7278

class 0 clustering acc 0.9580965909090909: correct 8094/8448

class 1 clustering acc 0.47679924242424243: correct 1007/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.7291666666666666, correct 70/96

class 2: acc 0.664179104477612, correct 89/134

class 3: acc 0.26666666666666666, correct 8/30

Overall Accuracy: 0.6326

Overall F1 Score: 0.4087

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.3349, weighted_loss: 0.1005, label: 1, bag_size: 189

batch 199, loss: 0.0011, instance_loss: 0.0509, weighted_loss: 0.0161, label: 1, bag_size: 467

batch 299, loss: 0.0000, instance_loss: 0.0071, weighted_loss: 0.0021, label: 1, bag_size: 488

batch 399, loss: 0.0023, instance_loss: 0.0505, weighted_loss: 0.0167, label: 1, bag_size: 2692

batch 499, loss: 0.0000, instance_loss: 0.0569, weighted_loss: 0.0171, label: 2, bag_size: 473

batch 599, loss: 0.0001, instance_loss: 0.4811, weighted_loss: 0.1444, label: 2, bag_size: 375

batch 699, loss: 0.0018, instance_loss: 0.4324, weighted_loss: 0.1310, label: 2, bag_size: 253

batch 799, loss: 0.0026, instance_loss: 0.0491, weighted_loss: 0.0165, label: 2, bag_size: 381

batch 899, loss: 0.0002, instance_loss: 0.2722, weighted_loss: 0.0818, label: 1, bag_size: 531

batch 999, loss: 0.0006, instance_loss: 0.1011, weighted_loss: 0.0308, label: 1, bag_size: 2170

batch 1099, loss: 0.0000, instance_loss: 0.0749, weighted_loss: 0.0225, label: 2, bag_size: 587

batch 1199, loss: 0.0056, instance_loss: 0.3424, weighted_loss: 0.1066, label: 3, bag_size: 478

batch 1299, loss: 0.0000, instance_loss: 0.1176, weighted_loss: 0.0353, label: 2, bag_size: 225

batch 1399, loss: 0.1444, instance_loss: 0.2939, weighted_loss: 0.1893, label: 2, bag_size: 168

batch 1499, loss: 0.0027, instance_loss: 0.1064, weighted_loss: 0.0338, label: 2, bag_size: 794

batch 1599, loss: 0.0000, instance_loss: 0.0107, weighted_loss: 0.0032, label: 2, bag_size: 274

batch 1699, loss: 4.9372, instance_loss: 0.6906, weighted_loss: 3.6632, label: 1, bag_size: 666

batch 1799, loss: 0.0003, instance_loss: 0.1138, weighted_loss: 0.0343, label: 2, bag_size: 389

batch 1899, loss: 0.0283, instance_loss: 0.7176, weighted_loss: 0.2351, label: 0, bag_size: 220

batch 1999, loss: 0.0000, instance_loss: 0.4003, weighted_loss: 0.1201, label: 3, bag_size: 84

batch 2099, loss: 0.0075, instance_loss: 0.4149, weighted_loss: 0.1298, label: 0, bag_size: 37

Instance Classifier Stats

class 0 clustering acc 0.9832373271889401: correct 68276/69440

class 1 clustering acc 0.6449308755760369: correct 11196/17360


Epoch: 29, train_loss: 0.0560, train_clustering_loss:  0.2628

class 0: acc 1.0, correct 44/44

class 1: acc 0.9808184143222506, correct 767/782

class 2: acc 0.985280588776449, correct 1071/1087

class 3: acc 0.9649805447470817, correct 248/257


Val Set, val_loss: 1.9848, auc: 0.7558

class 0 clustering acc 0.9556107954545454: correct 8073/8448

class 1 clustering acc 0.4805871212121212: correct 1015/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.7604166666666666, correct 73/96

class 2: acc 0.6417910447761194, correct 86/134

class 3: acc 0.16666666666666666, correct 5/30

Overall Accuracy: 0.6212

Overall F1 Score: 0.3875

Training for coarse level...

batch 99, loss: 0.0012, instance_loss: 0.0637, weighted_loss: 0.0200, label: 2, bag_size: 1058

batch 199, loss: 0.0000, instance_loss: 0.0155, weighted_loss: 0.0046, label: 2, bag_size: 888

batch 299, loss: 0.0000, instance_loss: 0.1061, weighted_loss: 0.0318, label: 1, bag_size: 270

batch 399, loss: 0.0049, instance_loss: 0.2802, weighted_loss: 0.0875, label: 2, bag_size: 509

batch 499, loss: 0.0014, instance_loss: 0.2833, weighted_loss: 0.0860, label: 2, bag_size: 921

batch 599, loss: 0.0139, instance_loss: 0.4634, weighted_loss: 0.1487, label: 3, bag_size: 22

batch 699, loss: 0.0012, instance_loss: 0.6218, weighted_loss: 0.1874, label: 1, bag_size: 356

batch 799, loss: 0.0162, instance_loss: 0.4141, weighted_loss: 0.1356, label: 3, bag_size: 756

batch 899, loss: 0.0023, instance_loss: 0.7058, weighted_loss: 0.2134, label: 3, bag_size: 338

batch 999, loss: 0.0000, instance_loss: 0.0172, weighted_loss: 0.0051, label: 1, bag_size: 897

batch 1099, loss: 0.0002, instance_loss: 0.1209, weighted_loss: 0.0364, label: 2, bag_size: 316

batch 1199, loss: 0.0000, instance_loss: 0.2361, weighted_loss: 0.0708, label: 2, bag_size: 735

batch 1299, loss: 0.0000, instance_loss: 0.0045, weighted_loss: 0.0013, label: 1, bag_size: 1460

batch 1399, loss: 0.0000, instance_loss: 0.0452, weighted_loss: 0.0136, label: 2, bag_size: 422

batch 1499, loss: 0.0004, instance_loss: 0.1716, weighted_loss: 0.0518, label: 2, bag_size: 789

batch 1599, loss: 0.0001, instance_loss: 0.1880, weighted_loss: 0.0565, label: 1, bag_size: 607

batch 1699, loss: 0.0007, instance_loss: 0.0566, weighted_loss: 0.0175, label: 2, bag_size: 287

batch 1799, loss: 0.0000, instance_loss: 0.0668, weighted_loss: 0.0200, label: 2, bag_size: 394

batch 1899, loss: 0.0047, instance_loss: 0.2857, weighted_loss: 0.0890, label: 2, bag_size: 1549

batch 1999, loss: 0.0000, instance_loss: 0.0085, weighted_loss: 0.0026, label: 1, bag_size: 480

batch 2099, loss: 0.0000, instance_loss: 0.0024, weighted_loss: 0.0007, label: 2, bag_size: 635

Instance Classifier Stats

class 0 clustering acc 0.9826036866359447: correct 68232/69440

class 1 clustering acc 0.6535714285714286: correct 11346/17360


Epoch: 30, train_loss: 0.0461, train_clustering_loss:  0.2611

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9820971867007673, correct 768/782

class 2: acc 0.9898804047838087, correct 1076/1087

class 3: acc 0.9844357976653697, correct 253/257


Val Set, val_loss: 2.3096, auc: 0.7281

class 0 clustering acc 0.9558475378787878: correct 8075/8448

class 1 clustering acc 0.4815340909090909: correct 1017/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.71875, correct 69/96

class 2: acc 0.664179104477612, correct 89/134

class 3: acc 0.03333333333333333, correct 1/30

Overall Accuracy: 0.6023

Overall F1 Score: 0.3365

Training for coarse level...

batch 99, loss: 0.0004, instance_loss: 0.5595, weighted_loss: 0.1681, label: 1, bag_size: 186

batch 199, loss: 0.0000, instance_loss: 0.6953, weighted_loss: 0.2086, label: 1, bag_size: 2059

batch 299, loss: 0.0040, instance_loss: 0.2372, weighted_loss: 0.0740, label: 2, bag_size: 333

batch 399, loss: 0.0002, instance_loss: 0.4187, weighted_loss: 0.1258, label: 2, bag_size: 129

batch 499, loss: 0.0000, instance_loss: 0.1255, weighted_loss: 0.0377, label: 2, bag_size: 850

batch 599, loss: 0.0000, instance_loss: 0.2837, weighted_loss: 0.0851, label: 1, bag_size: 1223

batch 699, loss: 0.0165, instance_loss: 0.1576, weighted_loss: 0.0588, label: 1, bag_size: 1727

batch 799, loss: 0.0000, instance_loss: 0.0219, weighted_loss: 0.0066, label: 2, bag_size: 875

batch 899, loss: 0.0000, instance_loss: 0.0448, weighted_loss: 0.0134, label: 2, bag_size: 232

batch 999, loss: 0.0001, instance_loss: 0.6336, weighted_loss: 0.1901, label: 3, bag_size: 201

batch 1099, loss: 0.0748, instance_loss: 0.8208, weighted_loss: 0.2986, label: 3, bag_size: 829

batch 1199, loss: 0.1793, instance_loss: 0.4878, weighted_loss: 0.2719, label: 1, bag_size: 377

batch 1299, loss: 0.0000, instance_loss: 0.1748, weighted_loss: 0.0524, label: 3, bag_size: 452

batch 1399, loss: 0.0004, instance_loss: 0.3410, weighted_loss: 0.1026, label: 2, bag_size: 929

batch 1499, loss: 0.0000, instance_loss: 0.0229, weighted_loss: 0.0069, label: 2, bag_size: 495

batch 1599, loss: 0.0000, instance_loss: 0.0120, weighted_loss: 0.0036, label: 2, bag_size: 645

batch 1699, loss: 0.0000, instance_loss: 0.5830, weighted_loss: 0.1749, label: 1, bag_size: 394

batch 1799, loss: 0.0003, instance_loss: 0.0265, weighted_loss: 0.0081, label: 2, bag_size: 362

batch 1899, loss: 0.0000, instance_loss: 0.0216, weighted_loss: 0.0065, label: 1, bag_size: 1535

batch 1999, loss: 0.0006, instance_loss: 0.1560, weighted_loss: 0.0472, label: 2, bag_size: 574

batch 2099, loss: 0.0000, instance_loss: 0.3257, weighted_loss: 0.0977, label: 2, bag_size: 276

Instance Classifier Stats

class 0 clustering acc 0.9828052995391705: correct 68246/69440

class 1 clustering acc 0.6644585253456221: correct 11535/17360


Epoch: 31, train_loss: 0.0315, train_clustering_loss:  0.2544

class 0: acc 1.0, correct 44/44

class 1: acc 0.9859335038363172, correct 771/782

class 2: acc 0.9926402943882244, correct 1079/1087

class 3: acc 0.980544747081712, correct 252/257


Val Set, val_loss: 2.1446, auc: 0.7490

class 0 clustering acc 0.9578598484848485: correct 8092/8448

class 1 clustering acc 0.48295454545454547: correct 1020/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.71875, correct 69/96

class 2: acc 0.6343283582089553, correct 85/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.6061

Overall F1 Score: 0.3844

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0090, weighted_loss: 0.0027, label: 1, bag_size: 873

batch 199, loss: 0.0083, instance_loss: 0.4290, weighted_loss: 0.1345, label: 2, bag_size: 243

batch 299, loss: 0.0000, instance_loss: 0.1285, weighted_loss: 0.0385, label: 2, bag_size: 636

batch 399, loss: 0.0000, instance_loss: 0.0586, weighted_loss: 0.0176, label: 1, bag_size: 1323

batch 499, loss: 0.0000, instance_loss: 0.0238, weighted_loss: 0.0072, label: 1, bag_size: 975

batch 599, loss: 0.0002, instance_loss: 0.5130, weighted_loss: 0.1541, label: 1, bag_size: 568

batch 699, loss: 0.0000, instance_loss: 0.0050, weighted_loss: 0.0015, label: 2, bag_size: 208

batch 799, loss: 0.0000, instance_loss: 0.0274, weighted_loss: 0.0082, label: 2, bag_size: 352

batch 899, loss: 0.0025, instance_loss: 0.0166, weighted_loss: 0.0067, label: 2, bag_size: 563

batch 999, loss: 0.0001, instance_loss: 0.3791, weighted_loss: 0.1138, label: 2, bag_size: 621

batch 1099, loss: 0.0055, instance_loss: 0.3101, weighted_loss: 0.0969, label: 2, bag_size: 667

batch 1199, loss: 0.0000, instance_loss: 0.0181, weighted_loss: 0.0054, label: 2, bag_size: 246

batch 1299, loss: 0.0012, instance_loss: 0.0692, weighted_loss: 0.0216, label: 1, bag_size: 2086

batch 1399, loss: 0.0000, instance_loss: 0.7157, weighted_loss: 0.2147, label: 1, bag_size: 1860

batch 1499, loss: 0.0000, instance_loss: 0.0163, weighted_loss: 0.0049, label: 2, bag_size: 576

batch 1599, loss: 0.0000, instance_loss: 0.4729, weighted_loss: 0.1419, label: 2, bag_size: 106

batch 1699, loss: 0.0000, instance_loss: 0.0965, weighted_loss: 0.0290, label: 2, bag_size: 266

batch 1799, loss: 0.0003, instance_loss: 0.0268, weighted_loss: 0.0083, label: 2, bag_size: 290

batch 1899, loss: 0.0000, instance_loss: 0.5972, weighted_loss: 0.1792, label: 3, bag_size: 383

batch 1999, loss: 0.0000, instance_loss: 0.4424, weighted_loss: 0.1328, label: 0, bag_size: 119

batch 2099, loss: 0.0000, instance_loss: 0.2432, weighted_loss: 0.0730, label: 2, bag_size: 483

Instance Classifier Stats

class 0 clustering acc 0.9834821428571429: correct 68293/69440

class 1 clustering acc 0.6685483870967742: correct 11606/17360


Epoch: 32, train_loss: 0.0256, train_clustering_loss:  0.2520

class 0: acc 0.9545454545454546, correct 42/44

class 1: acc 0.9923273657289002, correct 776/782

class 2: acc 0.9944802207911684, correct 1081/1087

class 3: acc 0.9922178988326849, correct 255/257


Val Set, val_loss: 2.0284, auc: 0.7332

class 0 clustering acc 0.9605823863636364: correct 8115/8448

class 1 clustering acc 0.45549242424242425: correct 962/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6770833333333334, correct 65/96

class 2: acc 0.6791044776119403, correct 91/134

class 3: acc 0.13333333333333333, correct 4/30

Overall Accuracy: 0.6061

Overall F1 Score: 0.3691

Training for coarse level...

batch 99, loss: 0.0001, instance_loss: 0.0551, weighted_loss: 0.0166, label: 2, bag_size: 216

batch 199, loss: 0.0007, instance_loss: 0.2660, weighted_loss: 0.0803, label: 1, bag_size: 1744

batch 299, loss: 0.0009, instance_loss: 0.3676, weighted_loss: 0.1109, label: 1, bag_size: 347

batch 399, loss: 0.0037, instance_loss: 0.4356, weighted_loss: 0.1333, label: 2, bag_size: 115

batch 499, loss: 0.0000, instance_loss: 0.3331, weighted_loss: 0.0999, label: 2, bag_size: 589

batch 599, loss: 0.0027, instance_loss: 0.1867, weighted_loss: 0.0579, label: 2, bag_size: 108

batch 699, loss: 0.0000, instance_loss: 0.0571, weighted_loss: 0.0172, label: 1, bag_size: 379

batch 799, loss: 0.0000, instance_loss: 0.5973, weighted_loss: 0.1792, label: 1, bag_size: 471

batch 899, loss: 0.0000, instance_loss: 0.0008, weighted_loss: 0.0002, label: 1, bag_size: 897

batch 999, loss: 0.0088, instance_loss: 0.8962, weighted_loss: 0.2751, label: 1, bag_size: 356

batch 1099, loss: 0.0004, instance_loss: 1.3812, weighted_loss: 0.4146, label: 3, bag_size: 328

batch 1199, loss: 0.0014, instance_loss: 0.5164, weighted_loss: 0.1559, label: 0, bag_size: 198

batch 1299, loss: 0.0000, instance_loss: 0.3655, weighted_loss: 0.1097, label: 2, bag_size: 687

batch 1399, loss: 0.0810, instance_loss: 0.5002, weighted_loss: 0.2067, label: 2, bag_size: 808

batch 1499, loss: 0.0000, instance_loss: 0.1889, weighted_loss: 0.0567, label: 1, bag_size: 749

batch 1599, loss: 0.0002, instance_loss: 0.0266, weighted_loss: 0.0081, label: 2, bag_size: 1015

batch 1699, loss: 0.0000, instance_loss: 0.1063, weighted_loss: 0.0319, label: 2, bag_size: 1140

batch 1799, loss: 0.0007, instance_loss: 0.0278, weighted_loss: 0.0088, label: 2, bag_size: 559

batch 1899, loss: 0.0000, instance_loss: 0.0312, weighted_loss: 0.0094, label: 2, bag_size: 318

batch 1999, loss: 0.0095, instance_loss: 0.1301, weighted_loss: 0.0457, label: 2, bag_size: 677

batch 2099, loss: 0.0000, instance_loss: 0.3432, weighted_loss: 0.1030, label: 1, bag_size: 746

Instance Classifier Stats

class 0 clustering acc 0.9824164746543779: correct 68219/69440

class 1 clustering acc 0.6676843317972351: correct 11591/17360


Epoch: 33, train_loss: 0.0308, train_clustering_loss:  0.2537

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9872122762148338, correct 772/782

class 2: acc 0.9954001839926403, correct 1082/1087

class 3: acc 0.9844357976653697, correct 253/257


Val Set, val_loss: 2.1198, auc: 0.7492

class 0 clustering acc 0.9504024621212122: correct 8029/8448

class 1 clustering acc 0.5203598484848485: correct 1099/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.5520833333333334, correct 53/96

class 2: acc 0.8432835820895522, correct 113/134

class 3: acc 0.23333333333333334, correct 7/30

Overall Accuracy: 0.6553

Overall F1 Score: 0.4195

Training for coarse level...

batch 99, loss: 0.0356, instance_loss: 0.0578, weighted_loss: 0.0422, label: 2, bag_size: 403

batch 199, loss: 0.0000, instance_loss: 0.3377, weighted_loss: 0.1013, label: 2, bag_size: 802

batch 299, loss: 0.0001, instance_loss: 0.5861, weighted_loss: 0.1759, label: 2, bag_size: 228

batch 399, loss: 0.0000, instance_loss: 0.0400, weighted_loss: 0.0120, label: 1, bag_size: 749

batch 499, loss: 0.0002, instance_loss: 0.0425, weighted_loss: 0.0129, label: 2, bag_size: 1049

batch 599, loss: 0.0008, instance_loss: 0.0856, weighted_loss: 0.0263, label: 1, bag_size: 927

batch 699, loss: 0.0000, instance_loss: 0.1197, weighted_loss: 0.0359, label: 2, bag_size: 369

batch 799, loss: 0.0001, instance_loss: 0.4217, weighted_loss: 0.1266, label: 3, bag_size: 710

batch 899, loss: 0.0003, instance_loss: 0.8253, weighted_loss: 0.2478, label: 0, bag_size: 260

batch 999, loss: 0.0050, instance_loss: 0.4851, weighted_loss: 0.1490, label: 1, bag_size: 622

batch 1099, loss: 0.0001, instance_loss: 0.0144, weighted_loss: 0.0044, label: 2, bag_size: 1222

batch 1199, loss: 0.0000, instance_loss: 0.0055, weighted_loss: 0.0017, label: 1, bag_size: 309

batch 1299, loss: 0.0000, instance_loss: 0.3475, weighted_loss: 0.1042, label: 2, bag_size: 926

batch 1399, loss: 0.0000, instance_loss: 0.0025, weighted_loss: 0.0008, label: 1, bag_size: 941

batch 1499, loss: 0.0006, instance_loss: 0.4035, weighted_loss: 0.1214, label: 2, bag_size: 471

batch 1599, loss: 0.0000, instance_loss: 0.0344, weighted_loss: 0.0103, label: 2, bag_size: 896

batch 1699, loss: 0.0001, instance_loss: 0.2431, weighted_loss: 0.0730, label: 2, bag_size: 201

batch 1799, loss: 0.0000, instance_loss: 0.0005, weighted_loss: 0.0002, label: 1, bag_size: 2213

batch 1899, loss: 0.0001, instance_loss: 0.4313, weighted_loss: 0.1295, label: 2, bag_size: 890

batch 1999, loss: 0.0000, instance_loss: 0.0245, weighted_loss: 0.0074, label: 1, bag_size: 298

batch 2099, loss: 0.0000, instance_loss: 0.0029, weighted_loss: 0.0009, label: 1, bag_size: 1981

Instance Classifier Stats

class 0 clustering acc 0.9827908986175116: correct 68245/69440

class 1 clustering acc 0.6766705069124423: correct 11747/17360


Epoch: 34, train_loss: 0.0394, train_clustering_loss:  0.2477

class 0: acc 1.0, correct 44/44

class 1: acc 0.989769820971867, correct 774/782

class 2: acc 0.985280588776449, correct 1071/1087

class 3: acc 0.9844357976653697, correct 253/257


Val Set, val_loss: 2.2982, auc: 0.7002

class 0 clustering acc 0.9538352272727273: correct 8058/8448

class 1 clustering acc 0.4493371212121212: correct 949/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.5104166666666666, correct 49/96

class 2: acc 0.7761194029850746, correct 104/134

class 3: acc 0.26666666666666666, correct 8/30

Overall Accuracy: 0.6098

Overall F1 Score: 0.3909

Training for coarse level...

batch 99, loss: 0.0014, instance_loss: 0.2289, weighted_loss: 0.0697, label: 3, bag_size: 464

batch 199, loss: 0.0042, instance_loss: 0.0119, weighted_loss: 0.0065, label: 1, bag_size: 1189

batch 299, loss: 0.0000, instance_loss: 0.0169, weighted_loss: 0.0051, label: 2, bag_size: 328

batch 399, loss: 0.0000, instance_loss: 0.0254, weighted_loss: 0.0076, label: 2, bag_size: 601

batch 499, loss: 0.0071, instance_loss: 0.2436, weighted_loss: 0.0781, label: 1, bag_size: 483

batch 599, loss: 0.0001, instance_loss: 0.0388, weighted_loss: 0.0117, label: 1, bag_size: 447

batch 699, loss: 0.0094, instance_loss: 0.4935, weighted_loss: 0.1546, label: 1, bag_size: 167

batch 799, loss: 0.0004, instance_loss: 0.0792, weighted_loss: 0.0240, label: 2, bag_size: 620

batch 899, loss: 0.0050, instance_loss: 0.7462, weighted_loss: 0.2274, label: 1, bag_size: 486

batch 999, loss: 0.0000, instance_loss: 0.0010, weighted_loss: 0.0003, label: 1, bag_size: 1692

batch 1099, loss: 0.0000, instance_loss: 0.0041, weighted_loss: 0.0012, label: 2, bag_size: 323

batch 1199, loss: 0.0000, instance_loss: 0.0557, weighted_loss: 0.0167, label: 2, bag_size: 209

batch 1299, loss: 0.0002, instance_loss: 0.7716, weighted_loss: 0.2316, label: 0, bag_size: 207

batch 1399, loss: 0.0000, instance_loss: 0.0428, weighted_loss: 0.0128, label: 1, bag_size: 427

batch 1499, loss: 0.0009, instance_loss: 0.2067, weighted_loss: 0.0626, label: 2, bag_size: 718

batch 1599, loss: 0.0155, instance_loss: 0.3812, weighted_loss: 0.1252, label: 1, bag_size: 78

batch 1699, loss: 0.0055, instance_loss: 0.5712, weighted_loss: 0.1752, label: 3, bag_size: 868

batch 1799, loss: 0.0000, instance_loss: 0.0000, weighted_loss: 0.0000, label: 1, bag_size: 847

batch 1899, loss: 0.0000, instance_loss: 0.4853, weighted_loss: 0.1456, label: 2, bag_size: 770

batch 1999, loss: 0.0000, instance_loss: 0.1225, weighted_loss: 0.0367, label: 2, bag_size: 310

batch 2099, loss: 0.0000, instance_loss: 0.1955, weighted_loss: 0.0587, label: 2, bag_size: 1836

Instance Classifier Stats

class 0 clustering acc 0.983395737327189: correct 68287/69440

class 1 clustering acc 0.6830645161290323: correct 11858/17360


Epoch: 35, train_loss: 0.0178, train_clustering_loss:  0.2432

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9961636828644501, correct 779/782

class 2: acc 0.9944802207911684, correct 1081/1087

class 3: acc 0.9883268482490273, correct 254/257


Val Set, val_loss: 2.3818, auc: 0.7406

class 0 clustering acc 0.9614109848484849: correct 8122/8448

class 1 clustering acc 0.4583333333333333: correct 968/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6666666666666666, correct 64/96

class 2: acc 0.6343283582089553, correct 85/134

class 3: acc 0.4666666666666667, correct 14/30

Overall Accuracy: 0.6174

Overall F1 Score: 0.4272

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0185, weighted_loss: 0.0056, label: 2, bag_size: 2114

batch 199, loss: 0.0000, instance_loss: 0.0186, weighted_loss: 0.0056, label: 1, bag_size: 298

batch 299, loss: 0.0001, instance_loss: 0.0485, weighted_loss: 0.0146, label: 2, bag_size: 679

batch 399, loss: 0.0001, instance_loss: 0.0198, weighted_loss: 0.0060, label: 1, bag_size: 570

batch 499, loss: 0.0000, instance_loss: 0.4276, weighted_loss: 0.1283, label: 3, bag_size: 901

batch 599, loss: 0.0003, instance_loss: 0.0583, weighted_loss: 0.0177, label: 1, bag_size: 673

batch 699, loss: 0.0000, instance_loss: 0.1688, weighted_loss: 0.0506, label: 2, bag_size: 308

batch 799, loss: 0.0001, instance_loss: 0.0437, weighted_loss: 0.0132, label: 2, bag_size: 1217

batch 899, loss: 0.0000, instance_loss: 0.0000, weighted_loss: 0.0000, label: 1, bag_size: 2219

batch 999, loss: 0.0065, instance_loss: 0.1691, weighted_loss: 0.0552, label: 2, bag_size: 298

batch 1099, loss: 0.0000, instance_loss: 0.2319, weighted_loss: 0.0696, label: 3, bag_size: 179

batch 1199, loss: 0.0000, instance_loss: 0.4743, weighted_loss: 0.1423, label: 1, bag_size: 37

batch 1299, loss: 0.0000, instance_loss: 0.5339, weighted_loss: 0.1602, label: 1, bag_size: 1061

batch 1399, loss: 0.0000, instance_loss: 0.0053, weighted_loss: 0.0016, label: 2, bag_size: 987

batch 1499, loss: 0.0184, instance_loss: 0.3294, weighted_loss: 0.1117, label: 1, bag_size: 258

batch 1599, loss: 0.0004, instance_loss: 0.1880, weighted_loss: 0.0567, label: 1, bag_size: 381

batch 1699, loss: 0.0003, instance_loss: 0.1021, weighted_loss: 0.0308, label: 2, bag_size: 1364

batch 1799, loss: 0.0000, instance_loss: 0.0059, weighted_loss: 0.0018, label: 2, bag_size: 341

batch 1899, loss: 0.0002, instance_loss: 0.2268, weighted_loss: 0.0682, label: 0, bag_size: 101

batch 1999, loss: 0.0000, instance_loss: 0.8091, weighted_loss: 0.2427, label: 0, bag_size: 1452

batch 2099, loss: 0.0002, instance_loss: 0.0221, weighted_loss: 0.0068, label: 2, bag_size: 336

Instance Classifier Stats

class 0 clustering acc 0.9837989631336406: correct 68315/69440

class 1 clustering acc 0.691647465437788: correct 12007/17360


Epoch: 36, train_loss: 0.0141, train_clustering_loss:  0.2370

class 0: acc 0.9545454545454546, correct 42/44

class 1: acc 0.9974424552429667, correct 780/782

class 2: acc 0.9963201471941122, correct 1083/1087

class 3: acc 0.9883268482490273, correct 254/257


Val Set, val_loss: 2.4224, auc: 0.7201

class 0 clustering acc 0.9505208333333334: correct 8030/8448

class 1 clustering acc 0.4758522727272727: correct 1005/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.65625, correct 63/96

class 2: acc 0.7238805970149254, correct 97/134

class 3: acc 0.3, correct 9/30

Overall Accuracy: 0.6402

Overall F1 Score: 0.4206

Training for coarse level...

batch 99, loss: 0.0017, instance_loss: 0.3706, weighted_loss: 0.1123, label: 1, bag_size: 1860

batch 199, loss: 0.0000, instance_loss: 0.6370, weighted_loss: 0.1911, label: 1, bag_size: 1061

batch 299, loss: 0.0000, instance_loss: 0.0246, weighted_loss: 0.0074, label: 1, bag_size: 244

batch 399, loss: 0.0000, instance_loss: 0.1404, weighted_loss: 0.0421, label: 1, bag_size: 410

batch 499, loss: 0.0018, instance_loss: 0.7659, weighted_loss: 0.2310, label: 1, bag_size: 566

batch 599, loss: 0.0003, instance_loss: 0.4534, weighted_loss: 0.1363, label: 2, bag_size: 376

batch 699, loss: 0.0007, instance_loss: 0.3629, weighted_loss: 0.1093, label: 1, bag_size: 305

batch 799, loss: 0.0000, instance_loss: 0.1052, weighted_loss: 0.0315, label: 2, bag_size: 274

batch 899, loss: 0.0000, instance_loss: 0.5053, weighted_loss: 0.1516, label: 1, bag_size: 298

batch 999, loss: 0.0002, instance_loss: 0.1081, weighted_loss: 0.0326, label: 1, bag_size: 1323

batch 1099, loss: 0.0000, instance_loss: 0.0117, weighted_loss: 0.0035, label: 2, bag_size: 518

batch 1199, loss: 0.0000, instance_loss: 0.0046, weighted_loss: 0.0014, label: 2, bag_size: 389

batch 1299, loss: 0.0001, instance_loss: 0.0919, weighted_loss: 0.0276, label: 2, bag_size: 206

batch 1399, loss: 0.0000, instance_loss: 0.2252, weighted_loss: 0.0676, label: 2, bag_size: 344

batch 1499, loss: 0.0000, instance_loss: 0.1740, weighted_loss: 0.0522, label: 1, bag_size: 517

batch 1599, loss: 0.0000, instance_loss: 0.0061, weighted_loss: 0.0018, label: 2, bag_size: 475

batch 1699, loss: 0.0000, instance_loss: 0.0093, weighted_loss: 0.0028, label: 2, bag_size: 844

batch 1799, loss: 6.8913, instance_loss: 0.6837, weighted_loss: 5.0290, label: 1, bag_size: 575

batch 1899, loss: 0.0002, instance_loss: 0.3429, weighted_loss: 0.1030, label: 2, bag_size: 270

batch 1999, loss: 0.0000, instance_loss: 0.5593, weighted_loss: 0.1678, label: 3, bag_size: 417

batch 2099, loss: 0.0000, instance_loss: 0.6621, weighted_loss: 0.1986, label: 2, bag_size: 304

Instance Classifier Stats

class 0 clustering acc 0.983280529953917: correct 68279/69440

class 1 clustering acc 0.6914170506912443: correct 12003/17360


Epoch: 37, train_loss: 0.0362, train_clustering_loss:  0.2395

class 0: acc 0.9318181818181818, correct 41/44

class 1: acc 0.9846547314578005, correct 770/782

class 2: acc 0.9908003679852806, correct 1077/1087

class 3: acc 0.9844357976653697, correct 253/257


Val Set, val_loss: 2.0876, auc: 0.7200

class 0 clustering acc 0.9530066287878788: correct 8051/8448

class 1 clustering acc 0.4933712121212121: correct 1042/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.625, correct 60/96

class 2: acc 0.7164179104477612, correct 96/134

class 3: acc 0.3, correct 9/30

Overall Accuracy: 0.6250

Overall F1 Score: 0.4169

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.1997, weighted_loss: 0.0599, label: 1, bag_size: 65

batch 199, loss: 0.0001, instance_loss: 0.9651, weighted_loss: 0.2896, label: 0, bag_size: 220

batch 299, loss: 0.0000, instance_loss: 0.0140, weighted_loss: 0.0042, label: 2, bag_size: 216

batch 399, loss: 0.0000, instance_loss: 0.8923, weighted_loss: 0.2677, label: 1, bag_size: 339

batch 499, loss: 0.0001, instance_loss: 0.1703, weighted_loss: 0.0512, label: 2, bag_size: 267

batch 599, loss: 0.0000, instance_loss: 0.3276, weighted_loss: 0.0983, label: 2, bag_size: 333

batch 699, loss: 0.0000, instance_loss: 0.2949, weighted_loss: 0.0885, label: 1, bag_size: 738

batch 799, loss: 0.0028, instance_loss: 0.2422, weighted_loss: 0.0747, label: 2, bag_size: 235

batch 899, loss: 0.0000, instance_loss: 0.1730, weighted_loss: 0.0519, label: 2, bag_size: 605

batch 999, loss: 0.0000, instance_loss: 0.8596, weighted_loss: 0.2579, label: 1, bag_size: 983

batch 1099, loss: 0.0000, instance_loss: 0.2919, weighted_loss: 0.0876, label: 2, bag_size: 243

batch 1199, loss: 0.0000, instance_loss: 0.0588, weighted_loss: 0.0176, label: 1, bag_size: 457

batch 1299, loss: 0.0043, instance_loss: 0.6904, weighted_loss: 0.2102, label: 1, bag_size: 953

batch 1399, loss: 0.0000, instance_loss: 0.4265, weighted_loss: 0.1280, label: 2, bag_size: 463

batch 1499, loss: 0.0002, instance_loss: 0.0784, weighted_loss: 0.0236, label: 2, bag_size: 290

batch 1599, loss: 0.0000, instance_loss: 0.0082, weighted_loss: 0.0025, label: 1, bag_size: 1211

batch 1699, loss: 0.0004, instance_loss: 0.1205, weighted_loss: 0.0364, label: 2, bag_size: 714

batch 1799, loss: 0.0001, instance_loss: 0.3975, weighted_loss: 0.1193, label: 1, bag_size: 119

batch 1899, loss: 0.0044, instance_loss: 0.4870, weighted_loss: 0.1492, label: 2, bag_size: 497

batch 1999, loss: 0.0000, instance_loss: 0.2392, weighted_loss: 0.0718, label: 2, bag_size: 850

batch 2099, loss: 0.0002, instance_loss: 0.0698, weighted_loss: 0.0211, label: 2, bag_size: 712

Instance Classifier Stats

class 0 clustering acc 0.9845046082949309: correct 68364/69440

class 1 clustering acc 0.6995967741935484: correct 12145/17360


Epoch: 38, train_loss: 0.0239, train_clustering_loss:  0.2316

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9974424552429667, correct 780/782

class 2: acc 0.9944802207911684, correct 1081/1087

class 3: acc 0.9766536964980544, correct 251/257


Val Set, val_loss: 2.4125, auc: 0.7369

class 0 clustering acc 0.9544270833333334: correct 8063/8448

class 1 clustering acc 0.4810606060606061: correct 1016/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6979166666666666, correct 67/96

class 2: acc 0.7238805970149254, correct 97/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.6439

Overall F1 Score: 0.4064

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0269, weighted_loss: 0.0081, label: 2, bag_size: 521

batch 199, loss: 0.0000, instance_loss: 0.1521, weighted_loss: 0.0456, label: 2, bag_size: 1479

batch 299, loss: 0.0000, instance_loss: 0.0087, weighted_loss: 0.0026, label: 2, bag_size: 326

batch 399, loss: 0.0015, instance_loss: 0.0291, weighted_loss: 0.0098, label: 2, bag_size: 532

batch 499, loss: 0.0000, instance_loss: 0.4592, weighted_loss: 0.1378, label: 1, bag_size: 168

batch 599, loss: 0.0000, instance_loss: 0.0403, weighted_loss: 0.0121, label: 1, bag_size: 1616

batch 699, loss: 0.0000, instance_loss: 0.2585, weighted_loss: 0.0776, label: 3, bag_size: 574

batch 799, loss: 0.0378, instance_loss: 1.0135, weighted_loss: 0.3305, label: 3, bag_size: 333

batch 899, loss: 0.0000, instance_loss: 0.0261, weighted_loss: 0.0078, label: 2, bag_size: 346

batch 999, loss: 0.0000, instance_loss: 0.2564, weighted_loss: 0.0769, label: 1, bag_size: 190

batch 1099, loss: 0.0000, instance_loss: 0.1841, weighted_loss: 0.0552, label: 3, bag_size: 1274

batch 1199, loss: 0.0002, instance_loss: 0.0930, weighted_loss: 0.0281, label: 2, bag_size: 619

batch 1299, loss: 0.0000, instance_loss: 0.1394, weighted_loss: 0.0418, label: 1, bag_size: 287

batch 1399, loss: 0.0001, instance_loss: 0.6511, weighted_loss: 0.1954, label: 2, bag_size: 489

batch 1499, loss: 0.0086, instance_loss: 0.4402, weighted_loss: 0.1381, label: 2, bag_size: 643

batch 1599, loss: 0.0000, instance_loss: 0.1091, weighted_loss: 0.0327, label: 2, bag_size: 605

batch 1699, loss: 0.0000, instance_loss: 0.0717, weighted_loss: 0.0215, label: 2, bag_size: 366

batch 1799, loss: 0.0000, instance_loss: 0.0757, weighted_loss: 0.0227, label: 2, bag_size: 1064

batch 1899, loss: 0.0000, instance_loss: 0.5136, weighted_loss: 0.1541, label: 3, bag_size: 344

batch 1999, loss: 0.0000, instance_loss: 0.0698, weighted_loss: 0.0210, label: 1, bag_size: 457

batch 2099, loss: 0.0000, instance_loss: 0.4696, weighted_loss: 0.1409, label: 3, bag_size: 710

Instance Classifier Stats

class 0 clustering acc 0.9845478110599079: correct 68367/69440

class 1 clustering acc 0.7085253456221198: correct 12300/17360


Epoch: 39, train_loss: 0.0108, train_clustering_loss:  0.2251

class 0: acc 1.0, correct 44/44

class 1: acc 0.9948849104859335, correct 778/782

class 2: acc 0.9972401103955841, correct 1084/1087

class 3: acc 0.9961089494163424, correct 256/257


Val Set, val_loss: 2.6561, auc: 0.7280

class 0 clustering acc 0.9525331439393939: correct 8047/8448

class 1 clustering acc 0.47301136363636365: correct 999/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6770833333333334, correct 65/96

class 2: acc 0.6791044776119403, correct 91/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.6136

Overall F1 Score: 0.3903

Training for coarse level...

batch 99, loss: 0.0072, instance_loss: 0.1803, weighted_loss: 0.0591, label: 2, bag_size: 339

batch 199, loss: 0.0000, instance_loss: 0.0093, weighted_loss: 0.0028, label: 1, bag_size: 88

batch 299, loss: 0.0024, instance_loss: 0.2833, weighted_loss: 0.0867, label: 1, bag_size: 308

batch 399, loss: 0.0000, instance_loss: 0.0002, weighted_loss: 0.0001, label: 1, bag_size: 848

batch 499, loss: 0.0000, instance_loss: 0.0001, weighted_loss: 0.0000, label: 1, bag_size: 836

batch 599, loss: 0.0000, instance_loss: 0.0025, weighted_loss: 0.0008, label: 2, bag_size: 432

batch 699, loss: 0.0000, instance_loss: 0.1668, weighted_loss: 0.0501, label: 1, bag_size: 1124

batch 799, loss: 0.1031, instance_loss: 0.3004, weighted_loss: 0.1623, label: 2, bag_size: 435

batch 899, loss: 0.0000, instance_loss: 0.1605, weighted_loss: 0.0481, label: 0, bag_size: 153

batch 999, loss: 0.0000, instance_loss: 0.7861, weighted_loss: 0.2358, label: 1, bag_size: 1009

batch 1099, loss: 0.0003, instance_loss: 1.0342, weighted_loss: 0.3105, label: 1, bag_size: 209

batch 1199, loss: 0.0000, instance_loss: 0.2068, weighted_loss: 0.0621, label: 2, bag_size: 393

batch 1299, loss: 0.0000, instance_loss: 0.4566, weighted_loss: 0.1370, label: 1, bag_size: 696

batch 1399, loss: 0.0003, instance_loss: 0.2769, weighted_loss: 0.0833, label: 3, bag_size: 118

batch 1499, loss: 0.0025, instance_loss: 0.1701, weighted_loss: 0.0528, label: 2, bag_size: 259

batch 1599, loss: 0.0000, instance_loss: 0.0184, weighted_loss: 0.0055, label: 1, bag_size: 1692

batch 1699, loss: 0.0001, instance_loss: 0.6847, weighted_loss: 0.2055, label: 3, bag_size: 558

batch 1799, loss: 0.0000, instance_loss: 1.1459, weighted_loss: 0.3438, label: 1, bag_size: 965

batch 1899, loss: 0.0000, instance_loss: 0.0042, weighted_loss: 0.0013, label: 1, bag_size: 1181

batch 1999, loss: 0.0000, instance_loss: 0.2617, weighted_loss: 0.0785, label: 2, bag_size: 519

batch 2099, loss: 0.0069, instance_loss: 0.6987, weighted_loss: 0.2145, label: 3, bag_size: 628

Instance Classifier Stats

class 0 clustering acc 0.983338133640553: correct 68283/69440

class 1 clustering acc 0.6981566820276498: correct 12120/17360


Epoch: 40, train_loss: 0.0297, train_clustering_loss:  0.2384

class 0: acc 1.0, correct 44/44

class 1: acc 0.9884910485933504, correct 773/782

class 2: acc 0.9935602575896965, correct 1080/1087

class 3: acc 0.9766536964980544, correct 251/257


Val Set, val_loss: 2.4114, auc: 0.7417

class 0 clustering acc 0.9517045454545454: correct 8040/8448

class 1 clustering acc 0.4777462121212121: correct 1009/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6770833333333334, correct 65/96

class 2: acc 0.6940298507462687, correct 93/134

class 3: acc 0.3, correct 9/30

Overall Accuracy: 0.6326

Overall F1 Score: 0.4158

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0119, weighted_loss: 0.0036, label: 1, bag_size: 333

batch 199, loss: 0.0000, instance_loss: 0.1093, weighted_loss: 0.0328, label: 1, bag_size: 265

batch 299, loss: 0.0069, instance_loss: 0.1922, weighted_loss: 0.0625, label: 2, bag_size: 422

batch 399, loss: 0.0000, instance_loss: 0.1697, weighted_loss: 0.0509, label: 2, bag_size: 2046

batch 499, loss: 0.0000, instance_loss: 0.2522, weighted_loss: 0.0757, label: 1, bag_size: 267

batch 599, loss: 0.0183, instance_loss: 0.5701, weighted_loss: 0.1838, label: 0, bag_size: 901

batch 699, loss: 0.0003, instance_loss: 0.9982, weighted_loss: 0.2997, label: 3, bag_size: 94

batch 799, loss: 0.0011, instance_loss: 0.1532, weighted_loss: 0.0468, label: 1, bag_size: 927

batch 899, loss: 0.0000, instance_loss: 0.0004, weighted_loss: 0.0001, label: 1, bag_size: 936

batch 999, loss: 0.2616, instance_loss: 1.2924, weighted_loss: 0.5708, label: 3, bag_size: 328

batch 1099, loss: 0.0034, instance_loss: 0.1860, weighted_loss: 0.0582, label: 2, bag_size: 405

batch 1199, loss: 0.0000, instance_loss: 0.0058, weighted_loss: 0.0017, label: 1, bag_size: 1313

batch 1299, loss: 0.0000, instance_loss: 0.3148, weighted_loss: 0.0944, label: 2, bag_size: 643

batch 1399, loss: 0.0000, instance_loss: 0.3494, weighted_loss: 0.1048, label: 3, bag_size: 367

batch 1499, loss: 0.0821, instance_loss: 0.8742, weighted_loss: 0.3197, label: 1, bag_size: 1667

batch 1599, loss: 0.0022, instance_loss: 0.5883, weighted_loss: 0.1781, label: 3, bag_size: 2244

batch 1699, loss: 0.0000, instance_loss: 0.0349, weighted_loss: 0.0105, label: 2, bag_size: 518

batch 1799, loss: 0.0000, instance_loss: 0.1370, weighted_loss: 0.0411, label: 1, bag_size: 477

batch 1899, loss: 0.0042, instance_loss: 0.0872, weighted_loss: 0.0291, label: 2, bag_size: 265

batch 1999, loss: 0.0000, instance_loss: 0.2731, weighted_loss: 0.0819, label: 3, bag_size: 778

batch 2099, loss: 0.0001, instance_loss: 0.1815, weighted_loss: 0.0545, label: 2, bag_size: 1897

Instance Classifier Stats

class 0 clustering acc 0.9836549539170507: correct 68305/69440

class 1 clustering acc 0.6966589861751152: correct 12094/17360


Epoch: 41, train_loss: 0.0441, train_clustering_loss:  0.2355

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9833759590792839, correct 769/782

class 2: acc 0.9880404783808647, correct 1074/1087

class 3: acc 0.9922178988326849, correct 255/257


Val Set, val_loss: 2.5424, auc: 0.7109

class 0 clustering acc 0.9520596590909091: correct 8043/8448

class 1 clustering acc 0.5137310606060606: correct 1085/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6458333333333334, correct 62/96

class 2: acc 0.753731343283582, correct 101/134

class 3: acc 0.16666666666666666, correct 5/30

Overall Accuracy: 0.6364

Overall F1 Score: 0.3921

Training for coarse level...

batch 99, loss: 0.0231, instance_loss: 0.1602, weighted_loss: 0.0642, label: 2, bag_size: 1214

batch 199, loss: 0.0002, instance_loss: 0.7998, weighted_loss: 0.2401, label: 1, bag_size: 738

batch 299, loss: 0.0153, instance_loss: 0.7365, weighted_loss: 0.2317, label: 1, bag_size: 2139

batch 399, loss: 0.0003, instance_loss: 0.1620, weighted_loss: 0.0488, label: 2, bag_size: 245

batch 499, loss: 0.0000, instance_loss: 0.0466, weighted_loss: 0.0140, label: 2, bag_size: 505

batch 599, loss: 0.0000, instance_loss: 0.1115, weighted_loss: 0.0334, label: 2, bag_size: 472

batch 699, loss: 0.0019, instance_loss: 0.1856, weighted_loss: 0.0570, label: 1, bag_size: 476

batch 799, loss: 0.0000, instance_loss: 1.1080, weighted_loss: 0.3324, label: 0, bag_size: 807

batch 899, loss: 0.0000, instance_loss: 0.0007, weighted_loss: 0.0002, label: 2, bag_size: 969

batch 999, loss: 0.0000, instance_loss: 1.2060, weighted_loss: 0.3618, label: 1, bag_size: 472

batch 1099, loss: 0.0000, instance_loss: 0.2670, weighted_loss: 0.0801, label: 1, bag_size: 558

batch 1199, loss: 0.0000, instance_loss: 0.1636, weighted_loss: 0.0491, label: 2, bag_size: 178

batch 1299, loss: 0.0000, instance_loss: 0.4675, weighted_loss: 0.1403, label: 1, bag_size: 349

batch 1399, loss: 0.0000, instance_loss: 0.0101, weighted_loss: 0.0030, label: 1, bag_size: 788

batch 1499, loss: 0.0002, instance_loss: 0.1006, weighted_loss: 0.0303, label: 2, bag_size: 365

batch 1599, loss: 0.0000, instance_loss: 0.1524, weighted_loss: 0.0457, label: 1, bag_size: 641

batch 1699, loss: 0.0000, instance_loss: 0.0021, weighted_loss: 0.0006, label: 2, bag_size: 732

batch 1799, loss: 0.0000, instance_loss: 0.3593, weighted_loss: 0.1078, label: 2, bag_size: 608

batch 1899, loss: 0.0000, instance_loss: 0.0108, weighted_loss: 0.0033, label: 2, bag_size: 506

batch 1999, loss: 0.0000, instance_loss: 0.2259, weighted_loss: 0.0678, label: 2, bag_size: 108

batch 2099, loss: 0.0000, instance_loss: 0.4998, weighted_loss: 0.1500, label: 1, bag_size: 268

Instance Classifier Stats

class 0 clustering acc 0.9830357142857142: correct 68262/69440

class 1 clustering acc 0.7017857142857142: correct 12183/17360


Epoch: 42, train_loss: 0.0191, train_clustering_loss:  0.2316

class 0: acc 1.0, correct 44/44

class 1: acc 0.9923273657289002, correct 776/782

class 2: acc 0.9954001839926403, correct 1082/1087

class 3: acc 0.9961089494163424, correct 256/257


Val Set, val_loss: 2.5364, auc: 0.7081

class 0 clustering acc 0.9526515151515151: correct 8048/8448

class 1 clustering acc 0.43892045454545453: correct 927/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6666666666666666, correct 64/96

class 2: acc 0.6492537313432836, correct 87/134

class 3: acc 0.26666666666666666, correct 8/30

Overall Accuracy: 0.6023

Overall F1 Score: 0.3971

Training for coarse level...

batch 99, loss: 0.0004, instance_loss: 0.4825, weighted_loss: 0.1450, label: 1, bag_size: 142

batch 199, loss: 0.0000, instance_loss: 0.0104, weighted_loss: 0.0031, label: 2, bag_size: 765

batch 299, loss: 0.0003, instance_loss: 0.0955, weighted_loss: 0.0289, label: 1, bag_size: 204

batch 399, loss: 0.0000, instance_loss: 0.0533, weighted_loss: 0.0160, label: 2, bag_size: 289

batch 499, loss: 0.0000, instance_loss: 0.0372, weighted_loss: 0.0112, label: 2, bag_size: 271

batch 599, loss: 0.0000, instance_loss: 0.0068, weighted_loss: 0.0020, label: 1, bag_size: 687

batch 699, loss: 0.0002, instance_loss: 0.0617, weighted_loss: 0.0186, label: 2, bag_size: 902

batch 799, loss: 0.0000, instance_loss: 0.0035, weighted_loss: 0.0011, label: 2, bag_size: 448

batch 899, loss: 0.0000, instance_loss: 0.2197, weighted_loss: 0.0659, label: 2, bag_size: 268

batch 999, loss: 0.0000, instance_loss: 0.0003, weighted_loss: 0.0001, label: 2, bag_size: 543

batch 1099, loss: 0.0001, instance_loss: 0.0159, weighted_loss: 0.0048, label: 1, bag_size: 298

batch 1199, loss: 0.0000, instance_loss: 0.0220, weighted_loss: 0.0066, label: 2, bag_size: 866

batch 1299, loss: 0.0000, instance_loss: 0.7849, weighted_loss: 0.2355, label: 0, bag_size: 260

batch 1399, loss: 0.0151, instance_loss: 0.2634, weighted_loss: 0.0896, label: 2, bag_size: 1049

batch 1499, loss: 0.0003, instance_loss: 0.0082, weighted_loss: 0.0027, label: 2, bag_size: 475

batch 1599, loss: 0.0000, instance_loss: 0.0745, weighted_loss: 0.0223, label: 2, bag_size: 714

batch 1699, loss: 0.0000, instance_loss: 0.2286, weighted_loss: 0.0686, label: 3, bag_size: 372

batch 1799, loss: 0.0000, instance_loss: 0.1264, weighted_loss: 0.0379, label: 1, bag_size: 1632

batch 1899, loss: 0.0000, instance_loss: 0.9148, weighted_loss: 0.2744, label: 3, bag_size: 175

batch 1999, loss: 0.0156, instance_loss: 0.6025, weighted_loss: 0.1917, label: 3, bag_size: 1167

batch 2099, loss: 0.0001, instance_loss: 0.0285, weighted_loss: 0.0086, label: 1, bag_size: 685

Instance Classifier Stats

class 0 clustering acc 0.984375: correct 68355/69440

class 1 clustering acc 0.7040898617511521: correct 12223/17360


Epoch: 43, train_loss: 0.0246, train_clustering_loss:  0.2300

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9948849104859335, correct 778/782

class 2: acc 0.9944802207911684, correct 1081/1087

class 3: acc 0.9766536964980544, correct 251/257


Val Set, val_loss: 2.4241, auc: 0.7367

class 0 clustering acc 0.951467803030303: correct 8038/8448

class 1 clustering acc 0.4564393939393939: correct 964/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.7291666666666666, correct 70/96

class 2: acc 0.5522388059701493, correct 74/134

class 3: acc 0.3333333333333333, correct 10/30

Overall Accuracy: 0.5833

Overall F1 Score: 0.3952

Training for coarse level...

batch 99, loss: 0.0003, instance_loss: 0.2115, weighted_loss: 0.0636, label: 2, bag_size: 279

batch 199, loss: 0.0001, instance_loss: 0.3141, weighted_loss: 0.0943, label: 2, bag_size: 658

batch 299, loss: 0.0001, instance_loss: 0.2817, weighted_loss: 0.0846, label: 1, bag_size: 402

batch 399, loss: 0.0032, instance_loss: 0.0539, weighted_loss: 0.0185, label: 1, bag_size: 428

batch 499, loss: 0.0007, instance_loss: 0.0096, weighted_loss: 0.0034, label: 2, bag_size: 162

batch 599, loss: 0.0000, instance_loss: 0.2209, weighted_loss: 0.0663, label: 1, bag_size: 440

batch 699, loss: 0.0000, instance_loss: 0.0156, weighted_loss: 0.0047, label: 2, bag_size: 359

batch 799, loss: 0.0000, instance_loss: 0.0144, weighted_loss: 0.0043, label: 2, bag_size: 505

batch 899, loss: 0.0000, instance_loss: 0.0518, weighted_loss: 0.0155, label: 1, bag_size: 666

batch 999, loss: 0.0000, instance_loss: 0.0406, weighted_loss: 0.0122, label: 1, bag_size: 1892

batch 1099, loss: 0.0000, instance_loss: 0.0030, weighted_loss: 0.0009, label: 1, bag_size: 1404

batch 1199, loss: 0.0000, instance_loss: 0.1436, weighted_loss: 0.0431, label: 2, bag_size: 427

batch 1299, loss: 0.0000, instance_loss: 0.0426, weighted_loss: 0.0128, label: 2, bag_size: 368

batch 1399, loss: 0.0000, instance_loss: 0.3254, weighted_loss: 0.0976, label: 2, bag_size: 216

batch 1499, loss: 0.0000, instance_loss: 0.3534, weighted_loss: 0.1060, label: 1, bag_size: 567

batch 1599, loss: 0.0000, instance_loss: 0.0237, weighted_loss: 0.0071, label: 2, bag_size: 834

batch 1699, loss: 0.0000, instance_loss: 0.4471, weighted_loss: 0.1341, label: 1, bag_size: 175

batch 1799, loss: 0.0000, instance_loss: 0.3938, weighted_loss: 0.1182, label: 3, bag_size: 245

batch 1899, loss: 0.0057, instance_loss: 0.4878, weighted_loss: 0.1504, label: 1, bag_size: 295

batch 1999, loss: 0.0000, instance_loss: 0.0004, weighted_loss: 0.0001, label: 1, bag_size: 1104

batch 2099, loss: 0.0000, instance_loss: 0.2915, weighted_loss: 0.0874, label: 1, bag_size: 574

Instance Classifier Stats

class 0 clustering acc 0.9851670506912442: correct 68410/69440

class 1 clustering acc 0.7097926267281106: correct 12322/17360


Epoch: 44, train_loss: 0.0094, train_clustering_loss:  0.2217

class 0: acc 1.0, correct 44/44

class 1: acc 0.9974424552429667, correct 780/782

class 2: acc 0.9990800367985281, correct 1086/1087

class 3: acc 0.9961089494163424, correct 256/257


Val Set, val_loss: 2.4380, auc: 0.7478

class 0 clustering acc 0.94921875: correct 8019/8448

class 1 clustering acc 0.49763257575757575: correct 1051/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6458333333333334, correct 62/96

class 2: acc 0.6716417910447762, correct 90/134

class 3: acc 0.36666666666666664, correct 11/30

Overall Accuracy: 0.6174

Overall F1 Score: 0.4147

Training for coarse level...

batch 99, loss: 0.0039, instance_loss: 0.4708, weighted_loss: 0.1440, label: 1, bag_size: 37

batch 199, loss: 0.0000, instance_loss: 0.0059, weighted_loss: 0.0018, label: 2, bag_size: 622

batch 299, loss: 0.0002, instance_loss: 0.1742, weighted_loss: 0.0524, label: 2, bag_size: 714

batch 399, loss: 0.0000, instance_loss: 0.0374, weighted_loss: 0.0112, label: 1, bag_size: 848

batch 499, loss: 0.0000, instance_loss: 0.3902, weighted_loss: 0.1171, label: 2, bag_size: 599

batch 599, loss: 0.0002, instance_loss: 0.4979, weighted_loss: 0.1495, label: 1, bag_size: 311

batch 699, loss: 0.0000, instance_loss: 0.1399, weighted_loss: 0.0420, label: 3, bag_size: 388

batch 799, loss: 4.5635, instance_loss: 0.7554, weighted_loss: 3.4211, label: 1, bag_size: 215

batch 899, loss: 0.0000, instance_loss: 0.0572, weighted_loss: 0.0172, label: 0, bag_size: 119

batch 999, loss: 0.0000, instance_loss: 0.1044, weighted_loss: 0.0313, label: 1, bag_size: 476

batch 1099, loss: 0.0001, instance_loss: 0.0328, weighted_loss: 0.0099, label: 1, bag_size: 388

batch 1199, loss: 0.0003, instance_loss: 0.0260, weighted_loss: 0.0080, label: 2, bag_size: 198

batch 1299, loss: 0.0165, instance_loss: 0.3319, weighted_loss: 0.1111, label: 2, bag_size: 1549

batch 1399, loss: 0.0001, instance_loss: 0.3018, weighted_loss: 0.0906, label: 2, bag_size: 112

batch 1499, loss: 0.0000, instance_loss: 0.2477, weighted_loss: 0.0743, label: 2, bag_size: 297

batch 1599, loss: 0.0082, instance_loss: 0.2913, weighted_loss: 0.0932, label: 2, bag_size: 294

batch 1699, loss: 0.0000, instance_loss: 0.1935, weighted_loss: 0.0581, label: 2, bag_size: 444

batch 1799, loss: 0.0000, instance_loss: 0.0003, weighted_loss: 0.0001, label: 1, bag_size: 1079

batch 1899, loss: 0.0000, instance_loss: 0.0262, weighted_loss: 0.0079, label: 1, bag_size: 3332

batch 1999, loss: 0.0000, instance_loss: 0.9841, weighted_loss: 0.2952, label: 1, bag_size: 359

batch 2099, loss: 0.0002, instance_loss: 0.2669, weighted_loss: 0.0803, label: 2, bag_size: 266

Instance Classifier Stats

class 0 clustering acc 0.9846198156682028: correct 68372/69440

class 1 clustering acc 0.7195852534562212: correct 12492/17360


Epoch: 45, train_loss: 0.0255, train_clustering_loss:  0.2195

class 0: acc 0.9545454545454546, correct 42/44

class 1: acc 0.9936061381074168, correct 777/782

class 2: acc 0.9935602575896965, correct 1080/1087

class 3: acc 0.9883268482490273, correct 254/257


Val Set, val_loss: 2.1713, auc: 0.7540

class 0 clustering acc 0.9506392045454546: correct 8031/8448

class 1 clustering acc 0.49242424242424243: correct 1040/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6145833333333334, correct 59/96

class 2: acc 0.7910447761194029, correct 106/134

class 3: acc 0.13333333333333333, correct 4/30

Overall Accuracy: 0.6402

Overall F1 Score: 0.3863

Training for coarse level...

batch 99, loss: 0.0007, instance_loss: 0.4893, weighted_loss: 0.1473, label: 3, bag_size: 347

batch 199, loss: 0.0000, instance_loss: 0.1809, weighted_loss: 0.0543, label: 3, bag_size: 457

batch 299, loss: 0.0001, instance_loss: 0.0714, weighted_loss: 0.0215, label: 2, bag_size: 1222

batch 399, loss: 0.0000, instance_loss: 0.0548, weighted_loss: 0.0165, label: 2, bag_size: 414

batch 499, loss: 0.0000, instance_loss: 0.0002, weighted_loss: 0.0001, label: 1, bag_size: 2219

batch 599, loss: 0.0000, instance_loss: 0.0424, weighted_loss: 0.0127, label: 2, bag_size: 847

batch 699, loss: 0.0001, instance_loss: 0.0650, weighted_loss: 0.0195, label: 2, bag_size: 422

batch 799, loss: 0.0006, instance_loss: 0.3040, weighted_loss: 0.0916, label: 3, bag_size: 483

batch 899, loss: 0.0000, instance_loss: 0.0980, weighted_loss: 0.0294, label: 1, bag_size: 333

batch 999, loss: 0.0000, instance_loss: 0.0920, weighted_loss: 0.0276, label: 1, bag_size: 1706

batch 1099, loss: 0.0001, instance_loss: 0.6396, weighted_loss: 0.1920, label: 3, bag_size: 276

batch 1199, loss: 0.0000, instance_loss: 0.0045, weighted_loss: 0.0014, label: 2, bag_size: 1211

batch 1299, loss: 0.0000, instance_loss: 0.0250, weighted_loss: 0.0075, label: 1, bag_size: 3773

batch 1399, loss: 0.0000, instance_loss: 0.4827, weighted_loss: 0.1448, label: 3, bag_size: 208

batch 1499, loss: 0.0000, instance_loss: 0.1797, weighted_loss: 0.0539, label: 1, bag_size: 328

batch 1599, loss: 0.0000, instance_loss: 0.0007, weighted_loss: 0.0002, label: 2, bag_size: 250

batch 1699, loss: 0.0012, instance_loss: 0.3281, weighted_loss: 0.0993, label: 2, bag_size: 527

batch 1799, loss: 0.0000, instance_loss: 0.3034, weighted_loss: 0.0910, label: 3, bag_size: 565

batch 1899, loss: 0.0000, instance_loss: 0.5123, weighted_loss: 0.1537, label: 3, bag_size: 486

batch 1999, loss: 0.0005, instance_loss: 0.2477, weighted_loss: 0.0747, label: 2, bag_size: 472

batch 2099, loss: 0.0000, instance_loss: 0.1730, weighted_loss: 0.0519, label: 1, bag_size: 354

Instance Classifier Stats

class 0 clustering acc 0.9860311059907834: correct 68470/69440

class 1 clustering acc 0.7359447004608295: correct 12776/17360


Epoch: 46, train_loss: 0.0064, train_clustering_loss:  0.2063

class 0: acc 1.0, correct 44/44

class 1: acc 0.9974424552429667, correct 780/782

class 2: acc 0.9981600735970562, correct 1085/1087

class 3: acc 0.9961089494163424, correct 256/257


Val Set, val_loss: 2.2486, auc: 0.7467

class 0 clustering acc 0.9511126893939394: correct 8035/8448

class 1 clustering acc 0.4881628787878788: correct 1031/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.7395833333333334, correct 71/96

class 2: acc 0.6865671641791045, correct 92/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.6402

Overall F1 Score: 0.4082

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0209, weighted_loss: 0.0063, label: 2, bag_size: 753

batch 199, loss: 0.0262, instance_loss: 0.4175, weighted_loss: 0.1436, label: 3, bag_size: 159

batch 299, loss: 0.0001, instance_loss: 0.4063, weighted_loss: 0.1220, label: 1, bag_size: 224

batch 399, loss: 0.0001, instance_loss: 0.0438, weighted_loss: 0.0132, label: 2, bag_size: 796

batch 499, loss: 0.0000, instance_loss: 0.0117, weighted_loss: 0.0035, label: 1, bag_size: 1616

batch 599, loss: 0.0000, instance_loss: 0.0044, weighted_loss: 0.0013, label: 1, bag_size: 1046

batch 699, loss: 0.0000, instance_loss: 0.0177, weighted_loss: 0.0053, label: 2, bag_size: 622

batch 799, loss: 0.0000, instance_loss: 0.7691, weighted_loss: 0.2307, label: 3, bag_size: 139

batch 899, loss: 0.0000, instance_loss: 0.1392, weighted_loss: 0.0418, label: 2, bag_size: 409

batch 999, loss: 0.0000, instance_loss: 0.1630, weighted_loss: 0.0489, label: 2, bag_size: 686

batch 1099, loss: 0.0000, instance_loss: 0.0088, weighted_loss: 0.0027, label: 1, bag_size: 862

batch 1199, loss: 0.0000, instance_loss: 0.5337, weighted_loss: 0.1601, label: 1, bag_size: 376

batch 1299, loss: 0.0000, instance_loss: 0.2827, weighted_loss: 0.0848, label: 2, bag_size: 11

batch 1399, loss: 0.0000, instance_loss: 0.9141, weighted_loss: 0.2742, label: 1, bag_size: 393

batch 1499, loss: 0.0000, instance_loss: 0.5273, weighted_loss: 0.1582, label: 3, bag_size: 216

batch 1599, loss: 0.0099, instance_loss: 0.8259, weighted_loss: 0.2547, label: 1, bag_size: 792

batch 1699, loss: 0.0000, instance_loss: 0.1588, weighted_loss: 0.0477, label: 2, bag_size: 465

batch 1799, loss: 0.0001, instance_loss: 0.1412, weighted_loss: 0.0424, label: 2, bag_size: 509

batch 1899, loss: 0.0000, instance_loss: 0.0563, weighted_loss: 0.0169, label: 2, bag_size: 733

batch 1999, loss: 0.0000, instance_loss: 0.1087, weighted_loss: 0.0326, label: 2, bag_size: 239

batch 2099, loss: 0.0000, instance_loss: 0.6262, weighted_loss: 0.1879, label: 3, bag_size: 609

Instance Classifier Stats

class 0 clustering acc 0.9854838709677419: correct 68432/69440

class 1 clustering acc 0.7396313364055299: correct 12840/17360


Epoch: 47, train_loss: 0.0051, train_clustering_loss:  0.2052

class 0: acc 1.0, correct 44/44

class 1: acc 0.9987212276214834, correct 781/782

class 2: acc 0.9990800367985281, correct 1086/1087

class 3: acc 1.0, correct 257/257


Val Set, val_loss: 2.3997, auc: 0.7470

class 0 clustering acc 0.94921875: correct 8019/8448

class 1 clustering acc 0.49857954545454547: correct 1053/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6666666666666666, correct 64/96

class 2: acc 0.7611940298507462, correct 102/134

class 3: acc 0.2, correct 6/30

Overall Accuracy: 0.6515

Overall F1 Score: 0.4101

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0591, weighted_loss: 0.0177, label: 1, bag_size: 169

batch 199, loss: 0.0262, instance_loss: 0.2596, weighted_loss: 0.0962, label: 1, bag_size: 2625

batch 299, loss: 0.0000, instance_loss: 0.2242, weighted_loss: 0.0673, label: 1, bag_size: 123

batch 399, loss: 0.0000, instance_loss: 0.0657, weighted_loss: 0.0197, label: 2, bag_size: 308

batch 499, loss: 0.0001, instance_loss: 0.0810, weighted_loss: 0.0244, label: 2, bag_size: 239

batch 599, loss: 0.0040, instance_loss: 0.2556, weighted_loss: 0.0795, label: 1, bag_size: 201

batch 699, loss: 0.0008, instance_loss: 0.4454, weighted_loss: 0.1342, label: 0, bag_size: 419

batch 799, loss: 0.0000, instance_loss: 0.1396, weighted_loss: 0.0419, label: 2, bag_size: 609

batch 899, loss: 0.0061, instance_loss: 0.2767, weighted_loss: 0.0873, label: 3, bag_size: 501

batch 999, loss: 0.0000, instance_loss: 0.3333, weighted_loss: 0.1000, label: 2, bag_size: 545

batch 1099, loss: 0.0000, instance_loss: 0.4707, weighted_loss: 0.1412, label: 3, bag_size: 450

batch 1199, loss: 0.0000, instance_loss: 0.2663, weighted_loss: 0.0799, label: 1, bag_size: 161

batch 1299, loss: 0.0043, instance_loss: 0.7106, weighted_loss: 0.2162, label: 3, bag_size: 681

batch 1399, loss: 0.0000, instance_loss: 0.0108, weighted_loss: 0.0032, label: 2, bag_size: 511

batch 1499, loss: 0.0004, instance_loss: 0.3970, weighted_loss: 0.1193, label: 2, bag_size: 1364

batch 1599, loss: 0.0000, instance_loss: 0.0167, weighted_loss: 0.0050, label: 2, bag_size: 592

batch 1699, loss: 0.0117, instance_loss: 0.3968, weighted_loss: 0.1272, label: 2, bag_size: 746

batch 1799, loss: 0.0013, instance_loss: 0.6993, weighted_loss: 0.2107, label: 3, bag_size: 1875

batch 1899, loss: 0.0369, instance_loss: 0.2130, weighted_loss: 0.0897, label: 2, bag_size: 416

batch 1999, loss: 0.0005, instance_loss: 0.3721, weighted_loss: 0.1120, label: 1, bag_size: 332

batch 2099, loss: 0.0001, instance_loss: 0.2205, weighted_loss: 0.0662, label: 2, bag_size: 12

Instance Classifier Stats

class 0 clustering acc 0.9850374423963134: correct 68401/69440

class 1 clustering acc 0.7347926267281106: correct 12756/17360


Epoch: 48, train_loss: 0.0292, train_clustering_loss:  0.2148

class 0: acc 0.9772727272727273, correct 43/44

class 1: acc 0.9948849104859335, correct 778/782

class 2: acc 0.9889604415823368, correct 1075/1087

class 3: acc 0.980544747081712, correct 252/257


Val Set, val_loss: 2.2983, auc: 0.7452

class 0 clustering acc 0.9543087121212122: correct 8062/8448

class 1 clustering acc 0.4772727272727273: correct 1008/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6458333333333334, correct 62/96

class 2: acc 0.7014925373134329, correct 94/134

class 3: acc 0.3, correct 9/30

Overall Accuracy: 0.6250

Overall F1 Score: 0.4084

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.5565, weighted_loss: 0.1669, label: 3, bag_size: 542

batch 199, loss: 0.0001, instance_loss: 0.0309, weighted_loss: 0.0094, label: 1, bag_size: 793

batch 299, loss: 0.0000, instance_loss: 0.0032, weighted_loss: 0.0010, label: 2, bag_size: 681

batch 399, loss: 0.0000, instance_loss: 0.0344, weighted_loss: 0.0103, label: 1, bag_size: 1847

batch 499, loss: 0.0000, instance_loss: 0.0537, weighted_loss: 0.0161, label: 2, bag_size: 333

batch 599, loss: 0.0000, instance_loss: 0.6996, weighted_loss: 0.2099, label: 3, bag_size: 139

batch 699, loss: 0.0000, instance_loss: 0.0687, weighted_loss: 0.0206, label: 2, bag_size: 451

batch 799, loss: 0.0000, instance_loss: 0.4439, weighted_loss: 0.1332, label: 1, bag_size: 646

batch 899, loss: 0.0000, instance_loss: 0.1031, weighted_loss: 0.0309, label: 2, bag_size: 630

batch 999, loss: 0.0000, instance_loss: 0.0005, weighted_loss: 0.0001, label: 2, bag_size: 676

batch 1099, loss: 0.0000, instance_loss: 0.4482, weighted_loss: 0.1345, label: 3, bag_size: 116

batch 1199, loss: 0.0000, instance_loss: 0.0971, weighted_loss: 0.0291, label: 3, bag_size: 243

batch 1299, loss: 0.0000, instance_loss: 0.0246, weighted_loss: 0.0074, label: 2, bag_size: 424

batch 1399, loss: 0.0000, instance_loss: 0.0927, weighted_loss: 0.0278, label: 2, bag_size: 247

batch 1499, loss: 0.0000, instance_loss: 0.1217, weighted_loss: 0.0365, label: 2, bag_size: 154

batch 1599, loss: 0.0002, instance_loss: 0.0553, weighted_loss: 0.0167, label: 2, bag_size: 679

batch 1699, loss: 0.0000, instance_loss: 0.0859, weighted_loss: 0.0258, label: 1, bag_size: 1967

batch 1799, loss: 0.0000, instance_loss: 0.0770, weighted_loss: 0.0231, label: 2, bag_size: 336

batch 1899, loss: 0.0000, instance_loss: 0.0504, weighted_loss: 0.0151, label: 2, bag_size: 542

batch 1999, loss: 0.0000, instance_loss: 0.0215, weighted_loss: 0.0065, label: 2, bag_size: 596

batch 2099, loss: 0.0000, instance_loss: 0.0147, weighted_loss: 0.0044, label: 1, bag_size: 778

Instance Classifier Stats

class 0 clustering acc 0.9861319124423963: correct 68477/69440

class 1 clustering acc 0.7402073732718893: correct 12850/17360


Epoch: 49, train_loss: 0.0149, train_clustering_loss:  0.2032

class 0: acc 1.0, correct 44/44

class 1: acc 0.9961636828644501, correct 779/782

class 2: acc 0.9954001839926403, correct 1082/1087

class 3: acc 0.9922178988326849, correct 255/257


Val Set, val_loss: 2.4019, auc: 0.7357

class 0 clustering acc 0.9500473484848485: correct 8026/8448

class 1 clustering acc 0.5014204545454546: correct 1059/2112

class 0: acc 0.0, correct 0/4

class 1: acc 0.6979166666666666, correct 67/96

class 2: acc 0.6940298507462687, correct 93/134

class 3: acc 0.3333333333333333, correct 10/30

Overall Accuracy: 0.6439

Overall F1 Score: 0.4295


Process finished with exit code 0
