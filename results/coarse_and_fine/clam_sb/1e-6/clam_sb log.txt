Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for coarse_and_fine level...
batch 100, loss: 3.0789, instance_loss: 1.2945, weighted_loss: 2.5436, label: 5, bag_size: 312
batch 200, loss: 3.5883, instance_loss: 1.2013, weighted_loss: 2.8722, label: 5, bag_size: 368
batch 300, loss: 3.5854, instance_loss: 1.2117, weighted_loss: 2.8733, label: 5, bag_size: 52
batch 400, loss: 3.7277, instance_loss: 1.2086, weighted_loss: 2.9720, label: 5, bag_size: 334
batch 500, loss: 3.4697, instance_loss: 1.1542, weighted_loss: 2.7751, label: 2, bag_size: 454
batch 600, loss: 2.9049, instance_loss: 1.1587, weighted_loss: 2.3810, label: 5, bag_size: 502
batch 700, loss: 3.3697, instance_loss: 1.1194, weighted_loss: 2.6946, label: 2, bag_size: 785
batch 800, loss: 2.7842, instance_loss: 1.1534, weighted_loss: 2.2950, label: 5, bag_size: 1190
batch 900, loss: 3.4017, instance_loss: 1.0926, weighted_loss: 2.7089, label: 6, bag_size: 290
batch 1000, loss: 2.5937, instance_loss: 1.0830, weighted_loss: 2.1405, label: 5, bag_size: 248
batch 1100, loss: 2.7110, instance_loss: 1.1059, weighted_loss: 2.2295, label: 5, bag_size: 192
batch 1200, loss: 3.2744, instance_loss: 1.0423, weighted_loss: 2.6047, label: 2, bag_size: 1323
batch 1300, loss: 3.1280, instance_loss: 1.0594, weighted_loss: 2.5074, label: 2, bag_size: 382
batch 1400, loss: 3.1144, instance_loss: 0.9989, weighted_loss: 2.4797, label: 6, bag_size: 146
batch 1500, loss: 2.3027, instance_loss: 0.9754, weighted_loss: 1.9045, label: 5, bag_size: 711
batch 1600, loss: 3.8491, instance_loss: 1.0268, weighted_loss: 3.0024, label: 4, bag_size: 563
batch 1700, loss: 2.5626, instance_loss: 0.8995, weighted_loss: 2.0637, label: 5, bag_size: 1165
batch 1800, loss: 2.3278, instance_loss: 0.9111, weighted_loss: 1.9028, label: 5, bag_size: 509
batch 1900, loss: 2.0878, instance_loss: 0.9128, weighted_loss: 1.7353, label: 5, bag_size: 1853
batch 2000, loss: 3.0454, instance_loss: 0.9649, weighted_loss: 2.4212, label: 2, bag_size: 1075
batch 2100, loss: 2.9936, instance_loss: 0.9029, weighted_loss: 2.3664, label: 2, bag_size: 1384

Instance Classifier Stats
class 0 clustering acc 0.7968356374807988: correct 207496/260400
class 1 clustering acc 0.2653225806451613: correct 4606/17360

Epoch: 1, train_loss: 3.2483, train_clustering_loss: 1.0719, train_error: 0.6364
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.0, correct coarse 0/782
coarse class 2: coarse acc 0.9981600735970562, correct coarse 1085/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.017408123791102514, correct fine 9/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.9224343675417661, correct fine 773/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.05303030303030303, correct fine 7/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.9327, coarse auc: 0.6641, fine auc: 0.5881
class 0 clustering acc 0.984280303030303: correct 31182/31680
class 1 clustering acc 0.029356060606060608: correct 62/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.0, correct coarse 0/96
coarse class 2: coarse acc 1.0, correct coarse 134/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.0, correct fine 0/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 1.0, correct fine 104/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.5076
Coarse Overall F1 Score: 0.1683
Fine Overall Accuracy: 0.3939
Fine Overall F1 Score: 0.0514

Training for coarse_and_fine level...
batch 100, loss: 3.7089, instance_loss: 0.8290, weighted_loss: 2.8449, label: 3, bag_size: 378
batch 200, loss: 1.9261, instance_loss: 0.7781, weighted_loss: 1.5817, label: 5, bag_size: 138
batch 300, loss: 4.9235, instance_loss: 0.8499, weighted_loss: 3.7014, label: 10, bag_size: 309
batch 400, loss: 4.0989, instance_loss: 0.7954, weighted_loss: 3.1078, label: 3, bag_size: 972
batch 500, loss: 1.9164, instance_loss: 0.7995, weighted_loss: 1.5814, label: 5, bag_size: 1000
batch 600, loss: 4.8703, instance_loss: 0.7678, weighted_loss: 3.6396, label: 7, bag_size: 263
batch 700, loss: 3.9513, instance_loss: 0.6955, weighted_loss: 2.9746, label: 4, bag_size: 402
batch 800, loss: 4.5746, instance_loss: 0.7353, weighted_loss: 3.4228, label: 8, bag_size: 151
batch 900, loss: 1.7452, instance_loss: 0.6900, weighted_loss: 1.4287, label: 5, bag_size: 880
batch 1000, loss: 1.7107, instance_loss: 0.6988, weighted_loss: 1.4071, label: 5, bag_size: 573
batch 1100, loss: 1.6316, instance_loss: 0.6653, weighted_loss: 1.3417, label: 5, bag_size: 1048
batch 1200, loss: 5.5169, instance_loss: 0.6912, weighted_loss: 4.0692, label: 10, bag_size: 372
batch 1300, loss: 1.6681, instance_loss: 0.6042, weighted_loss: 1.3489, label: 5, bag_size: 575
batch 1400, loss: 1.9690, instance_loss: 0.6626, weighted_loss: 1.5771, label: 5, bag_size: 112
batch 1500, loss: 1.5708, instance_loss: 0.5314, weighted_loss: 1.2590, label: 5, bag_size: 779
batch 1600, loss: 3.8011, instance_loss: 0.5411, weighted_loss: 2.8231, label: 4, bag_size: 235
batch 1700, loss: 1.5924, instance_loss: 0.5761, weighted_loss: 1.2875, label: 5, bag_size: 569
batch 1800, loss: 1.4942, instance_loss: 0.5736, weighted_loss: 1.2180, label: 5, bag_size: 841
batch 1900, loss: 1.7529, instance_loss: 0.4824, weighted_loss: 1.3718, label: 5, bag_size: 310
batch 2000, loss: 2.8592, instance_loss: 0.5519, weighted_loss: 2.1670, label: 2, bag_size: 381
batch 2100, loss: 2.6529, instance_loss: 0.5067, weighted_loss: 2.0090, label: 2, bag_size: 691

Instance Classifier Stats
class 0 clustering acc 0.9881182795698925: correct 257306/260400
class 1 clustering acc 0.020967741935483872: correct 364/17360

Epoch: 2, train_loss: 2.8582, train_clustering_loss: 0.6701, train_error: 0.6120
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.03324808184143223, correct coarse 26/782
coarse class 2: coarse acc 0.9908003679852806, correct coarse 1077/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.009671179883945842, correct fine 5/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.9988066825775657, correct fine 837/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.7268, coarse auc: 0.6782, fine auc: 0.6115
class 0 clustering acc 0.9999368686868687: correct 31678/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.041666666666666664, correct coarse 4/96
coarse class 2: coarse acc 0.9850746268656716, correct coarse 132/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.0, correct fine 0/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 1.0, correct fine 104/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.5152
Coarse Overall F1 Score: 0.1882
Fine Overall Accuracy: 0.3939
Fine Overall F1 Score: 0.0514

Training for coarse_and_fine level...
batch 100, loss: 2.9479, instance_loss: 0.5572, weighted_loss: 2.2307, label: 6, bag_size: 245
batch 200, loss: 4.5185, instance_loss: 0.5610, weighted_loss: 3.3313, label: 8, bag_size: 427
batch 300, loss: 2.9516, instance_loss: 0.4474, weighted_loss: 2.2004, label: 2, bag_size: 533
batch 400, loss: 4.6437, instance_loss: 0.4809, weighted_loss: 3.3948, label: 8, bag_size: 65
batch 500, loss: 3.7544, instance_loss: 0.4557, weighted_loss: 2.7648, label: 4, bag_size: 909
batch 600, loss: 2.6450, instance_loss: 0.5645, weighted_loss: 2.0209, label: 2, bag_size: 700
batch 700, loss: 3.9850, instance_loss: 0.4850, weighted_loss: 2.9350, label: 3, bag_size: 1313
batch 800, loss: 2.5036, instance_loss: 0.4200, weighted_loss: 1.8785, label: 2, bag_size: 1490
batch 900, loss: 4.5702, instance_loss: 0.4894, weighted_loss: 3.3460, label: 8, bag_size: 160
batch 1000, loss: 2.1813, instance_loss: 0.3825, weighted_loss: 1.6417, label: 5, bag_size: 770
batch 1100, loss: 2.6533, instance_loss: 0.4005, weighted_loss: 1.9775, label: 2, bag_size: 73
batch 1200, loss: 1.0813, instance_loss: 0.4246, weighted_loss: 0.8843, label: 5, bag_size: 764
batch 1300, loss: 1.8084, instance_loss: 0.3378, weighted_loss: 1.3672, label: 5, bag_size: 229
batch 1400, loss: 1.3777, instance_loss: 0.3219, weighted_loss: 1.0610, label: 5, bag_size: 457
batch 1500, loss: 1.0573, instance_loss: 0.3119, weighted_loss: 0.8336, label: 5, bag_size: 460
batch 1600, loss: 1.3224, instance_loss: 0.2966, weighted_loss: 1.0147, label: 5, bag_size: 483
batch 1700, loss: 5.4462, instance_loss: 0.3600, weighted_loss: 3.9203, label: 8, bag_size: 419
batch 1800, loss: 2.8783, instance_loss: 0.4322, weighted_loss: 2.1445, label: 6, bag_size: 304
batch 1900, loss: 5.1293, instance_loss: 0.3467, weighted_loss: 3.6945, label: 7, bag_size: 681
batch 2000, loss: 2.9275, instance_loss: 0.3281, weighted_loss: 2.1477, label: 6, bag_size: 299
batch 2100, loss: 1.8025, instance_loss: 0.2858, weighted_loss: 1.3475, label: 5, bag_size: 429

Instance Classifier Stats
class 0 clustering acc 0.9998233486943164: correct 260354/260400
class 1 clustering acc 0.0006336405529953918: correct 11/17360

Epoch: 3, train_loss: 2.7325, train_clustering_loss: 0.4085, train_error: 0.6065
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.16624040920716113, correct coarse 130/782
coarse class 2: coarse acc 0.9714811407543699, correct coarse 1056/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.04061895551257253, correct fine 21/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.9940334128878282, correct fine 833/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.6432, coarse auc: 0.6869, fine auc: 0.6294
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.3645833333333333, correct coarse 35/96
coarse class 2: coarse acc 0.9104477611940298, correct coarse 122/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.171875, correct fine 11/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.9807692307692307, correct fine 102/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.5947
Coarse Overall F1 Score: 0.2937
Fine Overall Accuracy: 0.4280
Fine Overall F1 Score: 0.0772

Training for coarse_and_fine level...
batch 100, loss: 1.2288, instance_loss: 0.2680, weighted_loss: 0.9405, label: 5, bag_size: 193
batch 200, loss: 2.9528, instance_loss: 0.4021, weighted_loss: 2.1876, label: 6, bag_size: 334
batch 300, loss: 7.5512, instance_loss: 0.3362, weighted_loss: 5.3867, label: 1, bag_size: 260
batch 400, loss: 0.9569, instance_loss: 0.2795, weighted_loss: 0.7537, label: 5, bag_size: 444
batch 500, loss: 1.6371, instance_loss: 0.2921, weighted_loss: 1.2336, label: 5, bag_size: 121
batch 600, loss: 4.7317, instance_loss: 0.2849, weighted_loss: 3.3977, label: 8, bag_size: 543
batch 700, loss: 1.6700, instance_loss: 0.2556, weighted_loss: 1.2457, label: 5, bag_size: 860
batch 800, loss: 5.1481, instance_loss: 0.3002, weighted_loss: 3.6937, label: 7, bag_size: 133
batch 900, loss: 1.3803, instance_loss: 0.2883, weighted_loss: 1.0527, label: 5, bag_size: 424
batch 1000, loss: 2.8462, instance_loss: 0.2882, weighted_loss: 2.0788, label: 6, bag_size: 477
batch 1100, loss: 0.9288, instance_loss: 0.2269, weighted_loss: 0.7182, label: 5, bag_size: 537
batch 1200, loss: 1.9980, instance_loss: 0.3159, weighted_loss: 1.4934, label: 2, bag_size: 2121
batch 1300, loss: 1.5561, instance_loss: 0.2346, weighted_loss: 1.1596, label: 5, bag_size: 148
batch 1400, loss: 5.6947, instance_loss: 0.3014, weighted_loss: 4.0767, label: 10, bag_size: 391
batch 1500, loss: 4.0693, instance_loss: 0.2936, weighted_loss: 2.9366, label: 3, bag_size: 188
batch 1600, loss: 0.7821, instance_loss: 0.2417, weighted_loss: 0.6200, label: 5, bag_size: 451
batch 1700, loss: 3.0548, instance_loss: 0.3328, weighted_loss: 2.2382, label: 6, bag_size: 559
batch 1800, loss: 1.0749, instance_loss: 0.2090, weighted_loss: 0.8151, label: 5, bag_size: 506
batch 1900, loss: 4.5515, instance_loss: 0.2608, weighted_loss: 3.2643, label: 8, bag_size: 663
batch 2000, loss: 4.6290, instance_loss: 0.2949, weighted_loss: 3.3287, label: 8, bag_size: 383
batch 2100, loss: 2.3427, instance_loss: 0.2474, weighted_loss: 1.7141, label: 2, bag_size: 1229

Instance Classifier Stats
class 0 clustering acc 0.999984639016897: correct 260396/260400
class 1 clustering acc 0.0001152073732718894: correct 2/17360

Epoch: 4, train_loss: 2.6647, train_clustering_loss: 0.2803, train_error: 0.5783
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.38618925831202044, correct coarse 302/782
coarse class 2: coarse acc 0.9006439742410304, correct coarse 979/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.17988394584139264, correct fine 93/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.9809069212410502, correct fine 822/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.5907, coarse auc: 0.6946, fine auc: 0.6454
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.4791666666666667, correct coarse 46/96
coarse class 2: coarse acc 0.9029850746268657, correct coarse 121/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.25, correct fine 16/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.9615384615384616, correct fine 100/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6326
Coarse Overall F1 Score: 0.3227
Fine Overall Accuracy: 0.4394
Fine Overall F1 Score: 0.0847

Training for coarse_and_fine level...
batch 100, loss: 3.0210, instance_loss: 0.2805, weighted_loss: 2.1988, label: 6, bag_size: 231
batch 200, loss: 2.7128, instance_loss: 0.2752, weighted_loss: 1.9815, label: 6, bag_size: 244
batch 300, loss: 2.3066, instance_loss: 0.2424, weighted_loss: 1.6874, label: 2, bag_size: 1744
batch 400, loss: 1.9720, instance_loss: 0.1973, weighted_loss: 1.4396, label: 5, bag_size: 252
batch 500, loss: 3.5783, instance_loss: 0.2660, weighted_loss: 2.5846, label: 3, bag_size: 836
batch 600, loss: 2.1094, instance_loss: 0.2865, weighted_loss: 1.5625, label: 2, bag_size: 206
batch 700, loss: 1.4747, instance_loss: 0.1809, weighted_loss: 1.0866, label: 5, bag_size: 304
batch 800, loss: 1.0736, instance_loss: 0.1942, weighted_loss: 0.8098, label: 5, bag_size: 242
batch 900, loss: 1.2270, instance_loss: 0.1857, weighted_loss: 0.9146, label: 5, bag_size: 253
batch 1000, loss: 5.0846, instance_loss: 0.2528, weighted_loss: 3.6351, label: 8, bag_size: 216
batch 1100, loss: 2.2226, instance_loss: 0.2189, weighted_loss: 1.6215, label: 2, bag_size: 383
batch 1200, loss: 0.9801, instance_loss: 0.1855, weighted_loss: 0.7417, label: 5, bag_size: 424
batch 1300, loss: 4.4660, instance_loss: 0.2343, weighted_loss: 3.1965, label: 8, bag_size: 372
batch 1400, loss: 4.8227, instance_loss: 0.2253, weighted_loss: 3.4435, label: 8, bag_size: 461
batch 1500, loss: 3.0813, instance_loss: 0.2349, weighted_loss: 2.2274, label: 6, bag_size: 252
batch 1600, loss: 3.6931, instance_loss: 0.2420, weighted_loss: 2.6577, label: 4, bag_size: 169
batch 1700, loss: 1.5528, instance_loss: 0.2287, weighted_loss: 1.1556, label: 2, bag_size: 2692
batch 1800, loss: 4.7990, instance_loss: 0.2336, weighted_loss: 3.4294, label: 8, bag_size: 571
batch 1900, loss: 1.8346, instance_loss: 0.2272, weighted_loss: 1.3524, label: 2, bag_size: 1216
batch 2000, loss: 2.2099, instance_loss: 0.2067, weighted_loss: 1.6090, label: 2, bag_size: 309
batch 2100, loss: 2.5048, instance_loss: 0.2232, weighted_loss: 1.8203, label: 2, bag_size: 1704

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 5.76036866359447e-05: correct 1/17360

Epoch: 5, train_loss: 2.6141, train_clustering_loss: 0.2250, train_error: 0.5599
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.4731457800511509, correct coarse 370/782
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.2862669245647969, correct fine 148/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.9630071599045346, correct fine 807/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.5507, coarse auc: 0.7018, fine auc: 0.6560
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.5104166666666666, correct coarse 49/96
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.375, correct fine 24/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.9423076923076923, correct fine 98/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6326
Coarse Overall F1 Score: 0.3250
Fine Overall Accuracy: 0.4621
Fine Overall F1 Score: 0.0945

Training for coarse_and_fine level...
batch 100, loss: 6.4340, instance_loss: 0.2493, weighted_loss: 4.5786, label: 7, bag_size: 393
batch 200, loss: 2.2867, instance_loss: 0.1719, weighted_loss: 1.6523, label: 5, bag_size: 371
batch 300, loss: 2.2605, instance_loss: 0.2159, weighted_loss: 1.6471, label: 5, bag_size: 40
batch 400, loss: 1.1669, instance_loss: 0.1907, weighted_loss: 0.8740, label: 5, bag_size: 12
batch 500, loss: 2.4904, instance_loss: 0.2099, weighted_loss: 1.8063, label: 6, bag_size: 555
batch 600, loss: 4.0341, instance_loss: 0.2442, weighted_loss: 2.8971, label: 3, bag_size: 188
batch 700, loss: 3.5461, instance_loss: 0.2281, weighted_loss: 2.5507, label: 4, bag_size: 889
batch 800, loss: 1.9258, instance_loss: 0.1785, weighted_loss: 1.4016, label: 5, bag_size: 331
batch 900, loss: 3.4958, instance_loss: 0.2264, weighted_loss: 2.5150, label: 4, bag_size: 1301
batch 1000, loss: 4.9975, instance_loss: 0.2476, weighted_loss: 3.5725, label: 7, bag_size: 132
batch 1100, loss: 0.7074, instance_loss: 0.1569, weighted_loss: 0.5423, label: 5, bag_size: 714
batch 1200, loss: 1.1883, instance_loss: 0.1674, weighted_loss: 0.8820, label: 5, bag_size: 887
batch 1300, loss: 5.0521, instance_loss: 0.2252, weighted_loss: 3.6040, label: 8, bag_size: 1105
batch 1400, loss: 2.3553, instance_loss: 0.2182, weighted_loss: 1.7142, label: 2, bag_size: 530
batch 1500, loss: 1.2246, instance_loss: 0.1699, weighted_loss: 0.9082, label: 5, bag_size: 216
batch 1600, loss: 2.7180, instance_loss: 0.2007, weighted_loss: 1.9628, label: 2, bag_size: 726
batch 1700, loss: 2.2475, instance_loss: 0.1658, weighted_loss: 1.6230, label: 5, bag_size: 309
batch 1800, loss: 1.9173, instance_loss: 0.2477, weighted_loss: 1.4164, label: 2, bag_size: 748
batch 1900, loss: 1.0939, instance_loss: 0.1416, weighted_loss: 0.8082, label: 5, bag_size: 393
batch 2000, loss: 7.5543, instance_loss: 0.2658, weighted_loss: 5.3677, label: 1, bag_size: 554
batch 2100, loss: 4.5780, instance_loss: 0.2290, weighted_loss: 3.2733, label: 8, bag_size: 380

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 6, train_loss: 2.5728, train_clustering_loss: 0.2008, train_error: 0.5475
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.5281329923273658, correct coarse 413/782
coarse class 2: coarse acc 0.8638454461821528, correct coarse 939/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.37524177949709864, correct fine 194/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.9403341288782816, correct fine 788/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.5177, coarse auc: 0.7060, fine auc: 0.6668
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.5416666666666666, correct coarse 52/96
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.515625, correct fine 33/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.9134615384615384, correct fine 95/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3305
Fine Overall Accuracy: 0.4848
Fine Overall F1 Score: 0.1026

Training for coarse_and_fine level...
batch 100, loss: 1.5561, instance_loss: 0.1570, weighted_loss: 1.1364, label: 5, bag_size: 210
batch 200, loss: 3.5574, instance_loss: 0.2283, weighted_loss: 2.5587, label: 4, bag_size: 821
batch 300, loss: 1.9866, instance_loss: 0.1613, weighted_loss: 1.4390, label: 5, bag_size: 469
batch 400, loss: 3.8782, instance_loss: 0.2389, weighted_loss: 2.7865, label: 8, bag_size: 536
batch 500, loss: 2.3531, instance_loss: 0.1992, weighted_loss: 1.7069, label: 2, bag_size: 530
batch 600, loss: 2.7722, instance_loss: 0.2160, weighted_loss: 2.0053, label: 6, bag_size: 201
batch 700, loss: 0.8365, instance_loss: 0.1375, weighted_loss: 0.6268, label: 5, bag_size: 1140
batch 800, loss: 1.4658, instance_loss: 0.1977, weighted_loss: 1.0854, label: 2, bag_size: 558
batch 900, loss: 2.9631, instance_loss: 0.2288, weighted_loss: 2.1428, label: 6, bag_size: 3471
batch 1000, loss: 2.3326, instance_loss: 0.2036, weighted_loss: 1.6939, label: 2, bag_size: 1232
batch 1100, loss: 1.6163, instance_loss: 0.2019, weighted_loss: 1.1920, label: 2, bag_size: 1226
batch 1200, loss: 1.0278, instance_loss: 0.1398, weighted_loss: 0.7614, label: 5, bag_size: 1304
batch 1300, loss: 3.0972, instance_loss: 0.2014, weighted_loss: 2.2285, label: 2, bag_size: 115
batch 1400, loss: 2.5588, instance_loss: 0.2005, weighted_loss: 1.8513, label: 6, bag_size: 482
batch 1500, loss: 1.6032, instance_loss: 0.2025, weighted_loss: 1.1830, label: 2, bag_size: 1531
batch 1600, loss: 6.0084, instance_loss: 0.2737, weighted_loss: 4.2880, label: 9, bag_size: 237
batch 1700, loss: 2.6805, instance_loss: 0.1865, weighted_loss: 1.9323, label: 2, bag_size: 265
batch 1800, loss: 6.0356, instance_loss: 0.2751, weighted_loss: 4.3074, label: 1, bag_size: 113
batch 1900, loss: 0.9836, instance_loss: 0.1450, weighted_loss: 0.7320, label: 5, bag_size: 123
batch 2000, loss: 0.9250, instance_loss: 0.1440, weighted_loss: 0.6907, label: 5, bag_size: 279
batch 2100, loss: 2.7959, instance_loss: 0.1902, weighted_loss: 2.0142, label: 6, bag_size: 284

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 7, train_loss: 2.5373, train_clustering_loss: 0.1897, train_error: 0.5401
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.571611253196931, correct coarse 447/782
coarse class 2: coarse acc 0.8537258509659613, correct coarse 928/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.4584139264990329, correct fine 237/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.9081145584725537, correct fine 761/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.4900, coarse auc: 0.7132, fine auc: 0.6761
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.5625, correct coarse 54/96
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.5625, correct fine 36/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.9134615384615384, correct fine 95/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3338
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1058

Training for coarse_and_fine level...
batch 100, loss: 0.9605, instance_loss: 0.1295, weighted_loss: 0.7112, label: 5, bag_size: 364
batch 200, loss: 2.4116, instance_loss: 0.1904, weighted_loss: 1.7453, label: 2, bag_size: 347
batch 300, loss: 2.2401, instance_loss: 0.1741, weighted_loss: 1.6203, label: 5, bag_size: 129
batch 400, loss: 2.3295, instance_loss: 0.1609, weighted_loss: 1.6789, label: 5, bag_size: 466
batch 500, loss: 0.7021, instance_loss: 0.1308, weighted_loss: 0.5307, label: 5, bag_size: 632
batch 600, loss: 3.4031, instance_loss: 0.2437, weighted_loss: 2.4553, label: 4, bag_size: 223
batch 700, loss: 2.8450, instance_loss: 0.2155, weighted_loss: 2.0561, label: 3, bag_size: 1947
batch 800, loss: 0.7579, instance_loss: 0.1219, weighted_loss: 0.5671, label: 5, bag_size: 622
batch 900, loss: 3.9205, instance_loss: 0.2358, weighted_loss: 2.8151, label: 3, bag_size: 495
batch 1000, loss: 1.7452, instance_loss: 0.1338, weighted_loss: 1.2618, label: 5, bag_size: 1062
batch 1100, loss: 0.4133, instance_loss: 0.1193, weighted_loss: 0.3251, label: 5, bag_size: 414
batch 1200, loss: 4.4075, instance_loss: 0.1854, weighted_loss: 3.1409, label: 2, bag_size: 306
batch 1300, loss: 1.9061, instance_loss: 0.1720, weighted_loss: 1.3858, label: 2, bag_size: 374
batch 1400, loss: 3.2625, instance_loss: 0.1986, weighted_loss: 2.3433, label: 6, bag_size: 409
batch 1500, loss: 1.5278, instance_loss: 0.1390, weighted_loss: 1.1111, label: 5, bag_size: 271
batch 1600, loss: 3.2103, instance_loss: 0.2191, weighted_loss: 2.3129, label: 6, bag_size: 1836
batch 1700, loss: 1.6528, instance_loss: 0.1839, weighted_loss: 1.2122, label: 2, bag_size: 309
batch 1800, loss: 2.4669, instance_loss: 0.2107, weighted_loss: 1.7900, label: 6, bag_size: 333
batch 1900, loss: 1.0317, instance_loss: 0.1404, weighted_loss: 0.7643, label: 5, bag_size: 802
batch 2000, loss: 4.7674, instance_loss: 0.2355, weighted_loss: 3.4078, label: 8, bag_size: 253
batch 2100, loss: 1.9217, instance_loss: 0.1398, weighted_loss: 1.3871, label: 5, bag_size: 1549

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 8, train_loss: 2.5068, train_clustering_loss: 0.1836, train_error: 0.5355
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6023017902813299, correct coarse 471/782
coarse class 2: coarse acc 0.8362465501379944, correct coarse 909/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5087040618955513, correct fine 263/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8890214797136038, correct fine 745/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.4656, coarse auc: 0.7195, fine auc: 0.6874
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.5729166666666666, correct coarse 55/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.5625, correct fine 36/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.9038461538461539, correct fine 94/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3327
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1046

Training for coarse_and_fine level...
batch 100, loss: 4.1855, instance_loss: 0.2224, weighted_loss: 2.9966, label: 8, bag_size: 565
batch 200, loss: 2.7500, instance_loss: 0.1679, weighted_loss: 1.9754, label: 5, bag_size: 280
batch 300, loss: 2.7665, instance_loss: 0.1454, weighted_loss: 1.9801, label: 5, bag_size: 1555
batch 400, loss: 3.0928, instance_loss: 0.2137, weighted_loss: 2.2291, label: 3, bag_size: 774
batch 500, loss: 2.5575, instance_loss: 0.1787, weighted_loss: 1.8439, label: 2, bag_size: 343
batch 600, loss: 3.0610, instance_loss: 0.2121, weighted_loss: 2.2064, label: 3, bag_size: 945
batch 700, loss: 4.7495, instance_loss: 0.2319, weighted_loss: 3.3942, label: 8, bag_size: 501
batch 800, loss: 4.0018, instance_loss: 0.2331, weighted_loss: 2.8712, label: 3, bag_size: 347
batch 900, loss: 3.2227, instance_loss: 0.2275, weighted_loss: 2.3241, label: 4, bag_size: 2131
batch 1000, loss: 4.4205, instance_loss: 0.2369, weighted_loss: 3.1654, label: 8, bag_size: 260
batch 1100, loss: 2.3882, instance_loss: 0.1968, weighted_loss: 1.7308, label: 6, bag_size: 361
batch 1200, loss: 2.6695, instance_loss: 0.2181, weighted_loss: 1.9341, label: 6, bag_size: 850
batch 1300, loss: 4.7463, instance_loss: 0.2333, weighted_loss: 3.3924, label: 7, bag_size: 133
batch 1400, loss: 3.0090, instance_loss: 0.2115, weighted_loss: 2.1698, label: 3, bag_size: 567
batch 1500, loss: 2.5518, instance_loss: 0.1789, weighted_loss: 1.8399, label: 2, bag_size: 204
batch 1600, loss: 4.8677, instance_loss: 0.2380, weighted_loss: 3.4788, label: 8, bag_size: 558
batch 1700, loss: 1.5345, instance_loss: 0.1701, weighted_loss: 1.1252, label: 2, bag_size: 252
batch 1800, loss: 3.4973, instance_loss: 0.2363, weighted_loss: 2.5190, label: 3, bag_size: 1185
batch 1900, loss: 2.2401, instance_loss: 0.1891, weighted_loss: 1.6248, label: 2, bag_size: 1897
batch 2000, loss: 1.9517, instance_loss: 0.1342, weighted_loss: 1.4064, label: 5, bag_size: 225
batch 2100, loss: 3.4489, instance_loss: 0.2508, weighted_loss: 2.4895, label: 4, bag_size: 425

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 5.76036866359447e-05: correct 1/17360

Epoch: 9, train_loss: 2.4795, train_clustering_loss: 0.1801, train_error: 0.5300
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6163682864450127, correct coarse 482/782
coarse class 2: coarse acc 0.8380864765409384, correct coarse 911/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5319148936170213, correct fine 275/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8890214797136038, correct fine 745/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.4439, coarse auc: 0.7290, fine auc: 0.6970
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96
coarse class 2: coarse acc 0.7985074626865671, correct coarse 107/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.59375, correct fine 38/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8942307692307693, correct fine 93/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6250
Coarse Overall F1 Score: 0.3272
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1058

Training for coarse_and_fine level...
batch 100, loss: 1.6140, instance_loss: 0.1745, weighted_loss: 1.1822, label: 2, bag_size: 725
batch 200, loss: 3.0285, instance_loss: 0.1827, weighted_loss: 2.1748, label: 2, bag_size: 631
batch 300, loss: 2.1464, instance_loss: 0.1731, weighted_loss: 1.5544, label: 2, bag_size: 193
batch 400, loss: 1.3178, instance_loss: 0.1213, weighted_loss: 0.9588, label: 5, bag_size: 370
batch 500, loss: 1.1649, instance_loss: 0.1723, weighted_loss: 0.8671, label: 2, bag_size: 379
batch 600, loss: 2.8377, instance_loss: 0.1848, weighted_loss: 2.0418, label: 2, bag_size: 565
batch 700, loss: 3.4300, instance_loss: 0.2457, weighted_loss: 2.4747, label: 4, bag_size: 425
batch 800, loss: 0.7692, instance_loss: 0.1192, weighted_loss: 0.5742, label: 5, bag_size: 396
batch 900, loss: 0.6990, instance_loss: 0.1067, weighted_loss: 0.5213, label: 5, bag_size: 318
batch 1000, loss: 4.3621, instance_loss: 0.2277, weighted_loss: 3.1218, label: 8, bag_size: 141
batch 1100, loss: 2.6848, instance_loss: 0.2206, weighted_loss: 1.9456, label: 3, bag_size: 1172
batch 1200, loss: 1.7978, instance_loss: 0.1775, weighted_loss: 1.3117, label: 2, bag_size: 405
batch 1300, loss: 2.4331, instance_loss: 0.2094, weighted_loss: 1.7660, label: 6, bag_size: 686
batch 1400, loss: 3.4906, instance_loss: 0.2310, weighted_loss: 2.5127, label: 3, bag_size: 1667
batch 1500, loss: 0.3634, instance_loss: 0.1131, weighted_loss: 0.2883, label: 5, bag_size: 278
batch 1600, loss: 1.4125, instance_loss: 0.1634, weighted_loss: 1.0378, label: 2, bag_size: 2239
batch 1700, loss: 3.0978, instance_loss: 0.2126, weighted_loss: 2.2323, label: 4, bag_size: 88
batch 1800, loss: 1.9670, instance_loss: 0.1359, weighted_loss: 1.4177, label: 5, bag_size: 1364
batch 1900, loss: 1.4697, instance_loss: 0.1229, weighted_loss: 1.0656, label: 5, bag_size: 729
batch 2000, loss: 0.5104, instance_loss: 0.1188, weighted_loss: 0.3929, label: 5, bag_size: 1110
batch 2100, loss: 0.7736, instance_loss: 0.1368, weighted_loss: 0.5826, label: 5, bag_size: 475

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 5.76036866359447e-05: correct 1/17360

Epoch: 10, train_loss: 2.4550, train_clustering_loss: 0.1775, train_error: 0.5272
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782
coarse class 2: coarse acc 0.8141674333026679, correct coarse 885/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.586073500967118, correct fine 303/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8627684964200477, correct fine 723/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.4233, coarse auc: 0.7351, fine auc: 0.7056
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.59375, correct coarse 57/96
coarse class 2: coarse acc 0.8059701492537313, correct coarse 108/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.59375, correct fine 38/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.9038461538461539, correct fine 94/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6250
Coarse Overall F1 Score: 0.3268
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1066

Training for coarse_and_fine level...
batch 100, loss: 0.7574, instance_loss: 0.1614, weighted_loss: 0.5786, label: 2, bag_size: 305
batch 200, loss: 2.8526, instance_loss: 0.1572, weighted_loss: 2.0440, label: 5, bag_size: 304
batch 300, loss: 3.4507, instance_loss: 0.2390, weighted_loss: 2.4872, label: 4, bag_size: 483
batch 400, loss: 1.0775, instance_loss: 0.1657, weighted_loss: 0.8040, label: 2, bag_size: 762
batch 500, loss: 2.8478, instance_loss: 0.1818, weighted_loss: 2.0480, label: 2, bag_size: 493
batch 600, loss: 1.3652, instance_loss: 0.1695, weighted_loss: 1.0065, label: 2, bag_size: 1847
batch 700, loss: 0.6948, instance_loss: 0.1131, weighted_loss: 0.5203, label: 5, bag_size: 429
batch 800, loss: 3.1263, instance_loss: 0.1940, weighted_loss: 2.2466, label: 2, bag_size: 541
batch 900, loss: 2.5072, instance_loss: 0.2193, weighted_loss: 1.8208, label: 6, bag_size: 1239
batch 1000, loss: 0.1724, instance_loss: 0.1077, weighted_loss: 0.1530, label: 5, bag_size: 336
batch 1100, loss: 1.5785, instance_loss: 0.1679, weighted_loss: 1.1553, label: 2, bag_size: 1374
batch 1200, loss: 2.5486, instance_loss: 0.1991, weighted_loss: 1.8438, label: 6, bag_size: 424
batch 1300, loss: 4.5726, instance_loss: 0.2364, weighted_loss: 3.2717, label: 8, bag_size: 430
batch 1400, loss: 1.1362, instance_loss: 0.1636, weighted_loss: 0.8444, label: 2, bag_size: 988
batch 1500, loss: 0.8056, instance_loss: 0.1120, weighted_loss: 0.5976, label: 5, bag_size: 461
batch 1600, loss: 2.7179, instance_loss: 0.2261, weighted_loss: 1.9704, label: 3, bag_size: 813
batch 1700, loss: 2.7034, instance_loss: 0.2112, weighted_loss: 1.9557, label: 6, bag_size: 406
batch 1800, loss: 3.3830, instance_loss: 0.2225, weighted_loss: 2.4348, label: 3, bag_size: 375
batch 1900, loss: 0.6158, instance_loss: 0.1170, weighted_loss: 0.4661, label: 5, bag_size: 956
batch 2000, loss: 0.6591, instance_loss: 0.1162, weighted_loss: 0.4962, label: 5, bag_size: 394
batch 2100, loss: 1.0976, instance_loss: 0.1179, weighted_loss: 0.8037, label: 5, bag_size: 360

Instance Classifier Stats
class 0 clustering acc 0.999984639016897: correct 260396/260400
class 1 clustering acc 0.0002304147465437788: correct 4/17360

Epoch: 11, train_loss: 2.4303, train_clustering_loss: 0.1756, train_error: 0.5249
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782
coarse class 2: coarse acc 0.8224471021159153, correct coarse 894/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5783365570599613, correct fine 299/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8735083532219571, correct fine 732/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.4054, coarse auc: 0.7421, fine auc: 0.7158
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96
coarse class 2: coarse acc 0.7835820895522388, correct coarse 105/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.625, correct fine 40/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8269230769230769, correct fine 86/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6326
Coarse Overall F1 Score: 0.3330
Fine Overall Accuracy: 0.4773
Fine Overall F1 Score: 0.1025

Training for coarse_and_fine level...
batch 100, loss: 4.5667, instance_loss: 0.2404, weighted_loss: 3.2688, label: 8, bag_size: 430
batch 200, loss: 2.5999, instance_loss: 0.2137, weighted_loss: 1.8840, label: 6, bag_size: 896
batch 300, loss: 0.8611, instance_loss: 0.1724, weighted_loss: 0.6545, label: 2, bag_size: 1561
batch 400, loss: 1.7550, instance_loss: 0.1258, weighted_loss: 1.2662, label: 5, bag_size: 373
batch 500, loss: 6.6705, instance_loss: 0.2870, weighted_loss: 4.7554, label: 10, bag_size: 829
batch 600, loss: 1.7978, instance_loss: 0.1137, weighted_loss: 1.2926, label: 5, bag_size: 548
batch 700, loss: 3.6707, instance_loss: 0.2283, weighted_loss: 2.6380, label: 3, bag_size: 174
batch 800, loss: 1.6945, instance_loss: 0.1332, weighted_loss: 1.2261, label: 5, bag_size: 210
batch 900, loss: 5.2832, instance_loss: 0.2463, weighted_loss: 3.7721, label: 7, bag_size: 716
batch 1000, loss: 3.5004, instance_loss: 0.1655, weighted_loss: 2.5000, label: 5, bag_size: 2146
batch 1100, loss: 4.1263, instance_loss: 0.2189, weighted_loss: 2.9541, label: 8, bag_size: 661
batch 1200, loss: 0.3147, instance_loss: 0.1118, weighted_loss: 0.2538, label: 5, bag_size: 507
batch 1300, loss: 1.1514, instance_loss: 0.1165, weighted_loss: 0.8409, label: 5, bag_size: 358
batch 1400, loss: 0.2163, instance_loss: 0.0967, weighted_loss: 0.1804, label: 5, bag_size: 210
batch 1500, loss: 3.4359, instance_loss: 0.1886, weighted_loss: 2.4617, label: 2, bag_size: 764
batch 1600, loss: 0.3514, instance_loss: 0.1026, weighted_loss: 0.2767, label: 5, bag_size: 403
batch 1700, loss: 0.7423, instance_loss: 0.1200, weighted_loss: 0.5556, label: 5, bag_size: 478
batch 1800, loss: 3.1881, instance_loss: 0.2311, weighted_loss: 2.3010, label: 4, bag_size: 313
batch 1900, loss: 1.7391, instance_loss: 0.1728, weighted_loss: 1.2692, label: 2, bag_size: 2612
batch 2000, loss: 5.8504, instance_loss: 0.2166, weighted_loss: 4.1603, label: 8, bag_size: 1009
batch 2100, loss: 3.4291, instance_loss: 0.2148, weighted_loss: 2.4648, label: 4, bag_size: 607

Instance Classifier Stats
class 0 clustering acc 0.9999923195084486: correct 260398/260400
class 1 clustering acc 0.0006912442396313364: correct 12/17360

Epoch: 12, train_loss: 2.4103, train_clustering_loss: 0.1740, train_error: 0.5244
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782
coarse class 2: coarse acc 0.8104875804967802, correct coarse 881/1087
coarse class 3: coarse acc 0.0, correct coarse 0/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6170212765957447, correct fine 319/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.850835322195704, correct fine 713/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.3872, coarse auc: 0.7482, fine auc: 0.7207
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96
coarse class 2: coarse acc 0.7985074626865671, correct coarse 107/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.625, correct fine 40/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8653846153846154, correct fine 90/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3367
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1054

Training for coarse_and_fine level...
batch 100, loss: 3.5674, instance_loss: 0.2242, weighted_loss: 2.5645, label: 8, bag_size: 228
batch 200, loss: 0.2403, instance_loss: 0.1108, weighted_loss: 0.2014, label: 5, bag_size: 756
batch 300, loss: 1.8165, instance_loss: 0.1508, weighted_loss: 1.3168, label: 2, bag_size: 975
batch 400, loss: 2.0738, instance_loss: 0.1744, weighted_loss: 1.5040, label: 2, bag_size: 1049
batch 500, loss: 1.3941, instance_loss: 0.1293, weighted_loss: 1.0146, label: 5, bag_size: 735
batch 600, loss: 2.9353, instance_loss: 0.2118, weighted_loss: 2.1183, label: 6, bag_size: 651
batch 700, loss: 1.5732, instance_loss: 0.1534, weighted_loss: 1.1473, label: 2, bag_size: 476
batch 800, loss: 1.1912, instance_loss: 0.1894, weighted_loss: 0.8906, label: 2, bag_size: 958
batch 900, loss: 0.6002, instance_loss: 0.1424, weighted_loss: 0.4628, label: 2, bag_size: 619
batch 1000, loss: 2.4796, instance_loss: 0.1533, weighted_loss: 1.7817, label: 5, bag_size: 311
batch 1100, loss: 4.2738, instance_loss: 0.1599, weighted_loss: 3.0396, label: 5, bag_size: 444
batch 1200, loss: 1.3949, instance_loss: 0.1669, weighted_loss: 1.0265, label: 2, bag_size: 252
batch 1300, loss: 3.5586, instance_loss: 0.2067, weighted_loss: 2.5530, label: 2, bag_size: 835
batch 1400, loss: 1.7374, instance_loss: 0.1545, weighted_loss: 1.2625, label: 2, bag_size: 1205
batch 1500, loss: 0.5950, instance_loss: 0.1141, weighted_loss: 0.4507, label: 5, bag_size: 205
batch 1600, loss: 1.5592, instance_loss: 0.1405, weighted_loss: 1.1336, label: 2, bag_size: 333
batch 1700, loss: 3.0906, instance_loss: 0.2221, weighted_loss: 2.2300, label: 3, bag_size: 683
batch 1800, loss: 1.5616, instance_loss: 0.1279, weighted_loss: 1.1315, label: 5, bag_size: 311
batch 1900, loss: 1.4927, instance_loss: 0.1244, weighted_loss: 1.0822, label: 5, bag_size: 350
batch 2000, loss: 2.8547, instance_loss: 0.1750, weighted_loss: 2.0508, label: 2, bag_size: 411
batch 2100, loss: 3.7109, instance_loss: 0.1976, weighted_loss: 2.6569, label: 2, bag_size: 377

Instance Classifier Stats
class 0 clustering acc 0.9999884792626728: correct 260397/260400
class 1 clustering acc 0.0010944700460829493: correct 19/17360

Epoch: 13, train_loss: 2.3902, train_clustering_loss: 0.1724, train_error: 0.5212
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6534526854219949, correct coarse 511/782
coarse class 2: coarse acc 0.8261269549218031, correct coarse 898/1087
coarse class 3: coarse acc 0.007782101167315175, correct coarse 2/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6150870406189555, correct fine 318/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.860381861575179, correct fine 721/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.3708, coarse auc: 0.7544, fine auc: 0.7294
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96
coarse class 2: coarse acc 0.7761194029850746, correct coarse 104/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.640625, correct fine 41/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8365384615384616, correct fine 87/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6288
Coarse Overall F1 Score: 0.3312
Fine Overall Accuracy: 0.4848
Fine Overall F1 Score: 0.1042

Training for coarse_and_fine level...
batch 100, loss: 1.2566, instance_loss: 0.1545, weighted_loss: 0.9260, label: 2, bag_size: 389
batch 200, loss: 3.3634, instance_loss: 0.2015, weighted_loss: 2.4148, label: 2, bag_size: 215
batch 300, loss: 1.8187, instance_loss: 0.1170, weighted_loss: 1.3082, label: 5, bag_size: 644
batch 400, loss: 2.4951, instance_loss: 0.2279, weighted_loss: 1.8149, label: 6, bag_size: 701
batch 500, loss: 1.2603, instance_loss: 0.1132, weighted_loss: 0.9162, label: 5, bag_size: 284
batch 600, loss: 2.6948, instance_loss: 0.2023, weighted_loss: 1.9470, label: 6, bag_size: 545
batch 700, loss: 2.1178, instance_loss: 0.1957, weighted_loss: 1.5412, label: 6, bag_size: 307
batch 800, loss: 1.3804, instance_loss: 0.1215, weighted_loss: 1.0027, label: 5, bag_size: 148
batch 900, loss: 0.6277, instance_loss: 0.0958, weighted_loss: 0.4682, label: 5, bag_size: 498
batch 1000, loss: 0.2331, instance_loss: 0.0932, weighted_loss: 0.1911, label: 5, bag_size: 274
batch 1100, loss: 0.3081, instance_loss: 0.0951, weighted_loss: 0.2442, label: 5, bag_size: 969
batch 1200, loss: 2.0128, instance_loss: 0.1380, weighted_loss: 1.4504, label: 5, bag_size: 106
batch 1300, loss: 0.3206, instance_loss: 0.0977, weighted_loss: 0.2537, label: 5, bag_size: 456
batch 1400, loss: 3.0978, instance_loss: 0.2228, weighted_loss: 2.2353, label: 6, bag_size: 1550
batch 1500, loss: 1.3153, instance_loss: 0.1596, weighted_loss: 0.9686, label: 2, bag_size: 252
batch 1600, loss: 1.6514, instance_loss: 0.1550, weighted_loss: 1.2025, label: 2, bag_size: 691
batch 1700, loss: 2.1408, instance_loss: 0.2078, weighted_loss: 1.5609, label: 6, bag_size: 89
batch 1800, loss: 0.9576, instance_loss: 0.1331, weighted_loss: 0.7103, label: 2, bag_size: 826
batch 1900, loss: 1.1938, instance_loss: 0.1141, weighted_loss: 0.8699, label: 5, bag_size: 1214
batch 2000, loss: 0.9508, instance_loss: 0.1448, weighted_loss: 0.7090, label: 5, bag_size: 11
batch 2100, loss: 0.4646, instance_loss: 0.0914, weighted_loss: 0.3526, label: 5, bag_size: 1137

Instance Classifier Stats
class 0 clustering acc 0.9999807987711213: correct 260395/260400
class 1 clustering acc 0.0025921658986175116: correct 45/17360

Epoch: 14, train_loss: 2.3713, train_clustering_loss: 0.1711, train_error: 0.5226
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6675191815856778, correct coarse 522/782
coarse class 2: coarse acc 0.8095676172953082, correct coarse 880/1087
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6382978723404256, correct fine 330/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8424821002386634, correct fine 706/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.3540, coarse auc: 0.7581, fine auc: 0.7345
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134
coarse class 3: coarse acc 0.0, correct coarse 0/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.640625, correct fine 41/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3400
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1071

Training for coarse_and_fine level...
batch 100, loss: 2.9545, instance_loss: 0.1871, weighted_loss: 2.1243, label: 2, bag_size: 540
batch 200, loss: 3.5745, instance_loss: 0.2298, weighted_loss: 2.5711, label: 7, bag_size: 120
batch 300, loss: 2.4684, instance_loss: 0.2114, weighted_loss: 1.7913, label: 6, bag_size: 896
batch 400, loss: 4.4727, instance_loss: 0.2263, weighted_loss: 3.1988, label: 8, bag_size: 1167
batch 500, loss: 0.8876, instance_loss: 0.0958, weighted_loss: 0.6500, label: 5, bag_size: 510
batch 600, loss: 0.6333, instance_loss: 0.1479, weighted_loss: 0.4877, label: 2, bag_size: 224
batch 700, loss: 5.1527, instance_loss: 0.2616, weighted_loss: 3.6854, label: 7, bag_size: 388
batch 800, loss: 1.9458, instance_loss: 0.1677, weighted_loss: 1.4124, label: 2, bag_size: 965
batch 900, loss: 4.0201, instance_loss: 0.2182, weighted_loss: 2.8795, label: 8, bag_size: 141
batch 1000, loss: 0.3034, instance_loss: 0.1026, weighted_loss: 0.2432, label: 5, bag_size: 711
batch 1100, loss: 2.5021, instance_loss: 0.2333, weighted_loss: 1.8214, label: 3, bag_size: 189
batch 1200, loss: 0.5991, instance_loss: 0.0934, weighted_loss: 0.4474, label: 5, bag_size: 794
batch 1300, loss: 2.4836, instance_loss: 0.2265, weighted_loss: 1.8065, label: 3, bag_size: 1967
batch 1400, loss: 1.2737, instance_loss: 0.1053, weighted_loss: 0.9232, label: 5, bag_size: 624
batch 1500, loss: 1.8270, instance_loss: 0.1289, weighted_loss: 1.3176, label: 5, bag_size: 337
batch 1600, loss: 0.3713, instance_loss: 0.1064, weighted_loss: 0.2918, label: 5, bag_size: 540
batch 1700, loss: 3.9944, instance_loss: 0.1808, weighted_loss: 2.8503, label: 2, bag_size: 317
batch 1800, loss: 0.2062, instance_loss: 0.0879, weighted_loss: 0.1707, label: 5, bag_size: 691
batch 1900, loss: 1.2361, instance_loss: 0.1653, weighted_loss: 0.9149, label: 2, bag_size: 601
batch 2000, loss: 2.6105, instance_loss: 0.1857, weighted_loss: 1.8831, label: 2, bag_size: 894
batch 2100, loss: 4.2783, instance_loss: 0.2390, weighted_loss: 3.0665, label: 8, bag_size: 2218

Instance Classifier Stats
class 0 clustering acc 0.999942396313364: correct 260385/260400
class 1 clustering acc 0.003974654377880184: correct 69/17360

Epoch: 15, train_loss: 2.3529, train_clustering_loss: 0.1697, train_error: 0.5194
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6534526854219949, correct coarse 511/782
coarse class 2: coarse acc 0.8242870285188593, correct coarse 896/1087
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6344294003868471, correct fine 328/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8532219570405728, correct fine 715/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.3389, coarse auc: 0.7614, fine auc: 0.7428
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0: correct 0/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.65625, correct coarse 63/96
coarse class 2: coarse acc 0.7985074626865671, correct coarse 107/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3563
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1083

Training for coarse_and_fine level...
batch 100, loss: 2.3954, instance_loss: 0.1594, weighted_loss: 1.7246, label: 5, bag_size: 429
batch 200, loss: 1.6350, instance_loss: 0.1625, weighted_loss: 1.1932, label: 2, bag_size: 4251
batch 300, loss: 3.7911, instance_loss: 0.2011, weighted_loss: 2.7141, label: 2, bag_size: 910
batch 400, loss: 1.2942, instance_loss: 0.1516, weighted_loss: 0.9514, label: 2, bag_size: 1617
batch 500, loss: 0.5809, instance_loss: 0.0987, weighted_loss: 0.4362, label: 5, bag_size: 691
batch 600, loss: 2.3098, instance_loss: 0.1525, weighted_loss: 1.6626, label: 5, bag_size: 387
batch 700, loss: 5.7996, instance_loss: 0.2721, weighted_loss: 4.1414, label: 7, bag_size: 269
batch 800, loss: 3.2124, instance_loss: 0.2264, weighted_loss: 2.3166, label: 3, bag_size: 483
batch 900, loss: 1.9061, instance_loss: 0.1649, weighted_loss: 1.3837, label: 2, bag_size: 774
batch 1000, loss: 3.2520, instance_loss: 0.2127, weighted_loss: 2.3402, label: 8, bag_size: 245
batch 1100, loss: 0.6758, instance_loss: 0.1188, weighted_loss: 0.5087, label: 5, bag_size: 458
batch 1200, loss: 1.3090, instance_loss: 0.1382, weighted_loss: 0.9578, label: 2, bag_size: 2830
batch 1300, loss: 2.3298, instance_loss: 0.2194, weighted_loss: 1.6967, label: 6, bag_size: 2272
batch 1400, loss: 2.0048, instance_loss: 0.1777, weighted_loss: 1.4567, label: 2, bag_size: 818
batch 1500, loss: 3.3817, instance_loss: 0.2194, weighted_loss: 2.4330, label: 8, bag_size: 228
batch 1600, loss: 2.2996, instance_loss: 0.2125, weighted_loss: 1.6735, label: 6, bag_size: 468
batch 1700, loss: 3.9848, instance_loss: 0.2147, weighted_loss: 2.8538, label: 6, bag_size: 764
batch 1800, loss: 6.0406, instance_loss: 0.2911, weighted_loss: 4.3157, label: 7, bag_size: 599
batch 1900, loss: 1.9029, instance_loss: 0.1452, weighted_loss: 1.3756, label: 5, bag_size: 397
batch 2000, loss: 0.7502, instance_loss: 0.0916, weighted_loss: 0.5526, label: 5, bag_size: 1330
batch 2100, loss: 3.6634, instance_loss: 0.2355, weighted_loss: 2.6350, label: 6, bag_size: 231

Instance Classifier Stats
class 0 clustering acc 0.9998924731182796: correct 260372/260400
class 1 clustering acc 0.0065668202764976955: correct 114/17360

Epoch: 16, train_loss: 2.3362, train_clustering_loss: 0.1690, train_error: 0.5184
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6636828644501279, correct coarse 519/782
coarse class 2: coarse acc 0.8187672493100276, correct coarse 890/1087
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6421663442940039, correct fine 332/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.850835322195704, correct fine 713/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.3250, coarse auc: 0.7653, fine auc: 0.7480
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0004734848484848485: correct 1/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3550
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1082

Training for coarse_and_fine level...
batch 100, loss: 2.0936, instance_loss: 0.2120, weighted_loss: 1.5291, label: 6, bag_size: 156
batch 200, loss: 0.8047, instance_loss: 0.1120, weighted_loss: 0.5969, label: 5, bag_size: 424
batch 300, loss: 5.1211, instance_loss: 0.2837, weighted_loss: 3.6699, label: 7, bag_size: 2244
batch 400, loss: 0.7967, instance_loss: 0.0946, weighted_loss: 0.5860, label: 5, bag_size: 1262
batch 500, loss: 2.8572, instance_loss: 0.2100, weighted_loss: 2.0630, label: 6, bag_size: 1004
batch 600, loss: 1.7129, instance_loss: 0.1298, weighted_loss: 1.2380, label: 5, bag_size: 233
batch 700, loss: 2.3347, instance_loss: 0.1715, weighted_loss: 1.6858, label: 5, bag_size: 482
batch 800, loss: 0.4477, instance_loss: 0.0997, weighted_loss: 0.3433, label: 5, bag_size: 353
batch 900, loss: 3.1033, instance_loss: 0.1735, weighted_loss: 2.2243, label: 2, bag_size: 142
batch 1000, loss: 0.3718, instance_loss: 0.0849, weighted_loss: 0.2858, label: 5, bag_size: 2402
batch 1100, loss: 5.6619, instance_loss: 0.2868, weighted_loss: 4.0493, label: 7, bag_size: 528
batch 1200, loss: 2.3120, instance_loss: 0.2042, weighted_loss: 1.6797, label: 6, bag_size: 286
batch 1300, loss: 1.0891, instance_loss: 0.1090, weighted_loss: 0.7951, label: 5, bag_size: 773
batch 1400, loss: 3.3851, instance_loss: 0.2077, weighted_loss: 2.4319, label: 2, bag_size: 250
batch 1500, loss: 0.8211, instance_loss: 0.1296, weighted_loss: 0.6137, label: 5, bag_size: 12
batch 1600, loss: 2.6214, instance_loss: 0.1505, weighted_loss: 1.8801, label: 5, bag_size: 375
batch 1700, loss: 4.8803, instance_loss: 0.2671, weighted_loss: 3.4963, label: 4, bag_size: 435
batch 1800, loss: 1.5940, instance_loss: 0.1499, weighted_loss: 1.1608, label: 2, bag_size: 943
batch 1900, loss: 5.9461, instance_loss: 0.2897, weighted_loss: 4.2492, label: 9, bag_size: 307
batch 2000, loss: 3.0095, instance_loss: 0.1954, weighted_loss: 2.1653, label: 2, bag_size: 205
batch 2100, loss: 2.1980, instance_loss: 0.1780, weighted_loss: 1.5920, label: 2, bag_size: 365

Instance Classifier Stats
class 0 clustering acc 0.9998502304147465: correct 260361/260400
class 1 clustering acc 0.010253456221198156: correct 178/17360

Epoch: 17, train_loss: 2.3199, train_clustering_loss: 0.1678, train_error: 0.5194
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6547314578005116, correct coarse 512/782
coarse class 2: coarse acc 0.8307267709291628, correct coarse 903/1087
coarse class 3: coarse acc 0.023346303501945526, correct coarse 6/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6286266924564797, correct fine 325/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8568019093078759, correct fine 718/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.3124, coarse auc: 0.7670, fine auc: 0.7532
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.0014204545454545455: correct 3/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96
coarse class 2: coarse acc 0.8134328358208955, correct coarse 109/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3555
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1082

Training for coarse_and_fine level...
batch 100, loss: 1.3296, instance_loss: 0.1284, weighted_loss: 0.9693, label: 5, bag_size: 1716
batch 200, loss: 0.3945, instance_loss: 0.0992, weighted_loss: 0.3059, label: 5, bag_size: 385
batch 300, loss: 1.6245, instance_loss: 0.1347, weighted_loss: 1.1775, label: 5, bag_size: 286
batch 400, loss: 2.1581, instance_loss: 0.1306, weighted_loss: 1.5499, label: 5, bag_size: 644
batch 500, loss: 0.4285, instance_loss: 0.1030, weighted_loss: 0.3309, label: 5, bag_size: 225
batch 600, loss: 0.7781, instance_loss: 0.1144, weighted_loss: 0.5790, label: 5, bag_size: 305
batch 700, loss: 0.5541, instance_loss: 0.0957, weighted_loss: 0.4166, label: 5, bag_size: 335
batch 800, loss: 2.1234, instance_loss: 0.1285, weighted_loss: 1.5249, label: 5, bag_size: 596
batch 900, loss: 5.1459, instance_loss: 0.2877, weighted_loss: 3.6884, label: 3, bag_size: 953
batch 1000, loss: 0.3931, instance_loss: 0.0927, weighted_loss: 0.3030, label: 5, bag_size: 261
batch 1100, loss: 4.8875, instance_loss: 0.2611, weighted_loss: 3.4996, label: 7, bag_size: 227
batch 1200, loss: 0.7012, instance_loss: 0.1234, weighted_loss: 0.5278, label: 2, bag_size: 2213
batch 1300, loss: 4.1320, instance_loss: 0.2362, weighted_loss: 2.9633, label: 7, bag_size: 778
batch 1400, loss: 2.3157, instance_loss: 0.1450, weighted_loss: 1.6645, label: 5, bag_size: 429
batch 1500, loss: 0.5834, instance_loss: 0.0970, weighted_loss: 0.4375, label: 5, bag_size: 796
batch 1600, loss: 1.8121, instance_loss: 0.1940, weighted_loss: 1.3266, label: 4, bag_size: 847
batch 1700, loss: 3.3171, instance_loss: 0.1982, weighted_loss: 2.3814, label: 2, bag_size: 190
batch 1800, loss: 4.5584, instance_loss: 0.2561, weighted_loss: 3.2677, label: 7, bag_size: 159
batch 1900, loss: 3.9484, instance_loss: 0.2206, weighted_loss: 2.8301, label: 4, bag_size: 201
batch 2000, loss: 2.7257, instance_loss: 0.1419, weighted_loss: 1.9506, label: 5, bag_size: 509
batch 2100, loss: 2.1986, instance_loss: 0.1485, weighted_loss: 1.5836, label: 5, bag_size: 269

Instance Classifier Stats
class 0 clustering acc 0.9997388632872504: correct 260332/260400
class 1 clustering acc 0.014285714285714285: correct 248/17360

Epoch: 18, train_loss: 2.3063, train_clustering_loss: 0.1674, train_error: 0.5184
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6521739130434783, correct coarse 510/782
coarse class 2: coarse acc 0.8344066237350506, correct coarse 907/1087
coarse class 3: coarse acc 0.023346303501945526, correct coarse 6/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6344294003868471, correct fine 328/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8556085918854416, correct fine 717/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.3011, coarse auc: 0.7693, fine auc: 0.7576
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.003787878787878788: correct 8/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3554
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1091

Training for coarse_and_fine level...
batch 100, loss: 3.9213, instance_loss: 0.2419, weighted_loss: 2.8175, label: 3, bag_size: 437
batch 200, loss: 3.5550, instance_loss: 0.2220, weighted_loss: 2.5551, label: 7, bag_size: 311
batch 300, loss: 2.4631, instance_loss: 0.1533, weighted_loss: 1.7701, label: 5, bag_size: 235
batch 400, loss: 2.9479, instance_loss: 0.1873, weighted_loss: 2.1197, label: 2, bag_size: 217
batch 500, loss: 1.3752, instance_loss: 0.1180, weighted_loss: 0.9980, label: 5, bag_size: 522
batch 600, loss: 0.4154, instance_loss: 0.0732, weighted_loss: 0.3127, label: 5, bag_size: 812
batch 700, loss: 1.6700, instance_loss: 0.1395, weighted_loss: 1.2109, label: 5, bag_size: 125
batch 800, loss: 2.0758, instance_loss: 0.2083, weighted_loss: 1.5156, label: 6, bag_size: 334
batch 900, loss: 1.6758, instance_loss: 0.1932, weighted_loss: 1.2310, label: 4, bag_size: 2272
batch 1000, loss: 2.0095, instance_loss: 0.2100, weighted_loss: 1.4696, label: 6, bag_size: 333
batch 1100, loss: 1.3688, instance_loss: 0.1339, weighted_loss: 0.9983, label: 2, bag_size: 643
batch 1200, loss: 3.1052, instance_loss: 0.1785, weighted_loss: 2.2272, label: 2, bag_size: 165
batch 1300, loss: 1.5907, instance_loss: 0.1243, weighted_loss: 1.1508, label: 5, bag_size: 449
batch 1400, loss: 6.4475, instance_loss: 0.2647, weighted_loss: 4.5926, label: 7, bag_size: 2158
batch 1500, loss: 2.0157, instance_loss: 0.2058, weighted_loss: 1.4727, label: 6, bag_size: 572
batch 1600, loss: 4.5215, instance_loss: 0.2260, weighted_loss: 3.2329, label: 7, bag_size: 274
batch 1700, loss: 0.3598, instance_loss: 0.0915, weighted_loss: 0.2793, label: 5, bag_size: 505
batch 1800, loss: 5.0467, instance_loss: 0.2074, weighted_loss: 3.5949, label: 2, bag_size: 306
batch 1900, loss: 1.9816, instance_loss: 0.1525, weighted_loss: 1.4329, label: 2, bag_size: 681
batch 2000, loss: 1.5634, instance_loss: 0.1337, weighted_loss: 1.1345, label: 5, bag_size: 382
batch 2100, loss: 0.6334, instance_loss: 0.1182, weighted_loss: 0.4789, label: 2, bag_size: 994

Instance Classifier Stats
class 0 clustering acc 0.9997119815668203: correct 260325/260400
class 1 clustering acc 0.02171658986175115: correct 377/17360

Epoch: 19, train_loss: 2.2916, train_clustering_loss: 0.1665, train_error: 0.5143
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6534526854219949, correct coarse 511/782
coarse class 2: coarse acc 0.8353265869365225, correct coarse 908/1087
coarse class 3: coarse acc 0.023346303501945526, correct coarse 6/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6441005802707931, correct fine 333/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.860381861575179, correct fine 721/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2909, coarse auc: 0.7704, fine auc: 0.7629
class 0 clustering acc 1.0: correct 31680/31680
class 1 clustering acc 0.006628787878787879: correct 14/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.640625, correct fine 41/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3577
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1080

Training for coarse_and_fine level...
batch 100, loss: 1.2916, instance_loss: 0.1353, weighted_loss: 0.9447, label: 5, bag_size: 69
batch 200, loss: 0.8836, instance_loss: 0.1062, weighted_loss: 0.6504, label: 5, bag_size: 180
batch 300, loss: 1.5496, instance_loss: 0.2024, weighted_loss: 1.1454, label: 4, bag_size: 361
batch 400, loss: 3.7473, instance_loss: 0.1941, weighted_loss: 2.6813, label: 2, bag_size: 1654
batch 500, loss: 0.1676, instance_loss: 0.0734, weighted_loss: 0.1394, label: 5, bag_size: 563
batch 600, loss: 0.6165, instance_loss: 0.0852, weighted_loss: 0.4571, label: 5, bag_size: 1304
batch 700, loss: 0.3549, instance_loss: 0.0744, weighted_loss: 0.2707, label: 5, bag_size: 1301
batch 800, loss: 0.4273, instance_loss: 0.0652, weighted_loss: 0.3187, label: 5, bag_size: 658
batch 900, loss: 0.1502, instance_loss: 0.0787, weighted_loss: 0.1288, label: 5, bag_size: 104
batch 1000, loss: 1.0704, instance_loss: 0.1009, weighted_loss: 0.7795, label: 5, bag_size: 630
batch 1100, loss: 1.2748, instance_loss: 0.1074, weighted_loss: 0.9246, label: 5, bag_size: 1716
batch 1200, loss: 2.3000, instance_loss: 0.1608, weighted_loss: 1.6583, label: 2, bag_size: 222
batch 1300, loss: 1.7843, instance_loss: 0.2349, weighted_loss: 1.3195, label: 6, bag_size: 1066
batch 1400, loss: 2.2630, instance_loss: 0.2099, weighted_loss: 1.6471, label: 3, bag_size: 1967
batch 1500, loss: 3.7172, instance_loss: 0.2170, weighted_loss: 2.6671, label: 3, bag_size: 248
batch 1600, loss: 4.0104, instance_loss: 0.2514, weighted_loss: 2.8827, label: 8, bag_size: 372
batch 1700, loss: 0.3561, instance_loss: 0.0921, weighted_loss: 0.2769, label: 5, bag_size: 544
batch 1800, loss: 2.4543, instance_loss: 0.1963, weighted_loss: 1.7769, label: 6, bag_size: 129
batch 1900, loss: 4.2223, instance_loss: 0.2282, weighted_loss: 3.0241, label: 3, bag_size: 197
batch 2000, loss: 4.3607, instance_loss: 0.2337, weighted_loss: 3.1226, label: 2, bag_size: 655
batch 2100, loss: 2.0173, instance_loss: 0.1378, weighted_loss: 1.4535, label: 2, bag_size: 1618

Instance Classifier Stats
class 0 clustering acc 0.9996466973886329: correct 260308/260400
class 1 clustering acc 0.028513824884792628: correct 495/17360

Epoch: 20, train_loss: 2.2801, train_clustering_loss: 0.1656, train_error: 0.5120
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6329923273657289, correct coarse 495/782
coarse class 2: coarse acc 0.84360625574977, correct coarse 917/1087
coarse class 3: coarse acc 0.04669260700389105, correct coarse 12/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6363636363636364, correct fine 329/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8711217183770883, correct fine 730/838
fine class 6: fine acc 0.0, correct fine 0/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2822, coarse auc: 0.7719, fine auc: 0.7690
class 0 clustering acc 0.9999684343434343: correct 31679/31680
class 1 clustering acc 0.011837121212121212: correct 25/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6666666666666666, correct coarse 64/96
coarse class 2: coarse acc 0.8134328358208955, correct coarse 109/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3634
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1091

Training for coarse_and_fine level...
batch 100, loss: 0.4589, instance_loss: 0.1170, weighted_loss: 0.3563, label: 2, bag_size: 1189
batch 200, loss: 0.7186, instance_loss: 0.1068, weighted_loss: 0.5351, label: 5, bag_size: 123
batch 300, loss: 3.3961, instance_loss: 0.2391, weighted_loss: 2.4490, label: 3, bag_size: 160
batch 400, loss: 2.0345, instance_loss: 0.2427, weighted_loss: 1.4970, label: 6, bag_size: 1096
batch 500, loss: 0.3152, instance_loss: 0.1022, weighted_loss: 0.2513, label: 5, bag_size: 346
batch 600, loss: 0.2272, instance_loss: 0.0774, weighted_loss: 0.1823, label: 5, bag_size: 250
batch 700, loss: 0.5039, instance_loss: 0.0915, weighted_loss: 0.3802, label: 5, bag_size: 1105
batch 800, loss: 0.7421, instance_loss: 0.1188, weighted_loss: 0.5551, label: 2, bag_size: 1359
batch 900, loss: 1.4535, instance_loss: 0.1070, weighted_loss: 1.0495, label: 5, bag_size: 271
batch 1000, loss: 0.5566, instance_loss: 0.1333, weighted_loss: 0.4296, label: 2, bag_size: 1561
batch 1100, loss: 0.4252, instance_loss: 0.0828, weighted_loss: 0.3225, label: 5, bag_size: 622
batch 1200, loss: 4.5165, instance_loss: 0.2397, weighted_loss: 3.2335, label: 4, bag_size: 37
batch 1300, loss: 2.8303, instance_loss: 0.2437, weighted_loss: 2.0543, label: 3, bag_size: 1441
batch 1400, loss: 2.5483, instance_loss: 0.2135, weighted_loss: 1.8479, label: 4, bag_size: 793
batch 1500, loss: 0.4802, instance_loss: 0.0771, weighted_loss: 0.3592, label: 5, bag_size: 242
batch 1600, loss: 0.1484, instance_loss: 0.0611, weighted_loss: 0.1222, label: 5, bag_size: 365
batch 1700, loss: 2.9312, instance_loss: 0.2217, weighted_loss: 2.1183, label: 4, bag_size: 226
batch 1800, loss: 0.3026, instance_loss: 0.0663, weighted_loss: 0.2317, label: 5, bag_size: 1140
batch 1900, loss: 3.3442, instance_loss: 0.2236, weighted_loss: 2.4080, label: 8, bag_size: 340
batch 2000, loss: 1.6652, instance_loss: 0.2106, weighted_loss: 1.2288, label: 4, bag_size: 454
batch 2100, loss: 1.9743, instance_loss: 0.2127, weighted_loss: 1.4458, label: 3, bag_size: 836

Instance Classifier Stats
class 0 clustering acc 0.9994815668202764: correct 260265/260400
class 1 clustering acc 0.036290322580645164: correct 630/17360

Epoch: 21, train_loss: 2.2684, train_clustering_loss: 0.1649, train_error: 0.5092
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782
coarse class 2: coarse acc 0.8408463661453542, correct coarse 914/1087
coarse class 3: coarse acc 0.042801556420233464, correct coarse 11/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6305609284332688, correct fine 326/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.0, correct fine 0/115
fine class 5: fine acc 0.8782816229116945, correct fine 736/838
fine class 6: fine acc 0.012048192771084338, correct fine 3/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2737, coarse auc: 0.7730, fine auc: 0.7730
class 0 clustering acc 0.9999684343434343: correct 31679/31680
class 1 clustering acc 0.015151515151515152: correct 32/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96
coarse class 2: coarse acc 0.8134328358208955, correct coarse 109/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3563
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1091

Training for coarse_and_fine level...
batch 100, loss: 2.1409, instance_loss: 0.1405, weighted_loss: 1.5408, label: 5, bag_size: 644
batch 200, loss: 2.1804, instance_loss: 0.2164, weighted_loss: 1.5912, label: 6, bag_size: 1586
batch 300, loss: 3.0580, instance_loss: 0.2028, weighted_loss: 2.2014, label: 2, bag_size: 241
batch 400, loss: 2.4889, instance_loss: 0.1938, weighted_loss: 1.8004, label: 6, bag_size: 562
batch 500, loss: 2.1843, instance_loss: 0.2197, weighted_loss: 1.5949, label: 5, bag_size: 473
batch 600, loss: 0.9984, instance_loss: 0.0936, weighted_loss: 0.7269, label: 5, bag_size: 460
batch 700, loss: 6.9584, instance_loss: 0.3286, weighted_loss: 4.9694, label: 10, bag_size: 481
batch 800, loss: 5.8634, instance_loss: 0.2972, weighted_loss: 4.1936, label: 7, bag_size: 599
batch 900, loss: 0.1844, instance_loss: 0.0651, weighted_loss: 0.1486, label: 5, bag_size: 905
batch 1000, loss: 1.1792, instance_loss: 0.1090, weighted_loss: 0.8581, label: 5, bag_size: 773
batch 1100, loss: 2.3061, instance_loss: 0.2301, weighted_loss: 1.6833, label: 3, bag_size: 3112
batch 1200, loss: 3.2696, instance_loss: 0.2246, weighted_loss: 2.3561, label: 4, bag_size: 155
batch 1300, loss: 1.6383, instance_loss: 0.1450, weighted_loss: 1.1903, label: 2, bag_size: 1536
batch 1400, loss: 1.7772, instance_loss: 0.1509, weighted_loss: 1.2893, label: 2, bag_size: 1114
batch 1500, loss: 1.9081, instance_loss: 0.1000, weighted_loss: 1.3657, label: 5, bag_size: 448
batch 1600, loss: 7.7455, instance_loss: 0.2956, weighted_loss: 5.5105, label: 0, bag_size: 343
batch 1700, loss: 2.1220, instance_loss: 0.1432, weighted_loss: 1.5283, label: 5, bag_size: 352
batch 1800, loss: 1.6179, instance_loss: 0.0893, weighted_loss: 1.1593, label: 5, bag_size: 462
batch 1900, loss: 1.7734, instance_loss: 0.1285, weighted_loss: 1.2799, label: 5, bag_size: 233
batch 2000, loss: 1.1720, instance_loss: 0.1231, weighted_loss: 0.8573, label: 5, bag_size: 194
batch 2100, loss: 2.0077, instance_loss: 0.2106, weighted_loss: 1.4686, label: 6, bag_size: 858

Instance Classifier Stats
class 0 clustering acc 0.9995430107526881: correct 260281/260400
class 1 clustering acc 0.04158986175115208: correct 722/17360

Epoch: 22, train_loss: 2.2579, train_clustering_loss: 0.1645, train_error: 0.5115
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6432225063938619, correct coarse 503/782
coarse class 2: coarse acc 0.8417663293468262, correct coarse 915/1087
coarse class 3: coarse acc 0.058365758754863814, correct coarse 15/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6305609284332688, correct fine 326/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.017391304347826087, correct fine 2/115
fine class 5: fine acc 0.8651551312649165, correct fine 725/838
fine class 6: fine acc 0.028112449799196786, correct fine 7/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2665, coarse auc: 0.7746, fine auc: 0.7740
class 0 clustering acc 0.9998421717171717: correct 31675/31680
class 1 clustering acc 0.029356060606060608: correct 62/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3557
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1092

Training for coarse_and_fine level...
batch 100, loss: 3.2367, instance_loss: 0.2038, weighted_loss: 2.3268, label: 2, bag_size: 341
batch 200, loss: 2.2006, instance_loss: 0.1530, weighted_loss: 1.5863, label: 2, bag_size: 161
batch 300, loss: 1.3204, instance_loss: 0.0999, weighted_loss: 0.9543, label: 5, bag_size: 847
batch 400, loss: 1.8196, instance_loss: 0.1290, weighted_loss: 1.3124, label: 5, bag_size: 243
batch 500, loss: 3.4184, instance_loss: 0.2230, weighted_loss: 2.4598, label: 8, bag_size: 440
batch 600, loss: 0.9648, instance_loss: 0.1326, weighted_loss: 0.7152, label: 2, bag_size: 2536
batch 700, loss: 0.9664, instance_loss: 0.0960, weighted_loss: 0.7053, label: 5, bag_size: 615
batch 800, loss: 0.3445, instance_loss: 0.0654, weighted_loss: 0.2608, label: 5, bag_size: 1257
batch 900, loss: 3.0833, instance_loss: 0.1930, weighted_loss: 2.2162, label: 5, bag_size: 190
batch 1000, loss: 2.4874, instance_loss: 0.2028, weighted_loss: 1.8020, label: 3, bag_size: 123
batch 1100, loss: 2.1852, instance_loss: 0.1419, weighted_loss: 1.5722, label: 2, bag_size: 308
batch 1200, loss: 0.5331, instance_loss: 0.0733, weighted_loss: 0.3951, label: 5, bag_size: 624
batch 1300, loss: 2.3550, instance_loss: 0.2079, weighted_loss: 1.7109, label: 3, bag_size: 1138
batch 1400, loss: 0.3599, instance_loss: 0.0856, weighted_loss: 0.2776, label: 5, bag_size: 225
batch 1500, loss: 1.0867, instance_loss: 0.1088, weighted_loss: 0.7933, label: 5, bag_size: 408
batch 1600, loss: 2.2088, instance_loss: 0.1485, weighted_loss: 1.5907, label: 2, bag_size: 2367
batch 1700, loss: 2.4241, instance_loss: 0.1540, weighted_loss: 1.7430, label: 2, bag_size: 296
batch 1800, loss: 0.6639, instance_loss: 0.0946, weighted_loss: 0.4931, label: 5, bag_size: 279
batch 1900, loss: 0.4825, instance_loss: 0.0721, weighted_loss: 0.3594, label: 5, bag_size: 597
batch 2000, loss: 2.4561, instance_loss: 0.1641, weighted_loss: 1.7685, label: 2, bag_size: 823
batch 2100, loss: 1.3035, instance_loss: 0.0961, weighted_loss: 0.9413, label: 5, bag_size: 588

Instance Classifier Stats
class 0 clustering acc 0.9992741935483871: correct 260211/260400
class 1 clustering acc 0.05178571428571429: correct 899/17360

Epoch: 23, train_loss: 2.2472, train_clustering_loss: 0.1638, train_error: 0.5078
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782
coarse class 2: coarse acc 0.860165593376265, correct coarse 935/1087
coarse class 3: coarse acc 0.03501945525291829, correct coarse 9/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6189555125725339, correct fine 320/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.008695652173913044, correct fine 1/115
fine class 5: fine acc 0.8866348448687351, correct fine 743/838
fine class 6: fine acc 0.01606425702811245, correct fine 4/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.0, correct fine 0/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2596, coarse auc: 0.7762, fine auc: 0.7777
class 0 clustering acc 0.9997159090909091: correct 31671/31680
class 1 clustering acc 0.03835227272727273: correct 81/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8653846153846154, correct fine 90/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3615
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1077

Training for coarse_and_fine level...
batch 100, loss: 2.8970, instance_loss: 0.2096, weighted_loss: 2.0908, label: 8, bag_size: 144
batch 200, loss: 0.2607, instance_loss: 0.0650, weighted_loss: 0.2020, label: 5, bag_size: 484
batch 300, loss: 3.4808, instance_loss: 0.2089, weighted_loss: 2.4992, label: 3, bag_size: 375
batch 400, loss: 3.0036, instance_loss: 0.2042, weighted_loss: 2.1638, label: 2, bag_size: 746
batch 500, loss: 1.5027, instance_loss: 0.1370, weighted_loss: 1.0930, label: 2, bag_size: 1628
batch 600, loss: 0.8020, instance_loss: 0.1031, weighted_loss: 0.5923, label: 2, bag_size: 2658
batch 700, loss: 2.9228, instance_loss: 0.1885, weighted_loss: 2.1025, label: 5, bag_size: 777
batch 800, loss: 2.2854, instance_loss: 0.1948, weighted_loss: 1.6582, label: 6, bag_size: 117
batch 900, loss: 2.9604, instance_loss: 0.2219, weighted_loss: 2.1388, label: 6, bag_size: 1010
batch 1000, loss: 0.2549, instance_loss: 0.0674, weighted_loss: 0.1987, label: 5, bag_size: 180
batch 1100, loss: 6.7676, instance_loss: 0.2601, weighted_loss: 4.8153, label: 7, bag_size: 2158
batch 1200, loss: 1.5602, instance_loss: 0.1042, weighted_loss: 1.1234, label: 5, bag_size: 599
batch 1300, loss: 0.4451, instance_loss: 0.0863, weighted_loss: 0.3375, label: 5, bag_size: 292
batch 1400, loss: 5.7386, instance_loss: 0.2649, weighted_loss: 4.0965, label: 10, bag_size: 162
batch 1500, loss: 7.0195, instance_loss: 0.2728, weighted_loss: 4.9955, label: 0, bag_size: 324
batch 1600, loss: 3.3139, instance_loss: 0.2276, weighted_loss: 2.3880, label: 3, bag_size: 262
batch 1700, loss: 0.7485, instance_loss: 0.0818, weighted_loss: 0.5485, label: 5, bag_size: 322
batch 1800, loss: 3.1844, instance_loss: 0.1873, weighted_loss: 2.2853, label: 5, bag_size: 1796
batch 1900, loss: 1.7831, instance_loss: 0.2329, weighted_loss: 1.3180, label: 3, bag_size: 53
batch 2000, loss: 4.2404, instance_loss: 0.2504, weighted_loss: 3.0434, label: 8, bag_size: 149
batch 2100, loss: 0.6643, instance_loss: 0.1099, weighted_loss: 0.4980, label: 2, bag_size: 1490

Instance Classifier Stats
class 0 clustering acc 0.9992089093701997: correct 260194/260400
class 1 clustering acc 0.05720046082949309: correct 993/17360

Epoch: 24, train_loss: 2.2417, train_clustering_loss: 0.1634, train_error: 0.5028
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782
coarse class 2: coarse acc 0.8482060717571297, correct coarse 922/1087
coarse class 3: coarse acc 0.04669260700389105, correct coarse 12/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.632495164410058, correct fine 327/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.02608695652173913, correct fine 3/115
fine class 5: fine acc 0.8806682577565632, correct fine 738/838
fine class 6: fine acc 0.0321285140562249, correct fine 8/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.022727272727272728, correct fine 3/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2526, coarse auc: 0.7776, fine auc: 0.7778
class 0 clustering acc 0.9996212121212121: correct 31668/31680
class 1 clustering acc 0.054450757575757576: correct 115/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.0, correct fine 0/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3598
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1086

Training for coarse_and_fine level...
batch 100, loss: 2.0543, instance_loss: 0.1944, weighted_loss: 1.4963, label: 3, bag_size: 1831
batch 200, loss: 0.5204, instance_loss: 0.0862, weighted_loss: 0.3901, label: 5, bag_size: 629
batch 300, loss: 1.0333, instance_loss: 0.0922, weighted_loss: 0.7510, label: 5, bag_size: 615
batch 400, loss: 0.6979, instance_loss: 0.0992, weighted_loss: 0.5183, label: 2, bag_size: 732
batch 500, loss: 2.4359, instance_loss: 0.2138, weighted_loss: 1.7693, label: 6, bag_size: 1339
batch 600, loss: 3.7991, instance_loss: 0.2225, weighted_loss: 2.7261, label: 3, bag_size: 477
batch 700, loss: 0.6053, instance_loss: 0.1233, weighted_loss: 0.4607, label: 2, bag_size: 547
batch 800, loss: 2.3028, instance_loss: 0.1708, weighted_loss: 1.6632, label: 2, bag_size: 65
batch 900, loss: 2.2272, instance_loss: 0.1576, weighted_loss: 1.6063, label: 5, bag_size: 595
batch 1000, loss: 3.6724, instance_loss: 0.2962, weighted_loss: 2.6595, label: 3, bag_size: 495
batch 1100, loss: 3.0123, instance_loss: 0.1665, weighted_loss: 2.1585, label: 2, bag_size: 334
batch 1200, loss: 0.3733, instance_loss: 0.0597, weighted_loss: 0.2792, label: 5, bag_size: 2141
batch 1300, loss: 1.2470, instance_loss: 0.1399, weighted_loss: 0.9149, label: 2, bag_size: 1522
batch 1400, loss: 2.0747, instance_loss: 0.1259, weighted_loss: 1.4901, label: 2, bag_size: 1257
batch 1500, loss: 7.9823, instance_loss: 0.2772, weighted_loss: 5.6708, label: 10, bag_size: 174
batch 1600, loss: 0.1921, instance_loss: 0.0704, weighted_loss: 0.1556, label: 5, bag_size: 743
batch 1700, loss: 6.1952, instance_loss: 0.2717, weighted_loss: 4.4181, label: 10, bag_size: 752
batch 1800, loss: 1.7856, instance_loss: 0.1387, weighted_loss: 1.2915, label: 5, bag_size: 131
batch 1900, loss: 0.6069, instance_loss: 0.1137, weighted_loss: 0.4589, label: 2, bag_size: 1099
batch 2000, loss: 0.1765, instance_loss: 0.0539, weighted_loss: 0.1397, label: 5, bag_size: 821
batch 2100, loss: 1.5022, instance_loss: 0.1121, weighted_loss: 1.0852, label: 5, bag_size: 148

Instance Classifier Stats
class 0 clustering acc 0.9990821812596006: correct 260161/260400
class 1 clustering acc 0.06618663594470046: correct 1149/17360

Epoch: 25, train_loss: 2.2306, train_clustering_loss: 0.1627, train_error: 0.5018
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782
coarse class 2: coarse acc 0.860165593376265, correct coarse 935/1087
coarse class 3: coarse acc 0.05058365758754864, correct coarse 13/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6189555125725339, correct fine 320/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.034782608695652174, correct fine 4/115
fine class 5: fine acc 0.8890214797136038, correct fine 745/838
fine class 6: fine acc 0.03614457831325301, correct fine 9/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.022727272727272728, correct fine 3/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2467, coarse auc: 0.7787, fine auc: 0.7824
class 0 clustering acc 0.9995896464646464: correct 31667/31680
class 1 clustering acc 0.061553030303030304: correct 130/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.671875, correct fine 43/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.03333333333333333, correct fine 1/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3645
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1159

Training for coarse_and_fine level...
batch 100, loss: 0.3572, instance_loss: 0.0662, weighted_loss: 0.2699, label: 5, bag_size: 396
batch 200, loss: 0.1710, instance_loss: 0.0642, weighted_loss: 0.1390, label: 5, bag_size: 361
batch 300, loss: 0.1328, instance_loss: 0.0719, weighted_loss: 0.1145, label: 5, bag_size: 190
batch 400, loss: 5.3406, instance_loss: 0.2801, weighted_loss: 3.8224, label: 7, bag_size: 682
batch 500, loss: 3.6318, instance_loss: 0.2112, weighted_loss: 2.6056, label: 3, bag_size: 445
batch 600, loss: 0.4776, instance_loss: 0.0691, weighted_loss: 0.3551, label: 5, bag_size: 691
batch 700, loss: 0.6693, instance_loss: 0.1055, weighted_loss: 0.5001, label: 2, bag_size: 357
batch 800, loss: 1.7512, instance_loss: 0.2309, weighted_loss: 1.2951, label: 6, bag_size: 334
batch 900, loss: 0.1864, instance_loss: 0.0489, weighted_loss: 0.1451, label: 5, bag_size: 821
batch 1000, loss: 2.2546, instance_loss: 0.1461, weighted_loss: 1.6220, label: 2, bag_size: 454
batch 1100, loss: 0.1216, instance_loss: 0.0442, weighted_loss: 0.0984, label: 5, bag_size: 414
batch 1200, loss: 4.0701, instance_loss: 0.2506, weighted_loss: 2.9243, label: 8, bag_size: 501
batch 1300, loss: 2.1947, instance_loss: 0.1510, weighted_loss: 1.5816, label: 5, bag_size: 235
batch 1400, loss: 1.4933, instance_loss: 0.2409, weighted_loss: 1.1175, label: 6, bag_size: 156
batch 1500, loss: 0.2394, instance_loss: 0.0632, weighted_loss: 0.1865, label: 5, bag_size: 779
batch 1600, loss: 2.6992, instance_loss: 0.1676, weighted_loss: 1.9397, label: 5, bag_size: 464
batch 1700, loss: 1.0922, instance_loss: 0.0996, weighted_loss: 0.7944, label: 5, bag_size: 665
batch 1800, loss: 1.8360, instance_loss: 0.2091, weighted_loss: 1.3479, label: 6, bag_size: 461
batch 1900, loss: 2.1786, instance_loss: 0.1361, weighted_loss: 1.5659, label: 5, bag_size: 110
batch 2000, loss: 0.7035, instance_loss: 0.1414, weighted_loss: 0.5349, label: 2, bag_size: 1447
batch 2100, loss: 4.2001, instance_loss: 0.2275, weighted_loss: 3.0083, label: 3, bag_size: 276

Instance Classifier Stats
class 0 clustering acc 0.9990552995391705: correct 260154/260400
class 1 clustering acc 0.07119815668202766: correct 1236/17360

Epoch: 26, train_loss: 2.2227, train_clustering_loss: 0.1627, train_error: 0.5023
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782
coarse class 2: coarse acc 0.8675252989880404, correct coarse 943/1087
coarse class 3: coarse acc 0.042801556420233464, correct coarse 11/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6073500967117988, correct fine 314/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.06086956521739131, correct fine 7/115
fine class 5: fine acc 0.8866348448687351, correct fine 743/838
fine class 6: fine acc 0.05220883534136546, correct fine 13/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.022727272727272728, correct fine 3/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2421, coarse auc: 0.7803, fine auc: 0.7833
class 0 clustering acc 0.9994949494949495: correct 31664/31680
class 1 clustering acc 0.07149621212121213: correct 151/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.03333333333333333, correct fine 1/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3755
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1155

Training for coarse_and_fine level...
batch 100, loss: 1.8009, instance_loss: 0.2135, weighted_loss: 1.3247, label: 3, bag_size: 836
batch 200, loss: 0.1672, instance_loss: 0.0647, weighted_loss: 0.1365, label: 5, bag_size: 764
batch 300, loss: 1.0871, instance_loss: 0.1005, weighted_loss: 0.7911, label: 5, bag_size: 1360
batch 400, loss: 1.1776, instance_loss: 0.1499, weighted_loss: 0.8693, label: 2, bag_size: 2154
batch 500, loss: 6.0455, instance_loss: 0.2350, weighted_loss: 4.3024, label: 1, bag_size: 369
batch 600, loss: 0.9238, instance_loss: 0.1238, weighted_loss: 0.6838, label: 2, bag_size: 1617
batch 700, loss: 1.9678, instance_loss: 0.2027, weighted_loss: 1.4382, label: 3, bag_size: 1781
batch 800, loss: 3.8987, instance_loss: 0.2333, weighted_loss: 2.7991, label: 2, bag_size: 529
batch 900, loss: 2.1330, instance_loss: 0.1511, weighted_loss: 1.5384, label: 5, bag_size: 765
batch 1000, loss: 1.9124, instance_loss: 0.2194, weighted_loss: 1.4045, label: 6, bag_size: 244
batch 1100, loss: 6.0474, instance_loss: 0.3025, weighted_loss: 4.3239, label: 7, bag_size: 462
batch 1200, loss: 2.1598, instance_loss: 0.2049, weighted_loss: 1.5734, label: 6, bag_size: 337
batch 1300, loss: 8.5458, instance_loss: 0.2413, weighted_loss: 6.0545, label: 8, bag_size: 1875
batch 1400, loss: 1.6040, instance_loss: 0.1297, weighted_loss: 1.1617, label: 5, bag_size: 889
batch 1500, loss: 1.0454, instance_loss: 0.1212, weighted_loss: 0.7681, label: 2, bag_size: 1973
batch 1600, loss: 0.9645, instance_loss: 0.0787, weighted_loss: 0.6988, label: 5, bag_size: 802
batch 1700, loss: 2.7564, instance_loss: 0.1613, weighted_loss: 1.9779, label: 2, bag_size: 179
batch 1800, loss: 0.8243, instance_loss: 0.0712, weighted_loss: 0.5984, label: 5, bag_size: 403
batch 1900, loss: 3.2821, instance_loss: 0.1967, weighted_loss: 2.3565, label: 6, bag_size: 379
batch 2000, loss: 4.2739, instance_loss: 0.2293, weighted_loss: 3.0605, label: 3, bag_size: 197
batch 2100, loss: 2.1092, instance_loss: 0.1854, weighted_loss: 1.5321, label: 4, bag_size: 1410

Instance Classifier Stats
class 0 clustering acc 0.9990629800307219: correct 260156/260400
class 1 clustering acc 0.07932027649769585: correct 1377/17360

Epoch: 27, train_loss: 2.2169, train_clustering_loss: 0.1622, train_error: 0.4986
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782
coarse class 2: coarse acc 0.859245630174793, correct coarse 934/1087
coarse class 3: coarse acc 0.0622568093385214, correct coarse 16/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6092843326885881, correct fine 315/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.08695652173913043, correct fine 10/115
fine class 5: fine acc 0.8937947494033412, correct fine 749/838
fine class 6: fine acc 0.040160642570281124, correct fine 10/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2371, coarse auc: 0.7821, fine auc: 0.7835
class 0 clustering acc 0.9994318181818181: correct 31662/31680
class 1 clustering acc 0.07954545454545454: correct 168/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.03333333333333333, correct fine 1/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3640
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1156

Training for coarse_and_fine level...
batch 100, loss: 3.0085, instance_loss: 0.1722, weighted_loss: 2.1576, label: 2, bag_size: 399
batch 200, loss: 2.1614, instance_loss: 0.1652, weighted_loss: 1.5625, label: 2, bag_size: 965
batch 300, loss: 0.1550, instance_loss: 0.0660, weighted_loss: 0.1283, label: 5, bag_size: 278
batch 400, loss: 0.1873, instance_loss: 0.0487, weighted_loss: 0.1457, label: 5, bag_size: 676
batch 500, loss: 2.8512, instance_loss: 0.1767, weighted_loss: 2.0489, label: 2, bag_size: 558
batch 600, loss: 1.9411, instance_loss: 0.2213, weighted_loss: 1.4251, label: 6, bag_size: 526
batch 700, loss: 2.8861, instance_loss: 0.2118, weighted_loss: 2.0838, label: 8, bag_size: 229
batch 800, loss: 3.0806, instance_loss: 0.1919, weighted_loss: 2.2140, label: 6, bag_size: 243
batch 900, loss: 0.7911, instance_loss: 0.1130, weighted_loss: 0.5877, label: 2, bag_size: 2037
batch 1000, loss: 0.1937, instance_loss: 0.0679, weighted_loss: 0.1560, label: 5, bag_size: 288
batch 1100, loss: 1.7504, instance_loss: 0.2138, weighted_loss: 1.2894, label: 6, bag_size: 361
batch 1200, loss: 2.1850, instance_loss: 0.2202, weighted_loss: 1.5955, label: 3, bag_size: 807
batch 1300, loss: 2.6924, instance_loss: 0.2174, weighted_loss: 1.9499, label: 6, bag_size: 476
batch 1400, loss: 2.3323, instance_loss: 0.1326, weighted_loss: 1.6724, label: 5, bag_size: 548
batch 1500, loss: 2.8963, instance_loss: 0.2034, weighted_loss: 2.0885, label: 8, bag_size: 245
batch 1600, loss: 1.8491, instance_loss: 0.1431, weighted_loss: 1.3373, label: 5, bag_size: 1077
batch 1700, loss: 0.5873, instance_loss: 0.1181, weighted_loss: 0.4465, label: 2, bag_size: 207
batch 1800, loss: 2.9080, instance_loss: 0.2109, weighted_loss: 2.0989, label: 8, bag_size: 144
batch 1900, loss: 1.3262, instance_loss: 0.1077, weighted_loss: 0.9607, label: 5, bag_size: 392
batch 2000, loss: 2.7708, instance_loss: 0.1825, weighted_loss: 1.9943, label: 2, bag_size: 446
batch 2100, loss: 1.6051, instance_loss: 0.1161, weighted_loss: 1.1584, label: 5, bag_size: 290

Instance Classifier Stats
class 0 clustering acc 0.9987941628264209: correct 260086/260400
class 1 clustering acc 0.086463133640553: correct 1501/17360

Epoch: 28, train_loss: 2.2091, train_clustering_loss: 0.1620, train_error: 0.5000
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6214833759590793, correct coarse 486/782
coarse class 2: coarse acc 0.874885004599816, correct coarse 951/1087
coarse class 3: coarse acc 0.042801556420233464, correct coarse 11/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6054158607350096, correct fine 313/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.08695652173913043, correct fine 10/115
fine class 5: fine acc 0.8926014319809069, correct fine 748/838
fine class 6: fine acc 0.04819277108433735, correct fine 12/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.015151515151515152, correct fine 2/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2331, coarse auc: 0.7831, fine auc: 0.7847
class 0 clustering acc 0.9994318181818181: correct 31662/31680
class 1 clustering acc 0.08664772727272728: correct 183/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.65625, correct fine 42/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.03333333333333333, correct fine 1/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3757
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1157

Training for coarse_and_fine level...
batch 100, loss: 0.1376, instance_loss: 0.0474, weighted_loss: 0.1106, label: 5, bag_size: 543
batch 200, loss: 3.3056, instance_loss: 0.2101, weighted_loss: 2.3769, label: 7, bag_size: 888
batch 300, loss: 2.8381, instance_loss: 0.1968, weighted_loss: 2.0457, label: 6, bag_size: 651
batch 400, loss: 3.7128, instance_loss: 0.1819, weighted_loss: 2.6535, label: 6, bag_size: 246
batch 500, loss: 2.4320, instance_loss: 0.1832, weighted_loss: 1.7573, label: 5, bag_size: 741
batch 600, loss: 2.4879, instance_loss: 0.1600, weighted_loss: 1.7895, label: 2, bag_size: 427
batch 700, loss: 1.8646, instance_loss: 0.1141, weighted_loss: 1.3394, label: 5, bag_size: 489
batch 800, loss: 1.9195, instance_loss: 0.0924, weighted_loss: 1.3714, label: 5, bag_size: 448
batch 900, loss: 5.2796, instance_loss: 0.2590, weighted_loss: 3.7734, label: 10, bag_size: 239
batch 1000, loss: 0.1557, instance_loss: 0.0650, weighted_loss: 0.1285, label: 5, bag_size: 359
batch 1100, loss: 1.4106, instance_loss: 0.1076, weighted_loss: 1.0197, label: 5, bag_size: 880
batch 1200, loss: 2.7900, instance_loss: 0.2117, weighted_loss: 2.0165, label: 6, bag_size: 344
batch 1300, loss: 3.2211, instance_loss: 0.2116, weighted_loss: 2.3182, label: 2, bag_size: 634
batch 1400, loss: 3.3283, instance_loss: 0.2359, weighted_loss: 2.4006, label: 8, bag_size: 130
batch 1500, loss: 0.6205, instance_loss: 0.1049, weighted_loss: 0.4658, label: 2, bag_size: 956
batch 1600, loss: 3.3720, instance_loss: 0.2205, weighted_loss: 2.4266, label: 4, bag_size: 415
batch 1700, loss: 2.7028, instance_loss: 0.1737, weighted_loss: 1.9441, label: 2, bag_size: 290
batch 1800, loss: 1.8833, instance_loss: 0.2118, weighted_loss: 1.3818, label: 5, bag_size: 473
batch 1900, loss: 0.5800, instance_loss: 0.1187, weighted_loss: 0.4416, label: 2, bag_size: 379
batch 2000, loss: 0.2968, instance_loss: 0.0601, weighted_loss: 0.2258, label: 5, bag_size: 467
batch 2100, loss: 2.1456, instance_loss: 0.1448, weighted_loss: 1.5454, label: 5, bag_size: 596

Instance Classifier Stats
class 0 clustering acc 0.9987941628264209: correct 260086/260400
class 1 clustering acc 0.09089861751152074: correct 1578/17360

Epoch: 29, train_loss: 2.2035, train_clustering_loss: 0.1615, train_error: 0.4968
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6278772378516624, correct coarse 491/782
coarse class 2: coarse acc 0.8656853725850966, correct coarse 941/1087
coarse class 3: coarse acc 0.07392996108949416, correct coarse 19/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6131528046421664, correct fine 317/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.10434782608695652, correct fine 12/115
fine class 5: fine acc 0.8866348448687351, correct fine 743/838
fine class 6: fine acc 0.0642570281124498, correct fine 16/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2279, coarse auc: 0.7842, fine auc: 0.7851
class 0 clustering acc 0.9992739898989899: correct 31657/31680
class 1 clustering acc 0.09517045454545454: correct 201/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.640625, correct fine 41/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.0, correct fine 0/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.03333333333333333, correct fine 1/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3796
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1147

Training for coarse_and_fine level...
batch 100, loss: 1.0769, instance_loss: 0.0880, weighted_loss: 0.7802, label: 5, bag_size: 773
batch 200, loss: 3.7641, instance_loss: 0.2272, weighted_loss: 2.7030, label: 8, bag_size: 96
batch 300, loss: 1.7908, instance_loss: 0.2243, weighted_loss: 1.3209, label: 6, bag_size: 1530
batch 400, loss: 0.8894, instance_loss: 0.1233, weighted_loss: 0.6596, label: 5, bag_size: 534
batch 500, loss: 1.7531, instance_loss: 0.0882, weighted_loss: 1.2537, label: 5, bag_size: 396
batch 600, loss: 1.6550, instance_loss: 0.1050, weighted_loss: 1.1900, label: 5, bag_size: 1135
batch 700, loss: 1.0693, instance_loss: 0.1123, weighted_loss: 0.7822, label: 2, bag_size: 2601
batch 800, loss: 1.2628, instance_loss: 0.1223, weighted_loss: 0.9206, label: 2, bag_size: 3773
batch 900, loss: 1.9189, instance_loss: 0.1658, weighted_loss: 1.3930, label: 2, bag_size: 862
batch 1000, loss: 3.5495, instance_loss: 0.2013, weighted_loss: 2.5451, label: 6, bag_size: 252
batch 1100, loss: 4.1181, instance_loss: 0.2071, weighted_loss: 2.9448, label: 2, bag_size: 237
batch 1200, loss: 0.8912, instance_loss: 0.1387, weighted_loss: 0.6655, label: 2, bag_size: 1365
batch 1300, loss: 1.4898, instance_loss: 0.1357, weighted_loss: 1.0836, label: 2, bag_size: 2612
batch 1400, loss: 1.6822, instance_loss: 0.1196, weighted_loss: 1.2134, label: 5, bag_size: 513
batch 1500, loss: 0.2790, instance_loss: 0.0615, weighted_loss: 0.2138, label: 5, bag_size: 505
batch 1600, loss: 1.1435, instance_loss: 0.0901, weighted_loss: 0.8275, label: 5, bag_size: 776
batch 1700, loss: 3.8079, instance_loss: 0.2876, weighted_loss: 2.7518, label: 3, bag_size: 495
batch 1800, loss: 0.4756, instance_loss: 0.0692, weighted_loss: 0.3537, label: 5, bag_size: 892
batch 1900, loss: 2.0735, instance_loss: 0.1292, weighted_loss: 1.4902, label: 5, bag_size: 1149
batch 2000, loss: 1.1919, instance_loss: 0.0860, weighted_loss: 0.8601, label: 5, bag_size: 360
batch 2100, loss: 0.2297, instance_loss: 0.0612, weighted_loss: 0.1792, label: 5, bag_size: 178

Instance Classifier Stats
class 0 clustering acc 0.9987173579109063: correct 260066/260400
class 1 clustering acc 0.0957373271889401: correct 1662/17360

Epoch: 30, train_loss: 2.1975, train_clustering_loss: 0.1611, train_error: 0.4954
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6202046035805626, correct coarse 485/782
coarse class 2: coarse acc 0.8629254829806807, correct coarse 938/1087
coarse class 3: coarse acc 0.0622568093385214, correct coarse 16/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.6054158607350096, correct fine 313/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.13043478260869565, correct fine 15/115
fine class 5: fine acc 0.8902147971360382, correct fine 746/838
fine class 6: fine acc 0.07228915662650602, correct fine 18/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.022727272727272728, correct fine 3/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2232, coarse auc: 0.7858, fine auc: 0.7865
class 0 clustering acc 0.9992424242424243: correct 31656/31680
class 1 clustering acc 0.10227272727272728: correct 216/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.625, correct fine 40/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.03333333333333333, correct fine 1/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3780
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1256

Training for coarse_and_fine level...
batch 100, loss: 0.6135, instance_loss: 0.1085, weighted_loss: 0.4620, label: 2, bag_size: 309
batch 200, loss: 9.2047, instance_loss: 0.2431, weighted_loss: 6.5162, label: 5, bag_size: 362
batch 300, loss: 1.7537, instance_loss: 0.1298, weighted_loss: 1.2665, label: 5, bag_size: 734
batch 400, loss: 3.6157, instance_loss: 0.2317, weighted_loss: 2.6005, label: 2, bag_size: 666
batch 500, loss: 0.4722, instance_loss: 0.0850, weighted_loss: 0.3561, label: 5, bag_size: 817
batch 600, loss: 0.5672, instance_loss: 0.1244, weighted_loss: 0.4344, label: 2, bag_size: 379
batch 700, loss: 2.3824, instance_loss: 0.2269, weighted_loss: 1.7358, label: 6, bag_size: 298
batch 800, loss: 4.8986, instance_loss: 0.2607, weighted_loss: 3.5072, label: 8, bag_size: 567
batch 900, loss: 1.1350, instance_loss: 0.0929, weighted_loss: 0.8224, label: 5, bag_size: 773
batch 1000, loss: 0.5464, instance_loss: 0.0817, weighted_loss: 0.4070, label: 5, bag_size: 688
batch 1100, loss: 4.8743, instance_loss: 0.2442, weighted_loss: 3.4853, label: 7, bag_size: 901
batch 1200, loss: 2.0766, instance_loss: 0.2274, weighted_loss: 1.5218, label: 6, bag_size: 389
batch 1300, loss: 1.2469, instance_loss: 0.0857, weighted_loss: 0.8985, label: 5, bag_size: 630
batch 1400, loss: 2.3873, instance_loss: 0.1860, weighted_loss: 1.7269, label: 2, bag_size: 611
batch 1500, loss: 2.0892, instance_loss: 0.1545, weighted_loss: 1.5088, label: 2, bag_size: 409
batch 1600, loss: 0.1410, instance_loss: 0.0448, weighted_loss: 0.1121, label: 5, bag_size: 651
batch 1700, loss: 0.1045, instance_loss: 0.0429, weighted_loss: 0.0860, label: 5, bag_size: 407
batch 1800, loss: 6.1737, instance_loss: 0.2519, weighted_loss: 4.3972, label: 1, bag_size: 461
batch 1900, loss: 3.5778, instance_loss: 0.2031, weighted_loss: 2.5654, label: 2, bag_size: 127
batch 2000, loss: 0.5788, instance_loss: 0.0931, weighted_loss: 0.4331, label: 2, bag_size: 1253
batch 2100, loss: 2.9182, instance_loss: 0.1863, weighted_loss: 2.0987, label: 2, bag_size: 558

Instance Classifier Stats
class 0 clustering acc 0.998736559139785: correct 260071/260400
class 1 clustering acc 0.10178571428571428: correct 1767/17360

Epoch: 31, train_loss: 2.1909, train_clustering_loss: 0.1607, train_error: 0.4963
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6329923273657289, correct coarse 495/782
coarse class 2: coarse acc 0.8656853725850966, correct coarse 941/1087
coarse class 3: coarse acc 0.07392996108949416, correct coarse 19/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.586073500967118, correct fine 303/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.16521739130434782, correct fine 19/115
fine class 5: fine acc 0.8926014319809069, correct fine 748/838
fine class 6: fine acc 0.08032128514056225, correct fine 20/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.022727272727272728, correct fine 3/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2192, coarse auc: 0.7870, fine auc: 0.7867
class 0 clustering acc 0.9991477272727273: correct 31653/31680
class 1 clustering acc 0.1084280303030303: correct 229/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.640625, correct fine 41/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.03333333333333333, correct fine 1/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3778
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1266

Training for coarse_and_fine level...
batch 100, loss: 0.9969, instance_loss: 0.2138, weighted_loss: 0.7620, label: 4, bag_size: 488
batch 200, loss: 2.0551, instance_loss: 0.1948, weighted_loss: 1.4970, label: 6, bag_size: 843
batch 300, loss: 0.9729, instance_loss: 0.1015, weighted_loss: 0.7115, label: 5, bag_size: 655
batch 400, loss: 4.3751, instance_loss: 0.2099, weighted_loss: 3.1255, label: 6, bag_size: 1123
batch 500, loss: 4.6424, instance_loss: 0.2597, weighted_loss: 3.3276, label: 10, bag_size: 13
batch 600, loss: 0.1535, instance_loss: 0.0547, weighted_loss: 0.1238, label: 5, bag_size: 204
batch 700, loss: 3.5892, instance_loss: 0.2114, weighted_loss: 2.5758, label: 3, bag_size: 375
batch 800, loss: 5.6279, instance_loss: 0.2794, weighted_loss: 4.0233, label: 7, bag_size: 269
batch 900, loss: 0.4346, instance_loss: 0.0618, weighted_loss: 0.3227, label: 5, bag_size: 661
batch 1000, loss: 3.4851, instance_loss: 0.2232, weighted_loss: 2.5066, label: 7, bag_size: 132
batch 1100, loss: 0.5955, instance_loss: 0.0760, weighted_loss: 0.4397, label: 5, bag_size: 1045
batch 1200, loss: 0.4545, instance_loss: 0.0795, weighted_loss: 0.3420, label: 5, bag_size: 424
batch 1300, loss: 3.4671, instance_loss: 0.2285, weighted_loss: 2.4955, label: 3, bag_size: 657
batch 1400, loss: 1.1136, instance_loss: 0.1089, weighted_loss: 0.8122, label: 2, bag_size: 537
batch 1500, loss: 3.8882, instance_loss: 0.2228, weighted_loss: 2.7886, label: 8, bag_size: 195
batch 1600, loss: 0.9699, instance_loss: 0.0919, weighted_loss: 0.7065, label: 5, bag_size: 1214
batch 1700, loss: 1.9935, instance_loss: 0.1534, weighted_loss: 1.4414, label: 5, bag_size: 677
batch 1800, loss: 1.7343, instance_loss: 0.2227, weighted_loss: 1.2808, label: 4, bag_size: 217
batch 1900, loss: 2.3905, instance_loss: 0.2278, weighted_loss: 1.7417, label: 3, bag_size: 1006
batch 2000, loss: 2.4463, instance_loss: 0.2067, weighted_loss: 1.7744, label: 8, bag_size: 249
batch 2100, loss: 2.0913, instance_loss: 0.2179, weighted_loss: 1.5293, label: 3, bag_size: 610

Instance Classifier Stats
class 0 clustering acc 0.9985253456221198: correct 260016/260400
class 1 clustering acc 0.10437788018433179: correct 1812/17360

Epoch: 32, train_loss: 2.1864, train_clustering_loss: 0.1606, train_error: 0.4917
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6240409207161125, correct coarse 488/782
coarse class 2: coarse acc 0.8785648574057038, correct coarse 955/1087
coarse class 3: coarse acc 0.07392996108949416, correct coarse 19/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5899419729206963, correct fine 305/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.16521739130434782, correct fine 19/115
fine class 5: fine acc 0.8973747016706444, correct fine 752/838
fine class 6: fine acc 0.08835341365461848, correct fine 22/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.03787878787878788, correct fine 5/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2159, coarse auc: 0.7882, fine auc: 0.7865
class 0 clustering acc 0.999179292929293: correct 31654/31680
class 1 clustering acc 0.1103219696969697: correct 233/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.625, correct fine 40/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3939
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1303

Training for coarse_and_fine level...
batch 100, loss: 3.2715, instance_loss: 0.1771, weighted_loss: 2.3431, label: 2, bag_size: 493
batch 200, loss: 0.2462, instance_loss: 0.0528, weighted_loss: 0.1882, label: 5, bag_size: 844
batch 300, loss: 3.4968, instance_loss: 0.1998, weighted_loss: 2.5077, label: 5, bag_size: 294
batch 400, loss: 0.8574, instance_loss: 0.1324, weighted_loss: 0.6399, label: 2, bag_size: 1384
batch 500, loss: 1.6120, instance_loss: 0.1534, weighted_loss: 1.1744, label: 5, bag_size: 125
batch 600, loss: 3.6001, instance_loss: 0.1996, weighted_loss: 2.5800, label: 6, bag_size: 252
batch 700, loss: 1.9854, instance_loss: 0.1696, weighted_loss: 1.4407, label: 5, bag_size: 299
batch 800, loss: 1.4518, instance_loss: 0.0871, weighted_loss: 1.0424, label: 5, bag_size: 1555
batch 900, loss: 2.6728, instance_loss: 0.1894, weighted_loss: 1.9278, label: 5, bag_size: 252
batch 1000, loss: 2.0184, instance_loss: 0.2119, weighted_loss: 1.4765, label: 6, bag_size: 1238
batch 1100, loss: 2.3431, instance_loss: 0.1390, weighted_loss: 1.6818, label: 2, bag_size: 696
batch 1200, loss: 2.1386, instance_loss: 0.1997, weighted_loss: 1.5569, label: 4, bag_size: 786
batch 1300, loss: 0.2172, instance_loss: 0.0700, weighted_loss: 0.1730, label: 5, bag_size: 293
batch 1400, loss: 1.6505, instance_loss: 0.2161, weighted_loss: 1.2202, label: 3, bag_size: 504
batch 1500, loss: 0.5044, instance_loss: 0.0711, weighted_loss: 0.3744, label: 5, bag_size: 765
batch 1600, loss: 2.1753, instance_loss: 0.2143, weighted_loss: 1.5870, label: 3, bag_size: 1947
batch 1700, loss: 2.9404, instance_loss: 0.1731, weighted_loss: 2.1102, label: 2, bag_size: 505
batch 1800, loss: 6.4734, instance_loss: 0.2637, weighted_loss: 4.6105, label: 8, bag_size: 715
batch 1900, loss: 3.6168, instance_loss: 0.2305, weighted_loss: 2.6009, label: 2, bag_size: 533
batch 2000, loss: 2.6372, instance_loss: 0.1882, weighted_loss: 1.9025, label: 6, bag_size: 1004
batch 2100, loss: 2.6604, instance_loss: 0.1526, weighted_loss: 1.9081, label: 5, bag_size: 124

Instance Classifier Stats
class 0 clustering acc 0.9984600614439324: correct 259999/260400
class 1 clustering acc 0.1103110599078341: correct 1915/17360

Epoch: 33, train_loss: 2.1797, train_clustering_loss: 0.1603, train_error: 0.4940
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782
coarse class 2: coarse acc 0.8666053357865685, correct coarse 942/1087
coarse class 3: coarse acc 0.07003891050583658, correct coarse 18/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5880077369439072, correct fine 304/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.16521739130434782, correct fine 19/115
fine class 5: fine acc 0.8937947494033412, correct fine 749/838
fine class 6: fine acc 0.09236947791164658, correct fine 23/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.022727272727272728, correct fine 3/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2120, coarse auc: 0.7889, fine auc: 0.7872
class 0 clustering acc 0.9990214646464647: correct 31649/31680
class 1 clustering acc 0.11410984848484848: correct 241/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.625, correct fine 40/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.03333333333333333, correct fine 1/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3754
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1250

Training for coarse_and_fine level...
batch 100, loss: 2.9602, instance_loss: 0.2191, weighted_loss: 2.1379, label: 8, bag_size: 128
batch 200, loss: 1.3763, instance_loss: 0.1205, weighted_loss: 0.9996, label: 5, bag_size: 386
batch 300, loss: 2.9248, instance_loss: 0.2015, weighted_loss: 2.1078, label: 6, bag_size: 79
batch 400, loss: 1.3517, instance_loss: 0.2257, weighted_loss: 1.0139, label: 6, bag_size: 307
batch 500, loss: 2.0115, instance_loss: 0.1621, weighted_loss: 1.4566, label: 5, bag_size: 677
batch 600, loss: 1.4623, instance_loss: 0.1199, weighted_loss: 1.0596, label: 5, bag_size: 193
batch 700, loss: 7.2100, instance_loss: 0.2744, weighted_loss: 5.1293, label: 1, bag_size: 244
batch 800, loss: 2.4798, instance_loss: 0.1767, weighted_loss: 1.7888, label: 5, bag_size: 228
batch 900, loss: 3.3943, instance_loss: 0.2068, weighted_loss: 2.4381, label: 6, bag_size: 926
batch 1000, loss: 2.2719, instance_loss: 0.2072, weighted_loss: 1.6525, label: 6, bag_size: 979
batch 1100, loss: 6.7093, instance_loss: 0.2874, weighted_loss: 4.7828, label: 3, bag_size: 633
batch 1200, loss: 1.1774, instance_loss: 0.1048, weighted_loss: 0.8556, label: 5, bag_size: 333
batch 1300, loss: 2.6227, instance_loss: 0.1516, weighted_loss: 1.8814, label: 2, bag_size: 646
batch 1400, loss: 1.6028, instance_loss: 0.2118, weighted_loss: 1.1855, label: 6, bag_size: 373
batch 1500, loss: 3.9173, instance_loss: 0.2326, weighted_loss: 2.8119, label: 8, bag_size: 2218
batch 1600, loss: 0.3280, instance_loss: 0.0627, weighted_loss: 0.2484, label: 5, bag_size: 1246
batch 1700, loss: 2.1327, instance_loss: 0.1503, weighted_loss: 1.5380, label: 5, bag_size: 371
batch 1800, loss: 2.0072, instance_loss: 0.2108, weighted_loss: 1.4683, label: 6, bag_size: 444
batch 1900, loss: 1.4605, instance_loss: 0.2212, weighted_loss: 1.0887, label: 4, bag_size: 217
batch 2000, loss: 0.8115, instance_loss: 0.1226, weighted_loss: 0.6048, label: 2, bag_size: 1384
batch 2100, loss: 3.9109, instance_loss: 0.2137, weighted_loss: 2.8017, label: 2, bag_size: 655

Instance Classifier Stats
class 0 clustering acc 0.998379416282642: correct 259978/260400
class 1 clustering acc 0.11555299539170506: correct 2006/17360

Epoch: 34, train_loss: 2.1760, train_clustering_loss: 0.1601, train_error: 0.4908
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6150895140664961, correct coarse 481/782
coarse class 2: coarse acc 0.8859245630174793, correct coarse 963/1087
coarse class 3: coarse acc 0.0622568093385214, correct coarse 16/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5764023210831721, correct fine 298/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.16521739130434782, correct fine 19/115
fine class 5: fine acc 0.9069212410501193, correct fine 760/838
fine class 6: fine acc 0.09236947791164658, correct fine 23/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.03787878787878788, correct fine 5/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2124, coarse auc: 0.7898, fine auc: 0.7879
class 0 clustering acc 0.9991161616161616: correct 31652/31680
class 1 clustering acc 0.11079545454545454: correct 234/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96
coarse class 2: coarse acc 0.8134328358208955, correct coarse 109/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.625, correct fine 40/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.8557692307692307, correct fine 89/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3882
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1288

Training for coarse_and_fine level...
batch 100, loss: 2.4863, instance_loss: 0.1990, weighted_loss: 1.8001, label: 5, bag_size: 427
batch 200, loss: 2.7251, instance_loss: 0.1545, weighted_loss: 1.9539, label: 2, bag_size: 1214
batch 300, loss: 0.5067, instance_loss: 0.0829, weighted_loss: 0.3796, label: 2, bag_size: 1216
batch 400, loss: 3.7695, instance_loss: 0.2012, weighted_loss: 2.6990, label: 5, bag_size: 663
batch 500, loss: 6.3295, instance_loss: 0.2575, weighted_loss: 4.5079, label: 1, bag_size: 258
batch 600, loss: 4.9169, instance_loss: 0.2558, weighted_loss: 3.5185, label: 4, bag_size: 435
batch 700, loss: 0.4608, instance_loss: 0.0632, weighted_loss: 0.3416, label: 5, bag_size: 229
batch 800, loss: 0.7600, instance_loss: 0.0919, weighted_loss: 0.5595, label: 5, bag_size: 597
batch 900, loss: 0.3339, instance_loss: 0.0740, weighted_loss: 0.2559, label: 5, bag_size: 318
batch 1000, loss: 2.9654, instance_loss: 0.1748, weighted_loss: 2.1283, label: 2, bag_size: 320
batch 1100, loss: 5.7920, instance_loss: 0.2985, weighted_loss: 4.1439, label: 10, bag_size: 751
batch 1200, loss: 4.3373, instance_loss: 0.2113, weighted_loss: 3.0995, label: 4, bag_size: 665
batch 1300, loss: 0.3056, instance_loss: 0.0525, weighted_loss: 0.2297, label: 5, bag_size: 866
batch 1400, loss: 3.2941, instance_loss: 0.2136, weighted_loss: 2.3700, label: 2, bag_size: 215
batch 1500, loss: 0.4942, instance_loss: 0.0706, weighted_loss: 0.3671, label: 5, bag_size: 1058
batch 1600, loss: 0.3812, instance_loss: 0.0695, weighted_loss: 0.2877, label: 5, bag_size: 302
batch 1700, loss: 4.8661, instance_loss: 0.2721, weighted_loss: 3.4879, label: 7, bag_size: 521
batch 1800, loss: 2.0133, instance_loss: 0.2197, weighted_loss: 1.4752, label: 3, bag_size: 3112
batch 1900, loss: 2.4870, instance_loss: 0.2122, weighted_loss: 1.8045, label: 3, bag_size: 1150
batch 2000, loss: 2.1075, instance_loss: 0.1660, weighted_loss: 1.5250, label: 5, bag_size: 305
batch 2100, loss: 0.8570, instance_loss: 0.1102, weighted_loss: 0.6330, label: 2, bag_size: 1435

Instance Classifier Stats
class 0 clustering acc 0.9985176651305684: correct 260014/260400
class 1 clustering acc 0.11059907834101383: correct 1920/17360

Epoch: 35, train_loss: 2.1729, train_clustering_loss: 0.1600, train_error: 0.4908
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782
coarse class 2: coarse acc 0.8647654093836247, correct coarse 940/1087
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5918762088974855, correct fine 306/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.1826086956521739, correct fine 21/115
fine class 5: fine acc 0.8949880668257757, correct fine 750/838
fine class 6: fine acc 0.0963855421686747, correct fine 24/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2058, coarse auc: 0.7904, fine auc: 0.7876
class 0 clustering acc 0.9989267676767677: correct 31646/31680
class 1 clustering acc 0.1240530303030303: correct 262/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3909
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1301

Training for coarse_and_fine level...
batch 100, loss: 6.1616, instance_loss: 0.3161, weighted_loss: 4.4079, label: 10, bag_size: 625
batch 200, loss: 0.4527, instance_loss: 0.0791, weighted_loss: 0.3406, label: 5, bag_size: 424
batch 300, loss: 0.7598, instance_loss: 0.0916, weighted_loss: 0.5594, label: 2, bag_size: 206
batch 400, loss: 1.8237, instance_loss: 0.1821, weighted_loss: 1.3313, label: 5, bag_size: 1165
batch 500, loss: 0.9226, instance_loss: 0.1192, weighted_loss: 0.6816, label: 2, bag_size: 1479
batch 600, loss: 4.4607, instance_loss: 0.2452, weighted_loss: 3.1960, label: 8, bag_size: 288
batch 700, loss: 1.6950, instance_loss: 0.2272, weighted_loss: 1.2546, label: 6, bag_size: 244
batch 800, loss: 3.0718, instance_loss: 0.2083, weighted_loss: 2.2127, label: 8, bag_size: 228
batch 900, loss: 0.2229, instance_loss: 0.0522, weighted_loss: 0.1717, label: 5, bag_size: 446
batch 1000, loss: 2.2857, instance_loss: 0.2150, weighted_loss: 1.6645, label: 3, bag_size: 1987
batch 1100, loss: 4.6391, instance_loss: 0.2882, weighted_loss: 3.3338, label: 4, bag_size: 1061
batch 1200, loss: 5.0445, instance_loss: 0.2451, weighted_loss: 3.6047, label: 7, bag_size: 444
batch 1300, loss: 1.6894, instance_loss: 0.0977, weighted_loss: 1.2119, label: 5, bag_size: 714
batch 1400, loss: 2.6743, instance_loss: 0.1554, weighted_loss: 1.9186, label: 2, bag_size: 161
batch 1500, loss: 3.1626, instance_loss: 0.2257, weighted_loss: 2.2815, label: 2, bag_size: 363
batch 1600, loss: 1.9242, instance_loss: 0.1214, weighted_loss: 1.3834, label: 5, bag_size: 1145
batch 1700, loss: 1.8354, instance_loss: 0.2066, weighted_loss: 1.3468, label: 6, bag_size: 481
batch 1800, loss: 0.5523, instance_loss: 0.1208, weighted_loss: 0.4228, label: 2, bag_size: 334
batch 1900, loss: 1.2579, instance_loss: 0.1187, weighted_loss: 0.9161, label: 5, bag_size: 524
batch 2000, loss: 0.1021, instance_loss: 0.0399, weighted_loss: 0.0834, label: 5, bag_size: 190
batch 2100, loss: 0.5763, instance_loss: 0.0516, weighted_loss: 0.4189, label: 5, bag_size: 703

Instance Classifier Stats
class 0 clustering acc 0.9983064516129032: correct 259959/260400
class 1 clustering acc 0.12142857142857143: correct 2108/17360

Epoch: 36, train_loss: 2.1679, train_clustering_loss: 0.1595, train_error: 0.4903
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6227621483375959, correct coarse 487/782
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5783365570599613, correct fine 299/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.19130434782608696, correct fine 22/115
fine class 5: fine acc 0.9021479713603818, correct fine 756/838
fine class 6: fine acc 0.10040160642570281, correct fine 25/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2037, coarse auc: 0.7912, fine auc: 0.7881
class 0 clustering acc 0.9989267676767677: correct 31646/31680
class 1 clustering acc 0.12357954545454546: correct 261/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3911
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1293

Training for coarse_and_fine level...
batch 100, loss: 2.8443, instance_loss: 0.1620, weighted_loss: 2.0396, label: 5, bag_size: 106
batch 200, loss: 2.8054, instance_loss: 0.1648, weighted_loss: 2.0132, label: 5, bag_size: 309
batch 300, loss: 2.7738, instance_loss: 0.2194, weighted_loss: 2.0075, label: 6, bag_size: 268
batch 400, loss: 1.2440, instance_loss: 0.1841, weighted_loss: 0.9260, label: 4, bag_size: 483
batch 500, loss: 0.3915, instance_loss: 0.0616, weighted_loss: 0.2925, label: 5, bag_size: 812
batch 600, loss: 4.3611, instance_loss: 0.2852, weighted_loss: 3.1383, label: 8, bag_size: 876
batch 700, loss: 0.1212, instance_loss: 0.0341, weighted_loss: 0.0951, label: 5, bag_size: 668
batch 800, loss: 0.2201, instance_loss: 0.0575, weighted_loss: 0.1714, label: 5, bag_size: 442
batch 900, loss: 1.6425, instance_loss: 0.1178, weighted_loss: 1.1851, label: 5, bag_size: 337
batch 1000, loss: 1.8010, instance_loss: 0.1120, weighted_loss: 1.2943, label: 5, bag_size: 448
batch 1100, loss: 2.0564, instance_loss: 0.1394, weighted_loss: 1.4813, label: 5, bag_size: 765
batch 1200, loss: 1.1216, instance_loss: 0.0874, weighted_loss: 0.8113, label: 5, bag_size: 308
batch 1300, loss: 4.0011, instance_loss: 0.2196, weighted_loss: 2.8666, label: 3, bag_size: 167
batch 1400, loss: 1.9678, instance_loss: 0.1389, weighted_loss: 1.4191, label: 5, bag_size: 548
batch 1500, loss: 1.8750, instance_loss: 0.1394, weighted_loss: 1.3543, label: 5, bag_size: 350
batch 1600, loss: 0.8456, instance_loss: 0.0883, weighted_loss: 0.6184, label: 2, bag_size: 1279
batch 1700, loss: 0.1585, instance_loss: 0.0505, weighted_loss: 0.1261, label: 5, bag_size: 743
batch 1800, loss: 0.5569, instance_loss: 0.0705, weighted_loss: 0.4110, label: 5, bag_size: 600
batch 1900, loss: 2.0832, instance_loss: 0.1539, weighted_loss: 1.5044, label: 5, bag_size: 338
batch 2000, loss: 1.9387, instance_loss: 0.2047, weighted_loss: 1.4185, label: 3, bag_size: 1118
batch 2100, loss: 0.8800, instance_loss: 0.0942, weighted_loss: 0.6443, label: 5, bag_size: 470

Instance Classifier Stats
class 0 clustering acc 0.9982949308755761: correct 259956/260400
class 1 clustering acc 0.12183179723502305: correct 2115/17360

Epoch: 37, train_loss: 2.1637, train_clustering_loss: 0.1595, train_error: 0.4903
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6317135549872123, correct coarse 494/782
coarse class 2: coarse acc 0.8675252989880404, correct coarse 943/1087
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5841392649903289, correct fine 302/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.19130434782608696, correct fine 22/115
fine class 5: fine acc 0.8949880668257757, correct fine 750/838
fine class 6: fine acc 0.11244979919678715, correct fine 28/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.2002, coarse auc: 0.7910, fine auc: 0.7885
class 0 clustering acc 0.9988636363636364: correct 31644/31680
class 1 clustering acc 0.13115530303030304: correct 277/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.8942307692307693, correct fine 93/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3882
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1309

Training for coarse_and_fine level...
batch 100, loss: 2.5800, instance_loss: 0.1660, weighted_loss: 1.8558, label: 5, bag_size: 984
batch 200, loss: 0.3387, instance_loss: 0.0676, weighted_loss: 0.2573, label: 5, bag_size: 461
batch 300, loss: 5.0291, instance_loss: 0.2757, weighted_loss: 3.6031, label: 8, bag_size: 567
batch 400, loss: 0.2935, instance_loss: 0.0674, weighted_loss: 0.2257, label: 5, bag_size: 254
batch 500, loss: 0.3062, instance_loss: 0.0595, weighted_loss: 0.2322, label: 5, bag_size: 511
batch 600, loss: 0.2987, instance_loss: 0.0613, weighted_loss: 0.2275, label: 5, bag_size: 544
batch 700, loss: 0.3082, instance_loss: 0.0469, weighted_loss: 0.2298, label: 5, bag_size: 318
batch 800, loss: 1.0932, instance_loss: 0.0986, weighted_loss: 0.7948, label: 5, bag_size: 436
batch 900, loss: 2.6232, instance_loss: 0.1697, weighted_loss: 1.8871, label: 2, bag_size: 248
batch 1000, loss: 4.2150, instance_loss: 0.2516, weighted_loss: 3.0260, label: 4, bag_size: 616
batch 1100, loss: 2.9489, instance_loss: 0.1801, weighted_loss: 2.1183, label: 2, bag_size: 320
batch 1200, loss: 3.0318, instance_loss: 0.1864, weighted_loss: 2.1782, label: 5, bag_size: 348
batch 1300, loss: 0.0815, instance_loss: 0.0325, weighted_loss: 0.0668, label: 5, bag_size: 1015
batch 1400, loss: 0.5887, instance_loss: 0.1012, weighted_loss: 0.4425, label: 2, bag_size: 389
batch 1500, loss: 0.7681, instance_loss: 0.0742, weighted_loss: 0.5599, label: 5, bag_size: 733
batch 1600, loss: 0.2688, instance_loss: 0.0704, weighted_loss: 0.2093, label: 5, bag_size: 859
batch 1700, loss: 0.2550, instance_loss: 0.0481, weighted_loss: 0.1929, label: 5, bag_size: 1217
batch 1800, loss: 4.5269, instance_loss: 0.1811, weighted_loss: 3.2231, label: 5, bag_size: 1206
batch 1900, loss: 1.4872, instance_loss: 0.1274, weighted_loss: 1.0792, label: 5, bag_size: 237
batch 2000, loss: 1.8029, instance_loss: 0.2208, weighted_loss: 1.3282, label: 3, bag_size: 1120
batch 2100, loss: 0.2924, instance_loss: 0.0594, weighted_loss: 0.2225, label: 5, bag_size: 292

Instance Classifier Stats
class 0 clustering acc 0.9981874039938556: correct 259928/260400
class 1 clustering acc 0.12828341013824884: correct 2227/17360

Epoch: 38, train_loss: 2.1620, train_clustering_loss: 0.1588, train_error: 0.4894
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6112531969309463, correct coarse 478/782
coarse class 2: coarse acc 0.8831646734130635, correct coarse 960/1087
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5764023210831721, correct fine 298/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.2, correct fine 23/115
fine class 5: fine acc 0.9045346062052506, correct fine 758/838
fine class 6: fine acc 0.10040160642570281, correct fine 25/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.1979, coarse auc: 0.7915, fine auc: 0.7893
class 0 clustering acc 0.9988636363636364: correct 31644/31680
class 1 clustering acc 0.13068181818181818: correct 276/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3909
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1302

Training for coarse_and_fine level...
batch 100, loss: 3.3291, instance_loss: 0.2019, weighted_loss: 2.3909, label: 2, bag_size: 78
batch 200, loss: 1.8923, instance_loss: 0.1506, weighted_loss: 1.3698, label: 5, bag_size: 1077
batch 300, loss: 4.2792, instance_loss: 0.2511, weighted_loss: 3.0708, label: 4, bag_size: 552
batch 400, loss: 0.1594, instance_loss: 0.0433, weighted_loss: 0.1246, label: 5, bag_size: 846
batch 500, loss: 0.9212, instance_loss: 0.2027, weighted_loss: 0.7057, label: 4, bag_size: 1204
batch 600, loss: 3.3146, instance_loss: 0.2088, weighted_loss: 2.3829, label: 6, bag_size: 273
batch 700, loss: 0.5584, instance_loss: 0.0547, weighted_loss: 0.4073, label: 5, bag_size: 2032
batch 800, loss: 6.0334, instance_loss: 0.2731, weighted_loss: 4.3053, label: 7, bag_size: 675
batch 900, loss: 0.2423, instance_loss: 0.0543, weighted_loss: 0.1859, label: 5, bag_size: 311
batch 1000, loss: 0.9978, instance_loss: 0.0797, weighted_loss: 0.7224, label: 5, bag_size: 240
batch 1100, loss: 4.7022, instance_loss: 0.2048, weighted_loss: 3.3530, label: 5, bag_size: 506
batch 1200, loss: 1.0955, instance_loss: 0.1237, weighted_loss: 0.8040, label: 2, bag_size: 605
batch 1300, loss: 4.7330, instance_loss: 0.2782, weighted_loss: 3.3966, label: 4, bag_size: 593
batch 1400, loss: 0.0825, instance_loss: 0.0402, weighted_loss: 0.0698, label: 5, bag_size: 338
batch 1500, loss: 0.9723, instance_loss: 0.1231, weighted_loss: 0.7175, label: 2, bag_size: 365
batch 1600, loss: 6.9835, instance_loss: 0.2795, weighted_loss: 4.9723, label: 1, bag_size: 244
batch 1700, loss: 0.1018, instance_loss: 0.0361, weighted_loss: 0.0821, label: 5, bag_size: 543
batch 1800, loss: 1.9263, instance_loss: 0.2408, weighted_loss: 1.4207, label: 6, bag_size: 541
batch 1900, loss: 0.5211, instance_loss: 0.0781, weighted_loss: 0.3882, label: 2, bag_size: 1216
batch 2000, loss: 1.1810, instance_loss: 0.1422, weighted_loss: 0.8693, label: 2, bag_size: 4251
batch 2100, loss: 1.8049, instance_loss: 0.1340, weighted_loss: 1.3036, label: 5, bag_size: 396

Instance Classifier Stats
class 0 clustering acc 0.9981989247311828: correct 259931/260400
class 1 clustering acc 0.12851382488479263: correct 2231/17360

Epoch: 39, train_loss: 2.1542, train_clustering_loss: 0.1591, train_error: 0.4889
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782
coarse class 2: coarse acc 0.8684452621895125, correct coarse 944/1087
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5783365570599613, correct fine 299/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.19130434782608696, correct fine 22/115
fine class 5: fine acc 0.9033412887828163, correct fine 757/838
fine class 6: fine acc 0.10843373493975904, correct fine 27/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.1953, coarse auc: 0.7918, fine auc: 0.7891
class 0 clustering acc 0.998895202020202: correct 31645/31680
class 1 clustering acc 0.13068181818181818: correct 276/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3909
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1294

Training for coarse_and_fine level...
batch 100, loss: 0.9673, instance_loss: 0.1152, weighted_loss: 0.7117, label: 2, bag_size: 232
batch 200, loss: 2.4033, instance_loss: 0.2007, weighted_loss: 1.7425, label: 2, bag_size: 551
batch 300, loss: 0.4789, instance_loss: 0.1012, weighted_loss: 0.3656, label: 2, bag_size: 263
batch 400, loss: 5.4523, instance_loss: 0.2860, weighted_loss: 3.9025, label: 8, bag_size: 512
batch 500, loss: 4.6918, instance_loss: 0.2269, weighted_loss: 3.3523, label: 7, bag_size: 716
batch 600, loss: 2.4787, instance_loss: 0.1873, weighted_loss: 1.7913, label: 5, bag_size: 427
batch 700, loss: 2.4498, instance_loss: 0.1507, weighted_loss: 1.7601, label: 5, bag_size: 1462
batch 800, loss: 1.3253, instance_loss: 0.1084, weighted_loss: 0.9602, label: 5, bag_size: 311
batch 900, loss: 0.1365, instance_loss: 0.0492, weighted_loss: 0.1103, label: 5, bag_size: 444
batch 1000, loss: 2.4636, instance_loss: 0.1803, weighted_loss: 1.7786, label: 5, bag_size: 387
batch 1100, loss: 4.2165, instance_loss: 0.2679, weighted_loss: 3.0320, label: 4, bag_size: 616
batch 1200, loss: 0.7332, instance_loss: 0.1112, weighted_loss: 0.5466, label: 2, bag_size: 198
batch 1300, loss: 4.6734, instance_loss: 0.2532, weighted_loss: 3.3473, label: 4, bag_size: 402
batch 1400, loss: 2.5404, instance_loss: 0.1863, weighted_loss: 1.8342, label: 5, bag_size: 128
batch 1500, loss: 0.4874, instance_loss: 0.1071, weighted_loss: 0.3733, label: 2, bag_size: 1359
batch 1600, loss: 0.2219, instance_loss: 0.0395, weighted_loss: 0.1672, label: 5, bag_size: 827
batch 1700, loss: 9.8866, instance_loss: 0.3806, weighted_loss: 7.0348, label: 0, bag_size: 432
batch 1800, loss: 2.2009, instance_loss: 0.1817, weighted_loss: 1.5951, label: 5, bag_size: 627
batch 1900, loss: 1.4769, instance_loss: 0.1341, weighted_loss: 1.0741, label: 5, bag_size: 216
batch 2000, loss: 1.0884, instance_loss: 0.1060, weighted_loss: 0.7937, label: 2, bag_size: 1397
batch 2100, loss: 1.1667, instance_loss: 0.2077, weighted_loss: 0.8790, label: 4, bag_size: 1387

Instance Classifier Stats
class 0 clustering acc 0.9981643625192013: correct 259922/260400
class 1 clustering acc 0.12914746543778802: correct 2242/17360

Epoch: 40, train_loss: 2.1513, train_clustering_loss: 0.1585, train_error: 0.4912
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6163682864450127, correct coarse 482/782
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5609284332688588, correct fine 290/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.2, correct fine 23/115
fine class 5: fine acc 0.9009546539379475, correct fine 755/838
fine class 6: fine acc 0.1285140562248996, correct fine 32/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.1930, coarse auc: 0.7921, fine auc: 0.7891
class 0 clustering acc 0.9989583333333333: correct 31647/31680
class 1 clustering acc 0.13020833333333334: correct 275/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3909
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1294

Training for coarse_and_fine level...
batch 100, loss: 0.8515, instance_loss: 0.2055, weighted_loss: 0.6577, label: 4, bag_size: 1424
batch 200, loss: 0.7983, instance_loss: 0.0852, weighted_loss: 0.5844, label: 2, bag_size: 1360
batch 300, loss: 2.2346, instance_loss: 0.1863, weighted_loss: 1.6201, label: 6, bag_size: 292
batch 400, loss: 0.4880, instance_loss: 0.0833, weighted_loss: 0.3666, label: 5, bag_size: 593
batch 500, loss: 1.2685, instance_loss: 0.1123, weighted_loss: 0.9217, label: 5, bag_size: 808
batch 600, loss: 0.7683, instance_loss: 0.0924, weighted_loss: 0.5655, label: 2, bag_size: 2037
batch 700, loss: 0.4793, instance_loss: 0.0982, weighted_loss: 0.3650, label: 2, bag_size: 2692
batch 800, loss: 2.1084, instance_loss: 0.2002, weighted_loss: 1.5360, label: 4, bag_size: 185
batch 900, loss: 1.8564, instance_loss: 0.2299, weighted_loss: 1.3685, label: 3, bag_size: 362
batch 1000, loss: 1.7141, instance_loss: 0.1403, weighted_loss: 1.2420, label: 2, bag_size: 858
batch 1100, loss: 0.9370, instance_loss: 0.1065, weighted_loss: 0.6878, label: 2, bag_size: 784
batch 1200, loss: 2.4497, instance_loss: 0.1664, weighted_loss: 1.7647, label: 5, bag_size: 220
batch 1300, loss: 1.4349, instance_loss: 0.2029, weighted_loss: 1.0653, label: 3, bag_size: 836
batch 1400, loss: 0.4460, instance_loss: 0.0608, weighted_loss: 0.3304, label: 5, bag_size: 618
batch 1500, loss: 1.6818, instance_loss: 0.1600, weighted_loss: 1.2253, label: 5, bag_size: 301
batch 1600, loss: 2.2001, instance_loss: 0.1705, weighted_loss: 1.5913, label: 2, bag_size: 1616
batch 1700, loss: 3.4455, instance_loss: 0.2014, weighted_loss: 2.4723, label: 5, bag_size: 304
batch 1800, loss: 2.5834, instance_loss: 0.1832, weighted_loss: 1.8633, label: 5, bag_size: 190
batch 1900, loss: 0.2052, instance_loss: 0.0576, weighted_loss: 0.1609, label: 5, bag_size: 387
batch 2000, loss: 3.4863, instance_loss: 0.2398, weighted_loss: 2.5124, label: 7, bag_size: 431
batch 2100, loss: 5.6265, instance_loss: 0.2637, weighted_loss: 4.0176, label: 1, bag_size: 198

Instance Classifier Stats
class 0 clustering acc 0.9982795698924731: correct 259952/260400
class 1 clustering acc 0.13346774193548386: correct 2317/17360

Epoch: 41, train_loss: 2.1471, train_clustering_loss: 0.1585, train_error: 0.4834
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6240409207161125, correct coarse 488/782
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5725338491295938, correct fine 296/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.23478260869565218, correct fine 27/115
fine class 5: fine acc 0.9021479713603818, correct fine 756/838
fine class 6: fine acc 0.14859437751004015, correct fine 37/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.03787878787878788, correct fine 5/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.1908, coarse auc: 0.7925, fine auc: 0.7895
class 0 clustering acc 0.9988636363636364: correct 31644/31680
class 1 clustering acc 0.13541666666666666: correct 286/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3885
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1294

Training for coarse_and_fine level...
batch 100, loss: 5.1935, instance_loss: 0.2589, weighted_loss: 3.7131, label: 8, bag_size: 235
batch 200, loss: 3.7993, instance_loss: 0.2395, weighted_loss: 2.7314, label: 7, bag_size: 618
batch 300, loss: 1.2033, instance_loss: 0.0960, weighted_loss: 0.8711, label: 5, bag_size: 714
batch 400, loss: 1.7462, instance_loss: 0.2599, weighted_loss: 1.3003, label: 6, bag_size: 1248
batch 500, loss: 2.5054, instance_loss: 0.1777, weighted_loss: 1.8071, label: 5, bag_size: 1897
batch 600, loss: 2.5564, instance_loss: 0.1801, weighted_loss: 1.8435, label: 2, bag_size: 193
batch 700, loss: 0.7466, instance_loss: 0.1020, weighted_loss: 0.5532, label: 2, bag_size: 392
batch 800, loss: 1.5070, instance_loss: 0.1920, weighted_loss: 1.1125, label: 6, bag_size: 368
batch 900, loss: 3.1263, instance_loss: 0.2464, weighted_loss: 2.2623, label: 2, bag_size: 746
batch 1000, loss: 1.5635, instance_loss: 0.1062, weighted_loss: 1.1263, label: 5, bag_size: 465
batch 1100, loss: 0.0953, instance_loss: 0.0284, weighted_loss: 0.0752, label: 5, bag_size: 331
batch 1200, loss: 1.5877, instance_loss: 0.1293, weighted_loss: 1.1502, label: 2, bag_size: 1193
batch 1300, loss: 0.1543, instance_loss: 0.0488, weighted_loss: 0.1226, label: 5, bag_size: 202
batch 1400, loss: 1.5248, instance_loss: 0.2119, weighted_loss: 1.1309, label: 3, bag_size: 504
batch 1500, loss: 0.4544, instance_loss: 0.0959, weighted_loss: 0.3469, label: 2, bag_size: 1110
batch 1600, loss: 4.7195, instance_loss: 0.2625, weighted_loss: 3.3824, label: 2, bag_size: 559
batch 1700, loss: 3.5069, instance_loss: 0.2219, weighted_loss: 2.5214, label: 7, bag_size: 168
batch 1800, loss: 1.8655, instance_loss: 0.1432, weighted_loss: 1.3488, label: 2, bag_size: 298
batch 1900, loss: 2.0463, instance_loss: 0.2610, weighted_loss: 1.5107, label: 6, bag_size: 132
batch 2000, loss: 4.2054, instance_loss: 0.2339, weighted_loss: 3.0139, label: 8, bag_size: 276
batch 2100, loss: 3.1104, instance_loss: 0.2192, weighted_loss: 2.2430, label: 8, bag_size: 563

Instance Classifier Stats
class 0 clustering acc 0.9980952380952381: correct 259904/260400
class 1 clustering acc 0.1357142857142857: correct 2356/17360

Epoch: 42, train_loss: 2.1457, train_clustering_loss: 0.1582, train_error: 0.4862
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6176470588235294, correct coarse 483/782
coarse class 2: coarse acc 0.8877644894204232, correct coarse 965/1087
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.574468085106383, correct fine 297/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.19130434782608696, correct fine 22/115
fine class 5: fine acc 0.905727923627685, correct fine 759/838
fine class 6: fine acc 0.13253012048192772, correct fine 33/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.1909, coarse auc: 0.7926, fine auc: 0.7893
class 0 clustering acc 0.9989267676767677: correct 31646/31680
class 1 clustering acc 0.13399621212121213: correct 283/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.875, correct fine 91/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3878
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1293

Training for coarse_and_fine level...
batch 100, loss: 3.2025, instance_loss: 0.2124, weighted_loss: 2.3055, label: 8, bag_size: 65
batch 200, loss: 0.1247, instance_loss: 0.0390, weighted_loss: 0.0990, label: 5, bag_size: 288
batch 300, loss: 0.2541, instance_loss: 0.0639, weighted_loss: 0.1971, label: 5, bag_size: 239
batch 400, loss: 0.3074, instance_loss: 0.0577, weighted_loss: 0.2325, label: 5, bag_size: 753
batch 500, loss: 0.7878, instance_loss: 0.2133, weighted_loss: 0.6154, label: 4, bag_size: 2219
batch 600, loss: 2.9407, instance_loss: 0.3322, weighted_loss: 2.1581, label: 6, bag_size: 304
batch 700, loss: 2.3482, instance_loss: 0.1601, weighted_loss: 1.6918, label: 5, bag_size: 311
batch 800, loss: 0.4405, instance_loss: 0.0905, weighted_loss: 0.3355, label: 2, bag_size: 388
batch 900, loss: 3.2526, instance_loss: 0.2079, weighted_loss: 2.3392, label: 7, bag_size: 658
batch 1000, loss: 0.1024, instance_loss: 0.0362, weighted_loss: 0.0826, label: 5, bag_size: 274
batch 1100, loss: 0.1889, instance_loss: 0.0369, weighted_loss: 0.1433, label: 5, bag_size: 853
batch 1200, loss: 0.7782, instance_loss: 0.1034, weighted_loss: 0.5758, label: 5, bag_size: 585
batch 1300, loss: 1.2854, instance_loss: 0.1303, weighted_loss: 0.9389, label: 2, bag_size: 440
batch 1400, loss: 2.6359, instance_loss: 0.2309, weighted_loss: 1.9144, label: 6, bag_size: 280
batch 1500, loss: 1.7775, instance_loss: 0.1259, weighted_loss: 1.2820, label: 5, bag_size: 890
batch 1600, loss: 0.7710, instance_loss: 0.0867, weighted_loss: 0.5657, label: 5, bag_size: 841
batch 1700, loss: 3.5334, instance_loss: 0.2257, weighted_loss: 2.5411, label: 2, bag_size: 50
batch 1800, loss: 2.6162, instance_loss: 0.1751, weighted_loss: 1.8838, label: 2, bag_size: 290
batch 1900, loss: 3.1335, instance_loss: 0.1681, weighted_loss: 2.2439, label: 2, bag_size: 334
batch 2000, loss: 1.2181, instance_loss: 0.2605, weighted_loss: 0.9308, label: 6, bag_size: 387
batch 2100, loss: 4.8685, instance_loss: 0.2548, weighted_loss: 3.4844, label: 7, bag_size: 444

Instance Classifier Stats
class 0 clustering acc 0.9981221198156682: correct 259911/260400
class 1 clustering acc 0.1380184331797235: correct 2396/17360

Epoch: 43, train_loss: 2.1409, train_clustering_loss: 0.1581, train_error: 0.4820
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6253196930946292, correct coarse 489/782
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087
coarse class 3: coarse acc 0.10116731517509728, correct coarse 26/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5783365570599613, correct fine 299/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.21739130434782608, correct fine 25/115
fine class 5: fine acc 0.905727923627685, correct fine 759/838
fine class 6: fine acc 0.14859437751004015, correct fine 37/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.030303030303030304, correct fine 4/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.1887, coarse auc: 0.7933, fine auc: 0.7899
class 0 clustering acc 0.9989267676767677: correct 31646/31680
class 1 clustering acc 0.13304924242424243: correct 281/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.8653846153846154, correct fine 90/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3853
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1285

Training for coarse_and_fine level...
batch 100, loss: 1.8166, instance_loss: 0.1095, weighted_loss: 1.3044, label: 5, bag_size: 532
batch 200, loss: 1.8265, instance_loss: 0.1446, weighted_loss: 1.3220, label: 5, bag_size: 151
batch 300, loss: 0.0949, instance_loss: 0.0293, weighted_loss: 0.0752, label: 5, bag_size: 383
batch 400, loss: 1.7382, instance_loss: 0.0995, weighted_loss: 1.2466, label: 5, bag_size: 714
batch 500, loss: 0.5617, instance_loss: 0.0617, weighted_loss: 0.4117, label: 5, bag_size: 310
batch 600, loss: 0.0883, instance_loss: 0.0373, weighted_loss: 0.0730, label: 5, bag_size: 318
batch 700, loss: 1.2118, instance_loss: 0.0944, weighted_loss: 0.8765, label: 5, bag_size: 460
batch 800, loss: 0.0878, instance_loss: 0.0544, weighted_loss: 0.0778, label: 5, bag_size: 179
batch 900, loss: 1.5904, instance_loss: 0.1040, weighted_loss: 1.1445, label: 5, bag_size: 465
batch 1000, loss: 5.1876, instance_loss: 0.2447, weighted_loss: 3.7047, label: 8, bag_size: 378
batch 1100, loss: 1.6929, instance_loss: 0.1922, weighted_loss: 1.2427, label: 6, bag_size: 352
batch 1200, loss: 2.9115, instance_loss: 0.2168, weighted_loss: 2.1031, label: 6, bag_size: 476
batch 1300, loss: 2.7111, instance_loss: 0.1882, weighted_loss: 1.9542, label: 5, bag_size: 338
batch 1400, loss: 5.5704, instance_loss: 0.2855, weighted_loss: 3.9849, label: 7, bag_size: 542
batch 1500, loss: 0.1827, instance_loss: 0.0399, weighted_loss: 0.1398, label: 5, bag_size: 507
batch 1600, loss: 2.5438, instance_loss: 0.1572, weighted_loss: 1.8278, label: 5, bag_size: 252
batch 1700, loss: 1.6881, instance_loss: 0.1175, weighted_loss: 1.2169, label: 5, bag_size: 525
batch 1800, loss: 0.5762, instance_loss: 0.1775, weighted_loss: 0.4566, label: 4, bag_size: 836
batch 1900, loss: 1.2177, instance_loss: 0.1127, weighted_loss: 0.8862, label: 5, bag_size: 91
batch 2000, loss: 3.8163, instance_loss: 0.2085, weighted_loss: 2.7339, label: 4, bag_size: 304
batch 2100, loss: 1.9894, instance_loss: 0.1443, weighted_loss: 1.4359, label: 5, bag_size: 548

Instance Classifier Stats
class 0 clustering acc 0.9981336405529954: correct 259914/260400
class 1 clustering acc 0.13605990783410138: correct 2362/17360

Epoch: 44, train_loss: 2.1369, train_clustering_loss: 0.1578, train_error: 0.4811
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782
coarse class 2: coarse acc 0.8638454461821528, correct coarse 939/1087
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5899419729206963, correct fine 305/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.22608695652173913, correct fine 26/115
fine class 5: fine acc 0.89618138424821, correct fine 751/838
fine class 6: fine acc 0.15261044176706828, correct fine 38/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.045454545454545456, correct fine 6/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.1850, coarse auc: 0.7928, fine auc: 0.7899
class 0 clustering acc 0.9987373737373737: correct 31640/31680
class 1 clustering acc 0.1425189393939394: correct 301/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.06666666666666667, correct fine 2/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3865
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1303

Training for coarse_and_fine level...
batch 100, loss: 2.0065, instance_loss: 0.2555, weighted_loss: 1.4812, label: 6, bag_size: 132
batch 200, loss: 3.4014, instance_loss: 0.2176, weighted_loss: 2.4462, label: 8, bag_size: 361
batch 300, loss: 5.5580, instance_loss: 0.2530, weighted_loss: 3.9665, label: 1, bag_size: 198
batch 400, loss: 1.9437, instance_loss: 0.2266, weighted_loss: 1.4285, label: 3, bag_size: 831
batch 500, loss: 0.4407, instance_loss: 0.0532, weighted_loss: 0.3244, label: 5, bag_size: 1113
batch 600, loss: 2.0153, instance_loss: 0.1665, weighted_loss: 1.4607, label: 5, bag_size: 154
batch 700, loss: 2.6694, instance_loss: 0.1937, weighted_loss: 1.9267, label: 8, bag_size: 245
batch 800, loss: 2.8664, instance_loss: 0.2213, weighted_loss: 2.0729, label: 2, bag_size: 282
batch 900, loss: 2.3286, instance_loss: 0.1416, weighted_loss: 1.6725, label: 5, bag_size: 124
batch 1000, loss: 3.5981, instance_loss: 0.2375, weighted_loss: 2.5899, label: 7, bag_size: 201
batch 1100, loss: 6.4990, instance_loss: 0.3200, weighted_loss: 4.6453, label: 7, bag_size: 549
batch 1200, loss: 0.4506, instance_loss: 0.0532, weighted_loss: 0.3314, label: 5, bag_size: 433
batch 1300, loss: 0.1724, instance_loss: 0.0442, weighted_loss: 0.1340, label: 5, bag_size: 467
batch 1400, loss: 0.3933, instance_loss: 0.0849, weighted_loss: 0.3008, label: 2, bag_size: 1189
batch 1500, loss: 2.3137, instance_loss: 0.1565, weighted_loss: 1.6666, label: 2, bag_size: 555
batch 1600, loss: 3.4896, instance_loss: 0.1784, weighted_loss: 2.4963, label: 5, bag_size: 621
batch 1700, loss: 3.7053, instance_loss: 0.2246, weighted_loss: 2.6611, label: 4, bag_size: 74
batch 1800, loss: 2.9876, instance_loss: 0.2239, weighted_loss: 2.1585, label: 7, bag_size: 311
batch 1900, loss: 1.6786, instance_loss: 0.2010, weighted_loss: 1.2353, label: 3, bag_size: 2045
batch 2000, loss: 1.5789, instance_loss: 0.1194, weighted_loss: 1.1411, label: 5, bag_size: 577
batch 2100, loss: 0.1048, instance_loss: 0.0317, weighted_loss: 0.0829, label: 5, bag_size: 485

Instance Classifier Stats
class 0 clustering acc 0.9979531490015361: correct 259867/260400
class 1 clustering acc 0.1396889400921659: correct 2425/17360

Epoch: 45, train_loss: 2.1380, train_clustering_loss: 0.1575, train_error: 0.4862
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6214833759590793, correct coarse 486/782
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5667311411992263, correct fine 293/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.23478260869565218, correct fine 27/115
fine class 5: fine acc 0.8997613365155132, correct fine 754/838
fine class 6: fine acc 0.14457831325301204, correct fine 36/249
fine class 7: fine acc 0.0, correct fine 0/89
fine class 8: fine acc 0.03787878787878788, correct fine 5/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.1828, coarse auc: 0.7940, fine auc: 0.7898
class 0 clustering acc 0.9986742424242424: correct 31638/31680
class 1 clustering acc 0.14299242424242425: correct 302/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.1, correct fine 3/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3895
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1353

Training for coarse_and_fine level...
batch 100, loss: 1.2801, instance_loss: 0.1187, weighted_loss: 0.9317, label: 2, bag_size: 663
batch 200, loss: 0.1072, instance_loss: 0.0351, weighted_loss: 0.0856, label: 5, bag_size: 460
batch 300, loss: 3.2953, instance_loss: 0.1740, weighted_loss: 2.3589, label: 2, bag_size: 123
batch 400, loss: 0.3120, instance_loss: 0.0782, weighted_loss: 0.2419, label: 2, bag_size: 1067
batch 500, loss: 0.3033, instance_loss: 0.0459, weighted_loss: 0.2261, label: 5, bag_size: 622
batch 600, loss: 0.8019, instance_loss: 0.1056, weighted_loss: 0.5930, label: 2, bag_size: 1479
batch 700, loss: 0.7027, instance_loss: 0.1285, weighted_loss: 0.5304, label: 2, bag_size: 706
batch 800, loss: 1.4354, instance_loss: 0.1010, weighted_loss: 1.0351, label: 5, bag_size: 377
batch 900, loss: 6.7591, instance_loss: 0.3057, weighted_loss: 4.8231, label: 10, bag_size: 309
batch 1000, loss: 4.8568, instance_loss: 0.2564, weighted_loss: 3.4767, label: 7, bag_size: 444
batch 1100, loss: 0.3449, instance_loss: 0.0672, weighted_loss: 0.2616, label: 5, bag_size: 289
batch 1200, loss: 0.7610, instance_loss: 0.2004, weighted_loss: 0.5928, label: 4, bag_size: 454
batch 1300, loss: 2.6066, instance_loss: 0.1884, weighted_loss: 1.8811, label: 2, bag_size: 1170
batch 1400, loss: 3.2811, instance_loss: 0.2140, weighted_loss: 2.3610, label: 8, bag_size: 259
batch 1500, loss: 3.4547, instance_loss: 0.1909, weighted_loss: 2.4755, label: 2, bag_size: 165
batch 1600, loss: 2.8882, instance_loss: 0.1734, weighted_loss: 2.0737, label: 2, bag_size: 629
batch 1700, loss: 1.2489, instance_loss: 0.0887, weighted_loss: 0.9009, label: 5, bag_size: 494
batch 1800, loss: 0.2526, instance_loss: 0.0550, weighted_loss: 0.1933, label: 5, bag_size: 435
batch 1900, loss: 0.9622, instance_loss: 0.0940, weighted_loss: 0.7017, label: 5, bag_size: 543
batch 2000, loss: 2.4671, instance_loss: 0.1960, weighted_loss: 1.7858, label: 6, bag_size: 1339
batch 2100, loss: 2.2652, instance_loss: 0.1565, weighted_loss: 1.6326, label: 2, bag_size: 1256

Instance Classifier Stats
class 0 clustering acc 0.9980491551459293: correct 259892/260400
class 1 clustering acc 0.140610599078341: correct 2441/17360

Epoch: 46, train_loss: 2.1286, train_clustering_loss: 0.1572, train_error: 0.4783
coarse class 0: coarse acc 0.0, correct coarse 0/44
coarse class 1: coarse acc 0.6214833759590793, correct coarse 486/782
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257
fine class 0: fine acc 0.0, correct fine 0/12
fine class 1: fine acc 0.0, correct fine 0/32
fine class 2: fine acc 0.5725338491295938, correct fine 296/517
fine class 3: fine acc 0.0, correct fine 0/150
fine class 4: fine acc 0.23478260869565218, correct fine 27/115
fine class 5: fine acc 0.9081145584725537, correct fine 761/838
fine class 6: fine acc 0.1646586345381526, correct fine 41/249
fine class 7: fine acc 0.011235955056179775, correct fine 1/89
fine class 8: fine acc 0.045454545454545456, correct fine 6/132
fine class 9: fine acc 0.0, correct fine 0/10
fine class 10: fine acc 0.0, correct fine 0/26
Val Set, val_loss: 2.1818, coarse auc: 0.7944, fine auc: 0.7900
class 0 clustering acc 0.9986742424242424: correct 31638/31680
class 1 clustering acc 0.1434659090909091: correct 303/2112
coarse class 0: coarse acc 0.0, correct coarse 0/4
coarse class 1: coarse acc 0.625, correct coarse 60/96
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134
coarse class 3: coarse acc 0.1, correct coarse 3/30
fine class 0: fine acc 0.0, correct fine 0/1
fine class 1: fine acc 0.0, correct fine 0/3
fine class 2: fine acc 0.609375, correct fine 39/64
fine class 3: fine acc 0.0, correct fine 0/18
fine class 4: fine acc 0.07142857142857142, correct fine 1/14
fine class 5: fine acc 0.8846153846153846, correct fine 92/104
fine class 6: fine acc 0.1, correct fine 3/30
fine class 7: fine acc 0.0, correct fine 0/10
fine class 8: fine acc 0.0, correct fine 0/16
fine class 9: fine acc 0.0, correct fine 0/1
fine class 10: fine acc 0.0, correct fine 0/3
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3876
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1353

Evaluation on Test Set...
f1 Coarse: 0.3641, f1 Fine: 0.1248, Coarse Acc: 0.6654, Fine Acc: 0.5095
