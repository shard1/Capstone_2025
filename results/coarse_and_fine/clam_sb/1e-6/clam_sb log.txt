Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for coarse_and_fine level...
batch 100, loss: 3.0901, instance_loss: 1.3150, weighted_loss: 2.5575, label: 5, bag_size: 312
batch 200, loss: 3.5851, instance_loss: 1.2480, weighted_loss: 2.8840, label: 5, bag_size: 368
batch 300, loss: 3.5423, instance_loss: 1.1950, weighted_loss: 2.8381, label: 5, bag_size: 52
batch 400, loss: 3.7286, instance_loss: 1.2258, weighted_loss: 2.9777, label: 5, bag_size: 334
batch 500, loss: 3.4652, instance_loss: 1.1984, weighted_loss: 2.7852, label: 2, bag_size: 454
batch 600, loss: 2.9124, instance_loss: 1.1633, weighted_loss: 2.3877, label: 5, bag_size: 502
batch 700, loss: 3.3667, instance_loss: 1.1356, weighted_loss: 2.6974, label: 2, bag_size: 785
batch 800, loss: 2.7771, instance_loss: 1.1587, weighted_loss: 2.2916, label: 5, bag_size: 1190
batch 900, loss: 3.3574, instance_loss: 1.0785, weighted_loss: 2.6737, label: 6, bag_size: 290
batch 1000, loss: 2.5820, instance_loss: 1.0847, weighted_loss: 2.1328, label: 5, bag_size: 248
batch 1100, loss: 2.6980, instance_loss: 1.1104, weighted_loss: 2.2218, label: 5, bag_size: 192
batch 1200, loss: 3.2701, instance_loss: 1.0161, weighted_loss: 2.5939, label: 2, bag_size: 1323
batch 1300, loss: 3.1297, instance_loss: 1.0584, weighted_loss: 2.5083, label: 2, bag_size: 382
batch 1400, loss: 3.1655, instance_loss: 1.0130, weighted_loss: 2.5197, label: 6, bag_size: 146
batch 1500, loss: 2.2966, instance_loss: 0.9107, weighted_loss: 1.8808, label: 5, bag_size: 711
batch 1600, loss: 3.8595, instance_loss: 0.9793, weighted_loss: 2.9954, label: 4, bag_size: 563
batch 1700, loss: 2.5629, instance_loss: 0.9108, weighted_loss: 2.0673, label: 5, bag_size: 1165
batch 1800, loss: 2.3400, instance_loss: 0.8773, weighted_loss: 1.9012, label: 5, bag_size: 509
batch 1900, loss: 2.0956, instance_loss: 0.8632, weighted_loss: 1.7259, label: 5, bag_size: 1853
batch 2000, loss: 3.0482, instance_loss: 0.9529, weighted_loss: 2.4196, label: 2, bag_size: 1075
batch 2100, loss: 2.9901, instance_loss: 0.8945, weighted_loss: 2.3614, label: 2, bag_size: 1384

Instance Classifier Stats
class 0 clustering acc 0.7983448540706605: correct 207889/260400
class 1 clustering acc 0.26964285714285713: correct 4681/17360

Epoch: 1, train_loss: 3.2480, train_clustering_loss: 1.0708, train_error: 0.6355
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.0012787723785166241, correct coarse 1/782 
coarse class 2: coarse acc 0.9981600735970562, correct coarse 1085/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.017408123791102514, correct fine 9/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9272076372315036, correct fine 777/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.9327, coarse auc: 0.6638, fine auc: 0.5879 
class 0 clustering acc 0.9846590909090909: correct 31194/31680 
class 1 clustering acc 0.029356060606060608: correct 62/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.0, correct coarse 0/96 
coarse class 2: coarse acc 1.0, correct coarse 134/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.0, correct fine 0/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.5076
Coarse Overall F1 Score: 0.1683
Fine Overall Accuracy: 0.3939
Fine Overall F1 Score: 0.0514

Training for coarse_and_fine level...
batch 100, loss: 2.0417, instance_loss: 0.8222, weighted_loss: 1.6759, label: 5, bag_size: 599
batch 200, loss: 2.1881, instance_loss: 0.8229, weighted_loss: 1.7785, label: 5, bag_size: 644
batch 300, loss: 1.6937, instance_loss: 0.8181, weighted_loss: 1.4310, label: 5, bag_size: 859
batch 400, loss: 3.0917, instance_loss: 0.8198, weighted_loss: 2.4101, label: 6, bag_size: 117
batch 500, loss: 4.4214, instance_loss: 0.7337, weighted_loss: 3.3151, label: 8, bag_size: 461
batch 600, loss: 2.0383, instance_loss: 0.7152, weighted_loss: 1.6414, label: 5, bag_size: 1364
batch 700, loss: 1.8364, instance_loss: 0.6941, weighted_loss: 1.4937, label: 5, bag_size: 525
batch 800, loss: 2.7856, instance_loss: 0.6701, weighted_loss: 2.1510, label: 2, bag_size: 774
batch 900, loss: 4.5669, instance_loss: 0.7717, weighted_loss: 3.4284, label: 8, bag_size: 1009
batch 1000, loss: 1.7403, instance_loss: 0.5940, weighted_loss: 1.3964, label: 5, bag_size: 645
batch 1100, loss: 1.8155, instance_loss: 0.7066, weighted_loss: 1.4828, label: 5, bag_size: 347
batch 1200, loss: 3.0436, instance_loss: 0.5958, weighted_loss: 2.3092, label: 6, bag_size: 534
batch 1300, loss: 4.1336, instance_loss: 0.5918, weighted_loss: 3.0711, label: 3, bag_size: 188
batch 1400, loss: 2.8631, instance_loss: 0.5395, weighted_loss: 2.1660, label: 2, bag_size: 1704
batch 1500, loss: 5.0500, instance_loss: 0.6205, weighted_loss: 3.7212, label: 8, bag_size: 149
batch 1600, loss: 1.3386, instance_loss: 0.5996, weighted_loss: 1.1169, label: 5, bag_size: 223
batch 1700, loss: 3.2054, instance_loss: 0.5883, weighted_loss: 2.4203, label: 2, bag_size: 317
batch 1800, loss: 3.9604, instance_loss: 0.5050, weighted_loss: 2.9238, label: 4, bag_size: 415
batch 1900, loss: 3.8664, instance_loss: 0.5458, weighted_loss: 2.8702, label: 4, bag_size: 313
batch 2000, loss: 1.6186, instance_loss: 0.5330, weighted_loss: 1.2929, label: 5, bag_size: 921
batch 2100, loss: 6.4381, instance_loss: 0.5046, weighted_loss: 4.6580, label: 0, bag_size: 324

Instance Classifier Stats
class 0 clustering acc 0.9887135176651306: correct 257461/260400
class 1 clustering acc 0.01935483870967742: correct 336/17360

Epoch: 2, train_loss: 2.8571, train_clustering_loss: 0.6700, train_error: 0.6106
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.023017902813299233, correct coarse 18/782 
coarse class 2: coarse acc 0.9898804047838087, correct coarse 1076/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.015473887814313346, correct fine 8/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9988066825775657, correct fine 837/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.7260, coarse auc: 0.6774, fine auc: 0.6114 
class 0 clustering acc 0.9999368686868687: correct 31678/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.03125, correct coarse 3/96 
coarse class 2: coarse acc 0.9925373134328358, correct coarse 133/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.0, correct fine 0/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.5152
Coarse Overall F1 Score: 0.1841
Fine Overall Accuracy: 0.3939
Fine Overall F1 Score: 0.0514

Training for coarse_and_fine level...
batch 100, loss: 3.1475, instance_loss: 0.6149, weighted_loss: 2.3877, label: 6, bag_size: 224
batch 200, loss: 1.3904, instance_loss: 0.4611, weighted_loss: 1.1116, label: 5, bag_size: 244
batch 300, loss: 4.0112, instance_loss: 0.4832, weighted_loss: 2.9528, label: 4, bag_size: 574
batch 400, loss: 2.8277, instance_loss: 0.4765, weighted_loss: 2.1223, label: 6, bag_size: 352
batch 500, loss: 1.4085, instance_loss: 0.3964, weighted_loss: 1.1049, label: 5, bag_size: 696
batch 600, loss: 1.1350, instance_loss: 0.4792, weighted_loss: 0.9382, label: 5, bag_size: 235
batch 700, loss: 2.4266, instance_loss: 0.4806, weighted_loss: 1.8428, label: 2, bag_size: 447
batch 800, loss: 4.9461, instance_loss: 0.4403, weighted_loss: 3.5944, label: 7, bag_size: 201
batch 900, loss: 1.7515, instance_loss: 0.4099, weighted_loss: 1.3490, label: 5, bag_size: 482
batch 1000, loss: 4.9644, instance_loss: 0.4077, weighted_loss: 3.5974, label: 8, bag_size: 235
batch 1100, loss: 1.3695, instance_loss: 0.3433, weighted_loss: 1.0616, label: 5, bag_size: 1422
batch 1200, loss: 1.4903, instance_loss: 0.3603, weighted_loss: 1.1513, label: 5, bag_size: 376
batch 1300, loss: 4.6544, instance_loss: 0.4127, weighted_loss: 3.3819, label: 8, bag_size: 327
batch 1400, loss: 1.7160, instance_loss: 0.3315, weighted_loss: 1.3007, label: 5, bag_size: 524
batch 1500, loss: 1.7674, instance_loss: 0.3179, weighted_loss: 1.3325, label: 5, bag_size: 427
batch 1600, loss: 5.1585, instance_loss: 0.3503, weighted_loss: 3.7160, label: 8, bag_size: 276
batch 1700, loss: 2.8446, instance_loss: 0.3340, weighted_loss: 2.0914, label: 6, bag_size: 1064
batch 1800, loss: 3.9847, instance_loss: 0.3685, weighted_loss: 2.8999, label: 3, bag_size: 371
batch 1900, loss: 4.8849, instance_loss: 0.3442, weighted_loss: 3.5227, label: 8, bag_size: 567
batch 2000, loss: 1.6020, instance_loss: 0.2941, weighted_loss: 1.2096, label: 5, bag_size: 485
batch 2100, loss: 6.2569, instance_loss: 0.3488, weighted_loss: 4.4845, label: 10, bag_size: 372

Instance Classifier Stats
class 0 clustering acc 0.999758064516129: correct 260337/260400
class 1 clustering acc 0.0002304147465437788: correct 4/17360

Epoch: 3, train_loss: 2.7314, train_clustering_loss: 0.4085, train_error: 0.6041
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.1547314578005115, correct coarse 121/782 
coarse class 2: coarse acc 0.9705611775528978, correct coarse 1055/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.048355899419729204, correct fine 25/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9952267303102625, correct fine 834/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.6428, coarse auc: 0.6863, fine auc: 0.6289 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.3854166666666667, correct coarse 37/96 
coarse class 2: coarse acc 0.9104477611940298, correct coarse 122/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.171875, correct fine 11/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9711538461538461, correct fine 101/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6023
Coarse Overall F1 Score: 0.2991
Fine Overall Accuracy: 0.4242
Fine Overall F1 Score: 0.0765

Training for coarse_and_fine level...
batch 100, loss: 2.4125, instance_loss: 0.3074, weighted_loss: 1.7810, label: 2, bag_size: 1269
batch 200, loss: 1.3543, instance_loss: 0.3408, weighted_loss: 1.0503, label: 5, bag_size: 292
batch 300, loss: 1.1193, instance_loss: 0.2692, weighted_loss: 0.8643, label: 5, bag_size: 217
batch 400, loss: 2.9354, instance_loss: 0.3061, weighted_loss: 2.1466, label: 6, bag_size: 1865
batch 500, loss: 2.4556, instance_loss: 0.3275, weighted_loss: 1.8171, label: 2, bag_size: 1744
batch 600, loss: 1.3363, instance_loss: 0.2716, weighted_loss: 1.0169, label: 5, bag_size: 311
batch 700, loss: 2.4532, instance_loss: 0.2805, weighted_loss: 1.8014, label: 2, bag_size: 334
batch 800, loss: 1.2019, instance_loss: 0.2592, weighted_loss: 0.9191, label: 5, bag_size: 817
batch 900, loss: 3.8545, instance_loss: 0.3040, weighted_loss: 2.7894, label: 4, bag_size: 488
batch 1000, loss: 2.5217, instance_loss: 0.2795, weighted_loss: 1.8490, label: 2, bag_size: 1381
batch 1100, loss: 1.0862, instance_loss: 0.2606, weighted_loss: 0.8386, label: 5, bag_size: 162
batch 1200, loss: 2.4105, instance_loss: 0.2773, weighted_loss: 1.7705, label: 2, bag_size: 454
batch 1300, loss: 5.2733, instance_loss: 0.2936, weighted_loss: 3.7794, label: 7, bag_size: 210
batch 1400, loss: 4.8184, instance_loss: 0.2929, weighted_loss: 3.4608, label: 7, bag_size: 479
batch 1500, loss: 2.2946, instance_loss: 0.2533, weighted_loss: 1.6822, label: 2, bag_size: 2104
batch 1600, loss: 1.4860, instance_loss: 0.2117, weighted_loss: 1.1037, label: 5, bag_size: 1330
batch 1700, loss: 4.7208, instance_loss: 0.2854, weighted_loss: 3.3902, label: 8, bag_size: 756
batch 1800, loss: 2.7618, instance_loss: 0.2719, weighted_loss: 2.0148, label: 6, bag_size: 641
batch 1900, loss: 2.5625, instance_loss: 0.2517, weighted_loss: 1.8692, label: 2, bag_size: 430
batch 2000, loss: 2.0992, instance_loss: 0.2672, weighted_loss: 1.5496, label: 2, bag_size: 392
batch 2100, loss: 0.7414, instance_loss: 0.1989, weighted_loss: 0.5787, label: 5, bag_size: 257

Instance Classifier Stats
class 0 clustering acc 0.9999923195084486: correct 260398/260400
class 1 clustering acc 5.76036866359447e-05: correct 1/17360

Epoch: 4, train_loss: 2.6637, train_clustering_loss: 0.2803, train_error: 0.5774
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.37595907928388744, correct coarse 294/782 
coarse class 2: coarse acc 0.9172033118675254, correct coarse 997/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.16827852998065765, correct fine 87/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9904534606205251, correct fine 830/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5905, coarse auc: 0.6937, fine auc: 0.6455 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.4895833333333333, correct coarse 47/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.296875, correct fine 19/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9519230769230769, correct fine 99/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6288
Coarse Overall F1 Score: 0.3214
Fine Overall Accuracy: 0.4470
Fine Overall F1 Score: 0.0889

Training for coarse_and_fine level...
batch 100, loss: 0.6302, instance_loss: 0.1834, weighted_loss: 0.4962, label: 5, bag_size: 179
batch 200, loss: 3.0016, instance_loss: 0.2559, weighted_loss: 2.1779, label: 6, bag_size: 219
batch 300, loss: 1.0333, instance_loss: 0.2174, weighted_loss: 0.7886, label: 5, bag_size: 956
batch 400, loss: 6.3329, instance_loss: 0.3076, weighted_loss: 4.5253, label: 9, bag_size: 862
batch 500, loss: 2.4035, instance_loss: 0.2461, weighted_loss: 1.7563, label: 2, bag_size: 1573
batch 600, loss: 2.0995, instance_loss: 0.2117, weighted_loss: 1.5332, label: 5, bag_size: 478
batch 700, loss: 2.2499, instance_loss: 0.2605, weighted_loss: 1.6531, label: 5, bag_size: 232
batch 800, loss: 2.7863, instance_loss: 0.2447, weighted_loss: 2.0238, label: 2, bag_size: 328
batch 900, loss: 4.0279, instance_loss: 0.2543, weighted_loss: 2.8958, label: 4, bag_size: 723
batch 1000, loss: 2.3861, instance_loss: 0.2295, weighted_loss: 1.7391, label: 2, bag_size: 73
batch 1100, loss: 7.1108, instance_loss: 0.2794, weighted_loss: 5.0614, label: 1, bag_size: 68
batch 1200, loss: 7.8717, instance_loss: 0.2838, weighted_loss: 5.5953, label: 1, bag_size: 418
batch 1300, loss: 2.0661, instance_loss: 0.2559, weighted_loss: 1.5230, label: 5, bag_size: 359
batch 1400, loss: 1.4135, instance_loss: 0.1852, weighted_loss: 1.0450, label: 5, bag_size: 635
batch 1500, loss: 5.1144, instance_loss: 0.2521, weighted_loss: 3.6557, label: 7, bag_size: 778
batch 1600, loss: 1.0086, instance_loss: 0.1728, weighted_loss: 0.7579, label: 5, bag_size: 414
batch 1700, loss: 1.1422, instance_loss: 0.1847, weighted_loss: 0.8550, label: 5, bag_size: 511
batch 1800, loss: 2.1493, instance_loss: 0.2060, weighted_loss: 1.5663, label: 2, bag_size: 225
batch 1900, loss: 5.6884, instance_loss: 0.2756, weighted_loss: 4.0645, label: 10, bag_size: 472
batch 2000, loss: 1.3155, instance_loss: 0.1737, weighted_loss: 0.9729, label: 5, bag_size: 543
batch 2100, loss: 1.8963, instance_loss: 0.1952, weighted_loss: 1.3860, label: 2, bag_size: 116

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 5, train_loss: 2.6141, train_clustering_loss: 0.2249, train_error: 0.5594
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.47698209718670076, correct coarse 373/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.2862669245647969, correct fine 148/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.964200477326969, correct fine 808/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5507, coarse auc: 0.7026, fine auc: 0.6566 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5208333333333334, correct coarse 50/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.421875, correct fine 27/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6326
Coarse Overall F1 Score: 0.3256
Fine Overall Accuracy: 0.4659
Fine Overall F1 Score: 0.0960

Training for coarse_and_fine level...
batch 100, loss: 2.2489, instance_loss: 0.2405, weighted_loss: 1.6464, label: 2, bag_size: 265
batch 200, loss: 1.5866, instance_loss: 0.1465, weighted_loss: 1.1546, label: 5, bag_size: 462
batch 300, loss: 2.6504, instance_loss: 0.2075, weighted_loss: 1.9175, label: 6, bag_size: 518
batch 400, loss: 1.1050, instance_loss: 0.1808, weighted_loss: 0.8277, label: 5, bag_size: 364
batch 500, loss: 1.3569, instance_loss: 0.1613, weighted_loss: 0.9982, label: 5, bag_size: 217
batch 600, loss: 4.7093, instance_loss: 0.2399, weighted_loss: 3.3685, label: 7, bag_size: 888
batch 700, loss: 1.0516, instance_loss: 0.1507, weighted_loss: 0.7813, label: 5, bag_size: 844
batch 800, loss: 1.7088, instance_loss: 0.2110, weighted_loss: 1.2595, label: 2, bag_size: 2213
batch 900, loss: 1.7979, instance_loss: 0.1952, weighted_loss: 1.3171, label: 2, bag_size: 1847
batch 1000, loss: 2.8126, instance_loss: 0.2088, weighted_loss: 2.0314, label: 6, bag_size: 344
batch 1100, loss: 2.4164, instance_loss: 0.1797, weighted_loss: 1.7454, label: 5, bag_size: 232
batch 1200, loss: 1.9144, instance_loss: 0.1963, weighted_loss: 1.3990, label: 2, bag_size: 1365
batch 1300, loss: 7.3719, instance_loss: 0.2727, weighted_loss: 5.2421, label: 0, bag_size: 388
batch 1400, loss: 3.4233, instance_loss: 0.2278, weighted_loss: 2.4647, label: 3, bag_size: 3332
batch 1500, loss: 1.8822, instance_loss: 0.2053, weighted_loss: 1.3792, label: 2, bag_size: 476
batch 1600, loss: 5.2278, instance_loss: 0.2476, weighted_loss: 3.7337, label: 7, bag_size: 263
batch 1700, loss: 2.6703, instance_loss: 0.2005, weighted_loss: 1.9294, label: 6, bag_size: 416
batch 1800, loss: 1.4160, instance_loss: 0.1478, weighted_loss: 1.0355, label: 5, bag_size: 463
batch 1900, loss: 1.0570, instance_loss: 0.1611, weighted_loss: 0.7882, label: 5, bag_size: 393
batch 2000, loss: 5.0869, instance_loss: 0.2232, weighted_loss: 3.6278, label: 8, bag_size: 457
batch 2100, loss: 1.3217, instance_loss: 0.1487, weighted_loss: 0.9698, label: 5, bag_size: 1045

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 6, train_loss: 2.5732, train_clustering_loss: 0.2010, train_error: 0.5456
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5498721227621484, correct coarse 430/782 
coarse class 2: coarse acc 0.8574057037718491, correct coarse 932/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.41392649903288203, correct fine 214/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9212410501193318, correct fine 772/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5178, coarse auc: 0.7059, fine auc: 0.6658 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.53125, correct coarse 51/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5, correct fine 32/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6364
Coarse Overall F1 Score: 0.3280
Fine Overall Accuracy: 0.4811
Fine Overall F1 Score: 0.1017

Training for coarse_and_fine level...
batch 100, loss: 1.5354, instance_loss: 0.1991, weighted_loss: 1.1345, label: 2, bag_size: 447
batch 200, loss: 2.2105, instance_loss: 0.1761, weighted_loss: 1.6002, label: 5, bag_size: 242
batch 300, loss: 4.5978, instance_loss: 0.2433, weighted_loss: 3.2914, label: 7, bag_size: 426
batch 400, loss: 1.0991, instance_loss: 0.1697, weighted_loss: 0.8202, label: 5, bag_size: 11
batch 500, loss: 2.3760, instance_loss: 0.1942, weighted_loss: 1.7215, label: 2, bag_size: 448
batch 600, loss: 2.0974, instance_loss: 0.2037, weighted_loss: 1.5293, label: 2, bag_size: 222
batch 700, loss: 2.0997, instance_loss: 0.2079, weighted_loss: 1.5322, label: 2, bag_size: 138
batch 800, loss: 2.3537, instance_loss: 0.1983, weighted_loss: 1.7071, label: 2, bag_size: 530
batch 900, loss: 4.9805, instance_loss: 0.2382, weighted_loss: 3.5578, label: 8, bag_size: 876
batch 1000, loss: 0.9195, instance_loss: 0.1355, weighted_loss: 0.6843, label: 5, bag_size: 658
batch 1100, loss: 2.9664, instance_loss: 0.2079, weighted_loss: 2.1388, label: 6, bag_size: 589
batch 1200, loss: 3.1235, instance_loss: 0.2425, weighted_loss: 2.2592, label: 3, bag_size: 378
batch 1300, loss: 2.7260, instance_loss: 0.2079, weighted_loss: 1.9706, label: 6, bag_size: 696
batch 1400, loss: 3.2667, instance_loss: 0.2155, weighted_loss: 2.3513, label: 4, bag_size: 691
batch 1500, loss: 5.5469, instance_loss: 0.2286, weighted_loss: 3.9514, label: 8, bag_size: 367
batch 1600, loss: 2.1070, instance_loss: 0.1879, weighted_loss: 1.5313, label: 2, bag_size: 1323
batch 1700, loss: 2.6999, instance_loss: 0.2055, weighted_loss: 1.9516, label: 6, bag_size: 896
batch 1800, loss: 2.6199, instance_loss: 0.1866, weighted_loss: 1.8899, label: 2, bag_size: 976
batch 1900, loss: 3.1753, instance_loss: 0.2297, weighted_loss: 2.2916, label: 3, bag_size: 685
batch 2000, loss: 4.2674, instance_loss: 0.2354, weighted_loss: 3.0578, label: 4, bag_size: 424
batch 2100, loss: 1.9919, instance_loss: 0.1360, weighted_loss: 1.4351, label: 5, bag_size: 1246

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 7, train_loss: 2.5380, train_clustering_loss: 0.1898, train_error: 0.5396
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5754475703324808, correct coarse 450/782 
coarse class 2: coarse acc 0.8500459981600736, correct coarse 924/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.45454545454545453, correct fine 235/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9116945107398569, correct fine 764/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4901, coarse auc: 0.7130, fine auc: 0.6768 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5416666666666666, correct coarse 52/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3305
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1058

Training for coarse_and_fine level...
batch 100, loss: 0.7788, instance_loss: 0.1392, weighted_loss: 0.5869, label: 5, bag_size: 329
batch 200, loss: 1.4382, instance_loss: 0.1351, weighted_loss: 1.0473, label: 5, bag_size: 307
batch 300, loss: 0.3941, instance_loss: 0.1282, weighted_loss: 0.3143, label: 5, bag_size: 190
batch 400, loss: 2.8686, instance_loss: 0.1556, weighted_loss: 2.0547, label: 5, bag_size: 608
batch 500, loss: 1.7517, instance_loss: 0.1416, weighted_loss: 1.2687, label: 5, bag_size: 193
batch 600, loss: 4.9765, instance_loss: 0.2463, weighted_loss: 3.5574, label: 8, bag_size: 567
batch 700, loss: 1.5759, instance_loss: 0.1860, weighted_loss: 1.1589, label: 2, bag_size: 207
batch 800, loss: 0.4435, instance_loss: 0.1162, weighted_loss: 0.3453, label: 5, bag_size: 307
batch 900, loss: 7.4060, instance_loss: 0.2477, weighted_loss: 5.2585, label: 1, bag_size: 320
batch 1000, loss: 4.8013, instance_loss: 0.2298, weighted_loss: 3.4298, label: 7, bag_size: 1800
batch 1100, loss: 1.7701, instance_loss: 0.1347, weighted_loss: 1.2795, label: 5, bag_size: 396
batch 1200, loss: 2.4388, instance_loss: 0.2118, weighted_loss: 1.7707, label: 6, bag_size: 333
batch 1300, loss: 3.0699, instance_loss: 0.1894, weighted_loss: 2.2058, label: 2, bag_size: 675
batch 1400, loss: 2.8686, instance_loss: 0.1901, weighted_loss: 2.0650, label: 2, bag_size: 559
batch 1500, loss: 0.4817, instance_loss: 0.1159, weighted_loss: 0.3720, label: 5, bag_size: 515
batch 1600, loss: 1.8640, instance_loss: 0.1532, weighted_loss: 1.3508, label: 5, bag_size: 315
batch 1700, loss: 2.5170, instance_loss: 0.1792, weighted_loss: 1.8157, label: 2, bag_size: 172
batch 1800, loss: 1.7332, instance_loss: 0.1270, weighted_loss: 1.2513, label: 5, bag_size: 607
batch 1900, loss: 5.9464, instance_loss: 0.2531, weighted_loss: 4.2384, label: 10, bag_size: 416
batch 2000, loss: 1.0318, instance_loss: 0.1447, weighted_loss: 0.7656, label: 5, bag_size: 310
batch 2100, loss: 1.9561, instance_loss: 0.1521, weighted_loss: 1.4149, label: 5, bag_size: 121

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 8, train_loss: 2.5073, train_clustering_loss: 0.1835, train_error: 0.5369
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.578005115089514, correct coarse 452/782 
coarse class 2: coarse acc 0.8537258509659613, correct coarse 928/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.4951644100580271, correct fine 256/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8937947494033412, correct fine 749/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4657, coarse auc: 0.7199, fine auc: 0.6875 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6288
Coarse Overall F1 Score: 0.3278
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1046

Training for coarse_and_fine level...
batch 100, loss: 3.3232, instance_loss: 0.2303, weighted_loss: 2.3953, label: 3, bag_size: 1087
batch 200, loss: 0.7224, instance_loss: 0.1179, weighted_loss: 0.5411, label: 5, bag_size: 307
batch 300, loss: 1.7813, instance_loss: 0.1777, weighted_loss: 1.3002, label: 2, bag_size: 900
batch 400, loss: 1.3062, instance_loss: 0.1292, weighted_loss: 0.9531, label: 5, bag_size: 1330
batch 500, loss: 2.3124, instance_loss: 0.1553, weighted_loss: 1.6653, label: 5, bag_size: 367
batch 600, loss: 2.2053, instance_loss: 0.1510, weighted_loss: 1.5891, label: 5, bag_size: 347
batch 700, loss: 3.3789, instance_loss: 0.2037, weighted_loss: 2.4263, label: 6, bag_size: 246
batch 800, loss: 3.1142, instance_loss: 0.2316, weighted_loss: 2.2494, label: 3, bag_size: 1706
batch 900, loss: 3.4213, instance_loss: 0.2354, weighted_loss: 2.4655, label: 3, bag_size: 837
batch 1000, loss: 1.2300, instance_loss: 0.1403, weighted_loss: 0.9031, label: 5, bag_size: 568
batch 1100, loss: 0.5592, instance_loss: 0.1260, weighted_loss: 0.4292, label: 5, bag_size: 437
batch 1200, loss: 1.5419, instance_loss: 0.1673, weighted_loss: 1.1295, label: 2, bag_size: 884
batch 1300, loss: 1.5656, instance_loss: 0.1634, weighted_loss: 1.1449, label: 2, bag_size: 309
batch 1400, loss: 4.2677, instance_loss: 0.2409, weighted_loss: 3.0596, label: 4, bag_size: 118
batch 1500, loss: 3.4600, instance_loss: 0.2445, weighted_loss: 2.4954, label: 4, bag_size: 779
batch 1600, loss: 0.8499, instance_loss: 0.1163, weighted_loss: 0.6298, label: 5, bag_size: 887
batch 1700, loss: 0.7284, instance_loss: 0.1389, weighted_loss: 0.5515, label: 5, bag_size: 565
batch 1800, loss: 0.9057, instance_loss: 0.1174, weighted_loss: 0.6692, label: 5, bag_size: 667
batch 1900, loss: 0.6389, instance_loss: 0.1235, weighted_loss: 0.4843, label: 5, bag_size: 206
batch 2000, loss: 8.3179, instance_loss: 0.2683, weighted_loss: 5.9030, label: 1, bag_size: 807
batch 2100, loss: 1.1519, instance_loss: 0.1617, weighted_loss: 0.8548, label: 2, bag_size: 357

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 0.0001152073732718894: correct 2/17360

Epoch: 9, train_loss: 2.4796, train_clustering_loss: 0.1805, train_error: 0.5304
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6329923273657289, correct coarse 495/782 
coarse class 2: coarse acc 0.8178472861085556, correct coarse 889/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5415860735009671, correct fine 280/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8818615751789977, correct fine 739/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4437, coarse auc: 0.7276, fine auc: 0.6954 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5729166666666666, correct coarse 55/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3327
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1067

Training for coarse_and_fine level...
batch 100, loss: 1.5804, instance_loss: 0.1239, weighted_loss: 1.1434, label: 5, bag_size: 576
batch 200, loss: 2.4757, instance_loss: 0.2331, weighted_loss: 1.8029, label: 6, bag_size: 649
batch 300, loss: 3.5937, instance_loss: 0.2432, weighted_loss: 2.5886, label: 4, bag_size: 488
batch 400, loss: 2.8328, instance_loss: 0.1886, weighted_loss: 2.0395, label: 2, bag_size: 746
batch 500, loss: 2.6970, instance_loss: 0.2009, weighted_loss: 1.9481, label: 6, bag_size: 476
batch 600, loss: 1.9549, instance_loss: 0.1351, weighted_loss: 1.4089, label: 5, bag_size: 604
batch 700, loss: 1.4282, instance_loss: 0.1154, weighted_loss: 1.0343, label: 5, bag_size: 661
batch 800, loss: 4.5086, instance_loss: 0.2350, weighted_loss: 3.2265, label: 8, bag_size: 2218
batch 900, loss: 0.9801, instance_loss: 0.1832, weighted_loss: 0.7411, label: 2, bag_size: 1561
batch 1000, loss: 1.9762, instance_loss: 0.1280, weighted_loss: 1.4218, label: 5, bag_size: 1355
batch 1100, loss: 1.3436, instance_loss: 0.1162, weighted_loss: 0.9754, label: 5, bag_size: 373
batch 1200, loss: 2.6084, instance_loss: 0.1759, weighted_loss: 1.8786, label: 2, bag_size: 399
batch 1300, loss: 3.8060, instance_loss: 0.2224, weighted_loss: 2.7309, label: 8, bag_size: 198
batch 1400, loss: 1.4893, instance_loss: 0.1676, weighted_loss: 1.0928, label: 2, bag_size: 748
batch 1500, loss: 3.5495, instance_loss: 0.2242, weighted_loss: 2.5519, label: 8, bag_size: 120
batch 1600, loss: 4.4014, instance_loss: 0.2337, weighted_loss: 3.1511, label: 8, bag_size: 461
batch 1700, loss: 4.0624, instance_loss: 0.2369, weighted_loss: 2.9148, label: 7, bag_size: 311
batch 1800, loss: 4.0468, instance_loss: 0.2314, weighted_loss: 2.9022, label: 8, bag_size: 209
batch 1900, loss: 4.6971, instance_loss: 0.2389, weighted_loss: 3.3596, label: 7, bag_size: 981
batch 2000, loss: 2.6114, instance_loss: 0.2108, weighted_loss: 1.8912, label: 6, bag_size: 200
batch 2100, loss: 1.2457, instance_loss: 0.1224, weighted_loss: 0.9087, label: 5, bag_size: 621

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 10, train_loss: 2.4552, train_clustering_loss: 0.1776, train_error: 0.5295
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.828886844526219, correct coarse 901/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5667311411992263, correct fine 293/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8687350835322196, correct fine 728/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4239, coarse auc: 0.7352, fine auc: 0.7069 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.7985074626865671, correct coarse 107/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6250
Coarse Overall F1 Score: 0.3273
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1060

Training for coarse_and_fine level...
batch 100, loss: 3.1642, instance_loss: 0.2126, weighted_loss: 2.2787, label: 3, bag_size: 362
batch 200, loss: 4.1572, instance_loss: 0.2174, weighted_loss: 2.9753, label: 7, bag_size: 479
batch 300, loss: 2.6962, instance_loss: 0.2004, weighted_loss: 1.9475, label: 6, bag_size: 696
batch 400, loss: 3.8634, instance_loss: 0.1796, weighted_loss: 2.7582, label: 2, bag_size: 564
batch 500, loss: 5.3798, instance_loss: 0.2289, weighted_loss: 3.8345, label: 8, bag_size: 457
batch 600, loss: 0.5771, instance_loss: 0.1109, weighted_loss: 0.4372, label: 5, bag_size: 353
batch 700, loss: 1.8493, instance_loss: 0.1308, weighted_loss: 1.3337, label: 5, bag_size: 193
batch 800, loss: 1.1974, instance_loss: 0.1178, weighted_loss: 0.8735, label: 5, bag_size: 733
batch 900, loss: 2.6097, instance_loss: 0.2152, weighted_loss: 1.8914, label: 6, bag_size: 701
batch 1000, loss: 1.7785, instance_loss: 0.1337, weighted_loss: 1.2850, label: 5, bag_size: 116
batch 1100, loss: 0.7273, instance_loss: 0.1602, weighted_loss: 0.5572, label: 2, bag_size: 305
batch 1200, loss: 1.1623, instance_loss: 0.1146, weighted_loss: 0.8480, label: 5, bag_size: 460
batch 1300, loss: 0.6165, instance_loss: 0.1259, weighted_loss: 0.4693, label: 5, bag_size: 702
batch 1400, loss: 4.1013, instance_loss: 0.2190, weighted_loss: 2.9366, label: 8, bag_size: 478
batch 1500, loss: 2.0781, instance_loss: 0.1306, weighted_loss: 1.4939, label: 5, bag_size: 596
batch 1600, loss: 2.5626, instance_loss: 0.1681, weighted_loss: 1.8442, label: 5, bag_size: 248
batch 1700, loss: 2.5017, instance_loss: 0.2043, weighted_loss: 1.8125, label: 3, bag_size: 1336
batch 1800, loss: 3.2924, instance_loss: 0.1974, weighted_loss: 2.3639, label: 3, bag_size: 106
batch 1900, loss: 5.3821, instance_loss: 0.2457, weighted_loss: 3.8412, label: 8, bag_size: 531
batch 2000, loss: 1.3486, instance_loss: 0.1490, weighted_loss: 0.9887, label: 2, bag_size: 981
batch 2100, loss: 0.6925, instance_loss: 0.1050, weighted_loss: 0.5163, label: 5, bag_size: 364

Instance Classifier Stats
class 0 clustering acc 0.9999923195084486: correct 260398/260400
class 1 clustering acc 0.0003456221198156682: correct 6/17360

Epoch: 11, train_loss: 2.4320, train_clustering_loss: 0.1758, train_error: 0.5240
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6547314578005116, correct coarse 512/782 
coarse class 2: coarse acc 0.8150873965041399, correct coarse 886/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.860381861575179, correct fine 721/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4048, coarse auc: 0.7413, fine auc: 0.7127 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.59375, correct coarse 57/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3340
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1075

Training for coarse_and_fine level...
batch 100, loss: 2.6177, instance_loss: 0.2566, weighted_loss: 1.9094, label: 5, bag_size: 473
batch 200, loss: 2.4452, instance_loss: 0.2058, weighted_loss: 1.7734, label: 6, bag_size: 256
batch 300, loss: 2.5883, instance_loss: 0.2285, weighted_loss: 1.8803, label: 6, bag_size: 481
batch 400, loss: 4.1723, instance_loss: 0.2174, weighted_loss: 2.9858, label: 3, bag_size: 347
batch 500, loss: 0.8815, instance_loss: 0.1723, weighted_loss: 0.6688, label: 2, bag_size: 1561
batch 600, loss: 2.7452, instance_loss: 0.2290, weighted_loss: 1.9903, label: 3, bag_size: 1967
batch 700, loss: 3.2596, instance_loss: 0.2185, weighted_loss: 2.3472, label: 6, bag_size: 361
batch 800, loss: 2.3865, instance_loss: 0.1920, weighted_loss: 1.7282, label: 2, bag_size: 861
batch 900, loss: 4.5854, instance_loss: 0.2699, weighted_loss: 3.2908, label: 10, bag_size: 13
batch 1000, loss: 3.1982, instance_loss: 0.2039, weighted_loss: 2.2999, label: 2, bag_size: 559
batch 1100, loss: 1.1703, instance_loss: 0.1228, weighted_loss: 0.8561, label: 5, bag_size: 192
batch 1200, loss: 0.6482, instance_loss: 0.1073, weighted_loss: 0.4859, label: 5, bag_size: 712
batch 1300, loss: 6.5800, instance_loss: 0.2527, weighted_loss: 4.6818, label: 7, bag_size: 561
batch 1400, loss: 4.1097, instance_loss: 0.2273, weighted_loss: 2.9449, label: 8, bag_size: 720
batch 1500, loss: 3.3400, instance_loss: 0.1989, weighted_loss: 2.3977, label: 2, bag_size: 215
batch 1600, loss: 1.2887, instance_loss: 0.1591, weighted_loss: 0.9498, label: 2, bag_size: 1727
batch 1700, loss: 0.3691, instance_loss: 0.0912, weighted_loss: 0.2857, label: 5, bag_size: 554
batch 1800, loss: 3.0619, instance_loss: 0.2073, weighted_loss: 2.2055, label: 6, bag_size: 519
batch 1900, loss: 0.3294, instance_loss: 0.1061, weighted_loss: 0.2624, label: 5, bag_size: 883
batch 2000, loss: 1.7820, instance_loss: 0.1840, weighted_loss: 1.3026, label: 2, bag_size: 4251
batch 2100, loss: 1.5759, instance_loss: 0.1906, weighted_loss: 1.1603, label: 2, bag_size: 354

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 0.0002880184331797235: correct 5/17360

Epoch: 12, train_loss: 2.4101, train_clustering_loss: 0.1741, train_error: 0.5258
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6547314578005116, correct coarse 512/782 
coarse class 2: coarse acc 0.827046918123275, correct coarse 899/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5996131528046421, correct fine 310/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8579952267303103, correct fine 719/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3868, coarse auc: 0.7473, fine auc: 0.7197 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8059701492537313, correct coarse 108/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6326
Coarse Overall F1 Score: 0.3316
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1061

Training for coarse_and_fine level...
batch 100, loss: 3.1038, instance_loss: 0.2326, weighted_loss: 2.2424, label: 3, bag_size: 301
batch 200, loss: 0.5972, instance_loss: 0.1003, weighted_loss: 0.4481, label: 5, bag_size: 887
batch 300, loss: 3.2372, instance_loss: 0.2257, weighted_loss: 2.3338, label: 4, bag_size: 2080
batch 400, loss: 0.5062, instance_loss: 0.1053, weighted_loss: 0.3859, label: 5, bag_size: 628
batch 500, loss: 0.2202, instance_loss: 0.1100, weighted_loss: 0.1872, label: 5, bag_size: 475
batch 600, loss: 0.4404, instance_loss: 0.0960, weighted_loss: 0.3371, label: 5, bag_size: 330
batch 700, loss: 6.8462, instance_loss: 0.3009, weighted_loss: 4.8826, label: 9, bag_size: 464
batch 800, loss: 3.6184, instance_loss: 0.2157, weighted_loss: 2.5976, label: 8, bag_size: 383
batch 900, loss: 3.9171, instance_loss: 0.2348, weighted_loss: 2.8124, label: 8, bag_size: 384
batch 1000, loss: 2.8346, instance_loss: 0.2201, weighted_loss: 2.0503, label: 4, bag_size: 1460
batch 1100, loss: 2.5058, instance_loss: 0.2037, weighted_loss: 1.8152, label: 3, bag_size: 410
batch 1200, loss: 3.5660, instance_loss: 0.2158, weighted_loss: 2.5610, label: 3, bag_size: 185
batch 1300, loss: 1.4184, instance_loss: 0.1484, weighted_loss: 1.0374, label: 2, bag_size: 1397
batch 1400, loss: 3.7148, instance_loss: 0.2342, weighted_loss: 2.6707, label: 7, bag_size: 120
batch 1500, loss: 2.5618, instance_loss: 0.2241, weighted_loss: 1.8605, label: 3, bag_size: 1947
batch 1600, loss: 2.4242, instance_loss: 0.1925, weighted_loss: 1.7547, label: 6, bag_size: 239
batch 1700, loss: 4.3017, instance_loss: 0.2238, weighted_loss: 3.0783, label: 8, bag_size: 96
batch 1800, loss: 7.7737, instance_loss: 0.2601, weighted_loss: 5.5196, label: 3, bag_size: 477
batch 1900, loss: 1.2746, instance_loss: 0.1573, weighted_loss: 0.9394, label: 2, bag_size: 623
batch 2000, loss: 1.0055, instance_loss: 0.1156, weighted_loss: 0.7385, label: 5, bag_size: 274
batch 2100, loss: 6.5325, instance_loss: 0.2552, weighted_loss: 4.6493, label: 8, bag_size: 435

Instance Classifier Stats
class 0 clustering acc 0.9999884792626728: correct 260397/260400
class 1 clustering acc 0.0010368663594470047: correct 18/17360

Epoch: 13, train_loss: 2.3909, train_clustering_loss: 0.1726, train_error: 0.5226
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6572890025575447, correct coarse 514/782 
coarse class 2: coarse acc 0.8196872125114996, correct coarse 891/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6170212765957447, correct fine 319/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8556085918854416, correct fine 717/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3701, coarse auc: 0.7534, fine auc: 0.7283 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8059701492537313, correct coarse 108/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3363
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1054

Training for coarse_and_fine level...
batch 100, loss: 1.2781, instance_loss: 0.1033, weighted_loss: 0.9257, label: 5, bag_size: 954
batch 200, loss: 2.5621, instance_loss: 0.2193, weighted_loss: 1.8593, label: 3, bag_size: 428
batch 300, loss: 2.2127, instance_loss: 0.2002, weighted_loss: 1.6090, label: 6, bag_size: 235
batch 400, loss: 0.9962, instance_loss: 0.1032, weighted_loss: 0.7283, label: 5, bag_size: 706
batch 500, loss: 1.4526, instance_loss: 0.1263, weighted_loss: 1.0547, label: 5, bag_size: 115
batch 600, loss: 1.1413, instance_loss: 0.1201, weighted_loss: 0.8349, label: 5, bag_size: 258
batch 700, loss: 3.7800, instance_loss: 0.2223, weighted_loss: 2.7127, label: 7, bag_size: 658
batch 800, loss: 1.2365, instance_loss: 0.1637, weighted_loss: 0.9147, label: 2, bag_size: 1727
batch 900, loss: 1.8513, instance_loss: 0.1764, weighted_loss: 1.3488, label: 2, bag_size: 1232
batch 1000, loss: 3.0366, instance_loss: 0.2059, weighted_loss: 2.1873, label: 6, bag_size: 379
batch 1100, loss: 2.2575, instance_loss: 0.1723, weighted_loss: 1.6319, label: 2, bag_size: 365
batch 1200, loss: 0.9670, instance_loss: 0.1490, weighted_loss: 0.7216, label: 2, bag_size: 941
batch 1300, loss: 0.4606, instance_loss: 0.1035, weighted_loss: 0.3534, label: 5, bag_size: 505
batch 1400, loss: 2.4144, instance_loss: 0.1948, weighted_loss: 1.7485, label: 3, bag_size: 2170
batch 1500, loss: 2.8658, instance_loss: 0.1183, weighted_loss: 2.0416, label: 5, bag_size: 1744
batch 1600, loss: 0.9070, instance_loss: 0.1451, weighted_loss: 0.6784, label: 2, bag_size: 1359
batch 1700, loss: 1.2076, instance_loss: 0.1059, weighted_loss: 0.8771, label: 5, bag_size: 640
batch 1800, loss: 1.6442, instance_loss: 0.1038, weighted_loss: 1.1821, label: 5, bag_size: 1062
batch 1900, loss: 1.9972, instance_loss: 0.1716, weighted_loss: 1.4495, label: 2, bag_size: 965
batch 2000, loss: 2.3079, instance_loss: 0.1357, weighted_loss: 1.6563, label: 2, bag_size: 420
batch 2100, loss: 0.8416, instance_loss: 0.1581, weighted_loss: 0.6366, label: 2, bag_size: 2086

Instance Classifier Stats
class 0 clustering acc 0.9999615975422427: correct 260390/260400
class 1 clustering acc 0.0020737327188940094: correct 36/17360

Epoch: 14, train_loss: 2.3703, train_clustering_loss: 0.1713, train_error: 0.5207
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6572890025575447, correct coarse 514/782 
coarse class 2: coarse acc 0.8187672493100276, correct coarse 890/1087 
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.620889748549323, correct fine 321/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8579952267303103, correct fine 719/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3541, coarse auc: 0.7581, fine auc: 0.7344 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8059701492537313, correct coarse 108/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3387
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1072

Training for coarse_and_fine level...
batch 100, loss: 0.9015, instance_loss: 0.1098, weighted_loss: 0.6640, label: 5, bag_size: 393
batch 200, loss: 1.1130, instance_loss: 0.1436, weighted_loss: 0.8222, label: 2, bag_size: 1523
batch 300, loss: 0.4402, instance_loss: 0.1058, weighted_loss: 0.3399, label: 5, bag_size: 488
batch 400, loss: 1.2043, instance_loss: 0.1265, weighted_loss: 0.8810, label: 5, bag_size: 376
batch 500, loss: 3.5337, instance_loss: 0.2329, weighted_loss: 2.5435, label: 8, bag_size: 340
batch 600, loss: 0.4411, instance_loss: 0.0828, weighted_loss: 0.3336, label: 5, bag_size: 1137
batch 700, loss: 2.5449, instance_loss: 0.2048, weighted_loss: 1.8428, label: 3, bag_size: 774
batch 800, loss: 4.3999, instance_loss: 0.2445, weighted_loss: 3.1533, label: 8, bag_size: 253
batch 900, loss: 4.2368, instance_loss: 0.2383, weighted_loss: 3.0372, label: 8, bag_size: 116
batch 1000, loss: 2.5173, instance_loss: 0.2285, weighted_loss: 1.8306, label: 6, bag_size: 337
batch 1100, loss: 3.7857, instance_loss: 0.1979, weighted_loss: 2.7094, label: 2, bag_size: 235
batch 1200, loss: 2.5040, instance_loss: 0.1759, weighted_loss: 1.8056, label: 2, bag_size: 149
batch 1300, loss: 2.4122, instance_loss: 0.1774, weighted_loss: 1.7418, label: 5, bag_size: 299
batch 1400, loss: 0.3580, instance_loss: 0.0932, weighted_loss: 0.2786, label: 5, bag_size: 682
batch 1500, loss: 5.4612, instance_loss: 0.2562, weighted_loss: 3.8997, label: 8, bag_size: 367
batch 1600, loss: 5.6232, instance_loss: 0.2853, weighted_loss: 4.0218, label: 10, bag_size: 270
batch 1700, loss: 1.1859, instance_loss: 0.0975, weighted_loss: 0.8594, label: 5, bag_size: 888
batch 1800, loss: 2.4528, instance_loss: 0.1989, weighted_loss: 1.7766, label: 6, bag_size: 263
batch 1900, loss: 3.4107, instance_loss: 0.1961, weighted_loss: 2.4463, label: 2, bag_size: 250
batch 2000, loss: 1.2417, instance_loss: 0.1405, weighted_loss: 0.9114, label: 2, bag_size: 2601
batch 2100, loss: 1.3237, instance_loss: 0.0930, weighted_loss: 0.9545, label: 5, bag_size: 814

Instance Classifier Stats
class 0 clustering acc 0.9999308755760369: correct 260382/260400
class 1 clustering acc 0.004147465437788019: correct 72/17360

Epoch: 15, train_loss: 2.3529, train_clustering_loss: 0.1701, train_error: 0.5207
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6585677749360613, correct coarse 515/782 
coarse class 2: coarse acc 0.827966881324747, correct coarse 900/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6228239845261122, correct fine 322/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8568019093078759, correct fine 718/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3390, coarse auc: 0.7613, fine auc: 0.7431 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.7985074626865671, correct coarse 107/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3540
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1082

Training for coarse_and_fine level...
batch 100, loss: 0.7027, instance_loss: 0.1103, weighted_loss: 0.5250, label: 5, bag_size: 451
batch 200, loss: 2.1630, instance_loss: 0.1638, weighted_loss: 1.5632, label: 2, bag_size: 613
batch 300, loss: 0.7838, instance_loss: 0.1190, weighted_loss: 0.5844, label: 5, bag_size: 393
batch 400, loss: 2.0472, instance_loss: 0.1994, weighted_loss: 1.4928, label: 4, bag_size: 2272
batch 500, loss: 3.1477, instance_loss: 0.2274, weighted_loss: 2.2716, label: 3, bag_size: 301
batch 600, loss: 0.8536, instance_loss: 0.1022, weighted_loss: 0.6282, label: 5, bag_size: 365
batch 700, loss: 0.8978, instance_loss: 0.1104, weighted_loss: 0.6616, label: 5, bag_size: 704
batch 800, loss: 2.0378, instance_loss: 0.2174, weighted_loss: 1.4917, label: 6, bag_size: 541
batch 900, loss: 1.2832, instance_loss: 0.1248, weighted_loss: 0.9357, label: 5, bag_size: 307
batch 1000, loss: 0.2958, instance_loss: 0.0896, weighted_loss: 0.2340, label: 5, bag_size: 996
batch 1100, loss: 2.2593, instance_loss: 0.2042, weighted_loss: 1.6428, label: 6, bag_size: 477
batch 1200, loss: 2.7359, instance_loss: 0.1814, weighted_loss: 1.9696, label: 2, bag_size: 201
batch 1300, loss: 0.6929, instance_loss: 0.1121, weighted_loss: 0.5186, label: 5, bag_size: 679
batch 1400, loss: 6.8302, instance_loss: 0.2790, weighted_loss: 4.8648, label: 10, bag_size: 264
batch 1500, loss: 0.9032, instance_loss: 0.1524, weighted_loss: 0.6780, label: 2, bag_size: 1231
batch 1600, loss: 0.3440, instance_loss: 0.0830, weighted_loss: 0.2657, label: 5, bag_size: 834
batch 1700, loss: 2.6338, instance_loss: 0.1956, weighted_loss: 1.9024, label: 6, bag_size: 545
batch 1800, loss: 3.0200, instance_loss: 0.2141, weighted_loss: 2.1782, label: 2, bag_size: 946
batch 1900, loss: 3.7642, instance_loss: 0.2103, weighted_loss: 2.6980, label: 3, bag_size: 298
batch 2000, loss: 2.0444, instance_loss: 0.1529, weighted_loss: 1.4770, label: 2, bag_size: 427
batch 2100, loss: 0.8254, instance_loss: 0.0894, weighted_loss: 0.6046, label: 5, bag_size: 308

Instance Classifier Stats
class 0 clustering acc 0.999900153609831: correct 260374/260400
class 1 clustering acc 0.007661290322580645: correct 133/17360

Epoch: 16, train_loss: 2.3358, train_clustering_loss: 0.1688, train_error: 0.5184
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6662404092071611, correct coarse 521/782 
coarse class 2: coarse acc 0.827966881324747, correct coarse 900/1087 
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6344294003868471, correct fine 328/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8556085918854416, correct fine 717/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3250, coarse auc: 0.7657, fine auc: 0.7491 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0004734848484848485: correct 1/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8059701492537313, correct coarse 108/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3537
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1082

Training for coarse_and_fine level...
batch 100, loss: 0.2403, instance_loss: 0.0857, weighted_loss: 0.1939, label: 5, bag_size: 323
batch 200, loss: 3.7089, instance_loss: 0.1600, weighted_loss: 2.6442, label: 5, bag_size: 1206
batch 300, loss: 2.3674, instance_loss: 0.1420, weighted_loss: 1.6998, label: 5, bag_size: 708
batch 400, loss: 2.5530, instance_loss: 0.2174, weighted_loss: 1.8523, label: 6, bag_size: 1339
batch 500, loss: 2.7240, instance_loss: 0.2077, weighted_loss: 1.9691, label: 6, bag_size: 590
batch 600, loss: 2.3636, instance_loss: 0.2055, weighted_loss: 1.7162, label: 6, bag_size: 481
batch 700, loss: 3.8014, instance_loss: 0.2228, weighted_loss: 2.7278, label: 7, bag_size: 529
batch 800, loss: 0.8392, instance_loss: 0.1294, weighted_loss: 0.6263, label: 2, bag_size: 1771
batch 900, loss: 0.1558, instance_loss: 0.0750, weighted_loss: 0.1315, label: 5, bag_size: 1015
batch 1000, loss: 1.2122, instance_loss: 0.1383, weighted_loss: 0.8901, label: 2, bag_size: 310
batch 1100, loss: 0.6162, instance_loss: 0.0897, weighted_loss: 0.4583, label: 5, bag_size: 2663
batch 1200, loss: 0.5719, instance_loss: 0.1300, weighted_loss: 0.4394, label: 2, bag_size: 1353
batch 1300, loss: 1.1472, instance_loss: 0.1343, weighted_loss: 0.8433, label: 2, bag_size: 1973
batch 1400, loss: 5.0245, instance_loss: 0.2610, weighted_loss: 3.5954, label: 8, bag_size: 380
batch 1500, loss: 0.3857, instance_loss: 0.0852, weighted_loss: 0.2955, label: 5, bag_size: 645
batch 1600, loss: 3.1083, instance_loss: 0.2364, weighted_loss: 2.2467, label: 3, bag_size: 1223
batch 1700, loss: 2.6024, instance_loss: 0.1934, weighted_loss: 1.8797, label: 6, bag_size: 416
batch 1800, loss: 0.4358, instance_loss: 0.0952, weighted_loss: 0.3336, label: 5, bag_size: 206
batch 1900, loss: 1.9892, instance_loss: 0.1865, weighted_loss: 1.4484, label: 2, bag_size: 1124
batch 2000, loss: 2.6143, instance_loss: 0.1775, weighted_loss: 1.8833, label: 2, bag_size: 328
batch 2100, loss: 4.9910, instance_loss: 0.2361, weighted_loss: 3.5645, label: 7, bag_size: 716

Instance Classifier Stats
class 0 clustering acc 0.9998425499231951: correct 260359/260400
class 1 clustering acc 0.010080645161290322: correct 175/17360

Epoch: 17, train_loss: 2.3211, train_clustering_loss: 0.1681, train_error: 0.5175
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6611253196930946, correct coarse 517/782 
coarse class 2: coarse acc 0.8252069917203312, correct coarse 897/1087 
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6382978723404256, correct fine 330/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8556085918854416, correct fine 717/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3123, coarse auc: 0.7668, fine auc: 0.7528 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0014204545454545455: correct 3/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3571
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1083

Training for coarse_and_fine level...
batch 100, loss: 2.6161, instance_loss: 0.1631, weighted_loss: 1.8802, label: 2, bag_size: 894
batch 200, loss: 2.8997, instance_loss: 0.2059, weighted_loss: 2.0916, label: 4, bag_size: 185
batch 300, loss: 1.8705, instance_loss: 0.1610, weighted_loss: 1.3576, label: 2, bag_size: 179
batch 400, loss: 2.9236, instance_loss: 0.1711, weighted_loss: 2.0979, label: 2, bag_size: 217
batch 500, loss: 0.6723, instance_loss: 0.1395, weighted_loss: 0.5125, label: 2, bag_size: 939
batch 600, loss: 1.6744, instance_loss: 0.1322, weighted_loss: 1.2118, label: 2, bag_size: 955
batch 700, loss: 3.9669, instance_loss: 0.2336, weighted_loss: 2.8469, label: 8, bag_size: 486
batch 800, loss: 0.7488, instance_loss: 0.1329, weighted_loss: 0.5640, label: 2, bag_size: 988
batch 900, loss: 3.6756, instance_loss: 0.1802, weighted_loss: 2.6270, label: 5, bag_size: 109
batch 1000, loss: 0.5599, instance_loss: 0.0718, weighted_loss: 0.4134, label: 5, bag_size: 468
batch 1100, loss: 0.2465, instance_loss: 0.0724, weighted_loss: 0.1943, label: 5, bag_size: 874
batch 1200, loss: 0.9136, instance_loss: 0.1334, weighted_loss: 0.6795, label: 2, bag_size: 1523
batch 1300, loss: 3.0521, instance_loss: 0.2154, weighted_loss: 2.2011, label: 6, bag_size: 861
batch 1400, loss: 3.7565, instance_loss: 0.1795, weighted_loss: 2.6834, label: 5, bag_size: 608
batch 1500, loss: 0.2876, instance_loss: 0.0896, weighted_loss: 0.2282, label: 5, bag_size: 349
batch 1600, loss: 2.6232, instance_loss: 0.1933, weighted_loss: 1.8942, label: 2, bag_size: 456
batch 1700, loss: 1.9755, instance_loss: 0.2258, weighted_loss: 1.4506, label: 6, bag_size: 474
batch 1800, loss: 0.6741, instance_loss: 0.1298, weighted_loss: 0.5108, label: 2, bag_size: 2220
batch 1900, loss: 0.3579, instance_loss: 0.0797, weighted_loss: 0.2745, label: 5, bag_size: 587
batch 2000, loss: 2.0460, instance_loss: 0.2251, weighted_loss: 1.4997, label: 6, bag_size: 787
batch 2100, loss: 0.2047, instance_loss: 0.0811, weighted_loss: 0.1676, label: 5, bag_size: 543

Instance Classifier Stats
class 0 clustering acc 0.9997887864823348: correct 260345/260400
class 1 clustering acc 0.013306451612903225: correct 231/17360

Epoch: 18, train_loss: 2.3066, train_clustering_loss: 0.1673, train_error: 0.5152
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.8334866605335787, correct coarse 906/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6460348162475822, correct fine 334/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8568019093078759, correct fine 718/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3009, coarse auc: 0.7696, fine auc: 0.7575 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.003787878787878788: correct 8/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3554
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1091

Training for coarse_and_fine level...
batch 100, loss: 3.0735, instance_loss: 0.2218, weighted_loss: 2.2180, label: 4, bag_size: 160
batch 200, loss: 2.6555, instance_loss: 0.2358, weighted_loss: 1.9296, label: 6, bag_size: 541
batch 300, loss: 4.2661, instance_loss: 0.2783, weighted_loss: 3.0697, label: 4, bag_size: 264
batch 400, loss: 0.8160, instance_loss: 0.0853, weighted_loss: 0.5968, label: 5, bag_size: 732
batch 500, loss: 0.4191, instance_loss: 0.0882, weighted_loss: 0.3198, label: 5, bag_size: 640
batch 600, loss: 2.6162, instance_loss: 0.2022, weighted_loss: 1.8920, label: 6, bag_size: 1865
batch 700, loss: 4.6556, instance_loss: 0.2261, weighted_loss: 3.3268, label: 8, bag_size: 333
batch 800, loss: 2.7405, instance_loss: 0.2028, weighted_loss: 1.9792, label: 3, bag_size: 1150
batch 900, loss: 2.8555, instance_loss: 0.1706, weighted_loss: 2.0500, label: 2, bag_size: 305
batch 1000, loss: 0.4883, instance_loss: 0.0677, weighted_loss: 0.3621, label: 5, bag_size: 1246
batch 1100, loss: 2.2983, instance_loss: 0.2117, weighted_loss: 1.6723, label: 4, bag_size: 1867
batch 1200, loss: 0.3408, instance_loss: 0.0792, weighted_loss: 0.2623, label: 5, bag_size: 1157
batch 1300, loss: 4.1129, instance_loss: 0.2443, weighted_loss: 2.9523, label: 7, bag_size: 478
batch 1400, loss: 0.7701, instance_loss: 0.1453, weighted_loss: 0.5827, label: 2, bag_size: 185
batch 1500, loss: 3.3737, instance_loss: 0.2185, weighted_loss: 2.4271, label: 8, bag_size: 209
batch 1600, loss: 3.7950, instance_loss: 0.2494, weighted_loss: 2.7313, label: 8, bag_size: 371
batch 1700, loss: 2.9607, instance_loss: 0.1849, weighted_loss: 2.1280, label: 5, bag_size: 404
batch 1800, loss: 1.1779, instance_loss: 0.1132, weighted_loss: 0.8585, label: 5, bag_size: 473
batch 1900, loss: 0.6800, instance_loss: 0.1379, weighted_loss: 0.5174, label: 2, bag_size: 379
batch 2000, loss: 2.9138, instance_loss: 0.2110, weighted_loss: 2.1030, label: 6, bag_size: 266
batch 2100, loss: 2.9702, instance_loss: 0.1669, weighted_loss: 2.1292, label: 5, bag_size: 478

Instance Classifier Stats
class 0 clustering acc 0.9997465437788018: correct 260334/260400
class 1 clustering acc 0.022004608294930877: correct 382/17360

Epoch: 19, train_loss: 2.2924, train_clustering_loss: 0.1664, train_error: 0.5166
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6432225063938619, correct coarse 503/782 
coarse class 2: coarse acc 0.8371665133394665, correct coarse 910/1087 
coarse class 3: coarse acc 0.0311284046692607, correct coarse 8/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.632495164410058, correct fine 327/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8615751789976134, correct fine 722/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2904, coarse auc: 0.7705, fine auc: 0.7626 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.006628787878787879: correct 14/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3577
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1080

Training for coarse_and_fine level...
batch 100, loss: 0.9466, instance_loss: 0.1351, weighted_loss: 0.7032, label: 2, bag_size: 496
batch 200, loss: 1.1162, instance_loss: 0.1121, weighted_loss: 0.8150, label: 5, bag_size: 296
batch 300, loss: 0.1869, instance_loss: 0.0662, weighted_loss: 0.1507, label: 5, bag_size: 485
batch 400, loss: 1.4749, instance_loss: 0.1243, weighted_loss: 1.0697, label: 5, bag_size: 237
batch 500, loss: 0.1768, instance_loss: 0.0613, weighted_loss: 0.1422, label: 5, bag_size: 280
batch 600, loss: 1.1596, instance_loss: 0.1293, weighted_loss: 0.8505, label: 2, bag_size: 1727
batch 700, loss: 1.2784, instance_loss: 0.1430, weighted_loss: 0.9378, label: 2, bag_size: 1211
batch 800, loss: 0.8790, instance_loss: 0.0817, weighted_loss: 0.6398, label: 5, bag_size: 1032
batch 900, loss: 1.5788, instance_loss: 0.1142, weighted_loss: 1.1394, label: 5, bag_size: 729
batch 1000, loss: 3.7968, instance_loss: 0.2081, weighted_loss: 2.7202, label: 2, bag_size: 666
batch 1100, loss: 3.1632, instance_loss: 0.1900, weighted_loss: 2.2712, label: 6, bag_size: 169
batch 1200, loss: 2.4158, instance_loss: 0.2153, weighted_loss: 1.7556, label: 3, bag_size: 589
batch 1300, loss: 1.9643, instance_loss: 0.2163, weighted_loss: 1.4399, label: 6, bag_size: 474
batch 1400, loss: 0.5725, instance_loss: 0.1477, weighted_loss: 0.4451, label: 2, bag_size: 1561
batch 1500, loss: 0.3241, instance_loss: 0.0705, weighted_loss: 0.2481, label: 5, bag_size: 1140
batch 1600, loss: 0.1705, instance_loss: 0.0722, weighted_loss: 0.1410, label: 5, bag_size: 691
batch 1700, loss: 0.4432, instance_loss: 0.0794, weighted_loss: 0.3341, label: 5, bag_size: 364
batch 1800, loss: 3.3796, instance_loss: 0.1965, weighted_loss: 2.4247, label: 2, bag_size: 250
batch 1900, loss: 3.2022, instance_loss: 0.1912, weighted_loss: 2.2989, label: 6, bag_size: 519
batch 2000, loss: 6.6527, instance_loss: 0.3103, weighted_loss: 4.7500, label: 10, bag_size: 372
batch 2100, loss: 0.2509, instance_loss: 0.0857, weighted_loss: 0.2014, label: 5, bag_size: 1044

Instance Classifier Stats
class 0 clustering acc 0.9996274961597542: correct 260303/260400
class 1 clustering acc 0.027361751152073732: correct 475/17360

Epoch: 20, train_loss: 2.2803, train_clustering_loss: 0.1656, train_error: 0.5111
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.8417663293468262, correct coarse 915/1087 
coarse class 3: coarse acc 0.03501945525291829, correct coarse 9/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6382978723404256, correct fine 330/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8711217183770883, correct fine 730/838 
fine class 6: fine acc 0.004016064257028112, correct fine 1/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2816, coarse auc: 0.7717, fine auc: 0.7661 
class 0 clustering acc 0.9999684343434343: correct 31679/31680 
class 1 clustering acc 0.013731060606060606: correct 29/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3592
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1091

Training for coarse_and_fine level...
batch 100, loss: 0.9805, instance_loss: 0.0910, weighted_loss: 0.7136, label: 5, bag_size: 253
batch 200, loss: 0.1820, instance_loss: 0.0629, weighted_loss: 0.1463, label: 5, bag_size: 432
batch 300, loss: 1.1803, instance_loss: 0.1293, weighted_loss: 0.8650, label: 2, bag_size: 666
batch 400, loss: 2.2516, instance_loss: 0.2232, weighted_loss: 1.6430, label: 3, bag_size: 773
batch 500, loss: 6.7628, instance_loss: 0.2861, weighted_loss: 4.8198, label: 8, bag_size: 435
batch 600, loss: 0.3507, instance_loss: 0.0858, weighted_loss: 0.2712, label: 5, bag_size: 992
batch 700, loss: 2.2676, instance_loss: 0.1516, weighted_loss: 1.6328, label: 5, bag_size: 394
batch 800, loss: 0.4825, instance_loss: 0.1191, weighted_loss: 0.3735, label: 2, bag_size: 1353
batch 900, loss: 1.2957, instance_loss: 0.1013, weighted_loss: 0.9374, label: 5, bag_size: 148
batch 1000, loss: 1.0343, instance_loss: 0.1045, weighted_loss: 0.7553, label: 5, bag_size: 333
batch 1100, loss: 1.4547, instance_loss: 0.1214, weighted_loss: 1.0547, label: 5, bag_size: 202
batch 1200, loss: 1.7165, instance_loss: 0.2248, weighted_loss: 1.2690, label: 6, bag_size: 555
batch 1300, loss: 0.3829, instance_loss: 0.0887, weighted_loss: 0.2946, label: 5, bag_size: 442
batch 1400, loss: 2.6250, instance_loss: 0.1513, weighted_loss: 1.8829, label: 2, bag_size: 894
batch 1500, loss: 3.9742, instance_loss: 0.2252, weighted_loss: 2.8495, label: 3, bag_size: 1666
batch 1600, loss: 0.3383, instance_loss: 0.0670, weighted_loss: 0.2569, label: 5, bag_size: 396
batch 1700, loss: 0.3855, instance_loss: 0.0863, weighted_loss: 0.2958, label: 5, bag_size: 360
batch 1800, loss: 2.1849, instance_loss: 0.1721, weighted_loss: 1.5811, label: 5, bag_size: 315
batch 1900, loss: 0.2781, instance_loss: 0.0663, weighted_loss: 0.2146, label: 5, bag_size: 228
batch 2000, loss: 2.5964, instance_loss: 0.1709, weighted_loss: 1.8687, label: 2, bag_size: 301
batch 2100, loss: 1.4246, instance_loss: 0.1340, weighted_loss: 1.0374, label: 2, bag_size: 365

Instance Classifier Stats
class 0 clustering acc 0.9994854070660523: correct 260266/260400
class 1 clustering acc 0.0363479262672811: correct 631/17360

Epoch: 21, train_loss: 2.2700, train_clustering_loss: 0.1648, train_error: 0.5111
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6329923273657289, correct coarse 495/782 
coarse class 2: coarse acc 0.8472861085556578, correct coarse 921/1087 
coarse class 3: coarse acc 0.03501945525291829, correct coarse 9/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6305609284332688, correct fine 326/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8747016706443914, correct fine 733/838 
fine class 6: fine acc 0.008032128514056224, correct fine 2/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2734, coarse auc: 0.7728, fine auc: 0.7719 
class 0 clustering acc 0.9999684343434343: correct 31679/31680 
class 1 clustering acc 0.017045454545454544: correct 36/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3558
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1091

Training for coarse_and_fine level...
batch 100, loss: 0.7389, instance_loss: 0.0805, weighted_loss: 0.5414, label: 5, bag_size: 732
batch 200, loss: 0.8622, instance_loss: 0.1441, weighted_loss: 0.6468, label: 2, bag_size: 680
batch 300, loss: 2.3835, instance_loss: 0.1563, weighted_loss: 1.7153, label: 2, bag_size: 531
batch 400, loss: 4.2503, instance_loss: 0.2268, weighted_loss: 3.0432, label: 7, bag_size: 748
batch 500, loss: 1.1256, instance_loss: 0.0942, weighted_loss: 0.8162, label: 5, bag_size: 718
batch 600, loss: 0.2996, instance_loss: 0.0555, weighted_loss: 0.2264, label: 5, bag_size: 456
batch 700, loss: 3.7575, instance_loss: 0.1969, weighted_loss: 2.6893, label: 2, bag_size: 2625
batch 800, loss: 3.6371, instance_loss: 0.2251, weighted_loss: 2.6135, label: 4, bag_size: 304
batch 900, loss: 2.1819, instance_loss: 0.2227, weighted_loss: 1.5941, label: 6, bag_size: 434
batch 1000, loss: 0.4330, instance_loss: 0.0948, weighted_loss: 0.3315, label: 5, bag_size: 217
batch 1100, loss: 1.2878, instance_loss: 0.1142, weighted_loss: 0.9357, label: 5, bag_size: 217
batch 1200, loss: 1.6911, instance_loss: 0.1241, weighted_loss: 1.2210, label: 5, bag_size: 1145
batch 1300, loss: 1.0463, instance_loss: 0.1548, weighted_loss: 0.7788, label: 2, bag_size: 129
batch 1400, loss: 0.5017, instance_loss: 0.0916, weighted_loss: 0.3787, label: 5, bag_size: 335
batch 1500, loss: 0.4115, instance_loss: 0.0868, weighted_loss: 0.3141, label: 5, bag_size: 329
batch 1600, loss: 1.8389, instance_loss: 0.2303, weighted_loss: 1.3563, label: 6, bag_size: 351
batch 1700, loss: 2.0864, instance_loss: 0.2098, weighted_loss: 1.5235, label: 3, bag_size: 2170
batch 1800, loss: 2.6463, instance_loss: 0.2149, weighted_loss: 1.9169, label: 3, bag_size: 1477
batch 1900, loss: 1.8589, instance_loss: 0.1504, weighted_loss: 1.3464, label: 2, bag_size: 298
batch 2000, loss: 3.0563, instance_loss: 0.2105, weighted_loss: 2.2026, label: 6, bag_size: 1836
batch 2100, loss: 4.2255, instance_loss: 0.2292, weighted_loss: 3.0266, label: 7, bag_size: 438

Instance Classifier Stats
class 0 clustering acc 0.9994393241167435: correct 260254/260400
class 1 clustering acc 0.046025345622119816: correct 799/17360

Epoch: 22, train_loss: 2.2582, train_clustering_loss: 0.1644, train_error: 0.5101
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8482060717571297, correct coarse 922/1087 
coarse class 3: coarse acc 0.038910505836575876, correct coarse 10/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6286266924564797, correct fine 325/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8747016706443914, correct fine 733/838 
fine class 6: fine acc 0.01606425702811245, correct fine 4/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2657, coarse auc: 0.7750, fine auc: 0.7752 
class 0 clustering acc 0.9998421717171717: correct 31675/31680 
class 1 clustering acc 0.029356060606060608: correct 62/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3586
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1092

Training for coarse_and_fine level...
batch 100, loss: 1.4424, instance_loss: 0.1275, weighted_loss: 1.0479, label: 5, bag_size: 353
batch 200, loss: 0.1437, instance_loss: 0.0597, weighted_loss: 0.1185, label: 5, bag_size: 537
batch 300, loss: 6.3333, instance_loss: 0.2903, weighted_loss: 4.5204, label: 9, bag_size: 862
batch 400, loss: 3.6677, instance_loss: 0.2394, weighted_loss: 2.6392, label: 4, bag_size: 1030
batch 500, loss: 1.2344, instance_loss: 0.1053, weighted_loss: 0.8957, label: 5, bag_size: 655
batch 600, loss: 1.2166, instance_loss: 0.1217, weighted_loss: 0.8881, label: 2, bag_size: 975
batch 700, loss: 2.7584, instance_loss: 0.2026, weighted_loss: 1.9917, label: 6, bag_size: 283
batch 800, loss: 0.2417, instance_loss: 0.0723, weighted_loss: 0.1909, label: 5, bag_size: 305
batch 900, loss: 0.4391, instance_loss: 0.1153, weighted_loss: 0.3420, label: 2, bag_size: 1189
batch 1000, loss: 4.1602, instance_loss: 0.2378, weighted_loss: 2.9835, label: 8, bag_size: 149
batch 1100, loss: 1.4104, instance_loss: 0.1231, weighted_loss: 1.0242, label: 5, bag_size: 193
batch 1200, loss: 4.6573, instance_loss: 0.2670, weighted_loss: 3.3402, label: 3, bag_size: 234
batch 1300, loss: 1.9882, instance_loss: 0.2378, weighted_loss: 1.4631, label: 6, bag_size: 2272
batch 1400, loss: 0.9534, instance_loss: 0.1200, weighted_loss: 0.7034, label: 2, bag_size: 1084
batch 1500, loss: 3.6974, instance_loss: 0.2361, weighted_loss: 2.6590, label: 3, bag_size: 398
batch 1600, loss: 2.8512, instance_loss: 0.2222, weighted_loss: 2.0625, label: 8, bag_size: 415
batch 1700, loss: 3.5687, instance_loss: 0.2188, weighted_loss: 2.5637, label: 8, bag_size: 264
batch 1800, loss: 1.5830, instance_loss: 0.1820, weighted_loss: 1.1627, label: 4, bag_size: 1424
batch 1900, loss: 0.2461, instance_loss: 0.0699, weighted_loss: 0.1932, label: 5, bag_size: 596
batch 2000, loss: 6.8598, instance_loss: 0.2429, weighted_loss: 4.8748, label: 1, bag_size: 352
batch 2100, loss: 0.4763, instance_loss: 0.0703, weighted_loss: 0.3545, label: 5, bag_size: 618

Instance Classifier Stats
class 0 clustering acc 0.9993317972350231: correct 260226/260400
class 1 clustering acc 0.049366359447004605: correct 857/17360

Epoch: 23, train_loss: 2.2486, train_clustering_loss: 0.1638, train_error: 0.5060
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8509659613615456, correct coarse 925/1087 
coarse class 3: coarse acc 0.05058365758754864, correct coarse 13/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.632495164410058, correct fine 327/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.017391304347826087, correct fine 2/115 
fine class 5: fine acc 0.8747016706443914, correct fine 733/838 
fine class 6: fine acc 0.0321285140562249, correct fine 8/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2584, coarse auc: 0.7759, fine auc: 0.7760 
class 0 clustering acc 0.9997474747474747: correct 31672/31680 
class 1 clustering acc 0.043087121212121215: correct 91/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3580
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1083

Training for coarse_and_fine level...
batch 100, loss: 3.7231, instance_loss: 0.2268, weighted_loss: 2.6742, label: 8, bag_size: 486
batch 200, loss: 4.5408, instance_loss: 0.2696, weighted_loss: 3.2595, label: 3, bag_size: 1168
batch 300, loss: 0.1040, instance_loss: 0.0569, weighted_loss: 0.0899, label: 5, bag_size: 448
batch 400, loss: 0.3441, instance_loss: 0.0696, weighted_loss: 0.2618, label: 5, bag_size: 357
batch 500, loss: 0.4633, instance_loss: 0.1034, weighted_loss: 0.3553, label: 2, bag_size: 1353
batch 600, loss: 3.2570, instance_loss: 0.2099, weighted_loss: 2.3429, label: 4, bag_size: 344
batch 700, loss: 0.6380, instance_loss: 0.1106, weighted_loss: 0.4798, label: 2, bag_size: 2213
batch 800, loss: 1.2164, instance_loss: 0.1453, weighted_loss: 0.8951, label: 2, bag_size: 936
batch 900, loss: 2.6455, instance_loss: 0.2001, weighted_loss: 1.9118, label: 6, bag_size: 416
batch 1000, loss: 4.0993, instance_loss: 0.1931, weighted_loss: 2.9274, label: 5, bag_size: 2146
batch 1100, loss: 3.2062, instance_loss: 0.2139, weighted_loss: 2.3085, label: 6, bag_size: 201
batch 1200, loss: 2.1315, instance_loss: 0.2074, weighted_loss: 1.5543, label: 3, bag_size: 567
batch 1300, loss: 0.4670, instance_loss: 0.0673, weighted_loss: 0.3471, label: 5, bag_size: 691
batch 1400, loss: 2.6614, instance_loss: 0.1813, weighted_loss: 1.9173, label: 5, bag_size: 40
batch 1500, loss: 2.8234, instance_loss: 0.2137, weighted_loss: 2.0405, label: 6, bag_size: 3471
batch 1600, loss: 2.7564, instance_loss: 0.1957, weighted_loss: 1.9882, label: 6, bag_size: 566
batch 1700, loss: 1.4256, instance_loss: 0.1085, weighted_loss: 1.0304, label: 5, bag_size: 1422
batch 1800, loss: 0.4619, instance_loss: 0.0961, weighted_loss: 0.3522, label: 5, bag_size: 1058
batch 1900, loss: 1.6587, instance_loss: 0.1339, weighted_loss: 1.2012, label: 5, bag_size: 280
batch 2000, loss: 1.8681, instance_loss: 0.2212, weighted_loss: 1.3740, label: 6, bag_size: 2443
batch 2100, loss: 2.7675, instance_loss: 0.1638, weighted_loss: 1.9864, label: 2, bag_size: 334

Instance Classifier Stats
class 0 clustering acc 0.9992549923195084: correct 260206/260400
class 1 clustering acc 0.058640552995391705: correct 1018/17360

Epoch: 24, train_loss: 2.2398, train_clustering_loss: 0.1637, train_error: 0.5037
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.8610855565777369, correct coarse 936/1087 
coarse class 3: coarse acc 0.058365758754863814, correct coarse 15/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6170212765957447, correct fine 319/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.02608695652173913, correct fine 3/115 
fine class 5: fine acc 0.8890214797136038, correct fine 745/838 
fine class 6: fine acc 0.028112449799196786, correct fine 7/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2522, coarse auc: 0.7767, fine auc: 0.7787 
class 0 clustering acc 0.9996843434343434: correct 31670/31680 
class 1 clustering acc 0.05397727272727273: correct 114/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3598
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1089

Training for coarse_and_fine level...
batch 100, loss: 0.9551, instance_loss: 0.0857, weighted_loss: 0.6943, label: 5, bag_size: 733
batch 200, loss: 2.0360, instance_loss: 0.1765, weighted_loss: 1.4781, label: 2, bag_size: 1124
batch 300, loss: 2.8703, instance_loss: 0.1797, weighted_loss: 2.0631, label: 2, bag_size: 592
batch 400, loss: 0.4838, instance_loss: 0.1174, weighted_loss: 0.3739, label: 2, bag_size: 224
batch 500, loss: 2.3029, instance_loss: 0.1402, weighted_loss: 1.6541, label: 5, bag_size: 347
batch 600, loss: 0.9718, instance_loss: 0.1179, weighted_loss: 0.7156, label: 2, bag_size: 1423
batch 700, loss: 2.8355, instance_loss: 0.2002, weighted_loss: 2.0449, label: 2, bag_size: 738
batch 800, loss: 1.8576, instance_loss: 0.1242, weighted_loss: 1.3376, label: 5, bag_size: 890
batch 900, loss: 7.0957, instance_loss: 0.2639, weighted_loss: 5.0461, label: 1, bag_size: 119
batch 1000, loss: 5.6289, instance_loss: 0.3037, weighted_loss: 4.0313, label: 4, bag_size: 424
batch 1100, loss: 2.0577, instance_loss: 0.1553, weighted_loss: 1.4870, label: 2, bag_size: 818
batch 1200, loss: 2.6171, instance_loss: 0.1617, weighted_loss: 1.8804, label: 5, bag_size: 770
batch 1300, loss: 2.1800, instance_loss: 0.1567, weighted_loss: 1.5730, label: 5, bag_size: 596
batch 1400, loss: 2.3118, instance_loss: 0.1475, weighted_loss: 1.6625, label: 2, bag_size: 646
batch 1500, loss: 6.3683, instance_loss: 0.2949, weighted_loss: 4.5462, label: 7, bag_size: 139
batch 1600, loss: 0.9491, instance_loss: 0.0991, weighted_loss: 0.6941, label: 5, bag_size: 545
batch 1700, loss: 1.8688, instance_loss: 0.2370, weighted_loss: 1.3793, label: 6, bag_size: 1096
batch 1800, loss: 2.8080, instance_loss: 0.1703, weighted_loss: 2.0167, label: 2, bag_size: 334
batch 1900, loss: 2.3382, instance_loss: 0.1999, weighted_loss: 1.6967, label: 2, bag_size: 762
batch 2000, loss: 4.8840, instance_loss: 0.2603, weighted_loss: 3.4969, label: 8, bag_size: 567
batch 2100, loss: 0.2310, instance_loss: 0.0586, weighted_loss: 0.1793, label: 5, bag_size: 1157

Instance Classifier Stats
class 0 clustering acc 0.9990284178187404: correct 260147/260400
class 1 clustering acc 0.0646889400921659: correct 1123/17360

Epoch: 25, train_loss: 2.2305, train_clustering_loss: 0.1632, train_error: 0.5028
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.8574057037718491, correct coarse 932/1087 
coarse class 3: coarse acc 0.0622568093385214, correct coarse 16/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6189555125725339, correct fine 320/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.034782608695652174, correct fine 4/115 
fine class 5: fine acc 0.883054892601432, correct fine 740/838 
fine class 6: fine acc 0.05622489959839357, correct fine 14/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2463, coarse auc: 0.7789, fine auc: 0.7824 
class 0 clustering acc 0.9996212121212121: correct 31668/31680 
class 1 clustering acc 0.06202651515151515: correct 131/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3755
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1156

Training for coarse_and_fine level...
batch 100, loss: 2.5684, instance_loss: 0.2119, weighted_loss: 1.8614, label: 8, bag_size: 120
batch 200, loss: 0.3387, instance_loss: 0.0753, weighted_loss: 0.2597, label: 5, bag_size: 574
batch 300, loss: 2.3821, instance_loss: 0.2142, weighted_loss: 1.7317, label: 3, bag_size: 2069
batch 400, loss: 0.2763, instance_loss: 0.0704, weighted_loss: 0.2145, label: 5, bag_size: 834
batch 500, loss: 2.9800, instance_loss: 0.1889, weighted_loss: 2.1427, label: 5, bag_size: 112
batch 600, loss: 0.9232, instance_loss: 0.1128, weighted_loss: 0.6800, label: 5, bag_size: 308
batch 700, loss: 3.2547, instance_loss: 0.1885, weighted_loss: 2.3349, label: 2, bag_size: 165
batch 800, loss: 1.7347, instance_loss: 0.1919, weighted_loss: 1.2719, label: 3, bag_size: 554
batch 900, loss: 3.3569, instance_loss: 0.2098, weighted_loss: 2.4128, label: 2, bag_size: 371
batch 1000, loss: 0.6861, instance_loss: 0.1207, weighted_loss: 0.5165, label: 2, bag_size: 784
batch 1100, loss: 3.5074, instance_loss: 0.2070, weighted_loss: 2.5173, label: 8, bag_size: 478
batch 1200, loss: 1.6282, instance_loss: 0.1308, weighted_loss: 1.1790, label: 2, bag_size: 766
batch 1300, loss: 2.4666, instance_loss: 0.1771, weighted_loss: 1.7797, label: 5, bag_size: 741
batch 1400, loss: 1.1022, instance_loss: 0.1113, weighted_loss: 0.8049, label: 2, bag_size: 2159
batch 1500, loss: 1.6334, instance_loss: 0.0871, weighted_loss: 1.1695, label: 5, bag_size: 396
batch 1600, loss: 0.2382, instance_loss: 0.0663, weighted_loss: 0.1866, label: 5, bag_size: 387
batch 1700, loss: 2.0619, instance_loss: 0.1561, weighted_loss: 1.4902, label: 5, bag_size: 310
batch 1800, loss: 1.4759, instance_loss: 0.1079, weighted_loss: 1.0655, label: 5, bag_size: 259
batch 1900, loss: 2.1881, instance_loss: 0.2304, weighted_loss: 1.6008, label: 3, bag_size: 788
batch 2000, loss: 0.8555, instance_loss: 0.0847, weighted_loss: 0.6243, label: 5, bag_size: 860
batch 2100, loss: 1.8182, instance_loss: 0.1243, weighted_loss: 1.3101, label: 5, bag_size: 113

Instance Classifier Stats
class 0 clustering acc 0.9990399385560675: correct 260150/260400
class 1 clustering acc 0.07298387096774193: correct 1267/17360

Epoch: 26, train_loss: 2.2236, train_clustering_loss: 0.1627, train_error: 0.5000
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6240409207161125, correct coarse 488/782 
coarse class 2: coarse acc 0.8647654093836247, correct coarse 940/1087 
coarse class 3: coarse acc 0.05058365758754864, correct coarse 13/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6092843326885881, correct fine 315/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.06086956521739131, correct fine 7/115 
fine class 5: fine acc 0.8890214797136038, correct fine 745/838 
fine class 6: fine acc 0.060240963855421686, correct fine 15/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2424, coarse auc: 0.7801, fine auc: 0.7835 
class 0 clustering acc 0.9995265151515151: correct 31665/31680 
class 1 clustering acc 0.07007575757575757: correct 148/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.671875, correct fine 43/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3760
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1165

Training for coarse_and_fine level...
batch 100, loss: 0.5826, instance_loss: 0.1294, weighted_loss: 0.4466, label: 2, bag_size: 334
batch 200, loss: 0.8808, instance_loss: 0.1187, weighted_loss: 0.6522, label: 2, bag_size: 192
batch 300, loss: 0.6359, instance_loss: 0.0704, weighted_loss: 0.4662, label: 5, bag_size: 667
batch 400, loss: 5.2770, instance_loss: 0.2799, weighted_loss: 3.7779, label: 10, bag_size: 416
batch 500, loss: 2.6922, instance_loss: 0.2025, weighted_loss: 1.9453, label: 4, bag_size: 2056
batch 600, loss: 0.8931, instance_loss: 0.1285, weighted_loss: 0.6637, label: 2, bag_size: 313
batch 700, loss: 2.2740, instance_loss: 0.2105, weighted_loss: 1.6550, label: 4, bag_size: 185
batch 800, loss: 0.2277, instance_loss: 0.0592, weighted_loss: 0.1772, label: 5, bag_size: 202
batch 900, loss: 1.6547, instance_loss: 0.2193, weighted_loss: 1.2241, label: 6, bag_size: 239
batch 1000, loss: 6.5403, instance_loss: 0.2456, weighted_loss: 4.6519, label: 1, bag_size: 149
batch 1100, loss: 1.7256, instance_loss: 0.1363, weighted_loss: 1.2488, label: 5, bag_size: 315
batch 1200, loss: 3.8556, instance_loss: 0.2479, weighted_loss: 2.7733, label: 7, bag_size: 681
batch 1300, loss: 2.0157, instance_loss: 0.1612, weighted_loss: 1.4594, label: 5, bag_size: 129
batch 1400, loss: 0.4426, instance_loss: 0.0737, weighted_loss: 0.3319, label: 5, bag_size: 429
batch 1500, loss: 1.6559, instance_loss: 0.1889, weighted_loss: 1.2158, label: 4, bag_size: 1673
batch 1600, loss: 0.7400, instance_loss: 0.0660, weighted_loss: 0.5378, label: 5, bag_size: 298
batch 1700, loss: 0.4291, instance_loss: 0.0936, weighted_loss: 0.3285, label: 2, bag_size: 1067
batch 1800, loss: 1.2537, instance_loss: 0.1227, weighted_loss: 0.9144, label: 2, bag_size: 2830
batch 1900, loss: 2.9142, instance_loss: 0.2114, weighted_loss: 2.1034, label: 8, bag_size: 128
batch 2000, loss: 3.3259, instance_loss: 0.1808, weighted_loss: 2.3824, label: 5, bag_size: 237
batch 2100, loss: 2.2157, instance_loss: 0.2147, weighted_loss: 1.6154, label: 3, bag_size: 1336

Instance Classifier Stats
class 0 clustering acc 0.9989132104454685: correct 260117/260400
class 1 clustering acc 0.08116359447004608: correct 1409/17360

Epoch: 27, train_loss: 2.2165, train_clustering_loss: 0.1623, train_error: 0.4972
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8620055197792088, correct coarse 937/1087 
coarse class 3: coarse acc 0.05058365758754864, correct coarse 13/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6131528046421664, correct fine 317/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0782608695652174, correct fine 9/115 
fine class 5: fine acc 0.8937947494033412, correct fine 749/838 
fine class 6: fine acc 0.05220883534136546, correct fine 13/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2373, coarse auc: 0.7828, fine auc: 0.7837 
class 0 clustering acc 0.9994633838383838: correct 31663/31680 
class 1 clustering acc 0.07623106060606061: correct 161/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.671875, correct fine 43/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3779
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1165

Training for coarse_and_fine level...
batch 100, loss: 3.2982, instance_loss: 0.2263, weighted_loss: 2.3766, label: 8, bag_size: 378
batch 200, loss: 0.6081, instance_loss: 0.0919, weighted_loss: 0.4532, label: 5, bag_size: 600
batch 300, loss: 1.3705, instance_loss: 0.1110, weighted_loss: 0.9927, label: 5, bag_size: 216
batch 400, loss: 0.7141, instance_loss: 0.0800, weighted_loss: 0.5239, label: 5, bag_size: 365
batch 500, loss: 4.1625, instance_loss: 0.2528, weighted_loss: 2.9896, label: 7, bag_size: 441
batch 600, loss: 2.5022, instance_loss: 0.1955, weighted_loss: 1.8102, label: 5, bag_size: 132
batch 700, loss: 2.8116, instance_loss: 0.2170, weighted_loss: 2.0332, label: 2, bag_size: 411
batch 800, loss: 0.3316, instance_loss: 0.0604, weighted_loss: 0.2502, label: 5, bag_size: 217
batch 900, loss: 1.3784, instance_loss: 0.1070, weighted_loss: 0.9970, label: 5, bag_size: 847
batch 1000, loss: 0.9116, instance_loss: 0.1046, weighted_loss: 0.6695, label: 5, bag_size: 148
batch 1100, loss: 2.6128, instance_loss: 0.1640, weighted_loss: 1.8782, label: 5, bag_size: 509
batch 1200, loss: 0.7212, instance_loss: 0.1194, weighted_loss: 0.5407, label: 5, bag_size: 933
batch 1300, loss: 1.2192, instance_loss: 0.1370, weighted_loss: 0.8945, label: 2, bag_size: 343
batch 1400, loss: 5.1487, instance_loss: 0.2558, weighted_loss: 3.6809, label: 1, bag_size: 113
batch 1500, loss: 0.3292, instance_loss: 0.0557, weighted_loss: 0.2472, label: 5, bag_size: 396
batch 1600, loss: 3.2708, instance_loss: 0.2141, weighted_loss: 2.3538, label: 4, bag_size: 121
batch 1700, loss: 1.6941, instance_loss: 0.2403, weighted_loss: 1.2579, label: 6, bag_size: 1072
batch 1800, loss: 2.0775, instance_loss: 0.1312, weighted_loss: 1.4936, label: 5, bag_size: 317
batch 1900, loss: 3.9499, instance_loss: 0.2167, weighted_loss: 2.8299, label: 2, bag_size: 393
batch 2000, loss: 1.3376, instance_loss: 0.1233, weighted_loss: 0.9733, label: 5, bag_size: 880
batch 2100, loss: 2.6846, instance_loss: 0.1658, weighted_loss: 1.9289, label: 2, bag_size: 894

Instance Classifier Stats
class 0 clustering acc 0.9989400921658986: correct 260124/260400
class 1 clustering acc 0.08692396313364055: correct 1509/17360

Epoch: 28, train_loss: 2.2104, train_clustering_loss: 0.1619, train_error: 0.4995
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782 
coarse class 2: coarse acc 0.8620055197792088, correct coarse 937/1087 
coarse class 3: coarse acc 0.054474708171206226, correct coarse 14/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6112185686653772, correct fine 316/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.09565217391304348, correct fine 11/115 
fine class 5: fine acc 0.8890214797136038, correct fine 745/838 
fine class 6: fine acc 0.04819277108433735, correct fine 12/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2322, coarse auc: 0.7834, fine auc: 0.7846 
class 0 clustering acc 0.9994318181818181: correct 31662/31680 
class 1 clustering acc 0.08475378787878787: correct 179/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3782
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1157

Training for coarse_and_fine level...
batch 100, loss: 3.1610, instance_loss: 0.2164, weighted_loss: 2.2776, label: 2, bag_size: 566
batch 200, loss: 0.3423, instance_loss: 0.0758, weighted_loss: 0.2623, label: 5, bag_size: 369
batch 300, loss: 0.3356, instance_loss: 0.0894, weighted_loss: 0.2617, label: 5, bag_size: 400
batch 400, loss: 0.4849, instance_loss: 0.0749, weighted_loss: 0.3619, label: 5, bag_size: 857
batch 500, loss: 0.9011, instance_loss: 0.0976, weighted_loss: 0.6600, label: 5, bag_size: 216
batch 600, loss: 0.4737, instance_loss: 0.0961, weighted_loss: 0.3604, label: 2, bag_size: 2107
batch 700, loss: 0.1835, instance_loss: 0.0507, weighted_loss: 0.1436, label: 5, bag_size: 467
batch 800, loss: 0.1233, instance_loss: 0.0527, weighted_loss: 0.1021, label: 5, bag_size: 397
batch 900, loss: 0.1233, instance_loss: 0.0635, weighted_loss: 0.1053, label: 5, bag_size: 312
batch 1000, loss: 2.0052, instance_loss: 0.1405, weighted_loss: 1.4458, label: 2, bag_size: 785
batch 1100, loss: 0.4328, instance_loss: 0.0861, weighted_loss: 0.3288, label: 5, bag_size: 226
batch 1200, loss: 0.7624, instance_loss: 0.0766, weighted_loss: 0.5566, label: 5, bag_size: 339
batch 1300, loss: 4.5447, instance_loss: 0.2529, weighted_loss: 3.2571, label: 3, bag_size: 188
batch 1400, loss: 5.3795, instance_loss: 0.2786, weighted_loss: 3.8492, label: 3, bag_size: 542
batch 1500, loss: 1.3736, instance_loss: 0.1060, weighted_loss: 0.9933, label: 5, bag_size: 480
batch 1600, loss: 1.8550, instance_loss: 0.2115, weighted_loss: 1.3619, label: 6, bag_size: 333
batch 1700, loss: 0.7355, instance_loss: 0.1040, weighted_loss: 0.5460, label: 2, bag_size: 490
batch 1800, loss: 3.1912, instance_loss: 0.1732, weighted_loss: 2.2858, label: 2, bag_size: 1009
batch 1900, loss: 0.5177, instance_loss: 0.0929, weighted_loss: 0.3902, label: 5, bag_size: 817
batch 2000, loss: 2.9020, instance_loss: 0.2355, weighted_loss: 2.1021, label: 3, bag_size: 1678
batch 2100, loss: 3.8520, instance_loss: 0.2387, weighted_loss: 2.7680, label: 7, bag_size: 489

Instance Classifier Stats
class 0 clustering acc 0.9987596006144394: correct 260077/260400
class 1 clustering acc 0.08847926267281106: correct 1536/17360

Epoch: 29, train_loss: 2.2026, train_clustering_loss: 0.1618, train_error: 0.4945
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6317135549872123, correct coarse 494/782 
coarse class 2: coarse acc 0.8675252989880404, correct coarse 943/1087 
coarse class 3: coarse acc 0.0622568093385214, correct coarse 16/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6092843326885881, correct fine 315/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1391304347826087, correct fine 16/115 
fine class 5: fine acc 0.8926014319809069, correct fine 748/838 
fine class 6: fine acc 0.060240963855421686, correct fine 15/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2277, coarse auc: 0.7841, fine auc: 0.7860 
class 0 clustering acc 0.9993686868686869: correct 31660/31680 
class 1 clustering acc 0.08996212121212122: correct 190/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3779
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1283

Training for coarse_and_fine level...
batch 100, loss: 0.2685, instance_loss: 0.0588, weighted_loss: 0.2056, label: 5, bag_size: 180
batch 200, loss: 2.8128, instance_loss: 0.2133, weighted_loss: 2.0329, label: 8, bag_size: 210
batch 300, loss: 2.7718, instance_loss: 0.1997, weighted_loss: 2.0002, label: 6, bag_size: 387
batch 400, loss: 0.1824, instance_loss: 0.0503, weighted_loss: 0.1428, label: 5, bag_size: 439
batch 500, loss: 1.7973, instance_loss: 0.2112, weighted_loss: 1.3215, label: 6, bag_size: 245
batch 600, loss: 1.3645, instance_loss: 0.1313, weighted_loss: 0.9946, label: 2, bag_size: 536
batch 700, loss: 3.5940, instance_loss: 0.1993, weighted_loss: 2.5756, label: 6, bag_size: 252
batch 800, loss: 1.6089, instance_loss: 0.2160, weighted_loss: 1.1911, label: 4, bag_size: 889
batch 900, loss: 2.5330, instance_loss: 0.2172, weighted_loss: 1.8382, label: 3, bag_size: 1150
batch 1000, loss: 2.4773, instance_loss: 0.2307, weighted_loss: 1.8033, label: 6, bag_size: 337
batch 1100, loss: 3.2404, instance_loss: 0.1891, weighted_loss: 2.3250, label: 6, bag_size: 735
batch 1200, loss: 0.3418, instance_loss: 0.0708, weighted_loss: 0.2605, label: 5, bag_size: 574
batch 1300, loss: 1.7394, instance_loss: 0.1319, weighted_loss: 1.2571, label: 2, bag_size: 298
batch 1400, loss: 1.5612, instance_loss: 0.1410, weighted_loss: 1.1351, label: 5, bag_size: 237
batch 1500, loss: 3.3516, instance_loss: 0.2128, weighted_loss: 2.4099, label: 2, bag_size: 437
batch 1600, loss: 0.7642, instance_loss: 0.1184, weighted_loss: 0.5704, label: 2, bag_size: 2433
batch 1700, loss: 2.0452, instance_loss: 0.1309, weighted_loss: 1.4709, label: 5, bag_size: 421
batch 1800, loss: 0.8392, instance_loss: 0.0818, weighted_loss: 0.6120, label: 5, bag_size: 585
batch 1900, loss: 2.6154, instance_loss: 0.1786, weighted_loss: 1.8843, label: 2, bag_size: 161
batch 2000, loss: 0.2915, instance_loss: 0.0464, weighted_loss: 0.2180, label: 5, bag_size: 1257
batch 2100, loss: 3.1277, instance_loss: 0.1879, weighted_loss: 2.2457, label: 6, bag_size: 146

Instance Classifier Stats
class 0 clustering acc 0.9986866359447004: correct 260058/260400
class 1 clustering acc 0.09164746543778801: correct 1591/17360

Epoch: 30, train_loss: 2.1973, train_clustering_loss: 0.1613, train_error: 0.4935
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.859245630174793, correct coarse 934/1087 
coarse class 3: coarse acc 0.07003891050583658, correct coarse 18/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1565217391304348, correct fine 18/115 
fine class 5: fine acc 0.8902147971360382, correct fine 746/838 
fine class 6: fine acc 0.07630522088353414, correct fine 19/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2224, coarse auc: 0.7851, fine auc: 0.7854 
class 0 clustering acc 0.999179292929293: correct 31654/31680 
class 1 clustering acc 0.10653409090909091: correct 225/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3742
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1263

Training for coarse_and_fine level...
batch 100, loss: 0.1135, instance_loss: 0.0474, weighted_loss: 0.0937, label: 5, bag_size: 331
batch 200, loss: 3.7929, instance_loss: 0.2077, weighted_loss: 2.7173, label: 6, bag_size: 231
batch 300, loss: 2.6746, instance_loss: 0.2438, weighted_loss: 1.9454, label: 6, bag_size: 661
batch 400, loss: 0.2689, instance_loss: 0.0719, weighted_loss: 0.2098, label: 5, bag_size: 713
batch 500, loss: 1.0017, instance_loss: 0.1447, weighted_loss: 0.7446, label: 2, bag_size: 1245
batch 600, loss: 1.8434, instance_loss: 0.1808, weighted_loss: 1.3446, label: 5, bag_size: 275
batch 700, loss: 3.7778, instance_loss: 0.2144, weighted_loss: 2.7088, label: 2, bag_size: 235
batch 800, loss: 2.3049, instance_loss: 0.2203, weighted_loss: 1.6795, label: 6, bag_size: 689
batch 900, loss: 4.4460, instance_loss: 0.2478, weighted_loss: 3.1865, label: 2, bag_size: 559
batch 1000, loss: 3.1985, instance_loss: 0.2192, weighted_loss: 2.3047, label: 7, bag_size: 312
batch 1100, loss: 0.6560, instance_loss: 0.0693, weighted_loss: 0.4800, label: 5, bag_size: 860
batch 1200, loss: 0.6736, instance_loss: 0.1264, weighted_loss: 0.5095, label: 2, bag_size: 958
batch 1300, loss: 1.5531, instance_loss: 0.1030, weighted_loss: 1.1181, label: 5, bag_size: 1135
batch 1400, loss: 6.8407, instance_loss: 0.3391, weighted_loss: 4.8902, label: 10, bag_size: 372
batch 1500, loss: 1.1946, instance_loss: 0.1002, weighted_loss: 0.8662, label: 5, bag_size: 408
batch 1600, loss: 0.3698, instance_loss: 0.0575, weighted_loss: 0.2761, label: 5, bag_size: 661
batch 1700, loss: 0.6185, instance_loss: 0.1269, weighted_loss: 0.4710, label: 2, bag_size: 334
batch 1800, loss: 1.6017, instance_loss: 0.2094, weighted_loss: 1.1840, label: 3, bag_size: 836
batch 1900, loss: 4.9195, instance_loss: 0.3079, weighted_loss: 3.5360, label: 4, bag_size: 593
batch 2000, loss: 2.5333, instance_loss: 0.2197, weighted_loss: 1.8392, label: 3, bag_size: 501
batch 2100, loss: 3.1089, instance_loss: 0.1904, weighted_loss: 2.2334, label: 8, bag_size: 313

Instance Classifier Stats
class 0 clustering acc 0.9985330261136712: correct 260018/260400
class 1 clustering acc 0.1028225806451613: correct 1785/17360

Epoch: 31, train_loss: 2.1926, train_clustering_loss: 0.1612, train_error: 0.4945
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6150895140664961, correct coarse 481/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.05058365758754864, correct coarse 13/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5841392649903289, correct fine 302/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1565217391304348, correct fine 18/115 
fine class 5: fine acc 0.9009546539379475, correct fine 755/838 
fine class 6: fine acc 0.07630522088353414, correct fine 19/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2203, coarse auc: 0.7876, fine auc: 0.7862 
class 0 clustering acc 0.9992739898989899: correct 31657/31680 
class 1 clustering acc 0.10321969696969698: correct 218/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3936
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1264

Training for coarse_and_fine level...
batch 100, loss: 1.4630, instance_loss: 0.1151, weighted_loss: 1.0586, label: 5, bag_size: 202
batch 200, loss: 8.1353, instance_loss: 0.3107, weighted_loss: 5.7879, label: 0, bag_size: 313
batch 300, loss: 3.3173, instance_loss: 0.2056, weighted_loss: 2.3838, label: 2, bag_size: 437
batch 400, loss: 0.0512, instance_loss: 0.0424, weighted_loss: 0.0486, label: 5, bag_size: 421
batch 500, loss: 0.1117, instance_loss: 0.0351, weighted_loss: 0.0887, label: 5, bag_size: 393
batch 600, loss: 3.8359, instance_loss: 0.2138, weighted_loss: 2.7493, label: 8, bag_size: 368
batch 700, loss: 0.1542, instance_loss: 0.0431, weighted_loss: 0.1208, label: 5, bag_size: 554
batch 800, loss: 3.2075, instance_loss: 0.2219, weighted_loss: 2.3118, label: 8, bag_size: 707
batch 900, loss: 3.3843, instance_loss: 0.2204, weighted_loss: 2.4351, label: 8, bag_size: 116
batch 1000, loss: 1.8731, instance_loss: 0.2280, weighted_loss: 1.3796, label: 6, bag_size: 570
batch 1100, loss: 2.2615, instance_loss: 0.1551, weighted_loss: 1.6296, label: 2, bag_size: 49
batch 1200, loss: 2.7471, instance_loss: 0.2029, weighted_loss: 1.9838, label: 2, bag_size: 177
batch 1300, loss: 1.8710, instance_loss: 0.1208, weighted_loss: 1.3459, label: 5, bag_size: 1145
batch 1400, loss: 1.2582, instance_loss: 0.1296, weighted_loss: 0.9196, label: 2, bag_size: 333
batch 1500, loss: 3.3789, instance_loss: 0.2148, weighted_loss: 2.4296, label: 2, bag_size: 562
batch 1600, loss: 0.4148, instance_loss: 0.0646, weighted_loss: 0.3097, label: 5, bag_size: 622
batch 1700, loss: 2.8171, instance_loss: 0.1723, weighted_loss: 2.0237, label: 2, bag_size: 472
batch 1800, loss: 1.2193, instance_loss: 0.2190, weighted_loss: 0.9192, label: 4, bag_size: 919
batch 1900, loss: 3.3208, instance_loss: 0.1921, weighted_loss: 2.3822, label: 2, bag_size: 119
batch 2000, loss: 0.2600, instance_loss: 0.0550, weighted_loss: 0.1985, label: 5, bag_size: 717
batch 2100, loss: 1.4323, instance_loss: 0.0851, weighted_loss: 1.0282, label: 5, bag_size: 588

Instance Classifier Stats
class 0 clustering acc 0.9987058371735791: correct 260063/260400
class 1 clustering acc 0.10097926267281106: correct 1753/17360

Epoch: 32, train_loss: 2.1881, train_clustering_loss: 0.1604, train_error: 0.4922
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8702851885924563, correct coarse 946/1087 
coarse class 3: coarse acc 0.0933852140077821, correct coarse 24/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6112185686653772, correct fine 316/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1565217391304348, correct fine 18/115 
fine class 5: fine acc 0.8890214797136038, correct fine 745/838 
fine class 6: fine acc 0.08433734939759036, correct fine 21/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2156, coarse auc: 0.7881, fine auc: 0.7860 
class 0 clustering acc 0.999179292929293: correct 31654/31680 
class 1 clustering acc 0.11126893939393939: correct 235/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3945
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1250

Training for coarse_and_fine level...
batch 100, loss: 0.7723, instance_loss: 0.1021, weighted_loss: 0.5713, label: 2, bag_size: 795
batch 200, loss: 0.8036, instance_loss: 0.0719, weighted_loss: 0.5841, label: 5, bag_size: 434
batch 300, loss: 0.2212, instance_loss: 0.0500, weighted_loss: 0.1698, label: 5, bag_size: 956
batch 400, loss: 3.3140, instance_loss: 0.1945, weighted_loss: 2.3781, label: 6, bag_size: 106
batch 500, loss: 0.2065, instance_loss: 0.0439, weighted_loss: 0.1577, label: 5, bag_size: 853
batch 600, loss: 1.8144, instance_loss: 0.1316, weighted_loss: 1.3096, label: 5, bag_size: 373
batch 700, loss: 2.5429, instance_loss: 0.1997, weighted_loss: 1.8400, label: 6, bag_size: 396
batch 800, loss: 2.1109, instance_loss: 0.1822, weighted_loss: 1.5323, label: 5, bag_size: 214
batch 900, loss: 1.7883, instance_loss: 0.2181, weighted_loss: 1.3173, label: 3, bag_size: 526
batch 1000, loss: 3.1377, instance_loss: 0.2098, weighted_loss: 2.2593, label: 6, bag_size: 1550
batch 1100, loss: 0.8956, instance_loss: 0.0700, weighted_loss: 0.6479, label: 5, bag_size: 578
batch 1200, loss: 5.5507, instance_loss: 0.2435, weighted_loss: 3.9586, label: 8, bag_size: 419
batch 1300, loss: 3.5509, instance_loss: 0.1583, weighted_loss: 2.5331, label: 5, bag_size: 1830
batch 1400, loss: 0.2132, instance_loss: 0.0578, weighted_loss: 0.1666, label: 5, bag_size: 180
batch 1500, loss: 2.0473, instance_loss: 0.2034, weighted_loss: 1.4942, label: 4, bag_size: 904
batch 1600, loss: 3.3076, instance_loss: 0.1813, weighted_loss: 2.3697, label: 6, bag_size: 344
batch 1700, loss: 3.0564, instance_loss: 0.1777, weighted_loss: 2.1928, label: 6, bag_size: 337
batch 1800, loss: 0.8731, instance_loss: 0.0999, weighted_loss: 0.6411, label: 5, bag_size: 322
batch 1900, loss: 1.7426, instance_loss: 0.1194, weighted_loss: 1.2556, label: 5, bag_size: 331
batch 2000, loss: 5.7099, instance_loss: 0.2336, weighted_loss: 4.0671, label: 1, bag_size: 369
batch 2100, loss: 7.1483, instance_loss: 0.2832, weighted_loss: 5.0887, label: 1, bag_size: 244

Instance Classifier Stats
class 0 clustering acc 0.9984869431643625: correct 260006/260400
class 1 clustering acc 0.10656682027649769: correct 1850/17360

Epoch: 33, train_loss: 2.1821, train_clustering_loss: 0.1604, train_error: 0.4954
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6253196930946292, correct coarse 489/782 
coarse class 2: coarse acc 0.8702851885924563, correct coarse 946/1087 
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5880077369439072, correct fine 304/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.16521739130434782, correct fine 19/115 
fine class 5: fine acc 0.8914081145584726, correct fine 747/838 
fine class 6: fine acc 0.08433734939759036, correct fine 21/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2115, coarse auc: 0.7887, fine auc: 0.7861 
class 0 clustering acc 0.9990214646464647: correct 31649/31680 
class 1 clustering acc 0.11647727272727272: correct 246/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.59375, correct coarse 57/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3767
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1257

Training for coarse_and_fine level...
batch 100, loss: 2.7692, instance_loss: 0.1855, weighted_loss: 1.9941, label: 5, bag_size: 190
batch 200, loss: 1.3716, instance_loss: 0.1070, weighted_loss: 0.9922, label: 5, bag_size: 480
batch 300, loss: 4.1228, instance_loss: 0.2378, weighted_loss: 2.9573, label: 8, bag_size: 717
batch 400, loss: 2.7446, instance_loss: 0.2042, weighted_loss: 1.9825, label: 6, bag_size: 313
batch 500, loss: 0.7020, instance_loss: 0.0667, weighted_loss: 0.5114, label: 5, bag_size: 849
batch 600, loss: 3.2985, instance_loss: 0.1925, weighted_loss: 2.3667, label: 6, bag_size: 361
batch 700, loss: 3.2945, instance_loss: 0.2044, weighted_loss: 2.3675, label: 7, bag_size: 209
batch 800, loss: 3.6253, instance_loss: 0.2084, weighted_loss: 2.6002, label: 3, bag_size: 375
batch 900, loss: 2.3814, instance_loss: 0.1681, weighted_loss: 1.7174, label: 2, bag_size: 823
batch 1000, loss: 0.7217, instance_loss: 0.0802, weighted_loss: 0.5293, label: 5, bag_size: 674
batch 1100, loss: 0.2203, instance_loss: 0.0586, weighted_loss: 0.1718, label: 5, bag_size: 332
batch 1200, loss: 0.1185, instance_loss: 0.0503, weighted_loss: 0.0981, label: 5, bag_size: 835
batch 1300, loss: 0.3513, instance_loss: 0.0807, weighted_loss: 0.2701, label: 5, bag_size: 794
batch 1400, loss: 3.1117, instance_loss: 0.2034, weighted_loss: 2.2392, label: 8, bag_size: 440
batch 1500, loss: 1.2349, instance_loss: 0.1239, weighted_loss: 0.9016, label: 2, bag_size: 1767
batch 1600, loss: 1.3974, instance_loss: 0.2043, weighted_loss: 1.0395, label: 6, bag_size: 482
batch 1700, loss: 0.9216, instance_loss: 0.0754, weighted_loss: 0.6677, label: 5, bag_size: 615
batch 1800, loss: 2.3452, instance_loss: 0.1952, weighted_loss: 1.7002, label: 6, bag_size: 263
batch 1900, loss: 0.5679, instance_loss: 0.0897, weighted_loss: 0.4245, label: 5, bag_size: 310
batch 2000, loss: 0.2793, instance_loss: 0.0702, weighted_loss: 0.2165, label: 5, bag_size: 400
batch 2100, loss: 0.7484, instance_loss: 0.0831, weighted_loss: 0.5488, label: 2, bag_size: 989

Instance Classifier Stats
class 0 clustering acc 0.998410138248848: correct 259986/260400
class 1 clustering acc 0.11123271889400922: correct 1931/17360

Epoch: 34, train_loss: 2.1781, train_clustering_loss: 0.1601, train_error: 0.4926
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6227621483375959, correct coarse 487/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5783365570599613, correct fine 299/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.17391304347826086, correct fine 20/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.10040160642570281, correct fine 25/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2090, coarse auc: 0.7891, fine auc: 0.7866 
class 0 clustering acc 0.998989898989899: correct 31648/31680 
class 1 clustering acc 0.11884469696969698: correct 251/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3756
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1259

Training for coarse_and_fine level...
batch 100, loss: 4.0201, instance_loss: 0.2325, weighted_loss: 2.8838, label: 8, bag_size: 430
batch 200, loss: 2.4074, instance_loss: 0.1849, weighted_loss: 1.7406, label: 2, bag_size: 201
batch 300, loss: 0.6480, instance_loss: 0.0680, weighted_loss: 0.4740, label: 5, bag_size: 1045
batch 400, loss: 2.1086, instance_loss: 0.2052, weighted_loss: 1.5376, label: 4, bag_size: 1147
batch 500, loss: 1.9479, instance_loss: 0.1946, weighted_loss: 1.4219, label: 6, bag_size: 453
batch 600, loss: 2.1102, instance_loss: 0.2080, weighted_loss: 1.5396, label: 6, bag_size: 256
batch 700, loss: 0.3094, instance_loss: 0.0665, weighted_loss: 0.2365, label: 5, bag_size: 318
batch 800, loss: 6.6608, instance_loss: 0.3124, weighted_loss: 4.7563, label: 9, bag_size: 464
batch 900, loss: 1.1790, instance_loss: 0.0848, weighted_loss: 0.8507, label: 5, bag_size: 718
batch 1000, loss: 2.4744, instance_loss: 0.1448, weighted_loss: 1.7755, label: 2, bag_size: 779
batch 1100, loss: 2.5596, instance_loss: 0.1862, weighted_loss: 1.8476, label: 5, bag_size: 463
batch 1200, loss: 0.3949, instance_loss: 0.1079, weighted_loss: 0.3088, label: 2, bag_size: 1300
batch 1300, loss: 0.1906, instance_loss: 0.0562, weighted_loss: 0.1503, label: 5, bag_size: 385
batch 1400, loss: 3.7151, instance_loss: 0.2292, weighted_loss: 2.6693, label: 7, bag_size: 426
batch 1500, loss: 0.1386, instance_loss: 0.0581, weighted_loss: 0.1144, label: 5, bag_size: 239
batch 1600, loss: 2.0161, instance_loss: 0.1656, weighted_loss: 1.4609, label: 5, bag_size: 429
batch 1700, loss: 1.0473, instance_loss: 0.1041, weighted_loss: 0.7644, label: 5, bag_size: 431
batch 1800, loss: 1.1221, instance_loss: 0.2330, weighted_loss: 0.8554, label: 4, bag_size: 542
batch 1900, loss: 2.8539, instance_loss: 0.1933, weighted_loss: 2.0558, label: 4, bag_size: 225
batch 2000, loss: 1.8637, instance_loss: 0.1130, weighted_loss: 1.3385, label: 5, bag_size: 658
batch 2100, loss: 0.2307, instance_loss: 0.0615, weighted_loss: 0.1799, label: 5, bag_size: 667

Instance Classifier Stats
class 0 clustering acc 0.9983218125960062: correct 259963/260400
class 1 clustering acc 0.11526497695852535: correct 2001/17360

Epoch: 35, train_loss: 2.1740, train_clustering_loss: 0.1603, train_error: 0.4945
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.08560311284046693, correct coarse 22/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5802707930367504, correct fine 300/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.16521739130434782, correct fine 19/115 
fine class 5: fine acc 0.8973747016706444, correct fine 752/838 
fine class 6: fine acc 0.08433734939759036, correct fine 21/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2047, coarse auc: 0.7895, fine auc: 0.7869 
class 0 clustering acc 0.998895202020202: correct 31645/31680 
class 1 clustering acc 0.12547348484848486: correct 265/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3742
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1308

Training for coarse_and_fine level...
batch 100, loss: 2.9069, instance_loss: 0.1949, weighted_loss: 2.0933, label: 2, bag_size: 343
batch 200, loss: 0.6916, instance_loss: 0.1992, weighted_loss: 0.5439, label: 4, bag_size: 1333
batch 300, loss: 0.0847, instance_loss: 0.0404, weighted_loss: 0.0714, label: 5, bag_size: 424
batch 400, loss: 3.1402, instance_loss: 0.2169, weighted_loss: 2.2632, label: 6, bag_size: 1271
batch 500, loss: 3.8386, instance_loss: 0.2046, weighted_loss: 2.7484, label: 5, bag_size: 182
batch 600, loss: 2.7517, instance_loss: 0.1888, weighted_loss: 1.9829, label: 2, bag_size: 190
batch 700, loss: 1.6849, instance_loss: 0.2174, weighted_loss: 1.2447, label: 4, bag_size: 1867
batch 800, loss: 0.6625, instance_loss: 0.0771, weighted_loss: 0.4869, label: 5, bag_size: 674
batch 900, loss: 0.3070, instance_loss: 0.0539, weighted_loss: 0.2310, label: 5, bag_size: 597
batch 1000, loss: 0.9470, instance_loss: 0.1229, weighted_loss: 0.6998, label: 2, bag_size: 232
batch 1100, loss: 0.9334, instance_loss: 0.0978, weighted_loss: 0.6827, label: 5, bag_size: 240
batch 1200, loss: 0.8907, instance_loss: 0.1152, weighted_loss: 0.6581, label: 2, bag_size: 1365
batch 1300, loss: 2.5419, instance_loss: 0.1730, weighted_loss: 1.8312, label: 2, bag_size: 237
batch 1400, loss: 3.9337, instance_loss: 0.2291, weighted_loss: 2.8223, label: 2, bag_size: 348
batch 1500, loss: 1.0377, instance_loss: 0.0670, weighted_loss: 0.7465, label: 5, bag_size: 679
batch 1600, loss: 3.4047, instance_loss: 0.1917, weighted_loss: 2.4408, label: 6, bag_size: 744
batch 1700, loss: 3.0014, instance_loss: 0.2174, weighted_loss: 2.1662, label: 8, bag_size: 151
batch 1800, loss: 2.5186, instance_loss: 0.2089, weighted_loss: 1.8257, label: 3, bag_size: 501
batch 1900, loss: 0.7679, instance_loss: 0.0957, weighted_loss: 0.5662, label: 2, bag_size: 671
batch 2000, loss: 3.5380, instance_loss: 0.1945, weighted_loss: 2.5350, label: 6, bag_size: 276
batch 2100, loss: 4.2131, instance_loss: 0.2104, weighted_loss: 3.0123, label: 7, bag_size: 1196

Instance Classifier Stats
class 0 clustering acc 0.9983602150537635: correct 259973/260400
class 1 clustering acc 0.1228110599078341: correct 2132/17360

Epoch: 36, train_loss: 2.1675, train_clustering_loss: 0.1595, train_error: 0.4889
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6138107416879796, correct coarse 480/782 
coarse class 2: coarse acc 0.8877644894204232, correct coarse 965/1087 
coarse class 3: coarse acc 0.06614785992217899, correct coarse 17/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5686653771760155, correct fine 294/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.19130434782608696, correct fine 22/115 
fine class 5: fine acc 0.905727923627685, correct fine 759/838 
fine class 6: fine acc 0.12048192771084337, correct fine 30/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2039, coarse auc: 0.7904, fine auc: 0.7882 
class 0 clustering acc 0.9989583333333333: correct 31647/31680 
class 1 clustering acc 0.12121212121212122: correct 256/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3911
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1284

Training for coarse_and_fine level...
batch 100, loss: 3.0110, instance_loss: 0.1774, weighted_loss: 2.1609, label: 2, bag_size: 214
batch 200, loss: 1.3800, instance_loss: 0.2098, weighted_loss: 1.0289, label: 6, bag_size: 541
batch 300, loss: 0.7076, instance_loss: 0.1101, weighted_loss: 0.5284, label: 2, bag_size: 623
batch 400, loss: 6.1528, instance_loss: 0.2769, weighted_loss: 4.3900, label: 7, bag_size: 166
batch 500, loss: 0.5354, instance_loss: 0.0948, weighted_loss: 0.4032, label: 2, bag_size: 2239
batch 600, loss: 4.1690, instance_loss: 0.2015, weighted_loss: 2.9788, label: 3, bag_size: 1666
batch 700, loss: 3.0551, instance_loss: 0.1964, weighted_loss: 2.1975, label: 6, bag_size: 146
batch 800, loss: 0.6957, instance_loss: 0.0934, weighted_loss: 0.5150, label: 2, bag_size: 1512
batch 900, loss: 1.0231, instance_loss: 0.1149, weighted_loss: 0.7507, label: 5, bag_size: 394
batch 1000, loss: 5.9398, instance_loss: 0.2614, weighted_loss: 4.2363, label: 0, bag_size: 37
batch 1100, loss: 1.9612, instance_loss: 0.1297, weighted_loss: 1.4117, label: 5, bag_size: 359
batch 1200, loss: 9.0868, instance_loss: 0.2603, weighted_loss: 6.4388, label: 5, bag_size: 362
batch 1300, loss: 2.9878, instance_loss: 0.2191, weighted_loss: 2.1572, label: 7, bag_size: 312
batch 1400, loss: 1.5197, instance_loss: 0.2608, weighted_loss: 1.1420, label: 6, bag_size: 1072
batch 1500, loss: 4.1856, instance_loss: 0.2209, weighted_loss: 2.9962, label: 4, bag_size: 295
batch 1600, loss: 4.3413, instance_loss: 0.2106, weighted_loss: 3.1021, label: 4, bag_size: 201
batch 1700, loss: 1.5140, instance_loss: 0.1212, weighted_loss: 1.0962, label: 5, bag_size: 450
batch 1800, loss: 7.2573, instance_loss: 0.2647, weighted_loss: 5.1595, label: 8, bag_size: 589
batch 1900, loss: 0.2850, instance_loss: 0.0620, weighted_loss: 0.2181, label: 5, bag_size: 673
batch 2000, loss: 3.8916, instance_loss: 0.2110, weighted_loss: 2.7874, label: 7, bag_size: 435
batch 2100, loss: 1.6866, instance_loss: 0.1453, weighted_loss: 1.2242, label: 5, bag_size: 335

Instance Classifier Stats
class 0 clustering acc 0.9984600614439324: correct 259999/260400
class 1 clustering acc 0.11877880184331797: correct 2062/17360

Epoch: 37, train_loss: 2.1627, train_clustering_loss: 0.1593, train_error: 0.4903
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8675252989880404, correct coarse 943/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5918762088974855, correct fine 306/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.17391304347826086, correct fine 20/115 
fine class 5: fine acc 0.8926014319809069, correct fine 748/838 
fine class 6: fine acc 0.11646586345381527, correct fine 29/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1998, coarse auc: 0.7920, fine auc: 0.7886 
class 0 clustering acc 0.9988636363636364: correct 31644/31680 
class 1 clustering acc 0.12878787878787878: correct 272/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3854
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1309

Training for coarse_and_fine level...
batch 100, loss: 0.0969, instance_loss: 0.0355, weighted_loss: 0.0785, label: 5, bag_size: 756
batch 200, loss: 0.3655, instance_loss: 0.0513, weighted_loss: 0.2712, label: 5, bag_size: 691
batch 300, loss: 0.6280, instance_loss: 0.0682, weighted_loss: 0.4601, label: 5, bag_size: 807
batch 400, loss: 0.2265, instance_loss: 0.0803, weighted_loss: 0.1827, label: 5, bag_size: 360
batch 500, loss: 5.3056, instance_loss: 0.2704, weighted_loss: 3.7951, label: 8, bag_size: 235
batch 600, loss: 3.5688, instance_loss: 0.2626, weighted_loss: 2.5769, label: 2, bag_size: 564
batch 700, loss: 1.5038, instance_loss: 0.1034, weighted_loss: 1.0837, label: 5, bag_size: 1555
batch 800, loss: 3.2890, instance_loss: 0.2248, weighted_loss: 2.3697, label: 4, bag_size: 779
batch 900, loss: 3.8802, instance_loss: 0.2228, weighted_loss: 2.7830, label: 7, bag_size: 438
batch 1000, loss: 1.5878, instance_loss: 0.1192, weighted_loss: 1.1472, label: 5, bag_size: 377
batch 1100, loss: 6.7346, instance_loss: 0.3456, weighted_loss: 4.8179, label: 10, bag_size: 372
batch 1200, loss: 2.0785, instance_loss: 0.1571, weighted_loss: 1.5021, label: 5, bag_size: 338
batch 1300, loss: 6.5531, instance_loss: 0.2818, weighted_loss: 4.6717, label: 8, bag_size: 2813
batch 1400, loss: 2.4060, instance_loss: 0.2207, weighted_loss: 1.7504, label: 6, bag_size: 559
batch 1500, loss: 1.1940, instance_loss: 0.0489, weighted_loss: 0.8504, label: 5, bag_size: 1600
batch 1600, loss: 2.2520, instance_loss: 0.2148, weighted_loss: 1.6409, label: 7, bag_size: 163
batch 1700, loss: 2.1627, instance_loss: 0.1351, weighted_loss: 1.5544, label: 5, bag_size: 290
batch 1800, loss: 3.3968, instance_loss: 0.1995, weighted_loss: 2.4376, label: 2, bag_size: 50
batch 1900, loss: 2.1570, instance_loss: 0.2112, weighted_loss: 1.5732, label: 3, bag_size: 2069
batch 2000, loss: 2.5460, instance_loss: 0.1562, weighted_loss: 1.8291, label: 2, bag_size: 356
batch 2100, loss: 0.5656, instance_loss: 0.0805, weighted_loss: 0.4201, label: 5, bag_size: 310

Instance Classifier Stats
class 0 clustering acc 0.9981950844854071: correct 259930/260400
class 1 clustering acc 0.12678571428571428: correct 2201/17360

Epoch: 38, train_loss: 2.1601, train_clustering_loss: 0.1594, train_error: 0.4903
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6176470588235294, correct coarse 483/782 
coarse class 2: coarse acc 0.8850045998160073, correct coarse 962/1087 
coarse class 3: coarse acc 0.0933852140077821, correct coarse 24/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.574468085106383, correct fine 297/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.10843373493975904, correct fine 27/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1983, coarse auc: 0.7912, fine auc: 0.7889 
class 0 clustering acc 0.9989267676767677: correct 31646/31680 
class 1 clustering acc 0.12831439393939395: correct 271/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3909
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1302

Training for coarse_and_fine level...
batch 100, loss: 3.0557, instance_loss: 0.2022, weighted_loss: 2.1996, label: 8, bag_size: 175
batch 200, loss: 0.9055, instance_loss: 0.1006, weighted_loss: 0.6640, label: 5, bag_size: 124
batch 300, loss: 1.4547, instance_loss: 0.1003, weighted_loss: 1.0484, label: 5, bag_size: 1716
batch 400, loss: 1.6124, instance_loss: 0.1214, weighted_loss: 1.1651, label: 5, bag_size: 729
batch 500, loss: 2.4337, instance_loss: 0.1761, weighted_loss: 1.7564, label: 5, bag_size: 387
batch 600, loss: 0.5347, instance_loss: 0.0632, weighted_loss: 0.3933, label: 5, bag_size: 433
batch 700, loss: 7.5154, instance_loss: 0.2553, weighted_loss: 5.3374, label: 5, bag_size: 2344
batch 800, loss: 0.3154, instance_loss: 0.0577, weighted_loss: 0.2381, label: 5, bag_size: 755
batch 900, loss: 4.3459, instance_loss: 0.2218, weighted_loss: 3.1087, label: 7, bag_size: 274
batch 1000, loss: 3.1832, instance_loss: 0.1583, weighted_loss: 2.2758, label: 2, bag_size: 1009
batch 1100, loss: 2.1144, instance_loss: 0.2259, weighted_loss: 1.5479, label: 3, bag_size: 410
batch 1200, loss: 2.2739, instance_loss: 0.1808, weighted_loss: 1.6460, label: 5, bag_size: 518
batch 1300, loss: 0.1751, instance_loss: 0.0527, weighted_loss: 0.1384, label: 5, bag_size: 462
batch 1400, loss: 0.8871, instance_loss: 0.1038, weighted_loss: 0.6521, label: 5, bag_size: 393
batch 1500, loss: 2.2348, instance_loss: 0.1342, weighted_loss: 1.6046, label: 2, bag_size: 170
batch 1600, loss: 0.6035, instance_loss: 0.0773, weighted_loss: 0.4456, label: 5, bag_size: 1364
batch 1700, loss: 0.3268, instance_loss: 0.0616, weighted_loss: 0.2472, label: 5, bag_size: 217
batch 1800, loss: 2.9317, instance_loss: 0.2018, weighted_loss: 2.1128, label: 4, bag_size: 183
batch 1900, loss: 3.6358, instance_loss: 0.2243, weighted_loss: 2.6123, label: 7, bag_size: 168
batch 2000, loss: 0.8840, instance_loss: 0.1084, weighted_loss: 0.6513, label: 2, bag_size: 1365
batch 2100, loss: 1.1801, instance_loss: 0.1200, weighted_loss: 0.8621, label: 2, bag_size: 497

Instance Classifier Stats
class 0 clustering acc 0.9983640552995392: correct 259974/260400
class 1 clustering acc 0.12436635944700461: correct 2159/17360

Epoch: 39, train_loss: 2.1555, train_clustering_loss: 0.1588, train_error: 0.4843
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6253196930946292, correct coarse 489/782 
coarse class 2: coarse acc 0.8730450781968722, correct coarse 949/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5880077369439072, correct fine 304/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2, correct fine 23/115 
fine class 5: fine acc 0.9045346062052506, correct fine 758/838 
fine class 6: fine acc 0.11646586345381527, correct fine 29/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1950, coarse auc: 0.7919, fine auc: 0.7893 
class 0 clustering acc 0.9989267676767677: correct 31646/31680 
class 1 clustering acc 0.13115530303030304: correct 277/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3907
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1302

Training for coarse_and_fine level...
batch 100, loss: 4.0137, instance_loss: 0.2302, weighted_loss: 2.8786, label: 2, bag_size: 655
batch 200, loss: 0.1258, instance_loss: 0.0534, weighted_loss: 0.1041, label: 5, bag_size: 257
batch 300, loss: 0.1218, instance_loss: 0.0373, weighted_loss: 0.0965, label: 5, bag_size: 414
batch 400, loss: 0.9342, instance_loss: 0.1224, weighted_loss: 0.6906, label: 2, bag_size: 1085
batch 500, loss: 1.9386, instance_loss: 0.2095, weighted_loss: 1.4199, label: 3, bag_size: 605
batch 600, loss: 2.1639, instance_loss: 0.1767, weighted_loss: 1.5678, label: 5, bag_size: 206
batch 700, loss: 0.4954, instance_loss: 0.1044, weighted_loss: 0.3781, label: 2, bag_size: 762
batch 800, loss: 3.5138, instance_loss: 0.2451, weighted_loss: 2.5332, label: 8, bag_size: 212
batch 900, loss: 2.1744, instance_loss: 0.2213, weighted_loss: 1.5885, label: 3, bag_size: 1006
batch 1000, loss: 2.9947, instance_loss: 0.2306, weighted_loss: 2.1655, label: 7, bag_size: 311
batch 1100, loss: 0.1102, instance_loss: 0.0448, weighted_loss: 0.0906, label: 5, bag_size: 676
batch 1200, loss: 3.6275, instance_loss: 0.1929, weighted_loss: 2.5971, label: 6, bag_size: 252
batch 1300, loss: 2.2857, instance_loss: 0.1487, weighted_loss: 1.6446, label: 2, bag_size: 575
batch 1400, loss: 1.2256, instance_loss: 0.0930, weighted_loss: 0.8858, label: 2, bag_size: 1263
batch 1500, loss: 2.4070, instance_loss: 0.2502, weighted_loss: 1.7599, label: 6, bag_size: 600
batch 1600, loss: 4.0169, instance_loss: 0.2197, weighted_loss: 2.8777, label: 8, bag_size: 483
batch 1700, loss: 0.0835, instance_loss: 0.0459, weighted_loss: 0.0722, label: 5, bag_size: 190
batch 1800, loss: 0.3838, instance_loss: 0.1015, weighted_loss: 0.2991, label: 2, bag_size: 534
batch 1900, loss: 0.5802, instance_loss: 0.1247, weighted_loss: 0.4435, label: 2, bag_size: 334
batch 2000, loss: 1.6603, instance_loss: 0.1368, weighted_loss: 1.2032, label: 2, bag_size: 1049
batch 2100, loss: 0.6554, instance_loss: 0.1057, weighted_loss: 0.4905, label: 2, bag_size: 1817

Instance Classifier Stats
class 0 clustering acc 0.9981067588325653: correct 259907/260400
class 1 clustering acc 0.13099078341013826: correct 2274/17360

Epoch: 40, train_loss: 2.1520, train_clustering_loss: 0.1587, train_error: 0.4839
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.612531969309463, correct coarse 479/782 
coarse class 2: coarse acc 0.8850045998160073, correct coarse 962/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5764023210831721, correct fine 298/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.905727923627685, correct fine 759/838 
fine class 6: fine acc 0.14056224899598393, correct fine 35/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1938, coarse auc: 0.7905, fine auc: 0.7887 
class 0 clustering acc 0.9989267676767677: correct 31646/31680 
class 1 clustering acc 0.13068181818181818: correct 276/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3876
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1294

Training for coarse_and_fine level...
batch 100, loss: 0.7090, instance_loss: 0.1899, weighted_loss: 0.5533, label: 4, bag_size: 505
batch 200, loss: 2.5759, instance_loss: 0.1960, weighted_loss: 1.8619, label: 2, bag_size: 205
batch 300, loss: 7.5376, instance_loss: 0.2971, weighted_loss: 5.3655, label: 7, bag_size: 2158
batch 400, loss: 2.5847, instance_loss: 0.1755, weighted_loss: 1.8619, label: 5, bag_size: 1897
batch 500, loss: 0.5681, instance_loss: 0.0947, weighted_loss: 0.4261, label: 2, bag_size: 2352
batch 600, loss: 0.5194, instance_loss: 0.0950, weighted_loss: 0.3921, label: 2, bag_size: 1359
batch 700, loss: 2.2341, instance_loss: 0.2054, weighted_loss: 1.6255, label: 7, bag_size: 163
batch 800, loss: 3.8631, instance_loss: 0.2062, weighted_loss: 2.7660, label: 2, bag_size: 2625
batch 900, loss: 3.5526, instance_loss: 0.2553, weighted_loss: 2.5634, label: 2, bag_size: 559
batch 1000, loss: 6.8710, instance_loss: 0.2329, weighted_loss: 4.8796, label: 5, bag_size: 1331
batch 1100, loss: 2.4421, instance_loss: 0.1643, weighted_loss: 1.7587, label: 2, bag_size: 823
batch 1200, loss: 1.3884, instance_loss: 0.1424, weighted_loss: 1.0146, label: 2, bag_size: 1659
batch 1300, loss: 0.3036, instance_loss: 0.0666, weighted_loss: 0.2325, label: 5, bag_size: 292
batch 1400, loss: 0.6904, instance_loss: 0.1139, weighted_loss: 0.5175, label: 2, bag_size: 1567
batch 1500, loss: 3.0166, instance_loss: 0.2282, weighted_loss: 2.1801, label: 2, bag_size: 371
batch 1600, loss: 1.5554, instance_loss: 0.2059, weighted_loss: 1.1506, label: 6, bag_size: 461
batch 1700, loss: 6.4351, instance_loss: 0.2634, weighted_loss: 4.5836, label: 1, bag_size: 119
batch 1800, loss: 0.8549, instance_loss: 0.1235, weighted_loss: 0.6355, label: 5, bag_size: 12
batch 1900, loss: 0.3267, instance_loss: 0.0525, weighted_loss: 0.2444, label: 5, bag_size: 273
batch 2000, loss: 5.9612, instance_loss: 0.2539, weighted_loss: 4.2490, label: 1, bag_size: 132
batch 2100, loss: 1.5352, instance_loss: 0.2335, weighted_loss: 1.1447, label: 6, bag_size: 740

Instance Classifier Stats
class 0 clustering acc 0.9981989247311828: correct 259931/260400
class 1 clustering acc 0.13012672811059908: correct 2259/17360

Epoch: 41, train_loss: 2.1484, train_clustering_loss: 0.1585, train_error: 0.4880
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5725338491295938, correct fine 296/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.9009546539379475, correct fine 755/838 
fine class 6: fine acc 0.12048192771084337, correct fine 30/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1905, coarse auc: 0.7916, fine auc: 0.7896 
class 0 clustering acc 0.9988005050505051: correct 31642/31680 
class 1 clustering acc 0.13731060606060605: correct 290/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3907
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1294

Training for coarse_and_fine level...
batch 100, loss: 0.2549, instance_loss: 0.0560, weighted_loss: 0.1953, label: 5, bag_size: 637
batch 200, loss: 1.2386, instance_loss: 0.2577, weighted_loss: 0.9444, label: 6, bag_size: 328
batch 300, loss: 2.5129, instance_loss: 0.1776, weighted_loss: 1.8123, label: 5, bag_size: 52
batch 400, loss: 0.1332, instance_loss: 0.0267, weighted_loss: 0.1012, label: 5, bag_size: 890
batch 500, loss: 4.3783, instance_loss: 0.2655, weighted_loss: 3.1445, label: 8, bag_size: 876
batch 600, loss: 3.9762, instance_loss: 0.2094, weighted_loss: 2.8462, label: 3, bag_size: 285
batch 700, loss: 2.0181, instance_loss: 0.1455, weighted_loss: 1.4563, label: 2, bag_size: 435
batch 800, loss: 0.4519, instance_loss: 0.1047, weighted_loss: 0.3478, label: 2, bag_size: 1490
batch 900, loss: 1.1044, instance_loss: 0.1091, weighted_loss: 0.8058, label: 5, bag_size: 861
batch 1000, loss: 0.2064, instance_loss: 0.0507, weighted_loss: 0.1597, label: 5, bag_size: 360
batch 1100, loss: 3.6620, instance_loss: 0.2102, weighted_loss: 2.6265, label: 5, bag_size: 537
batch 1200, loss: 2.3112, instance_loss: 0.2073, weighted_loss: 1.6800, label: 6, bag_size: 2046
batch 1300, loss: 5.3746, instance_loss: 0.2507, weighted_loss: 3.8374, label: 8, bag_size: 378
batch 1400, loss: 3.8358, instance_loss: 0.2041, weighted_loss: 2.7463, label: 6, bag_size: 563
batch 1500, loss: 2.0152, instance_loss: 0.1502, weighted_loss: 1.4557, label: 5, bag_size: 429
batch 1600, loss: 4.3043, instance_loss: 0.3068, weighted_loss: 3.1050, label: 4, bag_size: 758
batch 1700, loss: 1.2424, instance_loss: 0.2304, weighted_loss: 0.9388, label: 6, bag_size: 422
batch 1800, loss: 0.1069, instance_loss: 0.0432, weighted_loss: 0.0878, label: 5, bag_size: 361
batch 1900, loss: 0.3102, instance_loss: 0.0517, weighted_loss: 0.2326, label: 5, bag_size: 139
batch 2000, loss: 6.7788, instance_loss: 0.2656, weighted_loss: 4.8248, label: 1, bag_size: 863
batch 2100, loss: 2.4391, instance_loss: 0.1602, weighted_loss: 1.7554, label: 2, bag_size: 696

Instance Classifier Stats
class 0 clustering acc 0.9980376344086022: correct 259889/260400
class 1 clustering acc 0.1341589861751152: correct 2329/17360

Epoch: 42, train_loss: 2.1440, train_clustering_loss: 0.1584, train_error: 0.4834
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.618925831202046, correct coarse 484/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5705996131528046, correct fine 295/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.9069212410501193, correct fine 760/838 
fine class 6: fine acc 0.14457831325301204, correct fine 36/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1893, coarse auc: 0.7915, fine auc: 0.7893 
class 0 clustering acc 0.9988636363636364: correct 31644/31680 
class 1 clustering acc 0.13541666666666666: correct 286/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3895
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1294

Training for coarse_and_fine level...
batch 100, loss: 3.9624, instance_loss: 0.2310, weighted_loss: 2.8430, label: 8, bag_size: 356
batch 200, loss: 0.2969, instance_loss: 0.0538, weighted_loss: 0.2240, label: 5, bag_size: 511
batch 300, loss: 6.1547, instance_loss: 0.2469, weighted_loss: 4.3824, label: 8, bag_size: 568
batch 400, loss: 1.6355, instance_loss: 0.1384, weighted_loss: 1.1864, label: 5, bag_size: 277
batch 500, loss: 2.9964, instance_loss: 0.1689, weighted_loss: 2.1481, label: 2, bag_size: 544
batch 600, loss: 2.2641, instance_loss: 0.1570, weighted_loss: 1.6320, label: 2, bag_size: 258
batch 700, loss: 1.7964, instance_loss: 0.1548, weighted_loss: 1.3039, label: 5, bag_size: 258
batch 800, loss: 1.6377, instance_loss: 0.1318, weighted_loss: 1.1859, label: 2, bag_size: 374
batch 900, loss: 0.0839, instance_loss: 0.0323, weighted_loss: 0.0684, label: 5, bag_size: 455
batch 1000, loss: 0.1438, instance_loss: 0.0341, weighted_loss: 0.1109, label: 5, bag_size: 676
batch 1100, loss: 2.1205, instance_loss: 0.1577, weighted_loss: 1.5317, label: 5, bag_size: 253
batch 1200, loss: 0.5068, instance_loss: 0.0630, weighted_loss: 0.3737, label: 5, bag_size: 229
batch 1300, loss: 0.0923, instance_loss: 0.0267, weighted_loss: 0.0726, label: 5, bag_size: 403
batch 1400, loss: 4.7104, instance_loss: 0.2639, weighted_loss: 3.3765, label: 4, bag_size: 593
batch 1500, loss: 0.0795, instance_loss: 0.0328, weighted_loss: 0.0655, label: 5, bag_size: 338
batch 1600, loss: 1.1227, instance_loss: 0.1207, weighted_loss: 0.8221, label: 2, bag_size: 927
batch 1700, loss: 0.2179, instance_loss: 0.0406, weighted_loss: 0.1647, label: 5, bag_size: 221
batch 1800, loss: 0.0943, instance_loss: 0.0417, weighted_loss: 0.0785, label: 5, bag_size: 495
batch 1900, loss: 0.2585, instance_loss: 0.0588, weighted_loss: 0.1986, label: 5, bag_size: 252
batch 2000, loss: 0.4704, instance_loss: 0.2019, weighted_loss: 0.3898, label: 4, bag_size: 1380
batch 2100, loss: 0.9484, instance_loss: 0.1129, weighted_loss: 0.6977, label: 2, bag_size: 1973

Instance Classifier Stats
class 0 clustering acc 0.9980990783410139: correct 259905/260400
class 1 clustering acc 0.13577188940092166: correct 2357/17360

Epoch: 43, train_loss: 2.1407, train_clustering_loss: 0.1582, train_error: 0.4811
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6253196930946292, correct coarse 489/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.08560311284046693, correct coarse 22/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5686653771760155, correct fine 294/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.22608695652173913, correct fine 26/115 
fine class 5: fine acc 0.9081145584725537, correct fine 761/838 
fine class 6: fine acc 0.1566265060240964, correct fine 39/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1878, coarse auc: 0.7921, fine auc: 0.7893 
class 0 clustering acc 0.9987689393939394: correct 31641/31680 
class 1 clustering acc 0.140625: correct 297/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3937
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1294

Training for coarse_and_fine level...
batch 100, loss: 0.5954, instance_loss: 0.0775, weighted_loss: 0.4401, label: 5, bag_size: 1045
batch 200, loss: 2.7494, instance_loss: 0.1589, weighted_loss: 1.9723, label: 5, bag_size: 478
batch 300, loss: 0.0774, instance_loss: 0.0331, weighted_loss: 0.0641, label: 5, bag_size: 338
batch 400, loss: 0.1422, instance_loss: 0.0458, weighted_loss: 0.1133, label: 5, bag_size: 250
batch 500, loss: 2.2437, instance_loss: 0.1551, weighted_loss: 1.6171, label: 5, bag_size: 458
batch 600, loss: 0.1534, instance_loss: 0.0321, weighted_loss: 0.1170, label: 5, bag_size: 1281
batch 700, loss: 0.9418, instance_loss: 0.0874, weighted_loss: 0.6855, label: 5, bag_size: 543
batch 800, loss: 2.7095, instance_loss: 0.1744, weighted_loss: 1.9489, label: 5, bag_size: 112
batch 900, loss: 2.5233, instance_loss: 0.1636, weighted_loss: 1.8154, label: 5, bag_size: 228
batch 1000, loss: 1.3996, instance_loss: 0.1253, weighted_loss: 1.0173, label: 5, bag_size: 386
batch 1100, loss: 5.5820, instance_loss: 0.2897, weighted_loss: 3.9943, label: 10, bag_size: 335
batch 1200, loss: 1.6785, instance_loss: 0.1553, weighted_loss: 1.2215, label: 5, bag_size: 108
batch 1300, loss: 4.8370, instance_loss: 0.2279, weighted_loss: 3.4543, label: 3, bag_size: 233
batch 1400, loss: 4.7947, instance_loss: 0.2828, weighted_loss: 3.4411, label: 2, bag_size: 559
batch 1500, loss: 1.4504, instance_loss: 0.1254, weighted_loss: 1.0529, label: 5, bag_size: 473
batch 1600, loss: 0.8045, instance_loss: 0.0910, weighted_loss: 0.5905, label: 2, bag_size: 2047
batch 1700, loss: 3.3050, instance_loss: 0.2098, weighted_loss: 2.3764, label: 8, bag_size: 388
batch 1800, loss: 3.6456, instance_loss: 0.2181, weighted_loss: 2.6173, label: 8, bag_size: 571
batch 1900, loss: 1.9260, instance_loss: 0.1095, weighted_loss: 1.3810, label: 5, bag_size: 658
batch 2000, loss: 0.6311, instance_loss: 0.0895, weighted_loss: 0.4686, label: 2, bag_size: 2213
batch 2100, loss: 2.5652, instance_loss: 0.1647, weighted_loss: 1.8451, label: 2, bag_size: 448

Instance Classifier Stats
class 0 clustering acc 0.9981374807987711: correct 259915/260400
class 1 clustering acc 0.1398041474654378: correct 2427/17360

Epoch: 44, train_loss: 2.1364, train_clustering_loss: 0.1576, train_error: 0.4829
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.618925831202046, correct coarse 484/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5667311411992263, correct fine 293/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.22608695652173913, correct fine 26/115 
fine class 5: fine acc 0.9033412887828163, correct fine 757/838 
fine class 6: fine acc 0.1646586345381526, correct fine 41/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1866, coarse auc: 0.7929, fine auc: 0.7893 
class 0 clustering acc 0.9987373737373737: correct 31640/31680 
class 1 clustering acc 0.14204545454545456: correct 300/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3876
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1294

Training for coarse_and_fine level...
batch 100, loss: 4.4447, instance_loss: 0.2091, weighted_loss: 3.1740, label: 8, bag_size: 110
batch 200, loss: 0.4736, instance_loss: 0.0785, weighted_loss: 0.3551, label: 2, bag_size: 2239
batch 300, loss: 2.3659, instance_loss: 0.1786, weighted_loss: 1.7097, label: 5, bag_size: 331
batch 400, loss: 1.0626, instance_loss: 0.1019, weighted_loss: 0.7744, label: 2, bag_size: 1617
batch 500, loss: 3.6688, instance_loss: 0.2005, weighted_loss: 2.6283, label: 8, bag_size: 141
batch 600, loss: 0.2088, instance_loss: 0.0536, weighted_loss: 0.1622, label: 5, bag_size: 505
batch 700, loss: 2.5017, instance_loss: 0.2175, weighted_loss: 1.8165, label: 3, bag_size: 483
batch 800, loss: 3.5265, instance_loss: 0.2113, weighted_loss: 2.5319, label: 5, bag_size: 537
batch 900, loss: 1.4830, instance_loss: 0.1074, weighted_loss: 1.0703, label: 5, bag_size: 696
batch 1000, loss: 2.1002, instance_loss: 0.1818, weighted_loss: 1.5247, label: 2, bag_size: 1184
batch 1100, loss: 0.2978, instance_loss: 0.1836, weighted_loss: 0.2635, label: 4, bag_size: 260
batch 1200, loss: 1.1629, instance_loss: 0.1145, weighted_loss: 0.8484, label: 2, bag_size: 1665
batch 1300, loss: 0.7505, instance_loss: 0.0652, weighted_loss: 0.5449, label: 5, bag_size: 674
batch 1400, loss: 2.0188, instance_loss: 0.1320, weighted_loss: 1.4528, label: 5, bag_size: 394
batch 1500, loss: 1.0050, instance_loss: 0.1846, weighted_loss: 0.7589, label: 4, bag_size: 483
batch 1600, loss: 3.2032, instance_loss: 0.1740, weighted_loss: 2.2944, label: 2, bag_size: 334
batch 1700, loss: 0.4704, instance_loss: 0.0913, weighted_loss: 0.3567, label: 2, bag_size: 1394
batch 1800, loss: 6.4201, instance_loss: 0.3195, weighted_loss: 4.5900, label: 8, bag_size: 380
batch 1900, loss: 4.1210, instance_loss: 0.2690, weighted_loss: 2.9654, label: 2, bag_size: 361
batch 2000, loss: 0.7865, instance_loss: 0.1151, weighted_loss: 0.5851, label: 2, bag_size: 365
batch 2100, loss: 4.4388, instance_loss: 0.1817, weighted_loss: 3.1617, label: 5, bag_size: 506

Instance Classifier Stats
class 0 clustering acc 0.9978917050691244: correct 259851/260400
class 1 clustering acc 0.13703917050691244: correct 2379/17360

Epoch: 45, train_loss: 2.1341, train_clustering_loss: 0.1579, train_error: 0.4797
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6202046035805626, correct coarse 485/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5822050290135397, correct fine 301/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.9069212410501193, correct fine 760/838 
fine class 6: fine acc 0.15261044176706828, correct fine 38/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1849, coarse auc: 0.7934, fine auc: 0.7896 
class 0 clustering acc 0.9987058080808081: correct 31639/31680 
class 1 clustering acc 0.140625: correct 297/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8208955223880597, correct coarse 110/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3856
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1294

Training for coarse_and_fine level...
batch 100, loss: 0.1147, instance_loss: 0.0426, weighted_loss: 0.0931, label: 5, bag_size: 764
batch 200, loss: 1.7851, instance_loss: 0.1929, weighted_loss: 1.3074, label: 6, bag_size: 444
batch 300, loss: 6.4125, instance_loss: 0.2787, weighted_loss: 4.5724, label: 0, bag_size: 324
batch 400, loss: 3.7056, instance_loss: 0.2181, weighted_loss: 2.6594, label: 3, bag_size: 303
batch 500, loss: 1.1283, instance_loss: 0.1312, weighted_loss: 0.8291, label: 2, bag_size: 343
batch 600, loss: 2.0279, instance_loss: 0.1417, weighted_loss: 1.4620, label: 2, bag_size: 1618
batch 700, loss: 3.2339, instance_loss: 0.2049, weighted_loss: 2.3252, label: 7, bag_size: 658
batch 800, loss: 1.6292, instance_loss: 0.2250, weighted_loss: 1.2080, label: 3, bag_size: 428
batch 900, loss: 0.5723, instance_loss: 0.1023, weighted_loss: 0.4313, label: 2, bag_size: 778
batch 1000, loss: 4.2701, instance_loss: 0.2421, weighted_loss: 3.0617, label: 4, bag_size: 168
batch 1100, loss: 0.2311, instance_loss: 0.0669, weighted_loss: 0.1818, label: 5, bag_size: 235
batch 1200, loss: 0.4369, instance_loss: 0.0530, weighted_loss: 0.3217, label: 5, bag_size: 667
batch 1300, loss: 2.5982, instance_loss: 0.1899, weighted_loss: 1.8757, label: 2, bag_size: 271
batch 1400, loss: 2.2864, instance_loss: 0.1705, weighted_loss: 1.6516, label: 5, bag_size: 472
batch 1500, loss: 1.3026, instance_loss: 0.0782, weighted_loss: 0.9353, label: 5, bag_size: 575
batch 1600, loss: 4.7552, instance_loss: 0.2488, weighted_loss: 3.4033, label: 4, bag_size: 287
batch 1700, loss: 3.5544, instance_loss: 0.2400, weighted_loss: 2.5601, label: 7, bag_size: 478
batch 1800, loss: 0.4497, instance_loss: 0.0818, weighted_loss: 0.3393, label: 2, bag_size: 1490
batch 1900, loss: 1.7119, instance_loss: 0.2707, weighted_loss: 1.2795, label: 6, bag_size: 649
batch 2000, loss: 0.5681, instance_loss: 0.1154, weighted_loss: 0.4323, label: 2, bag_size: 309
batch 2100, loss: 7.4581, instance_loss: 0.2795, weighted_loss: 5.3045, label: 1, bag_size: 439

Instance Classifier Stats
class 0 clustering acc 0.9980913978494623: correct 259903/260400
class 1 clustering acc 0.13807603686635944: correct 2397/17360

Epoch: 46, train_loss: 2.1293, train_clustering_loss: 0.1574, train_error: 0.4788
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5880077369439072, correct fine 304/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.22608695652173913, correct fine 26/115 
fine class 5: fine acc 0.8997613365155132, correct fine 754/838 
fine class 6: fine acc 0.1686746987951807, correct fine 42/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1810, coarse auc: 0.7939, fine auc: 0.7899 
class 0 clustering acc 0.9986426767676768: correct 31637/31680 
class 1 clustering acc 0.14583333333333334: correct 308/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.1, correct fine 3/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3909
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1350

Training for coarse_and_fine level...
batch 100, loss: 2.3128, instance_loss: 0.1576, weighted_loss: 1.6663, label: 2, bag_size: 308
batch 200, loss: 2.2766, instance_loss: 0.1664, weighted_loss: 1.6435, label: 2, bag_size: 267
batch 300, loss: 6.0464, instance_loss: 0.2817, weighted_loss: 4.3170, label: 10, bag_size: 625
batch 400, loss: 0.2048, instance_loss: 0.0429, weighted_loss: 0.1562, label: 5, bag_size: 887
batch 500, loss: 1.6626, instance_loss: 0.1913, weighted_loss: 1.2212, label: 6, bag_size: 477
batch 600, loss: 1.8124, instance_loss: 0.2127, weighted_loss: 1.3325, label: 3, bag_size: 304
batch 700, loss: 2.9308, instance_loss: 0.2302, weighted_loss: 2.1206, label: 7, bag_size: 311
batch 800, loss: 1.7747, instance_loss: 0.1681, weighted_loss: 1.2927, label: 6, bag_size: 239
batch 900, loss: 4.0235, instance_loss: 0.3029, weighted_loss: 2.9073, label: 3, bag_size: 495
batch 1000, loss: 0.6682, instance_loss: 0.0853, weighted_loss: 0.4933, label: 2, bag_size: 1360
batch 1100, loss: 1.5922, instance_loss: 0.1860, weighted_loss: 1.1704, label: 6, bag_size: 352
batch 1200, loss: 2.6078, instance_loss: 0.2241, weighted_loss: 1.8927, label: 3, bag_size: 1046
batch 1300, loss: 3.0250, instance_loss: 0.1663, weighted_loss: 2.1674, label: 2, bag_size: 420
batch 1400, loss: 3.2928, instance_loss: 0.2199, weighted_loss: 2.3709, label: 2, bag_size: 540
batch 1500, loss: 3.4306, instance_loss: 0.1811, weighted_loss: 2.4558, label: 2, bag_size: 471
batch 1600, loss: 1.0921, instance_loss: 0.1027, weighted_loss: 0.7952, label: 2, bag_size: 496
batch 1700, loss: 3.3069, instance_loss: 0.2114, weighted_loss: 2.3783, label: 8, bag_size: 1555
batch 1800, loss: 1.5027, instance_loss: 0.1085, weighted_loss: 1.0844, label: 5, bag_size: 223
batch 1900, loss: 1.5877, instance_loss: 0.1893, weighted_loss: 1.1682, label: 6, bag_size: 481
batch 2000, loss: 1.6982, instance_loss: 0.2040, weighted_loss: 1.2499, label: 3, bag_size: 724
batch 2100, loss: 9.0322, instance_loss: 0.3661, weighted_loss: 6.4324, label: 3, bag_size: 486

Instance Classifier Stats
class 0 clustering acc 0.9979339477726574: correct 259862/260400
class 1 clustering acc 0.14412442396313363: correct 2502/17360

Epoch: 47, train_loss: 2.1271, train_clustering_loss: 0.1573, train_error: 0.4839
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6202046035805626, correct coarse 485/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.0933852140077821, correct coarse 24/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5705996131528046, correct fine 295/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.23478260869565218, correct fine 27/115 
fine class 5: fine acc 0.9045346062052506, correct fine 758/838 
fine class 6: fine acc 0.14457831325301204, correct fine 36/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1798, coarse auc: 0.7945, fine auc: 0.7898 
class 0 clustering acc 0.9986742424242424: correct 31638/31680 
class 1 clustering acc 0.14488636363636365: correct 306/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.1, correct fine 3/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3876
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1361

Val error: 0.4848, ROC Coarse AUC: 0.7801
Val error: 0.4848, ROC Fine AUC: 0.7835
