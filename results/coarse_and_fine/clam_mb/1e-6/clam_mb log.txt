Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for coarse_and_fine level...
batch 100, loss: 3.7556, instance_loss: 1.2692, weighted_loss: 3.0097, label: 5, bag_size: 315
batch 200, loss: 3.8478, instance_loss: 1.2282, weighted_loss: 3.0619, label: 7, bag_size: 210
batch 300, loss: 3.6693, instance_loss: 1.2449, weighted_loss: 2.9420, label: 6, bag_size: 518
batch 400, loss: 3.7937, instance_loss: 1.2334, weighted_loss: 3.0256, label: 2, bag_size: 762
batch 500, loss: 3.8436, instance_loss: 1.1857, weighted_loss: 3.0462, label: 7, bag_size: 256
batch 600, loss: 3.5386, instance_loss: 1.1859, weighted_loss: 2.8328, label: 2, bag_size: 198
batch 700, loss: 3.4428, instance_loss: 1.1695, weighted_loss: 2.7608, label: 2, bag_size: 306
batch 800, loss: 2.9991, instance_loss: 1.1354, weighted_loss: 2.4400, label: 5, bag_size: 658
batch 900, loss: 3.3268, instance_loss: 1.1467, weighted_loss: 2.6728, label: 2, bag_size: 1263
batch 1000, loss: 3.9342, instance_loss: 1.1452, weighted_loss: 3.0975, label: 7, bag_size: 704
batch 1100, loss: 3.3559, instance_loss: 1.0761, weighted_loss: 2.6720, label: 2, bag_size: 940
batch 1200, loss: 2.7236, instance_loss: 1.0552, weighted_loss: 2.2231, label: 5, bag_size: 2141
batch 1300, loss: 2.5801, instance_loss: 1.0804, weighted_loss: 2.1302, label: 5, bag_size: 385
batch 1400, loss: 4.0565, instance_loss: 1.0553, weighted_loss: 3.1562, label: 7, bag_size: 452
batch 1500, loss: 3.2844, instance_loss: 1.0038, weighted_loss: 2.6002, label: 2, bag_size: 2239
batch 1600, loss: 2.4755, instance_loss: 0.9568, weighted_loss: 2.0199, label: 5, bag_size: 559
batch 1700, loss: 2.4071, instance_loss: 1.0022, weighted_loss: 1.9856, label: 5, bag_size: 11
batch 1800, loss: 4.9187, instance_loss: 0.9647, weighted_loss: 3.7325, label: 1, bag_size: 113
batch 1900, loss: 2.5527, instance_loss: 0.9312, weighted_loss: 2.0663, label: 5, bag_size: 121
batch 2000, loss: 4.2730, instance_loss: 0.9180, weighted_loss: 3.2665, label: 8, bag_size: 543
batch 2100, loss: 3.9823, instance_loss: 0.9464, weighted_loss: 3.0716, label: 4, bag_size: 74

Instance Classifier Stats
class 0 clustering acc 0.7700076804915514: correct 200510/260400
class 1 clustering acc 0.38894009216589864: correct 6752/17360

Epoch: 1, train_loss: 3.3282, train_clustering_loss: 1.0898, train_error: 0.6613
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.07289002557544758, correct coarse 57/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.07003891050583658, correct coarse 18/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.013539651837524178, correct fine 7/517 
fine class 3: fine acc 0.17333333333333334, correct fine 26/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8257756563245824, correct fine 692/838 
fine class 6: fine acc 0.040160642570281124, correct fine 10/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.9733, coarse auc: 0.5757, fine auc: 0.5612 
class 0 clustering acc 0.9631628787878788: correct 30513/31680 
class 1 clustering acc 0.08333333333333333: correct 176/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.020833333333333332, correct coarse 2/96 
coarse class 2: coarse acc 1.0, correct coarse 134/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.0, correct fine 0/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.5152
Coarse Overall F1 Score: 0.1794
Fine Overall Accuracy: 0.3939
Fine Overall F1 Score: 0.0514

Training for coarse_and_fine level...
batch 100, loss: 3.0060, instance_loss: 0.8577, weighted_loss: 2.3615, label: 6, bag_size: 89
batch 200, loss: 3.1371, instance_loss: 0.9161, weighted_loss: 2.4708, label: 2, bag_size: 1144
batch 300, loss: 2.0399, instance_loss: 0.8445, weighted_loss: 1.6813, label: 5, bag_size: 817
batch 400, loss: 2.9203, instance_loss: 0.8021, weighted_loss: 2.2849, label: 2, bag_size: 84
batch 500, loss: 2.8446, instance_loss: 0.7838, weighted_loss: 2.2264, label: 2, bag_size: 646
batch 600, loss: 3.5763, instance_loss: 0.7681, weighted_loss: 2.7339, label: 3, bag_size: 262
batch 700, loss: 2.0118, instance_loss: 0.7346, weighted_loss: 1.6287, label: 5, bag_size: 615
batch 800, loss: 3.8347, instance_loss: 0.7683, weighted_loss: 2.9148, label: 4, bag_size: 1181
batch 900, loss: 3.1621, instance_loss: 0.6979, weighted_loss: 2.4228, label: 6, bag_size: 843
batch 1000, loss: 4.8952, instance_loss: 0.6713, weighted_loss: 3.6281, label: 7, bag_size: 528
batch 1100, loss: 3.1756, instance_loss: 0.6818, weighted_loss: 2.4274, label: 6, bag_size: 850
batch 1200, loss: 2.0650, instance_loss: 0.7020, weighted_loss: 1.6561, label: 5, bag_size: 307
batch 1300, loss: 5.1925, instance_loss: 0.6470, weighted_loss: 3.8288, label: 7, bag_size: 462
batch 1400, loss: 5.0923, instance_loss: 0.6188, weighted_loss: 3.7502, label: 7, bag_size: 354
batch 1500, loss: 3.0568, instance_loss: 0.6786, weighted_loss: 2.3433, label: 6, bag_size: 132
batch 1600, loss: 5.4866, instance_loss: 0.7304, weighted_loss: 4.0598, label: 9, bag_size: 84
batch 1700, loss: 4.7310, instance_loss: 0.6338, weighted_loss: 3.5018, label: 7, bag_size: 590
batch 1800, loss: 2.7836, instance_loss: 0.5990, weighted_loss: 2.1282, label: 2, bag_size: 687
batch 1900, loss: 1.6772, instance_loss: 0.5214, weighted_loss: 1.3305, label: 5, bag_size: 214
batch 2000, loss: 1.8465, instance_loss: 0.5466, weighted_loss: 1.4565, label: 5, bag_size: 311
batch 2100, loss: 2.6735, instance_loss: 0.5508, weighted_loss: 2.0367, label: 2, bag_size: 768

Instance Classifier Stats
class 0 clustering acc 0.9798655913978495: correct 255157/260400
class 1 clustering acc 0.05478110599078341: correct 951/17360

Epoch: 2, train_loss: 2.8786, train_clustering_loss: 0.7023, train_error: 0.6129
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.05754475703324808, correct coarse 45/782 
coarse class 2: coarse acc 0.9954001839926403, correct coarse 1082/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.0038684719535783366, correct fine 2/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 1.0, correct fine 838/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.7449, coarse auc: 0.6196, fine auc: 0.5986 
class 0 clustering acc 0.9994949494949495: correct 31664/31680 
class 1 clustering acc 0.0004734848484848485: correct 1/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.09375, correct coarse 9/96 
coarse class 2: coarse acc 1.0, correct coarse 134/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.03125, correct fine 2/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.5417
Coarse Overall F1 Score: 0.2151
Fine Overall Accuracy: 0.4015
Fine Overall F1 Score: 0.0572

Training for coarse_and_fine level...
batch 100, loss: 1.7349, instance_loss: 0.4989, weighted_loss: 1.3641, label: 5, bag_size: 394
batch 200, loss: 2.6476, instance_loss: 0.4912, weighted_loss: 2.0006, label: 2, bag_size: 517
batch 300, loss: 2.8615, instance_loss: 0.5341, weighted_loss: 2.1633, label: 2, bag_size: 738
batch 400, loss: 1.5287, instance_loss: 0.5064, weighted_loss: 1.2220, label: 5, bag_size: 921
batch 500, loss: 2.6988, instance_loss: 0.5227, weighted_loss: 2.0459, label: 2, bag_size: 681
batch 600, loss: 1.2714, instance_loss: 0.4382, weighted_loss: 1.0215, label: 5, bag_size: 393
batch 700, loss: 1.3127, instance_loss: 0.4388, weighted_loss: 1.0505, label: 5, bag_size: 318
batch 800, loss: 2.4629, instance_loss: 0.5062, weighted_loss: 1.8759, label: 2, bag_size: 613
batch 900, loss: 3.1096, instance_loss: 0.4786, weighted_loss: 2.3203, label: 6, bag_size: 1043
batch 1000, loss: 1.1861, instance_loss: 0.4181, weighted_loss: 0.9557, label: 5, bag_size: 827
batch 1100, loss: 2.5893, instance_loss: 0.4509, weighted_loss: 1.9478, label: 2, bag_size: 183
batch 1200, loss: 5.4346, instance_loss: 0.4219, weighted_loss: 3.9308, label: 7, bag_size: 210
batch 1300, loss: 6.5048, instance_loss: 0.4306, weighted_loss: 4.6825, label: 1, bag_size: 132
batch 1400, loss: 1.7214, instance_loss: 0.3838, weighted_loss: 1.3201, label: 5, bag_size: 316
batch 1500, loss: 2.5491, instance_loss: 0.4233, weighted_loss: 1.9113, label: 2, bag_size: 1253
batch 1600, loss: 1.2153, instance_loss: 0.3501, weighted_loss: 0.9558, label: 5, bag_size: 223
batch 1700, loss: 2.9629, instance_loss: 0.4021, weighted_loss: 2.1946, label: 6, bag_size: 1836
batch 1800, loss: 1.5036, instance_loss: 0.3801, weighted_loss: 1.1665, label: 5, bag_size: 542
batch 1900, loss: 2.9117, instance_loss: 0.3597, weighted_loss: 2.1461, label: 2, bag_size: 531
batch 2000, loss: 5.4893, instance_loss: 0.3611, weighted_loss: 3.9508, label: 7, bag_size: 256
batch 2100, loss: 2.2694, instance_loss: 0.3372, weighted_loss: 1.6898, label: 2, bag_size: 116

Instance Classifier Stats
class 0 clustering acc 0.9991129032258065: correct 260169/260400
class 1 clustering acc 0.003859447004608295: correct 67/17360

Epoch: 3, train_loss: 2.7482, train_clustering_loss: 0.4368, train_error: 0.6051
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.1867007672634271, correct coarse 146/782 
coarse class 2: coarse acc 0.9788408463661453, correct coarse 1064/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.0425531914893617, correct fine 22/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9964200477326969, correct fine 835/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.6635, coarse auc: 0.6423, fine auc: 0.6199 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.2604166666666667, correct coarse 25/96 
coarse class 2: coarse acc 0.9776119402985075, correct coarse 131/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.046875, correct fine 3/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.5909
Coarse Overall F1 Score: 0.2766
Fine Overall Accuracy: 0.4053
Fine Overall F1 Score: 0.0600

Training for coarse_and_fine level...
batch 100, loss: 3.0621, instance_loss: 0.3679, weighted_loss: 2.2538, label: 6, bag_size: 3471
batch 200, loss: 4.3479, instance_loss: 0.3514, weighted_loss: 3.1490, label: 3, bag_size: 406
batch 300, loss: 4.9990, instance_loss: 0.3616, weighted_loss: 3.6078, label: 7, bag_size: 426
batch 400, loss: 2.2956, instance_loss: 0.3361, weighted_loss: 1.7077, label: 2, bag_size: 826
batch 500, loss: 2.2751, instance_loss: 0.3512, weighted_loss: 1.6979, label: 2, bag_size: 1847
batch 600, loss: 5.0792, instance_loss: 0.3088, weighted_loss: 3.6480, label: 8, bag_size: 151
batch 700, loss: 2.5531, instance_loss: 0.2944, weighted_loss: 1.8755, label: 2, bag_size: 214
batch 800, loss: 7.6240, instance_loss: 0.3562, weighted_loss: 5.4437, label: 0, bag_size: 432
batch 900, loss: 1.2162, instance_loss: 0.2805, weighted_loss: 0.9355, label: 5, bag_size: 462
batch 1000, loss: 3.0306, instance_loss: 0.3037, weighted_loss: 2.2125, label: 6, bag_size: 169
batch 1100, loss: 1.2569, instance_loss: 0.2646, weighted_loss: 0.9592, label: 5, bag_size: 208
batch 1200, loss: 3.0153, instance_loss: 0.2845, weighted_loss: 2.1961, label: 6, bag_size: 843
batch 1300, loss: 1.1326, instance_loss: 0.2457, weighted_loss: 0.8665, label: 5, bag_size: 859
batch 1400, loss: 1.2348, instance_loss: 0.2601, weighted_loss: 0.9424, label: 5, bag_size: 385
batch 1500, loss: 3.2831, instance_loss: 0.3373, weighted_loss: 2.3993, label: 6, bag_size: 144
batch 1600, loss: 2.5800, instance_loss: 0.3129, weighted_loss: 1.8998, label: 2, bag_size: 333
batch 1700, loss: 4.9395, instance_loss: 0.3030, weighted_loss: 3.5485, label: 8, bag_size: 568
batch 1800, loss: 1.2820, instance_loss: 0.2539, weighted_loss: 0.9736, label: 5, bag_size: 234
batch 1900, loss: 2.2801, instance_loss: 0.2602, weighted_loss: 1.6741, label: 2, bag_size: 1085
batch 2000, loss: 0.9668, instance_loss: 0.2190, weighted_loss: 0.7425, label: 5, bag_size: 686
batch 2100, loss: 2.9428, instance_loss: 0.2378, weighted_loss: 2.1313, label: 6, bag_size: 1019

Instance Classifier Stats
class 0 clustering acc 0.9999385560675883: correct 260384/260400
class 1 clustering acc 5.76036866359447e-05: correct 1/17360

Epoch: 4, train_loss: 2.6845, train_clustering_loss: 0.3010, train_error: 0.5843
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.2826086956521739, correct coarse 221/782 
coarse class 2: coarse acc 0.9678012879484821, correct coarse 1052/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.13733075435203096, correct fine 71/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9916467780429594, correct fine 831/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.6154, coarse auc: 0.6586, fine auc: 0.6320 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.4479166666666667, correct coarse 43/96 
coarse class 2: coarse acc 0.917910447761194, correct coarse 123/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.1875, correct fine 12/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9807692307692307, correct fine 102/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6288
Coarse Overall F1 Score: 0.3191
Fine Overall Accuracy: 0.4318
Fine Overall F1 Score: 0.0787

Training for coarse_and_fine level...
batch 100, loss: 1.7696, instance_loss: 0.2362, weighted_loss: 1.3096, label: 5, bag_size: 518
batch 200, loss: 3.3672, instance_loss: 0.2886, weighted_loss: 2.4437, label: 3, bag_size: 1120
batch 300, loss: 4.7251, instance_loss: 0.2678, weighted_loss: 3.3879, label: 8, bag_size: 128
batch 400, loss: 3.1628, instance_loss: 0.3239, weighted_loss: 2.3111, label: 3, bag_size: 1632
batch 500, loss: 3.2394, instance_loss: 0.2676, weighted_loss: 2.3479, label: 3, bag_size: 1046
batch 600, loss: 1.8508, instance_loss: 0.2578, weighted_loss: 1.3729, label: 2, bag_size: 174
batch 700, loss: 1.4658, instance_loss: 0.2081, weighted_loss: 1.0885, label: 5, bag_size: 1555
batch 800, loss: 6.4450, instance_loss: 0.2446, weighted_loss: 4.5849, label: 10, bag_size: 481
batch 900, loss: 2.7897, instance_loss: 0.2388, weighted_loss: 2.0244, label: 6, bag_size: 625
batch 1000, loss: 2.6525, instance_loss: 0.2369, weighted_loss: 1.9278, label: 2, bag_size: 976
batch 1100, loss: 5.1313, instance_loss: 0.2609, weighted_loss: 3.6702, label: 3, bag_size: 486
batch 1200, loss: 1.0667, instance_loss: 0.1843, weighted_loss: 0.8020, label: 5, bag_size: 846
batch 1300, loss: 1.5973, instance_loss: 0.1835, weighted_loss: 1.1732, label: 5, bag_size: 548
batch 1400, loss: 2.3074, instance_loss: 0.2298, weighted_loss: 1.6841, label: 2, bag_size: 1232
batch 1500, loss: 5.9842, instance_loss: 0.2950, weighted_loss: 4.2774, label: 9, bag_size: 335
batch 1600, loss: 2.7891, instance_loss: 0.2518, weighted_loss: 2.0279, label: 2, bag_size: 1663
batch 1700, loss: 2.9896, instance_loss: 0.2176, weighted_loss: 2.1580, label: 6, bag_size: 252
batch 1800, loss: 2.8392, instance_loss: 0.2176, weighted_loss: 2.0527, label: 6, bag_size: 298
batch 1900, loss: 2.1877, instance_loss: 0.2827, weighted_loss: 1.6162, label: 2, bag_size: 748
batch 2000, loss: 2.4240, instance_loss: 0.2406, weighted_loss: 1.7690, label: 2, bag_size: 333
batch 2100, loss: 2.3503, instance_loss: 0.2315, weighted_loss: 1.7147, label: 2, bag_size: 204

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 5, train_loss: 2.6397, train_clustering_loss: 0.2358, train_error: 0.5705
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.4194373401534527, correct coarse 328/782 
coarse class 2: coarse acc 0.9144434222631095, correct coarse 994/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.2379110251450677, correct fine 123/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9653937947494033, correct fine 809/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5788, coarse auc: 0.6701, fine auc: 0.6438 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5, correct coarse 48/96 
coarse class 2: coarse acc 0.917910447761194, correct coarse 123/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.3125, correct fine 20/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9326923076923077, correct fine 97/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3327
Fine Overall Accuracy: 0.4432
Fine Overall F1 Score: 0.0877

Training for coarse_and_fine level...
batch 100, loss: 1.5027, instance_loss: 0.1805, weighted_loss: 1.1060, label: 5, bag_size: 909
batch 200, loss: 1.3253, instance_loss: 0.1829, weighted_loss: 0.9825, label: 5, bag_size: 309
batch 300, loss: 4.9756, instance_loss: 0.2339, weighted_loss: 3.5531, label: 8, bag_size: 461
batch 400, loss: 2.9723, instance_loss: 0.2266, weighted_loss: 2.1485, label: 6, bag_size: 274
batch 500, loss: 1.0588, instance_loss: 0.1658, weighted_loss: 0.7909, label: 5, bag_size: 1137
batch 600, loss: 1.6918, instance_loss: 0.1709, weighted_loss: 1.2355, label: 5, bag_size: 387
batch 700, loss: 2.5101, instance_loss: 0.2369, weighted_loss: 1.8282, label: 6, bag_size: 304
batch 800, loss: 4.4450, instance_loss: 0.2380, weighted_loss: 3.1829, label: 8, bag_size: 65
batch 900, loss: 3.7662, instance_loss: 0.2274, weighted_loss: 2.7046, label: 4, bag_size: 488
batch 1000, loss: 2.2747, instance_loss: 0.2197, weighted_loss: 1.6582, label: 2, bag_size: 989
batch 1100, loss: 1.2112, instance_loss: 0.1527, weighted_loss: 0.8936, label: 5, bag_size: 779
batch 1200, loss: 0.9021, instance_loss: 0.1618, weighted_loss: 0.6800, label: 5, bag_size: 162
batch 1300, loss: 2.7928, instance_loss: 0.1865, weighted_loss: 2.0109, label: 2, bag_size: 675
batch 1400, loss: 1.7502, instance_loss: 0.2159, weighted_loss: 1.2899, label: 2, bag_size: 2948
batch 1500, loss: 1.2859, instance_loss: 0.1697, weighted_loss: 0.9510, label: 5, bag_size: 202
batch 1600, loss: 3.0359, instance_loss: 0.1801, weighted_loss: 2.1792, label: 2, bag_size: 531
batch 1700, loss: 2.1494, instance_loss: 0.1709, weighted_loss: 1.5558, label: 5, bag_size: 1426
batch 1800, loss: 2.0975, instance_loss: 0.1590, weighted_loss: 1.5159, label: 2, bag_size: 940
batch 1900, loss: 2.8687, instance_loss: 0.2235, weighted_loss: 2.0751, label: 6, bag_size: 1004
batch 2000, loss: 0.9897, instance_loss: 0.1619, weighted_loss: 0.7414, label: 5, bag_size: 728
batch 2100, loss: 1.0145, instance_loss: 0.1623, weighted_loss: 0.7588, label: 5, bag_size: 1014

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 6, train_loss: 2.6026, train_clustering_loss: 0.2066, train_error: 0.5502
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.4744245524296675, correct coarse 371/782 
coarse class 2: coarse acc 0.9024839006439742, correct coarse 981/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.3694390715667311, correct fine 191/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9367541766109785, correct fine 785/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5493, coarse auc: 0.6809, fine auc: 0.6528 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5104166666666666, correct coarse 49/96 
coarse class 2: coarse acc 0.8955223880597015, correct coarse 120/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.4375, correct fine 28/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3293
Fine Overall Accuracy: 0.4697
Fine Overall F1 Score: 0.0972

Training for coarse_and_fine level...
batch 100, loss: 1.6457, instance_loss: 0.1668, weighted_loss: 1.2020, label: 5, bag_size: 345
batch 200, loss: 0.7185, instance_loss: 0.1615, weighted_loss: 0.5514, label: 5, bag_size: 651
batch 300, loss: 4.0889, instance_loss: 0.2156, weighted_loss: 2.9269, label: 3, bag_size: 542
batch 400, loss: 0.7886, instance_loss: 0.1343, weighted_loss: 0.5923, label: 5, bag_size: 484
batch 500, loss: 1.4803, instance_loss: 0.1626, weighted_loss: 1.0850, label: 5, bag_size: 138
batch 600, loss: 3.8190, instance_loss: 0.2451, weighted_loss: 2.7469, label: 4, bag_size: 793
batch 700, loss: 1.9962, instance_loss: 0.1779, weighted_loss: 1.4507, label: 5, bag_size: 338
batch 800, loss: 2.9158, instance_loss: 0.2002, weighted_loss: 2.1011, label: 6, bag_size: 739
batch 900, loss: 2.7118, instance_loss: 0.1934, weighted_loss: 1.9563, label: 2, bag_size: 1170
batch 1000, loss: 1.6709, instance_loss: 0.1734, weighted_loss: 1.2217, label: 5, bag_size: 1222
batch 1100, loss: 4.7553, instance_loss: 0.2242, weighted_loss: 3.3959, label: 7, bag_size: 590
batch 1200, loss: 1.7214, instance_loss: 0.1833, weighted_loss: 1.2600, label: 2, bag_size: 223
batch 1300, loss: 2.2320, instance_loss: 0.1998, weighted_loss: 1.6223, label: 2, bag_size: 128
batch 1400, loss: 1.0534, instance_loss: 0.1686, weighted_loss: 0.7879, label: 5, bag_size: 332
batch 1500, loss: 2.0255, instance_loss: 0.1998, weighted_loss: 1.4778, label: 2, bag_size: 900
batch 1600, loss: 2.8079, instance_loss: 0.2096, weighted_loss: 2.0284, label: 6, bag_size: 2046
batch 1700, loss: 1.9302, instance_loss: 0.1915, weighted_loss: 1.4086, label: 2, bag_size: 975
batch 1800, loss: 0.9310, instance_loss: 0.1539, weighted_loss: 0.6978, label: 5, bag_size: 1211
batch 1900, loss: 1.4011, instance_loss: 0.1917, weighted_loss: 1.0383, label: 2, bag_size: 2692
batch 2000, loss: 4.9144, instance_loss: 0.2289, weighted_loss: 3.5088, label: 7, bag_size: 981
batch 2100, loss: 0.8637, instance_loss: 0.1419, weighted_loss: 0.6471, label: 5, bag_size: 238

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 7, train_loss: 2.5694, train_clustering_loss: 0.1934, train_error: 0.5415
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5127877237851662, correct coarse 401/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.43520309477756286, correct fine 225/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.918854415274463, correct fine 770/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5241, coarse auc: 0.6907, fine auc: 0.6630 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5416666666666666, correct coarse 52/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.484375, correct fine 31/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3333
Fine Overall Accuracy: 0.4811
Fine Overall F1 Score: 0.1008

Training for coarse_and_fine level...
batch 100, loss: 2.5862, instance_loss: 0.2307, weighted_loss: 1.8795, label: 3, bag_size: 631
batch 200, loss: 2.9359, instance_loss: 0.1903, weighted_loss: 2.1122, label: 2, bag_size: 282
batch 300, loss: 2.8315, instance_loss: 0.2184, weighted_loss: 2.0476, label: 6, bag_size: 2224
batch 400, loss: 1.5308, instance_loss: 0.1531, weighted_loss: 1.1175, label: 5, bag_size: 703
batch 500, loss: 6.9355, instance_loss: 0.2894, weighted_loss: 4.9417, label: 0, bag_size: 901
batch 600, loss: 1.4570, instance_loss: 0.1859, weighted_loss: 1.0757, label: 2, bag_size: 418
batch 700, loss: 4.8289, instance_loss: 0.2171, weighted_loss: 3.4453, label: 7, bag_size: 179
batch 800, loss: 0.8463, instance_loss: 0.1331, weighted_loss: 0.6324, label: 5, bag_size: 456
batch 900, loss: 0.5652, instance_loss: 0.1422, weighted_loss: 0.4383, label: 5, bag_size: 507
batch 1000, loss: 5.0669, instance_loss: 0.2293, weighted_loss: 3.6156, label: 4, bag_size: 510
batch 1100, loss: 0.8391, instance_loss: 0.1563, weighted_loss: 0.6343, label: 5, bag_size: 328
batch 1200, loss: 5.2389, instance_loss: 0.2128, weighted_loss: 3.7311, label: 7, bag_size: 118
batch 1300, loss: 2.5659, instance_loss: 0.1769, weighted_loss: 1.8492, label: 2, bag_size: 265
batch 1400, loss: 3.0658, instance_loss: 0.2048, weighted_loss: 2.2075, label: 2, bag_size: 360
batch 1500, loss: 0.7264, instance_loss: 0.1465, weighted_loss: 0.5525, label: 5, bag_size: 393
batch 1600, loss: 1.1313, instance_loss: 0.1394, weighted_loss: 0.8337, label: 5, bag_size: 667
batch 1700, loss: 2.1250, instance_loss: 0.2042, weighted_loss: 1.5488, label: 2, bag_size: 555
batch 1800, loss: 1.4466, instance_loss: 0.1386, weighted_loss: 1.0542, label: 5, bag_size: 412
batch 1900, loss: 2.3021, instance_loss: 0.1791, weighted_loss: 1.6652, label: 2, bag_size: 779
batch 2000, loss: 3.7962, instance_loss: 0.2261, weighted_loss: 2.7252, label: 4, bag_size: 324
batch 2100, loss: 0.5883, instance_loss: 0.1274, weighted_loss: 0.4500, label: 5, bag_size: 474

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 8, train_loss: 2.5416, train_clustering_loss: 0.1865, train_error: 0.5433
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5575447570332481, correct coarse 436/782 
coarse class 2: coarse acc 0.8684452621895125, correct coarse 944/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.4622823984526112, correct fine 239/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8973747016706444, correct fine 752/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5021, coarse auc: 0.6968, fine auc: 0.6716 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5520833333333334, correct coarse 53/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3358
Fine Overall Accuracy: 0.4886
Fine Overall F1 Score: 0.1043

Training for coarse_and_fine level...
batch 100, loss: 1.0962, instance_loss: 0.1490, weighted_loss: 0.8120, label: 5, bag_size: 310
batch 200, loss: 0.6739, instance_loss: 0.1443, weighted_loss: 0.5150, label: 5, bag_size: 714
batch 300, loss: 2.4864, instance_loss: 0.1581, weighted_loss: 1.7879, label: 5, bag_size: 336
batch 400, loss: 1.5251, instance_loss: 0.1505, weighted_loss: 1.1127, label: 5, bag_size: 422
batch 500, loss: 2.3969, instance_loss: 0.1710, weighted_loss: 1.7291, label: 5, bag_size: 276
batch 600, loss: 4.8608, instance_loss: 0.2374, weighted_loss: 3.4738, label: 7, bag_size: 681
batch 700, loss: 1.8950, instance_loss: 0.1764, weighted_loss: 1.3794, label: 2, bag_size: 405
batch 800, loss: 7.3912, instance_loss: 0.2516, weighted_loss: 5.2493, label: 1, bag_size: 153
batch 900, loss: 1.0456, instance_loss: 0.1465, weighted_loss: 0.7758, label: 5, bag_size: 322
batch 1000, loss: 1.2252, instance_loss: 0.1490, weighted_loss: 0.9023, label: 5, bag_size: 458
batch 1100, loss: 6.1566, instance_loss: 0.2593, weighted_loss: 4.3874, label: 10, bag_size: 357
batch 1200, loss: 4.7745, instance_loss: 0.2518, weighted_loss: 3.4177, label: 7, bag_size: 229
batch 1300, loss: 2.8641, instance_loss: 0.1763, weighted_loss: 2.0578, label: 2, bag_size: 566
batch 1400, loss: 6.1060, instance_loss: 0.2518, weighted_loss: 4.3497, label: 10, bag_size: 310
batch 1500, loss: 2.0684, instance_loss: 0.1830, weighted_loss: 1.5027, label: 2, bag_size: 3530
batch 1600, loss: 0.8818, instance_loss: 0.1251, weighted_loss: 0.6548, label: 5, bag_size: 817
batch 1700, loss: 3.7740, instance_loss: 0.2127, weighted_loss: 2.7056, label: 8, bag_size: 119
batch 1800, loss: 2.7862, instance_loss: 0.2108, weighted_loss: 2.0136, label: 6, bag_size: 298
batch 1900, loss: 2.6558, instance_loss: 0.1560, weighted_loss: 1.9059, label: 5, bag_size: 519
batch 2000, loss: 4.6101, instance_loss: 0.2208, weighted_loss: 3.2933, label: 8, bag_size: 356
batch 2100, loss: 0.4428, instance_loss: 0.1283, weighted_loss: 0.3484, label: 5, bag_size: 323

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 9, train_loss: 2.5165, train_clustering_loss: 0.1830, train_error: 0.5318
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5805626598465473, correct coarse 454/782 
coarse class 2: coarse acc 0.860165593376265, correct coarse 935/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5145067698259188, correct fine 266/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8949880668257757, correct fine 750/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4833, coarse auc: 0.7019, fine auc: 0.6810 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5416666666666666, correct coarse 52/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3333
Fine Overall Accuracy: 0.4886
Fine Overall F1 Score: 0.1042

Training for coarse_and_fine level...
batch 100, loss: 2.9286, instance_loss: 0.2121, weighted_loss: 2.1137, label: 6, bag_size: 337
batch 200, loss: 3.2957, instance_loss: 0.1736, weighted_loss: 2.3591, label: 2, bag_size: 529
batch 300, loss: 4.7429, instance_loss: 0.2457, weighted_loss: 3.3938, label: 7, bag_size: 1800
batch 400, loss: 1.7340, instance_loss: 0.1791, weighted_loss: 1.2675, label: 2, bag_size: 2154
batch 500, loss: 1.3655, instance_loss: 0.1477, weighted_loss: 1.0001, label: 5, bag_size: 470
batch 600, loss: 1.4169, instance_loss: 0.1684, weighted_loss: 1.0423, label: 2, bag_size: 497
batch 700, loss: 1.9473, instance_loss: 0.1554, weighted_loss: 1.4097, label: 5, bag_size: 639
batch 800, loss: 4.9205, instance_loss: 0.2172, weighted_loss: 3.5095, label: 7, bag_size: 618
batch 900, loss: 0.9510, instance_loss: 0.1224, weighted_loss: 0.7024, label: 5, bag_size: 619
batch 1000, loss: 2.0820, instance_loss: 0.1629, weighted_loss: 1.5063, label: 5, bag_size: 466
batch 1100, loss: 2.3090, instance_loss: 0.2026, weighted_loss: 1.6771, label: 2, bag_size: 235
batch 1200, loss: 1.2564, instance_loss: 0.1416, weighted_loss: 0.9219, label: 5, bag_size: 326
batch 1300, loss: 4.7804, instance_loss: 0.2455, weighted_loss: 3.4199, label: 7, bag_size: 778
batch 1400, loss: 4.8966, instance_loss: 0.2543, weighted_loss: 3.5039, label: 7, bag_size: 132
batch 1500, loss: 2.9557, instance_loss: 0.1999, weighted_loss: 2.1289, label: 6, bag_size: 739
batch 1600, loss: 1.4759, instance_loss: 0.1833, weighted_loss: 1.0881, label: 2, bag_size: 780
batch 1700, loss: 1.9555, instance_loss: 0.2028, weighted_loss: 1.4297, label: 2, bag_size: 526
batch 1800, loss: 3.1572, instance_loss: 0.1785, weighted_loss: 2.2636, label: 2, bag_size: 411
batch 1900, loss: 2.5894, instance_loss: 0.2228, weighted_loss: 1.8794, label: 6, bag_size: 443
batch 2000, loss: 5.2190, instance_loss: 0.2524, weighted_loss: 3.7290, label: 7, bag_size: 479
batch 2100, loss: 5.7827, instance_loss: 0.2463, weighted_loss: 4.1218, label: 7, bag_size: 549

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 10, train_loss: 2.4940, train_clustering_loss: 0.1808, train_error: 0.5341
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5805626598465473, correct coarse 454/782 
coarse class 2: coarse acc 0.8656853725850966, correct coarse 941/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5087040618955513, correct fine 263/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8926014319809069, correct fine 748/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4657, coarse auc: 0.7080, fine auc: 0.6890 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5729166666666666, correct coarse 55/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3368
Fine Overall Accuracy: 0.4848
Fine Overall F1 Score: 0.1030

Training for coarse_and_fine level...
batch 100, loss: 3.2046, instance_loss: 0.2180, weighted_loss: 2.3086, label: 6, bag_size: 2033
batch 200, loss: 3.8989, instance_loss: 0.2254, weighted_loss: 2.7968, label: 8, bag_size: 487
batch 300, loss: 2.6567, instance_loss: 0.1865, weighted_loss: 1.9157, label: 6, bag_size: 334
batch 400, loss: 0.6886, instance_loss: 0.1266, weighted_loss: 0.5200, label: 5, bag_size: 632
batch 500, loss: 0.8386, instance_loss: 0.1408, weighted_loss: 0.6293, label: 5, bag_size: 168
batch 600, loss: 3.0226, instance_loss: 0.2105, weighted_loss: 2.1790, label: 6, bag_size: 861
batch 700, loss: 4.7742, instance_loss: 0.2517, weighted_loss: 3.4174, label: 7, bag_size: 229
batch 800, loss: 3.1217, instance_loss: 0.2181, weighted_loss: 2.2506, label: 6, bag_size: 614
batch 900, loss: 0.5079, instance_loss: 0.1183, weighted_loss: 0.3910, label: 5, bag_size: 602
batch 1000, loss: 4.8736, instance_loss: 0.2344, weighted_loss: 3.4818, label: 7, bag_size: 618
batch 1100, loss: 4.5385, instance_loss: 0.2280, weighted_loss: 3.2453, label: 7, bag_size: 888
batch 1200, loss: 2.9807, instance_loss: 0.2093, weighted_loss: 2.1493, label: 6, bag_size: 527
batch 1300, loss: 3.3852, instance_loss: 0.1708, weighted_loss: 2.4209, label: 2, bag_size: 529
batch 1400, loss: 1.8085, instance_loss: 0.1671, weighted_loss: 1.3161, label: 2, bag_size: 1918
batch 1500, loss: 3.0525, instance_loss: 0.2276, weighted_loss: 2.2050, label: 4, bag_size: 88
batch 1600, loss: 4.4385, instance_loss: 0.2457, weighted_loss: 3.1807, label: 7, bag_size: 850
batch 1700, loss: 2.4718, instance_loss: 0.2096, weighted_loss: 1.7931, label: 3, bag_size: 2842
batch 1800, loss: 3.1514, instance_loss: 0.2278, weighted_loss: 2.2743, label: 4, bag_size: 2219
batch 1900, loss: 1.2077, instance_loss: 0.1632, weighted_loss: 0.8944, label: 2, bag_size: 409
batch 2000, loss: 2.3903, instance_loss: 0.1566, weighted_loss: 1.7202, label: 5, bag_size: 506
batch 2100, loss: 0.2361, instance_loss: 0.1074, weighted_loss: 0.1975, label: 5, bag_size: 169

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 11, train_loss: 2.4732, train_clustering_loss: 0.1792, train_error: 0.5281
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6086956521739131, correct coarse 476/782 
coarse class 2: coarse acc 0.8555657773689053, correct coarse 930/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5551257253384912, correct fine 287/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8794749403341289, correct fine 737/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4496, coarse auc: 0.7131, fine auc: 0.6938 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.59375, correct coarse 57/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3397
Fine Overall Accuracy: 0.4886
Fine Overall F1 Score: 0.1041

Training for coarse_and_fine level...
batch 100, loss: 5.3586, instance_loss: 0.2316, weighted_loss: 3.8205, label: 8, bag_size: 233
batch 200, loss: 0.7758, instance_loss: 0.1096, weighted_loss: 0.5760, label: 5, bag_size: 844
batch 300, loss: 2.6447, instance_loss: 0.2027, weighted_loss: 1.9121, label: 6, bag_size: 334
batch 400, loss: 3.7886, instance_loss: 0.2117, weighted_loss: 2.7155, label: 8, bag_size: 128
batch 500, loss: 1.4318, instance_loss: 0.1404, weighted_loss: 1.0443, label: 5, bag_size: 258
batch 600, loss: 1.3108, instance_loss: 0.1372, weighted_loss: 0.9587, label: 5, bag_size: 873
batch 700, loss: 1.2193, instance_loss: 0.1445, weighted_loss: 0.8969, label: 5, bag_size: 148
batch 800, loss: 7.8566, instance_loss: 0.2519, weighted_loss: 5.5752, label: 7, bag_size: 868
batch 900, loss: 2.6351, instance_loss: 0.2359, weighted_loss: 1.9153, label: 4, bag_size: 1333
batch 1000, loss: 2.3204, instance_loss: 0.1454, weighted_loss: 1.6679, label: 5, bag_size: 202
batch 1100, loss: 4.3967, instance_loss: 0.2481, weighted_loss: 3.1522, label: 7, bag_size: 111
batch 1200, loss: 4.3215, instance_loss: 0.2399, weighted_loss: 3.0970, label: 3, bag_size: 1134
batch 1300, loss: 4.0499, instance_loss: 0.2258, weighted_loss: 2.9027, label: 4, bag_size: 424
batch 1400, loss: 1.5295, instance_loss: 0.1212, weighted_loss: 1.1070, label: 5, bag_size: 788
batch 1500, loss: 2.8287, instance_loss: 0.1888, weighted_loss: 2.0367, label: 2, bag_size: 976
batch 1600, loss: 3.4545, instance_loss: 0.1856, weighted_loss: 2.4739, label: 2, bag_size: 167
batch 1700, loss: 3.1013, instance_loss: 0.2117, weighted_loss: 2.2344, label: 3, bag_size: 375
batch 1800, loss: 2.7872, instance_loss: 0.1890, weighted_loss: 2.0077, label: 2, bag_size: 332
batch 1900, loss: 0.7792, instance_loss: 0.1319, weighted_loss: 0.5851, label: 5, bag_size: 429
batch 2000, loss: 0.5709, instance_loss: 0.1238, weighted_loss: 0.4367, label: 5, bag_size: 446
batch 2100, loss: 0.8365, instance_loss: 0.1198, weighted_loss: 0.6215, label: 5, bag_size: 209

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0001152073732718894: correct 2/17360

Epoch: 12, train_loss: 2.4542, train_clustering_loss: 0.1782, train_error: 0.5290
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6048593350383632, correct coarse 473/782 
coarse class 2: coarse acc 0.8537258509659613, correct coarse 928/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5493230174081238, correct fine 284/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8806682577565632, correct fine 738/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4352, coarse auc: 0.7179, fine auc: 0.7011 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3383
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1056

Training for coarse_and_fine level...
batch 100, loss: 2.1156, instance_loss: 0.1753, weighted_loss: 1.5335, label: 2, bag_size: 1124
batch 200, loss: 0.6722, instance_loss: 0.1244, weighted_loss: 0.5078, label: 5, bag_size: 632
batch 300, loss: 2.8565, instance_loss: 0.2188, weighted_loss: 2.0652, label: 3, bag_size: 459
batch 400, loss: 2.7654, instance_loss: 0.2036, weighted_loss: 1.9969, label: 6, bag_size: 402
batch 500, loss: 2.4276, instance_loss: 0.2213, weighted_loss: 1.7657, label: 6, bag_size: 461
batch 600, loss: 2.5354, instance_loss: 0.1976, weighted_loss: 1.8340, label: 6, bag_size: 580
batch 700, loss: 5.0454, instance_loss: 0.2092, weighted_loss: 3.5946, label: 8, bag_size: 243
batch 800, loss: 0.3345, instance_loss: 0.1241, weighted_loss: 0.2714, label: 5, bag_size: 288
batch 900, loss: 3.7280, instance_loss: 0.2265, weighted_loss: 2.6776, label: 3, bag_size: 98
batch 1000, loss: 1.1382, instance_loss: 0.1209, weighted_loss: 0.8330, label: 5, bag_size: 620
batch 1100, loss: 1.0916, instance_loss: 0.1247, weighted_loss: 0.8015, label: 5, bag_size: 636
batch 1200, loss: 0.6819, instance_loss: 0.1109, weighted_loss: 0.5106, label: 5, bag_size: 1137
batch 1300, loss: 2.8395, instance_loss: 0.2094, weighted_loss: 2.0504, label: 6, bag_size: 1122
batch 1400, loss: 2.6220, instance_loss: 0.2024, weighted_loss: 1.8961, label: 6, bag_size: 280
batch 1500, loss: 1.1946, instance_loss: 0.1206, weighted_loss: 0.8724, label: 5, bag_size: 588
batch 1600, loss: 2.5282, instance_loss: 0.2268, weighted_loss: 1.8378, label: 6, bag_size: 481
batch 1700, loss: 3.1444, instance_loss: 0.2125, weighted_loss: 2.2648, label: 6, bag_size: 1836
batch 1800, loss: 6.7066, instance_loss: 0.2925, weighted_loss: 4.7824, label: 10, bag_size: 335
batch 1900, loss: 2.5328, instance_loss: 0.2219, weighted_loss: 1.8396, label: 6, bag_size: 368
batch 2000, loss: 1.7090, instance_loss: 0.1719, weighted_loss: 1.2479, label: 2, bag_size: 374
batch 2100, loss: 5.1685, instance_loss: 0.2449, weighted_loss: 3.6914, label: 8, bag_size: 153

Instance Classifier Stats
class 0 clustering acc 0.9999923195084486: correct 260398/260400
class 1 clustering acc 0.0001728110599078341: correct 3/17360

Epoch: 13, train_loss: 2.4377, train_clustering_loss: 0.1776, train_error: 0.5226
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.8445262189512419, correct coarse 918/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5957446808510638, correct fine 308/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8687350835322196, correct fine 728/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4210, coarse auc: 0.7222, fine auc: 0.7069 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3391
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1053

Training for coarse_and_fine level...
batch 100, loss: 1.6051, instance_loss: 0.1550, weighted_loss: 1.1701, label: 2, bag_size: 1264
batch 200, loss: 1.6861, instance_loss: 0.1737, weighted_loss: 1.2324, label: 2, bag_size: 936
batch 300, loss: 2.5394, instance_loss: 0.2092, weighted_loss: 1.8403, label: 6, bag_size: 669
batch 400, loss: 1.2760, instance_loss: 0.1652, weighted_loss: 0.9428, label: 2, bag_size: 2220
batch 500, loss: 2.5815, instance_loss: 0.2238, weighted_loss: 1.8742, label: 3, bag_size: 605
batch 600, loss: 2.7992, instance_loss: 0.1742, weighted_loss: 2.0117, label: 2, bag_size: 241
batch 700, loss: 1.6626, instance_loss: 0.1728, weighted_loss: 1.2157, label: 2, bag_size: 1918
batch 800, loss: 0.6127, instance_loss: 0.1194, weighted_loss: 0.4647, label: 5, bag_size: 463
batch 900, loss: 2.4981, instance_loss: 0.2226, weighted_loss: 1.8154, label: 6, bag_size: 555
batch 1000, loss: 1.7275, instance_loss: 0.1185, weighted_loss: 1.2448, label: 5, bag_size: 609
batch 1100, loss: 7.4963, instance_loss: 0.2574, weighted_loss: 5.3246, label: 3, bag_size: 477
batch 1200, loss: 1.0314, instance_loss: 0.1399, weighted_loss: 0.7639, label: 5, bag_size: 333
batch 1300, loss: 1.9760, instance_loss: 0.1187, weighted_loss: 1.4188, label: 5, bag_size: 1462
batch 1400, loss: 0.7882, instance_loss: 0.1254, weighted_loss: 0.5894, label: 5, bag_size: 235
batch 1500, loss: 2.3534, instance_loss: 0.1866, weighted_loss: 1.7033, label: 2, bag_size: 762
batch 1600, loss: 3.1156, instance_loss: 0.1613, weighted_loss: 2.2293, label: 5, bag_size: 325
batch 1700, loss: 0.8197, instance_loss: 0.1079, weighted_loss: 0.6062, label: 5, bag_size: 229
batch 1800, loss: 2.5791, instance_loss: 0.2092, weighted_loss: 1.8681, label: 6, bag_size: 526
batch 1900, loss: 2.3376, instance_loss: 0.1699, weighted_loss: 1.6873, label: 2, bag_size: 435
batch 2000, loss: 1.7064, instance_loss: 0.1724, weighted_loss: 1.2462, label: 2, bag_size: 666
batch 2100, loss: 1.7880, instance_loss: 0.1365, weighted_loss: 1.2926, label: 5, bag_size: 253

Instance Classifier Stats
class 0 clustering acc 0.999984639016897: correct 260396/260400
class 1 clustering acc 0.0004608294930875576: correct 8/17360

Epoch: 14, train_loss: 2.4210, train_clustering_loss: 0.1771, train_error: 0.5230
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.8399264029438822, correct coarse 913/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8627684964200477, correct fine 723/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4085, coarse auc: 0.7253, fine auc: 0.7127 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3397
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1053

Training for coarse_and_fine level...
batch 100, loss: 2.7664, instance_loss: 0.2061, weighted_loss: 1.9983, label: 6, bag_size: 414
batch 200, loss: 4.2988, instance_loss: 0.2164, weighted_loss: 3.0741, label: 7, bag_size: 120
batch 300, loss: 2.3263, instance_loss: 0.2060, weighted_loss: 1.6902, label: 3, bag_size: 1692
batch 400, loss: 4.3714, instance_loss: 0.2164, weighted_loss: 3.1249, label: 7, bag_size: 609
batch 500, loss: 1.3189, instance_loss: 0.1198, weighted_loss: 0.9591, label: 5, bag_size: 480
batch 600, loss: 2.8107, instance_loss: 0.2305, weighted_loss: 2.0366, label: 4, bag_size: 584
batch 700, loss: 0.5462, instance_loss: 0.1018, weighted_loss: 0.4128, label: 5, bag_size: 600
batch 800, loss: 0.8106, instance_loss: 0.1213, weighted_loss: 0.6038, label: 5, bag_size: 298
batch 900, loss: 0.3110, instance_loss: 0.1188, weighted_loss: 0.2534, label: 5, bag_size: 383
batch 1000, loss: 7.0226, instance_loss: 0.2485, weighted_loss: 4.9904, label: 1, bag_size: 320
batch 1100, loss: 1.2000, instance_loss: 0.1603, weighted_loss: 0.8881, label: 2, bag_size: 334
batch 1200, loss: 0.7260, instance_loss: 0.1384, weighted_loss: 0.5497, label: 5, bag_size: 168
batch 1300, loss: 2.3944, instance_loss: 0.2138, weighted_loss: 1.7402, label: 6, bag_size: 562
batch 1400, loss: 0.6726, instance_loss: 0.1634, weighted_loss: 0.5198, label: 2, bag_size: 714
batch 1500, loss: 2.3896, instance_loss: 0.2013, weighted_loss: 1.7331, label: 6, bag_size: 523
batch 1600, loss: 2.4662, instance_loss: 0.1631, weighted_loss: 1.7753, label: 5, bag_size: 968
batch 1700, loss: 2.4370, instance_loss: 0.2417, weighted_loss: 1.7784, label: 6, bag_size: 1235
batch 1800, loss: 7.8234, instance_loss: 0.2484, weighted_loss: 5.5509, label: 7, bag_size: 378
batch 1900, loss: 1.6930, instance_loss: 0.1555, weighted_loss: 1.2317, label: 2, bag_size: 1104
batch 2000, loss: 1.3871, instance_loss: 0.1384, weighted_loss: 1.0125, label: 5, bag_size: 258
batch 2100, loss: 2.6995, instance_loss: 0.2188, weighted_loss: 1.9553, label: 6, bag_size: 436

Instance Classifier Stats
class 0 clustering acc 0.9999807987711213: correct 260395/260400
class 1 clustering acc 0.0007488479262672812: correct 13/17360

Epoch: 15, train_loss: 2.4065, train_clustering_loss: 0.1762, train_error: 0.5194
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8472861085556578, correct coarse 921/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6092843326885881, correct fine 315/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8687350835322196, correct fine 728/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3965, coarse auc: 0.7326, fine auc: 0.7174 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3403
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1053

Training for coarse_and_fine level...
batch 100, loss: 1.8207, instance_loss: 0.1448, weighted_loss: 1.3180, label: 5, bag_size: 599
batch 200, loss: 0.2425, instance_loss: 0.0950, weighted_loss: 0.1983, label: 5, bag_size: 679
batch 300, loss: 2.4718, instance_loss: 0.2081, weighted_loss: 1.7927, label: 4, bag_size: 728
batch 400, loss: 1.2397, instance_loss: 0.1269, weighted_loss: 0.9058, label: 5, bag_size: 148
batch 500, loss: 3.3325, instance_loss: 0.2326, weighted_loss: 2.4025, label: 8, bag_size: 120
batch 600, loss: 2.8404, instance_loss: 0.2521, weighted_loss: 2.0639, label: 4, bag_size: 505
batch 700, loss: 2.4006, instance_loss: 0.1888, weighted_loss: 1.7370, label: 2, bag_size: 861
batch 800, loss: 2.2550, instance_loss: 0.1638, weighted_loss: 1.6277, label: 5, bag_size: 482
batch 900, loss: 7.6550, instance_loss: 0.2681, weighted_loss: 5.4389, label: 1, bag_size: 68
batch 1000, loss: 3.5781, instance_loss: 0.2323, weighted_loss: 2.5744, label: 3, bag_size: 1678
batch 1100, loss: 0.2659, instance_loss: 0.1063, weighted_loss: 0.2180, label: 5, bag_size: 474
batch 1200, loss: 0.6302, instance_loss: 0.1162, weighted_loss: 0.4760, label: 5, bag_size: 679
batch 1300, loss: 1.9746, instance_loss: 0.1342, weighted_loss: 1.4225, label: 5, bag_size: 658
batch 1400, loss: 8.6774, instance_loss: 0.3212, weighted_loss: 6.1706, label: 1, bag_size: 440
batch 1500, loss: 0.8414, instance_loss: 0.1439, weighted_loss: 0.6322, label: 2, bag_size: 248
batch 1600, loss: 1.1566, instance_loss: 0.1410, weighted_loss: 0.8519, label: 5, bag_size: 460
batch 1700, loss: 3.2386, instance_loss: 0.1722, weighted_loss: 2.3187, label: 2, bag_size: 371
batch 1800, loss: 4.4744, instance_loss: 0.2316, weighted_loss: 3.2016, label: 3, bag_size: 1134
batch 1900, loss: 1.2792, instance_loss: 0.1391, weighted_loss: 0.9372, label: 2, bag_size: 981
batch 2000, loss: 2.6496, instance_loss: 0.2008, weighted_loss: 1.9150, label: 6, bag_size: 424
batch 2100, loss: 3.2441, instance_loss: 0.1712, weighted_loss: 2.3222, label: 2, bag_size: 217

Instance Classifier Stats
class 0 clustering acc 0.9999615975422427: correct 260390/260400
class 1 clustering acc 0.0008064516129032258: correct 14/17360

Epoch: 16, train_loss: 2.3928, train_clustering_loss: 0.1757, train_error: 0.5217
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.84360625574977, correct coarse 917/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6092843326885881, correct fine 315/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8627684964200477, correct fine 723/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3851, coarse auc: 0.7361, fine auc: 0.7204 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.59375, correct coarse 57/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3399
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1063

Training for coarse_and_fine level...
batch 100, loss: 7.0558, instance_loss: 0.3662, weighted_loss: 5.0489, label: 9, bag_size: 1001
batch 200, loss: 0.5769, instance_loss: 0.1088, weighted_loss: 0.4365, label: 5, bag_size: 405
batch 300, loss: 1.2007, instance_loss: 0.1616, weighted_loss: 0.8890, label: 2, bag_size: 1374
batch 400, loss: 4.0555, instance_loss: 0.2092, weighted_loss: 2.9016, label: 7, bag_size: 479
batch 500, loss: 2.4872, instance_loss: 0.1796, weighted_loss: 1.7949, label: 6, bag_size: 453
batch 600, loss: 3.8247, instance_loss: 0.2222, weighted_loss: 2.7439, label: 8, bag_size: 541
batch 700, loss: 0.6610, instance_loss: 0.1236, weighted_loss: 0.4998, label: 5, bag_size: 229
batch 800, loss: 1.5664, instance_loss: 0.1303, weighted_loss: 1.1356, label: 5, bag_size: 462
batch 900, loss: 3.5113, instance_loss: 0.2183, weighted_loss: 2.5234, label: 3, bag_size: 185
batch 1000, loss: 1.9720, instance_loss: 0.1819, weighted_loss: 1.4350, label: 2, bag_size: 235
batch 1100, loss: 1.5779, instance_loss: 0.1144, weighted_loss: 1.1388, label: 5, bag_size: 624
batch 1200, loss: 4.0001, instance_loss: 0.2237, weighted_loss: 2.8672, label: 8, bag_size: 79
batch 1300, loss: 0.7009, instance_loss: 0.1113, weighted_loss: 0.5240, label: 5, bag_size: 468
batch 1400, loss: 2.4222, instance_loss: 0.2082, weighted_loss: 1.7580, label: 4, bag_size: 454
batch 1500, loss: 2.5623, instance_loss: 0.2050, weighted_loss: 1.8552, label: 6, bag_size: 435
batch 1600, loss: 6.2189, instance_loss: 0.2503, weighted_loss: 4.4283, label: 1, bag_size: 113
batch 1700, loss: 0.2846, instance_loss: 0.1150, weighted_loss: 0.2337, label: 5, bag_size: 329
batch 1800, loss: 1.4106, instance_loss: 0.1248, weighted_loss: 1.0249, label: 5, bag_size: 721
batch 1900, loss: 0.6814, instance_loss: 0.1031, weighted_loss: 0.5079, label: 5, bag_size: 688
batch 2000, loss: 1.3176, instance_loss: 0.1155, weighted_loss: 0.9569, label: 5, bag_size: 1250
batch 2100, loss: 2.8949, instance_loss: 0.2089, weighted_loss: 2.0891, label: 6, bag_size: 222

Instance Classifier Stats
class 0 clustering acc 0.9999539170506913: correct 260388/260400
class 1 clustering acc 0.0014400921658986176: correct 25/17360

Epoch: 17, train_loss: 2.3796, train_clustering_loss: 0.1749, train_error: 0.5184
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.8426862925482981, correct coarse 916/1087 
coarse class 3: coarse acc 0.007782101167315175, correct coarse 2/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6092843326885881, correct fine 315/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8711217183770883, correct fine 730/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3744, coarse auc: 0.7398, fine auc: 0.7247 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3391
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1054

Training for coarse_and_fine level...
batch 100, loss: 1.1250, instance_loss: 0.1496, weighted_loss: 0.8324, label: 2, bag_size: 1099
batch 200, loss: 1.3831, instance_loss: 0.1260, weighted_loss: 1.0060, label: 5, bag_size: 258
batch 300, loss: 2.7423, instance_loss: 0.2415, weighted_loss: 1.9921, label: 3, bag_size: 1087
batch 400, loss: 2.7319, instance_loss: 0.2076, weighted_loss: 1.9746, label: 6, bag_size: 284
batch 500, loss: 1.6220, instance_loss: 0.1668, weighted_loss: 1.1854, label: 2, bag_size: 618
batch 600, loss: 0.7697, instance_loss: 0.1066, weighted_loss: 0.5708, label: 5, bag_size: 475
batch 700, loss: 2.7779, instance_loss: 0.1415, weighted_loss: 1.9870, label: 5, bag_size: 663
batch 800, loss: 3.1825, instance_loss: 0.1865, weighted_loss: 2.2837, label: 2, bag_size: 260
batch 900, loss: 2.2003, instance_loss: 0.2304, weighted_loss: 1.6093, label: 4, bag_size: 559
batch 1000, loss: 2.0060, instance_loss: 0.1676, weighted_loss: 1.4545, label: 2, bag_size: 183
batch 1100, loss: 2.8905, instance_loss: 0.2200, weighted_loss: 2.0893, label: 6, bag_size: 416
batch 1200, loss: 3.3689, instance_loss: 0.1661, weighted_loss: 2.4080, label: 2, bag_size: 209
batch 1300, loss: 0.8962, instance_loss: 0.1075, weighted_loss: 0.6596, label: 5, bag_size: 892
batch 1400, loss: 3.7914, instance_loss: 0.1806, weighted_loss: 2.7082, label: 5, bag_size: 294
batch 1500, loss: 0.9166, instance_loss: 0.1115, weighted_loss: 0.6751, label: 5, bag_size: 784
batch 1600, loss: 2.9203, instance_loss: 0.2003, weighted_loss: 2.1043, label: 2, bag_size: 946
batch 1700, loss: 0.6627, instance_loss: 0.1122, weighted_loss: 0.4976, label: 5, bag_size: 573
batch 1800, loss: 2.0381, instance_loss: 0.1626, weighted_loss: 1.4754, label: 5, bag_size: 299
batch 1900, loss: 1.2287, instance_loss: 0.1295, weighted_loss: 0.8989, label: 2, bag_size: 192
batch 2000, loss: 3.2771, instance_loss: 0.2054, weighted_loss: 2.3556, label: 8, bag_size: 65
batch 2100, loss: 4.5357, instance_loss: 0.2476, weighted_loss: 3.2493, label: 8, bag_size: 276

Instance Classifier Stats
class 0 clustering acc 0.9999385560675883: correct 260384/260400
class 1 clustering acc 0.002534562211981567: correct 44/17360

Epoch: 18, train_loss: 2.3673, train_clustering_loss: 0.1741, train_error: 0.5147
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6521739130434783, correct coarse 510/782 
coarse class 2: coarse acc 0.8426862925482981, correct coarse 916/1087 
coarse class 3: coarse acc 0.007782101167315175, correct coarse 2/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6382978723404256, correct fine 330/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8627684964200477, correct fine 723/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3641, coarse auc: 0.7456, fine auc: 0.7290 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3413
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1062

Training for coarse_and_fine level...
batch 100, loss: 0.7721, instance_loss: 0.1104, weighted_loss: 0.5735, label: 5, bag_size: 339
batch 200, loss: 3.0422, instance_loss: 0.1577, weighted_loss: 2.1768, label: 5, bag_size: 519
batch 300, loss: 1.8654, instance_loss: 0.1493, weighted_loss: 1.3506, label: 5, bag_size: 315
batch 400, loss: 1.9149, instance_loss: 0.1737, weighted_loss: 1.3925, label: 2, bag_size: 1234
batch 500, loss: 3.7894, instance_loss: 0.2111, weighted_loss: 2.7159, label: 8, bag_size: 478
batch 600, loss: 0.3924, instance_loss: 0.1118, weighted_loss: 0.3082, label: 5, bag_size: 305
batch 700, loss: 3.4099, instance_loss: 0.2211, weighted_loss: 2.4533, label: 6, bag_size: 2033
batch 800, loss: 3.2581, instance_loss: 0.2053, weighted_loss: 2.3422, label: 6, bag_size: 219
batch 900, loss: 1.7911, instance_loss: 0.1385, weighted_loss: 1.2953, label: 5, bag_size: 448
batch 1000, loss: 1.6898, instance_loss: 0.1751, weighted_loss: 1.2354, label: 2, bag_size: 1423
batch 1100, loss: 4.2057, instance_loss: 0.2637, weighted_loss: 3.0231, label: 4, bag_size: 37
batch 1200, loss: 2.1245, instance_loss: 0.1507, weighted_loss: 1.5323, label: 5, bag_size: 466
batch 1300, loss: 4.9726, instance_loss: 0.2686, weighted_loss: 3.5614, label: 8, bag_size: 876
batch 1400, loss: 2.6722, instance_loss: 0.2260, weighted_loss: 1.9383, label: 4, bag_size: 1424
batch 1500, loss: 1.3417, instance_loss: 0.1796, weighted_loss: 0.9931, label: 2, bag_size: 1229
batch 1600, loss: 2.9588, instance_loss: 0.2307, weighted_loss: 2.1403, label: 3, bag_size: 807
batch 1700, loss: 0.4492, instance_loss: 0.1032, weighted_loss: 0.3454, label: 5, bag_size: 619
batch 1800, loss: 2.6470, instance_loss: 0.2270, weighted_loss: 1.9210, label: 3, bag_size: 1120
batch 1900, loss: 0.3441, instance_loss: 0.1000, weighted_loss: 0.2708, label: 5, bag_size: 700
batch 2000, loss: 2.6279, instance_loss: 0.2500, weighted_loss: 1.9145, label: 4, bag_size: 505
batch 2100, loss: 2.6961, instance_loss: 0.1663, weighted_loss: 1.9371, label: 2, bag_size: 328

Instance Classifier Stats
class 0 clustering acc 0.9999231950844855: correct 260380/260400
class 1 clustering acc 0.0029953917050691246: correct 52/17360

Epoch: 19, train_loss: 2.3551, train_clustering_loss: 0.1737, train_error: 0.5147
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6457800511508951, correct coarse 505/782 
coarse class 2: coarse acc 0.8454461821527139, correct coarse 919/1087 
coarse class 3: coarse acc 0.011673151750972763, correct coarse 3/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6344294003868471, correct fine 328/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8651551312649165, correct fine 725/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3547, coarse auc: 0.7487, fine auc: 0.7329 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3419
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1062

Training for coarse_and_fine level...
batch 100, loss: 0.8621, instance_loss: 0.1741, weighted_loss: 0.6557, label: 2, bag_size: 2948
batch 200, loss: 0.2631, instance_loss: 0.1042, weighted_loss: 0.2154, label: 5, bag_size: 439
batch 300, loss: 1.6122, instance_loss: 0.1281, weighted_loss: 1.1670, label: 5, bag_size: 595
batch 400, loss: 0.7675, instance_loss: 0.1120, weighted_loss: 0.5709, label: 5, bag_size: 714
batch 500, loss: 3.4130, instance_loss: 0.2170, weighted_loss: 2.4542, label: 3, bag_size: 106
batch 600, loss: 2.6347, instance_loss: 0.2304, weighted_loss: 1.9134, label: 6, bag_size: 476
batch 700, loss: 0.5798, instance_loss: 0.1028, weighted_loss: 0.4367, label: 5, bag_size: 2663
batch 800, loss: 3.4683, instance_loss: 0.2163, weighted_loss: 2.4927, label: 3, bag_size: 175
batch 900, loss: 2.2204, instance_loss: 0.1658, weighted_loss: 1.6040, label: 5, bag_size: 368
batch 1000, loss: 4.8899, instance_loss: 0.2599, weighted_loss: 3.5009, label: 7, bag_size: 945
batch 1100, loss: 2.1753, instance_loss: 0.1659, weighted_loss: 1.5725, label: 5, bag_size: 471
batch 1200, loss: 0.2215, instance_loss: 0.0887, weighted_loss: 0.1816, label: 5, bag_size: 686
batch 1300, loss: 4.1275, instance_loss: 0.1882, weighted_loss: 2.9457, label: 2, bag_size: 823
batch 1400, loss: 0.7120, instance_loss: 0.1410, weighted_loss: 0.5407, label: 2, bag_size: 1535
batch 1500, loss: 0.2223, instance_loss: 0.1084, weighted_loss: 0.1881, label: 5, bag_size: 383
batch 1600, loss: 1.8786, instance_loss: 0.1465, weighted_loss: 1.3590, label: 2, bag_size: 333
batch 1700, loss: 1.2583, instance_loss: 0.1762, weighted_loss: 0.9337, label: 2, bag_size: 2627
batch 1800, loss: 0.1832, instance_loss: 0.0944, weighted_loss: 0.1565, label: 5, bag_size: 338
batch 1900, loss: 3.9967, instance_loss: 0.2286, weighted_loss: 2.8663, label: 3, bag_size: 952
batch 2000, loss: 3.7638, instance_loss: 0.2150, weighted_loss: 2.6991, label: 3, bag_size: 477
batch 2100, loss: 0.2561, instance_loss: 0.1056, weighted_loss: 0.2110, label: 5, bag_size: 745

Instance Classifier Stats
class 0 clustering acc 0.9999155145929339: correct 260378/260400
class 1 clustering acc 0.004608294930875576: correct 80/17360

Epoch: 20, train_loss: 2.3445, train_clustering_loss: 0.1733, train_error: 0.5152
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8408463661453542, correct coarse 914/1087 
coarse class 3: coarse acc 0.007782101167315175, correct coarse 2/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.632495164410058, correct fine 327/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8651551312649165, correct fine 725/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3454, coarse auc: 0.7510, fine auc: 0.7353 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3434
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1062

Training for coarse_and_fine level...
batch 100, loss: 1.1311, instance_loss: 0.0888, weighted_loss: 0.8184, label: 5, bag_size: 1000
batch 200, loss: 4.1354, instance_loss: 0.2010, weighted_loss: 2.9551, label: 2, bag_size: 738
batch 300, loss: 2.8872, instance_loss: 0.2280, weighted_loss: 2.0894, label: 4, bag_size: 225
batch 400, loss: 4.9024, instance_loss: 0.2322, weighted_loss: 3.5013, label: 3, bag_size: 953
batch 500, loss: 2.6624, instance_loss: 0.2120, weighted_loss: 1.9273, label: 3, bag_size: 942
batch 600, loss: 6.8630, instance_loss: 0.3092, weighted_loss: 4.8969, label: 10, bag_size: 264
batch 700, loss: 2.2398, instance_loss: 0.1569, weighted_loss: 1.6149, label: 5, bag_size: 206
batch 800, loss: 1.2578, instance_loss: 0.1801, weighted_loss: 0.9345, label: 2, bag_size: 1803
batch 900, loss: 2.5597, instance_loss: 0.1701, weighted_loss: 1.8428, label: 5, bag_size: 741
batch 1000, loss: 0.6683, instance_loss: 0.0883, weighted_loss: 0.4943, label: 5, bag_size: 658
batch 1100, loss: 1.0530, instance_loss: 0.1283, weighted_loss: 0.7756, label: 5, bag_size: 333
batch 1200, loss: 0.3641, instance_loss: 0.0936, weighted_loss: 0.2829, label: 5, bag_size: 462
batch 1300, loss: 2.6449, instance_loss: 0.1833, weighted_loss: 1.9064, label: 2, bag_size: 976
batch 1400, loss: 4.8663, instance_loss: 0.2616, weighted_loss: 3.4849, label: 8, bag_size: 457
batch 1500, loss: 3.9833, instance_loss: 0.2053, weighted_loss: 2.8499, label: 3, bag_size: 401
batch 1600, loss: 0.9719, instance_loss: 0.1522, weighted_loss: 0.7260, label: 2, bag_size: 497
batch 1700, loss: 3.4119, instance_loss: 0.2281, weighted_loss: 2.4568, label: 8, bag_size: 487
batch 1800, loss: 0.1654, instance_loss: 0.1023, weighted_loss: 0.1465, label: 5, bag_size: 223
batch 1900, loss: 2.0606, instance_loss: 0.1813, weighted_loss: 1.4968, label: 5, bag_size: 1165
batch 2000, loss: 0.4468, instance_loss: 0.1075, weighted_loss: 0.3450, label: 5, bag_size: 385
batch 2100, loss: 4.3277, instance_loss: 0.2621, weighted_loss: 3.1080, label: 4, bag_size: 525

Instance Classifier Stats
class 0 clustering acc 0.999900153609831: correct 260374/260400
class 1 clustering acc 0.006336405529953917: correct 110/17360

Epoch: 21, train_loss: 2.3339, train_clustering_loss: 0.1729, train_error: 0.5129
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6508951406649617, correct coarse 509/782 
coarse class 2: coarse acc 0.8454461821527139, correct coarse 919/1087 
coarse class 3: coarse acc 0.011673151750972763, correct coarse 3/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6460348162475822, correct fine 334/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8627684964200477, correct fine 723/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3369, coarse auc: 0.7536, fine auc: 0.7359 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0004734848484848485: correct 1/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3458
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1066

Training for coarse_and_fine level...
batch 100, loss: 2.2672, instance_loss: 0.2156, weighted_loss: 1.6517, label: 3, bag_size: 945
batch 200, loss: 2.2199, instance_loss: 0.1473, weighted_loss: 1.5981, label: 2, bag_size: 1360
batch 300, loss: 1.8170, instance_loss: 0.1594, weighted_loss: 1.3197, label: 2, bag_size: 2104
batch 400, loss: 0.4598, instance_loss: 0.1074, weighted_loss: 0.3541, label: 5, bag_size: 221
batch 500, loss: 3.0831, instance_loss: 0.2109, weighted_loss: 2.2214, label: 3, bag_size: 483
batch 600, loss: 2.4983, instance_loss: 0.2171, weighted_loss: 1.8139, label: 6, bag_size: 2443
batch 700, loss: 0.6584, instance_loss: 0.0978, weighted_loss: 0.4903, label: 5, bag_size: 593
batch 800, loss: 5.0979, instance_loss: 0.2582, weighted_loss: 3.6460, label: 8, bag_size: 567
batch 900, loss: 4.5001, instance_loss: 0.1690, weighted_loss: 3.2008, label: 5, bag_size: 621
batch 1000, loss: 2.0956, instance_loss: 0.0989, weighted_loss: 1.4966, label: 5, bag_size: 1830
batch 1100, loss: 1.1089, instance_loss: 0.1189, weighted_loss: 0.8119, label: 5, bag_size: 714
batch 1200, loss: 1.8900, instance_loss: 0.2113, weighted_loss: 1.3864, label: 6, bag_size: 394
batch 1300, loss: 1.4746, instance_loss: 0.1292, weighted_loss: 1.0710, label: 5, bag_size: 270
batch 1400, loss: 2.8713, instance_loss: 0.2126, weighted_loss: 2.0737, label: 6, bag_size: 651
batch 1500, loss: 3.3771, instance_loss: 0.2280, weighted_loss: 2.4324, label: 3, bag_size: 1006
batch 1600, loss: 1.9504, instance_loss: 0.1572, weighted_loss: 1.4125, label: 2, bag_size: 356
batch 1700, loss: 3.7539, instance_loss: 0.1910, weighted_loss: 2.6851, label: 2, bag_size: 407
batch 1800, loss: 3.2504, instance_loss: 0.2285, weighted_loss: 2.3438, label: 8, bag_size: 207
batch 1900, loss: 0.5954, instance_loss: 0.0970, weighted_loss: 0.4459, label: 5, bag_size: 794
batch 2000, loss: 0.5201, instance_loss: 0.1371, weighted_loss: 0.4052, label: 2, bag_size: 1445
batch 2100, loss: 2.4143, instance_loss: 0.2361, weighted_loss: 1.7608, label: 3, bag_size: 510

Instance Classifier Stats
class 0 clustering acc 0.9998348694316437: correct 260357/260400
class 1 clustering acc 0.00944700460829493: correct 164/17360

Epoch: 22, train_loss: 2.3250, train_clustering_loss: 0.1726, train_error: 0.5143
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6419437340153452, correct coarse 502/782 
coarse class 2: coarse acc 0.859245630174793, correct coarse 934/1087 
coarse class 3: coarse acc 0.011673151750972763, correct coarse 3/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6247582205029013, correct fine 323/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8723150357995226, correct fine 731/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3285, coarse auc: 0.7591, fine auc: 0.7386 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0014204545454545455: correct 3/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3402
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1073

Training for coarse_and_fine level...
batch 100, loss: 0.2836, instance_loss: 0.0838, weighted_loss: 0.2236, label: 5, bag_size: 456
batch 200, loss: 3.9468, instance_loss: 0.2325, weighted_loss: 2.8325, label: 7, bag_size: 568
batch 300, loss: 2.5914, instance_loss: 0.2052, weighted_loss: 1.8755, label: 6, bag_size: 770
batch 400, loss: 6.8818, instance_loss: 0.3255, weighted_loss: 4.9149, label: 9, bag_size: 830
batch 500, loss: 0.7818, instance_loss: 0.1071, weighted_loss: 0.5794, label: 5, bag_size: 1304
batch 600, loss: 0.5810, instance_loss: 0.1323, weighted_loss: 0.4464, label: 2, bag_size: 660
batch 700, loss: 0.7047, instance_loss: 0.1055, weighted_loss: 0.5249, label: 5, bag_size: 679
batch 800, loss: 1.5860, instance_loss: 0.1093, weighted_loss: 1.1430, label: 5, bag_size: 814
batch 900, loss: 1.2977, instance_loss: 0.1576, weighted_loss: 0.9557, label: 2, bag_size: 1293
batch 1000, loss: 2.5038, instance_loss: 0.1971, weighted_loss: 1.8118, label: 6, bag_size: 518
batch 1100, loss: 0.9790, instance_loss: 0.1035, weighted_loss: 0.7164, label: 5, bag_size: 690
batch 1200, loss: 2.1910, instance_loss: 0.1790, weighted_loss: 1.5874, label: 2, bag_size: 1616
batch 1300, loss: 5.3928, instance_loss: 0.2619, weighted_loss: 3.8535, label: 7, bag_size: 528
batch 1400, loss: 3.2414, instance_loss: 0.1277, weighted_loss: 2.3073, label: 5, bag_size: 1796
batch 1500, loss: 4.0613, instance_loss: 0.1890, weighted_loss: 2.8996, label: 2, bag_size: 315
batch 1600, loss: 0.7897, instance_loss: 0.0852, weighted_loss: 0.5783, label: 5, bag_size: 1874
batch 1700, loss: 2.5966, instance_loss: 0.2358, weighted_loss: 1.8883, label: 6, bag_size: 2224
batch 1800, loss: 0.3061, instance_loss: 0.0934, weighted_loss: 0.2423, label: 5, bag_size: 2402
batch 1900, loss: 0.4430, instance_loss: 0.0983, weighted_loss: 0.3396, label: 5, bag_size: 221
batch 2000, loss: 1.2261, instance_loss: 0.1273, weighted_loss: 0.8965, label: 5, bag_size: 431
batch 2100, loss: 4.0991, instance_loss: 0.1907, weighted_loss: 2.9266, label: 2, bag_size: 377

Instance Classifier Stats
class 0 clustering acc 0.9997849462365591: correct 260344/260400
class 1 clustering acc 0.011635944700460829: correct 202/17360

Epoch: 23, train_loss: 2.3148, train_clustering_loss: 0.1718, train_error: 0.5106
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.659846547314578, correct coarse 516/782 
coarse class 2: coarse acc 0.8426862925482981, correct coarse 916/1087 
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6518375241779497, correct fine 337/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8651551312649165, correct fine 725/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3210, coarse auc: 0.7633, fine auc: 0.7394 
class 0 clustering acc 0.9999684343434343: correct 31679/31680 
class 1 clustering acc 0.002840909090909091: correct 6/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3482
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1075

Training for coarse_and_fine level...
batch 100, loss: 0.7039, instance_loss: 0.1025, weighted_loss: 0.5235, label: 5, bag_size: 1304
batch 200, loss: 0.2252, instance_loss: 0.1053, weighted_loss: 0.1892, label: 5, bag_size: 651
batch 300, loss: 2.8080, instance_loss: 0.2262, weighted_loss: 2.0335, label: 6, bag_size: 325
batch 400, loss: 1.4050, instance_loss: 0.0999, weighted_loss: 1.0135, label: 5, bag_size: 1062
batch 500, loss: 2.9689, instance_loss: 0.1874, weighted_loss: 2.1344, label: 6, bag_size: 106
batch 600, loss: 2.4630, instance_loss: 0.2379, weighted_loss: 1.7955, label: 3, bag_size: 685
batch 700, loss: 0.3531, instance_loss: 0.0993, weighted_loss: 0.2769, label: 5, bag_size: 226
batch 800, loss: 0.1678, instance_loss: 0.0729, weighted_loss: 0.1393, label: 5, bag_size: 474
batch 900, loss: 6.6188, instance_loss: 0.2630, weighted_loss: 4.7121, label: 1, bag_size: 129
batch 1000, loss: 4.5520, instance_loss: 0.2020, weighted_loss: 3.2470, label: 6, bag_size: 585
batch 1100, loss: 0.9101, instance_loss: 0.1507, weighted_loss: 0.6823, label: 2, bag_size: 1447
batch 1200, loss: 2.9027, instance_loss: 0.1935, weighted_loss: 2.0900, label: 2, bag_size: 430
batch 1300, loss: 0.8692, instance_loss: 0.1012, weighted_loss: 0.6388, label: 5, bag_size: 326
batch 1400, loss: 2.5881, instance_loss: 0.1769, weighted_loss: 1.8648, label: 2, bag_size: 161
batch 1500, loss: 2.9918, instance_loss: 0.1951, weighted_loss: 2.1528, label: 2, bag_size: 946
batch 1600, loss: 2.2470, instance_loss: 0.2346, weighted_loss: 1.6433, label: 4, bag_size: 836
batch 1700, loss: 2.3204, instance_loss: 0.2083, weighted_loss: 1.6868, label: 6, bag_size: 489
batch 1800, loss: 2.6224, instance_loss: 0.2134, weighted_loss: 1.8997, label: 6, bag_size: 1122
batch 1900, loss: 1.7683, instance_loss: 0.1582, weighted_loss: 1.2852, label: 2, bag_size: 267
batch 2000, loss: 0.3419, instance_loss: 0.1012, weighted_loss: 0.2697, label: 5, bag_size: 261
batch 2100, loss: 0.2732, instance_loss: 0.0849, weighted_loss: 0.2167, label: 5, bag_size: 540

Instance Classifier Stats
class 0 clustering acc 0.9997081413210446: correct 260324/260400
class 1 clustering acc 0.013191244239631337: correct 229/17360

Epoch: 24, train_loss: 2.3061, train_clustering_loss: 0.1713, train_error: 0.5138
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6457800511508951, correct coarse 505/782 
coarse class 2: coarse acc 0.8610855565777369, correct coarse 936/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6305609284332688, correct fine 326/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.869928400954654, correct fine 729/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3135, coarse auc: 0.7679, fine auc: 0.7413 
class 0 clustering acc 0.9999684343434343: correct 31679/31680 
class 1 clustering acc 0.004261363636363636: correct 9/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3442
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1074

Training for coarse_and_fine level...
batch 100, loss: 2.0352, instance_loss: 0.1886, weighted_loss: 1.4812, label: 6, bag_size: 326
batch 200, loss: 6.6785, instance_loss: 0.3363, weighted_loss: 4.7759, label: 10, bag_size: 335
batch 300, loss: 2.7753, instance_loss: 0.1810, weighted_loss: 1.9970, label: 6, bag_size: 194
batch 400, loss: 0.5724, instance_loss: 0.0957, weighted_loss: 0.4294, label: 5, bag_size: 713
batch 500, loss: 2.0373, instance_loss: 0.1381, weighted_loss: 1.4675, label: 5, bag_size: 421
batch 600, loss: 2.8904, instance_loss: 0.1935, weighted_loss: 2.0813, label: 6, bag_size: 444
batch 700, loss: 0.2846, instance_loss: 0.1089, weighted_loss: 0.2319, label: 5, bag_size: 290
batch 800, loss: 4.3749, instance_loss: 0.2409, weighted_loss: 3.1347, label: 8, bag_size: 558
batch 900, loss: 3.7496, instance_loss: 0.2122, weighted_loss: 2.6884, label: 7, bag_size: 168
batch 1000, loss: 7.6913, instance_loss: 0.1586, weighted_loss: 5.4315, label: 5, bag_size: 362
batch 1100, loss: 2.1465, instance_loss: 0.2139, weighted_loss: 1.5667, label: 6, bag_size: 572
batch 1200, loss: 2.5379, instance_loss: 0.1802, weighted_loss: 1.8306, label: 2, bag_size: 1214
batch 1300, loss: 1.8059, instance_loss: 0.1639, weighted_loss: 1.3133, label: 5, bag_size: 178
batch 1400, loss: 0.3272, instance_loss: 0.0916, weighted_loss: 0.2565, label: 5, bag_size: 441
batch 1500, loss: 4.6615, instance_loss: 0.2240, weighted_loss: 3.3302, label: 7, bag_size: 229
batch 1600, loss: 3.6856, instance_loss: 0.2073, weighted_loss: 2.6421, label: 3, bag_size: 175
batch 1700, loss: 0.0718, instance_loss: 0.0994, weighted_loss: 0.0801, label: 5, bag_size: 421
batch 1800, loss: 1.3057, instance_loss: 0.1147, weighted_loss: 0.9484, label: 5, bag_size: 721
batch 1900, loss: 3.4189, instance_loss: 0.2048, weighted_loss: 2.4546, label: 2, bag_size: 559
batch 2000, loss: 2.4628, instance_loss: 0.2238, weighted_loss: 1.7911, label: 3, bag_size: 1120
batch 2100, loss: 1.9851, instance_loss: 0.1420, weighted_loss: 1.4321, label: 5, bag_size: 677

Instance Classifier Stats
class 0 clustering acc 0.9997235023041474: correct 260328/260400
class 1 clustering acc 0.017223502304147466: correct 299/17360

Epoch: 25, train_loss: 2.2977, train_clustering_loss: 0.1709, train_error: 0.5111
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.8564857405703772, correct coarse 931/1087 
coarse class 3: coarse acc 0.023346303501945526, correct coarse 6/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6460348162475822, correct fine 334/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8675417661097852, correct fine 727/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3064, coarse auc: 0.7693, fine auc: 0.7431 
class 0 clustering acc 0.9999684343434343: correct 31679/31680 
class 1 clustering acc 0.008049242424242424: correct 17/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3653
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1075

Training for coarse_and_fine level...
batch 100, loss: 3.4944, instance_loss: 0.2206, weighted_loss: 2.5123, label: 8, bag_size: 707
batch 200, loss: 2.2490, instance_loss: 0.1512, weighted_loss: 1.6197, label: 5, bag_size: 156
batch 300, loss: 3.2775, instance_loss: 0.2250, weighted_loss: 2.3618, label: 6, bag_size: 710
batch 400, loss: 2.5283, instance_loss: 0.2475, weighted_loss: 1.8440, label: 6, bag_size: 570
batch 500, loss: 3.9642, instance_loss: 0.2356, weighted_loss: 2.8456, label: 8, bag_size: 1167
batch 600, loss: 0.7764, instance_loss: 0.0954, weighted_loss: 0.5721, label: 5, bag_size: 482
batch 700, loss: 0.2183, instance_loss: 0.0874, weighted_loss: 0.1790, label: 5, bag_size: 515
batch 800, loss: 4.3733, instance_loss: 0.2076, weighted_loss: 3.1236, label: 2, bag_size: 449
batch 900, loss: 2.1005, instance_loss: 0.1716, weighted_loss: 1.5218, label: 2, bag_size: 1627
batch 1000, loss: 2.9408, instance_loss: 0.1945, weighted_loss: 2.1169, label: 6, bag_size: 220
batch 1100, loss: 1.6047, instance_loss: 0.1528, weighted_loss: 1.1691, label: 2, bag_size: 515
batch 1200, loss: 0.2394, instance_loss: 0.0890, weighted_loss: 0.1943, label: 5, bag_size: 637
batch 1300, loss: 6.1728, instance_loss: 0.2782, weighted_loss: 4.4044, label: 7, bag_size: 549
batch 1400, loss: 0.5800, instance_loss: 0.1093, weighted_loss: 0.4388, label: 5, bag_size: 475
batch 1500, loss: 1.8644, instance_loss: 0.1711, weighted_loss: 1.3564, label: 2, bag_size: 1897
batch 1600, loss: 3.8027, instance_loss: 0.2327, weighted_loss: 2.7317, label: 8, bag_size: 1274
batch 1700, loss: 3.4557, instance_loss: 0.2215, weighted_loss: 2.4855, label: 3, bag_size: 262
batch 1800, loss: 0.6485, instance_loss: 0.1231, weighted_loss: 0.4909, label: 2, bag_size: 2121
batch 1900, loss: 2.7593, instance_loss: 0.2153, weighted_loss: 1.9961, label: 6, bag_size: 1655
batch 2000, loss: 2.2188, instance_loss: 0.2240, weighted_loss: 1.6204, label: 6, bag_size: 523
batch 2100, loss: 0.9226, instance_loss: 0.0911, weighted_loss: 0.6731, label: 5, bag_size: 690

Instance Classifier Stats
class 0 clustering acc 0.9996390168970815: correct 260306/260400
class 1 clustering acc 0.019527649769585254: correct 339/17360

Epoch: 26, train_loss: 2.2901, train_clustering_loss: 0.1707, train_error: 0.5138
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.8638454461821528, correct coarse 939/1087 
coarse class 3: coarse acc 0.027237354085603113, correct coarse 7/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6228239845261122, correct fine 322/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8735083532219571, correct fine 732/838 
fine class 6: fine acc 0.004016064257028112, correct fine 1/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2996, coarse auc: 0.7704, fine auc: 0.7445 
class 0 clustering acc 0.9999368686868687: correct 31678/31680 
class 1 clustering acc 0.01231060606060606: correct 26/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3653
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1074

Training for coarse_and_fine level...
batch 100, loss: 1.9969, instance_loss: 0.2284, weighted_loss: 1.4663, label: 6, bag_size: 361
batch 200, loss: 0.1238, instance_loss: 0.0748, weighted_loss: 0.1091, label: 5, bag_size: 475
batch 300, loss: 0.1347, instance_loss: 0.1038, weighted_loss: 0.1254, label: 5, bag_size: 190
batch 400, loss: 2.5898, instance_loss: 0.2311, weighted_loss: 1.8822, label: 6, bag_size: 600
batch 500, loss: 2.5394, instance_loss: 0.2416, weighted_loss: 1.8500, label: 4, bag_size: 1346
batch 600, loss: 1.1493, instance_loss: 0.1617, weighted_loss: 0.8530, label: 2, bag_size: 440
batch 700, loss: 0.6501, instance_loss: 0.0889, weighted_loss: 0.4817, label: 5, bag_size: 653
batch 800, loss: 4.3955, instance_loss: 0.2537, weighted_loss: 3.1529, label: 7, bag_size: 159
batch 900, loss: 0.7897, instance_loss: 0.1984, weighted_loss: 0.6123, label: 2, bag_size: 388
batch 1000, loss: 0.4436, instance_loss: 0.0905, weighted_loss: 0.3377, label: 5, bag_size: 807
batch 1100, loss: 2.4027, instance_loss: 0.1666, weighted_loss: 1.7319, label: 5, bag_size: 113
batch 1200, loss: 2.4185, instance_loss: 0.2130, weighted_loss: 1.7568, label: 6, bag_size: 489
batch 1300, loss: 5.3760, instance_loss: 0.2287, weighted_loss: 3.8318, label: 2, bag_size: 306
batch 1400, loss: 0.6453, instance_loss: 0.1016, weighted_loss: 0.4822, label: 5, bag_size: 359
batch 1500, loss: 3.0730, instance_loss: 0.1656, weighted_loss: 2.2008, label: 2, bag_size: 224
batch 1600, loss: 0.1150, instance_loss: 0.0838, weighted_loss: 0.1056, label: 5, bag_size: 1015
batch 1700, loss: 2.6545, instance_loss: 0.1803, weighted_loss: 1.9122, label: 6, bag_size: 625
batch 1800, loss: 2.0314, instance_loss: 0.1720, weighted_loss: 1.4736, label: 2, bag_size: 356
batch 1900, loss: 1.5274, instance_loss: 0.1296, weighted_loss: 1.1081, label: 5, bag_size: 462
batch 2000, loss: 2.0921, instance_loss: 0.1131, weighted_loss: 1.4984, label: 5, bag_size: 604
batch 2100, loss: 1.2619, instance_loss: 0.1438, weighted_loss: 0.9265, label: 2, bag_size: 1617

Instance Classifier Stats
class 0 clustering acc 0.9995775729646698: correct 260290/260400
class 1 clustering acc 0.0228110599078341: correct 396/17360

Epoch: 27, train_loss: 2.2817, train_clustering_loss: 0.1700, train_error: 0.5092
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6508951406649617, correct coarse 509/782 
coarse class 2: coarse acc 0.8675252989880404, correct coarse 943/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6382978723404256, correct fine 330/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8758949880668258, correct fine 734/838 
fine class 6: fine acc 0.004016064257028112, correct fine 1/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2940, coarse auc: 0.7724, fine auc: 0.7475 
class 0 clustering acc 0.9999368686868687: correct 31678/31680 
class 1 clustering acc 0.014678030303030304: correct 31/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3631
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1066

Training for coarse_and_fine level...
batch 100, loss: 2.1313, instance_loss: 0.2060, weighted_loss: 1.5537, label: 6, bag_size: 368
batch 200, loss: 0.4079, instance_loss: 0.1037, weighted_loss: 0.3166, label: 5, bag_size: 289
batch 300, loss: 3.8589, instance_loss: 0.2593, weighted_loss: 2.7790, label: 4, bag_size: 471
batch 400, loss: 2.7121, instance_loss: 0.1700, weighted_loss: 1.9495, label: 2, bag_size: 304
batch 500, loss: 3.7461, instance_loss: 0.2269, weighted_loss: 2.6903, label: 8, bag_size: 543
batch 600, loss: 0.4297, instance_loss: 0.0884, weighted_loss: 0.3274, label: 5, bag_size: 239
batch 700, loss: 0.1244, instance_loss: 0.0789, weighted_loss: 0.1107, label: 5, bag_size: 732
batch 800, loss: 1.6319, instance_loss: 0.1277, weighted_loss: 1.1806, label: 5, bag_size: 350
batch 900, loss: 2.2349, instance_loss: 0.2124, weighted_loss: 1.6281, label: 3, bag_size: 926
batch 1000, loss: 4.5606, instance_loss: 0.2253, weighted_loss: 3.2600, label: 8, bag_size: 288
batch 1100, loss: 3.4364, instance_loss: 0.2092, weighted_loss: 2.4683, label: 8, bag_size: 478
batch 1200, loss: 1.4000, instance_loss: 0.1361, weighted_loss: 1.0209, label: 5, bag_size: 258
batch 1300, loss: 6.5587, instance_loss: 0.2406, weighted_loss: 4.6633, label: 1, bag_size: 153
batch 1400, loss: 2.7372, instance_loss: 0.2499, weighted_loss: 1.9910, label: 6, bag_size: 464
batch 1500, loss: 6.5931, instance_loss: 0.2968, weighted_loss: 4.7042, label: 10, bag_size: 372
batch 1600, loss: 2.9311, instance_loss: 0.1583, weighted_loss: 2.0993, label: 2, bag_size: 119
batch 1700, loss: 3.6389, instance_loss: 0.2155, weighted_loss: 2.6119, label: 8, bag_size: 461
batch 1800, loss: 1.6547, instance_loss: 0.2037, weighted_loss: 1.2194, label: 6, bag_size: 787
batch 1900, loss: 0.4841, instance_loss: 0.0855, weighted_loss: 0.3645, label: 5, bag_size: 713
batch 2000, loss: 3.8671, instance_loss: 0.2090, weighted_loss: 2.7697, label: 2, bag_size: 360
batch 2100, loss: 0.6263, instance_loss: 0.1202, weighted_loss: 0.4745, label: 2, bag_size: 379

Instance Classifier Stats
class 0 clustering acc 0.9995814132104455: correct 260291/260400
class 1 clustering acc 0.025460829493087558: correct 442/17360

Epoch: 28, train_loss: 2.2755, train_clustering_loss: 0.1699, train_error: 0.5074
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6508951406649617, correct coarse 509/782 
coarse class 2: coarse acc 0.8629254829806807, correct coarse 938/1087 
coarse class 3: coarse acc 0.0311284046692607, correct coarse 8/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6479690522243714, correct fine 335/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8711217183770883, correct fine 730/838 
fine class 6: fine acc 0.004016064257028112, correct fine 1/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2873, coarse auc: 0.7745, fine auc: 0.7491 
class 0 clustering acc 0.999905303030303: correct 31677/31680 
class 1 clustering acc 0.01893939393939394: correct 40/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3653
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1082

Training for coarse_and_fine level...
batch 100, loss: 0.6535, instance_loss: 0.1506, weighted_loss: 0.5026, label: 2, bag_size: 3550
batch 200, loss: 0.2732, instance_loss: 0.0769, weighted_loss: 0.2143, label: 5, bag_size: 846
batch 300, loss: 3.5031, instance_loss: 0.2124, weighted_loss: 2.5159, label: 2, bag_size: 631
batch 400, loss: 4.4756, instance_loss: 0.2685, weighted_loss: 3.2135, label: 4, bag_size: 317
batch 500, loss: 1.6098, instance_loss: 0.1690, weighted_loss: 1.1775, label: 2, bag_size: 135
batch 600, loss: 0.2432, instance_loss: 0.0731, weighted_loss: 0.1922, label: 5, bag_size: 456
batch 700, loss: 1.1805, instance_loss: 0.1306, weighted_loss: 0.8655, label: 2, bag_size: 620
batch 800, loss: 3.4086, instance_loss: 0.2189, weighted_loss: 2.4517, label: 7, bag_size: 189
batch 900, loss: 3.2080, instance_loss: 0.2277, weighted_loss: 2.3139, label: 8, bag_size: 440
batch 1000, loss: 0.8333, instance_loss: 0.0925, weighted_loss: 0.6110, label: 5, bag_size: 1364
batch 1100, loss: 3.9458, instance_loss: 0.2019, weighted_loss: 2.8226, label: 6, bag_size: 395
batch 1200, loss: 2.1466, instance_loss: 0.2045, weighted_loss: 1.5640, label: 3, bag_size: 749
batch 1300, loss: 1.5820, instance_loss: 0.1477, weighted_loss: 1.1517, label: 5, bag_size: 106
batch 1400, loss: 0.1907, instance_loss: 0.0756, weighted_loss: 0.1561, label: 5, bag_size: 554
batch 1500, loss: 2.3023, instance_loss: 0.1723, weighted_loss: 1.6633, label: 2, bag_size: 237
batch 1600, loss: 1.0738, instance_loss: 0.1406, weighted_loss: 0.7939, label: 2, bag_size: 697
batch 1700, loss: 0.8816, instance_loss: 0.1365, weighted_loss: 0.6581, label: 2, bag_size: 1427
batch 1800, loss: 0.8269, instance_loss: 0.1509, weighted_loss: 0.6241, label: 2, bag_size: 2047
batch 1900, loss: 2.1844, instance_loss: 0.2647, weighted_loss: 1.6085, label: 4, bag_size: 2131
batch 2000, loss: 1.7763, instance_loss: 0.1460, weighted_loss: 1.2872, label: 2, bag_size: 385
batch 2100, loss: 3.4312, instance_loss: 0.2119, weighted_loss: 2.4654, label: 8, bag_size: 707

Instance Classifier Stats
class 0 clustering acc 0.999489247311828: correct 260267/260400
class 1 clustering acc 0.0277073732718894: correct 481/17360

Epoch: 29, train_loss: 2.2669, train_clustering_loss: 0.1698, train_error: 0.5074
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6508951406649617, correct coarse 509/782 
coarse class 2: coarse acc 0.8620055197792088, correct coarse 937/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6460348162475822, correct fine 334/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8723150357995226, correct fine 731/838 
fine class 6: fine acc 0.008032128514056224, correct fine 2/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2817, coarse auc: 0.7745, fine auc: 0.7501 
class 0 clustering acc 0.9998421717171717: correct 31675/31680 
class 1 clustering acc 0.02462121212121212: correct 52/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3650
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1090

Training for coarse_and_fine level...
batch 100, loss: 1.9000, instance_loss: 0.2442, weighted_loss: 1.4032, label: 4, bag_size: 1079
batch 200, loss: 3.8518, instance_loss: 0.2310, weighted_loss: 2.7655, label: 7, bag_size: 426
batch 300, loss: 1.9404, instance_loss: 0.2035, weighted_loss: 1.4194, label: 3, bag_size: 2842
batch 400, loss: 0.3284, instance_loss: 0.0834, weighted_loss: 0.2549, label: 5, bag_size: 226
batch 500, loss: 3.9262, instance_loss: 0.1897, weighted_loss: 2.8053, label: 6, bag_size: 290
batch 600, loss: 3.1258, instance_loss: 0.1983, weighted_loss: 2.2475, label: 2, bag_size: 394
batch 700, loss: 0.3864, instance_loss: 0.0805, weighted_loss: 0.2946, label: 5, bag_size: 239
batch 800, loss: 2.0360, instance_loss: 0.1123, weighted_loss: 1.4589, label: 5, bag_size: 658
batch 900, loss: 4.0123, instance_loss: 0.2327, weighted_loss: 2.8784, label: 8, bag_size: 356
batch 1000, loss: 0.1860, instance_loss: 0.0889, weighted_loss: 0.1568, label: 5, bag_size: 764
batch 1100, loss: 2.3117, instance_loss: 0.1709, weighted_loss: 1.6695, label: 5, bag_size: 562
batch 1200, loss: 1.3531, instance_loss: 0.1333, weighted_loss: 0.9872, label: 2, bag_size: 2159
batch 1300, loss: 3.8951, instance_loss: 0.1994, weighted_loss: 2.7864, label: 6, bag_size: 231
batch 1400, loss: 2.7507, instance_loss: 0.1670, weighted_loss: 1.9756, label: 2, bag_size: 267
batch 1500, loss: 1.7909, instance_loss: 0.1248, weighted_loss: 1.2910, label: 5, bag_size: 466
batch 1600, loss: 1.2229, instance_loss: 0.1080, weighted_loss: 0.8885, label: 5, bag_size: 873
batch 1700, loss: 0.5820, instance_loss: 0.1028, weighted_loss: 0.4382, label: 5, bag_size: 335
batch 1800, loss: 2.5489, instance_loss: 0.2130, weighted_loss: 1.8482, label: 6, bag_size: 387
batch 1900, loss: 1.8838, instance_loss: 0.1456, weighted_loss: 1.3623, label: 5, bag_size: 271
batch 2000, loss: 0.8372, instance_loss: 0.1498, weighted_loss: 0.6310, label: 2, bag_size: 1523
batch 2100, loss: 0.3395, instance_loss: 0.0852, weighted_loss: 0.2632, label: 5, bag_size: 246

Instance Classifier Stats
class 0 clustering acc 0.999389400921659: correct 260241/260400
class 1 clustering acc 0.03450460829493088: correct 599/17360

Epoch: 30, train_loss: 2.2602, train_clustering_loss: 0.1692, train_error: 0.5074
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.8702851885924563, correct coarse 946/1087 
coarse class 3: coarse acc 0.03501945525291829, correct coarse 9/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6402321083172147, correct fine 331/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8747016706443914, correct fine 733/838 
fine class 6: fine acc 0.012048192771084338, correct fine 3/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2761, coarse auc: 0.7749, fine auc: 0.7527 
class 0 clustering acc 0.9997790404040404: correct 31673/31680 
class 1 clustering acc 0.03172348484848485: correct 67/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3625
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1153

Training for coarse_and_fine level...
batch 100, loss: 3.1669, instance_loss: 0.1974, weighted_loss: 2.2760, label: 6, bag_size: 274
batch 200, loss: 2.7401, instance_loss: 0.1695, weighted_loss: 1.9689, label: 2, bag_size: 205
batch 300, loss: 0.2662, instance_loss: 0.0830, weighted_loss: 0.2113, label: 5, bag_size: 162
batch 400, loss: 0.8690, instance_loss: 0.1243, weighted_loss: 0.6456, label: 2, bag_size: 1110
batch 500, loss: 1.7756, instance_loss: 0.1310, weighted_loss: 1.2822, label: 5, bag_size: 316
batch 600, loss: 0.8289, instance_loss: 0.1299, weighted_loss: 0.6192, label: 2, bag_size: 1762
batch 700, loss: 2.3419, instance_loss: 0.2256, weighted_loss: 1.7070, label: 6, bag_size: 701
batch 800, loss: 2.0942, instance_loss: 0.1354, weighted_loss: 1.5065, label: 5, bag_size: 421
batch 900, loss: 2.4739, instance_loss: 0.2471, weighted_loss: 1.8059, label: 3, bag_size: 683
batch 1000, loss: 1.7514, instance_loss: 0.2347, weighted_loss: 1.2964, label: 4, bag_size: 563
batch 1100, loss: 0.2222, instance_loss: 0.0942, weighted_loss: 0.1838, label: 5, bag_size: 484
batch 1200, loss: 0.3272, instance_loss: 0.0822, weighted_loss: 0.2537, label: 5, bag_size: 956
batch 1300, loss: 2.2077, instance_loss: 0.2451, weighted_loss: 1.6189, label: 6, bag_size: 443
batch 1400, loss: 0.3148, instance_loss: 0.0894, weighted_loss: 0.2472, label: 5, bag_size: 139
batch 1500, loss: 0.2411, instance_loss: 0.0799, weighted_loss: 0.1927, label: 5, bag_size: 555
batch 1600, loss: 1.8447, instance_loss: 0.1782, weighted_loss: 1.3448, label: 2, bag_size: 1860
batch 1700, loss: 2.4477, instance_loss: 0.1955, weighted_loss: 1.7720, label: 6, bag_size: 483
batch 1800, loss: 0.2484, instance_loss: 0.0840, weighted_loss: 0.1991, label: 5, bag_size: 305
batch 1900, loss: 1.1445, instance_loss: 0.1022, weighted_loss: 0.8318, label: 5, bag_size: 558
batch 2000, loss: 2.9852, instance_loss: 0.2438, weighted_loss: 2.1628, label: 3, bag_size: 427
batch 2100, loss: 5.6786, instance_loss: 0.2886, weighted_loss: 4.0616, label: 10, bag_size: 416

Instance Classifier Stats
class 0 clustering acc 0.999389400921659: correct 260241/260400
class 1 clustering acc 0.03778801843317972: correct 656/17360

Epoch: 31, train_loss: 2.2534, train_clustering_loss: 0.1686, train_error: 0.5074
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.027237354085603113, correct coarse 7/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6305609284332688, correct fine 326/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8782816229116945, correct fine 736/838 
fine class 6: fine acc 0.01606425702811245, correct fine 4/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2720, coarse auc: 0.7748, fine auc: 0.7551 
class 0 clustering acc 0.9997790404040404: correct 31673/31680 
class 1 clustering acc 0.03551136363636364: correct 75/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3796
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1146

Training for coarse_and_fine level...
batch 100, loss: 0.4740, instance_loss: 0.0818, weighted_loss: 0.3563, label: 5, bag_size: 265
batch 200, loss: 2.7693, instance_loss: 0.1997, weighted_loss: 1.9984, label: 6, bag_size: 1506
batch 300, loss: 2.9929, instance_loss: 0.1703, weighted_loss: 2.1461, label: 5, bag_size: 228
batch 400, loss: 0.5254, instance_loss: 0.0921, weighted_loss: 0.3954, label: 5, bag_size: 688
batch 500, loss: 0.2097, instance_loss: 0.0773, weighted_loss: 0.1700, label: 5, bag_size: 699
batch 600, loss: 3.5509, instance_loss: 0.2265, weighted_loss: 2.5536, label: 8, bag_size: 110
batch 700, loss: 0.2716, instance_loss: 0.0805, weighted_loss: 0.2143, label: 5, bag_size: 437
batch 800, loss: 0.9628, instance_loss: 0.1292, weighted_loss: 0.7128, label: 5, bag_size: 494
batch 900, loss: 0.1949, instance_loss: 0.0774, weighted_loss: 0.1596, label: 5, bag_size: 204
batch 1000, loss: 5.6947, instance_loss: 0.3278, weighted_loss: 4.0846, label: 9, bag_size: 936
batch 1100, loss: 3.2452, instance_loss: 0.2723, weighted_loss: 2.3533, label: 6, bag_size: 371
batch 1200, loss: 2.3120, instance_loss: 0.1664, weighted_loss: 1.6683, label: 5, bag_size: 220
batch 1300, loss: 0.5024, instance_loss: 0.0976, weighted_loss: 0.3810, label: 5, bag_size: 866
batch 1400, loss: 0.6710, instance_loss: 0.0975, weighted_loss: 0.4990, label: 2, bag_size: 732
batch 1500, loss: 1.3107, instance_loss: 0.1502, weighted_loss: 0.9625, label: 2, bag_size: 506
batch 1600, loss: 0.4851, instance_loss: 0.0766, weighted_loss: 0.3625, label: 5, bag_size: 475
batch 1700, loss: 0.1024, instance_loss: 0.0733, weighted_loss: 0.0937, label: 5, bag_size: 307
batch 1800, loss: 8.5779, instance_loss: 0.2804, weighted_loss: 6.0887, label: 1, bag_size: 260
batch 1900, loss: 0.2960, instance_loss: 0.0714, weighted_loss: 0.2286, label: 5, bag_size: 779
batch 2000, loss: 2.1255, instance_loss: 0.1583, weighted_loss: 1.5353, label: 5, bag_size: 232
batch 2100, loss: 0.2552, instance_loss: 0.0768, weighted_loss: 0.2017, label: 5, bag_size: 859

Instance Classifier Stats
class 0 clustering acc 0.9994047619047619: correct 260245/260400
class 1 clustering acc 0.03917050691244239: correct 680/17360

Epoch: 32, train_loss: 2.2469, train_clustering_loss: 0.1683, train_error: 0.5046
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6547314578005116, correct coarse 512/782 
coarse class 2: coarse acc 0.8629254829806807, correct coarse 938/1087 
coarse class 3: coarse acc 0.038910505836575876, correct coarse 10/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6460348162475822, correct fine 334/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8723150357995226, correct fine 731/838 
fine class 6: fine acc 0.028112449799196786, correct fine 7/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2665, coarse auc: 0.7769, fine auc: 0.7556 
class 0 clustering acc 0.9996212121212121: correct 31668/31680 
class 1 clustering acc 0.05160984848484849: correct 109/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3625
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1176

Training for coarse_and_fine level...
batch 100, loss: 1.1150, instance_loss: 0.1182, weighted_loss: 0.8160, label: 2, bag_size: 310
batch 200, loss: 0.1427, instance_loss: 0.0812, weighted_loss: 0.1242, label: 5, bag_size: 318
batch 300, loss: 1.5447, instance_loss: 0.0987, weighted_loss: 1.1109, label: 5, bag_size: 337
batch 400, loss: 2.2742, instance_loss: 0.2290, weighted_loss: 1.6607, label: 6, bag_size: 304
batch 500, loss: 0.5769, instance_loss: 0.0954, weighted_loss: 0.4325, label: 5, bag_size: 358
batch 600, loss: 3.8058, instance_loss: 0.2101, weighted_loss: 2.7271, label: 3, bag_size: 175
batch 700, loss: 1.4254, instance_loss: 0.1476, weighted_loss: 1.0420, label: 5, bag_size: 311
batch 800, loss: 1.1961, instance_loss: 0.1402, weighted_loss: 0.8793, label: 5, bag_size: 318
batch 900, loss: 2.1676, instance_loss: 0.2065, weighted_loss: 1.5793, label: 6, bag_size: 92
batch 1000, loss: 1.1698, instance_loss: 0.1286, weighted_loss: 0.8574, label: 2, bag_size: 1567
batch 1100, loss: 1.5227, instance_loss: 0.1087, weighted_loss: 1.0985, label: 5, bag_size: 377
batch 1200, loss: 3.6399, instance_loss: 0.2325, weighted_loss: 2.6177, label: 7, bag_size: 168
batch 1300, loss: 0.1436, instance_loss: 0.0648, weighted_loss: 0.1199, label: 5, bag_size: 393
batch 1400, loss: 3.5475, instance_loss: 0.2138, weighted_loss: 2.5474, label: 6, bag_size: 379
batch 1500, loss: 3.1582, instance_loss: 0.2118, weighted_loss: 2.2743, label: 6, bag_size: 1550
batch 1600, loss: 0.5767, instance_loss: 0.1266, weighted_loss: 0.4417, label: 2, bag_size: 1549
batch 1700, loss: 0.2092, instance_loss: 0.0707, weighted_loss: 0.1677, label: 5, bag_size: 463
batch 1800, loss: 1.7141, instance_loss: 0.1538, weighted_loss: 1.2460, label: 2, bag_size: 333
batch 1900, loss: 4.0217, instance_loss: 0.1848, weighted_loss: 2.8706, label: 2, bag_size: 666
batch 2000, loss: 4.6500, instance_loss: 0.1786, weighted_loss: 3.3086, label: 5, bag_size: 2344
batch 2100, loss: 1.6879, instance_loss: 0.1508, weighted_loss: 1.2268, label: 2, bag_size: 1549

Instance Classifier Stats
class 0 clustering acc 0.999189708141321: correct 260189/260400
class 1 clustering acc 0.04360599078341014: correct 757/17360

Epoch: 33, train_loss: 2.2407, train_clustering_loss: 0.1682, train_error: 0.5018
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6534526854219949, correct coarse 511/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.0311284046692607, correct coarse 8/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6421663442940039, correct fine 332/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.017391304347826087, correct fine 2/115 
fine class 5: fine acc 0.8794749403341289, correct fine 737/838 
fine class 6: fine acc 0.0321285140562249, correct fine 8/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2618, coarse auc: 0.7776, fine auc: 0.7574 
class 0 clustering acc 0.9995580808080808: correct 31666/31680 
class 1 clustering acc 0.05587121212121212: correct 118/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3629
Fine Overall Accuracy: 0.5265
Fine Overall F1 Score: 0.1184

Training for coarse_and_fine level...
batch 100, loss: 1.8235, instance_loss: 0.1361, weighted_loss: 1.3173, label: 5, bag_size: 233
batch 200, loss: 2.3470, instance_loss: 0.1257, weighted_loss: 1.6806, label: 5, bag_size: 1462
batch 300, loss: 3.6226, instance_loss: 0.2160, weighted_loss: 2.6006, label: 4, bag_size: 250
batch 400, loss: 1.3832, instance_loss: 0.1363, weighted_loss: 1.0091, label: 5, bag_size: 332
batch 500, loss: 1.0059, instance_loss: 0.1565, weighted_loss: 0.7511, label: 2, bag_size: 1772
batch 600, loss: 3.0153, instance_loss: 0.2173, weighted_loss: 2.1759, label: 6, bag_size: 651
batch 700, loss: 4.8296, instance_loss: 0.2429, weighted_loss: 3.4536, label: 4, bag_size: 187
batch 800, loss: 0.0943, instance_loss: 0.0652, weighted_loss: 0.0856, label: 5, bag_size: 210
batch 900, loss: 1.8425, instance_loss: 0.2188, weighted_loss: 1.3554, label: 6, bag_size: 182
batch 1000, loss: 3.2641, instance_loss: 0.1883, weighted_loss: 2.3414, label: 7, bag_size: 189
batch 1100, loss: 3.0635, instance_loss: 0.2102, weighted_loss: 2.2075, label: 3, bag_size: 755
batch 1200, loss: 4.7812, instance_loss: 0.2355, weighted_loss: 3.4175, label: 7, bag_size: 118
batch 1300, loss: 1.6436, instance_loss: 0.1213, weighted_loss: 1.1869, label: 5, bag_size: 609
batch 1400, loss: 1.3185, instance_loss: 0.1192, weighted_loss: 0.9587, label: 5, bag_size: 360
batch 1500, loss: 0.1809, instance_loss: 0.0666, weighted_loss: 0.1466, label: 5, bag_size: 185
batch 1600, loss: 2.2791, instance_loss: 0.2252, weighted_loss: 1.6629, label: 3, bag_size: 724
batch 1700, loss: 2.3158, instance_loss: 0.1751, weighted_loss: 1.6736, label: 2, bag_size: 762
batch 1800, loss: 2.5310, instance_loss: 0.2078, weighted_loss: 1.8341, label: 3, bag_size: 3892
batch 1900, loss: 0.9826, instance_loss: 0.1401, weighted_loss: 0.7298, label: 5, bag_size: 833
batch 2000, loss: 2.5591, instance_loss: 0.1889, weighted_loss: 1.8480, label: 5, bag_size: 52
batch 2100, loss: 1.3381, instance_loss: 0.1184, weighted_loss: 0.9722, label: 5, bag_size: 450

Instance Classifier Stats
class 0 clustering acc 0.9991858678955453: correct 260188/260400
class 1 clustering acc 0.0478110599078341: correct 830/17360

Epoch: 34, train_loss: 2.2347, train_clustering_loss: 0.1680, train_error: 0.5046
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6457800511508951, correct coarse 505/782 
coarse class 2: coarse acc 0.8684452621895125, correct coarse 944/1087 
coarse class 3: coarse acc 0.042801556420233464, correct coarse 11/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6344294003868471, correct fine 328/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.017391304347826087, correct fine 2/115 
fine class 5: fine acc 0.8794749403341289, correct fine 737/838 
fine class 6: fine acc 0.024096385542168676, correct fine 6/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2567, coarse auc: 0.7782, fine auc: 0.7591 
class 0 clustering acc 0.9994318181818181: correct 31662/31680 
class 1 clustering acc 0.06297348484848485: correct 133/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3786
Fine Overall Accuracy: 0.5265
Fine Overall F1 Score: 0.1184

Training for coarse_and_fine level...
batch 100, loss: 3.1157, instance_loss: 0.1782, weighted_loss: 2.2344, label: 2, bag_size: 1650
batch 200, loss: 0.7865, instance_loss: 0.1079, weighted_loss: 0.5829, label: 5, bag_size: 206
batch 300, loss: 1.0600, instance_loss: 0.1187, weighted_loss: 0.7776, label: 2, bag_size: 940
batch 400, loss: 1.8718, instance_loss: 0.2075, weighted_loss: 1.3725, label: 6, bag_size: 352
batch 500, loss: 0.2421, instance_loss: 0.0921, weighted_loss: 0.1971, label: 5, bag_size: 458
batch 600, loss: 1.9674, instance_loss: 0.2393, weighted_loss: 1.4490, label: 6, bag_size: 740
batch 700, loss: 2.5438, instance_loss: 0.1947, weighted_loss: 1.8391, label: 6, bag_size: 850
batch 800, loss: 1.4165, instance_loss: 0.1380, weighted_loss: 1.0329, label: 5, bag_size: 259
batch 900, loss: 1.1314, instance_loss: 0.0999, weighted_loss: 0.8220, label: 5, bag_size: 718
batch 1000, loss: 3.6252, instance_loss: 0.1897, weighted_loss: 2.5945, label: 7, bag_size: 479
batch 1100, loss: 1.8798, instance_loss: 0.1214, weighted_loss: 1.3523, label: 2, bag_size: 1767
batch 1200, loss: 2.7863, instance_loss: 0.2091, weighted_loss: 2.0131, label: 8, bag_size: 245
batch 1300, loss: 2.5695, instance_loss: 0.1954, weighted_loss: 1.8573, label: 6, bag_size: 629
batch 1400, loss: 3.4856, instance_loss: 0.1607, weighted_loss: 2.4881, label: 5, bag_size: 216
batch 1500, loss: 2.8822, instance_loss: 0.1955, weighted_loss: 2.0762, label: 6, bag_size: 670
batch 1600, loss: 0.4755, instance_loss: 0.0623, weighted_loss: 0.3515, label: 5, bag_size: 618
batch 1700, loss: 0.4494, instance_loss: 0.1093, weighted_loss: 0.3474, label: 2, bag_size: 1353
batch 1800, loss: 1.0307, instance_loss: 0.2328, weighted_loss: 0.7913, label: 4, bag_size: 361
batch 1900, loss: 1.5200, instance_loss: 0.2017, weighted_loss: 1.1245, label: 6, bag_size: 541
batch 2000, loss: 0.6056, instance_loss: 0.1038, weighted_loss: 0.4551, label: 5, bag_size: 607
batch 2100, loss: 7.6452, instance_loss: 0.2560, weighted_loss: 5.4285, label: 1, bag_size: 207

Instance Classifier Stats
class 0 clustering acc 0.9991321044546851: correct 260174/260400
class 1 clustering acc 0.053456221198156684: correct 928/17360

Epoch: 35, train_loss: 2.2277, train_clustering_loss: 0.1675, train_error: 0.5032
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6253196930946292, correct coarse 489/782 
coarse class 2: coarse acc 0.8831646734130635, correct coarse 960/1087 
coarse class 3: coarse acc 0.042801556420233464, correct coarse 11/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6150870406189555, correct fine 318/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.02608695652173913, correct fine 3/115 
fine class 5: fine acc 0.8866348448687351, correct fine 743/838 
fine class 6: fine acc 0.04819277108433735, correct fine 12/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2538, coarse auc: 0.7809, fine auc: 0.7617 
class 0 clustering acc 0.9993686868686869: correct 31660/31680 
class 1 clustering acc 0.06676136363636363: correct 141/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3822
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1177

Training for coarse_and_fine level...
batch 100, loss: 2.7777, instance_loss: 0.1982, weighted_loss: 2.0038, label: 8, bag_size: 216
batch 200, loss: 3.5516, instance_loss: 0.1865, weighted_loss: 2.5421, label: 6, bag_size: 252
batch 300, loss: 5.5717, instance_loss: 0.3219, weighted_loss: 3.9967, label: 10, bag_size: 310
batch 400, loss: 1.6869, instance_loss: 0.2263, weighted_loss: 1.2487, label: 3, bag_size: 836
batch 500, loss: 3.9104, instance_loss: 0.2064, weighted_loss: 2.7992, label: 6, bag_size: 231
batch 600, loss: 3.0782, instance_loss: 0.1939, weighted_loss: 2.2129, label: 5, bag_size: 478
batch 700, loss: 4.9463, instance_loss: 0.2658, weighted_loss: 3.5422, label: 10, bag_size: 837
batch 800, loss: 3.0847, instance_loss: 0.2192, weighted_loss: 2.2250, label: 3, bag_size: 356
batch 900, loss: 3.2948, instance_loss: 0.2055, weighted_loss: 2.3680, label: 8, bag_size: 259
batch 1000, loss: 1.1672, instance_loss: 0.1192, weighted_loss: 0.8528, label: 2, bag_size: 659
batch 1100, loss: 2.5087, instance_loss: 0.1498, weighted_loss: 1.8010, label: 2, bag_size: 862
batch 1200, loss: 1.7537, instance_loss: 0.1898, weighted_loss: 1.2845, label: 5, bag_size: 315
batch 1300, loss: 1.0087, instance_loss: 0.1821, weighted_loss: 0.7607, label: 2, bag_size: 3530
batch 1400, loss: 0.6231, instance_loss: 0.1327, weighted_loss: 0.4760, label: 2, bag_size: 872
batch 1500, loss: 0.1963, instance_loss: 0.0597, weighted_loss: 0.1554, label: 5, bag_size: 711
batch 1600, loss: 4.0566, instance_loss: 0.2421, weighted_loss: 2.9122, label: 7, bag_size: 850
batch 1700, loss: 2.1751, instance_loss: 0.2132, weighted_loss: 1.5865, label: 3, bag_size: 428
batch 1800, loss: 0.3376, instance_loss: 0.0785, weighted_loss: 0.2599, label: 5, bag_size: 875
batch 1900, loss: 4.9909, instance_loss: 0.2662, weighted_loss: 3.5735, label: 7, bag_size: 2244
batch 2000, loss: 1.4271, instance_loss: 0.2363, weighted_loss: 1.0699, label: 4, bag_size: 563
batch 2100, loss: 0.4973, instance_loss: 0.0749, weighted_loss: 0.3706, label: 5, bag_size: 341

Instance Classifier Stats
class 0 clustering acc 0.9990437788018434: correct 260151/260400
class 1 clustering acc 0.052649769585253456: correct 914/17360

Epoch: 36, train_loss: 2.2224, train_clustering_loss: 0.1672, train_error: 0.5032
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6534526854219949, correct coarse 511/782 
coarse class 2: coarse acc 0.8684452621895125, correct coarse 944/1087 
coarse class 3: coarse acc 0.07003891050583658, correct coarse 18/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.620889748549323, correct fine 321/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.034782608695652174, correct fine 4/115 
fine class 5: fine acc 0.883054892601432, correct fine 740/838 
fine class 6: fine acc 0.04417670682730924, correct fine 11/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2491, coarse auc: 0.7817, fine auc: 0.7632 
class 0 clustering acc 0.9992739898989899: correct 31657/31680 
class 1 clustering acc 0.07102272727272728: correct 150/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.3837
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1177

Training for coarse_and_fine level...
batch 100, loss: 8.4357, instance_loss: 0.2180, weighted_loss: 5.9704, label: 5, bag_size: 3015
batch 200, loss: 0.7130, instance_loss: 0.1049, weighted_loss: 0.5306, label: 5, bag_size: 124
batch 300, loss: 3.2871, instance_loss: 0.2146, weighted_loss: 2.3654, label: 8, bag_size: 130
batch 400, loss: 0.2014, instance_loss: 0.0738, weighted_loss: 0.1632, label: 5, bag_size: 728
batch 500, loss: 2.6052, instance_loss: 0.2178, weighted_loss: 1.8890, label: 3, bag_size: 501
batch 600, loss: 3.5401, instance_loss: 0.2254, weighted_loss: 2.5457, label: 4, bag_size: 308
batch 700, loss: 1.1317, instance_loss: 0.0920, weighted_loss: 0.8198, label: 5, bag_size: 721
batch 800, loss: 1.6829, instance_loss: 0.1401, weighted_loss: 1.2201, label: 5, bag_size: 113
batch 900, loss: 6.2487, instance_loss: 0.2655, weighted_loss: 4.4538, label: 8, bag_size: 419
batch 1000, loss: 3.4734, instance_loss: 0.2252, weighted_loss: 2.4989, label: 4, bag_size: 155
batch 1100, loss: 4.8876, instance_loss: 0.2524, weighted_loss: 3.4970, label: 3, bag_size: 1324
batch 1200, loss: 0.5648, instance_loss: 0.1049, weighted_loss: 0.4268, label: 2, bag_size: 263
batch 1300, loss: 2.4561, instance_loss: 0.2022, weighted_loss: 1.7799, label: 6, bag_size: 313
batch 1400, loss: 4.5430, instance_loss: 0.1414, weighted_loss: 3.2225, label: 5, bag_size: 1555
batch 1500, loss: 0.2599, instance_loss: 0.0593, weighted_loss: 0.1997, label: 5, bag_size: 475
batch 1600, loss: 1.9494, instance_loss: 0.1466, weighted_loss: 1.4085, label: 5, bag_size: 110
batch 1700, loss: 0.2155, instance_loss: 0.0724, weighted_loss: 0.1726, label: 5, bag_size: 488
batch 1800, loss: 0.6631, instance_loss: 0.1065, weighted_loss: 0.4961, label: 5, bag_size: 380
batch 1900, loss: 2.6017, instance_loss: 0.1654, weighted_loss: 1.8709, label: 2, bag_size: 565
batch 2000, loss: 0.2019, instance_loss: 0.0817, weighted_loss: 0.1659, label: 5, bag_size: 228
batch 2100, loss: 1.0277, instance_loss: 0.0958, weighted_loss: 0.7481, label: 5, bag_size: 503

Instance Classifier Stats
class 0 clustering acc 0.999005376344086: correct 260141/260400
class 1 clustering acc 0.0576036866359447: correct 1000/17360

Epoch: 37, train_loss: 2.2167, train_clustering_loss: 0.1671, train_error: 0.5023
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8647654093836247, correct coarse 940/1087 
coarse class 3: coarse acc 0.03501945525291829, correct coarse 9/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6286266924564797, correct fine 325/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.034782608695652174, correct fine 4/115 
fine class 5: fine acc 0.8818615751789977, correct fine 739/838 
fine class 6: fine acc 0.040160642570281124, correct fine 10/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2439, coarse auc: 0.7820, fine auc: 0.7641 
class 0 clustering acc 0.9992108585858586: correct 31655/31680 
class 1 clustering acc 0.07859848484848485: correct 166/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.3958
Fine Overall Accuracy: 0.5265
Fine Overall F1 Score: 0.1185

Training for coarse_and_fine level...
batch 100, loss: 0.5255, instance_loss: 0.1181, weighted_loss: 0.4033, label: 2, bag_size: 357
batch 200, loss: 6.3683, instance_loss: 0.2568, weighted_loss: 4.5348, label: 1, bag_size: 149
batch 300, loss: 0.7910, instance_loss: 0.0956, weighted_loss: 0.5824, label: 5, bag_size: 322
batch 400, loss: 2.3410, instance_loss: 0.2605, weighted_loss: 1.7168, label: 4, bag_size: 793
batch 500, loss: 2.8073, instance_loss: 0.1870, weighted_loss: 2.0212, label: 5, bag_size: 378
batch 600, loss: 0.8914, instance_loss: 0.1132, weighted_loss: 0.6580, label: 2, bag_size: 1311
batch 700, loss: 0.8370, instance_loss: 0.1277, weighted_loss: 0.6242, label: 2, bag_size: 1119
batch 800, loss: 1.8926, instance_loss: 0.1371, weighted_loss: 1.3660, label: 5, bag_size: 544
batch 900, loss: 6.6325, instance_loss: 0.2830, weighted_loss: 4.7276, label: 1, bag_size: 244
batch 1000, loss: 3.8649, instance_loss: 0.2398, weighted_loss: 2.7774, label: 7, bag_size: 274
batch 1100, loss: 2.0262, instance_loss: 0.1682, weighted_loss: 1.4688, label: 5, bag_size: 466
batch 1200, loss: 4.7686, instance_loss: 0.2527, weighted_loss: 3.4138, label: 8, bag_size: 838
batch 1300, loss: 2.3871, instance_loss: 0.2220, weighted_loss: 1.7376, label: 6, bag_size: 1122
batch 1400, loss: 0.2176, instance_loss: 0.0536, weighted_loss: 0.1684, label: 5, bag_size: 846
batch 1500, loss: 2.8551, instance_loss: 0.2002, weighted_loss: 2.0586, label: 6, bag_size: 2023
batch 1600, loss: 1.1495, instance_loss: 0.0734, weighted_loss: 0.8266, label: 5, bag_size: 575
batch 1700, loss: 1.5600, instance_loss: 0.1175, weighted_loss: 1.1273, label: 5, bag_size: 577
batch 1800, loss: 0.1674, instance_loss: 0.0597, weighted_loss: 0.1351, label: 5, bag_size: 821
batch 1900, loss: 3.2655, instance_loss: 0.2148, weighted_loss: 2.3503, label: 8, bag_size: 756
batch 2000, loss: 2.6714, instance_loss: 0.1686, weighted_loss: 1.9206, label: 2, bag_size: 298
batch 2100, loss: 0.4446, instance_loss: 0.0871, weighted_loss: 0.3373, label: 5, bag_size: 498

Instance Classifier Stats
class 0 clustering acc 0.99892089093702: correct 260119/260400
class 1 clustering acc 0.06105990783410138: correct 1060/17360

Epoch: 38, train_loss: 2.2115, train_clustering_loss: 0.1666, train_error: 0.5028
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6457800511508951, correct coarse 505/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.054474708171206226, correct coarse 14/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6131528046421664, correct fine 317/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0782608695652174, correct fine 9/115 
fine class 5: fine acc 0.8818615751789977, correct fine 739/838 
fine class 6: fine acc 0.04417670682730924, correct fine 11/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2401, coarse auc: 0.7828, fine auc: 0.7649 
class 0 clustering acc 0.9991477272727273: correct 31653/31680 
class 1 clustering acc 0.08428030303030302: correct 178/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3935
Fine Overall Accuracy: 0.5265
Fine Overall F1 Score: 0.1185

Training for coarse_and_fine level...
batch 100, loss: 0.8544, instance_loss: 0.1678, weighted_loss: 0.6484, label: 2, bag_size: 601
batch 200, loss: 4.7714, instance_loss: 0.2527, weighted_loss: 3.4158, label: 7, bag_size: 281
batch 300, loss: 1.4654, instance_loss: 0.1470, weighted_loss: 1.0698, label: 5, bag_size: 277
batch 400, loss: 0.6107, instance_loss: 0.1286, weighted_loss: 0.4660, label: 2, bag_size: 1300
batch 500, loss: 0.2120, instance_loss: 0.0642, weighted_loss: 0.1676, label: 5, bag_size: 620
batch 600, loss: 0.1171, instance_loss: 0.0642, weighted_loss: 0.1012, label: 5, bag_size: 537
batch 700, loss: 0.1232, instance_loss: 0.0704, weighted_loss: 0.1073, label: 5, bag_size: 318
batch 800, loss: 1.5675, instance_loss: 0.1718, weighted_loss: 1.1488, label: 2, bag_size: 768
batch 900, loss: 2.3063, instance_loss: 0.1154, weighted_loss: 1.6490, label: 5, bag_size: 200
batch 1000, loss: 0.5010, instance_loss: 0.1045, weighted_loss: 0.3821, label: 2, bag_size: 1216
batch 1100, loss: 0.6927, instance_loss: 0.1383, weighted_loss: 0.5264, label: 2, bag_size: 389
batch 1200, loss: 1.0291, instance_loss: 0.1475, weighted_loss: 0.7646, label: 2, bag_size: 821
batch 1300, loss: 1.4065, instance_loss: 0.1323, weighted_loss: 1.0242, label: 5, bag_size: 880
batch 1400, loss: 3.0669, instance_loss: 0.1955, weighted_loss: 2.2055, label: 6, bag_size: 1271
batch 1500, loss: 2.0759, instance_loss: 0.1760, weighted_loss: 1.5059, label: 2, bag_size: 328
batch 1600, loss: 1.9009, instance_loss: 0.1422, weighted_loss: 1.3732, label: 5, bag_size: 544
batch 1700, loss: 3.8651, instance_loss: 0.1931, weighted_loss: 2.7635, label: 2, bag_size: 1663
batch 1800, loss: 0.5826, instance_loss: 0.1171, weighted_loss: 0.4429, label: 5, bag_size: 335
batch 1900, loss: 2.5299, instance_loss: 0.1511, weighted_loss: 1.8163, label: 2, bag_size: 427
batch 2000, loss: 2.3716, instance_loss: 0.2321, weighted_loss: 1.7297, label: 3, bag_size: 806
batch 2100, loss: 2.0998, instance_loss: 0.0918, weighted_loss: 1.4974, label: 5, bag_size: 1246

Instance Classifier Stats
class 0 clustering acc 0.9990284178187404: correct 260147/260400
class 1 clustering acc 0.061463133640552996: correct 1067/17360

Epoch: 39, train_loss: 2.2059, train_clustering_loss: 0.1662, train_error: 0.5018
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8684452621895125, correct coarse 944/1087 
coarse class 3: coarse acc 0.06614785992217899, correct coarse 17/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6247582205029013, correct fine 323/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0782608695652174, correct fine 9/115 
fine class 5: fine acc 0.8758949880668258, correct fine 734/838 
fine class 6: fine acc 0.04819277108433735, correct fine 12/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2362, coarse auc: 0.7831, fine auc: 0.7649 
class 0 clustering acc 0.9991161616161616: correct 31652/31680 
class 1 clustering acc 0.09375: correct 198/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.3962
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1177

Training for coarse_and_fine level...
batch 100, loss: 0.0435, instance_loss: 0.0757, weighted_loss: 0.0532, label: 5, bag_size: 421
batch 200, loss: 0.5784, instance_loss: 0.1203, weighted_loss: 0.4410, label: 2, bag_size: 1847
batch 300, loss: 2.4079, instance_loss: 0.1399, weighted_loss: 1.7275, label: 2, bag_size: 555
batch 400, loss: 0.2549, instance_loss: 0.0716, weighted_loss: 0.1999, label: 5, bag_size: 540
batch 500, loss: 6.9101, instance_loss: 0.3502, weighted_loss: 4.9421, label: 9, bag_size: 84
batch 600, loss: 0.2821, instance_loss: 0.0751, weighted_loss: 0.2200, label: 5, bag_size: 996
batch 700, loss: 2.9977, instance_loss: 0.2178, weighted_loss: 2.1638, label: 4, bag_size: 223
batch 800, loss: 3.4765, instance_loss: 0.2045, weighted_loss: 2.4949, label: 8, bag_size: 79
batch 900, loss: 2.7749, instance_loss: 0.1423, weighted_loss: 1.9851, label: 5, bag_size: 367
batch 1000, loss: 0.9749, instance_loss: 0.1102, weighted_loss: 0.7155, label: 5, bag_size: 494
batch 1100, loss: 1.3326, instance_loss: 0.2015, weighted_loss: 0.9933, label: 6, bag_size: 541
batch 1200, loss: 3.9814, instance_loss: 0.2269, weighted_loss: 2.8551, label: 3, bag_size: 167
batch 1300, loss: 2.4226, instance_loss: 0.1748, weighted_loss: 1.7482, label: 5, bag_size: 128
batch 1400, loss: 2.0934, instance_loss: 0.2071, weighted_loss: 1.5275, label: 3, bag_size: 605
batch 1500, loss: 3.5120, instance_loss: 0.2291, weighted_loss: 2.5271, label: 3, bag_size: 398
batch 1600, loss: 2.4539, instance_loss: 0.1896, weighted_loss: 1.7746, label: 3, bag_size: 602
batch 1700, loss: 1.1563, instance_loss: 0.1029, weighted_loss: 0.8403, label: 2, bag_size: 310
batch 1800, loss: 3.0899, instance_loss: 0.1941, weighted_loss: 2.2211, label: 6, bag_size: 106
batch 1900, loss: 2.6997, instance_loss: 0.1955, weighted_loss: 1.9484, label: 8, bag_size: 245
batch 2000, loss: 2.9866, instance_loss: 0.2084, weighted_loss: 2.1531, label: 7, bag_size: 172
batch 2100, loss: 0.4573, instance_loss: 0.0896, weighted_loss: 0.3470, label: 5, bag_size: 624

Instance Classifier Stats
class 0 clustering acc 0.998978494623656: correct 260134/260400
class 1 clustering acc 0.0652073732718894: correct 1132/17360

Epoch: 40, train_loss: 2.2003, train_clustering_loss: 0.1662, train_error: 0.5018
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6457800511508951, correct coarse 505/782 
coarse class 2: coarse acc 0.8730450781968722, correct coarse 949/1087 
coarse class 3: coarse acc 0.054474708171206226, correct coarse 14/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.09565217391304348, correct fine 11/115 
fine class 5: fine acc 0.8866348448687351, correct fine 743/838 
fine class 6: fine acc 0.04819277108433735, correct fine 12/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2331, coarse auc: 0.7830, fine auc: 0.7664 
class 0 clustering acc 0.9991161616161616: correct 31652/31680 
class 1 clustering acc 0.09611742424242424: correct 203/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3938
Fine Overall Accuracy: 0.5265
Fine Overall F1 Score: 0.1187

Training for coarse_and_fine level...
batch 100, loss: 3.3857, instance_loss: 0.2073, weighted_loss: 2.4321, label: 6, bag_size: 1836
batch 200, loss: 0.6694, instance_loss: 0.1332, weighted_loss: 0.5085, label: 2, bag_size: 884
batch 300, loss: 4.0403, instance_loss: 0.2277, weighted_loss: 2.8965, label: 7, bag_size: 492
batch 400, loss: 6.1702, instance_loss: 0.2762, weighted_loss: 4.4020, label: 1, bag_size: 352
batch 500, loss: 2.2608, instance_loss: 0.1719, weighted_loss: 1.6341, label: 5, bag_size: 741
batch 600, loss: 0.6403, instance_loss: 0.1205, weighted_loss: 0.4843, label: 2, bag_size: 3982
batch 700, loss: 1.3551, instance_loss: 0.1316, weighted_loss: 0.9880, label: 5, bag_size: 223
batch 800, loss: 3.9765, instance_loss: 0.2187, weighted_loss: 2.8491, label: 2, bag_size: 559
batch 900, loss: 4.7141, instance_loss: 0.2440, weighted_loss: 3.3731, label: 10, bag_size: 13
batch 1000, loss: 1.4919, instance_loss: 0.1295, weighted_loss: 1.0832, label: 5, bag_size: 115
batch 1100, loss: 1.7749, instance_loss: 0.2121, weighted_loss: 1.3060, label: 3, bag_size: 631
batch 1200, loss: 2.5648, instance_loss: 0.2293, weighted_loss: 1.8641, label: 3, bag_size: 1006
batch 1300, loss: 0.8477, instance_loss: 0.1088, weighted_loss: 0.6260, label: 2, bag_size: 1311
batch 1400, loss: 6.2471, instance_loss: 0.3240, weighted_loss: 4.4701, label: 10, bag_size: 335
batch 1500, loss: 0.2717, instance_loss: 0.0685, weighted_loss: 0.2107, label: 5, bag_size: 587
batch 1600, loss: 3.0334, instance_loss: 0.1748, weighted_loss: 2.1758, label: 5, bag_size: 112
batch 1700, loss: 0.2154, instance_loss: 0.0516, weighted_loss: 0.1662, label: 5, bag_size: 890
batch 1800, loss: 0.1994, instance_loss: 0.0575, weighted_loss: 0.1568, label: 5, bag_size: 1140
batch 1900, loss: 1.6155, instance_loss: 0.1470, weighted_loss: 1.1749, label: 5, bag_size: 317
batch 2000, loss: 2.0260, instance_loss: 0.2018, weighted_loss: 1.4787, label: 3, bag_size: 1249
batch 2100, loss: 1.7304, instance_loss: 0.1667, weighted_loss: 1.2613, label: 2, bag_size: 356

Instance Classifier Stats
class 0 clustering acc 0.9989861751152074: correct 260136/260400
class 1 clustering acc 0.06624423963133641: correct 1150/17360

Epoch: 41, train_loss: 2.1967, train_clustering_loss: 0.1658, train_error: 0.5000
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.07003891050583658, correct coarse 18/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6150870406189555, correct fine 318/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.09565217391304348, correct fine 11/115 
fine class 5: fine acc 0.883054892601432, correct fine 740/838 
fine class 6: fine acc 0.05220883534136546, correct fine 13/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2303, coarse auc: 0.7841, fine auc: 0.7663 
class 0 clustering acc 0.9990530303030303: correct 31650/31680 
class 1 clustering acc 0.10416666666666667: correct 220/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.3963
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1166

Training for coarse_and_fine level...
batch 100, loss: 1.0733, instance_loss: 0.2206, weighted_loss: 0.8175, label: 4, bag_size: 454
batch 200, loss: 2.4142, instance_loss: 0.2344, weighted_loss: 1.7602, label: 6, bag_size: 858
batch 300, loss: 1.8505, instance_loss: 0.2115, weighted_loss: 1.3588, label: 6, bag_size: 521
batch 400, loss: 0.3043, instance_loss: 0.0927, weighted_loss: 0.2408, label: 5, bag_size: 221
batch 500, loss: 2.2656, instance_loss: 0.1633, weighted_loss: 1.6349, label: 5, bag_size: 562
batch 600, loss: 3.0640, instance_loss: 0.1708, weighted_loss: 2.1960, label: 2, bag_size: 138
batch 700, loss: 2.4048, instance_loss: 0.1418, weighted_loss: 1.7259, label: 2, bag_size: 555
batch 800, loss: 2.0802, instance_loss: 0.2141, weighted_loss: 1.5204, label: 6, bag_size: 242
batch 900, loss: 0.5712, instance_loss: 0.1122, weighted_loss: 0.4335, label: 2, bag_size: 333
batch 1000, loss: 0.1034, instance_loss: 0.0585, weighted_loss: 0.0899, label: 5, bag_size: 261
batch 1100, loss: 0.0733, instance_loss: 0.0874, weighted_loss: 0.0776, label: 5, bag_size: 83
batch 1200, loss: 2.9207, instance_loss: 0.2064, weighted_loss: 2.1064, label: 7, bag_size: 172
batch 1300, loss: 3.9170, instance_loss: 0.2065, weighted_loss: 2.8039, label: 8, bag_size: 276
batch 1400, loss: 0.6863, instance_loss: 0.1100, weighted_loss: 0.5134, label: 2, bag_size: 392
batch 1500, loss: 3.0721, instance_loss: 0.1884, weighted_loss: 2.2070, label: 2, bag_size: 1650
batch 1600, loss: 0.3950, instance_loss: 0.0735, weighted_loss: 0.2986, label: 5, bag_size: 537
batch 1700, loss: 6.5375, instance_loss: 0.2410, weighted_loss: 4.6486, label: 8, bag_size: 568
batch 1800, loss: 4.5030, instance_loss: 0.2062, weighted_loss: 3.2139, label: 7, bag_size: 274
batch 1900, loss: 2.0291, instance_loss: 0.1334, weighted_loss: 1.4604, label: 5, bag_size: 986
batch 2000, loss: 0.2498, instance_loss: 0.0579, weighted_loss: 0.1922, label: 5, bag_size: 815
batch 2100, loss: 2.3161, instance_loss: 0.1390, weighted_loss: 1.6630, label: 2, bag_size: 161

Instance Classifier Stats
class 0 clustering acc 0.9988018433179724: correct 260088/260400
class 1 clustering acc 0.07137096774193548: correct 1239/17360

Epoch: 42, train_loss: 2.1923, train_clustering_loss: 0.1658, train_error: 0.5018
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6432225063938619, correct coarse 503/782 
coarse class 2: coarse acc 0.8666053357865685, correct coarse 942/1087 
coarse class 3: coarse acc 0.06614785992217899, correct coarse 17/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6015473887814313, correct fine 311/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.12173913043478261, correct fine 14/115 
fine class 5: fine acc 0.8854415274463007, correct fine 742/838 
fine class 6: fine acc 0.04417670682730924, correct fine 11/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2259, coarse auc: 0.7841, fine auc: 0.7689 
class 0 clustering acc 0.9990530303030303: correct 31650/31680 
class 1 clustering acc 0.10416666666666667: correct 220/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4129
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1180

Training for coarse_and_fine level...
batch 100, loss: 2.3036, instance_loss: 0.1770, weighted_loss: 1.6657, label: 2, bag_size: 568
batch 200, loss: 1.0789, instance_loss: 0.1196, weighted_loss: 0.7911, label: 5, bag_size: 318
batch 300, loss: 3.2707, instance_loss: 0.2213, weighted_loss: 2.3559, label: 8, bag_size: 663
batch 400, loss: 3.8551, instance_loss: 0.2342, weighted_loss: 2.7688, label: 4, bag_size: 324
batch 500, loss: 1.4127, instance_loss: 0.1357, weighted_loss: 1.0296, label: 5, bag_size: 41
batch 600, loss: 2.3043, instance_loss: 0.1699, weighted_loss: 1.6640, label: 2, bag_size: 641
batch 700, loss: 0.0811, instance_loss: 0.0668, weighted_loss: 0.0768, label: 5, bag_size: 451
batch 800, loss: 2.5066, instance_loss: 0.1796, weighted_loss: 1.8085, label: 5, bag_size: 311
batch 900, loss: 0.4900, instance_loss: 0.1117, weighted_loss: 0.3765, label: 2, bag_size: 547
batch 1000, loss: 1.3462, instance_loss: 0.1453, weighted_loss: 0.9859, label: 2, bag_size: 374
batch 1100, loss: 1.8843, instance_loss: 0.2482, weighted_loss: 1.3934, label: 3, bag_size: 837
batch 1200, loss: 0.3534, instance_loss: 0.0829, weighted_loss: 0.2722, label: 5, bag_size: 565
batch 1300, loss: 1.2632, instance_loss: 0.1099, weighted_loss: 0.9172, label: 5, bag_size: 776
batch 1400, loss: 5.2078, instance_loss: 0.2551, weighted_loss: 3.7220, label: 7, bag_size: 542
batch 1500, loss: 0.7504, instance_loss: 0.1109, weighted_loss: 0.5585, label: 5, bag_size: 339
batch 1600, loss: 7.3256, instance_loss: 0.2714, weighted_loss: 5.2094, label: 1, bag_size: 554
batch 1700, loss: 3.0366, instance_loss: 0.1710, weighted_loss: 2.1769, label: 2, bag_size: 138
batch 1800, loss: 1.0852, instance_loss: 0.1507, weighted_loss: 0.8048, label: 2, bag_size: 1479
batch 1900, loss: 1.8457, instance_loss: 0.1981, weighted_loss: 1.3514, label: 3, bag_size: 526
batch 2000, loss: 0.0854, instance_loss: 0.0592, weighted_loss: 0.0776, label: 5, bag_size: 336
batch 2100, loss: 1.0380, instance_loss: 0.1061, weighted_loss: 0.7584, label: 5, bag_size: 307

Instance Classifier Stats
class 0 clustering acc 0.9988748079877112: correct 260107/260400
class 1 clustering acc 0.07309907834101383: correct 1269/17360

Epoch: 43, train_loss: 2.1881, train_clustering_loss: 0.1658, train_error: 0.4986
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.8702851885924563, correct coarse 946/1087 
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.620889748549323, correct fine 321/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.12173913043478261, correct fine 14/115 
fine class 5: fine acc 0.8794749403341289, correct fine 737/838 
fine class 6: fine acc 0.05220883534136546, correct fine 13/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2217, coarse auc: 0.7854, fine auc: 0.7699 
class 0 clustering acc 0.9989267676767677: correct 31646/31680 
class 1 clustering acc 0.10984848484848485: correct 232/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4118
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1157

Training for coarse_and_fine level...
batch 100, loss: 2.2099, instance_loss: 0.1412, weighted_loss: 1.5893, label: 5, bag_size: 1355
batch 200, loss: 2.6665, instance_loss: 0.1398, weighted_loss: 1.9085, label: 2, bag_size: 179
batch 300, loss: 2.8739, instance_loss: 0.1858, weighted_loss: 2.0675, label: 5, bag_size: 237
batch 400, loss: 1.9698, instance_loss: 0.1586, weighted_loss: 1.4265, label: 5, bag_size: 986
batch 500, loss: 1.7791, instance_loss: 0.1930, weighted_loss: 1.3032, label: 3, bag_size: 3011
batch 600, loss: 2.0803, instance_loss: 0.2069, weighted_loss: 1.5183, label: 6, bag_size: 367
batch 700, loss: 2.4205, instance_loss: 0.1728, weighted_loss: 1.7462, label: 2, bag_size: 343
batch 800, loss: 0.2829, instance_loss: 0.0655, weighted_loss: 0.2177, label: 5, bag_size: 221
batch 900, loss: 3.7870, instance_loss: 0.2150, weighted_loss: 2.7154, label: 2, bag_size: 377
batch 1000, loss: 2.2560, instance_loss: 0.2111, weighted_loss: 1.6425, label: 3, bag_size: 589
batch 1100, loss: 2.5759, instance_loss: 0.1800, weighted_loss: 1.8571, label: 2, bag_size: 613
batch 1200, loss: 2.8293, instance_loss: 0.1790, weighted_loss: 2.0342, label: 2, bag_size: 446
batch 1300, loss: 2.7352, instance_loss: 0.1749, weighted_loss: 1.9671, label: 5, bag_size: 469
batch 1400, loss: 4.0858, instance_loss: 0.2439, weighted_loss: 2.9332, label: 4, bag_size: 295
batch 1500, loss: 7.8613, instance_loss: 0.3043, weighted_loss: 5.5942, label: 4, bag_size: 510
batch 1600, loss: 1.7341, instance_loss: 0.2068, weighted_loss: 1.2759, label: 3, bag_size: 1831
batch 1700, loss: 2.1849, instance_loss: 0.2065, weighted_loss: 1.5914, label: 6, bag_size: 507
batch 1800, loss: 3.8331, instance_loss: 0.2647, weighted_loss: 2.7626, label: 7, bag_size: 778
batch 1900, loss: 3.6184, instance_loss: 0.2315, weighted_loss: 2.6023, label: 8, bag_size: 2076
batch 2000, loss: 3.1156, instance_loss: 0.2248, weighted_loss: 2.2484, label: 7, bag_size: 665
batch 2100, loss: 0.1331, instance_loss: 0.0609, weighted_loss: 0.1114, label: 5, bag_size: 969

Instance Classifier Stats
class 0 clustering acc 0.9988018433179724: correct 260088/260400
class 1 clustering acc 0.07384792626728111: correct 1282/17360

Epoch: 44, train_loss: 2.1838, train_clustering_loss: 0.1656, train_error: 0.4959
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6054158607350096, correct fine 313/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1826086956521739, correct fine 21/115 
fine class 5: fine acc 0.8854415274463007, correct fine 742/838 
fine class 6: fine acc 0.060240963855421686, correct fine 15/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2189, coarse auc: 0.7857, fine auc: 0.7712 
class 0 clustering acc 0.9988636363636364: correct 31644/31680 
class 1 clustering acc 0.11600378787878787: correct 245/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6780
Coarse Overall F1 Score: 0.4099
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1149

Training for coarse_and_fine level...
batch 100, loss: 2.0738, instance_loss: 0.1570, weighted_loss: 1.4988, label: 5, bag_size: 604
batch 200, loss: 3.6348, instance_loss: 0.2063, weighted_loss: 2.6062, label: 2, bag_size: 449
batch 300, loss: 1.0531, instance_loss: 0.1159, weighted_loss: 0.7719, label: 5, bag_size: 494
batch 400, loss: 1.7903, instance_loss: 0.2001, weighted_loss: 1.3132, label: 6, bag_size: 481
batch 500, loss: 2.5096, instance_loss: 0.1773, weighted_loss: 1.8099, label: 6, bag_size: 2046
batch 600, loss: 3.0828, instance_loss: 0.2201, weighted_loss: 2.2240, label: 8, bag_size: 327
batch 700, loss: 2.0409, instance_loss: 0.1615, weighted_loss: 1.4771, label: 2, bag_size: 1618
batch 800, loss: 3.3832, instance_loss: 0.1800, weighted_loss: 2.4223, label: 2, bag_size: 475
batch 900, loss: 2.0604, instance_loss: 0.2071, weighted_loss: 1.5044, label: 3, bag_size: 1313
batch 1000, loss: 2.0044, instance_loss: 0.2095, weighted_loss: 1.4660, label: 3, bag_size: 1120
batch 1100, loss: 1.3297, instance_loss: 0.2479, weighted_loss: 1.0052, label: 4, bag_size: 1534
batch 1200, loss: 2.6535, instance_loss: 0.1904, weighted_loss: 1.9146, label: 2, bag_size: 534
batch 1300, loss: 2.5848, instance_loss: 0.1742, weighted_loss: 1.8616, label: 5, bag_size: 276
batch 1400, loss: 1.7654, instance_loss: 0.1400, weighted_loss: 1.2777, label: 5, bag_size: 513
batch 1500, loss: 1.2649, instance_loss: 0.1168, weighted_loss: 0.9205, label: 5, bag_size: 776
batch 1600, loss: 3.8584, instance_loss: 0.2072, weighted_loss: 2.7631, label: 7, bag_size: 778
batch 1700, loss: 2.3203, instance_loss: 0.1062, weighted_loss: 1.6561, label: 5, bag_size: 746
batch 1800, loss: 4.8412, instance_loss: 0.2038, weighted_loss: 3.4499, label: 6, bag_size: 1123
batch 1900, loss: 2.7156, instance_loss: 0.1327, weighted_loss: 1.9407, label: 5, bag_size: 509
batch 2000, loss: 0.1778, instance_loss: 0.0681, weighted_loss: 0.1449, label: 5, bag_size: 728
batch 2100, loss: 2.0956, instance_loss: 0.1624, weighted_loss: 1.5156, label: 5, bag_size: 290

Instance Classifier Stats
class 0 clustering acc 0.9987980030721966: correct 260087/260400
class 1 clustering acc 0.0777073732718894: correct 1349/17360

Epoch: 45, train_loss: 2.1785, train_clustering_loss: 0.1650, train_error: 0.4959
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.8712051517939282, correct coarse 947/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5996131528046421, correct fine 310/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1826086956521739, correct fine 21/115 
fine class 5: fine acc 0.8902147971360382, correct fine 746/838 
fine class 6: fine acc 0.05622489959839357, correct fine 14/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2158, coarse auc: 0.7862, fine auc: 0.7717 
class 0 clustering acc 0.9987689393939394: correct 31641/31680 
class 1 clustering acc 0.11931818181818182: correct 252/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6780
Coarse Overall F1 Score: 0.4092
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1149

Training for coarse_and_fine level...
batch 100, loss: 2.1490, instance_loss: 0.2386, weighted_loss: 1.5758, label: 4, bag_size: 160
batch 200, loss: 0.1504, instance_loss: 0.0610, weighted_loss: 0.1236, label: 5, bag_size: 724
batch 300, loss: 2.9262, instance_loss: 0.1908, weighted_loss: 2.1056, label: 2, bag_size: 190
batch 400, loss: 1.9645, instance_loss: 0.1539, weighted_loss: 1.4213, label: 5, bag_size: 394
batch 500, loss: 3.1726, instance_loss: 0.1753, weighted_loss: 2.2734, label: 2, bag_size: 217
batch 600, loss: 3.4558, instance_loss: 0.1971, weighted_loss: 2.4782, label: 6, bag_size: 608
batch 700, loss: 3.6500, instance_loss: 0.1961, weighted_loss: 2.6138, label: 6, bag_size: 276
batch 800, loss: 0.3090, instance_loss: 0.0620, weighted_loss: 0.2349, label: 5, bag_size: 875
batch 900, loss: 3.6253, instance_loss: 0.2035, weighted_loss: 2.5988, label: 2, bag_size: 235
batch 1000, loss: 6.4244, instance_loss: 0.2409, weighted_loss: 4.5693, label: 1, bag_size: 153
batch 1100, loss: 2.5826, instance_loss: 0.2030, weighted_loss: 1.8687, label: 6, bag_size: 387
batch 1200, loss: 3.6629, instance_loss: 0.2112, weighted_loss: 2.6274, label: 3, bag_size: 459
batch 1300, loss: 2.8015, instance_loss: 0.2083, weighted_loss: 2.0235, label: 8, bag_size: 619
batch 1400, loss: 2.2826, instance_loss: 0.2090, weighted_loss: 1.6605, label: 3, bag_size: 459
batch 1500, loss: 0.4736, instance_loss: 0.0607, weighted_loss: 0.3498, label: 5, bag_size: 242
batch 1600, loss: 3.6595, instance_loss: 0.2159, weighted_loss: 2.6264, label: 6, bag_size: 379
batch 1700, loss: 0.4662, instance_loss: 0.0791, weighted_loss: 0.3501, label: 5, bag_size: 765
batch 1800, loss: 4.5362, instance_loss: 0.2018, weighted_loss: 3.2359, label: 3, bag_size: 202
batch 1900, loss: 2.5943, instance_loss: 0.1823, weighted_loss: 1.8707, label: 2, bag_size: 534
batch 2000, loss: 5.5424, instance_loss: 0.2350, weighted_loss: 3.9502, label: 2, bag_size: 665
batch 2100, loss: 1.4055, instance_loss: 0.2197, weighted_loss: 1.0498, label: 6, bag_size: 732

Instance Classifier Stats
class 0 clustering acc 0.998721198156682: correct 260067/260400
class 1 clustering acc 0.08070276497695852: correct 1401/17360

Epoch: 46, train_loss: 2.1745, train_clustering_loss: 0.1652, train_error: 0.4922
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6054158607350096, correct fine 313/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1826086956521739, correct fine 21/115 
fine class 5: fine acc 0.8926014319809069, correct fine 748/838 
fine class 6: fine acc 0.0642570281124498, correct fine 16/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2137, coarse auc: 0.7858, fine auc: 0.7723 
class 0 clustering acc 0.9987373737373737: correct 31640/31680 
class 1 clustering acc 0.11931818181818182: correct 252/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4118
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1266

Training for coarse_and_fine level...
batch 100, loss: 3.6036, instance_loss: 0.2411, weighted_loss: 2.5948, label: 2, bag_size: 2139
batch 200, loss: 4.4662, instance_loss: 0.2031, weighted_loss: 3.1873, label: 8, bag_size: 153
batch 300, loss: 0.8967, instance_loss: 0.1343, weighted_loss: 0.6680, label: 2, bag_size: 1085
batch 400, loss: 2.0651, instance_loss: 0.2094, weighted_loss: 1.5084, label: 6, bag_size: 367
batch 500, loss: 3.1859, instance_loss: 0.2141, weighted_loss: 2.2944, label: 7, bag_size: 258
batch 600, loss: 0.7836, instance_loss: 0.1393, weighted_loss: 0.5903, label: 2, bag_size: 848
batch 700, loss: 2.5819, instance_loss: 0.2058, weighted_loss: 1.8691, label: 6, bag_size: 1339
batch 800, loss: 0.2630, instance_loss: 0.0901, weighted_loss: 0.2112, label: 5, bag_size: 256
batch 900, loss: 0.8928, instance_loss: 0.1125, weighted_loss: 0.6587, label: 2, bag_size: 232
batch 1000, loss: 2.2298, instance_loss: 0.1988, weighted_loss: 1.6205, label: 2, bag_size: 654
batch 1100, loss: 3.0505, instance_loss: 0.2326, weighted_loss: 2.2051, label: 3, bag_size: 427
batch 1200, loss: 1.9424, instance_loss: 0.1569, weighted_loss: 1.4067, label: 2, bag_size: 1618
batch 1300, loss: 2.4314, instance_loss: 0.2100, weighted_loss: 1.7650, label: 3, bag_size: 942
batch 1400, loss: 1.3896, instance_loss: 0.1428, weighted_loss: 1.0156, label: 5, bag_size: 236
batch 1500, loss: 2.0137, instance_loss: 0.2006, weighted_loss: 1.4698, label: 6, bag_size: 263
batch 1600, loss: 0.1976, instance_loss: 0.0647, weighted_loss: 0.1577, label: 5, bag_size: 658
batch 1700, loss: 2.0950, instance_loss: 0.2415, weighted_loss: 1.5389, label: 4, bag_size: 786
batch 1800, loss: 2.2567, instance_loss: 0.1529, weighted_loss: 1.6255, label: 5, bag_size: 188
batch 1900, loss: 2.1977, instance_loss: 0.1850, weighted_loss: 1.5939, label: 2, bag_size: 190
batch 2000, loss: 2.4435, instance_loss: 0.2579, weighted_loss: 1.7878, label: 6, bag_size: 762
batch 2100, loss: 0.8267, instance_loss: 0.0834, weighted_loss: 0.6037, label: 5, bag_size: 585

Instance Classifier Stats
class 0 clustering acc 0.9986751152073733: correct 260055/260400
class 1 clustering acc 0.08243087557603687: correct 1431/17360

Epoch: 47, train_loss: 2.1695, train_clustering_loss: 0.1646, train_error: 0.4894
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6406649616368286, correct coarse 501/782 
coarse class 2: coarse acc 0.8712051517939282, correct coarse 947/1087 
coarse class 3: coarse acc 0.08560311284046693, correct coarse 22/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6054158607350096, correct fine 313/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.19130434782608696, correct fine 22/115 
fine class 5: fine acc 0.8937947494033412, correct fine 749/838 
fine class 6: fine acc 0.07228915662650602, correct fine 18/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2108, coarse auc: 0.7863, fine auc: 0.7733 
class 0 clustering acc 0.9986111111111111: correct 31636/31680 
class 1 clustering acc 0.125: correct 264/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4118
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1369

Training for coarse_and_fine level...
batch 100, loss: 0.5854, instance_loss: 0.1243, weighted_loss: 0.4471, label: 2, bag_size: 826
batch 200, loss: 6.6157, instance_loss: 0.3211, weighted_loss: 4.7273, label: 10, bag_size: 309
batch 300, loss: 3.0747, instance_loss: 0.2276, weighted_loss: 2.2206, label: 7, bag_size: 152
batch 400, loss: 1.2461, instance_loss: 0.0929, weighted_loss: 0.9001, label: 5, bag_size: 838
batch 500, loss: 0.5280, instance_loss: 0.0838, weighted_loss: 0.3947, label: 5, bag_size: 1032
batch 600, loss: 2.0246, instance_loss: 0.1628, weighted_loss: 1.4661, label: 2, bag_size: 459
batch 700, loss: 1.5772, instance_loss: 0.1098, weighted_loss: 1.1370, label: 5, bag_size: 337
batch 800, loss: 2.4963, instance_loss: 0.1755, weighted_loss: 1.8001, label: 2, bag_size: 575
batch 900, loss: 5.5092, instance_loss: 0.3026, weighted_loss: 3.9472, label: 10, bag_size: 310
batch 1000, loss: 0.3590, instance_loss: 0.0841, weighted_loss: 0.2765, label: 5, bag_size: 537
batch 1100, loss: 2.1688, instance_loss: 0.1980, weighted_loss: 1.5775, label: 6, bag_size: 138
batch 1200, loss: 3.0349, instance_loss: 0.2242, weighted_loss: 2.1917, label: 8, bag_size: 327
batch 1300, loss: 0.3629, instance_loss: 0.0809, weighted_loss: 0.2783, label: 5, bag_size: 475
batch 1400, loss: 3.4552, instance_loss: 0.2063, weighted_loss: 2.4805, label: 8, bag_size: 2076
batch 1500, loss: 1.3454, instance_loss: 0.2791, weighted_loss: 1.0256, label: 4, bag_size: 889
batch 1600, loss: 2.5420, instance_loss: 0.1869, weighted_loss: 1.8355, label: 2, bag_size: 421
batch 1700, loss: 2.1011, instance_loss: 0.1781, weighted_loss: 1.5242, label: 2, bag_size: 858
batch 1800, loss: 2.1357, instance_loss: 0.1700, weighted_loss: 1.5460, label: 2, bag_size: 296
batch 1900, loss: 0.2147, instance_loss: 0.0738, weighted_loss: 0.1724, label: 5, bag_size: 745
batch 2000, loss: 2.1557, instance_loss: 0.2109, weighted_loss: 1.5722, label: 6, bag_size: 334
batch 2100, loss: 3.7062, instance_loss: 0.2387, weighted_loss: 2.6659, label: 3, bag_size: 657

Instance Classifier Stats
class 0 clustering acc 0.9985253456221198: correct 260016/260400
class 1 clustering acc 0.08836405529953917: correct 1534/17360

Epoch: 48, train_loss: 2.1661, train_clustering_loss: 0.1649, train_error: 0.4935
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5918762088974855, correct fine 306/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.19130434782608696, correct fine 22/115 
fine class 5: fine acc 0.8926014319809069, correct fine 748/838 
fine class 6: fine acc 0.07630522088353414, correct fine 19/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2096, coarse auc: 0.7860, fine auc: 0.7740 
class 0 clustering acc 0.9986742424242424: correct 31638/31680 
class 1 clustering acc 0.12357954545454546: correct 261/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4115
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1269

Training for coarse_and_fine level...
batch 100, loss: 4.2113, instance_loss: 0.2114, weighted_loss: 3.0113, label: 2, bag_size: 302
batch 200, loss: 8.6689, instance_loss: 0.2927, weighted_loss: 6.1560, label: 8, bag_size: 1009
batch 300, loss: 2.5790, instance_loss: 0.1960, weighted_loss: 1.8641, label: 6, bag_size: 284
batch 400, loss: 5.3656, instance_loss: 0.2620, weighted_loss: 3.8345, label: 1, bag_size: 132
batch 500, loss: 1.2896, instance_loss: 0.1282, weighted_loss: 0.9412, label: 5, bag_size: 696
batch 600, loss: 7.7640, instance_loss: 0.2865, weighted_loss: 5.5207, label: 7, bag_size: 2158
batch 700, loss: 3.4950, instance_loss: 0.2384, weighted_loss: 2.5180, label: 8, bag_size: 372
batch 800, loss: 1.8865, instance_loss: 0.1976, weighted_loss: 1.3798, label: 3, bag_size: 567
batch 900, loss: 2.9589, instance_loss: 0.1640, weighted_loss: 2.1204, label: 5, bag_size: 404
batch 1000, loss: 1.7073, instance_loss: 0.1496, weighted_loss: 1.2400, label: 5, bag_size: 187
batch 1100, loss: 2.2785, instance_loss: 0.1828, weighted_loss: 1.6498, label: 2, bag_size: 565
batch 1200, loss: 0.3624, instance_loss: 0.0711, weighted_loss: 0.2750, label: 5, bag_size: 753
batch 1300, loss: 4.1851, instance_loss: 0.2111, weighted_loss: 2.9929, label: 6, bag_size: 395
batch 1400, loss: 3.1686, instance_loss: 0.1983, weighted_loss: 2.2775, label: 6, bag_size: 219
batch 1500, loss: 1.4853, instance_loss: 0.1129, weighted_loss: 1.0736, label: 2, bag_size: 1084
batch 1600, loss: 4.3387, instance_loss: 0.2269, weighted_loss: 3.1052, label: 8, bag_size: 268
batch 1700, loss: 1.6942, instance_loss: 0.1758, weighted_loss: 1.2387, label: 5, bag_size: 522
batch 1800, loss: 2.2902, instance_loss: 0.2043, weighted_loss: 1.6644, label: 2, bag_size: 568
batch 1900, loss: 3.0156, instance_loss: 0.2131, weighted_loss: 2.1748, label: 7, bag_size: 665
batch 2000, loss: 0.3211, instance_loss: 0.0748, weighted_loss: 0.2472, label: 5, bag_size: 640
batch 2100, loss: 1.2860, instance_loss: 0.1583, weighted_loss: 0.9477, label: 2, bag_size: 165

Instance Classifier Stats
class 0 clustering acc 0.9985637480798771: correct 260026/260400
class 1 clustering acc 0.0896889400921659: correct 1557/17360

Epoch: 49, train_loss: 2.1630, train_clustering_loss: 0.1646, train_error: 0.4908
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6419437340153452, correct coarse 502/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2, correct fine 23/115 
fine class 5: fine acc 0.8914081145584726, correct fine 747/838 
fine class 6: fine acc 0.08032128514056225, correct fine 20/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2067, coarse auc: 0.7865, fine auc: 0.7758 
class 0 clustering acc 0.9987058080808081: correct 31639/31680 
class 1 clustering acc 0.12357954545454546: correct 261/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4118
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1365

Training for coarse_and_fine level...
batch 100, loss: 0.1686, instance_loss: 0.0644, weighted_loss: 0.1374, label: 5, bag_size: 484
batch 200, loss: 2.4924, instance_loss: 0.1762, weighted_loss: 1.7975, label: 5, bag_size: 124
batch 300, loss: 0.3078, instance_loss: 0.0730, weighted_loss: 0.2374, label: 5, bag_size: 714
batch 400, loss: 1.9548, instance_loss: 0.1589, weighted_loss: 1.4161, label: 2, bag_size: 459
batch 500, loss: 2.1223, instance_loss: 0.1857, weighted_loss: 1.5413, label: 6, bag_size: 1122
batch 600, loss: 3.0899, instance_loss: 0.2067, weighted_loss: 2.2250, label: 8, bag_size: 679
batch 700, loss: 0.1172, instance_loss: 0.0517, weighted_loss: 0.0976, label: 5, bag_size: 700
batch 800, loss: 0.6546, instance_loss: 0.1760, weighted_loss: 0.5111, label: 2, bag_size: 1404
batch 900, loss: 3.1702, instance_loss: 0.2024, weighted_loss: 2.2798, label: 8, bag_size: 384
batch 1000, loss: 1.8575, instance_loss: 0.1359, weighted_loss: 1.3410, label: 5, bag_size: 214
batch 1100, loss: 1.1437, instance_loss: 0.1266, weighted_loss: 0.8386, label: 2, bag_size: 193
batch 1200, loss: 0.9065, instance_loss: 0.1581, weighted_loss: 0.6819, label: 2, bag_size: 601
batch 1300, loss: 1.7027, instance_loss: 0.1471, weighted_loss: 1.2360, label: 5, bag_size: 599
batch 1400, loss: 0.3582, instance_loss: 0.0834, weighted_loss: 0.2758, label: 5, bag_size: 330
batch 1500, loss: 1.3475, instance_loss: 0.1183, weighted_loss: 0.9788, label: 5, bag_size: 735
batch 1600, loss: 0.5510, instance_loss: 0.1080, weighted_loss: 0.4181, label: 2, bag_size: 1099
batch 1700, loss: 0.1631, instance_loss: 0.0576, weighted_loss: 0.1315, label: 5, bag_size: 1140
batch 1800, loss: 4.5589, instance_loss: 0.2620, weighted_loss: 3.2698, label: 3, bag_size: 188
batch 1900, loss: 3.5198, instance_loss: 0.2262, weighted_loss: 2.5317, label: 8, bag_size: 378
batch 2000, loss: 0.1131, instance_loss: 0.0552, weighted_loss: 0.0957, label: 5, bag_size: 403
batch 2100, loss: 1.4356, instance_loss: 0.1299, weighted_loss: 1.0439, label: 2, bag_size: 2612

Instance Classifier Stats
class 0 clustering acc 0.998636712749616: correct 260045/260400
class 1 clustering acc 0.08536866359447004: correct 1482/17360

Epoch: 50, train_loss: 2.1593, train_clustering_loss: 0.1644, train_error: 0.4903
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8684452621895125, correct coarse 944/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6073500967117988, correct fine 314/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.8842482100238663, correct fine 741/838 
fine class 6: fine acc 0.09236947791164658, correct fine 23/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2034, coarse auc: 0.7870, fine auc: 0.7745 
class 0 clustering acc 0.9986111111111111: correct 31636/31680 
class 1 clustering acc 0.13020833333333334: correct 275/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4118
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1369

Training for coarse_and_fine level...
batch 100, loss: 1.4898, instance_loss: 0.1484, weighted_loss: 1.0874, label: 5, bag_size: 577
batch 200, loss: 2.4790, instance_loss: 0.1723, weighted_loss: 1.7870, label: 5, bag_size: 132
batch 300, loss: 0.3407, instance_loss: 0.0901, weighted_loss: 0.2655, label: 5, bag_size: 866
batch 400, loss: 0.2903, instance_loss: 0.0830, weighted_loss: 0.2281, label: 5, bag_size: 400
batch 500, loss: 0.2152, instance_loss: 0.0701, weighted_loss: 0.1717, label: 5, bag_size: 360
batch 600, loss: 0.6463, instance_loss: 0.1211, weighted_loss: 0.4887, label: 2, bag_size: 1052
batch 700, loss: 1.7233, instance_loss: 0.2295, weighted_loss: 1.2752, label: 6, bag_size: 235
batch 800, loss: 2.2146, instance_loss: 0.2170, weighted_loss: 1.6153, label: 6, bag_size: 1122
batch 900, loss: 0.3245, instance_loss: 0.0686, weighted_loss: 0.2478, label: 5, bag_size: 574
batch 1000, loss: 1.7871, instance_loss: 0.1343, weighted_loss: 1.2912, label: 5, bag_size: 714
batch 1100, loss: 11.1552, instance_loss: 0.3775, weighted_loss: 7.9219, label: 3, bag_size: 477
batch 1200, loss: 2.6010, instance_loss: 0.2557, weighted_loss: 1.8974, label: 4, bag_size: 1400
batch 1300, loss: 4.0583, instance_loss: 0.2292, weighted_loss: 2.9095, label: 8, bag_size: 347
batch 1400, loss: 2.3050, instance_loss: 0.1713, weighted_loss: 1.6649, label: 2, bag_size: 183
batch 1500, loss: 0.3062, instance_loss: 0.0654, weighted_loss: 0.2340, label: 5, bag_size: 796
batch 1600, loss: 5.5770, instance_loss: 0.2840, weighted_loss: 3.9891, label: 10, bag_size: 162
batch 1700, loss: 5.5451, instance_loss: 0.2834, weighted_loss: 3.9666, label: 8, bag_size: 380
batch 1800, loss: 1.6621, instance_loss: 0.1592, weighted_loss: 1.2112, label: 5, bag_size: 337
batch 1900, loss: 0.8769, instance_loss: 0.1271, weighted_loss: 0.6520, label: 2, bag_size: 177
batch 2000, loss: 2.1983, instance_loss: 0.1811, weighted_loss: 1.5932, label: 5, bag_size: 352
batch 2100, loss: 1.2776, instance_loss: 0.1284, weighted_loss: 0.9328, label: 2, bag_size: 1617

Instance Classifier Stats
class 0 clustering acc 0.9985138248847927: correct 260013/260400
class 1 clustering acc 0.09101382488479262: correct 1580/17360

Epoch: 51, train_loss: 2.1544, train_clustering_loss: 0.1641, train_error: 0.4917
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6329923273657289, correct coarse 495/782 
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087 
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.597678916827853, correct fine 309/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.8878281622911695, correct fine 744/838 
fine class 6: fine acc 0.08835341365461848, correct fine 22/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2009, coarse auc: 0.7869, fine auc: 0.7760 
class 0 clustering acc 0.9986111111111111: correct 31636/31680 
class 1 clustering acc 0.13068181818181818: correct 276/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6780
Coarse Overall F1 Score: 0.4092
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1362

Training for coarse_and_fine level...
batch 100, loss: 4.6455, instance_loss: 0.2520, weighted_loss: 3.3275, label: 8, bag_size: 751
batch 200, loss: 3.3200, instance_loss: 0.2087, weighted_loss: 2.3866, label: 2, bag_size: 726
batch 300, loss: 2.1743, instance_loss: 0.2149, weighted_loss: 1.5865, label: 6, bag_size: 488
batch 400, loss: 0.1930, instance_loss: 0.0649, weighted_loss: 0.1546, label: 5, bag_size: 409
batch 500, loss: 3.9182, instance_loss: 0.2106, weighted_loss: 2.8060, label: 6, bag_size: 144
batch 600, loss: 0.0875, instance_loss: 0.0420, weighted_loss: 0.0738, label: 5, bag_size: 563
batch 700, loss: 0.8602, instance_loss: 0.2562, weighted_loss: 0.6790, label: 4, bag_size: 505
batch 800, loss: 1.0905, instance_loss: 0.1127, weighted_loss: 0.7971, label: 5, bag_size: 1020
batch 900, loss: 2.0836, instance_loss: 0.1496, weighted_loss: 1.5034, label: 2, bag_size: 473
batch 1000, loss: 0.6801, instance_loss: 0.0837, weighted_loss: 0.5012, label: 5, bag_size: 499
batch 1100, loss: 3.3107, instance_loss: 0.2159, weighted_loss: 2.3822, label: 2, bag_size: 381
batch 1200, loss: 0.9267, instance_loss: 0.1144, weighted_loss: 0.6831, label: 2, bag_size: 2601
batch 1300, loss: 0.1973, instance_loss: 0.0602, weighted_loss: 0.1562, label: 5, bag_size: 651
batch 1400, loss: 2.3154, instance_loss: 0.1871, weighted_loss: 1.6769, label: 2, bag_size: 343
batch 1500, loss: 0.5183, instance_loss: 0.1029, weighted_loss: 0.3937, label: 2, bag_size: 1549
batch 1600, loss: 5.2391, instance_loss: 0.2133, weighted_loss: 3.7314, label: 2, bag_size: 107
batch 1700, loss: 0.8854, instance_loss: 0.0985, weighted_loss: 0.6494, label: 2, bag_size: 784
batch 1800, loss: 0.9768, instance_loss: 0.1291, weighted_loss: 0.7224, label: 2, bag_size: 631
batch 1900, loss: 3.1916, instance_loss: 0.1754, weighted_loss: 2.2868, label: 5, bag_size: 348
batch 2000, loss: 1.5316, instance_loss: 0.2436, weighted_loss: 1.1452, label: 6, bag_size: 361
batch 2100, loss: 0.4547, instance_loss: 0.1035, weighted_loss: 0.3493, label: 2, bag_size: 2535

Instance Classifier Stats
class 0 clustering acc 0.9985944700460829: correct 260034/260400
class 1 clustering acc 0.09585253456221199: correct 1664/17360

Epoch: 52, train_loss: 2.1516, train_clustering_loss: 0.1638, train_error: 0.4912
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5938104448742747, correct fine 307/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.89618138424821, correct fine 751/838 
fine class 6: fine acc 0.07630522088353414, correct fine 19/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1990, coarse auc: 0.7875, fine auc: 0.7770 
class 0 clustering acc 0.9986426767676768: correct 31637/31680 
class 1 clustering acc 0.13115530303030304: correct 277/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6780
Coarse Overall F1 Score: 0.4092
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1357

Training for coarse_and_fine level...
batch 100, loss: 2.3042, instance_loss: 0.1499, weighted_loss: 1.6579, label: 5, bag_size: 391
batch 200, loss: 4.4229, instance_loss: 0.2392, weighted_loss: 3.1678, label: 3, bag_size: 347
batch 300, loss: 0.2330, instance_loss: 0.0595, weighted_loss: 0.1810, label: 5, bag_size: 1325
batch 400, loss: 2.9195, instance_loss: 0.1800, weighted_loss: 2.0977, label: 2, bag_size: 618
batch 500, loss: 1.3585, instance_loss: 0.1048, weighted_loss: 0.9824, label: 5, bag_size: 455
batch 600, loss: 0.7564, instance_loss: 0.0977, weighted_loss: 0.5588, label: 5, bag_size: 482
batch 700, loss: 2.5654, instance_loss: 0.2032, weighted_loss: 1.8568, label: 6, bag_size: 1339
batch 800, loss: 2.6898, instance_loss: 0.1299, weighted_loss: 1.9218, label: 5, bag_size: 1744
batch 900, loss: 2.2880, instance_loss: 0.1151, weighted_loss: 1.6361, label: 5, bag_size: 1549
batch 1000, loss: 4.1353, instance_loss: 0.1679, weighted_loss: 2.9451, label: 5, bag_size: 3051
batch 1100, loss: 0.3709, instance_loss: 0.0677, weighted_loss: 0.2800, label: 5, bag_size: 302
batch 1200, loss: 0.1175, instance_loss: 0.0668, weighted_loss: 0.1023, label: 5, bag_size: 295
batch 1300, loss: 0.9097, instance_loss: 0.1435, weighted_loss: 0.6798, label: 2, bag_size: 182
batch 1400, loss: 0.8120, instance_loss: 0.0802, weighted_loss: 0.5925, label: 5, bag_size: 499
batch 1500, loss: 2.1331, instance_loss: 0.2429, weighted_loss: 1.5660, label: 6, bag_size: 451
batch 1600, loss: 1.0946, instance_loss: 0.2585, weighted_loss: 0.8438, label: 4, bag_size: 1387
batch 1700, loss: 2.4816, instance_loss: 0.2166, weighted_loss: 1.8021, label: 6, bag_size: 362
batch 1800, loss: 2.2877, instance_loss: 0.2536, weighted_loss: 1.6775, label: 6, bag_size: 1064
batch 1900, loss: 1.8615, instance_loss: 0.1557, weighted_loss: 1.3498, label: 5, bag_size: 344
batch 2000, loss: 1.0238, instance_loss: 0.0781, weighted_loss: 0.7401, label: 5, bag_size: 291
batch 2100, loss: 0.3951, instance_loss: 0.0639, weighted_loss: 0.2957, label: 5, bag_size: 605

Instance Classifier Stats
class 0 clustering acc 0.9985522273425499: correct 260023/260400
class 1 clustering acc 0.09095622119815668: correct 1579/17360

Epoch: 53, train_loss: 2.1501, train_clustering_loss: 0.1636, train_error: 0.4931
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5957446808510638, correct fine 308/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.8854415274463007, correct fine 742/838 
fine class 6: fine acc 0.08433734939759036, correct fine 21/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1962, coarse auc: 0.7876, fine auc: 0.7774 
class 0 clustering acc 0.9986426767676768: correct 31637/31680 
class 1 clustering acc 0.13731060606060605: correct 290/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6780
Coarse Overall F1 Score: 0.4092
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1363

Training for coarse_and_fine level...
batch 100, loss: 2.9329, instance_loss: 0.1657, weighted_loss: 2.1027, label: 2, bag_size: 558
batch 200, loss: 2.4679, instance_loss: 0.2032, weighted_loss: 1.7885, label: 2, bag_size: 371
batch 300, loss: 0.5449, instance_loss: 0.0885, weighted_loss: 0.4080, label: 5, bag_size: 667
batch 400, loss: 2.6831, instance_loss: 0.1523, weighted_loss: 1.9239, label: 5, bag_size: 309
batch 500, loss: 1.6014, instance_loss: 0.1783, weighted_loss: 1.1745, label: 6, bag_size: 92
batch 600, loss: 0.7793, instance_loss: 0.0980, weighted_loss: 0.5749, label: 5, bag_size: 545
batch 700, loss: 1.6820, instance_loss: 0.1247, weighted_loss: 1.2148, label: 5, bag_size: 742
batch 800, loss: 0.0876, instance_loss: 0.0607, weighted_loss: 0.0795, label: 5, bag_size: 439
batch 900, loss: 2.4153, instance_loss: 0.2121, weighted_loss: 1.7544, label: 6, bag_size: 1865
batch 1000, loss: 3.5911, instance_loss: 0.1824, weighted_loss: 2.5685, label: 5, bag_size: 100
batch 1100, loss: 0.2515, instance_loss: 0.0744, weighted_loss: 0.1984, label: 5, bag_size: 429
batch 1200, loss: 1.1148, instance_loss: 0.1595, weighted_loss: 0.8282, label: 6, bag_size: 89
batch 1300, loss: 0.6163, instance_loss: 0.1048, weighted_loss: 0.4629, label: 2, bag_size: 392
batch 1400, loss: 2.5360, instance_loss: 0.1618, weighted_loss: 1.8237, label: 5, bag_size: 509
batch 1500, loss: 4.2360, instance_loss: 0.2114, weighted_loss: 3.0286, label: 8, bag_size: 558
batch 1600, loss: 3.4030, instance_loss: 0.1918, weighted_loss: 2.4396, label: 6, bag_size: 926
batch 1700, loss: 2.0877, instance_loss: 0.0820, weighted_loss: 1.4860, label: 5, bag_size: 658
batch 1800, loss: 0.6592, instance_loss: 0.0753, weighted_loss: 0.4841, label: 5, bag_size: 262
batch 1900, loss: 3.1677, instance_loss: 0.2131, weighted_loss: 2.2813, label: 8, bag_size: 344
batch 2000, loss: 1.6910, instance_loss: 0.1678, weighted_loss: 1.2341, label: 2, bag_size: 766
batch 2100, loss: 6.8610, instance_loss: 0.3044, weighted_loss: 4.8940, label: 9, bag_size: 464

Instance Classifier Stats
class 0 clustering acc 0.9983678955453149: correct 259975/260400
class 1 clustering acc 0.09544930875576037: correct 1657/17360

Epoch: 54, train_loss: 2.1461, train_clustering_loss: 0.1636, train_error: 0.4880
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6240409207161125, correct coarse 488/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5899419729206963, correct fine 305/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.22608695652173913, correct fine 26/115 
fine class 5: fine acc 0.89618138424821, correct fine 751/838 
fine class 6: fine acc 0.10040160642570281, correct fine 25/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1952, coarse auc: 0.7879, fine auc: 0.7777 
class 0 clustering acc 0.9986111111111111: correct 31636/31680 
class 1 clustering acc 0.13636363636363635: correct 288/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.4073
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1357

Evaluation on Test Set...
