Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for coarse_and_fine level...
batch 100, loss: 3.7589, instance_loss: 1.2181, weighted_loss: 2.9966, label: 5, bag_size: 315
batch 200, loss: 3.8610, instance_loss: 1.2553, weighted_loss: 3.0793, label: 7, bag_size: 210
batch 300, loss: 3.6901, instance_loss: 1.1883, weighted_loss: 2.9396, label: 6, bag_size: 518
batch 400, loss: 3.7987, instance_loss: 1.2144, weighted_loss: 3.0234, label: 2, bag_size: 762
batch 500, loss: 3.8319, instance_loss: 1.1742, weighted_loss: 3.0346, label: 7, bag_size: 256
batch 600, loss: 3.5293, instance_loss: 1.2100, weighted_loss: 2.8335, label: 2, bag_size: 198
batch 700, loss: 3.4494, instance_loss: 1.1518, weighted_loss: 2.7601, label: 2, bag_size: 306
batch 800, loss: 2.9998, instance_loss: 1.1695, weighted_loss: 2.4507, label: 5, bag_size: 658
batch 900, loss: 3.3183, instance_loss: 1.1637, weighted_loss: 2.6719, label: 2, bag_size: 1263
batch 1000, loss: 3.9253, instance_loss: 1.1346, weighted_loss: 3.0881, label: 7, bag_size: 704
batch 1100, loss: 3.3546, instance_loss: 1.0678, weighted_loss: 2.6686, label: 2, bag_size: 940
batch 1200, loss: 2.7276, instance_loss: 1.0898, weighted_loss: 2.2362, label: 5, bag_size: 2141
batch 1300, loss: 2.5910, instance_loss: 1.0589, weighted_loss: 2.1314, label: 5, bag_size: 385
batch 1400, loss: 4.0804, instance_loss: 1.0280, weighted_loss: 3.1646, label: 7, bag_size: 452
batch 1500, loss: 3.2853, instance_loss: 0.9999, weighted_loss: 2.5997, label: 2, bag_size: 2239
batch 1600, loss: 2.5008, instance_loss: 0.9791, weighted_loss: 2.0443, label: 5, bag_size: 559
batch 1700, loss: 2.4266, instance_loss: 0.9886, weighted_loss: 1.9952, label: 5, bag_size: 11
batch 1800, loss: 4.9170, instance_loss: 1.0005, weighted_loss: 3.7421, label: 1, bag_size: 113
batch 1900, loss: 2.5166, instance_loss: 0.9364, weighted_loss: 2.0425, label: 5, bag_size: 121
batch 2000, loss: 4.2622, instance_loss: 0.9482, weighted_loss: 3.2680, label: 8, bag_size: 543
batch 2100, loss: 3.9695, instance_loss: 0.9174, weighted_loss: 3.0539, label: 4, bag_size: 74

Instance Classifier Stats
class 0 clustering acc 0.7690898617511521: correct 200271/260400
class 1 clustering acc 0.3917626728110599: correct 6801/17360

Epoch: 1, train_loss: 3.3280, train_clustering_loss: 1.0908, train_error: 0.6631
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.07544757033248081, correct coarse 59/782 
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087 
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.013539651837524178, correct fine 7/517 
fine class 3: fine acc 0.17333333333333334, correct fine 26/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8198090692124105, correct fine 687/838 
fine class 6: fine acc 0.04417670682730924, correct fine 11/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.9733, coarse auc: 0.5755, fine auc: 0.5618 
class 0 clustering acc 0.9634785353535353: correct 30523/31680 
class 1 clustering acc 0.08143939393939394: correct 172/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.020833333333333332, correct coarse 2/96 
coarse class 2: coarse acc 1.0, correct coarse 134/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.0, correct fine 0/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.5152
Coarse Overall F1 Score: 0.1794
Fine Overall Accuracy: 0.3939
Fine Overall F1 Score: 0.0514

Training for coarse_and_fine level...
batch 100, loss: 2.8998, instance_loss: 0.8850, weighted_loss: 2.2954, label: 2, bag_size: 149
batch 200, loss: 1.8859, instance_loss: 0.8644, weighted_loss: 1.5794, label: 5, bag_size: 444
batch 300, loss: 1.9064, instance_loss: 0.7897, weighted_loss: 1.5714, label: 5, bag_size: 460
batch 400, loss: 1.9100, instance_loss: 0.7765, weighted_loss: 1.5700, label: 5, bag_size: 468
batch 500, loss: 4.4321, instance_loss: 0.8245, weighted_loss: 3.3498, label: 8, bag_size: 307
batch 600, loss: 4.6311, instance_loss: 0.7474, weighted_loss: 3.4660, label: 7, bag_size: 760
batch 700, loss: 2.1180, instance_loss: 0.7209, weighted_loss: 1.6989, label: 5, bag_size: 202
batch 800, loss: 2.7946, instance_loss: 0.7504, weighted_loss: 2.1813, label: 2, bag_size: 440
batch 900, loss: 3.0157, instance_loss: 0.7113, weighted_loss: 2.3243, label: 6, bag_size: 2046
batch 1000, loss: 4.5602, instance_loss: 0.7118, weighted_loss: 3.4057, label: 8, bag_size: 756
batch 1100, loss: 1.7110, instance_loss: 0.6831, weighted_loss: 1.4026, label: 5, bag_size: 353
batch 1200, loss: 3.1082, instance_loss: 0.7357, weighted_loss: 2.3965, label: 3, bag_size: 1466
batch 1300, loss: 1.9381, instance_loss: 0.6370, weighted_loss: 1.5478, label: 5, bag_size: 929
batch 1400, loss: 3.9955, instance_loss: 0.6533, weighted_loss: 2.9929, label: 4, bag_size: 1079
batch 1500, loss: 2.3295, instance_loss: 0.7186, weighted_loss: 1.8462, label: 5, bag_size: 735
batch 1600, loss: 1.7075, instance_loss: 0.5979, weighted_loss: 1.3746, label: 5, bag_size: 733
batch 1700, loss: 1.6388, instance_loss: 0.5905, weighted_loss: 1.3243, label: 5, bag_size: 794
batch 1800, loss: 1.2137, instance_loss: 0.5466, weighted_loss: 1.0136, label: 5, bag_size: 169
batch 1900, loss: 1.8882, instance_loss: 0.5445, weighted_loss: 1.4851, label: 5, bag_size: 795
batch 2000, loss: 3.8665, instance_loss: 0.5419, weighted_loss: 2.8691, label: 4, bag_size: 488
batch 2100, loss: 3.3159, instance_loss: 0.5998, weighted_loss: 2.5011, label: 3, bag_size: 1947

Instance Classifier Stats
class 0 clustering acc 0.9797619047619047: correct 255130/260400
class 1 clustering acc 0.05616359447004608: correct 975/17360

Epoch: 2, train_loss: 2.8798, train_clustering_loss: 0.7021, train_error: 0.6124
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.06521739130434782, correct coarse 51/782 
coarse class 2: coarse acc 0.9926402943882244, correct coarse 1079/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.005802707930367505, correct fine 3/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 1.0, correct fine 838/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.7453, coarse auc: 0.6213, fine auc: 0.5994 
class 0 clustering acc 0.9995265151515151: correct 31665/31680 
class 1 clustering acc 0.0004734848484848485: correct 1/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.08333333333333333, correct coarse 8/96 
coarse class 2: coarse acc 1.0, correct coarse 134/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.015625, correct fine 1/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.5379
Coarse Overall F1 Score: 0.2103
Fine Overall Accuracy: 0.3977
Fine Overall F1 Score: 0.0543

Training for coarse_and_fine level...
batch 100, loss: 3.3194, instance_loss: 0.5863, weighted_loss: 2.4995, label: 3, bag_size: 510
batch 200, loss: 1.5133, instance_loss: 0.4909, weighted_loss: 1.2066, label: 5, bag_size: 394
batch 300, loss: 2.6382, instance_loss: 0.5247, weighted_loss: 2.0041, label: 2, bag_size: 2367
batch 400, loss: 1.3881, instance_loss: 0.4067, weighted_loss: 1.0937, label: 5, bag_size: 473
batch 500, loss: 1.6597, instance_loss: 0.4444, weighted_loss: 1.2951, label: 5, bag_size: 2114
batch 600, loss: 1.2675, instance_loss: 0.4707, weighted_loss: 1.0285, label: 5, bag_size: 403
batch 700, loss: 1.4079, instance_loss: 0.5177, weighted_loss: 1.1409, label: 5, bag_size: 262
batch 800, loss: 1.4100, instance_loss: 0.4361, weighted_loss: 1.1179, label: 5, bag_size: 1564
batch 900, loss: 3.0449, instance_loss: 0.4365, weighted_loss: 2.2624, label: 6, bag_size: 534
batch 1000, loss: 1.6193, instance_loss: 0.4090, weighted_loss: 1.2562, label: 5, bag_size: 890
batch 1100, loss: 1.6197, instance_loss: 0.4166, weighted_loss: 1.2588, label: 5, bag_size: 422
batch 1200, loss: 4.0025, instance_loss: 0.4899, weighted_loss: 2.9487, label: 4, bag_size: 225
batch 1300, loss: 1.4696, instance_loss: 0.4092, weighted_loss: 1.1515, label: 5, bag_size: 341
batch 1400, loss: 1.7937, instance_loss: 0.4042, weighted_loss: 1.3769, label: 5, bag_size: 466
batch 1500, loss: 3.4566, instance_loss: 0.4455, weighted_loss: 2.5533, label: 3, bag_size: 1739
batch 1600, loss: 2.6542, instance_loss: 0.4240, weighted_loss: 1.9852, label: 2, bag_size: 792
batch 1700, loss: 3.2797, instance_loss: 0.4802, weighted_loss: 2.4399, label: 3, bag_size: 1632
batch 1800, loss: 2.7015, instance_loss: 0.3463, weighted_loss: 1.9949, label: 2, bag_size: 983
batch 1900, loss: 1.2349, instance_loss: 0.3060, weighted_loss: 0.9563, label: 5, bag_size: 821
batch 2000, loss: 4.1302, instance_loss: 0.3554, weighted_loss: 2.9978, label: 4, bag_size: 607
batch 2100, loss: 2.8780, instance_loss: 0.3554, weighted_loss: 2.1212, label: 6, bag_size: 406

Instance Classifier Stats
class 0 clustering acc 0.9990898617511521: correct 260163/260400
class 1 clustering acc 0.004032258064516129: correct 70/17360

Epoch: 3, train_loss: 2.7482, train_clustering_loss: 0.4365, train_error: 0.6069
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.16879795396419436, correct coarse 132/782 
coarse class 2: coarse acc 0.985280588776449, correct coarse 1071/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.03288201160541586, correct fine 17/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9976133651551312, correct fine 836/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.6637, coarse auc: 0.6430, fine auc: 0.6201 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.2604166666666667, correct coarse 25/96 
coarse class 2: coarse acc 0.9701492537313433, correct coarse 130/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.0625, correct fine 4/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.5871
Coarse Overall F1 Score: 0.2747
Fine Overall Accuracy: 0.4091
Fine Overall F1 Score: 0.0626

Training for coarse_and_fine level...
batch 100, loss: 2.4620, instance_loss: 0.3627, weighted_loss: 1.8322, label: 2, bag_size: 224
batch 200, loss: 1.6398, instance_loss: 0.3122, weighted_loss: 1.2415, label: 5, bag_size: 703
batch 300, loss: 2.0262, instance_loss: 0.3713, weighted_loss: 1.5297, label: 5, bag_size: 232
batch 400, loss: 2.5324, instance_loss: 0.3853, weighted_loss: 1.8883, label: 2, bag_size: 1536
batch 500, loss: 2.9086, instance_loss: 0.3221, weighted_loss: 2.1326, label: 2, bag_size: 217
batch 600, loss: 2.8812, instance_loss: 0.3021, weighted_loss: 2.1075, label: 6, bag_size: 435
batch 700, loss: 5.3905, instance_loss: 0.3407, weighted_loss: 3.8755, label: 7, bag_size: 132
batch 800, loss: 3.0329, instance_loss: 0.3087, weighted_loss: 2.2157, label: 6, bag_size: 276
batch 900, loss: 4.9171, instance_loss: 0.3452, weighted_loss: 3.5456, label: 8, bag_size: 2813
batch 1000, loss: 1.4054, instance_loss: 0.2601, weighted_loss: 1.0618, label: 5, bag_size: 857
batch 1100, loss: 2.8838, instance_loss: 0.3138, weighted_loss: 2.1128, label: 6, bag_size: 333
batch 1200, loss: 2.7844, instance_loss: 0.2808, weighted_loss: 2.0333, label: 6, bag_size: 562
batch 1300, loss: 1.4437, instance_loss: 0.2516, weighted_loss: 1.0860, label: 5, bag_size: 1422
batch 1400, loss: 2.6070, instance_loss: 0.2856, weighted_loss: 1.9106, label: 2, bag_size: 540
batch 1500, loss: 2.4392, instance_loss: 0.2609, weighted_loss: 1.7857, label: 2, bag_size: 946
batch 1600, loss: 1.3432, instance_loss: 0.2632, weighted_loss: 1.0192, label: 5, bag_size: 221
batch 1700, loss: 2.6422, instance_loss: 0.2878, weighted_loss: 1.9359, label: 2, bag_size: 1534
batch 1800, loss: 2.4306, instance_loss: 0.2647, weighted_loss: 1.7809, label: 2, bag_size: 568
batch 1900, loss: 3.6195, instance_loss: 0.3588, weighted_loss: 2.6413, label: 3, bag_size: 257
batch 2000, loss: 2.1429, instance_loss: 0.2869, weighted_loss: 1.5861, label: 2, bag_size: 941
batch 2100, loss: 4.3208, instance_loss: 0.2803, weighted_loss: 3.1087, label: 8, bag_size: 201

Instance Classifier Stats
class 0 clustering acc 0.999942396313364: correct 260385/260400
class 1 clustering acc 0.0002304147465437788: correct 4/17360

Epoch: 4, train_loss: 2.6849, train_clustering_loss: 0.3008, train_error: 0.5829
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.30051150895140666, correct coarse 235/782 
coarse class 2: coarse acc 0.954001839926403, correct coarse 1037/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.1528046421663443, correct fine 79/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9856801909307876, correct fine 826/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.6154, coarse auc: 0.6590, fine auc: 0.6324 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.3645833333333333, correct coarse 35/96 
coarse class 2: coarse acc 0.9402985074626866, correct coarse 126/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.171875, correct fine 11/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9807692307692307, correct fine 102/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6098
Coarse Overall F1 Score: 0.3012
Fine Overall Accuracy: 0.4280
Fine Overall F1 Score: 0.0769

Training for coarse_and_fine level...
batch 100, loss: 1.3581, instance_loss: 0.2336, weighted_loss: 1.0207, label: 5, bag_size: 221
batch 200, loss: 4.9376, instance_loss: 0.3179, weighted_loss: 3.5517, label: 8, bag_size: 79
batch 300, loss: 1.3707, instance_loss: 0.2439, weighted_loss: 1.0327, label: 5, bag_size: 569
batch 400, loss: 2.7975, instance_loss: 0.2369, weighted_loss: 2.0293, label: 2, bag_size: 371
batch 500, loss: 1.5529, instance_loss: 0.2762, weighted_loss: 1.1699, label: 2, bag_size: 199
batch 600, loss: 4.1960, instance_loss: 0.2777, weighted_loss: 3.0205, label: 4, bag_size: 217
batch 700, loss: 1.4438, instance_loss: 0.2182, weighted_loss: 1.0761, label: 5, bag_size: 714
batch 800, loss: 0.8928, instance_loss: 0.2091, weighted_loss: 0.6877, label: 5, bag_size: 485
batch 900, loss: 2.7996, instance_loss: 0.2212, weighted_loss: 2.0261, label: 2, bag_size: 371
batch 1000, loss: 1.2320, instance_loss: 0.2012, weighted_loss: 0.9228, label: 5, bag_size: 640
batch 1100, loss: 2.7761, instance_loss: 0.2714, weighted_loss: 2.0247, label: 6, bag_size: 182
batch 1200, loss: 1.3851, instance_loss: 0.1988, weighted_loss: 1.0292, label: 5, bag_size: 658
batch 1300, loss: 1.0923, instance_loss: 0.1893, weighted_loss: 0.8214, label: 5, bag_size: 226
batch 1400, loss: 2.8969, instance_loss: 0.2202, weighted_loss: 2.0939, label: 2, bag_size: 1667
batch 1500, loss: 4.0123, instance_loss: 0.2579, weighted_loss: 2.8860, label: 3, bag_size: 495
batch 1600, loss: 2.5553, instance_loss: 0.2042, weighted_loss: 1.8499, label: 2, bag_size: 1616
batch 1700, loss: 4.5096, instance_loss: 0.2568, weighted_loss: 3.2337, label: 8, bag_size: 372
batch 1800, loss: 1.2353, instance_loss: 0.1929, weighted_loss: 0.9226, label: 5, bag_size: 234
batch 1900, loss: 2.3771, instance_loss: 0.2595, weighted_loss: 1.7418, label: 2, bag_size: 544
batch 2000, loss: 2.4729, instance_loss: 0.1994, weighted_loss: 1.7909, label: 2, bag_size: 237
batch 2100, loss: 1.5554, instance_loss: 0.1908, weighted_loss: 1.1460, label: 5, bag_size: 888

Instance Classifier Stats
class 0 clustering acc 0.999984639016897: correct 260396/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 5, train_loss: 2.6396, train_clustering_loss: 0.2371, train_error: 0.5687
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.41304347826086957, correct coarse 323/782 
coarse class 2: coarse acc 0.9172033118675254, correct coarse 997/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.23984526112185686, correct fine 124/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9689737470167065, correct fine 812/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5789, coarse auc: 0.6703, fine auc: 0.6435 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.46875, correct coarse 45/96 
coarse class 2: coarse acc 0.917910447761194, correct coarse 123/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.3125, correct fine 20/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9326923076923077, correct fine 97/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6364
Coarse Overall F1 Score: 0.3248
Fine Overall Accuracy: 0.4432
Fine Overall F1 Score: 0.0876

Training for coarse_and_fine level...
batch 100, loss: 0.8518, instance_loss: 0.1659, weighted_loss: 0.6460, label: 5, bag_size: 2402
batch 200, loss: 2.3329, instance_loss: 0.2214, weighted_loss: 1.6994, label: 2, bag_size: 204
batch 300, loss: 2.2601, instance_loss: 0.2266, weighted_loss: 1.6500, label: 2, bag_size: 356
batch 400, loss: 2.4909, instance_loss: 0.2227, weighted_loss: 1.8105, label: 2, bag_size: 1101
batch 500, loss: 2.1167, instance_loss: 0.2365, weighted_loss: 1.5526, label: 2, bag_size: 1527
batch 600, loss: 2.5926, instance_loss: 0.2076, weighted_loss: 1.8771, label: 5, bag_size: 294
batch 700, loss: 1.3105, instance_loss: 0.1887, weighted_loss: 0.9739, label: 5, bag_size: 478
batch 800, loss: 5.4516, instance_loss: 0.2413, weighted_loss: 3.8885, label: 7, bag_size: 716
batch 900, loss: 0.6783, instance_loss: 0.1730, weighted_loss: 0.5267, label: 5, bag_size: 400
batch 1000, loss: 3.3556, instance_loss: 0.2221, weighted_loss: 2.4156, label: 3, bag_size: 749
batch 1100, loss: 2.8967, instance_loss: 0.2284, weighted_loss: 2.0962, label: 6, bag_size: 338
batch 1200, loss: 1.4888, instance_loss: 0.1642, weighted_loss: 1.0914, label: 5, bag_size: 729
batch 1300, loss: 2.0862, instance_loss: 0.2000, weighted_loss: 1.5203, label: 2, bag_size: 1256
batch 1400, loss: 1.7047, instance_loss: 0.2058, weighted_loss: 1.2550, label: 2, bag_size: 224
batch 1500, loss: 1.9043, instance_loss: 0.1715, weighted_loss: 1.3844, label: 5, bag_size: 275
batch 1600, loss: 4.5636, instance_loss: 0.2235, weighted_loss: 3.2616, label: 8, bag_size: 178
batch 1700, loss: 5.6235, instance_loss: 0.2428, weighted_loss: 4.0093, label: 8, bag_size: 419
batch 1800, loss: 1.3322, instance_loss: 0.1577, weighted_loss: 0.9799, label: 5, bag_size: 658
batch 1900, loss: 3.0569, instance_loss: 0.2452, weighted_loss: 2.2134, label: 3, bag_size: 510
batch 2000, loss: 1.3021, instance_loss: 0.1620, weighted_loss: 0.9601, label: 5, bag_size: 773
batch 2100, loss: 1.4145, instance_loss: 0.1709, weighted_loss: 1.0414, label: 5, bag_size: 1049

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 6, train_loss: 2.6027, train_clustering_loss: 0.2068, train_error: 0.5521
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.46035805626598464, correct coarse 360/782 
coarse class 2: coarse acc 0.9006439742410304, correct coarse 979/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.36363636363636365, correct fine 188/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9355608591885441, correct fine 784/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5494, coarse auc: 0.6811, fine auc: 0.6523 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5104166666666666, correct coarse 49/96 
coarse class 2: coarse acc 0.8955223880597015, correct coarse 120/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.453125, correct fine 29/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3293
Fine Overall Accuracy: 0.4735
Fine Overall F1 Score: 0.0984

Training for coarse_and_fine level...
batch 100, loss: 1.1125, instance_loss: 0.1584, weighted_loss: 0.8263, label: 5, bag_size: 206
batch 200, loss: 2.4834, instance_loss: 0.2874, weighted_loss: 1.8246, label: 5, bag_size: 473
batch 300, loss: 0.4483, instance_loss: 0.1328, weighted_loss: 0.3537, label: 5, bag_size: 965
batch 400, loss: 4.9242, instance_loss: 0.2537, weighted_loss: 3.5231, label: 8, bag_size: 253
batch 500, loss: 3.0630, instance_loss: 0.2221, weighted_loss: 2.2107, label: 3, bag_size: 304
batch 600, loss: 2.7795, instance_loss: 0.1769, weighted_loss: 1.9987, label: 5, bag_size: 444
batch 700, loss: 2.7829, instance_loss: 0.2129, weighted_loss: 2.0119, label: 6, bag_size: 526
batch 800, loss: 4.6578, instance_loss: 0.2372, weighted_loss: 3.3316, label: 8, bag_size: 160
batch 900, loss: 5.1362, instance_loss: 0.2389, weighted_loss: 3.6670, label: 8, bag_size: 368
batch 1000, loss: 1.0498, instance_loss: 0.1550, weighted_loss: 0.7814, label: 5, bag_size: 796
batch 1100, loss: 1.0146, instance_loss: 0.1469, weighted_loss: 0.7543, label: 5, bag_size: 776
batch 1200, loss: 2.2777, instance_loss: 0.1606, weighted_loss: 1.6426, label: 5, bag_size: 104
batch 1300, loss: 2.9428, instance_loss: 0.1988, weighted_loss: 2.1196, label: 2, bag_size: 260
batch 1400, loss: 0.6369, instance_loss: 0.1546, weighted_loss: 0.4922, label: 5, bag_size: 235
batch 1500, loss: 1.1271, instance_loss: 0.1513, weighted_loss: 0.8344, label: 5, bag_size: 318
batch 1600, loss: 0.8800, instance_loss: 0.1509, weighted_loss: 0.6613, label: 5, bag_size: 307
batch 1700, loss: 1.2984, instance_loss: 0.1559, weighted_loss: 0.9556, label: 5, bag_size: 458
batch 1800, loss: 5.1798, instance_loss: 0.2187, weighted_loss: 3.6914, label: 7, bag_size: 708
batch 1900, loss: 1.2079, instance_loss: 0.1736, weighted_loss: 0.8976, label: 5, bag_size: 364
batch 2000, loss: 2.6185, instance_loss: 0.1906, weighted_loss: 1.8902, label: 2, bag_size: 475
batch 2100, loss: 2.9059, instance_loss: 0.2299, weighted_loss: 2.1031, label: 6, bag_size: 1004

Instance Classifier Stats
class 0 clustering acc 0.9999884792626728: correct 260397/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 7, train_loss: 2.5703, train_clustering_loss: 0.1932, train_error: 0.5442
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5076726342710998, correct coarse 397/782 
coarse class 2: coarse acc 0.8877644894204232, correct coarse 965/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.4158607350096712, correct fine 215/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9236276849642004, correct fine 774/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5243, coarse auc: 0.6906, fine auc: 0.6639 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5520833333333334, correct coarse 53/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.546875, correct fine 35/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3340
Fine Overall Accuracy: 0.4848
Fine Overall F1 Score: 0.1031

Training for coarse_and_fine level...
batch 100, loss: 1.6321, instance_loss: 0.1573, weighted_loss: 1.1897, label: 5, bag_size: 318
batch 200, loss: 2.0584, instance_loss: 0.1733, weighted_loss: 1.4928, label: 5, bag_size: 100
batch 300, loss: 2.7793, instance_loss: 0.2133, weighted_loss: 2.0095, label: 6, bag_size: 280
batch 400, loss: 1.6282, instance_loss: 0.1571, weighted_loss: 1.1868, label: 5, bag_size: 721
batch 500, loss: 1.9731, instance_loss: 0.1681, weighted_loss: 1.4316, label: 5, bag_size: 471
batch 600, loss: 1.0042, instance_loss: 0.1407, weighted_loss: 0.7452, label: 5, bag_size: 596
batch 700, loss: 1.9058, instance_loss: 0.1484, weighted_loss: 1.3786, label: 5, bag_size: 1600
batch 800, loss: 1.9411, instance_loss: 0.1851, weighted_loss: 1.4143, label: 2, bag_size: 1427
batch 900, loss: 2.7416, instance_loss: 0.1959, weighted_loss: 1.9779, label: 6, bag_size: 1239
batch 1000, loss: 3.1479, instance_loss: 0.2368, weighted_loss: 2.2746, label: 6, bag_size: 2193
batch 1100, loss: 1.1121, instance_loss: 0.1499, weighted_loss: 0.8234, label: 5, bag_size: 358
batch 1200, loss: 1.4930, instance_loss: 0.1511, weighted_loss: 1.0905, label: 5, bag_size: 515
batch 1300, loss: 0.4903, instance_loss: 0.1320, weighted_loss: 0.3828, label: 5, bag_size: 241
batch 1400, loss: 1.4432, instance_loss: 0.1386, weighted_loss: 1.0518, label: 5, bag_size: 304
batch 1500, loss: 2.3245, instance_loss: 0.1859, weighted_loss: 1.6829, label: 2, bag_size: 820
batch 1600, loss: 4.7292, instance_loss: 0.2298, weighted_loss: 3.3794, label: 3, bag_size: 510
batch 1700, loss: 1.7377, instance_loss: 0.1801, weighted_loss: 1.2704, label: 2, bag_size: 1397
batch 1800, loss: 2.4007, instance_loss: 0.1944, weighted_loss: 1.7388, label: 5, bag_size: 276
batch 1900, loss: 0.8470, instance_loss: 0.1330, weighted_loss: 0.6328, label: 5, bag_size: 682
batch 2000, loss: 4.7915, instance_loss: 0.2210, weighted_loss: 3.4203, label: 8, bag_size: 253
batch 2100, loss: 3.4642, instance_loss: 0.2448, weighted_loss: 2.4984, label: 4, bag_size: 505

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 8, train_loss: 2.5413, train_clustering_loss: 0.1869, train_error: 0.5406
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5537084398976982, correct coarse 433/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.4622823984526112, correct fine 239/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9045346062052506, correct fine 758/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.5023, coarse auc: 0.6967, fine auc: 0.6725 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5520833333333334, correct coarse 53/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6402
Coarse Overall F1 Score: 0.3322
Fine Overall Accuracy: 0.4848
Fine Overall F1 Score: 0.1033

Training for coarse_and_fine level...
batch 100, loss: 0.3830, instance_loss: 0.1399, weighted_loss: 0.3101, label: 5, bag_size: 83
batch 200, loss: 1.8174, instance_loss: 0.1612, weighted_loss: 1.3206, label: 2, bag_size: 365
batch 300, loss: 4.4956, instance_loss: 0.2310, weighted_loss: 3.2162, label: 8, bag_size: 838
batch 400, loss: 3.6620, instance_loss: 0.2287, weighted_loss: 2.6320, label: 4, bag_size: 2080
batch 500, loss: 3.3335, instance_loss: 0.2284, weighted_loss: 2.4020, label: 4, bag_size: 836
batch 600, loss: 2.7376, instance_loss: 0.1677, weighted_loss: 1.9666, label: 5, bag_size: 2344
batch 700, loss: 0.4358, instance_loss: 0.1347, weighted_loss: 0.3454, label: 5, bag_size: 210
batch 800, loss: 2.9675, instance_loss: 0.2342, weighted_loss: 2.1475, label: 6, bag_size: 274
batch 900, loss: 2.3041, instance_loss: 0.1567, weighted_loss: 1.6598, label: 5, bag_size: 232
batch 1000, loss: 8.2812, instance_loss: 0.2548, weighted_loss: 5.8733, label: 1, bag_size: 207
batch 1100, loss: 7.5929, instance_loss: 0.2701, weighted_loss: 5.3961, label: 0, bag_size: 419
batch 1200, loss: 3.1624, instance_loss: 0.2234, weighted_loss: 2.2807, label: 3, bag_size: 602
batch 1300, loss: 2.5524, instance_loss: 0.2262, weighted_loss: 1.8545, label: 3, bag_size: 2170
batch 1400, loss: 3.2893, instance_loss: 0.1734, weighted_loss: 2.3545, label: 2, bag_size: 201
batch 1500, loss: 0.7792, instance_loss: 0.1326, weighted_loss: 0.5852, label: 5, bag_size: 622
batch 1600, loss: 2.8936, instance_loss: 0.2279, weighted_loss: 2.0939, label: 3, bag_size: 773
batch 1700, loss: 1.6898, instance_loss: 0.1590, weighted_loss: 1.2306, label: 5, bag_size: 569
batch 1800, loss: 1.7178, instance_loss: 0.1673, weighted_loss: 1.2527, label: 2, bag_size: 252
batch 1900, loss: 2.9426, instance_loss: 0.2035, weighted_loss: 2.1209, label: 6, bag_size: 464
batch 2000, loss: 2.8767, instance_loss: 0.1543, weighted_loss: 2.0600, label: 5, bag_size: 3051
batch 2100, loss: 0.8928, instance_loss: 0.1297, weighted_loss: 0.6639, label: 5, bag_size: 502

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 9, train_loss: 2.5161, train_clustering_loss: 0.1830, train_error: 0.5369
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.578005115089514, correct coarse 452/782 
coarse class 2: coarse acc 0.859245630174793, correct coarse 934/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.504835589941973, correct fine 261/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8878281622911695, correct fine 744/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4825, coarse auc: 0.7021, fine auc: 0.6806 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5520833333333334, correct coarse 53/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3340
Fine Overall Accuracy: 0.4886
Fine Overall F1 Score: 0.1041

Training for coarse_and_fine level...
batch 100, loss: 7.3240, instance_loss: 0.2823, weighted_loss: 5.2114, label: 0, bag_size: 277
batch 200, loss: 2.9838, instance_loss: 0.2265, weighted_loss: 2.1566, label: 3, bag_size: 1477
batch 300, loss: 1.9344, instance_loss: 0.1679, weighted_loss: 1.4045, label: 2, bag_size: 84
batch 400, loss: 3.6933, instance_loss: 0.1869, weighted_loss: 2.6414, label: 2, bag_size: 665
batch 500, loss: 0.5258, instance_loss: 0.1223, weighted_loss: 0.4047, label: 5, bag_size: 1325
batch 600, loss: 2.2410, instance_loss: 0.1504, weighted_loss: 1.6138, label: 5, bag_size: 232
batch 700, loss: 2.7040, instance_loss: 0.2125, weighted_loss: 1.9566, label: 6, bag_size: 1248
batch 800, loss: 3.5346, instance_loss: 0.2242, weighted_loss: 2.5415, label: 4, bag_size: 1534
batch 900, loss: 1.0930, instance_loss: 0.1425, weighted_loss: 0.8079, label: 5, bag_size: 696
batch 1000, loss: 1.6474, instance_loss: 0.1589, weighted_loss: 1.2008, label: 5, bag_size: 337
batch 1100, loss: 2.6484, instance_loss: 0.1810, weighted_loss: 1.9082, label: 2, bag_size: 290
batch 1200, loss: 7.9038, instance_loss: 0.2798, weighted_loss: 5.6166, label: 0, bag_size: 558
batch 1300, loss: 1.5298, instance_loss: 0.1573, weighted_loss: 1.1180, label: 2, bag_size: 1099
batch 1400, loss: 2.8951, instance_loss: 0.2093, weighted_loss: 2.0894, label: 6, bag_size: 138
batch 1500, loss: 1.4167, instance_loss: 0.1374, weighted_loss: 1.0329, label: 5, bag_size: 115
batch 1600, loss: 1.3594, instance_loss: 0.1292, weighted_loss: 0.9903, label: 5, bag_size: 385
batch 1700, loss: 2.5419, instance_loss: 0.1921, weighted_loss: 1.8370, label: 2, bag_size: 349
batch 1800, loss: 2.1586, instance_loss: 0.1725, weighted_loss: 1.5628, label: 2, bag_size: 383
batch 1900, loss: 5.3430, instance_loss: 0.2437, weighted_loss: 3.8132, label: 7, bag_size: 227
batch 2000, loss: 4.2221, instance_loss: 0.2139, weighted_loss: 3.0196, label: 8, bag_size: 541
batch 2100, loss: 1.3672, instance_loss: 0.1637, weighted_loss: 1.0061, label: 2, bag_size: 601

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 10, train_loss: 2.4934, train_clustering_loss: 0.1810, train_error: 0.5304
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.592071611253197, correct coarse 463/782 
coarse class 2: coarse acc 0.859245630174793, correct coarse 934/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5203094777562862, correct fine 269/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8949880668257757, correct fine 750/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4651, coarse auc: 0.7074, fine auc: 0.6883 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5625, correct coarse 54/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3363
Fine Overall Accuracy: 0.4848
Fine Overall F1 Score: 0.1030

Training for coarse_and_fine level...
batch 100, loss: 6.4537, instance_loss: 0.2495, weighted_loss: 4.5925, label: 7, bag_size: 675
batch 200, loss: 1.9633, instance_loss: 0.1590, weighted_loss: 1.4220, label: 2, bag_size: 778
batch 300, loss: 6.7689, instance_loss: 0.2564, weighted_loss: 4.8151, label: 10, bag_size: 372
batch 400, loss: 2.1308, instance_loss: 0.1684, weighted_loss: 1.5421, label: 2, bag_size: 420
batch 500, loss: 1.0022, instance_loss: 0.1319, weighted_loss: 0.7411, label: 5, bag_size: 217
batch 600, loss: 1.9482, instance_loss: 0.1592, weighted_loss: 1.4115, label: 5, bag_size: 742
batch 700, loss: 2.3161, instance_loss: 0.1496, weighted_loss: 1.6662, label: 5, bag_size: 331
batch 800, loss: 2.0459, instance_loss: 0.1727, weighted_loss: 1.4840, label: 2, bag_size: 258
batch 900, loss: 2.6666, instance_loss: 0.2174, weighted_loss: 1.9318, label: 6, bag_size: 375
batch 1000, loss: 7.1425, instance_loss: 0.2646, weighted_loss: 5.0791, label: 1, bag_size: 101
batch 1100, loss: 2.3724, instance_loss: 0.1600, weighted_loss: 1.7087, label: 5, bag_size: 1347
batch 1200, loss: 8.4948, instance_loss: 0.2666, weighted_loss: 6.0263, label: 1, bag_size: 439
batch 1300, loss: 1.6705, instance_loss: 0.1499, weighted_loss: 1.2143, label: 5, bag_size: 396
batch 1400, loss: 2.7624, instance_loss: 0.1606, weighted_loss: 1.9818, label: 5, bag_size: 104
batch 1500, loss: 2.5217, instance_loss: 0.2023, weighted_loss: 1.8258, label: 6, bag_size: 201
batch 1600, loss: 0.4742, instance_loss: 0.1126, weighted_loss: 0.3657, label: 5, bag_size: 827
batch 1700, loss: 2.5976, instance_loss: 0.2094, weighted_loss: 1.8811, label: 6, bag_size: 304
batch 1800, loss: 3.1985, instance_loss: 0.1840, weighted_loss: 2.2941, label: 2, bag_size: 631
batch 1900, loss: 2.4506, instance_loss: 0.1731, weighted_loss: 1.7673, label: 2, bag_size: 364
batch 2000, loss: 1.4366, instance_loss: 0.1541, weighted_loss: 1.0518, label: 2, bag_size: 732
batch 2100, loss: 3.4190, instance_loss: 0.1991, weighted_loss: 2.4530, label: 3, bag_size: 1441

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 0.0: correct 0/17360

Epoch: 11, train_loss: 2.4728, train_clustering_loss: 0.1795, train_error: 0.5267
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.612531969309463, correct coarse 479/782 
coarse class 2: coarse acc 0.8518859245630175, correct coarse 926/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5705996131528046, correct fine 295/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8735083532219571, correct fine 732/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4497, coarse auc: 0.7114, fine auc: 0.6935 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5520833333333334, correct coarse 53/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3340
Fine Overall Accuracy: 0.4848
Fine Overall F1 Score: 0.1030

Training for coarse_and_fine level...
batch 100, loss: 2.3091, instance_loss: 0.1676, weighted_loss: 1.6666, label: 5, bag_size: 369
batch 200, loss: 1.2839, instance_loss: 0.1379, weighted_loss: 0.9401, label: 5, bag_size: 450
batch 300, loss: 2.5259, instance_loss: 0.1667, weighted_loss: 1.8182, label: 2, bag_size: 378
batch 400, loss: 4.6931, instance_loss: 0.2360, weighted_loss: 3.3560, label: 8, bag_size: 717
batch 500, loss: 2.8340, instance_loss: 0.1590, weighted_loss: 2.0315, label: 2, bag_size: 265
batch 600, loss: 3.8190, instance_loss: 0.1544, weighted_loss: 2.7196, label: 5, bag_size: 444
batch 700, loss: 3.2039, instance_loss: 0.2160, weighted_loss: 2.3076, label: 6, bag_size: 614
batch 800, loss: 1.7214, instance_loss: 0.1349, weighted_loss: 1.2454, label: 5, bag_size: 532
batch 900, loss: 2.7086, instance_loss: 0.1745, weighted_loss: 1.9484, label: 2, bag_size: 394
batch 1000, loss: 2.0930, instance_loss: 0.1493, weighted_loss: 1.5099, label: 5, bag_size: 627
batch 1100, loss: 3.4874, instance_loss: 0.2250, weighted_loss: 2.5087, label: 3, bag_size: 262
batch 1200, loss: 2.8276, instance_loss: 0.1965, weighted_loss: 2.0383, label: 6, bag_size: 288
batch 1300, loss: 2.8944, instance_loss: 0.2134, weighted_loss: 2.0901, label: 6, bag_size: 464
batch 1400, loss: 3.3100, instance_loss: 0.2088, weighted_loss: 2.3796, label: 6, bag_size: 764
batch 1500, loss: 4.0012, instance_loss: 0.2223, weighted_loss: 2.8675, label: 8, bag_size: 663
batch 1600, loss: 1.8253, instance_loss: 0.1834, weighted_loss: 1.3327, label: 2, bag_size: 1803
batch 1700, loss: 2.1048, instance_loss: 0.1716, weighted_loss: 1.5249, label: 2, bag_size: 965
batch 1800, loss: 3.6435, instance_loss: 0.2377, weighted_loss: 2.6217, label: 3, bag_size: 1666
batch 1900, loss: 2.5864, instance_loss: 0.2046, weighted_loss: 1.8719, label: 6, bag_size: 334
batch 2000, loss: 3.8453, instance_loss: 0.2244, weighted_loss: 2.7591, label: 4, bag_size: 217
batch 2100, loss: 0.9376, instance_loss: 0.1212, weighted_loss: 0.6927, label: 5, bag_size: 1032

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 0.0001152073732718894: correct 2/17360

Epoch: 12, train_loss: 2.4548, train_clustering_loss: 0.1787, train_error: 0.5244
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6048593350383632, correct coarse 473/782 
coarse class 2: coarse acc 0.8537258509659613, correct coarse 928/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5667311411992263, correct fine 293/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8818615751789977, correct fine 739/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4346, coarse auc: 0.7167, fine auc: 0.6997 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3395
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1051

Training for coarse_and_fine level...
batch 100, loss: 0.4278, instance_loss: 0.1174, weighted_loss: 0.3347, label: 5, bag_size: 764
batch 200, loss: 1.2979, instance_loss: 0.1236, weighted_loss: 0.9456, label: 5, bag_size: 412
batch 300, loss: 3.6277, instance_loss: 0.2087, weighted_loss: 2.6020, label: 3, bag_size: 1666
batch 400, loss: 3.4204, instance_loss: 0.1742, weighted_loss: 2.4465, label: 2, bag_size: 341
batch 500, loss: 4.9864, instance_loss: 0.2327, weighted_loss: 3.5603, label: 8, bag_size: 288
batch 600, loss: 4.6409, instance_loss: 0.2291, weighted_loss: 3.3173, label: 7, bag_size: 209
batch 700, loss: 2.4457, instance_loss: 0.1857, weighted_loss: 1.7677, label: 2, bag_size: 177
batch 800, loss: 2.1957, instance_loss: 0.1502, weighted_loss: 1.5820, label: 5, bag_size: 450
batch 900, loss: 0.4842, instance_loss: 0.1239, weighted_loss: 0.3761, label: 5, bag_size: 250
batch 1000, loss: 3.2978, instance_loss: 0.1836, weighted_loss: 2.3635, label: 2, bag_size: 533
batch 1100, loss: 0.3317, instance_loss: 0.1149, weighted_loss: 0.2666, label: 5, bag_size: 312
batch 1200, loss: 1.3461, instance_loss: 0.1475, weighted_loss: 0.9865, label: 2, bag_size: 2213
batch 1300, loss: 2.6911, instance_loss: 0.2516, weighted_loss: 1.9592, label: 4, bag_size: 2272
batch 1400, loss: 3.9773, instance_loss: 0.1751, weighted_loss: 2.8367, label: 2, bag_size: 665
batch 1500, loss: 3.6444, instance_loss: 0.2231, weighted_loss: 2.6180, label: 8, bag_size: 299
batch 1600, loss: 1.9814, instance_loss: 0.1621, weighted_loss: 1.4356, label: 2, bag_size: 271
batch 1700, loss: 5.2824, instance_loss: 0.2430, weighted_loss: 3.7706, label: 8, bag_size: 715
batch 1800, loss: 1.1607, instance_loss: 0.1324, weighted_loss: 0.8522, label: 5, bag_size: 106
batch 1900, loss: 3.9064, instance_loss: 0.2255, weighted_loss: 2.8022, label: 3, bag_size: 433
batch 2000, loss: 3.3039, instance_loss: 0.1923, weighted_loss: 2.3704, label: 6, bag_size: 320
batch 2100, loss: 3.9928, instance_loss: 0.2297, weighted_loss: 2.8639, label: 8, bag_size: 388

Instance Classifier Stats
class 0 clustering acc 0.9999961597542243: correct 260399/260400
class 1 clustering acc 5.76036866359447e-05: correct 1/17360

Epoch: 13, train_loss: 2.4379, train_clustering_loss: 0.1778, train_error: 0.5240
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6227621483375959, correct coarse 487/782 
coarse class 2: coarse acc 0.8546458141674333, correct coarse 929/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5880077369439072, correct fine 304/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.869928400954654, correct fine 729/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4211, coarse auc: 0.7226, fine auc: 0.7068 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.59375, correct coarse 57/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6477
Coarse Overall F1 Score: 0.3379
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1053

Training for coarse_and_fine level...
batch 100, loss: 2.6997, instance_loss: 0.2291, weighted_loss: 1.9586, label: 3, bag_size: 1739
batch 200, loss: 2.1937, instance_loss: 0.1433, weighted_loss: 1.5786, label: 5, bag_size: 153
batch 300, loss: 2.0721, instance_loss: 0.1889, weighted_loss: 1.5071, label: 2, bag_size: 1549
batch 400, loss: 2.3982, instance_loss: 0.2367, weighted_loss: 1.7498, label: 6, bag_size: 506
batch 500, loss: 2.7245, instance_loss: 0.2071, weighted_loss: 1.9693, label: 6, bag_size: 375
batch 600, loss: 4.5948, instance_loss: 0.2297, weighted_loss: 3.2853, label: 8, bag_size: 212
batch 700, loss: 1.4686, instance_loss: 0.1191, weighted_loss: 1.0638, label: 5, bag_size: 1145
batch 800, loss: 3.4163, instance_loss: 0.1997, weighted_loss: 2.4514, label: 6, bag_size: 246
batch 900, loss: 2.6386, instance_loss: 0.2199, weighted_loss: 1.9130, label: 4, bag_size: 1673
batch 1000, loss: 1.6787, instance_loss: 0.1787, weighted_loss: 1.2287, label: 2, bag_size: 2818
batch 1100, loss: 4.0214, instance_loss: 0.2160, weighted_loss: 2.8798, label: 8, bag_size: 430
batch 1200, loss: 0.4466, instance_loss: 0.1251, weighted_loss: 0.3501, label: 5, bag_size: 592
batch 1300, loss: 1.5640, instance_loss: 0.1600, weighted_loss: 1.1428, label: 2, bag_size: 671
batch 1400, loss: 0.9089, instance_loss: 0.1246, weighted_loss: 0.6737, label: 5, bag_size: 473
batch 1500, loss: 0.4097, instance_loss: 0.1110, weighted_loss: 0.3201, label: 5, bag_size: 217
batch 1600, loss: 2.6276, instance_loss: 0.1412, weighted_loss: 1.8817, label: 5, bag_size: 309
batch 1700, loss: 2.0793, instance_loss: 0.1493, weighted_loss: 1.5003, label: 5, bag_size: 377
batch 1800, loss: 2.3304, instance_loss: 0.1558, weighted_loss: 1.6780, label: 2, bag_size: 779
batch 1900, loss: 2.5467, instance_loss: 0.2171, weighted_loss: 1.8478, label: 3, bag_size: 1249
batch 2000, loss: 2.5330, instance_loss: 0.1553, weighted_loss: 1.8197, label: 5, bag_size: 224
batch 2100, loss: 2.1450, instance_loss: 0.2197, weighted_loss: 1.5674, label: 3, bag_size: 570

Instance Classifier Stats
class 0 clustering acc 1.0: correct 260400/260400
class 1 clustering acc 0.0002304147465437788: correct 4/17360

Epoch: 14, train_loss: 2.4212, train_clustering_loss: 0.1768, train_error: 0.5207
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8426862925482981, correct coarse 916/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6054158607350096, correct fine 313/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8675417661097852, correct fine 727/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.4088, coarse auc: 0.7257, fine auc: 0.7130 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3395
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1054

Training for coarse_and_fine level...
batch 100, loss: 2.3566, instance_loss: 0.1813, weighted_loss: 1.7040, label: 2, bag_size: 1618
batch 200, loss: 2.0667, instance_loss: 0.1294, weighted_loss: 1.4855, label: 5, bag_size: 984
batch 300, loss: 1.0451, instance_loss: 0.1138, weighted_loss: 0.7657, label: 5, bag_size: 2032
batch 400, loss: 2.4205, instance_loss: 0.1400, weighted_loss: 1.7363, label: 5, bag_size: 1347
batch 500, loss: 3.0417, instance_loss: 0.2334, weighted_loss: 2.1992, label: 4, bag_size: 183
batch 600, loss: 0.6788, instance_loss: 0.1231, weighted_loss: 0.5121, label: 5, bag_size: 817
batch 700, loss: 3.5420, instance_loss: 0.1938, weighted_loss: 2.5375, label: 2, bag_size: 186
batch 800, loss: 2.7932, instance_loss: 0.2131, weighted_loss: 2.0192, label: 6, bag_size: 1339
batch 900, loss: 2.4069, instance_loss: 0.1578, weighted_loss: 1.7322, label: 2, bag_size: 187
batch 1000, loss: 1.0711, instance_loss: 0.1190, weighted_loss: 0.7855, label: 5, bag_size: 558
batch 1100, loss: 1.0943, instance_loss: 0.1298, weighted_loss: 0.8050, label: 5, bag_size: 519
batch 1200, loss: 1.1980, instance_loss: 0.1388, weighted_loss: 0.8802, label: 5, bag_size: 223
batch 1300, loss: 1.9756, instance_loss: 0.1793, weighted_loss: 1.4367, label: 2, bag_size: 1114
batch 1400, loss: 2.4946, instance_loss: 0.2004, weighted_loss: 1.8063, label: 6, bag_size: 434
batch 1500, loss: 3.2848, instance_loss: 0.1467, weighted_loss: 2.3433, label: 5, bag_size: 1206
batch 1600, loss: 3.5238, instance_loss: 0.1713, weighted_loss: 2.5181, label: 2, bag_size: 107
batch 1700, loss: 0.5152, instance_loss: 0.1237, weighted_loss: 0.3977, label: 5, bag_size: 728
batch 1800, loss: 2.8677, instance_loss: 0.1826, weighted_loss: 2.0622, label: 2, bag_size: 430
batch 1900, loss: 1.5494, instance_loss: 0.1438, weighted_loss: 1.1277, label: 5, bag_size: 277
batch 2000, loss: 2.7069, instance_loss: 0.2301, weighted_loss: 1.9638, label: 4, bag_size: 2056
batch 2100, loss: 2.5189, instance_loss: 0.2152, weighted_loss: 1.8277, label: 6, bag_size: 299

Instance Classifier Stats
class 0 clustering acc 0.9999923195084486: correct 260398/260400
class 1 clustering acc 0.0007488479262672812: correct 13/17360

Epoch: 15, train_loss: 2.4061, train_clustering_loss: 0.1762, train_error: 0.5198
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8518859245630175, correct coarse 926/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5996131528046421, correct fine 310/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8735083532219571, correct fine 732/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3964, coarse auc: 0.7327, fine auc: 0.7179 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3401
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1062

Training for coarse_and_fine level...
batch 100, loss: 2.8132, instance_loss: 0.2042, weighted_loss: 2.0305, label: 6, bag_size: 687
batch 200, loss: 1.5867, instance_loss: 0.1223, weighted_loss: 1.1474, label: 5, bag_size: 233
batch 300, loss: 4.6173, instance_loss: 0.2369, weighted_loss: 3.3032, label: 7, bag_size: 431
batch 400, loss: 2.3233, instance_loss: 0.2063, weighted_loss: 1.6882, label: 3, bag_size: 53
batch 500, loss: 2.2523, instance_loss: 0.1638, weighted_loss: 1.6258, label: 2, bag_size: 1618
batch 600, loss: 2.4478, instance_loss: 0.1611, weighted_loss: 1.7618, label: 2, bag_size: 898
batch 700, loss: 2.7990, instance_loss: 0.1795, weighted_loss: 2.0132, label: 2, bag_size: 540
batch 800, loss: 1.2335, instance_loss: 0.1447, weighted_loss: 0.9068, label: 2, bag_size: 848
batch 900, loss: 1.7381, instance_loss: 0.1780, weighted_loss: 1.2701, label: 2, bag_size: 425
batch 1000, loss: 1.3649, instance_loss: 0.1182, weighted_loss: 0.9909, label: 5, bag_size: 597
batch 1100, loss: 2.4039, instance_loss: 0.1683, weighted_loss: 1.7332, label: 2, bag_size: 217
batch 1200, loss: 0.6673, instance_loss: 0.1003, weighted_loss: 0.4972, label: 5, bag_size: 1301
batch 1300, loss: 0.9192, instance_loss: 0.1208, weighted_loss: 0.6797, label: 5, bag_size: 458
batch 1400, loss: 2.4552, instance_loss: 0.2305, weighted_loss: 1.7878, label: 3, bag_size: 2537
batch 1500, loss: 0.3573, instance_loss: 0.1151, weighted_loss: 0.2846, label: 5, bag_size: 193
batch 1600, loss: 2.0823, instance_loss: 0.2220, weighted_loss: 1.5242, label: 6, bag_size: 225
batch 1700, loss: 2.0541, instance_loss: 0.1473, weighted_loss: 1.4821, label: 5, bag_size: 271
batch 1800, loss: 3.8892, instance_loss: 0.2271, weighted_loss: 2.7906, label: 8, bag_size: 386
batch 1900, loss: 0.4819, instance_loss: 0.1084, weighted_loss: 0.3699, label: 5, bag_size: 488
batch 2000, loss: 2.4761, instance_loss: 0.2123, weighted_loss: 1.7969, label: 6, bag_size: 129
batch 2100, loss: 4.4115, instance_loss: 0.2565, weighted_loss: 3.1650, label: 7, bag_size: 441

Instance Classifier Stats
class 0 clustering acc 0.999984639016897: correct 260396/260400
class 1 clustering acc 0.0010944700460829493: correct 19/17360

Epoch: 16, train_loss: 2.3906, train_clustering_loss: 0.1756, train_error: 0.5194
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.659846547314578, correct coarse 516/782 
coarse class 2: coarse acc 0.828886844526219, correct coarse 901/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6266924564796905, correct fine 324/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8579952267303103, correct fine 719/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3858, coarse auc: 0.7354, fine auc: 0.7188 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3397
Fine Overall Accuracy: 0.4924
Fine Overall F1 Score: 0.1054

Training for coarse_and_fine level...
batch 100, loss: 2.8026, instance_loss: 0.2517, weighted_loss: 2.0373, label: 3, bag_size: 1642
batch 200, loss: 2.8167, instance_loss: 0.1887, weighted_loss: 2.0283, label: 6, bag_size: 682
batch 300, loss: 0.3580, instance_loss: 0.1000, weighted_loss: 0.2806, label: 5, bag_size: 562
batch 400, loss: 4.0216, instance_loss: 0.2275, weighted_loss: 2.8834, label: 3, bag_size: 167
batch 500, loss: 0.7732, instance_loss: 0.1196, weighted_loss: 0.5772, label: 5, bag_size: 593
batch 600, loss: 0.8155, instance_loss: 0.1042, weighted_loss: 0.6021, label: 5, bag_size: 1157
batch 700, loss: 3.5405, instance_loss: 0.2386, weighted_loss: 2.5499, label: 4, bag_size: 244
batch 800, loss: 0.3270, instance_loss: 0.1115, weighted_loss: 0.2624, label: 5, bag_size: 789
batch 900, loss: 2.9021, instance_loss: 0.1681, weighted_loss: 2.0819, label: 5, bag_size: 376
batch 1000, loss: 2.4376, instance_loss: 0.1813, weighted_loss: 1.7607, label: 2, bag_size: 228
batch 1100, loss: 5.1129, instance_loss: 0.2624, weighted_loss: 3.6578, label: 7, bag_size: 760
batch 1200, loss: 2.8366, instance_loss: 0.2305, weighted_loss: 2.0548, label: 6, bag_size: 464
batch 1300, loss: 3.6936, instance_loss: 0.1815, weighted_loss: 2.6400, label: 2, bag_size: 57
batch 1400, loss: 3.0441, instance_loss: 0.1898, weighted_loss: 2.1878, label: 2, bag_size: 559
batch 1500, loss: 2.5505, instance_loss: 0.1475, weighted_loss: 1.8296, label: 5, bag_size: 242
batch 1600, loss: 5.5563, instance_loss: 0.2755, weighted_loss: 3.9720, label: 10, bag_size: 391
batch 1700, loss: 2.5014, instance_loss: 0.2043, weighted_loss: 1.8123, label: 6, bag_size: 239
batch 1800, loss: 4.6580, instance_loss: 0.2186, weighted_loss: 3.3262, label: 7, bag_size: 274
batch 1900, loss: 1.1394, instance_loss: 0.1434, weighted_loss: 0.8406, label: 2, bag_size: 1771
batch 2000, loss: 1.3422, instance_loss: 0.1661, weighted_loss: 0.9894, label: 2, bag_size: 605
batch 2100, loss: 1.8391, instance_loss: 0.1705, weighted_loss: 1.3385, label: 2, bag_size: 1534

Instance Classifier Stats
class 0 clustering acc 0.9999884792626728: correct 260397/260400
class 1 clustering acc 0.002131336405529954: correct 37/17360

Epoch: 17, train_loss: 2.3801, train_clustering_loss: 0.1753, train_error: 0.5207
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8491260349586016, correct coarse 923/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6131528046421664, correct fine 317/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8627684964200477, correct fine 723/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3743, coarse auc: 0.7389, fine auc: 0.7240 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.59375, correct coarse 57/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6515
Coarse Overall F1 Score: 0.3404
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1062

Training for coarse_and_fine level...
batch 100, loss: 2.4452, instance_loss: 0.2209, weighted_loss: 1.7779, label: 4, bag_size: 1673
batch 200, loss: 3.1563, instance_loss: 0.2122, weighted_loss: 2.2731, label: 6, bag_size: 861
batch 300, loss: 3.7443, instance_loss: 0.2292, weighted_loss: 2.6898, label: 7, bag_size: 172
batch 400, loss: 1.6979, instance_loss: 0.2022, weighted_loss: 1.2492, label: 6, bag_size: 504
batch 500, loss: 1.0535, instance_loss: 0.1788, weighted_loss: 0.7911, label: 2, bag_size: 884
batch 600, loss: 1.3537, instance_loss: 0.1213, weighted_loss: 0.9839, label: 5, bag_size: 394
batch 700, loss: 2.7955, instance_loss: 0.1664, weighted_loss: 2.0068, label: 2, bag_size: 858
batch 800, loss: 4.1981, instance_loss: 0.2317, weighted_loss: 3.0082, label: 8, bag_size: 571
batch 900, loss: 4.2633, instance_loss: 0.2242, weighted_loss: 3.0516, label: 7, bag_size: 209
batch 1000, loss: 2.6829, instance_loss: 0.2137, weighted_loss: 1.9422, label: 6, bag_size: 1122
batch 1100, loss: 2.0589, instance_loss: 0.1371, weighted_loss: 1.4824, label: 5, bag_size: 331
batch 1200, loss: 3.5174, instance_loss: 0.1574, weighted_loss: 2.5094, label: 5, bag_size: 216
batch 1300, loss: 5.8349, instance_loss: 0.2798, weighted_loss: 4.1684, label: 10, bag_size: 289
batch 1400, loss: 1.8176, instance_loss: 0.1686, weighted_loss: 1.3229, label: 2, bag_size: 265
batch 1500, loss: 0.6993, instance_loss: 0.1516, weighted_loss: 0.5350, label: 2, bag_size: 1078
batch 1600, loss: 5.7116, instance_loss: 0.3142, weighted_loss: 4.0924, label: 9, bag_size: 936
batch 1700, loss: 0.5582, instance_loss: 0.1140, weighted_loss: 0.4250, label: 5, bag_size: 1014
batch 1800, loss: 0.2008, instance_loss: 0.1077, weighted_loss: 0.1729, label: 5, bag_size: 274
batch 1900, loss: 4.1285, instance_loss: 0.2374, weighted_loss: 2.9612, label: 3, bag_size: 437
batch 2000, loss: 1.3452, instance_loss: 0.1568, weighted_loss: 0.9886, label: 2, bag_size: 671
batch 2100, loss: 3.7754, instance_loss: 0.2402, weighted_loss: 2.7148, label: 8, bag_size: 430

Instance Classifier Stats
class 0 clustering acc 0.9999539170506913: correct 260388/260400
class 1 clustering acc 0.0017281105990783411: correct 30/17360

Epoch: 18, train_loss: 2.3666, train_clustering_loss: 0.1745, train_error: 0.5157
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.8482060717571297, correct coarse 922/1087 
coarse class 3: coarse acc 0.007782101167315175, correct coarse 2/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6170212765957447, correct fine 319/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8735083532219571, correct fine 732/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3640, coarse auc: 0.7461, fine auc: 0.7290 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6439
Coarse Overall F1 Score: 0.3372
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1062

Training for coarse_and_fine level...
batch 100, loss: 2.4265, instance_loss: 0.2304, weighted_loss: 1.7677, label: 6, bag_size: 523
batch 200, loss: 2.0699, instance_loss: 0.1305, weighted_loss: 1.4881, label: 5, bag_size: 708
batch 300, loss: 0.4246, instance_loss: 0.1008, weighted_loss: 0.3275, label: 5, bag_size: 682
batch 400, loss: 1.4070, instance_loss: 0.1724, weighted_loss: 1.0366, label: 2, bag_size: 1573
batch 500, loss: 2.8161, instance_loss: 0.2253, weighted_loss: 2.0388, label: 3, bag_size: 831
batch 600, loss: 2.8079, instance_loss: 0.1978, weighted_loss: 2.0249, label: 6, bag_size: 843
batch 700, loss: 1.1496, instance_loss: 0.1044, weighted_loss: 0.8361, label: 5, bag_size: 1045
batch 800, loss: 2.0847, instance_loss: 0.2302, weighted_loss: 1.5283, label: 6, bag_size: 333
batch 900, loss: 0.8416, instance_loss: 0.1149, weighted_loss: 0.6236, label: 5, bag_size: 1262
batch 1000, loss: 1.7975, instance_loss: 0.1659, weighted_loss: 1.3080, label: 2, bag_size: 424
batch 1100, loss: 1.2594, instance_loss: 0.1824, weighted_loss: 0.9363, label: 2, bag_size: 270
batch 1200, loss: 1.1984, instance_loss: 0.1418, weighted_loss: 0.8814, label: 5, bag_size: 223
batch 1300, loss: 0.3180, instance_loss: 0.0972, weighted_loss: 0.2518, label: 5, bag_size: 714
batch 1400, loss: 3.3519, instance_loss: 0.1796, weighted_loss: 2.4002, label: 6, bag_size: 320
batch 1500, loss: 3.0596, instance_loss: 0.1775, weighted_loss: 2.1950, label: 2, bag_size: 421
batch 1600, loss: 0.6603, instance_loss: 0.0920, weighted_loss: 0.4899, label: 5, bag_size: 656
batch 1700, loss: 2.7974, instance_loss: 0.1360, weighted_loss: 1.9990, label: 5, bag_size: 663
batch 1800, loss: 1.1479, instance_loss: 0.1193, weighted_loss: 0.8393, label: 5, bag_size: 360
batch 1900, loss: 3.4545, instance_loss: 0.2733, weighted_loss: 2.5001, label: 3, bag_size: 1678
batch 2000, loss: 0.3413, instance_loss: 0.1031, weighted_loss: 0.2698, label: 5, bag_size: 596
batch 2100, loss: 0.3399, instance_loss: 0.0887, weighted_loss: 0.2645, label: 5, bag_size: 540

Instance Classifier Stats
class 0 clustering acc 0.9999308755760369: correct 260382/260400
class 1 clustering acc 0.0032258064516129032: correct 56/17360

Epoch: 19, train_loss: 2.3549, train_clustering_loss: 0.1740, train_error: 0.5166
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6508951406649617, correct coarse 509/782 
coarse class 2: coarse acc 0.8445262189512419, correct coarse 918/1087 
coarse class 3: coarse acc 0.011673151750972763, correct coarse 3/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6247582205029013, correct fine 323/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8663484486873508, correct fine 726/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3544, coarse auc: 0.7481, fine auc: 0.7333 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3438
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1061

Training for coarse_and_fine level...
batch 100, loss: 2.2626, instance_loss: 0.1626, weighted_loss: 1.6326, label: 2, bag_size: 1618
batch 200, loss: 5.0524, instance_loss: 0.2326, weighted_loss: 3.6065, label: 8, bag_size: 531
batch 300, loss: 4.3264, instance_loss: 0.2226, weighted_loss: 3.0952, label: 8, bag_size: 338
batch 400, loss: 3.2850, instance_loss: 0.2548, weighted_loss: 2.3759, label: 4, bag_size: 1400
batch 500, loss: 4.2223, instance_loss: 0.1963, weighted_loss: 3.0145, label: 6, bag_size: 1123
batch 600, loss: 2.2301, instance_loss: 0.1468, weighted_loss: 1.6051, label: 2, bag_size: 646
batch 700, loss: 0.5491, instance_loss: 0.1036, weighted_loss: 0.4155, label: 5, bag_size: 468
batch 800, loss: 1.7302, instance_loss: 0.1648, weighted_loss: 1.2606, label: 2, bag_size: 1423
batch 900, loss: 0.9823, instance_loss: 0.0865, weighted_loss: 0.7135, label: 5, bag_size: 1853
batch 1000, loss: 3.3114, instance_loss: 0.2120, weighted_loss: 2.3816, label: 6, bag_size: 379
batch 1100, loss: 1.2420, instance_loss: 0.1697, weighted_loss: 0.9203, label: 2, bag_size: 848
batch 1200, loss: 1.3133, instance_loss: 0.1398, weighted_loss: 0.9613, label: 5, bag_size: 216
batch 1300, loss: 0.3089, instance_loss: 0.1015, weighted_loss: 0.2467, label: 5, bag_size: 255
batch 1400, loss: 3.2872, instance_loss: 0.2239, weighted_loss: 2.3682, label: 8, bag_size: 130
batch 1500, loss: 0.2085, instance_loss: 0.0945, weighted_loss: 0.1743, label: 5, bag_size: 312
batch 1600, loss: 0.8373, instance_loss: 0.1389, weighted_loss: 0.6278, label: 2, bag_size: 988
batch 1700, loss: 2.9576, instance_loss: 0.2316, weighted_loss: 2.1398, label: 6, bag_size: 416
batch 1800, loss: 3.0821, instance_loss: 0.1735, weighted_loss: 2.2095, label: 2, bag_size: 169
batch 1900, loss: 1.0271, instance_loss: 0.1061, weighted_loss: 0.7508, label: 5, bag_size: 412
batch 2000, loss: 3.4596, instance_loss: 0.2151, weighted_loss: 2.4862, label: 6, bag_size: 764
batch 2100, loss: 3.0119, instance_loss: 0.1539, weighted_loss: 2.1545, label: 5, bag_size: 104

Instance Classifier Stats
class 0 clustering acc 0.9998694316436252: correct 260366/260400
class 1 clustering acc 0.005933179723502304: correct 103/17360

Epoch: 20, train_loss: 2.3442, train_clustering_loss: 0.1734, train_error: 0.5147
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8380864765409384, correct coarse 911/1087 
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6382978723404256, correct fine 330/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8627684964200477, correct fine 723/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3452, coarse auc: 0.7510, fine auc: 0.7350 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3453
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1064

Training for coarse_and_fine level...
batch 100, loss: 0.3033, instance_loss: 0.1004, weighted_loss: 0.2424, label: 5, bag_size: 554
batch 200, loss: 2.4222, instance_loss: 0.2062, weighted_loss: 1.7574, label: 6, bag_size: 545
batch 300, loss: 2.7949, instance_loss: 0.2248, weighted_loss: 2.0239, label: 6, bag_size: 566
batch 400, loss: 1.4827, instance_loss: 0.1464, weighted_loss: 1.0818, label: 5, bag_size: 217
batch 500, loss: 1.0842, instance_loss: 0.1786, weighted_loss: 0.8125, label: 2, bag_size: 983
batch 600, loss: 1.7403, instance_loss: 0.1658, weighted_loss: 1.2679, label: 2, bag_size: 1205
batch 700, loss: 0.3043, instance_loss: 0.1057, weighted_loss: 0.2447, label: 5, bag_size: 293
batch 800, loss: 3.9430, instance_loss: 0.2509, weighted_loss: 2.8354, label: 8, bag_size: 1555
batch 900, loss: 3.1241, instance_loss: 0.2127, weighted_loss: 2.2507, label: 4, bag_size: 185
batch 1000, loss: 3.0235, instance_loss: 0.1939, weighted_loss: 2.1747, label: 6, bag_size: 292
batch 1100, loss: 2.3039, instance_loss: 0.2238, weighted_loss: 1.6799, label: 3, bag_size: 1892
batch 1200, loss: 2.5213, instance_loss: 0.1706, weighted_loss: 1.8161, label: 2, bag_size: 366
batch 1300, loss: 1.4218, instance_loss: 0.1092, weighted_loss: 1.0280, label: 5, bag_size: 463
batch 1400, loss: 2.6731, instance_loss: 0.2015, weighted_loss: 1.9316, label: 6, bag_size: 284
batch 1500, loss: 2.0587, instance_loss: 0.1635, weighted_loss: 1.4901, label: 2, bag_size: 592
batch 1600, loss: 2.1346, instance_loss: 0.2094, weighted_loss: 1.5570, label: 6, bag_size: 326
batch 1700, loss: 0.1497, instance_loss: 0.0851, weighted_loss: 0.1303, label: 5, bag_size: 365
batch 1800, loss: 2.0072, instance_loss: 0.1577, weighted_loss: 1.4524, label: 2, bag_size: 1897
batch 1900, loss: 4.6792, instance_loss: 0.2643, weighted_loss: 3.3547, label: 3, bag_size: 234
batch 2000, loss: 0.3828, instance_loss: 0.1057, weighted_loss: 0.2997, label: 5, bag_size: 330
batch 2100, loss: 0.3251, instance_loss: 0.0895, weighted_loss: 0.2544, label: 5, bag_size: 2402

Instance Classifier Stats
class 0 clustering acc 0.9998809523809524: correct 260369/260400
class 1 clustering acc 0.007546082949308756: correct 131/17360

Epoch: 21, train_loss: 2.3346, train_clustering_loss: 0.1732, train_error: 0.5129
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6521739130434783, correct coarse 510/782 
coarse class 2: coarse acc 0.8445262189512419, correct coarse 918/1087 
coarse class 3: coarse acc 0.007782101167315175, correct coarse 2/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6382978723404256, correct fine 330/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8675417661097852, correct fine 727/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3367, coarse auc: 0.7538, fine auc: 0.7362 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3480
Fine Overall Accuracy: 0.4962
Fine Overall F1 Score: 0.1064

Training for coarse_and_fine level...
batch 100, loss: 4.7347, instance_loss: 0.2369, weighted_loss: 3.3854, label: 4, bag_size: 187
batch 200, loss: 2.8100, instance_loss: 0.1821, weighted_loss: 2.0216, label: 5, bag_size: 378
batch 300, loss: 1.2399, instance_loss: 0.1243, weighted_loss: 0.9052, label: 5, bag_size: 1250
batch 400, loss: 3.1995, instance_loss: 0.2232, weighted_loss: 2.3066, label: 6, bag_size: 1836
batch 500, loss: 1.8346, instance_loss: 0.1544, weighted_loss: 1.3305, label: 2, bag_size: 424
batch 600, loss: 2.2495, instance_loss: 0.2517, weighted_loss: 1.6502, label: 6, bag_size: 468
batch 700, loss: 4.0678, instance_loss: 0.1818, weighted_loss: 2.9020, label: 2, bag_size: 235
batch 800, loss: 2.0131, instance_loss: 0.2411, weighted_loss: 1.4815, label: 6, bag_size: 244
batch 900, loss: 3.0478, instance_loss: 0.1945, weighted_loss: 2.1918, label: 6, bag_size: 146
batch 1000, loss: 1.9745, instance_loss: 0.1679, weighted_loss: 1.4325, label: 2, bag_size: 1174
batch 1100, loss: 1.6187, instance_loss: 0.1283, weighted_loss: 1.1716, label: 5, bag_size: 860
batch 1200, loss: 2.4610, instance_loss: 0.1977, weighted_loss: 1.7820, label: 3, bag_size: 3332
batch 1300, loss: 0.8683, instance_loss: 0.1210, weighted_loss: 0.6441, label: 5, bag_size: 743
batch 1400, loss: 1.3281, instance_loss: 0.1289, weighted_loss: 0.9683, label: 5, bag_size: 470
batch 1500, loss: 0.6139, instance_loss: 0.0899, weighted_loss: 0.4567, label: 5, bag_size: 330
batch 1600, loss: 3.5239, instance_loss: 0.2107, weighted_loss: 2.5299, label: 6, bag_size: 1836
batch 1700, loss: 2.2852, instance_loss: 0.2041, weighted_loss: 1.6608, label: 6, bag_size: 235
batch 1800, loss: 4.3120, instance_loss: 0.2204, weighted_loss: 3.0845, label: 6, bag_size: 1123
batch 1900, loss: 2.6762, instance_loss: 0.1996, weighted_loss: 1.9332, label: 6, bag_size: 483
batch 2000, loss: 3.2895, instance_loss: 0.2489, weighted_loss: 2.3773, label: 4, bag_size: 415
batch 2100, loss: 4.3392, instance_loss: 0.2385, weighted_loss: 3.1090, label: 7, bag_size: 492

Instance Classifier Stats
class 0 clustering acc 0.9998387096774194: correct 260358/260400
class 1 clustering acc 0.009101382488479262: correct 158/17360

Epoch: 22, train_loss: 2.3243, train_clustering_loss: 0.1724, train_error: 0.5147
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8472861085556578, correct coarse 921/1087 
coarse class 3: coarse acc 0.011673151750972763, correct coarse 3/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6305609284332688, correct fine 326/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8675417661097852, correct fine 727/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3284, coarse auc: 0.7581, fine auc: 0.7391 
class 0 clustering acc 1.0: correct 31680/31680 
class 1 clustering acc 0.0014204545454545455: correct 3/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3496
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1073

Training for coarse_and_fine level...
batch 100, loss: 0.5610, instance_loss: 0.1084, weighted_loss: 0.4252, label: 5, bag_size: 335
batch 200, loss: 3.8551, instance_loss: 0.2273, weighted_loss: 2.7667, label: 8, bag_size: 79
batch 300, loss: 1.1466, instance_loss: 0.1128, weighted_loss: 0.8364, label: 5, bag_size: 1564
batch 400, loss: 0.7200, instance_loss: 0.1152, weighted_loss: 0.5385, label: 5, bag_size: 304
batch 500, loss: 0.6988, instance_loss: 0.1164, weighted_loss: 0.5241, label: 5, bag_size: 298
batch 600, loss: 1.3521, instance_loss: 0.1129, weighted_loss: 0.9804, label: 5, bag_size: 434
batch 700, loss: 0.3276, instance_loss: 0.1106, weighted_loss: 0.2625, label: 5, bag_size: 261
batch 800, loss: 2.2629, instance_loss: 0.1603, weighted_loss: 1.6322, label: 2, bag_size: 179
batch 900, loss: 1.0137, instance_loss: 0.0991, weighted_loss: 0.7393, label: 5, bag_size: 776
batch 1000, loss: 6.6713, instance_loss: 0.3135, weighted_loss: 4.7640, label: 10, bag_size: 335
batch 1100, loss: 0.8883, instance_loss: 0.1159, weighted_loss: 0.6566, label: 5, bag_size: 436
batch 1200, loss: 2.0455, instance_loss: 0.1553, weighted_loss: 1.4784, label: 5, bag_size: 331
batch 1300, loss: 1.4920, instance_loss: 0.2191, weighted_loss: 1.1101, label: 6, bag_size: 504
batch 1400, loss: 0.4318, instance_loss: 0.1046, weighted_loss: 0.3337, label: 5, bag_size: 208
batch 1500, loss: 2.8190, instance_loss: 0.1938, weighted_loss: 2.0315, label: 6, bag_size: 683
batch 1600, loss: 1.8902, instance_loss: 0.1477, weighted_loss: 1.3674, label: 2, bag_size: 1767
batch 1700, loss: 0.8919, instance_loss: 0.1674, weighted_loss: 0.6746, label: 2, bag_size: 601
batch 1800, loss: 2.7120, instance_loss: 0.2380, weighted_loss: 1.9698, label: 3, bag_size: 683
batch 1900, loss: 2.1265, instance_loss: 0.2318, weighted_loss: 1.5581, label: 6, bag_size: 572
batch 2000, loss: 0.4888, instance_loss: 0.0923, weighted_loss: 0.3699, label: 5, bag_size: 542
batch 2100, loss: 3.8597, instance_loss: 0.2659, weighted_loss: 2.7816, label: 8, bag_size: 372

Instance Classifier Stats
class 0 clustering acc 0.9998118279569892: correct 260351/260400
class 1 clustering acc 0.01140552995391705: correct 198/17360

Epoch: 23, train_loss: 2.3152, train_clustering_loss: 0.1719, train_error: 0.5138
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6470588235294118, correct coarse 506/782 
coarse class 2: coarse acc 0.8610855565777369, correct coarse 936/1087 
coarse class 3: coarse acc 0.011673151750972763, correct coarse 3/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6266924564796905, correct fine 324/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8723150357995226, correct fine 731/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3208, coarse auc: 0.7628, fine auc: 0.7408 
class 0 clustering acc 0.9999684343434343: correct 31679/31680 
class 1 clustering acc 0.002840909090909091: correct 6/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6591
Coarse Overall F1 Score: 0.3461
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1072

Training for coarse_and_fine level...
batch 100, loss: 0.4478, instance_loss: 0.1039, weighted_loss: 0.3447, label: 5, bag_size: 717
batch 200, loss: 0.5842, instance_loss: 0.1152, weighted_loss: 0.4435, label: 5, bag_size: 498
batch 300, loss: 1.7042, instance_loss: 0.1255, weighted_loss: 1.2306, label: 5, bag_size: 286
batch 400, loss: 3.0836, instance_loss: 0.2278, weighted_loss: 2.2269, label: 4, bag_size: 217
batch 500, loss: 3.1607, instance_loss: 0.1553, weighted_loss: 2.2591, label: 5, bag_size: 112
batch 600, loss: 0.8205, instance_loss: 0.0909, weighted_loss: 0.6016, label: 5, bag_size: 385
batch 700, loss: 3.2522, instance_loss: 0.1992, weighted_loss: 2.3363, label: 8, bag_size: 208
batch 800, loss: 2.1382, instance_loss: 0.2344, weighted_loss: 1.5671, label: 6, bag_size: 235
batch 900, loss: 1.4624, instance_loss: 0.2122, weighted_loss: 1.0873, label: 6, bag_size: 504
batch 1000, loss: 0.6461, instance_loss: 0.1078, weighted_loss: 0.4846, label: 5, bag_size: 279
batch 1100, loss: 0.4891, instance_loss: 0.0873, weighted_loss: 0.3686, label: 5, bag_size: 468
batch 1200, loss: 0.1707, instance_loss: 0.0866, weighted_loss: 0.1455, label: 5, bag_size: 329
batch 1300, loss: 1.7660, instance_loss: 0.1768, weighted_loss: 1.2893, label: 2, bag_size: 1665
batch 1400, loss: 3.2235, instance_loss: 0.1729, weighted_loss: 2.3083, label: 2, bag_size: 165
batch 1500, loss: 1.2249, instance_loss: 0.1160, weighted_loss: 0.8922, label: 5, bag_size: 649
batch 1600, loss: 6.5825, instance_loss: 0.2677, weighted_loss: 4.6880, label: 7, bag_size: 675
batch 1700, loss: 2.9849, instance_loss: 0.1788, weighted_loss: 2.1431, label: 6, bag_size: 361
batch 1800, loss: 0.6785, instance_loss: 0.1244, weighted_loss: 0.5123, label: 5, bag_size: 597
batch 1900, loss: 3.3903, instance_loss: 0.2322, weighted_loss: 2.4429, label: 3, bag_size: 445
batch 2000, loss: 2.0364, instance_loss: 0.2229, weighted_loss: 1.4923, label: 3, bag_size: 836
batch 2100, loss: 0.9566, instance_loss: 0.0975, weighted_loss: 0.6988, label: 5, bag_size: 620

Instance Classifier Stats
class 0 clustering acc 0.9997196620583717: correct 260327/260400
class 1 clustering acc 0.013709677419354839: correct 238/17360

Epoch: 24, train_loss: 2.3066, train_clustering_loss: 0.1713, train_error: 0.5111
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.8537258509659613, correct coarse 928/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.655705996131528, correct fine 339/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8615751789976134, correct fine 722/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3131, coarse auc: 0.7674, fine auc: 0.7414 
class 0 clustering acc 0.9999684343434343: correct 31679/31680 
class 1 clustering acc 0.004261363636363636: correct 9/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6553
Coarse Overall F1 Score: 0.3442
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1074

Training for coarse_and_fine level...
batch 100, loss: 1.4800, instance_loss: 0.1799, weighted_loss: 1.0900, label: 2, bag_size: 1700
batch 200, loss: 6.8216, instance_loss: 0.2808, weighted_loss: 4.8594, label: 0, bag_size: 419
batch 300, loss: 3.0803, instance_loss: 0.1898, weighted_loss: 2.2131, label: 6, bag_size: 273
batch 400, loss: 2.8154, instance_loss: 0.1755, weighted_loss: 2.0234, label: 5, bag_size: 777
batch 500, loss: 1.9779, instance_loss: 0.2028, weighted_loss: 1.4454, label: 6, bag_size: 477
batch 600, loss: 1.6996, instance_loss: 0.1691, weighted_loss: 1.2404, label: 2, bag_size: 385
batch 700, loss: 2.4865, instance_loss: 0.2057, weighted_loss: 1.8022, label: 6, bag_size: 756
batch 800, loss: 0.4081, instance_loss: 0.0938, weighted_loss: 0.3138, label: 5, bag_size: 1023
batch 900, loss: 0.7523, instance_loss: 0.1342, weighted_loss: 0.5669, label: 2, bag_size: 872
batch 1000, loss: 4.4336, instance_loss: 0.1931, weighted_loss: 3.1614, label: 6, bag_size: 1123
batch 1100, loss: 3.3050, instance_loss: 0.2152, weighted_loss: 2.3780, label: 3, bag_size: 459
batch 1200, loss: 0.3705, instance_loss: 0.0927, weighted_loss: 0.2872, label: 5, bag_size: 525
batch 1300, loss: 3.5366, instance_loss: 0.2277, weighted_loss: 2.5440, label: 3, bag_size: 657
batch 1400, loss: 2.7180, instance_loss: 0.1964, weighted_loss: 1.9615, label: 6, bag_size: 288
batch 1500, loss: 5.1312, instance_loss: 0.2046, weighted_loss: 3.6532, label: 2, bag_size: 306
batch 1600, loss: 2.3412, instance_loss: 0.2096, weighted_loss: 1.7017, label: 3, bag_size: 774
batch 1700, loss: 1.2432, instance_loss: 0.1609, weighted_loss: 0.9185, label: 2, bag_size: 165
batch 1800, loss: 0.3250, instance_loss: 0.1063, weighted_loss: 0.2594, label: 5, bag_size: 441
batch 1900, loss: 0.3653, instance_loss: 0.1017, weighted_loss: 0.2862, label: 5, bag_size: 574
batch 2000, loss: 0.1522, instance_loss: 0.0735, weighted_loss: 0.1286, label: 5, bag_size: 198
batch 2100, loss: 4.5052, instance_loss: 0.2759, weighted_loss: 3.2364, label: 3, bag_size: 1168

Instance Classifier Stats
class 0 clustering acc 0.9996658986175115: correct 260313/260400
class 1 clustering acc 0.016589861751152075: correct 288/17360

Epoch: 25, train_loss: 2.2979, train_clustering_loss: 0.1711, train_error: 0.5101
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6572890025575447, correct coarse 514/782 
coarse class 2: coarse acc 0.8537258509659613, correct coarse 928/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6460348162475822, correct fine 334/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.869928400954654, correct fine 729/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.3061, coarse auc: 0.7692, fine auc: 0.7439 
class 0 clustering acc 0.9999684343434343: correct 31679/31680 
class 1 clustering acc 0.008049242424242424: correct 17/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3653
Fine Overall Accuracy: 0.5000
Fine Overall F1 Score: 0.1074

Training for coarse_and_fine level...
batch 100, loss: 1.0648, instance_loss: 0.1011, weighted_loss: 0.7757, label: 5, bag_size: 838
batch 200, loss: 0.9354, instance_loss: 0.1175, weighted_loss: 0.6900, label: 5, bag_size: 867
batch 300, loss: 2.0698, instance_loss: 0.2211, weighted_loss: 1.5152, label: 3, bag_size: 2302
batch 400, loss: 3.9134, instance_loss: 0.2133, weighted_loss: 2.8034, label: 2, bag_size: 237
batch 500, loss: 2.5052, instance_loss: 0.2094, weighted_loss: 1.8165, label: 6, bag_size: 424
batch 600, loss: 2.2888, instance_loss: 0.1535, weighted_loss: 1.6482, label: 5, bag_size: 156
batch 700, loss: 3.0614, instance_loss: 0.2075, weighted_loss: 2.2052, label: 8, bag_size: 299
batch 800, loss: 1.9490, instance_loss: 0.2177, weighted_loss: 1.4296, label: 4, bag_size: 454
batch 900, loss: 1.1051, instance_loss: 0.1150, weighted_loss: 0.8081, label: 5, bag_size: 621
batch 1000, loss: 0.9703, instance_loss: 0.1407, weighted_loss: 0.7214, label: 2, bag_size: 313
batch 1100, loss: 2.1027, instance_loss: 0.1502, weighted_loss: 1.5169, label: 5, bag_size: 290
batch 1200, loss: 1.7706, instance_loss: 0.1442, weighted_loss: 1.2827, label: 2, bag_size: 2104
batch 1300, loss: 2.3157, instance_loss: 0.2155, weighted_loss: 1.6856, label: 6, bag_size: 488
batch 1400, loss: 3.5843, instance_loss: 0.1949, weighted_loss: 2.5675, label: 2, bag_size: 631
batch 1500, loss: 5.7970, instance_loss: 0.2547, weighted_loss: 4.1343, label: 1, bag_size: 113
batch 1600, loss: 0.4138, instance_loss: 0.0977, weighted_loss: 0.3190, label: 5, bag_size: 289
batch 1700, loss: 5.9966, instance_loss: 0.2852, weighted_loss: 4.2832, label: 9, bag_size: 335
batch 1800, loss: 2.2206, instance_loss: 0.1504, weighted_loss: 1.5996, label: 5, bag_size: 466
batch 1900, loss: 0.8615, instance_loss: 0.1423, weighted_loss: 0.6458, label: 2, bag_size: 1447
batch 2000, loss: 0.7889, instance_loss: 0.1436, weighted_loss: 0.5953, label: 2, bag_size: 833
batch 2100, loss: 0.7238, instance_loss: 0.0954, weighted_loss: 0.5353, label: 5, bag_size: 156

Instance Classifier Stats
class 0 clustering acc 0.9996274961597542: correct 260303/260400
class 1 clustering acc 0.018778801843317972: correct 326/17360

Epoch: 26, train_loss: 2.2895, train_clustering_loss: 0.1708, train_error: 0.5097
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.8610855565777369, correct coarse 936/1087 
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6460348162475822, correct fine 334/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.869928400954654, correct fine 729/838 
fine class 6: fine acc 0.004016064257028112, correct fine 1/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2994, coarse auc: 0.7707, fine auc: 0.7447 
class 0 clustering acc 0.9999368686868687: correct 31678/31680 
class 1 clustering acc 0.01278409090909091: correct 27/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3653
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1082

Training for coarse_and_fine level...
batch 100, loss: 1.9532, instance_loss: 0.2258, weighted_loss: 1.4350, label: 5, bag_size: 473
batch 200, loss: 0.1588, instance_loss: 0.0896, weighted_loss: 0.1381, label: 5, bag_size: 403
batch 300, loss: 2.0396, instance_loss: 0.2286, weighted_loss: 1.4963, label: 4, bag_size: 897
batch 400, loss: 0.5114, instance_loss: 0.1019, weighted_loss: 0.3885, label: 5, bag_size: 765
batch 500, loss: 2.3611, instance_loss: 0.2025, weighted_loss: 1.7135, label: 6, bag_size: 129
batch 600, loss: 1.4981, instance_loss: 0.1724, weighted_loss: 1.1004, label: 2, bag_size: 1522
batch 700, loss: 8.1725, instance_loss: 0.3437, weighted_loss: 5.8238, label: 9, bag_size: 205
batch 800, loss: 4.8789, instance_loss: 0.2453, weighted_loss: 3.4888, label: 7, bag_size: 945
batch 900, loss: 0.4268, instance_loss: 0.1025, weighted_loss: 0.3295, label: 5, bag_size: 246
batch 1000, loss: 0.4738, instance_loss: 0.0810, weighted_loss: 0.3559, label: 5, bag_size: 857
batch 1100, loss: 2.2070, instance_loss: 0.1654, weighted_loss: 1.5945, label: 2, bag_size: 248
batch 1200, loss: 0.7868, instance_loss: 0.0976, weighted_loss: 0.5800, label: 5, bag_size: 1798
batch 1300, loss: 0.7767, instance_loss: 0.1045, weighted_loss: 0.5750, label: 5, bag_size: 1262
batch 1400, loss: 4.3669, instance_loss: 0.2108, weighted_loss: 3.1201, label: 3, bag_size: 347
batch 1500, loss: 1.5759, instance_loss: 0.1551, weighted_loss: 1.1497, label: 5, bag_size: 385
batch 1600, loss: 2.3521, instance_loss: 0.1401, weighted_loss: 1.6885, label: 5, bag_size: 450
batch 1700, loss: 0.7458, instance_loss: 0.0986, weighted_loss: 0.5517, label: 5, bag_size: 333
batch 1800, loss: 1.2773, instance_loss: 0.1424, weighted_loss: 0.9368, label: 2, bag_size: 343
batch 1900, loss: 0.1456, instance_loss: 0.0652, weighted_loss: 0.1215, label: 5, bag_size: 474
batch 2000, loss: 0.3387, instance_loss: 0.1045, weighted_loss: 0.2684, label: 5, bag_size: 651
batch 2100, loss: 1.3365, instance_loss: 0.1176, weighted_loss: 0.9708, label: 5, bag_size: 422

Instance Classifier Stats
class 0 clustering acc 0.9995660522273425: correct 260287/260400
class 1 clustering acc 0.02390552995391705: correct 415/17360

Epoch: 27, train_loss: 2.2817, train_clustering_loss: 0.1701, train_error: 0.5111
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.8656853725850966, correct coarse 941/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6382978723404256, correct fine 330/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8711217183770883, correct fine 730/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2931, coarse auc: 0.7719, fine auc: 0.7470 
class 0 clustering acc 0.9999368686868687: correct 31678/31680 
class 1 clustering acc 0.014204545454545454: correct 30/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3653
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1082

Training for coarse_and_fine level...
batch 100, loss: 3.5056, instance_loss: 0.2125, weighted_loss: 2.5176, label: 8, bag_size: 344
batch 200, loss: 3.2683, instance_loss: 0.1927, weighted_loss: 2.3456, label: 6, bag_size: 608
batch 300, loss: 4.3520, instance_loss: 0.2207, weighted_loss: 3.1126, label: 8, bag_size: 558
batch 400, loss: 4.7788, instance_loss: 0.2341, weighted_loss: 3.4154, label: 4, bag_size: 435
batch 500, loss: 4.2686, instance_loss: 0.2173, weighted_loss: 3.0532, label: 8, bag_size: 96
batch 600, loss: 1.3948, instance_loss: 0.1906, weighted_loss: 1.0336, label: 2, bag_size: 1536
batch 700, loss: 1.2012, instance_loss: 0.1644, weighted_loss: 0.8902, label: 2, bag_size: 687
batch 800, loss: 1.8872, instance_loss: 0.1160, weighted_loss: 1.3559, label: 5, bag_size: 1600
batch 900, loss: 0.8499, instance_loss: 0.1337, weighted_loss: 0.6350, label: 2, bag_size: 1099
batch 1000, loss: 0.7740, instance_loss: 0.1231, weighted_loss: 0.5787, label: 2, bag_size: 2523
batch 1100, loss: 3.8164, instance_loss: 0.2424, weighted_loss: 2.7442, label: 7, bag_size: 568
batch 1200, loss: 2.3878, instance_loss: 0.2188, weighted_loss: 1.7371, label: 6, bag_size: 896
batch 1300, loss: 2.1002, instance_loss: 0.1649, weighted_loss: 1.5197, label: 5, bag_size: 627
batch 1400, loss: 0.2937, instance_loss: 0.0822, weighted_loss: 0.2303, label: 5, bag_size: 592
batch 1500, loss: 2.5125, instance_loss: 0.1492, weighted_loss: 1.8035, label: 5, bag_size: 229
batch 1600, loss: 2.2131, instance_loss: 0.2382, weighted_loss: 1.6206, label: 4, bag_size: 1867
batch 1700, loss: 2.9637, instance_loss: 0.1814, weighted_loss: 2.1290, label: 2, bag_size: 217
batch 1800, loss: 0.7077, instance_loss: 0.1277, weighted_loss: 0.5337, label: 2, bag_size: 333
batch 1900, loss: 2.0224, instance_loss: 0.1519, weighted_loss: 1.4612, label: 5, bag_size: 129
batch 2000, loss: 1.2426, instance_loss: 0.1460, weighted_loss: 0.9136, label: 2, bag_size: 1397
batch 2100, loss: 3.3032, instance_loss: 0.2234, weighted_loss: 2.3793, label: 8, bag_size: 175

Instance Classifier Stats
class 0 clustering acc 0.9995852534562212: correct 260292/260400
class 1 clustering acc 0.024308755760368665: correct 422/17360

Epoch: 28, train_loss: 2.2749, train_clustering_loss: 0.1702, train_error: 0.5051
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6432225063938619, correct coarse 503/782 
coarse class 2: coarse acc 0.8656853725850966, correct coarse 941/1087 
coarse class 3: coarse acc 0.027237354085603113, correct coarse 7/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6479690522243714, correct fine 335/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8782816229116945, correct fine 736/838 
fine class 6: fine acc 0.008032128514056224, correct fine 2/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2874, coarse auc: 0.7733, fine auc: 0.7493 
class 0 clustering acc 0.9999368686868687: correct 31678/31680 
class 1 clustering acc 0.019412878787878788: correct 41/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6629
Coarse Overall F1 Score: 0.3634
Fine Overall Accuracy: 0.5038
Fine Overall F1 Score: 0.1082

Training for coarse_and_fine level...
batch 100, loss: 3.4977, instance_loss: 0.2147, weighted_loss: 2.5128, label: 8, bag_size: 338
batch 200, loss: 1.5042, instance_loss: 0.1818, weighted_loss: 1.1075, label: 2, bag_size: 643
batch 300, loss: 0.1908, instance_loss: 0.0780, weighted_loss: 0.1570, label: 5, bag_size: 185
batch 400, loss: 1.9253, instance_loss: 0.1904, weighted_loss: 1.4048, label: 3, bag_size: 1466
batch 500, loss: 1.4286, instance_loss: 0.1494, weighted_loss: 1.0449, label: 5, bag_size: 522
batch 600, loss: 0.1503, instance_loss: 0.0856, weighted_loss: 0.1309, label: 5, bag_size: 679
batch 700, loss: 4.2569, instance_loss: 0.2379, weighted_loss: 3.0512, label: 3, bag_size: 1299
batch 800, loss: 2.1096, instance_loss: 0.1651, weighted_loss: 1.5262, label: 5, bag_size: 334
batch 900, loss: 1.3993, instance_loss: 0.1161, weighted_loss: 1.0144, label: 5, bag_size: 259
batch 1000, loss: 1.9406, instance_loss: 0.1517, weighted_loss: 1.4039, label: 5, bag_size: 708
batch 1100, loss: 2.3061, instance_loss: 0.2320, weighted_loss: 1.6839, label: 6, bag_size: 1238
batch 1200, loss: 1.9178, instance_loss: 0.1363, weighted_loss: 1.3834, label: 5, bag_size: 188
batch 1300, loss: 3.7972, instance_loss: 0.2364, weighted_loss: 2.7289, label: 4, bag_size: 295
batch 1400, loss: 1.9541, instance_loss: 0.2101, weighted_loss: 1.4309, label: 3, bag_size: 504
batch 1500, loss: 3.7237, instance_loss: 0.2105, weighted_loss: 2.6698, label: 8, bag_size: 661
batch 1600, loss: 0.4826, instance_loss: 0.0814, weighted_loss: 0.3623, label: 5, bag_size: 857
batch 1700, loss: 1.5221, instance_loss: 0.1763, weighted_loss: 1.1184, label: 2, bag_size: 1234
batch 1800, loss: 3.1611, instance_loss: 0.2058, weighted_loss: 2.2745, label: 7, bag_size: 321
batch 1900, loss: 0.7364, instance_loss: 0.1121, weighted_loss: 0.5491, label: 5, bag_size: 1262
batch 2000, loss: 0.7480, instance_loss: 0.1048, weighted_loss: 0.5551, label: 5, bag_size: 308
batch 2100, loss: 0.2869, instance_loss: 0.0815, weighted_loss: 0.2252, label: 5, bag_size: 400

Instance Classifier Stats
class 0 clustering acc 0.9994969278033794: correct 260269/260400
class 1 clustering acc 0.030587557603686637: correct 531/17360

Epoch: 29, train_loss: 2.2671, train_clustering_loss: 0.1697, train_error: 0.5092
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.8638454461821528, correct coarse 939/1087 
coarse class 3: coarse acc 0.023346303501945526, correct coarse 6/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6402321083172147, correct fine 331/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8723150357995226, correct fine 731/838 
fine class 6: fine acc 0.004016064257028112, correct fine 1/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2818, coarse auc: 0.7747, fine auc: 0.7506 
class 0 clustering acc 0.9998737373737374: correct 31676/31680 
class 1 clustering acc 0.023674242424242424: correct 50/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3653
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1146

Training for coarse_and_fine level...
batch 100, loss: 0.4082, instance_loss: 0.0963, weighted_loss: 0.3146, label: 5, bag_size: 673
batch 200, loss: 0.4209, instance_loss: 0.0809, weighted_loss: 0.3189, label: 5, bag_size: 318
batch 300, loss: 1.4168, instance_loss: 0.1664, weighted_loss: 1.0417, label: 2, bag_size: 1522
batch 400, loss: 4.9031, instance_loss: 0.2168, weighted_loss: 3.4972, label: 2, bag_size: 665
batch 500, loss: 2.5712, instance_loss: 0.1850, weighted_loss: 1.8553, label: 2, bag_size: 1170
batch 600, loss: 1.6549, instance_loss: 0.1411, weighted_loss: 1.2007, label: 5, bag_size: 317
batch 700, loss: 2.5400, instance_loss: 0.2242, weighted_loss: 1.8453, label: 6, bag_size: 2224
batch 800, loss: 0.1562, instance_loss: 0.0850, weighted_loss: 0.1348, label: 5, bag_size: 743
batch 900, loss: 0.5853, instance_loss: 0.1100, weighted_loss: 0.4427, label: 5, bag_size: 637
batch 1000, loss: 1.8240, instance_loss: 0.1491, weighted_loss: 1.3216, label: 5, bag_size: 210
batch 1100, loss: 1.1403, instance_loss: 0.1453, weighted_loss: 0.8418, label: 2, bag_size: 687
batch 1200, loss: 2.2628, instance_loss: 0.2372, weighted_loss: 1.6551, label: 6, bag_size: 523
batch 1300, loss: 0.1442, instance_loss: 0.0663, weighted_loss: 0.1208, label: 5, bag_size: 543
batch 1400, loss: 6.9773, instance_loss: 0.2871, weighted_loss: 4.9702, label: 1, bag_size: 119
batch 1500, loss: 0.9541, instance_loss: 0.2080, weighted_loss: 0.7303, label: 2, bag_size: 1279
batch 1600, loss: 2.5490, instance_loss: 0.1809, weighted_loss: 1.8386, label: 2, bag_size: 177
batch 1700, loss: 0.0962, instance_loss: 0.1099, weighted_loss: 0.1003, label: 5, bag_size: 83
batch 1800, loss: 2.4888, instance_loss: 0.1868, weighted_loss: 1.7982, label: 2, bag_size: 472
batch 1900, loss: 3.9227, instance_loss: 0.2555, weighted_loss: 2.8225, label: 7, bag_size: 490
batch 2000, loss: 1.4640, instance_loss: 0.1425, weighted_loss: 1.0676, label: 5, bag_size: 422
batch 2100, loss: 2.2590, instance_loss: 0.2219, weighted_loss: 1.6479, label: 6, bag_size: 689

Instance Classifier Stats
class 0 clustering acc 0.9994086021505376: correct 260246/260400
class 1 clustering acc 0.03197004608294931: correct 555/17360

Epoch: 30, train_loss: 2.2606, train_clustering_loss: 0.1692, train_error: 0.5060
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6470588235294118, correct coarse 506/782 
coarse class 2: coarse acc 0.8638454461821528, correct coarse 939/1087 
coarse class 3: coarse acc 0.03501945525291829, correct coarse 9/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6518375241779497, correct fine 337/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8711217183770883, correct fine 730/838 
fine class 6: fine acc 0.008032128514056224, correct fine 2/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2764, coarse auc: 0.7749, fine auc: 0.7518 
class 0 clustering acc 0.999810606060606: correct 31674/31680 
class 1 clustering acc 0.030776515151515152: correct 65/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3650
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1174

Training for coarse_and_fine level...
batch 100, loss: 2.2678, instance_loss: 0.1403, weighted_loss: 1.6296, label: 5, bag_size: 338
batch 200, loss: 0.9850, instance_loss: 0.0835, weighted_loss: 0.7146, label: 5, bag_size: 909
batch 300, loss: 0.6153, instance_loss: 0.1183, weighted_loss: 0.4662, label: 2, bag_size: 2121
batch 400, loss: 4.6752, instance_loss: 0.2389, weighted_loss: 3.3443, label: 8, bag_size: 838
batch 500, loss: 7.0164, instance_loss: 0.2299, weighted_loss: 4.9805, label: 8, bag_size: 2813
batch 600, loss: 1.1573, instance_loss: 0.1213, weighted_loss: 0.8465, label: 2, bag_size: 940
batch 700, loss: 0.5042, instance_loss: 0.0961, weighted_loss: 0.3817, label: 5, bag_size: 482
batch 800, loss: 2.5135, instance_loss: 0.1600, weighted_loss: 1.8075, label: 5, bag_size: 113
batch 900, loss: 3.2137, instance_loss: 0.2313, weighted_loss: 2.3190, label: 8, bag_size: 563
batch 1000, loss: 4.5209, instance_loss: 0.1515, weighted_loss: 3.2101, label: 5, bag_size: 1206
batch 1100, loss: 8.1420, instance_loss: 0.2335, weighted_loss: 5.7694, label: 2, bag_size: 641
batch 1200, loss: 5.3410, instance_loss: 0.2609, weighted_loss: 3.8170, label: 8, bag_size: 615
batch 1300, loss: 3.6011, instance_loss: 0.2249, weighted_loss: 2.5882, label: 8, bag_size: 260
batch 1400, loss: 3.7944, instance_loss: 0.1884, weighted_loss: 2.7126, label: 2, bag_size: 57
batch 1500, loss: 5.9096, instance_loss: 0.2093, weighted_loss: 4.1995, label: 2, bag_size: 608
batch 1600, loss: 1.4699, instance_loss: 0.1680, weighted_loss: 1.0793, label: 2, bag_size: 631
batch 1700, loss: 0.7450, instance_loss: 0.1304, weighted_loss: 0.5606, label: 2, bag_size: 706
batch 1800, loss: 2.3620, instance_loss: 0.1471, weighted_loss: 1.6975, label: 5, bag_size: 202
batch 1900, loss: 3.9425, instance_loss: 0.2361, weighted_loss: 2.8306, label: 7, bag_size: 274
batch 2000, loss: 3.2672, instance_loss: 0.2122, weighted_loss: 2.3507, label: 7, bag_size: 120
batch 2100, loss: 3.9334, instance_loss: 0.2163, weighted_loss: 2.8183, label: 7, bag_size: 1196

Instance Classifier Stats
class 0 clustering acc 0.9993509984639017: correct 260231/260400
class 1 clustering acc 0.036290322580645164: correct 630/17360

Epoch: 31, train_loss: 2.2544, train_clustering_loss: 0.1685, train_error: 0.5083
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.03501945525291829, correct coarse 9/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6305609284332688, correct fine 326/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8770883054892601, correct fine 735/838 
fine class 6: fine acc 0.012048192771084338, correct fine 3/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2713, coarse auc: 0.7756, fine auc: 0.7535 
class 0 clustering acc 0.9997474747474747: correct 31672/31680 
class 1 clustering acc 0.03835227272727273: correct 81/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3675
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1165

Training for coarse_and_fine level...
batch 100, loss: 1.0977, instance_loss: 0.1046, weighted_loss: 0.7997, label: 5, bag_size: 434
batch 200, loss: 0.1549, instance_loss: 0.0779, weighted_loss: 0.1318, label: 5, bag_size: 507
batch 300, loss: 0.5456, instance_loss: 0.1126, weighted_loss: 0.4157, label: 2, bag_size: 409
batch 400, loss: 0.0637, instance_loss: 0.0589, weighted_loss: 0.0623, label: 5, bag_size: 241
batch 500, loss: 3.4759, instance_loss: 0.1833, weighted_loss: 2.4882, label: 5, bag_size: 216
batch 600, loss: 0.6157, instance_loss: 0.1098, weighted_loss: 0.4640, label: 5, bag_size: 1032
batch 700, loss: 6.3528, instance_loss: 0.3146, weighted_loss: 4.5414, label: 0, bag_size: 1736
batch 800, loss: 1.4911, instance_loss: 0.1577, weighted_loss: 1.0911, label: 2, bag_size: 2612
batch 900, loss: 3.2350, instance_loss: 0.2084, weighted_loss: 2.3270, label: 2, bag_size: 946
batch 1000, loss: 1.0658, instance_loss: 0.0865, weighted_loss: 0.7720, label: 5, bag_size: 1816
batch 1100, loss: 0.8201, instance_loss: 0.1649, weighted_loss: 0.6235, label: 2, bag_size: 2047
batch 1200, loss: 0.1721, instance_loss: 0.0836, weighted_loss: 0.1455, label: 5, bag_size: 699
batch 1300, loss: 6.9596, instance_loss: 0.2546, weighted_loss: 4.9481, label: 1, bag_size: 68
batch 1400, loss: 0.4572, instance_loss: 0.1502, weighted_loss: 0.3651, label: 2, bag_size: 305
batch 1500, loss: 0.1858, instance_loss: 0.0682, weighted_loss: 0.1505, label: 5, bag_size: 668
batch 1600, loss: 0.5777, instance_loss: 0.1211, weighted_loss: 0.4407, label: 2, bag_size: 762
batch 1700, loss: 2.3347, instance_loss: 0.1791, weighted_loss: 1.6880, label: 5, bag_size: 968
batch 1800, loss: 2.8580, instance_loss: 0.2081, weighted_loss: 2.0630, label: 2, bag_size: 1650
batch 1900, loss: 0.2696, instance_loss: 0.0689, weighted_loss: 0.2094, label: 5, bag_size: 239
batch 2000, loss: 5.8927, instance_loss: 0.2231, weighted_loss: 4.1918, label: 2, bag_size: 608
batch 2100, loss: 1.1888, instance_loss: 0.0869, weighted_loss: 0.8582, label: 5, bag_size: 1736

Instance Classifier Stats
class 0 clustering acc 0.99926267281106: correct 260208/260400
class 1 clustering acc 0.038767281105990786: correct 673/17360

Epoch: 32, train_loss: 2.2468, train_clustering_loss: 0.1690, train_error: 0.5032
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.0311284046692607, correct coarse 8/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6344294003868471, correct fine 328/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8854415274463007, correct fine 742/838 
fine class 6: fine acc 0.020080321285140562, correct fine 5/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2662, coarse auc: 0.7764, fine auc: 0.7569 
class 0 clustering acc 0.9996843434343434: correct 31670/31680 
class 1 clustering acc 0.046875: correct 99/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6780
Coarse Overall F1 Score: 0.3856
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1161

Training for coarse_and_fine level...
batch 100, loss: 1.5590, instance_loss: 0.1321, weighted_loss: 1.1310, label: 5, bag_size: 301
batch 200, loss: 0.7939, instance_loss: 0.1150, weighted_loss: 0.5902, label: 2, bag_size: 1762
batch 300, loss: 3.1680, instance_loss: 0.2077, weighted_loss: 2.2799, label: 8, bag_size: 563
batch 400, loss: 0.2836, instance_loss: 0.0721, weighted_loss: 0.2201, label: 5, bag_size: 1140
batch 500, loss: 0.5596, instance_loss: 0.1039, weighted_loss: 0.4229, label: 5, bag_size: 593
batch 600, loss: 0.1355, instance_loss: 0.0737, weighted_loss: 0.1170, label: 5, bag_size: 318
batch 700, loss: 0.5526, instance_loss: 0.1012, weighted_loss: 0.4172, label: 5, bag_size: 857
batch 800, loss: 5.0220, instance_loss: 0.2270, weighted_loss: 3.5835, label: 8, bag_size: 457
batch 900, loss: 3.7169, instance_loss: 0.2093, weighted_loss: 2.6646, label: 6, bag_size: 2033
batch 1000, loss: 2.0217, instance_loss: 0.1814, weighted_loss: 1.4696, label: 5, bag_size: 206
batch 1100, loss: 0.2122, instance_loss: 0.0828, weighted_loss: 0.1734, label: 5, bag_size: 235
batch 1200, loss: 5.0647, instance_loss: 0.2596, weighted_loss: 3.6232, label: 10, bag_size: 391
batch 1300, loss: 0.7608, instance_loss: 0.1087, weighted_loss: 0.5652, label: 5, bag_size: 933
batch 1400, loss: 3.8598, instance_loss: 0.2116, weighted_loss: 2.7653, label: 3, bag_size: 477
batch 1500, loss: 0.4266, instance_loss: 0.0770, weighted_loss: 0.3217, label: 5, bag_size: 713
batch 1600, loss: 7.5044, instance_loss: 0.2884, weighted_loss: 5.3396, label: 1, bag_size: 554
batch 1700, loss: 6.3554, instance_loss: 0.2498, weighted_loss: 4.5237, label: 1, bag_size: 320
batch 1800, loss: 2.9295, instance_loss: 0.1607, weighted_loss: 2.0989, label: 5, bag_size: 297
batch 1900, loss: 3.4250, instance_loss: 0.2127, weighted_loss: 2.4613, label: 7, bag_size: 888
batch 2000, loss: 2.3215, instance_loss: 0.1429, weighted_loss: 1.6679, label: 2, bag_size: 258
batch 2100, loss: 2.7825, instance_loss: 0.1687, weighted_loss: 1.9984, label: 2, bag_size: 115

Instance Classifier Stats
class 0 clustering acc 0.9993010752688172: correct 260218/260400
class 1 clustering acc 0.04061059907834101: correct 705/17360

Epoch: 33, train_loss: 2.2403, train_clustering_loss: 0.1680, train_error: 0.5074
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6432225063938619, correct coarse 503/782 
coarse class 2: coarse acc 0.8675252989880404, correct coarse 943/1087 
coarse class 3: coarse acc 0.042801556420233464, correct coarse 11/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.632495164410058, correct fine 327/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.017391304347826087, correct fine 2/115 
fine class 5: fine acc 0.8723150357995226, correct fine 731/838 
fine class 6: fine acc 0.028112449799196786, correct fine 7/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2613, coarse auc: 0.7773, fine auc: 0.7579 
class 0 clustering acc 0.9995580808080808: correct 31666/31680 
class 1 clustering acc 0.054924242424242424: correct 116/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3807
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1168

Training for coarse_and_fine level...
batch 100, loss: 4.7827, instance_loss: 0.1443, weighted_loss: 3.3912, label: 5, bag_size: 3052
batch 200, loss: 3.4471, instance_loss: 0.2138, weighted_loss: 2.4771, label: 8, bag_size: 461
batch 300, loss: 2.1233, instance_loss: 0.2489, weighted_loss: 1.5610, label: 6, bag_size: 468
batch 400, loss: 1.9474, instance_loss: 0.2179, weighted_loss: 1.4285, label: 6, bag_size: 1530
batch 500, loss: 1.8323, instance_loss: 0.1400, weighted_loss: 1.3246, label: 5, bag_size: 644
batch 600, loss: 2.2979, instance_loss: 0.2372, weighted_loss: 1.6797, label: 4, bag_size: 556
batch 700, loss: 3.3696, instance_loss: 0.1957, weighted_loss: 2.4174, label: 6, bag_size: 405
batch 800, loss: 2.0770, instance_loss: 0.2172, weighted_loss: 1.5190, label: 3, bag_size: 304
batch 900, loss: 3.1164, instance_loss: 0.1561, weighted_loss: 2.2283, label: 2, bag_size: 282
batch 1000, loss: 0.7561, instance_loss: 0.1392, weighted_loss: 0.5710, label: 2, bag_size: 128
batch 1100, loss: 4.3801, instance_loss: 0.2249, weighted_loss: 3.1335, label: 8, bag_size: 347
batch 1200, loss: 0.6448, instance_loss: 0.1218, weighted_loss: 0.4879, label: 2, bag_size: 309
batch 1300, loss: 0.2880, instance_loss: 0.0912, weighted_loss: 0.2289, label: 5, bag_size: 217
batch 1400, loss: 1.1047, instance_loss: 0.1290, weighted_loss: 0.8120, label: 5, bag_size: 621
batch 1500, loss: 1.4501, instance_loss: 0.1314, weighted_loss: 1.0545, label: 5, bag_size: 449
batch 1600, loss: 3.4300, instance_loss: 0.2175, weighted_loss: 2.4663, label: 7, bag_size: 312
batch 1700, loss: 0.4325, instance_loss: 0.0877, weighted_loss: 0.3290, label: 5, bag_size: 817
batch 1800, loss: 2.4956, instance_loss: 0.2514, weighted_loss: 1.8224, label: 6, bag_size: 1064
batch 1900, loss: 0.3256, instance_loss: 0.0864, weighted_loss: 0.2539, label: 5, bag_size: 956
batch 2000, loss: 2.8926, instance_loss: 0.1449, weighted_loss: 2.0683, label: 5, bag_size: 297
batch 2100, loss: 1.7098, instance_loss: 0.2253, weighted_loss: 1.2644, label: 6, bag_size: 732

Instance Classifier Stats
class 0 clustering acc 0.9992741935483871: correct 260211/260400
class 1 clustering acc 0.04959677419354839: correct 861/17360

Epoch: 34, train_loss: 2.2334, train_clustering_loss: 0.1678, train_error: 0.5046
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6329923273657289, correct coarse 495/782 
coarse class 2: coarse acc 0.8684452621895125, correct coarse 944/1087 
coarse class 3: coarse acc 0.038910505836575876, correct coarse 10/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6286266924564797, correct fine 325/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.02608695652173913, correct fine 3/115 
fine class 5: fine acc 0.8806682577565632, correct fine 738/838 
fine class 6: fine acc 0.028112449799196786, correct fine 7/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2584, coarse auc: 0.7797, fine auc: 0.7612 
class 0 clustering acc 0.9995896464646464: correct 31667/31680 
class 1 clustering acc 0.05587121212121212: correct 118/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3819
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1146

Training for coarse_and_fine level...
batch 100, loss: 2.6843, instance_loss: 0.1962, weighted_loss: 1.9379, label: 3, bag_size: 1781
batch 200, loss: 0.2622, instance_loss: 0.0637, weighted_loss: 0.2026, label: 5, bag_size: 488
batch 300, loss: 5.0274, instance_loss: 0.2687, weighted_loss: 3.5998, label: 4, bag_size: 424
batch 400, loss: 1.8578, instance_loss: 0.1962, weighted_loss: 1.3593, label: 2, bag_size: 1256
batch 500, loss: 3.7337, instance_loss: 0.1956, weighted_loss: 2.6722, label: 6, bag_size: 276
batch 600, loss: 1.2353, instance_loss: 0.1037, weighted_loss: 0.8959, label: 5, bag_size: 1736
batch 700, loss: 5.0145, instance_loss: 0.2618, weighted_loss: 3.5887, label: 3, bag_size: 542
batch 800, loss: 1.6084, instance_loss: 0.1308, weighted_loss: 1.1651, label: 5, bag_size: 335
batch 900, loss: 0.7303, instance_loss: 0.1105, weighted_loss: 0.5444, label: 2, bag_size: 2523
batch 1000, loss: 1.9097, instance_loss: 0.1430, weighted_loss: 1.3797, label: 2, bag_size: 488
batch 1100, loss: 3.3125, instance_loss: 0.2179, weighted_loss: 2.3841, label: 7, bag_size: 888
batch 1200, loss: 0.5470, instance_loss: 0.1000, weighted_loss: 0.4129, label: 5, bag_size: 328
batch 1300, loss: 1.6797, instance_loss: 0.1366, weighted_loss: 1.2168, label: 5, bag_size: 1678
batch 1400, loss: 1.2461, instance_loss: 0.1617, weighted_loss: 0.9208, label: 2, bag_size: 1628
batch 1500, loss: 2.2389, instance_loss: 0.2376, weighted_loss: 1.6385, label: 6, bag_size: 1238
batch 1600, loss: 1.0562, instance_loss: 0.1066, weighted_loss: 0.7713, label: 5, bag_size: 808
batch 1700, loss: 3.8698, instance_loss: 0.1957, weighted_loss: 2.7675, label: 5, bag_size: 294
batch 1800, loss: 0.5401, instance_loss: 0.1087, weighted_loss: 0.4106, label: 5, bag_size: 807
batch 1900, loss: 2.2467, instance_loss: 0.1566, weighted_loss: 1.6196, label: 5, bag_size: 124
batch 2000, loss: 3.5915, instance_loss: 0.1884, weighted_loss: 2.5705, label: 2, bag_size: 209
batch 2100, loss: 0.0868, instance_loss: 0.0626, weighted_loss: 0.0795, label: 5, bag_size: 861

Instance Classifier Stats
class 0 clustering acc 0.9992780337941628: correct 260212/260400
class 1 clustering acc 0.047638248847926265: correct 827/17360

Epoch: 35, train_loss: 2.2289, train_clustering_loss: 0.1678, train_error: 0.5046
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6508951406649617, correct coarse 509/782 
coarse class 2: coarse acc 0.860165593376265, correct coarse 935/1087 
coarse class 3: coarse acc 0.058365758754863814, correct coarse 15/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.632495164410058, correct fine 327/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.034782608695652174, correct fine 4/115 
fine class 5: fine acc 0.8735083532219571, correct fine 732/838 
fine class 6: fine acc 0.03614457831325301, correct fine 9/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2524, coarse auc: 0.7804, fine auc: 0.7617 
class 0 clustering acc 0.9993055555555556: correct 31658/31680 
class 1 clustering acc 0.06486742424242424: correct 137/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6667
Coarse Overall F1 Score: 0.3791
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1177

Training for coarse_and_fine level...
batch 100, loss: 3.8289, instance_loss: 0.2366, weighted_loss: 2.7512, label: 7, bag_size: 263
batch 200, loss: 2.7995, instance_loss: 0.1461, weighted_loss: 2.0035, label: 2, bag_size: 420
batch 300, loss: 0.8753, instance_loss: 0.1067, weighted_loss: 0.6447, label: 2, bag_size: 623
batch 400, loss: 1.7590, instance_loss: 0.2067, weighted_loss: 1.2933, label: 6, bag_size: 373
batch 500, loss: 1.3100, instance_loss: 0.1604, weighted_loss: 0.9651, label: 2, bag_size: 536
batch 600, loss: 0.4567, instance_loss: 0.0769, weighted_loss: 0.3428, label: 5, bag_size: 817
batch 700, loss: 0.2201, instance_loss: 0.0620, weighted_loss: 0.1727, label: 5, bag_size: 890
batch 800, loss: 3.8055, instance_loss: 0.2287, weighted_loss: 2.7325, label: 8, bag_size: 185
batch 900, loss: 0.3064, instance_loss: 0.0615, weighted_loss: 0.2330, label: 5, bag_size: 658
batch 1000, loss: 0.7577, instance_loss: 0.1038, weighted_loss: 0.5615, label: 5, bag_size: 309
batch 1100, loss: 1.1425, instance_loss: 0.1196, weighted_loss: 0.8356, label: 5, bag_size: 714
batch 1200, loss: 0.8211, instance_loss: 0.1096, weighted_loss: 0.6077, label: 2, bag_size: 958
batch 1300, loss: 4.8307, instance_loss: 0.2617, weighted_loss: 3.4600, label: 7, bag_size: 281
batch 1400, loss: 1.6656, instance_loss: 0.1697, weighted_loss: 1.2168, label: 2, bag_size: 1205
batch 1500, loss: 1.0009, instance_loss: 0.1880, weighted_loss: 0.7570, label: 2, bag_size: 496
batch 1600, loss: 2.6191, instance_loss: 0.2006, weighted_loss: 1.8936, label: 3, bag_size: 602
batch 1700, loss: 0.2126, instance_loss: 0.0757, weighted_loss: 0.1715, label: 5, bag_size: 596
batch 1800, loss: 0.4762, instance_loss: 0.0875, weighted_loss: 0.3596, label: 5, bag_size: 304
batch 1900, loss: 1.9462, instance_loss: 0.2649, weighted_loss: 1.4418, label: 4, bag_size: 889
batch 2000, loss: 2.0305, instance_loss: 0.2216, weighted_loss: 1.4879, label: 3, bag_size: 1947
batch 2100, loss: 0.2694, instance_loss: 0.0719, weighted_loss: 0.2102, label: 5, bag_size: 996

Instance Classifier Stats
class 0 clustering acc 0.9991705069124424: correct 260184/260400
class 1 clustering acc 0.049827188940092165: correct 865/17360

Epoch: 36, train_loss: 2.2220, train_clustering_loss: 0.1673, train_error: 0.5060
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.8675252989880404, correct coarse 943/1087 
coarse class 3: coarse acc 0.04669260700389105, correct coarse 12/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6247582205029013, correct fine 323/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.02608695652173913, correct fine 3/115 
fine class 5: fine acc 0.8758949880668258, correct fine 734/838 
fine class 6: fine acc 0.040160642570281124, correct fine 10/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2479, coarse auc: 0.7813, fine auc: 0.7622 
class 0 clustering acc 0.9992108585858586: correct 31655/31680 
class 1 clustering acc 0.078125: correct 165/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3672
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1176

Training for coarse_and_fine level...
batch 100, loss: 3.6331, instance_loss: 0.2089, weighted_loss: 2.6058, label: 8, bag_size: 307
batch 200, loss: 3.4448, instance_loss: 0.2163, weighted_loss: 2.4763, label: 8, bag_size: 264
batch 300, loss: 3.1338, instance_loss: 0.2098, weighted_loss: 2.2566, label: 8, bag_size: 386
batch 400, loss: 3.1170, instance_loss: 0.1911, weighted_loss: 2.2392, label: 2, bag_size: 746
batch 500, loss: 3.1978, instance_loss: 0.2153, weighted_loss: 2.3030, label: 7, bag_size: 311
batch 600, loss: 1.9813, instance_loss: 0.1602, weighted_loss: 1.4349, label: 2, bag_size: 1124
batch 700, loss: 1.4358, instance_loss: 0.1453, weighted_loss: 1.0487, label: 5, bag_size: 277
batch 800, loss: 4.0212, instance_loss: 0.2384, weighted_loss: 2.8863, label: 3, bag_size: 167
batch 900, loss: 2.0978, instance_loss: 0.0966, weighted_loss: 1.4974, label: 5, bag_size: 658
batch 1000, loss: 3.9063, instance_loss: 0.2142, weighted_loss: 2.7987, label: 8, bag_size: 216
batch 1100, loss: 0.4661, instance_loss: 0.0889, weighted_loss: 0.3529, label: 5, bag_size: 796
batch 1200, loss: 0.6668, instance_loss: 0.1302, weighted_loss: 0.5058, label: 2, bag_size: 2627
batch 1300, loss: 3.3829, instance_loss: 0.1789, weighted_loss: 2.4217, label: 6, bag_size: 281
batch 1400, loss: 2.5665, instance_loss: 0.2214, weighted_loss: 1.8630, label: 6, bag_size: 316
batch 1500, loss: 3.6754, instance_loss: 0.2441, weighted_loss: 2.6460, label: 3, bag_size: 433
batch 1600, loss: 1.7393, instance_loss: 0.1239, weighted_loss: 1.2547, label: 5, bag_size: 344
batch 1700, loss: 0.3108, instance_loss: 0.0930, weighted_loss: 0.2455, label: 5, bag_size: 381
batch 1800, loss: 1.9915, instance_loss: 0.2167, weighted_loss: 1.4591, label: 3, bag_size: 788
batch 1900, loss: 2.1402, instance_loss: 0.1837, weighted_loss: 1.5532, label: 2, bag_size: 2085
batch 2000, loss: 0.7082, instance_loss: 0.1240, weighted_loss: 0.5329, label: 2, bag_size: 706
batch 2100, loss: 1.8144, instance_loss: 0.2326, weighted_loss: 1.3398, label: 6, bag_size: 1235

Instance Classifier Stats
class 0 clustering acc 0.9990629800307219: correct 260156/260400
class 1 clustering acc 0.05743087557603686: correct 997/17360

Epoch: 37, train_loss: 2.2174, train_clustering_loss: 0.1670, train_error: 0.5041
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.058365758754863814, correct coarse 15/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6150870406189555, correct fine 318/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.05217391304347826, correct fine 6/115 
fine class 5: fine acc 0.8818615751789977, correct fine 739/838 
fine class 6: fine acc 0.040160642570281124, correct fine 10/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2436, coarse auc: 0.7822, fine auc: 0.7642 
class 0 clustering acc 0.9992108585858586: correct 31655/31680 
class 1 clustering acc 0.07954545454545454: correct 168/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6705
Coarse Overall F1 Score: 0.3810
Fine Overall Accuracy: 0.5265
Fine Overall F1 Score: 0.1185

Training for coarse_and_fine level...
batch 100, loss: 2.7210, instance_loss: 0.1179, weighted_loss: 1.9401, label: 5, bag_size: 984
batch 200, loss: 2.2487, instance_loss: 0.1484, weighted_loss: 1.6187, label: 2, bag_size: 405
batch 300, loss: 0.2607, instance_loss: 0.0670, weighted_loss: 0.2026, label: 5, bag_size: 859
batch 400, loss: 2.4565, instance_loss: 0.2022, weighted_loss: 1.7802, label: 3, bag_size: 806
batch 500, loss: 1.6730, instance_loss: 0.1712, weighted_loss: 1.2225, label: 5, bag_size: 229
batch 600, loss: 2.7454, instance_loss: 0.2077, weighted_loss: 1.9841, label: 5, bag_size: 378
batch 700, loss: 1.0236, instance_loss: 0.1225, weighted_loss: 0.7533, label: 2, bag_size: 666
batch 800, loss: 3.3405, instance_loss: 0.2171, weighted_loss: 2.4035, label: 8, bag_size: 383
batch 900, loss: 0.4615, instance_loss: 0.0907, weighted_loss: 0.3502, label: 5, bag_size: 498
batch 1000, loss: 2.8700, instance_loss: 0.2180, weighted_loss: 2.0744, label: 7, bag_size: 321
batch 1100, loss: 0.5097, instance_loss: 0.0926, weighted_loss: 0.3845, label: 5, bag_size: 304
batch 1200, loss: 2.3174, instance_loss: 0.1753, weighted_loss: 1.6747, label: 2, bag_size: 894
batch 1300, loss: 0.3434, instance_loss: 0.0800, weighted_loss: 0.2644, label: 5, bag_size: 841
batch 1400, loss: 2.4205, instance_loss: 0.1884, weighted_loss: 1.7509, label: 5, bag_size: 741
batch 1500, loss: 1.3186, instance_loss: 0.1585, weighted_loss: 0.9706, label: 2, bag_size: 1522
batch 1600, loss: 0.7693, instance_loss: 0.0911, weighted_loss: 0.5658, label: 5, bag_size: 229
batch 1700, loss: 0.6579, instance_loss: 0.0966, weighted_loss: 0.4895, label: 2, bag_size: 418
batch 1800, loss: 1.8678, instance_loss: 0.1260, weighted_loss: 1.3452, label: 5, bag_size: 233
batch 1900, loss: 5.2021, instance_loss: 0.2634, weighted_loss: 3.7205, label: 7, bag_size: 542
batch 2000, loss: 5.8933, instance_loss: 0.3296, weighted_loss: 4.2242, label: 10, bag_size: 751
batch 2100, loss: 2.0776, instance_loss: 0.1425, weighted_loss: 1.4970, label: 5, bag_size: 290

Instance Classifier Stats
class 0 clustering acc 0.9991321044546851: correct 260174/260400
class 1 clustering acc 0.05777649769585253: correct 1003/17360

Epoch: 38, train_loss: 2.2123, train_clustering_loss: 0.1670, train_error: 0.5028
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.8730450781968722, correct coarse 949/1087 
coarse class 3: coarse acc 0.05058365758754864, correct coarse 13/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.620889748549323, correct fine 321/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.06956521739130435, correct fine 8/115 
fine class 5: fine acc 0.8782816229116945, correct fine 736/838 
fine class 6: fine acc 0.04417670682730924, correct fine 11/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2396, coarse auc: 0.7825, fine auc: 0.7646 
class 0 clustering acc 0.9991477272727273: correct 31653/31680 
class 1 clustering acc 0.08948863636363637: correct 189/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.3962
Fine Overall Accuracy: 0.5265
Fine Overall F1 Score: 0.1186

Training for coarse_and_fine level...
batch 100, loss: 3.0443, instance_loss: 0.1828, weighted_loss: 2.1859, label: 6, bag_size: 106
batch 200, loss: 0.1135, instance_loss: 0.0444, weighted_loss: 0.0928, label: 5, bag_size: 537
batch 300, loss: 4.0397, instance_loss: 0.2085, weighted_loss: 2.8903, label: 3, bag_size: 197
batch 400, loss: 6.0767, instance_loss: 0.2686, weighted_loss: 4.3342, label: 0, bag_size: 419
batch 500, loss: 0.1043, instance_loss: 0.0588, weighted_loss: 0.0907, label: 5, bag_size: 198
batch 600, loss: 0.1317, instance_loss: 0.0571, weighted_loss: 0.1093, label: 5, bag_size: 651
batch 700, loss: 3.1794, instance_loss: 0.1867, weighted_loss: 2.2816, label: 2, bag_size: 437
batch 800, loss: 4.8310, instance_loss: 0.1847, weighted_loss: 3.4371, label: 5, bag_size: 2344
batch 900, loss: 0.1339, instance_loss: 0.0767, weighted_loss: 0.1167, label: 5, bag_size: 432
batch 1000, loss: 1.5597, instance_loss: 0.1372, weighted_loss: 1.1329, label: 2, bag_size: 385
batch 1100, loss: 1.5630, instance_loss: 0.1422, weighted_loss: 1.1368, label: 5, bag_size: 236
batch 1200, loss: 0.2516, instance_loss: 0.0765, weighted_loss: 0.1991, label: 5, bag_size: 288
batch 1300, loss: 3.2581, instance_loss: 0.2392, weighted_loss: 2.3524, label: 2, bag_size: 2139
batch 1400, loss: 2.0357, instance_loss: 0.1477, weighted_loss: 1.4693, label: 5, bag_size: 290
batch 1500, loss: 2.4160, instance_loss: 0.1632, weighted_loss: 1.7401, label: 2, bag_size: 190
batch 1600, loss: 2.6764, instance_loss: 0.2265, weighted_loss: 1.9415, label: 4, bag_size: 584
batch 1700, loss: 0.8340, instance_loss: 0.1143, weighted_loss: 0.6181, label: 5, bag_size: 714
batch 1800, loss: 4.2576, instance_loss: 0.2445, weighted_loss: 3.0537, label: 4, bag_size: 37
batch 1900, loss: 3.7934, instance_loss: 0.2003, weighted_loss: 2.7155, label: 2, bag_size: 57
batch 2000, loss: 2.8125, instance_loss: 0.1867, weighted_loss: 2.0248, label: 6, bag_size: 146
batch 2100, loss: 7.2304, instance_loss: 0.2799, weighted_loss: 5.1453, label: 7, bag_size: 94

Instance Classifier Stats
class 0 clustering acc 0.9990015360983103: correct 260140/260400
class 1 clustering acc 0.06388248847926267: correct 1109/17360

Epoch: 39, train_loss: 2.2064, train_clustering_loss: 0.1664, train_error: 0.5009
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.05058365758754864, correct coarse 13/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6363636363636364, correct fine 329/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.06956521739130435, correct fine 8/115 
fine class 5: fine acc 0.8747016706443914, correct fine 733/838 
fine class 6: fine acc 0.04417670682730924, correct fine 11/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2356, coarse auc: 0.7832, fine auc: 0.7651 
class 0 clustering acc 0.9991477272727273: correct 31653/31680 
class 1 clustering acc 0.09375: correct 198/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.3962
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1177

Training for coarse_and_fine level...
batch 100, loss: 0.9989, instance_loss: 0.1171, weighted_loss: 0.7343, label: 2, bag_size: 940
batch 200, loss: 0.8682, instance_loss: 0.1512, weighted_loss: 0.6531, label: 2, bag_size: 673
batch 300, loss: 2.3203, instance_loss: 0.1892, weighted_loss: 1.6810, label: 6, bag_size: 129
batch 400, loss: 2.8088, instance_loss: 0.1997, weighted_loss: 2.0261, label: 8, bag_size: 208
batch 500, loss: 0.3128, instance_loss: 0.0746, weighted_loss: 0.2413, label: 5, bag_size: 1137
batch 600, loss: 2.1853, instance_loss: 0.1730, weighted_loss: 1.5816, label: 2, bag_size: 366
batch 700, loss: 2.0648, instance_loss: 0.2418, weighted_loss: 1.5179, label: 3, bag_size: 350
batch 800, loss: 0.4714, instance_loss: 0.1036, weighted_loss: 0.3611, label: 5, bag_size: 229
batch 900, loss: 2.1686, instance_loss: 0.1905, weighted_loss: 1.5752, label: 6, bag_size: 488
batch 1000, loss: 2.0839, instance_loss: 0.1578, weighted_loss: 1.5061, label: 2, bag_size: 858
batch 1100, loss: 5.1484, instance_loss: 0.2722, weighted_loss: 3.6855, label: 7, bag_size: 388
batch 1200, loss: 0.0709, instance_loss: 0.0478, weighted_loss: 0.0640, label: 5, bag_size: 965
batch 1300, loss: 1.8808, instance_loss: 0.1442, weighted_loss: 1.3598, label: 5, bag_size: 156
batch 1400, loss: 2.4679, instance_loss: 0.1513, weighted_loss: 1.7729, label: 2, bag_size: 311
batch 1500, loss: 3.2176, instance_loss: 0.1900, weighted_loss: 2.3093, label: 2, bag_size: 142
batch 1600, loss: 4.4000, instance_loss: 0.2292, weighted_loss: 3.1488, label: 3, bag_size: 185
batch 1700, loss: 3.1065, instance_loss: 0.2120, weighted_loss: 2.2382, label: 8, bag_size: 386
batch 1800, loss: 2.3351, instance_loss: 0.2053, weighted_loss: 1.6961, label: 6, bag_size: 1122
batch 1900, loss: 4.0367, instance_loss: 0.2048, weighted_loss: 2.8871, label: 2, bag_size: 359
batch 2000, loss: 1.3375, instance_loss: 0.1682, weighted_loss: 0.9867, label: 2, bag_size: 1918
batch 2100, loss: 3.1386, instance_loss: 0.2045, weighted_loss: 2.2584, label: 7, bag_size: 189

Instance Classifier Stats
class 0 clustering acc 0.9989170506912443: correct 260118/260400
class 1 clustering acc 0.06324884792626728: correct 1098/17360

Epoch: 40, train_loss: 2.2019, train_clustering_loss: 0.1661, train_error: 0.5028
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8702851885924563, correct coarse 946/1087 
coarse class 3: coarse acc 0.058365758754863814, correct coarse 15/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6015473887814313, correct fine 311/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.08695652173913043, correct fine 10/115 
fine class 5: fine acc 0.8866348448687351, correct fine 743/838 
fine class 6: fine acc 0.04819277108433735, correct fine 12/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2324, coarse auc: 0.7836, fine auc: 0.7667 
class 0 clustering acc 0.999084595959596: correct 31651/31680 
class 1 clustering acc 0.09801136363636363: correct 207/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.3962
Fine Overall Accuracy: 0.5265
Fine Overall F1 Score: 0.1188

Training for coarse_and_fine level...
batch 100, loss: 2.7379, instance_loss: 0.1871, weighted_loss: 1.9726, label: 5, bag_size: 353
batch 200, loss: 1.2940, instance_loss: 0.1369, weighted_loss: 0.9468, label: 5, bag_size: 355
batch 300, loss: 8.2636, instance_loss: 0.3079, weighted_loss: 5.8769, label: 10, bag_size: 724
batch 400, loss: 2.2052, instance_loss: 0.1642, weighted_loss: 1.5929, label: 2, bag_size: 965
batch 500, loss: 0.2335, instance_loss: 0.0966, weighted_loss: 0.1924, label: 5, bag_size: 332
batch 600, loss: 0.5240, instance_loss: 0.1081, weighted_loss: 0.3992, label: 2, bag_size: 941
batch 700, loss: 0.9869, instance_loss: 0.1227, weighted_loss: 0.7276, label: 5, bag_size: 511
batch 800, loss: 4.7086, instance_loss: 0.2333, weighted_loss: 3.3660, label: 8, bag_size: 838
batch 900, loss: 1.9072, instance_loss: 0.2006, weighted_loss: 1.3953, label: 3, bag_size: 526
batch 1000, loss: 4.1127, instance_loss: 0.2150, weighted_loss: 2.9434, label: 3, bag_size: 197
batch 1100, loss: 1.4325, instance_loss: 0.1576, weighted_loss: 1.0500, label: 5, bag_size: 270
batch 1200, loss: 0.3631, instance_loss: 0.0760, weighted_loss: 0.2770, label: 5, bag_size: 467
batch 1300, loss: 1.0708, instance_loss: 0.0773, weighted_loss: 0.7728, label: 5, bag_size: 1000
batch 1400, loss: 2.9635, instance_loss: 0.1944, weighted_loss: 2.1327, label: 5, bag_size: 478
batch 1500, loss: 2.6421, instance_loss: 0.2024, weighted_loss: 1.9102, label: 3, bag_size: 483
batch 1600, loss: 4.3383, instance_loss: 0.2020, weighted_loss: 3.0974, label: 2, bag_size: 268
batch 1700, loss: 2.8985, instance_loss: 0.1489, weighted_loss: 2.0736, label: 2, bag_size: 364
batch 1800, loss: 1.5539, instance_loss: 0.1211, weighted_loss: 1.1241, label: 5, bag_size: 462
batch 1900, loss: 0.2870, instance_loss: 0.0562, weighted_loss: 0.2178, label: 5, bag_size: 1217
batch 2000, loss: 4.6558, instance_loss: 0.2300, weighted_loss: 3.3281, label: 10, bag_size: 13
batch 2100, loss: 2.2527, instance_loss: 0.1023, weighted_loss: 1.6076, label: 5, bag_size: 1048

Instance Classifier Stats
class 0 clustering acc 0.9988056835637481: correct 260089/260400
class 1 clustering acc 0.06952764976958525: correct 1207/17360

Epoch: 41, train_loss: 2.1971, train_clustering_loss: 0.1665, train_error: 0.4991
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.874885004599816, correct coarse 951/1087 
coarse class 3: coarse acc 0.07392996108949416, correct coarse 19/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6092843326885881, correct fine 315/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.09565217391304348, correct fine 11/115 
fine class 5: fine acc 0.8902147971360382, correct fine 746/838 
fine class 6: fine acc 0.04819277108433735, correct fine 12/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2291, coarse auc: 0.7838, fine auc: 0.7682 
class 0 clustering acc 0.999084595959596: correct 31651/31680 
class 1 clustering acc 0.10085227272727272: correct 213/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.3962
Fine Overall Accuracy: 0.5265
Fine Overall F1 Score: 0.1188

Training for coarse_and_fine level...
batch 100, loss: 1.5025, instance_loss: 0.2514, weighted_loss: 1.1272, label: 6, bag_size: 474
batch 200, loss: 0.2800, instance_loss: 0.0646, weighted_loss: 0.2154, label: 5, bag_size: 1301
batch 300, loss: 2.6716, instance_loss: 0.1828, weighted_loss: 1.9250, label: 5, bag_size: 30
batch 400, loss: 0.3761, instance_loss: 0.0666, weighted_loss: 0.2832, label: 5, bag_size: 753
batch 500, loss: 3.5962, instance_loss: 0.2072, weighted_loss: 2.5795, label: 8, bag_size: 307
batch 600, loss: 3.4939, instance_loss: 0.2445, weighted_loss: 2.5191, label: 4, bag_size: 425
batch 700, loss: 3.6289, instance_loss: 0.1404, weighted_loss: 2.5823, label: 5, bag_size: 2209
batch 800, loss: 2.0694, instance_loss: 0.1932, weighted_loss: 1.5066, label: 5, bag_size: 174
batch 900, loss: 2.9069, instance_loss: 0.1651, weighted_loss: 2.0843, label: 2, bag_size: 1214
batch 1000, loss: 10.8448, instance_loss: 0.3399, weighted_loss: 7.6933, label: 3, bag_size: 477
batch 1100, loss: 0.8592, instance_loss: 0.1302, weighted_loss: 0.6405, label: 2, bag_size: 1833
batch 1200, loss: 0.2332, instance_loss: 0.0783, weighted_loss: 0.1867, label: 5, bag_size: 288
batch 1300, loss: 2.8652, instance_loss: 0.1970, weighted_loss: 2.0647, label: 6, bag_size: 682
batch 1400, loss: 2.2095, instance_loss: 0.2248, weighted_loss: 1.6141, label: 4, bag_size: 160
batch 1500, loss: 0.6156, instance_loss: 0.1316, weighted_loss: 0.4704, label: 2, bag_size: 2214
batch 1600, loss: 0.3267, instance_loss: 0.0720, weighted_loss: 0.2503, label: 5, bag_size: 673
batch 1700, loss: 3.2677, instance_loss: 0.2240, weighted_loss: 2.3546, label: 7, bag_size: 354
batch 1800, loss: 1.9979, instance_loss: 0.2126, weighted_loss: 1.4623, label: 3, bag_size: 567
batch 1900, loss: 0.5091, instance_loss: 0.0790, weighted_loss: 0.3801, label: 5, bag_size: 1308
batch 2000, loss: 1.1069, instance_loss: 0.1823, weighted_loss: 0.8295, label: 2, bag_size: 3773
batch 2100, loss: 0.8442, instance_loss: 0.0918, weighted_loss: 0.6185, label: 5, bag_size: 326

Instance Classifier Stats
class 0 clustering acc 0.9989400921658986: correct 260124/260400
class 1 clustering acc 0.07131336405529953: correct 1238/17360

Epoch: 42, train_loss: 2.1918, train_clustering_loss: 0.1662, train_error: 0.4986
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.8684452621895125, correct coarse 944/1087 
coarse class 3: coarse acc 0.06614785992217899, correct coarse 17/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6131528046421664, correct fine 317/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.11304347826086956, correct fine 13/115 
fine class 5: fine acc 0.8854415274463007, correct fine 742/838 
fine class 6: fine acc 0.05220883534136546, correct fine 13/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2256, coarse auc: 0.7848, fine auc: 0.7693 
class 0 clustering acc 0.999084595959596: correct 31651/31680 
class 1 clustering acc 0.10321969696969698: correct 218/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4118
Fine Overall Accuracy: 0.5227
Fine Overall F1 Score: 0.1180

Training for coarse_and_fine level...
batch 100, loss: 1.6047, instance_loss: 0.1425, weighted_loss: 1.1660, label: 5, bag_size: 654
batch 200, loss: 4.8976, instance_loss: 0.2623, weighted_loss: 3.5070, label: 7, bag_size: 256
batch 300, loss: 0.2948, instance_loss: 0.1014, weighted_loss: 0.2368, label: 5, bag_size: 755
batch 400, loss: 1.4763, instance_loss: 0.1383, weighted_loss: 1.0749, label: 5, bag_size: 138
batch 500, loss: 3.1134, instance_loss: 0.2217, weighted_loss: 2.2459, label: 7, bag_size: 132
batch 600, loss: 0.6229, instance_loss: 0.0687, weighted_loss: 0.4567, label: 5, bag_size: 1364
batch 700, loss: 1.2354, instance_loss: 0.0874, weighted_loss: 0.8910, label: 5, bag_size: 389
batch 800, loss: 3.9786, instance_loss: 0.1688, weighted_loss: 2.8357, label: 5, bag_size: 2146
batch 900, loss: 2.3957, instance_loss: 0.1830, weighted_loss: 1.7319, label: 2, bag_size: 568
batch 1000, loss: 1.6406, instance_loss: 0.1372, weighted_loss: 1.1896, label: 5, bag_size: 301
batch 1100, loss: 3.1811, instance_loss: 0.1961, weighted_loss: 2.2856, label: 8, bag_size: 175
batch 1200, loss: 1.0952, instance_loss: 0.2368, weighted_loss: 0.8377, label: 4, bag_size: 542
batch 1300, loss: 0.4948, instance_loss: 0.0685, weighted_loss: 0.3669, label: 5, bag_size: 618
batch 1400, loss: 1.3016, instance_loss: 0.2065, weighted_loss: 0.9731, label: 2, bag_size: 643
batch 1500, loss: 1.7111, instance_loss: 0.2463, weighted_loss: 1.2717, label: 4, bag_size: 1460
batch 1600, loss: 1.5517, instance_loss: 0.1934, weighted_loss: 1.1442, label: 6, bag_size: 580
batch 1700, loss: 3.9249, instance_loss: 0.2411, weighted_loss: 2.8197, label: 3, bag_size: 1666
batch 1800, loss: 3.0199, instance_loss: 0.2264, weighted_loss: 2.1819, label: 6, bag_size: 1836
batch 1900, loss: 2.4562, instance_loss: 0.2388, weighted_loss: 1.7910, label: 4, bag_size: 2056
batch 2000, loss: 4.4950, instance_loss: 0.2152, weighted_loss: 3.2110, label: 3, bag_size: 202
batch 2100, loss: 2.0984, instance_loss: 0.2106, weighted_loss: 1.5321, label: 3, bag_size: 683

Instance Classifier Stats
class 0 clustering acc 0.9987749615975422: correct 260081/260400
class 1 clustering acc 0.07597926267281106: correct 1319/17360

Epoch: 43, train_loss: 2.1869, train_clustering_loss: 0.1658, train_error: 0.4977
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6329923273657289, correct coarse 495/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6112185686653772, correct fine 316/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.13043478260869565, correct fine 15/115 
fine class 5: fine acc 0.8854415274463007, correct fine 742/838 
fine class 6: fine acc 0.05622489959839357, correct fine 14/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2229, coarse auc: 0.7850, fine auc: 0.7702 
class 0 clustering acc 0.998989898989899: correct 31648/31680 
class 1 clustering acc 0.10558712121212122: correct 223/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4129
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1157

Training for coarse_and_fine level...
batch 100, loss: 3.2772, instance_loss: 0.2152, weighted_loss: 2.3586, label: 8, bag_size: 756
batch 200, loss: 5.0351, instance_loss: 0.2588, weighted_loss: 3.6022, label: 7, bag_size: 1800
batch 300, loss: 2.8751, instance_loss: 0.1650, weighted_loss: 2.0621, label: 2, bag_size: 558
batch 400, loss: 0.7081, instance_loss: 0.1035, weighted_loss: 0.5267, label: 2, bag_size: 939
batch 500, loss: 3.4272, instance_loss: 0.1858, weighted_loss: 2.4548, label: 6, bag_size: 259
batch 600, loss: 4.2298, instance_loss: 0.3081, weighted_loss: 3.0533, label: 4, bag_size: 997
batch 700, loss: 0.4652, instance_loss: 0.1119, weighted_loss: 0.3592, label: 2, bag_size: 633
batch 800, loss: 4.3045, instance_loss: 0.2439, weighted_loss: 3.0863, label: 8, bag_size: 253
batch 900, loss: 1.3631, instance_loss: 0.1312, weighted_loss: 0.9935, label: 5, bag_size: 216
batch 1000, loss: 2.9893, instance_loss: 0.1650, weighted_loss: 2.1420, label: 2, bag_size: 138
batch 1100, loss: 6.3325, instance_loss: 0.2798, weighted_loss: 4.5167, label: 1, bag_size: 258
batch 1200, loss: 0.8856, instance_loss: 0.1276, weighted_loss: 0.6582, label: 2, bag_size: 483
batch 1300, loss: 3.5145, instance_loss: 0.2052, weighted_loss: 2.5217, label: 7, bag_size: 529
batch 1400, loss: 5.6451, instance_loss: 0.2706, weighted_loss: 4.0328, label: 1, bag_size: 482
batch 1500, loss: 0.2770, instance_loss: 0.0730, weighted_loss: 0.2158, label: 5, bag_size: 254
batch 1600, loss: 2.5769, instance_loss: 0.1852, weighted_loss: 1.8594, label: 5, bag_size: 376
batch 1700, loss: 0.7309, instance_loss: 0.1166, weighted_loss: 0.5466, label: 2, bag_size: 313
batch 1800, loss: 6.1143, instance_loss: 0.2712, weighted_loss: 4.3613, label: 1, bag_size: 352
batch 1900, loss: 0.2349, instance_loss: 0.0766, weighted_loss: 0.1874, label: 5, bag_size: 446
batch 2000, loss: 2.8000, instance_loss: 0.2230, weighted_loss: 2.0269, label: 4, bag_size: 183
batch 2100, loss: 2.0742, instance_loss: 0.1894, weighted_loss: 1.5088, label: 2, bag_size: 531

Instance Classifier Stats
class 0 clustering acc 0.998721198156682: correct 260067/260400
class 1 clustering acc 0.07811059907834102: correct 1356/17360

Epoch: 44, train_loss: 2.1828, train_clustering_loss: 0.1655, train_error: 0.4982
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6547314578005116, correct coarse 512/782 
coarse class 2: coarse acc 0.8656853725850966, correct coarse 941/1087 
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.16521739130434782, correct fine 19/115 
fine class 5: fine acc 0.8866348448687351, correct fine 743/838 
fine class 6: fine acc 0.04819277108433735, correct fine 12/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2190, coarse auc: 0.7859, fine auc: 0.7711 
class 0 clustering acc 0.9989583333333333: correct 31647/31680 
class 1 clustering acc 0.10984848484848485: correct 232/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4118
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1160

Training for coarse_and_fine level...
batch 100, loss: 1.0088, instance_loss: 0.0934, weighted_loss: 0.7342, label: 5, bag_size: 291
batch 200, loss: 2.7365, instance_loss: 0.1705, weighted_loss: 1.9667, label: 2, bag_size: 169
batch 300, loss: 2.5934, instance_loss: 0.2428, weighted_loss: 1.8882, label: 4, bag_size: 691
batch 400, loss: 6.6391, instance_loss: 0.3327, weighted_loss: 4.7472, label: 10, bag_size: 481
batch 500, loss: 2.9118, instance_loss: 0.2118, weighted_loss: 2.1018, label: 7, bag_size: 120
batch 600, loss: 3.0624, instance_loss: 0.2019, weighted_loss: 2.2043, label: 8, bag_size: 679
batch 700, loss: 0.6264, instance_loss: 0.0921, weighted_loss: 0.4661, label: 5, bag_size: 385
batch 800, loss: 3.1266, instance_loss: 0.1875, weighted_loss: 2.2449, label: 2, bag_size: 508
batch 900, loss: 3.3199, instance_loss: 0.1991, weighted_loss: 2.3837, label: 8, bag_size: 383
batch 1000, loss: 1.4820, instance_loss: 0.0936, weighted_loss: 1.0655, label: 5, bag_size: 1600
batch 1100, loss: 3.7482, instance_loss: 0.1997, weighted_loss: 2.6836, label: 6, bag_size: 409
batch 1200, loss: 0.1462, instance_loss: 0.0556, weighted_loss: 0.1190, label: 5, bag_size: 288
batch 1300, loss: 3.3201, instance_loss: 0.2733, weighted_loss: 2.4061, label: 6, bag_size: 371
batch 1400, loss: 4.2857, instance_loss: 0.1491, weighted_loss: 3.0447, label: 5, bag_size: 3051
batch 1500, loss: 3.8980, instance_loss: 0.2145, weighted_loss: 2.7930, label: 8, bag_size: 216
batch 1600, loss: 0.2557, instance_loss: 0.0658, weighted_loss: 0.1987, label: 5, bag_size: 902
batch 1700, loss: 1.5724, instance_loss: 0.1320, weighted_loss: 1.1403, label: 5, bag_size: 466
batch 1800, loss: 0.6298, instance_loss: 0.0912, weighted_loss: 0.4682, label: 5, bag_size: 478
batch 1900, loss: 0.5054, instance_loss: 0.1047, weighted_loss: 0.3852, label: 2, bag_size: 547
batch 2000, loss: 2.3335, instance_loss: 0.1832, weighted_loss: 1.6884, label: 2, bag_size: 204
batch 2100, loss: 2.4473, instance_loss: 0.1734, weighted_loss: 1.7652, label: 2, bag_size: 862

Instance Classifier Stats
class 0 clustering acc 0.9987519201228878: correct 260075/260400
class 1 clustering acc 0.07828341013824885: correct 1359/17360

Epoch: 45, train_loss: 2.1784, train_clustering_loss: 0.1652, train_error: 0.4963
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6445012787723785, correct coarse 504/782 
coarse class 2: coarse acc 0.874885004599816, correct coarse 951/1087 
coarse class 3: coarse acc 0.0622568093385214, correct coarse 16/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6150870406189555, correct fine 318/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1565217391304348, correct fine 18/115 
fine class 5: fine acc 0.8806682577565632, correct fine 738/838 
fine class 6: fine acc 0.0642570281124498, correct fine 16/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2159, coarse auc: 0.7863, fine auc: 0.7718 
class 0 clustering acc 0.9988636363636364: correct 31644/31680 
class 1 clustering acc 0.11742424242424243: correct 248/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4118
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1157

Training for coarse_and_fine level...
batch 100, loss: 3.5832, instance_loss: 0.2046, weighted_loss: 2.5696, label: 8, bag_size: 185
batch 200, loss: 3.4677, instance_loss: 0.1866, weighted_loss: 2.4834, label: 6, bag_size: 608
batch 300, loss: 3.3360, instance_loss: 0.1932, weighted_loss: 2.3932, label: 3, bag_size: 1223
batch 400, loss: 2.0059, instance_loss: 0.2299, weighted_loss: 1.4731, label: 4, bag_size: 1410
batch 500, loss: 4.0667, instance_loss: 0.2241, weighted_loss: 2.9139, label: 6, bag_size: 290
batch 600, loss: 2.4624, instance_loss: 0.1958, weighted_loss: 1.7824, label: 3, bag_size: 602
batch 700, loss: 3.9780, instance_loss: 0.2103, weighted_loss: 2.8477, label: 3, bag_size: 285
batch 800, loss: 3.1312, instance_loss: 0.2083, weighted_loss: 2.2543, label: 8, bag_size: 707
batch 900, loss: 2.4841, instance_loss: 0.2095, weighted_loss: 1.8017, label: 3, bag_size: 1477
batch 1000, loss: 0.1116, instance_loss: 0.0472, weighted_loss: 0.0923, label: 5, bag_size: 700
batch 1100, loss: 0.3003, instance_loss: 0.0845, weighted_loss: 0.2356, label: 5, bag_size: 640
batch 1200, loss: 1.3485, instance_loss: 0.1348, weighted_loss: 0.9844, label: 5, bag_size: 546
batch 1300, loss: 3.7170, instance_loss: 0.2192, weighted_loss: 2.6676, label: 3, bag_size: 445
batch 1400, loss: 2.8841, instance_loss: 0.1960, weighted_loss: 2.0776, label: 8, bag_size: 216
batch 1500, loss: 1.9759, instance_loss: 0.2527, weighted_loss: 1.4589, label: 4, bag_size: 217
batch 1600, loss: 0.7863, instance_loss: 0.0945, weighted_loss: 0.5787, label: 5, bag_size: 620
batch 1700, loss: 0.2540, instance_loss: 0.0519, weighted_loss: 0.1933, label: 5, bag_size: 815
batch 1800, loss: 6.6954, instance_loss: 0.2657, weighted_loss: 4.7665, label: 1, bag_size: 220
batch 1900, loss: 3.6201, instance_loss: 0.2428, weighted_loss: 2.6069, label: 7, bag_size: 441
batch 2000, loss: 2.0182, instance_loss: 0.2213, weighted_loss: 1.4791, label: 6, bag_size: 263
batch 2100, loss: 3.5374, instance_loss: 0.2042, weighted_loss: 2.5374, label: 2, bag_size: 50

Instance Classifier Stats
class 0 clustering acc 0.9988594470046083: correct 260103/260400
class 1 clustering acc 0.07828341013824885: correct 1359/17360

Epoch: 46, train_loss: 2.1761, train_clustering_loss: 0.1653, train_error: 0.4954
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6202046035805626, correct coarse 485/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5918762088974855, correct fine 306/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2, correct fine 23/115 
fine class 5: fine acc 0.8926014319809069, correct fine 748/838 
fine class 6: fine acc 0.060240963855421686, correct fine 15/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2135, coarse auc: 0.7861, fine auc: 0.7723 
class 0 clustering acc 0.9988636363636364: correct 31644/31680 
class 1 clustering acc 0.11742424242424243: correct 248/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6856
Coarse Overall F1 Score: 0.4149
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1276

Training for coarse_and_fine level...
batch 100, loss: 1.0291, instance_loss: 0.2378, weighted_loss: 0.7917, label: 4, bag_size: 836
batch 200, loss: 0.2181, instance_loss: 0.0683, weighted_loss: 0.1731, label: 5, bag_size: 645
batch 300, loss: 2.5109, instance_loss: 0.1732, weighted_loss: 1.8096, label: 2, bag_size: 613
batch 400, loss: 0.3000, instance_loss: 0.0747, weighted_loss: 0.2324, label: 5, bag_size: 887
batch 500, loss: 0.9468, instance_loss: 0.1411, weighted_loss: 0.7051, label: 2, bag_size: 821
batch 600, loss: 6.0617, instance_loss: 0.2913, weighted_loss: 4.3306, label: 10, bag_size: 625
batch 700, loss: 3.5037, instance_loss: 0.2606, weighted_loss: 2.5308, label: 4, bag_size: 574
batch 800, loss: 1.4402, instance_loss: 0.1144, weighted_loss: 1.0424, label: 5, bag_size: 450
batch 900, loss: 3.8660, instance_loss: 0.2220, weighted_loss: 2.7728, label: 8, bag_size: 571
batch 1000, loss: 2.8422, instance_loss: 0.1677, weighted_loss: 2.0399, label: 5, bag_size: 469
batch 1100, loss: 3.5420, instance_loss: 0.2329, weighted_loss: 2.5493, label: 2, bag_size: 2625
batch 1200, loss: 2.3102, instance_loss: 0.2276, weighted_loss: 1.6854, label: 6, bag_size: 206
batch 1300, loss: 2.4634, instance_loss: 0.1313, weighted_loss: 1.7638, label: 2, bag_size: 646
batch 1400, loss: 0.2611, instance_loss: 0.0621, weighted_loss: 0.2014, label: 5, bag_size: 1137
batch 1500, loss: 0.8711, instance_loss: 0.1219, weighted_loss: 0.6464, label: 2, bag_size: 623
batch 1600, loss: 3.8623, instance_loss: 0.2190, weighted_loss: 2.7693, label: 3, bag_size: 522
batch 1700, loss: 0.7197, instance_loss: 0.1112, weighted_loss: 0.5371, label: 2, bag_size: 1470
batch 1800, loss: 2.2472, instance_loss: 0.1906, weighted_loss: 1.6302, label: 5, bag_size: 242
batch 1900, loss: 4.5582, instance_loss: 0.2440, weighted_loss: 3.2639, label: 7, bag_size: 760
batch 2000, loss: 2.5012, instance_loss: 0.1639, weighted_loss: 1.8000, label: 2, bag_size: 611
batch 2100, loss: 0.4739, instance_loss: 0.0994, weighted_loss: 0.3615, label: 5, bag_size: 229

Instance Classifier Stats
class 0 clustering acc 0.9987135176651306: correct 260065/260400
class 1 clustering acc 0.07932027649769585: correct 1377/17360

Epoch: 47, train_loss: 2.1707, train_clustering_loss: 0.1648, train_error: 0.4940
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6131528046421664, correct fine 317/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2, correct fine 23/115 
fine class 5: fine acc 0.8794749403341289, correct fine 737/838 
fine class 6: fine acc 0.07228915662650602, correct fine 18/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2106, coarse auc: 0.7862, fine auc: 0.7732 
class 0 clustering acc 0.9986742424242424: correct 31638/31680 
class 1 clustering acc 0.12121212121212122: correct 256/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6856
Coarse Overall F1 Score: 0.4149
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1266

Training for coarse_and_fine level...
batch 100, loss: 0.2663, instance_loss: 0.0552, weighted_loss: 0.2029, label: 5, bag_size: 1217
batch 200, loss: 0.6229, instance_loss: 0.1103, weighted_loss: 0.4691, label: 2, bag_size: 3550
batch 300, loss: 3.0449, instance_loss: 0.1625, weighted_loss: 2.1801, label: 5, bag_size: 325
batch 400, loss: 2.6458, instance_loss: 0.1908, weighted_loss: 1.9093, label: 8, bag_size: 119
batch 500, loss: 0.7536, instance_loss: 0.1083, weighted_loss: 0.5600, label: 5, bag_size: 393
batch 600, loss: 0.1413, instance_loss: 0.0508, weighted_loss: 0.1142, label: 5, bag_size: 711
batch 700, loss: 0.3391, instance_loss: 0.0768, weighted_loss: 0.2604, label: 5, bag_size: 353
batch 800, loss: 1.5624, instance_loss: 0.1301, weighted_loss: 1.1327, label: 5, bag_size: 929
batch 900, loss: 1.0563, instance_loss: 0.1008, weighted_loss: 0.7697, label: 5, bag_size: 888
batch 1000, loss: 1.7357, instance_loss: 0.2506, weighted_loss: 1.2902, label: 4, bag_size: 1867
batch 1100, loss: 2.6149, instance_loss: 0.1864, weighted_loss: 1.8863, label: 5, bag_size: 276
batch 1200, loss: 3.0382, instance_loss: 0.1946, weighted_loss: 2.1851, label: 6, bag_size: 106
batch 1300, loss: 2.7762, instance_loss: 0.1663, weighted_loss: 1.9933, label: 5, bag_size: 519
batch 1400, loss: 1.4144, instance_loss: 0.1238, weighted_loss: 1.0272, label: 5, bag_size: 386
batch 1500, loss: 1.8702, instance_loss: 0.1576, weighted_loss: 1.3564, label: 5, bag_size: 131
batch 1600, loss: 0.6707, instance_loss: 0.1107, weighted_loss: 0.5027, label: 5, bag_size: 365
batch 1700, loss: 2.4295, instance_loss: 0.2379, weighted_loss: 1.7720, label: 6, bag_size: 600
batch 1800, loss: 2.5045, instance_loss: 0.1931, weighted_loss: 1.8111, label: 2, bag_size: 472
batch 1900, loss: 5.8439, instance_loss: 0.2873, weighted_loss: 4.1769, label: 7, bag_size: 166
batch 2000, loss: 0.5125, instance_loss: 0.1057, weighted_loss: 0.3905, label: 2, bag_size: 305
batch 2100, loss: 0.7955, instance_loss: 0.0772, weighted_loss: 0.5800, label: 5, bag_size: 841

Instance Classifier Stats
class 0 clustering acc 0.9986175115207373: correct 260040/260400
class 1 clustering acc 0.08392857142857142: correct 1457/17360

Epoch: 48, train_loss: 2.1669, train_clustering_loss: 0.1646, train_error: 0.4917
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6073500967117988, correct fine 314/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.8890214797136038, correct fine 745/838 
fine class 6: fine acc 0.0642570281124498, correct fine 16/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2080, coarse auc: 0.7864, fine auc: 0.7736 
class 0 clustering acc 0.9986742424242424: correct 31638/31680 
class 1 clustering acc 0.1240530303030303: correct 262/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6856
Coarse Overall F1 Score: 0.4145
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1369

Training for coarse_and_fine level...
batch 100, loss: 1.8534, instance_loss: 0.2684, weighted_loss: 1.3779, label: 6, bag_size: 1248
batch 200, loss: 4.6895, instance_loss: 0.2263, weighted_loss: 3.3506, label: 4, bag_size: 402
batch 300, loss: 3.0769, instance_loss: 0.2133, weighted_loss: 2.2179, label: 8, bag_size: 228
batch 400, loss: 4.6406, instance_loss: 0.1984, weighted_loss: 3.3080, label: 2, bag_size: 302
batch 500, loss: 1.7587, instance_loss: 0.1656, weighted_loss: 1.2808, label: 2, bag_size: 223
batch 600, loss: 2.0147, instance_loss: 0.1610, weighted_loss: 1.4586, label: 5, bag_size: 627
batch 700, loss: 1.9572, instance_loss: 0.1816, weighted_loss: 1.4245, label: 5, bag_size: 206
batch 800, loss: 0.9175, instance_loss: 0.1020, weighted_loss: 0.6729, label: 5, bag_size: 636
batch 900, loss: 0.1865, instance_loss: 0.0688, weighted_loss: 0.1512, label: 5, bag_size: 596
batch 1000, loss: 3.9832, instance_loss: 0.2181, weighted_loss: 2.8537, label: 8, bag_size: 276
batch 1100, loss: 7.8496, instance_loss: 0.2953, weighted_loss: 5.5833, label: 1, bag_size: 1452
batch 1200, loss: 2.0824, instance_loss: 0.2484, weighted_loss: 1.5322, label: 3, bag_size: 428
batch 1300, loss: 1.4999, instance_loss: 0.2231, weighted_loss: 1.1168, label: 3, bag_size: 836
batch 1400, loss: 0.2305, instance_loss: 0.0422, weighted_loss: 0.1740, label: 5, bag_size: 827
batch 1500, loss: 0.4977, instance_loss: 0.1045, weighted_loss: 0.3797, label: 5, bag_size: 637
batch 1600, loss: 1.0857, instance_loss: 0.1009, weighted_loss: 0.7902, label: 5, bag_size: 714
batch 1700, loss: 3.5499, instance_loss: 0.2464, weighted_loss: 2.5589, label: 4, bag_size: 574
batch 1800, loss: 3.3270, instance_loss: 0.1928, weighted_loss: 2.3868, label: 6, bag_size: 273
batch 1900, loss: 0.1759, instance_loss: 0.0533, weighted_loss: 0.1391, label: 5, bag_size: 515
batch 2000, loss: 4.6390, instance_loss: 0.2539, weighted_loss: 3.3234, label: 3, bag_size: 709
batch 2100, loss: 0.0846, instance_loss: 0.0713, weighted_loss: 0.0806, label: 5, bag_size: 190

Instance Classifier Stats
class 0 clustering acc 0.9985752688172043: correct 260029/260400
class 1 clustering acc 0.088536866359447: correct 1537/17360

Epoch: 49, train_loss: 2.1630, train_clustering_loss: 0.1645, train_error: 0.4880
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.07003891050583658, correct coarse 18/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6015473887814313, correct fine 311/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2, correct fine 23/115 
fine class 5: fine acc 0.8973747016706444, correct fine 752/838 
fine class 6: fine acc 0.08433734939759036, correct fine 21/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2058, coarse auc: 0.7868, fine auc: 0.7738 
class 0 clustering acc 0.9987058080808081: correct 31639/31680 
class 1 clustering acc 0.12547348484848486: correct 265/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4118
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1368

Training for coarse_and_fine level...
batch 100, loss: 1.4812, instance_loss: 0.1648, weighted_loss: 1.0863, label: 2, bag_size: 1174
batch 200, loss: 3.5305, instance_loss: 0.2027, weighted_loss: 2.5322, label: 7, bag_size: 441
batch 300, loss: 0.8238, instance_loss: 0.1132, weighted_loss: 0.6106, label: 5, bag_size: 364
batch 400, loss: 4.2338, instance_loss: 0.2617, weighted_loss: 3.0422, label: 4, bag_size: 758
batch 500, loss: 2.4853, instance_loss: 0.2747, weighted_loss: 1.8222, label: 6, bag_size: 304
batch 600, loss: 0.8001, instance_loss: 0.1605, weighted_loss: 0.6082, label: 2, bag_size: 2037
batch 700, loss: 3.5581, instance_loss: 0.2597, weighted_loss: 2.5686, label: 4, bag_size: 574
batch 800, loss: 1.1784, instance_loss: 0.1326, weighted_loss: 0.8647, label: 5, bag_size: 621
batch 900, loss: 0.9402, instance_loss: 0.1437, weighted_loss: 0.7012, label: 2, bag_size: 457
batch 1000, loss: 3.9800, instance_loss: 0.2386, weighted_loss: 2.8576, label: 4, bag_size: 308
batch 1100, loss: 1.6811, instance_loss: 0.1602, weighted_loss: 1.2248, label: 5, bag_size: 111
batch 1200, loss: 2.6443, instance_loss: 0.1867, weighted_loss: 1.9070, label: 6, bag_size: 590
batch 1300, loss: 0.5580, instance_loss: 0.1181, weighted_loss: 0.4260, label: 2, bag_size: 309
batch 1400, loss: 3.2238, instance_loss: 0.1739, weighted_loss: 2.3089, label: 2, bag_size: 119
batch 1500, loss: 0.4320, instance_loss: 0.0494, weighted_loss: 0.3172, label: 5, bag_size: 788
batch 1600, loss: 6.8429, instance_loss: 0.2637, weighted_loss: 4.8691, label: 2, bag_size: 738
batch 1700, loss: 2.3755, instance_loss: 0.1328, weighted_loss: 1.7027, label: 5, bag_size: 466
batch 1800, loss: 2.1734, instance_loss: 0.1867, weighted_loss: 1.5774, label: 2, bag_size: 204
batch 1900, loss: 2.7170, instance_loss: 0.1725, weighted_loss: 1.9536, label: 5, bag_size: 469
batch 2000, loss: 4.0602, instance_loss: 0.2568, weighted_loss: 2.9192, label: 3, bag_size: 952
batch 2100, loss: 2.1715, instance_loss: 0.2547, weighted_loss: 1.5965, label: 6, bag_size: 278

Instance Classifier Stats
class 0 clustering acc 0.9986597542242703: correct 260051/260400
class 1 clustering acc 0.08986175115207373: correct 1560/17360

Epoch: 50, train_loss: 2.1586, train_clustering_loss: 0.1644, train_error: 0.4926
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8712051517939282, correct coarse 947/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5880077369439072, correct fine 304/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.8926014319809069, correct fine 748/838 
fine class 6: fine acc 0.08433734939759036, correct fine 21/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2032, coarse auc: 0.7873, fine auc: 0.7759 
class 0 clustering acc 0.9987058080808081: correct 31639/31680 
class 1 clustering acc 0.1259469696969697: correct 266/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6856
Coarse Overall F1 Score: 0.4145
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1357

Training for coarse_and_fine level...
batch 100, loss: 0.5048, instance_loss: 0.1008, weighted_loss: 0.3836, label: 2, bag_size: 305
batch 200, loss: 0.2348, instance_loss: 0.0592, weighted_loss: 0.1821, label: 5, bag_size: 779
batch 300, loss: 3.9580, instance_loss: 0.2139, weighted_loss: 2.8348, label: 2, bag_size: 393
batch 400, loss: 1.6724, instance_loss: 0.1464, weighted_loss: 1.2146, label: 5, bag_size: 337
batch 500, loss: 3.7446, instance_loss: 0.1993, weighted_loss: 2.6810, label: 3, bag_size: 522
batch 600, loss: 1.7981, instance_loss: 0.1524, weighted_loss: 1.3044, label: 5, bag_size: 187
batch 700, loss: 3.6108, instance_loss: 0.2283, weighted_loss: 2.5961, label: 4, bag_size: 344
batch 800, loss: 2.5427, instance_loss: 0.1904, weighted_loss: 1.8370, label: 6, bag_size: 304
batch 900, loss: 2.3169, instance_loss: 0.2130, weighted_loss: 1.6858, label: 6, bag_size: 896
batch 1000, loss: 3.5730, instance_loss: 0.2345, weighted_loss: 2.5715, label: 8, bag_size: 720
batch 1100, loss: 2.5592, instance_loss: 0.1788, weighted_loss: 1.8451, label: 2, bag_size: 556
batch 1200, loss: 2.7317, instance_loss: 0.1867, weighted_loss: 1.9682, label: 8, bag_size: 249
batch 1300, loss: 2.5441, instance_loss: 0.1902, weighted_loss: 1.8379, label: 6, bag_size: 201
batch 1400, loss: 0.4679, instance_loss: 0.0633, weighted_loss: 0.3465, label: 5, bag_size: 765
batch 1500, loss: 0.1025, instance_loss: 0.0595, weighted_loss: 0.0896, label: 5, bag_size: 635
batch 1600, loss: 1.7463, instance_loss: 0.1643, weighted_loss: 1.2717, label: 5, bag_size: 111
batch 1700, loss: 5.1461, instance_loss: 0.2735, weighted_loss: 3.6843, label: 7, bag_size: 708
batch 1800, loss: 1.2993, instance_loss: 0.1107, weighted_loss: 0.9427, label: 5, bag_size: 1049
batch 1900, loss: 0.5104, instance_loss: 0.0871, weighted_loss: 0.3834, label: 5, bag_size: 310
batch 2000, loss: 0.4344, instance_loss: 0.1048, weighted_loss: 0.3355, label: 5, bag_size: 168
batch 2100, loss: 2.2241, instance_loss: 0.2256, weighted_loss: 1.6246, label: 3, bag_size: 510

Instance Classifier Stats
class 0 clustering acc 0.9985483870967742: correct 260022/260400
class 1 clustering acc 0.08623271889400921: correct 1497/17360

Epoch: 51, train_loss: 2.1567, train_clustering_loss: 0.1641, train_error: 0.4857
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6112185686653772, correct fine 316/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.8890214797136038, correct fine 745/838 
fine class 6: fine acc 0.10441767068273092, correct fine 26/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.2006, coarse auc: 0.7873, fine auc: 0.7752 
class 0 clustering acc 0.9986111111111111: correct 31636/31680 
class 1 clustering acc 0.13162878787878787: correct 278/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6780
Coarse Overall F1 Score: 0.4094
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1370

Training for coarse_and_fine level...
batch 100, loss: 0.1700, instance_loss: 0.0599, weighted_loss: 0.1370, label: 5, bag_size: 724
batch 200, loss: 1.5603, instance_loss: 0.1448, weighted_loss: 1.1356, label: 5, bag_size: 1068
batch 300, loss: 4.2833, instance_loss: 0.2273, weighted_loss: 3.0665, label: 3, bag_size: 276
batch 400, loss: 0.8421, instance_loss: 0.1178, weighted_loss: 0.6248, label: 2, bag_size: 232
batch 500, loss: 0.1473, instance_loss: 0.0357, weighted_loss: 0.1138, label: 5, bag_size: 890
batch 600, loss: 3.5276, instance_loss: 0.1800, weighted_loss: 2.5233, label: 2, bag_size: 73
batch 700, loss: 4.0295, instance_loss: 0.2406, weighted_loss: 2.8928, label: 2, bag_size: 348
batch 800, loss: 3.4501, instance_loss: 0.2613, weighted_loss: 2.4935, label: 6, bag_size: 416
batch 900, loss: 2.7758, instance_loss: 0.1827, weighted_loss: 1.9978, label: 2, bag_size: 298
batch 1000, loss: 0.7559, instance_loss: 0.1232, weighted_loss: 0.5661, label: 2, bag_size: 680
batch 1100, loss: 1.8328, instance_loss: 0.2528, weighted_loss: 1.3588, label: 6, bag_size: 570
batch 1200, loss: 2.8018, instance_loss: 0.2017, weighted_loss: 2.0218, label: 7, bag_size: 120
batch 1300, loss: 0.5389, instance_loss: 0.1131, weighted_loss: 0.4111, label: 2, bag_size: 214
batch 1400, loss: 3.8545, instance_loss: 0.2273, weighted_loss: 2.7664, label: 7, bag_size: 778
batch 1500, loss: 0.7511, instance_loss: 0.1111, weighted_loss: 0.5591, label: 2, bag_size: 1311
batch 1600, loss: 2.7527, instance_loss: 0.2105, weighted_loss: 1.9901, label: 6, bag_size: 739
batch 1700, loss: 2.0912, instance_loss: 0.2012, weighted_loss: 1.5242, label: 3, bag_size: 589
batch 1800, loss: 0.4859, instance_loss: 0.0805, weighted_loss: 0.3643, label: 5, bag_size: 460
batch 1900, loss: 1.8498, instance_loss: 0.1524, weighted_loss: 1.3406, label: 5, bag_size: 513
batch 2000, loss: 10.9080, instance_loss: 0.3827, weighted_loss: 7.7504, label: 7, bag_size: 868
batch 2100, loss: 2.7428, instance_loss: 0.1779, weighted_loss: 1.9733, label: 8, bag_size: 119

Instance Classifier Stats
class 0 clustering acc 0.9986098310291859: correct 260038/260400
class 1 clustering acc 0.09297235023041475: correct 1614/17360

Epoch: 52, train_loss: 2.1531, train_clustering_loss: 0.1641, train_error: 0.4894
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.0933852140077821, correct coarse 24/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5938104448742747, correct fine 307/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.22608695652173913, correct fine 26/115 
fine class 5: fine acc 0.89618138424821, correct fine 751/838 
fine class 6: fine acc 0.08032128514056225, correct fine 20/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1978, coarse auc: 0.7875, fine auc: 0.7765 
class 0 clustering acc 0.9986426767676768: correct 31637/31680 
class 1 clustering acc 0.13494318181818182: correct 285/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6818
Coarse Overall F1 Score: 0.4117
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1363

Training for coarse_and_fine level...
batch 100, loss: 1.5651, instance_loss: 0.1313, weighted_loss: 1.1350, label: 5, bag_size: 193
batch 200, loss: 0.6609, instance_loss: 0.0925, weighted_loss: 0.4904, label: 2, bag_size: 392
batch 300, loss: 2.7651, instance_loss: 0.1822, weighted_loss: 1.9903, label: 2, bag_size: 298
batch 400, loss: 2.5935, instance_loss: 0.2069, weighted_loss: 1.8775, label: 6, bag_size: 201
batch 500, loss: 4.9030, instance_loss: 0.2708, weighted_loss: 3.5133, label: 8, bag_size: 567
batch 600, loss: 0.8190, instance_loss: 0.1135, weighted_loss: 0.6073, label: 2, bag_size: 1973
batch 700, loss: 0.1400, instance_loss: 0.0559, weighted_loss: 0.1148, label: 5, bag_size: 679
batch 800, loss: 1.5848, instance_loss: 0.1310, weighted_loss: 1.1487, label: 5, bag_size: 473
batch 900, loss: 2.1071, instance_loss: 0.2210, weighted_loss: 1.5412, label: 3, bag_size: 685
batch 1000, loss: 0.2419, instance_loss: 0.0679, weighted_loss: 0.1897, label: 5, bag_size: 844
batch 1100, loss: 5.6865, instance_loss: 0.2829, weighted_loss: 4.0654, label: 10, bag_size: 162
batch 1200, loss: 2.7847, instance_loss: 0.1888, weighted_loss: 2.0060, label: 6, bag_size: 519
batch 1300, loss: 1.5266, instance_loss: 0.1571, weighted_loss: 1.1157, label: 5, bag_size: 108
batch 1400, loss: 0.8542, instance_loss: 0.1030, weighted_loss: 0.6288, label: 2, bag_size: 232
batch 1500, loss: 5.1176, instance_loss: 0.2622, weighted_loss: 3.6610, label: 7, bag_size: 945
batch 1600, loss: 1.8440, instance_loss: 0.2019, weighted_loss: 1.3514, label: 3, bag_size: 292
batch 1700, loss: 0.1068, instance_loss: 0.0571, weighted_loss: 0.0919, label: 5, bag_size: 629
batch 1800, loss: 3.0665, instance_loss: 0.2076, weighted_loss: 2.2088, label: 8, bag_size: 415
batch 1900, loss: 3.2806, instance_loss: 0.2158, weighted_loss: 2.3612, label: 8, bag_size: 260
batch 2000, loss: 10.9767, instance_loss: 0.3479, weighted_loss: 7.7880, label: 7, bag_size: 868
batch 2100, loss: 0.3678, instance_loss: 0.0712, weighted_loss: 0.2788, label: 5, bag_size: 788

Instance Classifier Stats
class 0 clustering acc 0.9984677419354838: correct 260001/260400
class 1 clustering acc 0.09222350230414747: correct 1601/17360

Epoch: 53, train_loss: 2.1478, train_clustering_loss: 0.1637, train_error: 0.4871
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6406649616368286, correct coarse 501/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6073500967117988, correct fine 314/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.8914081145584726, correct fine 747/838 
fine class 6: fine acc 0.09236947791164658, correct fine 23/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1959, coarse auc: 0.7878, fine auc: 0.7774 
class 0 clustering acc 0.9986426767676768: correct 31637/31680 
class 1 clustering acc 0.13731060606060605: correct 290/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6780
Coarse Overall F1 Score: 0.4092
Fine Overall Accuracy: 0.5189
Fine Overall F1 Score: 0.1374

Training for coarse_and_fine level...
batch 100, loss: 2.1965, instance_loss: 0.1546, weighted_loss: 1.5839, label: 2, bag_size: 102
batch 200, loss: 0.1858, instance_loss: 0.0662, weighted_loss: 0.1499, label: 5, bag_size: 235
batch 300, loss: 2.5767, instance_loss: 0.1659, weighted_loss: 1.8535, label: 5, bag_size: 548
batch 400, loss: 2.0086, instance_loss: 0.1552, weighted_loss: 1.4526, label: 2, bag_size: 309
batch 500, loss: 1.3365, instance_loss: 0.1149, weighted_loss: 0.9700, label: 5, bag_size: 216
batch 600, loss: 1.0583, instance_loss: 0.1386, weighted_loss: 0.7824, label: 2, bag_size: 936
batch 700, loss: 2.8079, instance_loss: 0.1987, weighted_loss: 2.0251, label: 8, bag_size: 144
batch 800, loss: 0.7701, instance_loss: 0.1100, weighted_loss: 0.5721, label: 2, bag_size: 313
batch 900, loss: 0.1666, instance_loss: 0.0560, weighted_loss: 0.1334, label: 5, bag_size: 488
batch 1000, loss: 0.2353, instance_loss: 0.0777, weighted_loss: 0.1880, label: 5, bag_size: 834
batch 1100, loss: 2.1304, instance_loss: 0.1520, weighted_loss: 1.5369, label: 5, bag_size: 708
batch 1200, loss: 3.0259, instance_loss: 0.1653, weighted_loss: 2.1677, label: 5, bag_size: 153
batch 1300, loss: 0.3299, instance_loss: 0.0798, weighted_loss: 0.2549, label: 5, bag_size: 1110
batch 1400, loss: 2.0867, instance_loss: 0.1512, weighted_loss: 1.5060, label: 5, bag_size: 110
batch 1500, loss: 0.3829, instance_loss: 0.0842, weighted_loss: 0.2933, label: 5, bag_size: 239
batch 1600, loss: 2.7802, instance_loss: 0.1834, weighted_loss: 2.0011, label: 2, bag_size: 228
batch 1700, loss: 3.7601, instance_loss: 0.2510, weighted_loss: 2.7073, label: 3, bag_size: 972
batch 1800, loss: 3.9923, instance_loss: 0.2211, weighted_loss: 2.8610, label: 3, bag_size: 174
batch 1900, loss: 1.8917, instance_loss: 0.1794, weighted_loss: 1.3780, label: 2, bag_size: 298
batch 2000, loss: 1.2552, instance_loss: 0.0960, weighted_loss: 0.9074, label: 5, bag_size: 696
batch 2100, loss: 5.4169, instance_loss: 0.2128, weighted_loss: 3.8557, label: 5, bag_size: 2344

Instance Classifier Stats
class 0 clustering acc 0.9985138248847927: correct 260013/260400
class 1 clustering acc 0.09591013824884792: correct 1665/17360

Epoch: 54, train_loss: 2.1450, train_clustering_loss: 0.1634, train_error: 0.4857
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6329923273657289, correct coarse 495/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.08171206225680934, correct coarse 21/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5957446808510638, correct fine 308/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.23478260869565218, correct fine 27/115 
fine class 5: fine acc 0.89618138424821, correct fine 751/838 
fine class 6: fine acc 0.10441767068273092, correct fine 26/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1942, coarse auc: 0.7883, fine auc: 0.7784 
class 0 clustering acc 0.9986426767676768: correct 31637/31680 
class 1 clustering acc 0.1396780303030303: correct 295/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6856
Coarse Overall F1 Score: 0.4145
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1364

Training for coarse_and_fine level...
batch 100, loss: 1.3590, instance_loss: 0.1285, weighted_loss: 0.9899, label: 5, bag_size: 280
batch 200, loss: 0.1861, instance_loss: 0.0515, weighted_loss: 0.1457, label: 5, bag_size: 676
batch 300, loss: 0.3633, instance_loss: 0.0741, weighted_loss: 0.2765, label: 5, bag_size: 239
batch 400, loss: 2.7631, instance_loss: 0.1888, weighted_loss: 1.9908, label: 6, bag_size: 338
batch 500, loss: 1.5742, instance_loss: 0.1549, weighted_loss: 1.1484, label: 5, bag_size: 569
batch 600, loss: 0.2043, instance_loss: 0.0822, weighted_loss: 0.1677, label: 5, bag_size: 208
batch 700, loss: 0.1099, instance_loss: 0.0659, weighted_loss: 0.0967, label: 5, bag_size: 255
batch 800, loss: 2.1770, instance_loss: 0.2216, weighted_loss: 1.5904, label: 3, bag_size: 2069
batch 900, loss: 2.9154, instance_loss: 0.1809, weighted_loss: 2.0950, label: 5, bag_size: 404
batch 1000, loss: 2.6275, instance_loss: 0.1923, weighted_loss: 1.8970, label: 6, bag_size: 268
batch 1100, loss: 0.4226, instance_loss: 0.0778, weighted_loss: 0.3192, label: 5, bag_size: 324
batch 1200, loss: 1.8832, instance_loss: 0.2067, weighted_loss: 1.3803, label: 6, bag_size: 239
batch 1300, loss: 2.7135, instance_loss: 0.2492, weighted_loss: 1.9742, label: 6, bag_size: 414
batch 1400, loss: 3.1560, instance_loss: 0.2303, weighted_loss: 2.2783, label: 7, bag_size: 590
batch 1500, loss: 2.5383, instance_loss: 0.2109, weighted_loss: 1.8401, label: 6, bag_size: 200
batch 1600, loss: 1.9044, instance_loss: 0.1678, weighted_loss: 1.3834, label: 5, bag_size: 290
batch 1700, loss: 3.9481, instance_loss: 0.2241, weighted_loss: 2.8309, label: 3, bag_size: 98
batch 1800, loss: 1.3369, instance_loss: 0.1740, weighted_loss: 0.9880, label: 5, bag_size: 275
batch 1900, loss: 3.2271, instance_loss: 0.2008, weighted_loss: 2.3192, label: 6, bag_size: 219
batch 2000, loss: 6.5589, instance_loss: 0.3354, weighted_loss: 4.6919, label: 9, bag_size: 84
batch 2100, loss: 1.4264, instance_loss: 0.2294, weighted_loss: 1.0673, label: 6, bag_size: 461

Instance Classifier Stats
class 0 clustering acc 0.9985522273425499: correct 260023/260400
class 1 clustering acc 0.09711981566820277: correct 1686/17360

Epoch: 55, train_loss: 2.1435, train_clustering_loss: 0.1633, train_error: 0.4880
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.874885004599816, correct coarse 951/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5918762088974855, correct fine 306/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.24347826086956523, correct fine 28/115 
fine class 5: fine acc 0.8914081145584726, correct fine 747/838 
fine class 6: fine acc 0.10040160642570281, correct fine 25/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1922, coarse auc: 0.7885, fine auc: 0.7787 
class 0 clustering acc 0.9986111111111111: correct 31636/31680 
class 1 clustering acc 0.14015151515151514: correct 296/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6780
Coarse Overall F1 Score: 0.4096
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1364

Training for coarse_and_fine level...
batch 100, loss: 2.4103, instance_loss: 0.2153, weighted_loss: 1.7518, label: 6, bag_size: 464
batch 200, loss: 1.6209, instance_loss: 0.2258, weighted_loss: 1.2023, label: 4, bag_size: 1726
batch 300, loss: 0.5963, instance_loss: 0.0963, weighted_loss: 0.4463, label: 5, bag_size: 600
batch 400, loss: 1.9225, instance_loss: 0.2351, weighted_loss: 1.4163, label: 3, bag_size: 2879
batch 500, loss: 0.9207, instance_loss: 0.1270, weighted_loss: 0.6826, label: 5, bag_size: 511
batch 600, loss: 3.9958, instance_loss: 0.2262, weighted_loss: 2.8649, label: 7, bag_size: 426
batch 700, loss: 2.9468, instance_loss: 0.1536, weighted_loss: 2.1088, label: 2, bag_size: 364
batch 800, loss: 1.2946, instance_loss: 0.2263, weighted_loss: 0.9741, label: 6, bag_size: 474
batch 900, loss: 1.4281, instance_loss: 0.1393, weighted_loss: 1.0415, label: 2, bag_size: 165
batch 1000, loss: 3.1431, instance_loss: 0.2470, weighted_loss: 2.2742, label: 7, bag_size: 568
batch 1100, loss: 3.8810, instance_loss: 0.2414, weighted_loss: 2.7891, label: 3, bag_size: 972
batch 1200, loss: 0.6743, instance_loss: 0.1094, weighted_loss: 0.5048, label: 2, bag_size: 1535
batch 1300, loss: 6.6290, instance_loss: 0.2670, weighted_loss: 4.7204, label: 8, bag_size: 568
batch 1400, loss: 7.6319, instance_loss: 0.2683, weighted_loss: 5.4228, label: 8, bag_size: 2813
batch 1500, loss: 0.1462, instance_loss: 0.0664, weighted_loss: 0.1222, label: 5, bag_size: 228
batch 1600, loss: 0.3506, instance_loss: 0.0892, weighted_loss: 0.2722, label: 5, bag_size: 461
batch 1700, loss: 2.5055, instance_loss: 0.1688, weighted_loss: 1.8045, label: 5, bag_size: 463
batch 1800, loss: 1.1458, instance_loss: 0.0990, weighted_loss: 0.8318, label: 5, bag_size: 861
batch 1900, loss: 3.2116, instance_loss: 0.2287, weighted_loss: 2.3167, label: 2, bag_size: 564
batch 2000, loss: 1.4840, instance_loss: 0.1521, weighted_loss: 1.0844, label: 5, bag_size: 332
batch 2100, loss: 2.8905, instance_loss: 0.2385, weighted_loss: 2.0949, label: 3, bag_size: 1678

Instance Classifier Stats
class 0 clustering acc 0.9983256528417819: correct 259964/260400
class 1 clustering acc 0.10190092165898618: correct 1769/17360

Epoch: 56, train_loss: 2.1401, train_clustering_loss: 0.1634, train_error: 0.4862
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8831646734130635, correct coarse 960/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5841392649903289, correct fine 302/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.24347826086956523, correct fine 28/115 
fine class 5: fine acc 0.8997613365155132, correct fine 754/838 
fine class 6: fine acc 0.10441767068273092, correct fine 26/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1917, coarse auc: 0.7886, fine auc: 0.7787 
class 0 clustering acc 0.9986742424242424: correct 31638/31680 
class 1 clustering acc 0.13589015151515152: correct 287/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.4070
Fine Overall Accuracy: 0.5076
Fine Overall F1 Score: 0.1350

Training for coarse_and_fine level...
batch 100, loss: 1.5200, instance_loss: 0.1726, weighted_loss: 1.1158, label: 6, bag_size: 156
batch 200, loss: 2.6330, instance_loss: 0.1865, weighted_loss: 1.8990, label: 6, bag_size: 589
batch 300, loss: 2.5399, instance_loss: 0.1923, weighted_loss: 1.8356, label: 6, bag_size: 590
batch 400, loss: 1.4419, instance_loss: 0.1526, weighted_loss: 1.0551, label: 5, bag_size: 148
batch 500, loss: 1.2688, instance_loss: 0.2456, weighted_loss: 0.9618, label: 4, bag_size: 2131
batch 600, loss: 2.4175, instance_loss: 0.1829, weighted_loss: 1.7471, label: 2, bag_size: 472
batch 700, loss: 0.5286, instance_loss: 0.0939, weighted_loss: 0.3982, label: 5, bag_size: 393
batch 800, loss: 2.0974, instance_loss: 0.2127, weighted_loss: 1.5320, label: 6, bag_size: 451
batch 900, loss: 0.1013, instance_loss: 0.0529, weighted_loss: 0.0868, label: 5, bag_size: 278
batch 1000, loss: 0.9738, instance_loss: 0.1231, weighted_loss: 0.7186, label: 5, bag_size: 366
batch 1100, loss: 1.0622, instance_loss: 0.2369, weighted_loss: 0.8146, label: 4, bag_size: 507
batch 1200, loss: 0.3189, instance_loss: 0.0907, weighted_loss: 0.2504, label: 5, bag_size: 475
batch 1300, loss: 0.4641, instance_loss: 0.0889, weighted_loss: 0.3515, label: 5, bag_size: 424
batch 1400, loss: 0.5321, instance_loss: 0.0725, weighted_loss: 0.3942, label: 5, bag_size: 1304
batch 1500, loss: 1.5228, instance_loss: 0.1445, weighted_loss: 1.1093, label: 2, bag_size: 1293
batch 1600, loss: 1.0553, instance_loss: 0.1764, weighted_loss: 0.7916, label: 2, bag_size: 3773
batch 1700, loss: 3.2806, instance_loss: 0.1587, weighted_loss: 2.3441, label: 5, bag_size: 304
batch 1800, loss: 0.9566, instance_loss: 0.1351, weighted_loss: 0.7101, label: 2, bag_size: 1374
batch 1900, loss: 2.2956, instance_loss: 0.1897, weighted_loss: 1.6638, label: 2, bag_size: 349
batch 2000, loss: 1.8952, instance_loss: 0.1939, weighted_loss: 1.3848, label: 5, bag_size: 368
batch 2100, loss: 1.6570, instance_loss: 0.2495, weighted_loss: 1.2348, label: 4, bag_size: 1301

Instance Classifier Stats
class 0 clustering acc 0.9983755760368663: correct 259977/260400
class 1 clustering acc 0.09879032258064516: correct 1715/17360

Epoch: 57, train_loss: 2.1361, train_clustering_loss: 0.1634, train_error: 0.4866
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6317135549872123, correct coarse 494/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.08560311284046693, correct coarse 22/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5899419729206963, correct fine 305/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.22608695652173913, correct fine 26/115 
fine class 5: fine acc 0.8949880668257757, correct fine 750/838 
fine class 6: fine acc 0.11646586345381527, correct fine 29/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1902, coarse auc: 0.7882, fine auc: 0.7792 
class 0 clustering acc 0.9986426767676768: correct 31637/31680 
class 1 clustering acc 0.13731060606060605: correct 290/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.4061
Fine Overall Accuracy: 0.5114
Fine Overall F1 Score: 0.1360

Training for coarse_and_fine level...
batch 100, loss: 2.2341, instance_loss: 0.1612, weighted_loss: 1.6122, label: 5, bag_size: 188
batch 200, loss: 0.8490, instance_loss: 0.1352, weighted_loss: 0.6349, label: 2, bag_size: 821
batch 300, loss: 2.5396, instance_loss: 0.2174, weighted_loss: 1.8430, label: 6, bag_size: 661
batch 400, loss: 0.8726, instance_loss: 0.1103, weighted_loss: 0.6439, label: 2, bag_size: 198
batch 500, loss: 1.0033, instance_loss: 0.1327, weighted_loss: 0.7421, label: 2, bag_size: 697
batch 600, loss: 1.0266, instance_loss: 0.1201, weighted_loss: 0.7547, label: 5, bag_size: 1222
batch 700, loss: 4.3517, instance_loss: 0.2547, weighted_loss: 3.1226, label: 4, bag_size: 758
batch 800, loss: 4.9515, instance_loss: 0.2932, weighted_loss: 3.5540, label: 7, bag_size: 528
batch 900, loss: 0.8613, instance_loss: 0.1309, weighted_loss: 0.6422, label: 2, bag_size: 483
batch 1000, loss: 3.0549, instance_loss: 0.1538, weighted_loss: 2.1846, label: 2, bag_size: 383
batch 1100, loss: 0.3221, instance_loss: 0.0873, weighted_loss: 0.2516, label: 5, bag_size: 622
batch 1200, loss: 1.9526, instance_loss: 0.2160, weighted_loss: 1.4316, label: 3, bag_size: 773
batch 1300, loss: 1.4847, instance_loss: 0.2137, weighted_loss: 1.1034, label: 6, bag_size: 422
batch 1400, loss: 3.0925, instance_loss: 0.2062, weighted_loss: 2.2266, label: 8, bag_size: 344
batch 1500, loss: 1.6279, instance_loss: 0.2497, weighted_loss: 1.2145, label: 4, bag_size: 1867
batch 1600, loss: 2.0488, instance_loss: 0.1669, weighted_loss: 1.4842, label: 2, bag_size: 1256
batch 1700, loss: 1.6320, instance_loss: 0.1242, weighted_loss: 1.1797, label: 5, bag_size: 588
batch 1800, loss: 2.2151, instance_loss: 0.2536, weighted_loss: 1.6266, label: 4, bag_size: 185
batch 1900, loss: 0.3906, instance_loss: 0.0762, weighted_loss: 0.2963, label: 5, bag_size: 1113
batch 2000, loss: 1.1475, instance_loss: 0.1253, weighted_loss: 0.8409, label: 5, bag_size: 543
batch 2100, loss: 1.6124, instance_loss: 0.1240, weighted_loss: 1.1659, label: 5, bag_size: 644

Instance Classifier Stats
class 0 clustering acc 0.9983141321044546: correct 259961/260400
class 1 clustering acc 0.10109447004608295: correct 1755/17360

Epoch: 58, train_loss: 2.1336, train_clustering_loss: 0.1631, train_error: 0.4862
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8702851885924563, correct coarse 946/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5996131528046421, correct fine 310/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.23478260869565218, correct fine 27/115 
fine class 5: fine acc 0.8902147971360382, correct fine 746/838 
fine class 6: fine acc 0.11244979919678715, correct fine 28/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Val Set, val_loss: 2.1873, coarse auc: 0.7888, fine auc: 0.7803 
class 0 clustering acc 0.9985795454545454: correct 31635/31680 
class 1 clustering acc 0.14299242424242425: correct 302/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Coarse Overall Accuracy: 0.6742
Coarse Overall F1 Score: 0.4073
Fine Overall Accuracy: 0.5152
Fine Overall F1 Score: 0.1364

Val error: 0.4735, ROC Coarse AUC: 0.7822
Val error: 0.4735, ROC Fine AUC: 0.7642
