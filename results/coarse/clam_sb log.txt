Preparing data...Training on 2170 samplesValidation on 264 samplesTest on 264 samples
Preparing model...DoneSetting optimizer...Done

Training for coarse level...batch 100, loss: 1.2735, instance_loss: 0.9971, weighted_loss: 1.1906, label: 1, bag_size: 1374batch 200, loss: 0.9842, instance_loss: 0.7529, weighted_loss: 0.9148, label: 2, bag_size: 138batch 300, loss: 1.0374, instance_loss: 0.7002, weighted_loss: 0.9362, label: 2, bag_size: 325batch 400, loss: 1.0570, instance_loss: 0.7008, weighted_loss: 0.9501, label: 1, bag_size: 454batch 500, loss: 1.9647, instance_loss: 0.7625, weighted_loss: 1.6040, label: 3, bag_size: 163batch 600, loss: 0.2848, instance_loss: 0.5297, weighted_loss: 0.3583, label: 2, bag_size: 274batch 700, loss: 2.5046, instance_loss: 0.7541, weighted_loss: 1.9794, label: 3, bag_size: 704batch 800, loss: 0.8181, instance_loss: 0.6373, weighted_loss: 0.7638, label: 1, bag_size: 618batch 900, loss: 0.3649, instance_loss: 0.4289, weighted_loss: 0.3841, label: 2, bag_size: 446batch 1000, loss: 0.8465, instance_loss: 0.5462, weighted_loss: 0.7564, label: 1, bag_size: 296batch 1100, loss: 1.6536, instance_loss: 0.7438, weighted_loss: 1.3807, label: 3, bag_size: 888batch 1200, loss: 0.1373, instance_loss: 0.2893, weighted_loss: 0.1829, label: 2, bag_size: 602batch 1300, loss: 0.2980, instance_loss: 0.2499, weighted_loss: 0.2836, label: 2, bag_size: 691batch 1400, loss: 1.2382, instance_loss: 0.6751, weighted_loss: 1.0693, label: 3, bag_size: 13batch 1500, loss: 0.1166, instance_loss: 0.2410, weighted_loss: 0.1539, label: 2, bag_size: 364batch 1600, loss: 0.5662, instance_loss: 0.2989, weighted_loss: 0.4860, label: 2, bag_size: 355batch 1700, loss: 1.1513, instance_loss: 0.7337, weighted_loss: 1.0260, label: 1, bag_size: 616batch 1800, loss: 0.1683, instance_loss: 0.3760, weighted_loss: 0.2306, label: 1, bag_size: 224batch 1900, loss: 1.7041, instance_loss: 0.6526, weighted_loss: 1.3886, label: 2, bag_size: 109batch 2000, loss: 0.3751, instance_loss: 0.3602, weighted_loss: 0.3707, label: 2, bag_size: 258batch 2100, loss: 0.6345, instance_loss: 0.3111, weighted_loss: 0.5375, label: 2, bag_size: 589Instance Classifier Statsclass 0 clustering acc 0.9841445852534563: correct 68339/69440class 1 clustering acc 0.07240783410138249: correct 1257/17360Epoch: 1, train_loss: 0.9359, train_clustering_loss:  0.5954, train_error: 0.4032class 0: acc 0.0, correct 0/44 class 1: acc 0.4373401534526854, correct 342/782 class 2: acc 0.8758049678012879, correct 952/1087 class 3: acc 0.0038910505836575876, correct 1/257 Overall Accuracy: 0.5968
Val Set, val_loss: 0.8242, auc: 0.7532 class 0 clustering acc 0.9886363636363636: correct 8352/8448 class 1 clustering acc 0.22537878787878787: correct 476/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.65625, correct 63/96 class 2: acc 0.8059701492537313, correct 108/134 class 3: acc 0.0, correct 0/30 Overall Accuracy: 0.6477Overall F1 Score: 0.3410Training for coarse level...batch 100, loss: 0.7295, instance_loss: 0.4767, weighted_loss: 0.6537, label: 1, bag_size: 202batch 200, loss: 1.3396, instance_loss: 0.7826, weighted_loss: 1.1725, label: 1, bag_size: 946batch 300, loss: 0.5936, instance_loss: 0.4677, weighted_loss: 0.5558, label: 1, bag_size: 837batch 400, loss: 1.1122, instance_loss: 0.5160, weighted_loss: 0.9333, label: 1, bag_size: 501batch 500, loss: 1.5617, instance_loss: 0.7581, weighted_loss: 1.3206, label: 1, bag_size: 190batch 600, loss: 0.9078, instance_loss: 0.4637, weighted_loss: 0.7746, label: 2, bag_size: 200batch 700, loss: 0.2738, instance_loss: 0.4035, weighted_loss: 0.3127, label: 1, bag_size: 584batch 800, loss: 1.3485, instance_loss: 0.9261, weighted_loss: 1.2218, label: 1, bag_size: 1168batch 900, loss: 0.0538, instance_loss: 0.1488, weighted_loss: 0.0823, label: 2, bag_size: 705batch 1000, loss: 0.1541, instance_loss: 0.2331, weighted_loss: 0.1778, label: 2, bag_size: 1048batch 1100, loss: 2.1309, instance_loss: 0.8688, weighted_loss: 1.7523, label: 3, bag_size: 751batch 1200, loss: 1.5638, instance_loss: 0.7532, weighted_loss: 1.3207, label: 2, bag_size: 764batch 1300, loss: 0.2819, instance_loss: 0.2417, weighted_loss: 0.2699, label: 1, bag_size: 1918batch 1400, loss: 0.5069, instance_loss: 0.2218, weighted_loss: 0.4214, label: 2, bag_size: 1716batch 1500, loss: 0.7143, instance_loss: 0.3260, weighted_loss: 0.5978, label: 2, bag_size: 670batch 1600, loss: 0.2065, instance_loss: 0.1019, weighted_loss: 0.1752, label: 1, bag_size: 1534batch 1700, loss: 1.0986, instance_loss: 1.0633, weighted_loss: 1.0880, label: 1, bag_size: 976batch 1800, loss: 0.1094, instance_loss: 0.1111, weighted_loss: 0.1099, label: 2, bag_size: 713batch 1900, loss: 0.7483, instance_loss: 0.5496, weighted_loss: 0.6887, label: 2, bag_size: 214batch 2000, loss: 1.1808, instance_loss: 0.7469, weighted_loss: 1.0506, label: 3, bag_size: 628batch 2100, loss: 0.0806, instance_loss: 0.1351, weighted_loss: 0.0969, label: 2, bag_size: 409Instance Classifier Statsclass 0 clustering acc 0.9841013824884792: correct 68336/69440class 1 clustering acc 0.32183179723502303: correct 5587/17360Epoch: 2, train_loss: 0.8204, train_clustering_loss:  0.4426, train_error: 0.3502class 0: acc 0.0, correct 0/44 class 1: acc 0.6342710997442456, correct 496/782 class 2: acc 0.8334866605335787, correct 906/1087 class 3: acc 0.0311284046692607, correct 8/257 Overall Accuracy: 0.6498
Val Set, val_loss: 0.7800, auc: 0.7805 class 0 clustering acc 0.9724195075757576: correct 8215/8448 class 1 clustering acc 0.42045454545454547: correct 888/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.59375, correct 57/96 class 2: acc 0.8880597014925373, correct 119/134 class 3: acc 0.03333333333333333, correct 1/30 Overall Accuracy: 0.6705Overall F1 Score: 0.3672Training for coarse level...batch 100, loss: 1.0743, instance_loss: 0.4724, weighted_loss: 0.8937, label: 1, bag_size: 637batch 200, loss: 0.7365, instance_loss: 0.4473, weighted_loss: 0.6497, label: 1, bag_size: 1628batch 300, loss: 0.3048, instance_loss: 0.3054, weighted_loss: 0.3050, label: 1, bag_size: 382batch 400, loss: 0.1803, instance_loss: 0.2676, weighted_loss: 0.2065, label: 1, bag_size: 2948batch 500, loss: 0.1413, instance_loss: 0.1181, weighted_loss: 0.1343, label: 2, bag_size: 857batch 600, loss: 1.4416, instance_loss: 0.6873, weighted_loss: 1.2153, label: 1, bag_size: 37batch 700, loss: 0.5433, instance_loss: 0.2654, weighted_loss: 0.4599, label: 2, bag_size: 243batch 800, loss: 1.0914, instance_loss: 0.6691, weighted_loss: 0.9647, label: 2, bag_size: 427batch 900, loss: 0.0762, instance_loss: 0.0868, weighted_loss: 0.0794, label: 1, bag_size: 2107batch 1000, loss: 0.9588, instance_loss: 0.4963, weighted_loss: 0.8201, label: 2, bag_size: 235batch 1100, loss: 0.9091, instance_loss: 0.5546, weighted_loss: 0.8027, label: 1, bag_size: 501batch 1200, loss: 0.7061, instance_loss: 0.4844, weighted_loss: 0.6396, label: 2, bag_size: 284batch 1300, loss: 0.0857, instance_loss: 0.1407, weighted_loss: 0.1022, label: 1, bag_size: 1561batch 1400, loss: 0.1252, instance_loss: 0.1676, weighted_loss: 0.1379, label: 2, bag_size: 1246batch 1500, loss: 0.4856, instance_loss: 0.5049, weighted_loss: 0.4914, label: 1, bag_size: 1659batch 1600, loss: 1.6487, instance_loss: 0.6844, weighted_loss: 1.3594, label: 3, bag_size: 168batch 1700, loss: 0.8850, instance_loss: 0.6865, weighted_loss: 0.8255, label: 1, bag_size: 332batch 1800, loss: 0.0317, instance_loss: 0.1126, weighted_loss: 0.0560, label: 2, bag_size: 439batch 1900, loss: 0.0849, instance_loss: 0.4157, weighted_loss: 0.1841, label: 2, bag_size: 346batch 2000, loss: 0.6826, instance_loss: 0.3702, weighted_loss: 0.5889, label: 2, bag_size: 292batch 2100, loss: 0.2912, instance_loss: 0.2996, weighted_loss: 0.2937, label: 1, bag_size: 589Instance Classifier Statsclass 0 clustering acc 0.9809331797235024: correct 68116/69440class 1 clustering acc 0.3863479262672811: correct 6707/17360Epoch: 3, train_loss: 0.7875, train_clustering_loss:  0.4239, train_error: 0.3419class 0: acc 0.0, correct 0/44 class 1: acc 0.6150895140664961, correct 481/782 class 2: acc 0.8546458141674333, correct 929/1087 class 3: acc 0.07003891050583658, correct 18/257 Overall Accuracy: 0.6581
Val Set, val_loss: 0.7660, auc: 0.7916 class 0 clustering acc 0.9758522727272727: correct 8244/8448 class 1 clustering acc 0.4275568181818182: correct 903/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.59375, correct 57/96 class 2: acc 0.8880597014925373, correct 119/134 class 3: acc 0.03333333333333333, correct 1/30 Overall Accuracy: 0.6705Overall F1 Score: 0.3672Training for coarse level...batch 100, loss: 0.4637, instance_loss: 0.2771, weighted_loss: 0.4077, label: 2, bag_size: 847batch 200, loss: 0.1008, instance_loss: 0.1201, weighted_loss: 0.1066, label: 1, bag_size: 983batch 300, loss: 0.1200, instance_loss: 0.1732, weighted_loss: 0.1360, label: 1, bag_size: 725batch 400, loss: 0.1795, instance_loss: 0.1764, weighted_loss: 0.1786, label: 2, bag_size: 358batch 500, loss: 1.2718, instance_loss: 0.6003, weighted_loss: 1.0704, label: 3, bag_size: 210batch 600, loss: 0.3058, instance_loss: 0.2575, weighted_loss: 0.2913, label: 1, bag_size: 663batch 700, loss: 0.0821, instance_loss: 0.1364, weighted_loss: 0.0984, label: 1, bag_size: 554batch 800, loss: 0.7469, instance_loss: 0.5209, weighted_loss: 0.6791, label: 2, bag_size: 284batch 900, loss: 0.4900, instance_loss: 0.1966, weighted_loss: 0.4020, label: 2, bag_size: 387batch 1000, loss: 0.1947, instance_loss: 0.1817, weighted_loss: 0.1908, label: 2, bag_size: 307batch 1100, loss: 0.0373, instance_loss: 0.0542, weighted_loss: 0.0424, label: 1, bag_size: 198batch 1200, loss: 1.0050, instance_loss: 0.5347, weighted_loss: 0.8639, label: 1, bag_size: 575batch 1300, loss: 0.2889, instance_loss: 0.2961, weighted_loss: 0.2911, label: 1, bag_size: 697batch 1400, loss: 0.9394, instance_loss: 0.7058, weighted_loss: 0.8693, label: 3, bag_size: 206batch 1500, loss: 1.6546, instance_loss: 0.8167, weighted_loss: 1.4032, label: 1, bag_size: 235batch 1600, loss: 0.4510, instance_loss: 0.3360, weighted_loss: 0.4165, label: 2, bag_size: 182batch 1700, loss: 1.1742, instance_loss: 0.5164, weighted_loss: 0.9769, label: 1, bag_size: 356batch 1800, loss: 0.8913, instance_loss: 0.5705, weighted_loss: 0.7951, label: 1, bag_size: 296batch 1900, loss: 0.2265, instance_loss: 0.2378, weighted_loss: 0.2299, label: 2, bag_size: 123batch 2000, loss: 0.2372, instance_loss: 0.2348, weighted_loss: 0.2365, label: 2, bag_size: 482batch 2100, loss: 0.4803, instance_loss: 0.2833, weighted_loss: 0.4212, label: 1, bag_size: 2830Instance Classifier Statsclass 0 clustering acc 0.9819844470046083: correct 68189/69440class 1 clustering acc 0.3975806451612903: correct 6902/17360Epoch: 4, train_loss: 0.7709, train_clustering_loss:  0.4160, train_error: 0.3359class 0: acc 0.0, correct 0/44 class 1: acc 0.6176470588235294, correct 483/782 class 2: acc 0.8656853725850966, correct 941/1087 class 3: acc 0.06614785992217899, correct 17/257 Overall Accuracy: 0.6641
Val Set, val_loss: 0.7648, auc: 0.7960 class 0 clustering acc 0.978811553030303: correct 8269/8448 class 1 clustering acc 0.4270833333333333: correct 902/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6875, correct 66/96 class 2: acc 0.8208955223880597, correct 110/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6818Overall F1 Score: 0.4140Training for coarse level...batch 100, loss: 0.8169, instance_loss: 0.3876, weighted_loss: 0.6881, label: 2, bag_size: 421batch 200, loss: 0.4817, instance_loss: 0.3588, weighted_loss: 0.4448, label: 1, bag_size: 807batch 300, loss: 0.0828, instance_loss: 0.0584, weighted_loss: 0.0755, label: 2, bag_size: 542batch 400, loss: 0.9364, instance_loss: 0.7282, weighted_loss: 0.8739, label: 1, bag_size: 976batch 500, loss: 0.2357, instance_loss: 0.1561, weighted_loss: 0.2118, label: 1, bag_size: 3892batch 600, loss: 0.0656, instance_loss: 0.0709, weighted_loss: 0.0672, label: 2, bag_size: 599batch 700, loss: 0.0901, instance_loss: 0.1023, weighted_loss: 0.0937, label: 2, bag_size: 324batch 800, loss: 0.2924, instance_loss: 0.2017, weighted_loss: 0.2652, label: 2, bag_size: 236batch 900, loss: 1.3905, instance_loss: 0.7219, weighted_loss: 1.1899, label: 3, bag_size: 543batch 1000, loss: 4.9325, instance_loss: 1.6645, weighted_loss: 3.9521, label: 1, bag_size: 477batch 1100, loss: 2.5975, instance_loss: 0.9010, weighted_loss: 2.0886, label: 2, bag_size: 75batch 1200, loss: 0.0719, instance_loss: 0.0474, weighted_loss: 0.0646, label: 1, bag_size: 2107batch 1300, loss: 1.5811, instance_loss: 0.6300, weighted_loss: 1.2958, label: 3, bag_size: 116batch 1400, loss: 1.5744, instance_loss: 0.7156, weighted_loss: 1.3168, label: 3, bag_size: 1196batch 1500, loss: 2.0216, instance_loss: 0.8394, weighted_loss: 1.6669, label: 3, bag_size: 558batch 1600, loss: 0.4583, instance_loss: 0.4267, weighted_loss: 0.4488, label: 2, bag_size: 296batch 1700, loss: 0.1337, instance_loss: 0.0895, weighted_loss: 0.1205, label: 2, bag_size: 1058batch 1800, loss: 0.0557, instance_loss: 0.0773, weighted_loss: 0.0622, label: 2, bag_size: 835batch 1900, loss: 0.2908, instance_loss: 0.1865, weighted_loss: 0.2595, label: 2, bag_size: 365batch 2000, loss: 0.7199, instance_loss: 0.5556, weighted_loss: 0.6706, label: 2, bag_size: 154batch 2100, loss: 0.2480, instance_loss: 0.2649, weighted_loss: 0.2531, label: 2, bag_size: 202Instance Classifier Statsclass 0 clustering acc 0.9825460829493088: correct 68228/69440class 1 clustering acc 0.4014400921658986: correct 6969/17360Epoch: 5, train_loss: 0.7626, train_clustering_loss:  0.4104, train_error: 0.3323class 0: acc 0.0, correct 0/44 class 1: acc 0.6214833759590793, correct 486/782 class 2: acc 0.858325666973321, correct 933/1087 class 3: acc 0.11673151750972763, correct 30/257 Overall Accuracy: 0.6677
Val Set, val_loss: 0.7497, auc: 0.7992 class 0 clustering acc 0.9781013257575758: correct 8263/8448 class 1 clustering acc 0.4393939393939394: correct 928/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.625, correct 60/96 class 2: acc 0.8582089552238806, correct 115/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6780Overall F1 Score: 0.4083Training for coarse level...batch 100, loss: 1.4834, instance_loss: 0.6546, weighted_loss: 1.2348, label: 3, bag_size: 426batch 200, loss: 0.8215, instance_loss: 0.3139, weighted_loss: 0.6692, label: 2, bag_size: 595batch 300, loss: 1.1546, instance_loss: 0.4978, weighted_loss: 0.9576, label: 2, bag_size: 224batch 400, loss: 0.0184, instance_loss: 0.0249, weighted_loss: 0.0204, label: 1, bag_size: 956batch 500, loss: 0.0273, instance_loss: 0.0293, weighted_loss: 0.0279, label: 2, bag_size: 1044batch 600, loss: 1.2988, instance_loss: 0.7489, weighted_loss: 1.1338, label: 3, bag_size: 253batch 700, loss: 1.3369, instance_loss: 0.8535, weighted_loss: 1.1919, label: 1, bag_size: 566batch 800, loss: 0.9197, instance_loss: 0.3990, weighted_loss: 0.7635, label: 2, bag_size: 431batch 900, loss: 0.0741, instance_loss: 0.1067, weighted_loss: 0.0839, label: 2, bag_size: 225batch 1000, loss: 0.0453, instance_loss: 0.0518, weighted_loss: 0.0472, label: 2, bag_size: 700batch 1100, loss: 0.6613, instance_loss: 0.3459, weighted_loss: 0.5667, label: 2, bag_size: 473batch 1200, loss: 0.1598, instance_loss: 0.1422, weighted_loss: 0.1545, label: 2, bag_size: 461batch 1300, loss: 0.5380, instance_loss: 0.4229, weighted_loss: 0.5035, label: 2, bag_size: 194batch 1400, loss: 1.5651, instance_loss: 0.9668, weighted_loss: 1.3856, label: 3, bag_size: 451batch 1500, loss: 0.1023, instance_loss: 0.0632, weighted_loss: 0.0905, label: 2, bag_size: 712batch 1600, loss: 0.5159, instance_loss: 0.4058, weighted_loss: 0.4828, label: 1, bag_size: 2019batch 1700, loss: 1.4063, instance_loss: 0.6168, weighted_loss: 1.1694, label: 1, bag_size: 851batch 1800, loss: 0.6197, instance_loss: 0.3828, weighted_loss: 0.5486, label: 1, bag_size: 574batch 1900, loss: 0.0930, instance_loss: 0.1099, weighted_loss: 0.0981, label: 2, bag_size: 475batch 2000, loss: 0.9347, instance_loss: 0.5712, weighted_loss: 0.8257, label: 2, bag_size: 132batch 2100, loss: 0.1042, instance_loss: 0.1650, weighted_loss: 0.1224, label: 2, bag_size: 473Instance Classifier Statsclass 0 clustering acc 0.9828197004608294: correct 68247/69440class 1 clustering acc 0.4064516129032258: correct 7056/17360Epoch: 6, train_loss: 0.7506, train_clustering_loss:  0.4046, train_error: 0.3253class 0: acc 0.0, correct 0/44 class 1: acc 0.6317135549872123, correct 494/782 class 2: acc 0.8629254829806807, correct 938/1087 class 3: acc 0.1245136186770428, correct 32/257 Overall Accuracy: 0.6747
Val Set, val_loss: 0.7505, auc: 0.7993 class 0 clustering acc 0.9778645833333334: correct 8261/8448 class 1 clustering acc 0.4441287878787879: correct 938/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.625, correct 60/96 class 2: acc 0.8880597014925373, correct 119/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6932Overall F1 Score: 0.4158Training for coarse level...batch 100, loss: 0.5036, instance_loss: 0.2455, weighted_loss: 0.4262, label: 2, bag_size: 408batch 200, loss: 1.3224, instance_loss: 0.5534, weighted_loss: 1.0917, label: 2, bag_size: 348batch 300, loss: 0.8747, instance_loss: 0.6142, weighted_loss: 0.7966, label: 1, bag_size: 421batch 400, loss: 0.0189, instance_loss: 0.0450, weighted_loss: 0.0267, label: 2, bag_size: 700batch 500, loss: 0.4141, instance_loss: 0.1839, weighted_loss: 0.3450, label: 2, bag_size: 333batch 600, loss: 0.1083, instance_loss: 0.0887, weighted_loss: 0.1024, label: 1, bag_size: 981batch 700, loss: 1.3458, instance_loss: 0.6292, weighted_loss: 1.1308, label: 1, bag_size: 341batch 800, loss: 0.0839, instance_loss: 0.4426, weighted_loss: 0.1915, label: 1, bag_size: 160batch 900, loss: 1.2015, instance_loss: 0.6445, weighted_loss: 1.0344, label: 1, bag_size: 471batch 1000, loss: 0.2284, instance_loss: 0.2640, weighted_loss: 0.2391, label: 2, bag_size: 202batch 1100, loss: 0.2046, instance_loss: 0.1739, weighted_loss: 0.1954, label: 2, bag_size: 541batch 1200, loss: 0.0834, instance_loss: 0.0760, weighted_loss: 0.0812, label: 1, bag_size: 2121batch 1300, loss: 0.0522, instance_loss: 0.0565, weighted_loss: 0.0535, label: 2, bag_size: 446batch 1400, loss: 0.9038, instance_loss: 0.5210, weighted_loss: 0.7890, label: 2, bag_size: 258batch 1500, loss: 0.0219, instance_loss: 0.0293, weighted_loss: 0.0241, label: 2, bag_size: 537batch 1600, loss: 0.1891, instance_loss: 0.1760, weighted_loss: 0.1852, label: 1, bag_size: 2214batch 1700, loss: 0.0251, instance_loss: 0.1135, weighted_loss: 0.0516, label: 2, bag_size: 439batch 1800, loss: 0.1247, instance_loss: 0.0424, weighted_loss: 0.1000, label: 2, bag_size: 712batch 1900, loss: 0.2646, instance_loss: 0.1027, weighted_loss: 0.2160, label: 2, bag_size: 1304batch 2000, loss: 0.0195, instance_loss: 0.0213, weighted_loss: 0.0201, label: 1, bag_size: 500batch 2100, loss: 0.1719, instance_loss: 0.1667, weighted_loss: 0.1703, label: 2, bag_size: 534Instance Classifier Statsclass 0 clustering acc 0.9829781105990784: correct 68258/69440class 1 clustering acc 0.410426267281106: correct 7125/17360Epoch: 7, train_loss: 0.7426, train_clustering_loss:  0.4017, train_error: 0.3198class 0: acc 0.0, correct 0/44 class 1: acc 0.6317135549872123, correct 494/782 class 2: acc 0.8712051517939282, correct 947/1087 class 3: acc 0.13618677042801555, correct 35/257 Overall Accuracy: 0.6802
Val Set, val_loss: 0.7511, auc: 0.7986 class 0 clustering acc 0.9810606060606061: correct 8288/8448 class 1 clustering acc 0.4303977272727273: correct 909/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6145833333333334, correct 59/96 class 2: acc 0.8059701492537313, correct 108/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6667Overall F1 Score: 0.4337Training for coarse level...batch 100, loss: 0.8789, instance_loss: 0.4328, weighted_loss: 0.7451, label: 2, bag_size: 266batch 200, loss: 0.0283, instance_loss: 0.0640, weighted_loss: 0.0390, label: 2, bag_size: 257batch 300, loss: 0.0970, instance_loss: 0.2302, weighted_loss: 0.1370, label: 1, bag_size: 1304batch 400, loss: 1.0480, instance_loss: 0.4770, weighted_loss: 0.8767, label: 2, bag_size: 472batch 500, loss: 1.0436, instance_loss: 0.5847, weighted_loss: 0.9059, label: 3, bag_size: 22batch 600, loss: 4.0140, instance_loss: 1.3037, weighted_loss: 3.2009, label: 3, bag_size: 94batch 700, loss: 2.4921, instance_loss: 0.8651, weighted_loss: 2.0040, label: 0, bag_size: 67batch 800, loss: 0.6848, instance_loss: 0.5184, weighted_loss: 0.6349, label: 1, bag_size: 1256batch 900, loss: 0.0890, instance_loss: 0.0997, weighted_loss: 0.0922, label: 2, bag_size: 618batch 1000, loss: 0.0401, instance_loss: 0.0496, weighted_loss: 0.0430, label: 2, bag_size: 403batch 1100, loss: 0.3904, instance_loss: 0.3432, weighted_loss: 0.3762, label: 1, bag_size: 729batch 1200, loss: 0.3367, instance_loss: 0.3428, weighted_loss: 0.3385, label: 1, bag_size: 483batch 1300, loss: 0.7521, instance_loss: 0.3423, weighted_loss: 0.6291, label: 2, bag_size: 1122batch 1400, loss: 0.7490, instance_loss: 0.6195, weighted_loss: 0.7102, label: 2, bag_size: 576batch 1500, loss: 0.6535, instance_loss: 0.4915, weighted_loss: 0.6049, label: 2, bag_size: 367batch 1600, loss: 0.5082, instance_loss: 0.4659, weighted_loss: 0.4955, label: 2, bag_size: 1865batch 1700, loss: 0.4059, instance_loss: 0.2766, weighted_loss: 0.3671, label: 2, bag_size: 308batch 1800, loss: 0.0579, instance_loss: 0.0618, weighted_loss: 0.0590, label: 2, bag_size: 252batch 1900, loss: 0.0229, instance_loss: 0.0351, weighted_loss: 0.0266, label: 2, bag_size: 686batch 2000, loss: 0.0300, instance_loss: 0.0453, weighted_loss: 0.0346, label: 1, bag_size: 1300batch 2100, loss: 0.0786, instance_loss: 0.1330, weighted_loss: 0.0949, label: 2, bag_size: 240Instance Classifier Statsclass 0 clustering acc 0.9830789170506913: correct 68265/69440class 1 clustering acc 0.4147465437788018: correct 7200/17360Epoch: 8, train_loss: 0.7307, train_clustering_loss:  0.3972, train_error: 0.3161class 0: acc 0.0, correct 0/44 class 1: acc 0.6470588235294118, correct 506/782 class 2: acc 0.8537258509659613, correct 928/1087 class 3: acc 0.19455252918287938, correct 50/257 Overall Accuracy: 0.6839
Val Set, val_loss: 0.7640, auc: 0.8010 class 0 clustering acc 0.9811789772727273: correct 8289/8448 class 1 clustering acc 0.4275568181818182: correct 903/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.7916666666666666, correct 76/96 class 2: acc 0.6791044776119403, correct 91/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6477Overall F1 Score: 0.3957Training for coarse level...batch 100, loss: 0.7063, instance_loss: 0.4912, weighted_loss: 0.6417, label: 1, bag_size: 356batch 200, loss: 1.5714, instance_loss: 0.7964, weighted_loss: 1.3389, label: 3, bag_size: 901batch 300, loss: 0.0230, instance_loss: 0.0296, weighted_loss: 0.0250, label: 1, bag_size: 989batch 400, loss: 0.2411, instance_loss: 0.1288, weighted_loss: 0.2074, label: 2, bag_size: 242batch 500, loss: 0.6170, instance_loss: 0.3363, weighted_loss: 0.5328, label: 2, bag_size: 216batch 600, loss: 1.8484, instance_loss: 0.8149, weighted_loss: 1.5383, label: 0, bag_size: 482batch 700, loss: 0.4566, instance_loss: 0.3808, weighted_loss: 0.4339, label: 2, bag_size: 304batch 800, loss: 0.8666, instance_loss: 0.4606, weighted_loss: 0.7448, label: 2, bag_size: 1830batch 900, loss: 1.0977, instance_loss: 0.7370, weighted_loss: 0.9895, label: 1, bag_size: 910batch 1000, loss: 1.4672, instance_loss: 0.6488, weighted_loss: 1.2216, label: 1, bag_size: 851batch 1100, loss: 1.0679, instance_loss: 0.4735, weighted_loss: 0.8896, label: 2, bag_size: 305batch 1200, loss: 0.1339, instance_loss: 0.1018, weighted_loss: 0.1243, label: 1, bag_size: 1365batch 1300, loss: 1.0461, instance_loss: 0.5063, weighted_loss: 0.8841, label: 2, bag_size: 160batch 1400, loss: 0.9839, instance_loss: 0.3746, weighted_loss: 0.8011, label: 2, bag_size: 291batch 1500, loss: 0.1567, instance_loss: 0.1190, weighted_loss: 0.1454, label: 1, bag_size: 298batch 1600, loss: 1.1371, instance_loss: 0.6682, weighted_loss: 0.9964, label: 1, bag_size: 454batch 1700, loss: 2.0404, instance_loss: 1.0214, weighted_loss: 1.7347, label: 3, bag_size: 278batch 1800, loss: 1.8932, instance_loss: 0.7715, weighted_loss: 1.5567, label: 0, bag_size: 220batch 1900, loss: 1.2728, instance_loss: 0.5561, weighted_loss: 1.0578, label: 2, bag_size: 718batch 2000, loss: 0.1991, instance_loss: 0.2842, weighted_loss: 0.2246, label: 2, bag_size: 200batch 2100, loss: 1.0325, instance_loss: 0.5184, weighted_loss: 0.8783, label: 2, bag_size: 72Instance Classifier Statsclass 0 clustering acc 0.9832229262672811: correct 68275/69440class 1 clustering acc 0.4144585253456221: correct 7195/17360Epoch: 9, train_loss: 0.7227, train_clustering_loss:  0.3961, train_error: 0.3157class 0: acc 0.022727272727272728, correct 1/44 class 1: acc 0.6649616368286445, correct 520/782 class 2: acc 0.8472861085556578, correct 921/1087 class 3: acc 0.16731517509727625, correct 43/257 Overall Accuracy: 0.6843
Val Set, val_loss: 0.7428, auc: 0.8040 class 0 clustering acc 0.9822443181818182: correct 8298/8448 class 1 clustering acc 0.4270833333333333: correct 902/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.59375, correct 57/96 class 2: acc 0.9029850746268657, correct 121/134 class 3: acc 0.1, correct 3/30 Overall Accuracy: 0.6856Overall F1 Score: 0.4006Training for coarse level...batch 100, loss: 0.7873, instance_loss: 0.4327, weighted_loss: 0.6810, label: 2, bag_size: 431batch 200, loss: 0.7484, instance_loss: 0.4517, weighted_loss: 0.6594, label: 2, bag_size: 124batch 300, loss: 0.7902, instance_loss: 0.4740, weighted_loss: 0.6953, label: 2, bag_size: 233batch 400, loss: 0.0424, instance_loss: 0.0776, weighted_loss: 0.0529, label: 2, bag_size: 193batch 500, loss: 1.4591, instance_loss: 0.6362, weighted_loss: 1.2123, label: 2, bag_size: 182batch 600, loss: 0.0240, instance_loss: 0.0216, weighted_loss: 0.0233, label: 1, bag_size: 447batch 700, loss: 0.8333, instance_loss: 0.5503, weighted_loss: 0.7484, label: 1, bag_size: 371batch 800, loss: 0.3954, instance_loss: 0.1663, weighted_loss: 0.3267, label: 2, bag_size: 1214batch 900, loss: 2.1355, instance_loss: 1.1473, weighted_loss: 1.8391, label: 3, bag_size: 1342batch 1000, loss: 0.0514, instance_loss: 0.1113, weighted_loss: 0.0694, label: 2, bag_size: 292batch 1100, loss: 0.0279, instance_loss: 0.0350, weighted_loss: 0.0300, label: 2, bag_size: 311batch 1200, loss: 0.7330, instance_loss: 0.5260, weighted_loss: 0.6709, label: 1, bag_size: 473batch 1300, loss: 0.5189, instance_loss: 0.2464, weighted_loss: 0.4371, label: 1, bag_size: 1404batch 1400, loss: 0.1574, instance_loss: 0.0965, weighted_loss: 0.1392, label: 1, bag_size: 1087batch 1500, loss: 0.3059, instance_loss: 0.2663, weighted_loss: 0.2940, label: 2, bag_size: 117batch 1600, loss: 1.3331, instance_loss: 0.6420, weighted_loss: 1.1258, label: 3, bag_size: 116batch 1700, loss: 0.1013, instance_loss: 0.0941, weighted_loss: 0.0991, label: 2, bag_size: 640batch 1800, loss: 0.7285, instance_loss: 0.4695, weighted_loss: 0.6508, label: 2, bag_size: 562batch 1900, loss: 0.3637, instance_loss: 0.1945, weighted_loss: 0.3129, label: 2, bag_size: 320batch 2000, loss: 1.0065, instance_loss: 0.4461, weighted_loss: 0.8384, label: 1, bag_size: 779batch 2100, loss: 0.1435, instance_loss: 0.1221, weighted_loss: 0.1371, label: 1, bag_size: 1781Instance Classifier Statsclass 0 clustering acc 0.9854838709677419: correct 68432/69440class 1 clustering acc 0.41278801843317975: correct 7166/17360Epoch: 10, train_loss: 0.7104, train_clustering_loss:  0.3899, train_error: 0.3115class 0: acc 0.022727272727272728, correct 1/44 class 1: acc 0.6662404092071611, correct 521/782 class 2: acc 0.8518859245630175, correct 926/1087 class 3: acc 0.17898832684824903, correct 46/257 Overall Accuracy: 0.6885
Val Set, val_loss: 0.7503, auc: 0.8001 class 0 clustering acc 0.9807054924242424: correct 8285/8448 class 1 clustering acc 0.4393939393939394: correct 928/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.625, correct 60/96 class 2: acc 0.8507462686567164, correct 114/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6742Overall F1 Score: 0.4037Training for coarse level...batch 100, loss: 0.6446, instance_loss: 0.4960, weighted_loss: 0.6000, label: 1, bag_size: 303batch 200, loss: 0.3185, instance_loss: 0.3028, weighted_loss: 0.3138, label: 2, bag_size: 113batch 300, loss: 0.3609, instance_loss: 0.2542, weighted_loss: 0.3289, label: 1, bag_size: 1174batch 400, loss: 0.2268, instance_loss: 0.2621, weighted_loss: 0.2374, label: 2, bag_size: 249batch 500, loss: 2.0990, instance_loss: 1.0154, weighted_loss: 1.7739, label: 3, bag_size: 462batch 600, loss: 1.2200, instance_loss: 0.6763, weighted_loss: 1.0569, label: 1, bag_size: 445batch 700, loss: 0.8271, instance_loss: 0.5986, weighted_loss: 0.7585, label: 3, bag_size: 338batch 800, loss: 1.6044, instance_loss: 0.6574, weighted_loss: 1.3203, label: 3, bag_size: 162batch 900, loss: 0.9940, instance_loss: 0.4647, weighted_loss: 0.8352, label: 2, bag_size: 193batch 1000, loss: 3.5652, instance_loss: 0.9117, weighted_loss: 2.7691, label: 0, bag_size: 260batch 1100, loss: 0.0721, instance_loss: 0.1130, weighted_loss: 0.0844, label: 1, bag_size: 309batch 1200, loss: 0.1453, instance_loss: 0.1080, weighted_loss: 0.1341, label: 2, bag_size: 330batch 1300, loss: 0.1105, instance_loss: 0.1337, weighted_loss: 0.1174, label: 2, bag_size: 434batch 1400, loss: 2.8936, instance_loss: 0.8496, weighted_loss: 2.2804, label: 0, bag_size: 451batch 1500, loss: 0.3927, instance_loss: 0.3471, weighted_loss: 0.3790, label: 2, bag_size: 689batch 1600, loss: 0.0147, instance_loss: 0.0183, weighted_loss: 0.0158, label: 1, bag_size: 687batch 1700, loss: 0.6047, instance_loss: 0.3735, weighted_loss: 0.5353, label: 2, bag_size: 546batch 1800, loss: 0.5599, instance_loss: 0.3122, weighted_loss: 0.4856, label: 2, bag_size: 492batch 1900, loss: 0.2331, instance_loss: 0.1007, weighted_loss: 0.1934, label: 1, bag_size: 1892batch 2000, loss: 0.2218, instance_loss: 0.1889, weighted_loss: 0.2120, label: 2, bag_size: 1364batch 2100, loss: 0.5470, instance_loss: 0.3987, weighted_loss: 0.5025, label: 2, bag_size: 299Instance Classifier Statsclass 0 clustering acc 0.9842885944700461: correct 68349/69440class 1 clustering acc 0.4167626728110599: correct 7235/17360Epoch: 11, train_loss: 0.7046, train_clustering_loss:  0.3889, train_error: 0.2908class 0: acc 0.09090909090909091, correct 4/44 class 1: acc 0.6790281329923273, correct 531/782 class 2: acc 0.8684452621895125, correct 944/1087 class 3: acc 0.23346303501945526, correct 60/257 Overall Accuracy: 0.7092
Val Set, val_loss: 0.7569, auc: 0.7957 class 0 clustering acc 0.9811789772727273: correct 8289/8448 class 1 clustering acc 0.4356060606060606: correct 920/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.7611940298507462, correct 102/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6477Overall F1 Score: 0.3899Training for coarse level...batch 100, loss: 0.6170, instance_loss: 0.4165, weighted_loss: 0.5569, label: 2, bag_size: 124batch 200, loss: 2.1204, instance_loss: 0.9974, weighted_loss: 1.7835, label: 3, bag_size: 599batch 300, loss: 0.3153, instance_loss: 0.3609, weighted_loss: 0.3290, label: 1, bag_size: 692batch 400, loss: 0.5468, instance_loss: 0.3437, weighted_loss: 0.4859, label: 1, bag_size: 2019batch 500, loss: 0.0892, instance_loss: 0.0824, weighted_loss: 0.0872, label: 1, bag_size: 207batch 600, loss: 1.2631, instance_loss: 0.6320, weighted_loss: 1.0737, label: 1, bag_size: 558batch 700, loss: 0.2269, instance_loss: 0.1620, weighted_loss: 0.2074, label: 1, bag_size: 270batch 800, loss: 0.1840, instance_loss: 0.1307, weighted_loss: 0.1680, label: 1, bag_size: 357batch 900, loss: 0.3472, instance_loss: 0.2573, weighted_loss: 0.3202, label: 2, bag_size: 600batch 1000, loss: 0.0447, instance_loss: 0.0456, weighted_loss: 0.0450, label: 1, bag_size: 217batch 1100, loss: 0.0705, instance_loss: 0.0435, weighted_loss: 0.0624, label: 2, bag_size: 1235batch 1200, loss: 0.8350, instance_loss: 0.4233, weighted_loss: 0.7115, label: 2, bag_size: 338batch 1300, loss: 0.2081, instance_loss: 0.1999, weighted_loss: 0.2056, label: 2, bag_size: 534batch 1400, loss: 0.0517, instance_loss: 0.0573, weighted_loss: 0.0533, label: 2, bag_size: 318batch 1500, loss: 0.0908, instance_loss: 0.0808, weighted_loss: 0.0878, label: 2, bag_size: 204batch 1600, loss: 1.5938, instance_loss: 0.8027, weighted_loss: 1.3565, label: 3, bag_size: 720batch 1700, loss: 0.1960, instance_loss: 0.1291, weighted_loss: 0.1760, label: 1, bag_size: 334batch 1800, loss: 0.2333, instance_loss: 0.2165, weighted_loss: 0.2283, label: 2, bag_size: 376batch 1900, loss: 2.5453, instance_loss: 1.0263, weighted_loss: 2.0896, label: 3, bag_size: 139batch 2000, loss: 0.0967, instance_loss: 0.2650, weighted_loss: 0.1472, label: 2, bag_size: 229batch 2100, loss: 0.6164, instance_loss: 0.3434, weighted_loss: 0.5345, label: 2, bag_size: 636Instance Classifier Statsclass 0 clustering acc 0.9846774193548387: correct 68376/69440class 1 clustering acc 0.4160714285714286: correct 7223/17360Epoch: 12, train_loss: 0.6919, train_clustering_loss:  0.3885, train_error: 0.2931class 0: acc 0.09090909090909091, correct 4/44 class 1: acc 0.690537084398977, correct 540/782 class 2: acc 0.8537258509659613, correct 928/1087 class 3: acc 0.24124513618677043, correct 62/257 Overall Accuracy: 0.7069
Val Set, val_loss: 0.7681, auc: 0.7946 class 0 clustering acc 0.9789299242424242: correct 8270/8448 class 1 clustering acc 0.4460227272727273: correct 942/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6458333333333334, correct 62/96 class 2: acc 0.7910447761194029, correct 106/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6515Overall F1 Score: 0.3914Training for coarse level...batch 100, loss: 0.5331, instance_loss: 0.5109, weighted_loss: 0.5265, label: 1, bag_size: 241batch 200, loss: 1.0146, instance_loss: 0.3875, weighted_loss: 0.8264, label: 2, bag_size: 291batch 300, loss: 0.9012, instance_loss: 0.6842, weighted_loss: 0.8361, label: 3, bag_size: 1555batch 400, loss: 0.9863, instance_loss: 0.5214, weighted_loss: 0.8468, label: 2, bag_size: 968batch 500, loss: 0.7170, instance_loss: 0.4563, weighted_loss: 0.6388, label: 2, bag_size: 367batch 600, loss: 1.6214, instance_loss: 0.8064, weighted_loss: 1.3769, label: 1, bag_size: 655batch 700, loss: 0.7227, instance_loss: 0.4869, weighted_loss: 0.6520, label: 2, bag_size: 206batch 800, loss: 0.0702, instance_loss: 0.0278, weighted_loss: 0.0575, label: 1, bag_size: 1445batch 900, loss: 0.0691, instance_loss: 0.0557, weighted_loss: 0.0651, label: 1, bag_size: 909batch 1000, loss: 0.2320, instance_loss: 0.3860, weighted_loss: 0.2782, label: 2, bag_size: 473batch 1100, loss: 0.2554, instance_loss: 0.2113, weighted_loss: 0.2422, label: 2, bag_size: 1736batch 1200, loss: 1.1744, instance_loss: 0.6087, weighted_loss: 1.0047, label: 1, bag_size: 347batch 1300, loss: 0.6954, instance_loss: 0.5796, weighted_loss: 0.6607, label: 3, bag_size: 338batch 1400, loss: 0.1810, instance_loss: 0.0596, weighted_loss: 0.1446, label: 1, bag_size: 410batch 1500, loss: 0.0898, instance_loss: 0.0915, weighted_loss: 0.0903, label: 2, bag_size: 618batch 1600, loss: 0.5244, instance_loss: 0.5764, weighted_loss: 0.5400, label: 3, bag_size: 229batch 1700, loss: 0.8807, instance_loss: 0.5937, weighted_loss: 0.7946, label: 1, bag_size: 172batch 1800, loss: 0.3472, instance_loss: 0.5030, weighted_loss: 0.3940, label: 1, bag_size: 1860batch 1900, loss: 2.1149, instance_loss: 0.8517, weighted_loss: 1.7360, label: 3, bag_size: 205batch 2000, loss: 0.0484, instance_loss: 0.0970, weighted_loss: 0.0630, label: 2, bag_size: 358batch 2100, loss: 0.8845, instance_loss: 0.3205, weighted_loss: 0.7153, label: 2, bag_size: 654Instance Classifier Statsclass 0 clustering acc 0.9841445852534563: correct 68339/69440class 1 clustering acc 0.4212557603686636: correct 7313/17360Epoch: 13, train_loss: 0.6812, train_clustering_loss:  0.3853, train_error: 0.2857class 0: acc 0.13636363636363635, correct 6/44 class 1: acc 0.6930946291560103, correct 542/782 class 2: acc 0.8546458141674333, correct 929/1087 class 3: acc 0.2840466926070039, correct 73/257 Overall Accuracy: 0.7143
Val Set, val_loss: 0.7534, auc: 0.8007 class 0 clustering acc 0.9820075757575758: correct 8296/8448 class 1 clustering acc 0.4346590909090909: correct 918/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6458333333333334, correct 62/96 class 2: acc 0.8059701492537313, correct 108/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6591Overall F1 Score: 0.3957Training for coarse level...batch 100, loss: 0.2892, instance_loss: 0.3181, weighted_loss: 0.2979, label: 2, bag_size: 216batch 200, loss: 0.8930, instance_loss: 0.4730, weighted_loss: 0.7670, label: 2, bag_size: 463batch 300, loss: 0.4487, instance_loss: 0.2470, weighted_loss: 0.3882, label: 2, bag_size: 523batch 400, loss: 0.5909, instance_loss: 0.4468, weighted_loss: 0.5477, label: 2, bag_size: 290batch 500, loss: 1.5568, instance_loss: 0.6097, weighted_loss: 1.2727, label: 1, bag_size: 298batch 600, loss: 1.9982, instance_loss: 0.9432, weighted_loss: 1.6817, label: 0, bag_size: 68batch 700, loss: 0.0760, instance_loss: 0.1292, weighted_loss: 0.0919, label: 1, bag_size: 504batch 800, loss: 1.2120, instance_loss: 0.7255, weighted_loss: 1.0661, label: 3, bag_size: 681batch 900, loss: 0.2617, instance_loss: 0.4041, weighted_loss: 0.3044, label: 2, bag_size: 296batch 1000, loss: 0.2705, instance_loss: 0.2897, weighted_loss: 0.2763, label: 1, bag_size: 1700batch 1100, loss: 0.4796, instance_loss: 0.4552, weighted_loss: 0.4723, label: 1, bag_size: 976batch 1200, loss: 1.3563, instance_loss: 0.8886, weighted_loss: 1.2160, label: 2, bag_size: 1206batch 1300, loss: 0.0250, instance_loss: 0.0257, weighted_loss: 0.0252, label: 2, bag_size: 329batch 1400, loss: 0.0389, instance_loss: 0.0348, weighted_loss: 0.0376, label: 2, bag_size: 403batch 1500, loss: 0.0254, instance_loss: 0.0436, weighted_loss: 0.0309, label: 1, bag_size: 873batch 1600, loss: 1.6618, instance_loss: 0.5838, weighted_loss: 1.3384, label: 2, bag_size: 228batch 1700, loss: 0.0536, instance_loss: 0.0865, weighted_loss: 0.0635, label: 2, bag_size: 2141batch 1800, loss: 0.9216, instance_loss: 0.4398, weighted_loss: 0.7771, label: 2, bag_size: 595batch 1900, loss: 1.0787, instance_loss: 0.5083, weighted_loss: 0.9076, label: 2, bag_size: 259batch 2000, loss: 0.1315, instance_loss: 0.1769, weighted_loss: 0.1451, label: 1, bag_size: 185batch 2100, loss: 0.0660, instance_loss: 0.0913, weighted_loss: 0.0736, label: 2, bag_size: 544Instance Classifier Statsclass 0 clustering acc 0.9847926267281106: correct 68384/69440class 1 clustering acc 0.42119815668202765: correct 7312/17360Epoch: 14, train_loss: 0.6693, train_clustering_loss:  0.3838, train_error: 0.2728class 0: acc 0.13636363636363635, correct 6/44 class 1: acc 0.7084398976982097, correct 554/782 class 2: acc 0.8693652253909844, correct 945/1087 class 3: acc 0.2840466926070039, correct 73/257 Overall Accuracy: 0.7272
Val Set, val_loss: 0.7601, auc: 0.7964 class 0 clustering acc 0.9822443181818182: correct 8298/8448 class 1 clustering acc 0.43323863636363635: correct 915/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6666666666666666, correct 64/96 class 2: acc 0.7686567164179104, correct 103/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6477Overall F1 Score: 0.3900Training for coarse level...batch 100, loss: 0.0113, instance_loss: 0.0120, weighted_loss: 0.0115, label: 1, bag_size: 723batch 200, loss: 3.9901, instance_loss: 1.0683, weighted_loss: 3.1135, label: 0, bag_size: 505batch 300, loss: 1.6927, instance_loss: 0.8761, weighted_loss: 1.4478, label: 3, bag_size: 751batch 400, loss: 0.0399, instance_loss: 0.0514, weighted_loss: 0.0433, label: 1, bag_size: 214batch 500, loss: 1.6689, instance_loss: 0.7938, weighted_loss: 1.4063, label: 3, bag_size: 415batch 600, loss: 1.8118, instance_loss: 0.5845, weighted_loss: 1.4436, label: 1, bag_size: 179batch 700, loss: 0.5472, instance_loss: 0.4111, weighted_loss: 0.5064, label: 2, bag_size: 401batch 800, loss: 0.0738, instance_loss: 0.0832, weighted_loss: 0.0766, label: 2, bag_size: 2032batch 900, loss: 0.1187, instance_loss: 0.1537, weighted_loss: 0.1292, label: 2, bag_size: 379batch 1000, loss: 1.3197, instance_loss: 1.1468, weighted_loss: 1.2678, label: 3, bag_size: 1800batch 1100, loss: 0.0492, instance_loss: 0.1311, weighted_loss: 0.0738, label: 2, bag_size: 291batch 1200, loss: 0.1046, instance_loss: 0.0888, weighted_loss: 0.0999, label: 2, bag_size: 1005batch 1300, loss: 1.2198, instance_loss: 0.9213, weighted_loss: 1.1303, label: 1, bag_size: 621batch 1400, loss: 0.9160, instance_loss: 0.6433, weighted_loss: 0.8342, label: 3, bag_size: 151batch 1500, loss: 0.1631, instance_loss: 0.1490, weighted_loss: 0.1589, label: 1, bag_size: 526batch 1600, loss: 0.5954, instance_loss: 0.7130, weighted_loss: 0.6307, label: 0, bag_size: 235batch 1700, loss: 0.0304, instance_loss: 0.0368, weighted_loss: 0.0323, label: 1, bag_size: 618batch 1800, loss: 0.0622, instance_loss: 0.0280, weighted_loss: 0.0519, label: 1, bag_size: 2239batch 1900, loss: 0.0372, instance_loss: 0.2473, weighted_loss: 0.1003, label: 2, bag_size: 307batch 2000, loss: 0.0653, instance_loss: 0.0205, weighted_loss: 0.0518, label: 1, bag_size: 1181batch 2100, loss: 0.1972, instance_loss: 0.1723, weighted_loss: 0.1897, label: 1, bag_size: 1323Instance Classifier Statsclass 0 clustering acc 0.9850662442396313: correct 68403/69440class 1 clustering acc 0.419815668202765: correct 7288/17360Epoch: 15, train_loss: 0.6530, train_clustering_loss:  0.3831, train_error: 0.2737class 0: acc 0.18181818181818182, correct 8/44 class 1: acc 0.710997442455243, correct 556/782 class 2: acc 0.8638454461821528, correct 939/1087 class 3: acc 0.2840466926070039, correct 73/257 Overall Accuracy: 0.7263
Val Set, val_loss: 0.7565, auc: 0.7958 class 0 clustering acc 0.9805871212121212: correct 8284/8448 class 1 clustering acc 0.4474431818181818: correct 945/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6354166666666666, correct 61/96 class 2: acc 0.835820895522388, correct 112/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6705Overall F1 Score: 0.4028Training for coarse level...batch 100, loss: 1.1435, instance_loss: 0.8930, weighted_loss: 1.0684, label: 1, bag_size: 559batch 200, loss: 0.8990, instance_loss: 0.6204, weighted_loss: 0.8154, label: 1, bag_size: 1168batch 300, loss: 0.0579, instance_loss: 0.1234, weighted_loss: 0.0776, label: 1, bag_size: 334batch 400, loss: 0.0845, instance_loss: 0.1113, weighted_loss: 0.0925, label: 2, bag_size: 379batch 500, loss: 0.0146, instance_loss: 0.0266, weighted_loss: 0.0182, label: 2, bag_size: 288batch 600, loss: 1.0524, instance_loss: 0.3853, weighted_loss: 0.8523, label: 2, bag_size: 421batch 700, loss: 2.9997, instance_loss: 1.4006, weighted_loss: 2.5200, label: 3, bag_size: 289batch 800, loss: 0.7554, instance_loss: 0.4790, weighted_loss: 0.6725, label: 2, bag_size: 416batch 900, loss: 0.0090, instance_loss: 0.0263, weighted_loss: 0.0142, label: 2, bag_size: 249batch 1000, loss: 0.6596, instance_loss: 0.4526, weighted_loss: 0.5975, label: 2, bag_size: 1897batch 1100, loss: 0.0129, instance_loss: 0.0481, weighted_loss: 0.0235, label: 2, bag_size: 393batch 1200, loss: 3.1735, instance_loss: 1.8200, weighted_loss: 2.7674, label: 3, bag_size: 981batch 1300, loss: 0.0115, instance_loss: 0.0240, weighted_loss: 0.0152, label: 2, bag_size: 651batch 1400, loss: 0.5223, instance_loss: 0.8217, weighted_loss: 0.6121, label: 3, bag_size: 1274batch 1500, loss: 0.0462, instance_loss: 0.0276, weighted_loss: 0.0406, label: 1, bag_size: 623batch 1600, loss: 0.8642, instance_loss: 0.6319, weighted_loss: 0.7945, label: 1, bag_size: 65batch 1700, loss: 2.8370, instance_loss: 1.7306, weighted_loss: 2.5051, label: 2, bag_size: 3052batch 1800, loss: 0.2249, instance_loss: 0.2887, weighted_loss: 0.2441, label: 1, bag_size: 430batch 1900, loss: 0.0973, instance_loss: 0.0534, weighted_loss: 0.0841, label: 1, bag_size: 1090batch 2000, loss: 0.1249, instance_loss: 0.1632, weighted_loss: 0.1364, label: 1, bag_size: 1120batch 2100, loss: 1.3714, instance_loss: 0.7586, weighted_loss: 1.1875, label: 1, bag_size: 983Instance Classifier Statsclass 0 clustering acc 0.9848790322580645: correct 68390/69440class 1 clustering acc 0.42891705069124425: correct 7446/17360Epoch: 16, train_loss: 0.6319, train_clustering_loss:  0.3779, train_error: 0.2641class 0: acc 0.20454545454545456, correct 9/44 class 1: acc 0.7250639386189258, correct 567/782 class 2: acc 0.8629254829806807, correct 938/1087 class 3: acc 0.3229571984435798, correct 83/257 Overall Accuracy: 0.7359
Val Set, val_loss: 0.7523, auc: 0.7965 class 0 clustering acc 0.982717803030303: correct 8302/8448 class 1 clustering acc 0.4337121212121212: correct 916/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.835820895522388, correct 112/134 class 3: acc 0.1, correct 3/30 Overall Accuracy: 0.6818Overall F1 Score: 0.4000Training for coarse level...batch 100, loss: 0.0428, instance_loss: 0.0468, weighted_loss: 0.0440, label: 2, bag_size: 239batch 200, loss: 0.1310, instance_loss: 0.1111, weighted_loss: 0.1251, label: 1, bag_size: 1767batch 300, loss: 0.0823, instance_loss: 0.0765, weighted_loss: 0.0806, label: 2, bag_size: 369batch 400, loss: 2.3306, instance_loss: 0.8397, weighted_loss: 1.8833, label: 3, bag_size: 558batch 500, loss: 0.2349, instance_loss: 0.1524, weighted_loss: 0.2102, label: 1, bag_size: 643batch 600, loss: 0.0785, instance_loss: 0.1116, weighted_loss: 0.0885, label: 2, bag_size: 629batch 700, loss: 1.5803, instance_loss: 0.7220, weighted_loss: 1.3228, label: 3, bag_size: 748batch 800, loss: 0.1093, instance_loss: 0.1527, weighted_loss: 0.1224, label: 1, bag_size: 177batch 900, loss: 0.0665, instance_loss: 0.0706, weighted_loss: 0.0678, label: 2, bag_size: 506batch 1000, loss: 0.7277, instance_loss: 0.5343, weighted_loss: 0.6697, label: 3, bag_size: 312batch 1100, loss: 1.7902, instance_loss: 0.6932, weighted_loss: 1.4611, label: 3, bag_size: 435batch 1200, loss: 0.0249, instance_loss: 0.0287, weighted_loss: 0.0261, label: 2, bag_size: 987batch 1300, loss: 0.1507, instance_loss: 0.1582, weighted_loss: 0.1530, label: 2, bag_size: 461batch 1400, loss: 0.3575, instance_loss: 0.3083, weighted_loss: 0.3428, label: 2, bag_size: 735batch 1500, loss: 1.0079, instance_loss: 0.4393, weighted_loss: 0.8373, label: 2, bag_size: 667batch 1600, loss: 0.2246, instance_loss: 0.1316, weighted_loss: 0.1967, label: 2, bag_size: 849batch 1700, loss: 0.0206, instance_loss: 0.0358, weighted_loss: 0.0252, label: 2, bag_size: 645batch 1800, loss: 0.0046, instance_loss: 0.0251, weighted_loss: 0.0108, label: 2, bag_size: 460batch 1900, loss: 0.5605, instance_loss: 0.5104, weighted_loss: 0.5455, label: 2, bag_size: 112batch 2000, loss: 0.0163, instance_loss: 0.0174, weighted_loss: 0.0166, label: 1, bag_size: 723batch 2100, loss: 0.0773, instance_loss: 0.1750, weighted_loss: 0.1066, label: 2, bag_size: 888Instance Classifier Statsclass 0 clustering acc 0.984403801843318: correct 68357/69440class 1 clustering acc 0.4247695852534562: correct 7374/17360Epoch: 17, train_loss: 0.6227, train_clustering_loss:  0.3786, train_error: 0.2530class 0: acc 0.20454545454545456, correct 9/44 class 1: acc 0.7404092071611253, correct 579/782 class 2: acc 0.8638454461821528, correct 939/1087 class 3: acc 0.3657587548638132, correct 94/257 Overall Accuracy: 0.7470
Val Set, val_loss: 0.7661, auc: 0.7888 class 0 clustering acc 0.98046875: correct 8283/8448 class 1 clustering acc 0.4498106060606061: correct 950/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.59375, correct 57/96 class 2: acc 0.8507462686567164, correct 114/134 class 3: acc 0.1, correct 3/30 Overall Accuracy: 0.6591Overall F1 Score: 0.3856Training for coarse level...batch 100, loss: 0.2726, instance_loss: 0.3069, weighted_loss: 0.2829, label: 2, bag_size: 361batch 200, loss: 0.5181, instance_loss: 0.2410, weighted_loss: 0.4350, label: 1, bag_size: 691batch 300, loss: 0.7514, instance_loss: 0.6175, weighted_loss: 0.7112, label: 2, bag_size: 1853batch 400, loss: 0.2287, instance_loss: 0.3124, weighted_loss: 0.2538, label: 2, bag_size: 2114batch 500, loss: 0.2289, instance_loss: 0.3766, weighted_loss: 0.2732, label: 1, bag_size: 1049batch 600, loss: 0.0384, instance_loss: 0.0264, weighted_loss: 0.0348, label: 2, bag_size: 859batch 700, loss: 0.5378, instance_loss: 0.4326, weighted_loss: 0.5063, label: 2, bag_size: 258batch 800, loss: 0.1397, instance_loss: 0.1328, weighted_loss: 0.1376, label: 2, bag_size: 542batch 900, loss: 0.5814, instance_loss: 0.4096, weighted_loss: 0.5298, label: 2, bag_size: 338batch 1000, loss: 0.4843, instance_loss: 0.5230, weighted_loss: 0.4959, label: 2, bag_size: 405batch 1100, loss: 0.7490, instance_loss: 0.4332, weighted_loss: 0.6542, label: 2, bag_size: 608batch 1200, loss: 0.0122, instance_loss: 0.0535, weighted_loss: 0.0246, label: 2, bag_size: 827batch 1300, loss: 0.0399, instance_loss: 0.0308, weighted_loss: 0.0372, label: 2, bag_size: 255batch 1400, loss: 1.0304, instance_loss: 0.3812, weighted_loss: 0.8357, label: 2, bag_size: 833batch 1500, loss: 0.6499, instance_loss: 0.5756, weighted_loss: 0.6276, label: 3, bag_size: 212batch 1600, loss: 0.7887, instance_loss: 0.3508, weighted_loss: 0.6574, label: 2, bag_size: 317batch 1700, loss: 0.4227, instance_loss: 0.2826, weighted_loss: 0.3807, label: 2, bag_size: 597batch 1800, loss: 0.4422, instance_loss: 0.4566, weighted_loss: 0.4465, label: 1, bag_size: 374batch 1900, loss: 0.6057, instance_loss: 0.3706, weighted_loss: 0.5352, label: 2, bag_size: 314batch 2000, loss: 0.2362, instance_loss: 0.1201, weighted_loss: 0.2014, label: 2, bag_size: 1214batch 2100, loss: 2.6222, instance_loss: 1.2430, weighted_loss: 2.2084, label: 1, bag_size: 559Instance Classifier Statsclass 0 clustering acc 0.9850806451612903: correct 68404/69440class 1 clustering acc 0.4261520737327189: correct 7398/17360Epoch: 18, train_loss: 0.6045, train_clustering_loss:  0.3765, train_error: 0.2442class 0: acc 0.25, correct 11/44 class 1: acc 0.7442455242966752, correct 582/782 class 2: acc 0.8776448942042319, correct 954/1087 class 3: acc 0.36186770428015563, correct 93/257 Overall Accuracy: 0.7558
Val Set, val_loss: 0.7911, auc: 0.7803 class 0 clustering acc 0.9820075757575758: correct 8296/8448 class 1 clustering acc 0.4322916666666667: correct 913/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.7395833333333334, correct 71/96 class 2: acc 0.7686567164179104, correct 103/134 class 3: acc 0.06666666666666667, correct 2/30 Overall Accuracy: 0.6667Overall F1 Score: 0.3825Training for coarse level...batch 100, loss: 0.0060, instance_loss: 0.1636, weighted_loss: 0.0533, label: 2, bag_size: 83batch 200, loss: 0.0131, instance_loss: 0.0740, weighted_loss: 0.0314, label: 2, bag_size: 439batch 300, loss: 0.4368, instance_loss: 0.5950, weighted_loss: 0.4842, label: 1, bag_size: 334batch 400, loss: 0.5609, instance_loss: 0.4399, weighted_loss: 0.5246, label: 2, bag_size: 124batch 500, loss: 2.1642, instance_loss: 0.6619, weighted_loss: 1.7135, label: 1, bag_size: 185batch 600, loss: 0.5769, instance_loss: 0.4270, weighted_loss: 0.5319, label: 2, bag_size: 202batch 700, loss: 0.5131, instance_loss: 0.6008, weighted_loss: 0.5394, label: 2, bag_size: 464batch 800, loss: 0.5129, instance_loss: 0.3858, weighted_loss: 0.4748, label: 2, bag_size: 206batch 900, loss: 0.0489, instance_loss: 0.0420, weighted_loss: 0.0468, label: 2, bag_size: 834batch 1000, loss: 0.0276, instance_loss: 0.0436, weighted_loss: 0.0324, label: 2, bag_size: 1330batch 1100, loss: 0.1482, instance_loss: 0.1184, weighted_loss: 0.1393, label: 1, bag_size: 1150batch 1200, loss: 0.0191, instance_loss: 0.0337, weighted_loss: 0.0235, label: 2, bag_size: 679batch 1300, loss: 0.4033, instance_loss: 0.3785, weighted_loss: 0.3958, label: 1, bag_size: 258batch 1400, loss: 0.1166, instance_loss: 0.0933, weighted_loss: 0.1096, label: 1, bag_size: 762batch 1500, loss: 0.1607, instance_loss: 0.1964, weighted_loss: 0.1714, label: 1, bag_size: 128batch 1600, loss: 0.5656, instance_loss: 0.4860, weighted_loss: 0.5417, label: 2, bag_size: 1506batch 1700, loss: 0.6336, instance_loss: 0.5965, weighted_loss: 0.6225, label: 1, bag_size: 471batch 1800, loss: 1.1142, instance_loss: 1.1406, weighted_loss: 1.1221, label: 2, bag_size: 585batch 1900, loss: 0.0486, instance_loss: 0.0785, weighted_loss: 0.0575, label: 2, bag_size: 1023batch 2000, loss: 0.0367, instance_loss: 0.0552, weighted_loss: 0.0422, label: 2, bag_size: 732batch 2100, loss: 1.6624, instance_loss: 0.6148, weighted_loss: 1.3481, label: 2, bag_size: 387Instance Classifier Statsclass 0 clustering acc 0.9844614055299539: correct 68361/69440class 1 clustering acc 0.43289170506912444: correct 7515/17360Epoch: 19, train_loss: 0.5900, train_clustering_loss:  0.3747, train_error: 0.2327class 0: acc 0.2727272727272727, correct 12/44 class 1: acc 0.7634271099744245, correct 597/782 class 2: acc 0.8850045998160073, correct 962/1087 class 3: acc 0.3657587548638132, correct 94/257 Overall Accuracy: 0.7673
Val Set, val_loss: 0.7741, auc: 0.7769 class 0 clustering acc 0.9820075757575758: correct 8296/8448 class 1 clustering acc 0.43986742424242425: correct 929/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6458333333333334, correct 62/96 class 2: acc 0.835820895522388, correct 112/134 class 3: acc 0.13333333333333333, correct 4/30 Overall Accuracy: 0.6742Overall F1 Score: 0.4037Training for coarse level...batch 100, loss: 1.3027, instance_loss: 0.7534, weighted_loss: 1.1379, label: 0, bag_size: 320batch 200, loss: 3.5499, instance_loss: 1.0217, weighted_loss: 2.7915, label: 0, bag_size: 439batch 300, loss: 0.3284, instance_loss: 0.3538, weighted_loss: 0.3361, label: 2, bag_size: 641batch 400, loss: 0.0260, instance_loss: 0.1221, weighted_loss: 0.0548, label: 2, bag_size: 244batch 500, loss: 0.6125, instance_loss: 0.3604, weighted_loss: 0.5369, label: 2, bag_size: 266batch 600, loss: 1.3483, instance_loss: 0.5646, weighted_loss: 1.1132, label: 2, bag_size: 182batch 700, loss: 0.0289, instance_loss: 0.1701, weighted_loss: 0.0713, label: 2, bag_size: 307batch 800, loss: 3.1949, instance_loss: 1.0882, weighted_loss: 2.5629, label: 1, bag_size: 510batch 900, loss: 0.1493, instance_loss: 0.0631, weighted_loss: 0.1234, label: 1, bag_size: 1947batch 1000, loss: 1.3595, instance_loss: 0.4187, weighted_loss: 1.0773, label: 2, bag_size: 231batch 1100, loss: 1.2565, instance_loss: 0.6254, weighted_loss: 1.0672, label: 3, bag_size: 565batch 1200, loss: 0.4916, instance_loss: 0.4008, weighted_loss: 0.4643, label: 2, bag_size: 206batch 1300, loss: 0.7769, instance_loss: 0.4518, weighted_loss: 0.6794, label: 2, bag_size: 599batch 1400, loss: 1.1914, instance_loss: 0.7426, weighted_loss: 1.0568, label: 0, bag_size: 388batch 1500, loss: 0.0094, instance_loss: 0.0669, weighted_loss: 0.0267, label: 2, bag_size: 1096batch 1600, loss: 0.0504, instance_loss: 0.0182, weighted_loss: 0.0408, label: 1, bag_size: 305batch 1700, loss: 0.0208, instance_loss: 0.0128, weighted_loss: 0.0184, label: 1, bag_size: 1883batch 1800, loss: 0.5642, instance_loss: 0.5506, weighted_loss: 0.5601, label: 1, bag_size: 637batch 1900, loss: 0.0166, instance_loss: 0.0693, weighted_loss: 0.0324, label: 2, bag_size: 336batch 2000, loss: 0.1023, instance_loss: 0.0664, weighted_loss: 0.0916, label: 1, bag_size: 762batch 2100, loss: 0.1946, instance_loss: 0.3522, weighted_loss: 0.2418, label: 1, bag_size: 641Instance Classifier Statsclass 0 clustering acc 0.9851526497695853: correct 68409/69440class 1 clustering acc 0.4314516129032258: correct 7490/17360Epoch: 20, train_loss: 0.5723, train_clustering_loss:  0.3721, train_error: 0.2194class 0: acc 0.29545454545454547, correct 13/44 class 1: acc 0.7800511508951407, correct 610/782 class 2: acc 0.889604415823367, correct 967/1087 class 3: acc 0.4046692607003891, correct 104/257 Overall Accuracy: 0.7806
Val Set, val_loss: 0.8076, auc: 0.7715 class 0 clustering acc 0.9812973484848485: correct 8290/8448 class 1 clustering acc 0.4356060606060606: correct 920/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.7238805970149254, correct 97/134 class 3: acc 0.16666666666666666, correct 5/30 Overall Accuracy: 0.6326Overall F1 Score: 0.3898Training for coarse level...batch 100, loss: 0.1296, instance_loss: 0.0779, weighted_loss: 0.1141, label: 1, bag_size: 457batch 200, loss: 0.0871, instance_loss: 0.0769, weighted_loss: 0.0840, label: 2, bag_size: 703batch 300, loss: 0.8119, instance_loss: 0.5719, weighted_loss: 0.7399, label: 2, bag_size: 325batch 400, loss: 0.3642, instance_loss: 0.3173, weighted_loss: 0.3501, label: 2, bag_size: 510batch 500, loss: 0.0260, instance_loss: 0.0199, weighted_loss: 0.0242, label: 2, bag_size: 905batch 600, loss: 0.9029, instance_loss: 0.6169, weighted_loss: 0.8171, label: 1, bag_size: 933batch 700, loss: 0.3295, instance_loss: 0.6607, weighted_loss: 0.4289, label: 1, bag_size: 161batch 800, loss: 0.4774, instance_loss: 0.5323, weighted_loss: 0.4939, label: 3, bag_size: 338batch 900, loss: 0.9861, instance_loss: 0.5989, weighted_loss: 0.8700, label: 1, bag_size: 558batch 1000, loss: 0.0657, instance_loss: 0.1668, weighted_loss: 0.0961, label: 2, bag_size: 888batch 1100, loss: 0.5192, instance_loss: 0.5184, weighted_loss: 0.5190, label: 3, bag_size: 209batch 1200, loss: 0.5279, instance_loss: 0.4677, weighted_loss: 0.5098, label: 2, bag_size: 596batch 1300, loss: 0.4204, instance_loss: 0.5257, weighted_loss: 0.4520, label: 1, bag_size: 1616batch 1400, loss: 0.1946, instance_loss: 0.6542, weighted_loss: 0.3325, label: 1, bag_size: 169batch 1500, loss: 0.8545, instance_loss: 0.3929, weighted_loss: 0.7160, label: 1, bag_size: 252batch 1600, loss: 0.7702, instance_loss: 0.5128, weighted_loss: 0.6930, label: 2, bag_size: 132batch 1700, loss: 0.1962, instance_loss: 0.2662, weighted_loss: 0.2172, label: 2, bag_size: 206batch 1800, loss: 0.5453, instance_loss: 0.3129, weighted_loss: 0.4756, label: 2, bag_size: 450batch 1900, loss: 0.0625, instance_loss: 0.1272, weighted_loss: 0.0819, label: 1, bag_size: 610batch 2000, loss: 0.6155, instance_loss: 0.4895, weighted_loss: 0.5777, label: 1, bag_size: 371batch 2100, loss: 0.5543, instance_loss: 0.3698, weighted_loss: 0.4990, label: 2, bag_size: 485Instance Classifier Statsclass 0 clustering acc 0.9850950460829493: correct 68405/69440class 1 clustering acc 0.42972350230414746: correct 7460/17360Epoch: 21, train_loss: 0.5539, train_clustering_loss:  0.3710, train_error: 0.2175class 0: acc 0.29545454545454547, correct 13/44 class 1: acc 0.7762148337595908, correct 607/782 class 2: acc 0.8877644894204232, correct 965/1087 class 3: acc 0.4396887159533074, correct 113/257 Overall Accuracy: 0.7825
Val Set, val_loss: 0.8320, auc: 0.7491 class 0 clustering acc 0.9801136363636364: correct 8280/8448 class 1 clustering acc 0.4479166666666667: correct 946/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6666666666666666, correct 64/96 class 2: acc 0.7388059701492538, correct 99/134 class 3: acc 0.2, correct 6/30 Overall Accuracy: 0.6402Overall F1 Score: 0.4020Training for coarse level...batch 100, loss: 1.1719, instance_loss: 0.6879, weighted_loss: 1.0267, label: 1, bag_size: 217batch 200, loss: 0.0205, instance_loss: 0.3577, weighted_loss: 0.1217, label: 2, bag_size: 202batch 300, loss: 0.4682, instance_loss: 0.7780, weighted_loss: 0.5612, label: 1, bag_size: 540batch 400, loss: 2.5837, instance_loss: 1.9373, weighted_loss: 2.3898, label: 2, bag_size: 1414batch 500, loss: 0.5158, instance_loss: 0.4195, weighted_loss: 0.4869, label: 2, bag_size: 104batch 600, loss: 0.0177, instance_loss: 0.0161, weighted_loss: 0.0172, label: 1, bag_size: 833batch 700, loss: 0.0265, instance_loss: 0.1411, weighted_loss: 0.0609, label: 2, bag_size: 295batch 800, loss: 0.0065, instance_loss: 0.1516, weighted_loss: 0.0500, label: 2, bag_size: 178batch 900, loss: 0.2175, instance_loss: 0.2732, weighted_loss: 0.2342, label: 2, bag_size: 247batch 1000, loss: 0.1832, instance_loss: 0.2697, weighted_loss: 0.2091, label: 1, bag_size: 265batch 1100, loss: 0.0354, instance_loss: 0.1395, weighted_loss: 0.0666, label: 1, bag_size: 235batch 1200, loss: 0.1714, instance_loss: 0.0722, weighted_loss: 0.1417, label: 1, bag_size: 457batch 1300, loss: 0.2926, instance_loss: 0.2711, weighted_loss: 0.2862, label: 2, bag_size: 283batch 1400, loss: 0.1570, instance_loss: 0.4134, weighted_loss: 0.2339, label: 2, bag_size: 225batch 1500, loss: 0.0192, instance_loss: 0.0285, weighted_loss: 0.0220, label: 1, bag_size: 1561batch 1600, loss: 1.0375, instance_loss: 0.6505, weighted_loss: 0.9214, label: 1, bag_size: 522batch 1700, loss: 0.1460, instance_loss: 0.1937, weighted_loss: 0.1603, label: 2, bag_size: 1304batch 1800, loss: 0.0421, instance_loss: 0.0776, weighted_loss: 0.0527, label: 2, bag_size: 407batch 1900, loss: 0.0173, instance_loss: 0.0140, weighted_loss: 0.0163, label: 1, bag_size: 728batch 2000, loss: 0.1978, instance_loss: 0.4145, weighted_loss: 0.2628, label: 3, bag_size: 172batch 2100, loss: 0.7345, instance_loss: 0.6801, weighted_loss: 0.7182, label: 1, bag_size: 306Instance Classifier Statsclass 0 clustering acc 0.9849654377880185: correct 68396/69440class 1 clustering acc 0.4391705069124424: correct 7624/17360Epoch: 22, train_loss: 0.5384, train_clustering_loss:  0.3680, train_error: 0.2028class 0: acc 0.3181818181818182, correct 14/44 class 1: acc 0.7902813299232737, correct 618/782 class 2: acc 0.891444342226311, correct 969/1087 class 3: acc 0.5019455252918288, correct 129/257 Overall Accuracy: 0.7972
Val Set, val_loss: 0.8206, auc: 0.7597 class 0 clustering acc 0.9824810606060606: correct 8300/8448 class 1 clustering acc 0.4318181818181818: correct 912/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6979166666666666, correct 67/96 class 2: acc 0.6940298507462687, correct 93/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6402Overall F1 Score: 0.4208Training for coarse level...batch 100, loss: 1.2498, instance_loss: 0.6571, weighted_loss: 1.0720, label: 2, bag_size: 298batch 200, loss: 0.9151, instance_loss: 0.4988, weighted_loss: 0.7902, label: 2, bag_size: 216batch 300, loss: 0.5193, instance_loss: 0.4591, weighted_loss: 0.5012, label: 2, bag_size: 1897batch 400, loss: 0.7254, instance_loss: 0.5506, weighted_loss: 0.6730, label: 1, bag_size: 282batch 500, loss: 0.8398, instance_loss: 0.5534, weighted_loss: 0.7539, label: 2, bag_size: 375batch 600, loss: 0.0626, instance_loss: 0.2953, weighted_loss: 0.1324, label: 2, bag_size: 770batch 700, loss: 0.0562, instance_loss: 0.2500, weighted_loss: 0.1143, label: 2, bag_size: 1364batch 800, loss: 0.0523, instance_loss: 0.0714, weighted_loss: 0.0581, label: 2, bag_size: 341batch 900, loss: 0.0258, instance_loss: 0.0333, weighted_loss: 0.0281, label: 1, bag_size: 2352batch 1000, loss: 0.1087, instance_loss: 0.2024, weighted_loss: 0.1368, label: 1, bag_size: 1897batch 1100, loss: 0.9963, instance_loss: 0.3628, weighted_loss: 0.8062, label: 2, bag_size: 314batch 1200, loss: 0.1157, instance_loss: 0.1954, weighted_loss: 0.1396, label: 1, bag_size: 685batch 1300, loss: 0.6589, instance_loss: 0.4095, weighted_loss: 0.5841, label: 1, bag_size: 1667batch 1400, loss: 0.9741, instance_loss: 0.7008, weighted_loss: 0.8921, label: 1, bag_size: 449batch 1500, loss: 0.9219, instance_loss: 0.5419, weighted_loss: 0.8079, label: 1, bag_size: 366batch 1600, loss: 1.5857, instance_loss: 0.6127, weighted_loss: 1.2938, label: 1, bag_size: 522batch 1700, loss: 0.4182, instance_loss: 0.2659, weighted_loss: 0.3725, label: 1, bag_size: 927batch 1800, loss: 0.0157, instance_loss: 0.0306, weighted_loss: 0.0202, label: 2, bag_size: 201batch 1900, loss: 0.0092, instance_loss: 0.0306, weighted_loss: 0.0156, label: 2, bag_size: 289batch 2000, loss: 0.5237, instance_loss: 0.4365, weighted_loss: 0.4975, label: 2, bag_size: 267batch 2100, loss: 0.0729, instance_loss: 0.4470, weighted_loss: 0.1851, label: 3, bag_size: 149Instance Classifier Statsclass 0 clustering acc 0.9856710829493087: correct 68445/69440class 1 clustering acc 0.43709677419354837: correct 7588/17360Epoch: 23, train_loss: 0.5200, train_clustering_loss:  0.3667, train_error: 0.1982class 0: acc 0.36363636363636365, correct 16/44 class 1: acc 0.8120204603580563, correct 635/782 class 2: acc 0.8877644894204232, correct 965/1087 class 3: acc 0.48249027237354086, correct 124/257 Overall Accuracy: 0.8018
Val Set, val_loss: 0.8302, auc: 0.7642 class 0 clustering acc 0.9769176136363636: correct 8253/8448 class 1 clustering acc 0.4659090909090909: correct 984/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.59375, correct 57/96 class 2: acc 0.8134328358208955, correct 109/134 class 3: acc 0.23333333333333334, correct 7/30 Overall Accuracy: 0.6553Overall F1 Score: 0.4172Training for coarse level...batch 100, loss: 0.0992, instance_loss: 0.1809, weighted_loss: 0.1237, label: 1, bag_size: 601batch 200, loss: 0.2010, instance_loss: 0.2190, weighted_loss: 0.2064, label: 2, bag_size: 180batch 300, loss: 0.0403, instance_loss: 0.0417, weighted_loss: 0.0408, label: 1, bag_size: 392batch 400, loss: 0.5698, instance_loss: 0.5531, weighted_loss: 0.5648, label: 1, bag_size: 1061batch 500, loss: 0.5097, instance_loss: 0.3103, weighted_loss: 0.4499, label: 1, bag_size: 1667batch 600, loss: 0.0244, instance_loss: 0.0433, weighted_loss: 0.0301, label: 2, bag_size: 397batch 700, loss: 0.4148, instance_loss: 0.5831, weighted_loss: 0.4653, label: 1, bag_size: 501batch 800, loss: 0.0848, instance_loss: 0.4934, weighted_loss: 0.2074, label: 1, bag_size: 1441batch 900, loss: 0.6985, instance_loss: 0.6958, weighted_loss: 0.6977, label: 3, bag_size: 270batch 1000, loss: 0.4763, instance_loss: 0.2798, weighted_loss: 0.4174, label: 2, bag_size: 386batch 1100, loss: 0.6453, instance_loss: 0.4152, weighted_loss: 0.5763, label: 2, bag_size: 336batch 1200, loss: 0.0024, instance_loss: 0.0112, weighted_loss: 0.0050, label: 2, bag_size: 349batch 1300, loss: 0.0057, instance_loss: 0.1008, weighted_loss: 0.0342, label: 2, bag_size: 307batch 1400, loss: 0.0249, instance_loss: 0.1047, weighted_loss: 0.0489, label: 2, bag_size: 817batch 1500, loss: 0.4007, instance_loss: 0.4118, weighted_loss: 0.4040, label: 2, bag_size: 463batch 1600, loss: 0.7221, instance_loss: 0.5845, weighted_loss: 0.6809, label: 1, bag_size: 248batch 1700, loss: 0.9705, instance_loss: 0.5661, weighted_loss: 0.8492, label: 1, bag_size: 282batch 1800, loss: 0.7092, instance_loss: 0.7549, weighted_loss: 0.7229, label: 1, bag_size: 437batch 1900, loss: 0.0499, instance_loss: 0.0745, weighted_loss: 0.0573, label: 2, bag_size: 482batch 2000, loss: 0.8148, instance_loss: 0.6756, weighted_loss: 0.7730, label: 0, bag_size: 352batch 2100, loss: 0.4639, instance_loss: 0.5415, weighted_loss: 0.4872, label: 3, bag_size: 707Instance Classifier Statsclass 0 clustering acc 0.9846342165898617: correct 68373/69440class 1 clustering acc 0.447926267281106: correct 7776/17360Epoch: 24, train_loss: 0.5006, train_clustering_loss:  0.3660, train_error: 0.1866class 0: acc 0.36363636363636365, correct 16/44 class 1: acc 0.8184143222506394, correct 640/782 class 2: acc 0.8997240110395585, correct 978/1087 class 3: acc 0.5097276264591439, correct 131/257 Overall Accuracy: 0.8134
Val Set, val_loss: 0.8396, auc: 0.7706 class 0 clustering acc 0.982717803030303: correct 8302/8448 class 1 clustering acc 0.4308712121212121: correct 910/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6979166666666666, correct 67/96 class 2: acc 0.7014925373134329, correct 94/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6477Overall F1 Score: 0.4282Training for coarse level...batch 100, loss: 0.0050, instance_loss: 0.0404, weighted_loss: 0.0156, label: 2, bag_size: 475batch 200, loss: 0.0929, instance_loss: 0.1307, weighted_loss: 0.1043, label: 1, bag_size: 610batch 300, loss: 0.0218, instance_loss: 0.0433, weighted_loss: 0.0282, label: 2, bag_size: 1140batch 400, loss: 1.2186, instance_loss: 0.6582, weighted_loss: 1.0505, label: 1, bag_size: 205batch 500, loss: 0.9095, instance_loss: 0.6799, weighted_loss: 0.8406, label: 1, bag_size: 250batch 600, loss: 0.2144, instance_loss: 0.3823, weighted_loss: 0.2647, label: 1, bag_size: 975batch 700, loss: 0.7543, instance_loss: 0.4063, weighted_loss: 0.6499, label: 2, bag_size: 644batch 800, loss: 0.0260, instance_loss: 0.0284, weighted_loss: 0.0267, label: 2, bag_size: 637batch 900, loss: 0.5256, instance_loss: 0.4398, weighted_loss: 0.4998, label: 2, bag_size: 334batch 1000, loss: 0.4808, instance_loss: 0.2555, weighted_loss: 0.4132, label: 2, bag_size: 463batch 1100, loss: 0.0178, instance_loss: 0.0581, weighted_loss: 0.0299, label: 2, bag_size: 815batch 1200, loss: 0.3416, instance_loss: 0.3871, weighted_loss: 0.3553, label: 2, bag_size: 1135batch 1300, loss: 0.0229, instance_loss: 0.0242, weighted_loss: 0.0233, label: 2, bag_size: 1157batch 1400, loss: 0.0415, instance_loss: 0.0742, weighted_loss: 0.0513, label: 2, bag_size: 857batch 1500, loss: 0.2545, instance_loss: 0.5253, weighted_loss: 0.3357, label: 2, bag_size: 331batch 1600, loss: 0.2292, instance_loss: 0.0673, weighted_loss: 0.1806, label: 2, bag_size: 517batch 1700, loss: 0.0192, instance_loss: 0.1000, weighted_loss: 0.0434, label: 1, bag_size: 600batch 1800, loss: 0.0049, instance_loss: 0.0950, weighted_loss: 0.0320, label: 2, bag_size: 400batch 1900, loss: 0.0457, instance_loss: 0.3757, weighted_loss: 0.1447, label: 3, bag_size: 850batch 2000, loss: 0.4329, instance_loss: 0.4407, weighted_loss: 0.4352, label: 2, bag_size: 174batch 2100, loss: 1.0630, instance_loss: 0.4975, weighted_loss: 0.8934, label: 2, bag_size: 132Instance Classifier Statsclass 0 clustering acc 0.9854550691244239: correct 68430/69440class 1 clustering acc 0.4411866359447005: correct 7659/17360Epoch: 25, train_loss: 0.4861, train_clustering_loss:  0.3641, train_error: 0.1834class 0: acc 0.36363636363636365, correct 16/44 class 1: acc 0.819693094629156, correct 641/782 class 2: acc 0.8969641214351426, correct 975/1087 class 3: acc 0.5447470817120622, correct 140/257 Overall Accuracy: 0.8166
Val Set, val_loss: 0.8726, auc: 0.7413 class 0 clustering acc 0.9773910984848485: correct 8257/8448 class 1 clustering acc 0.4550189393939394: correct 961/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6666666666666666, correct 64/96 class 2: acc 0.7611940298507462, correct 102/134 class 3: acc 0.16666666666666666, correct 5/30 Overall Accuracy: 0.6477Overall F1 Score: 0.4005Training for coarse level...batch 100, loss: 0.1717, instance_loss: 0.2341, weighted_loss: 0.1904, label: 1, bag_size: 459batch 200, loss: 0.0587, instance_loss: 0.0847, weighted_loss: 0.0665, label: 1, bag_size: 1781batch 300, loss: 0.8532, instance_loss: 0.6065, weighted_loss: 0.7792, label: 1, bag_size: 228batch 400, loss: 0.7415, instance_loss: 0.4771, weighted_loss: 0.6621, label: 1, bag_size: 2367batch 500, loss: 0.0440, instance_loss: 0.0316, weighted_loss: 0.0403, label: 2, bag_size: 357batch 600, loss: 1.0990, instance_loss: 0.4088, weighted_loss: 0.8920, label: 2, bag_size: 483batch 700, loss: 0.2613, instance_loss: 0.2909, weighted_loss: 0.2702, label: 2, bag_size: 313batch 800, loss: 0.4725, instance_loss: 0.5122, weighted_loss: 0.4844, label: 2, bag_size: 256batch 900, loss: 0.7348, instance_loss: 0.6603, weighted_loss: 0.7124, label: 3, bag_size: 130batch 1000, loss: 0.0959, instance_loss: 0.5410, weighted_loss: 0.2294, label: 3, bag_size: 388batch 1100, loss: 0.8051, instance_loss: 0.4864, weighted_loss: 0.7095, label: 2, bag_size: 242batch 1200, loss: 0.1729, instance_loss: 0.3564, weighted_loss: 0.2280, label: 2, bag_size: 283batch 1300, loss: 0.3107, instance_loss: 0.3233, weighted_loss: 0.3145, label: 2, bag_size: 565batch 1400, loss: 0.3239, instance_loss: 0.5309, weighted_loss: 0.3860, label: 3, bag_size: 888batch 1500, loss: 0.0080, instance_loss: 0.0412, weighted_loss: 0.0180, label: 2, bag_size: 475batch 1600, loss: 0.1342, instance_loss: 0.2423, weighted_loss: 0.1666, label: 1, bag_size: 1666batch 1700, loss: 0.0014, instance_loss: 0.0431, weighted_loss: 0.0139, label: 2, bag_size: 190batch 1800, loss: 0.0889, instance_loss: 0.1677, weighted_loss: 0.1126, label: 1, bag_size: 1727batch 1900, loss: 0.4699, instance_loss: 0.3069, weighted_loss: 0.4210, label: 1, bag_size: 1293batch 2000, loss: 1.0021, instance_loss: 0.7433, weighted_loss: 0.9245, label: 3, bag_size: 708batch 2100, loss: 0.2862, instance_loss: 0.5868, weighted_loss: 0.3764, label: 3, bag_size: 391Instance Classifier Statsclass 0 clustering acc 0.9847638248847926: correct 68382/69440class 1 clustering acc 0.44879032258064516: correct 7791/17360Epoch: 26, train_loss: 0.4663, train_clustering_loss:  0.3618, train_error: 0.1733class 0: acc 0.4772727272727273, correct 21/44 class 1: acc 0.8350383631713555, correct 653/782 class 2: acc 0.9080036798528058, correct 987/1087 class 3: acc 0.5175097276264592, correct 133/257 Overall Accuracy: 0.8267
Val Set, val_loss: 0.8726, auc: 0.7530 class 0 clustering acc 0.9792850378787878: correct 8273/8448 class 1 clustering acc 0.4412878787878788: correct 932/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.7388059701492538, correct 99/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6553Overall F1 Score: 0.4341Training for coarse level...batch 100, loss: 0.0495, instance_loss: 0.1415, weighted_loss: 0.0771, label: 1, bag_size: 1628batch 200, loss: 0.6246, instance_loss: 0.4614, weighted_loss: 0.5756, label: 2, bag_size: 305batch 300, loss: 0.7147, instance_loss: 0.4466, weighted_loss: 0.6343, label: 2, bag_size: 216batch 400, loss: 0.0794, instance_loss: 0.0444, weighted_loss: 0.0689, label: 1, bag_size: 1803batch 500, loss: 0.2547, instance_loss: 0.6754, weighted_loss: 0.3809, label: 1, bag_size: 102batch 600, loss: 0.0144, instance_loss: 0.0263, weighted_loss: 0.0180, label: 1, bag_size: 833batch 700, loss: 0.3667, instance_loss: 0.4416, weighted_loss: 0.3891, label: 1, bag_size: 265batch 800, loss: 0.0024, instance_loss: 0.0862, weighted_loss: 0.0275, label: 2, bag_size: 603batch 900, loss: 0.1049, instance_loss: 0.1438, weighted_loss: 0.1166, label: 2, bag_size: 755batch 1000, loss: 0.0106, instance_loss: 0.0539, weighted_loss: 0.0236, label: 2, bag_size: 1211batch 1100, loss: 0.1048, instance_loss: 0.0921, weighted_loss: 0.1010, label: 2, bag_size: 265batch 1200, loss: 0.0033, instance_loss: 0.0248, weighted_loss: 0.0097, label: 2, bag_size: 890batch 1300, loss: 0.0259, instance_loss: 0.0818, weighted_loss: 0.0427, label: 2, bag_size: 216batch 1400, loss: 0.3757, instance_loss: 0.3228, weighted_loss: 0.3598, label: 2, bag_size: 636batch 1500, loss: 0.0147, instance_loss: 0.0173, weighted_loss: 0.0155, label: 2, bag_size: 206batch 1600, loss: 0.1165, instance_loss: 0.4006, weighted_loss: 0.2017, label: 3, bag_size: 172batch 1700, loss: 0.0240, instance_loss: 0.0475, weighted_loss: 0.0310, label: 2, bag_size: 432batch 1800, loss: 0.0609, instance_loss: 0.1804, weighted_loss: 0.0967, label: 2, bag_size: 568batch 1900, loss: 0.0078, instance_loss: 0.0569, weighted_loss: 0.0226, label: 2, bag_size: 874batch 2000, loss: 2.3088, instance_loss: 1.2632, weighted_loss: 1.9951, label: 3, bag_size: 380batch 2100, loss: 0.0130, instance_loss: 0.0224, weighted_loss: 0.0158, label: 2, bag_size: 821Instance Classifier Statsclass 0 clustering acc 0.9852966589861751: correct 68419/69440class 1 clustering acc 0.4502880184331797: correct 7817/17360Epoch: 27, train_loss: 0.4443, train_clustering_loss:  0.3599, train_error: 0.1608class 0: acc 0.4318181818181818, correct 19/44 class 1: acc 0.8388746803069054, correct 656/782 class 2: acc 0.9153633854645814, correct 995/1087 class 3: acc 0.5875486381322957, correct 151/257 Overall Accuracy: 0.8392
Val Set, val_loss: 0.8793, auc: 0.7569 class 0 clustering acc 0.9776278409090909: correct 8259/8448 class 1 clustering acc 0.45265151515151514: correct 956/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.625, correct 60/96 class 2: acc 0.7910447761194029, correct 106/134 class 3: acc 0.26666666666666666, correct 8/30 Overall Accuracy: 0.6591Overall F1 Score: 0.4303Training for coarse level...batch 100, loss: 0.1476, instance_loss: 0.0909, weighted_loss: 0.1306, label: 2, bag_size: 574batch 200, loss: 0.0381, instance_loss: 0.1716, weighted_loss: 0.0781, label: 2, bag_size: 706batch 300, loss: 0.8452, instance_loss: 0.5683, weighted_loss: 0.7621, label: 1, bag_size: 347batch 400, loss: 2.2320, instance_loss: 0.9675, weighted_loss: 1.8526, label: 0, bag_size: 244batch 500, loss: 0.2995, instance_loss: 0.2830, weighted_loss: 0.2946, label: 2, bag_size: 124batch 600, loss: 0.0032, instance_loss: 0.0165, weighted_loss: 0.0072, label: 2, bag_size: 300batch 700, loss: 1.1141, instance_loss: 0.8447, weighted_loss: 1.0333, label: 3, bag_size: 444batch 800, loss: 0.2457, instance_loss: 0.0576, weighted_loss: 0.1892, label: 1, bag_size: 1947batch 900, loss: 0.0184, instance_loss: 0.0400, weighted_loss: 0.0248, label: 2, bag_size: 371batch 1000, loss: 1.6946, instance_loss: 0.5955, weighted_loss: 1.3649, label: 1, bag_size: 398batch 1100, loss: 0.0345, instance_loss: 0.0219, weighted_loss: 0.0307, label: 1, bag_size: 199batch 1200, loss: 0.1540, instance_loss: 0.4157, weighted_loss: 0.2325, label: 1, bag_size: 183batch 1300, loss: 0.0367, instance_loss: 0.0221, weighted_loss: 0.0324, label: 1, bag_size: 983batch 1400, loss: 0.5792, instance_loss: 0.5244, weighted_loss: 0.5628, label: 2, bag_size: 252batch 1500, loss: 0.1905, instance_loss: 0.2603, weighted_loss: 0.2115, label: 2, bag_size: 243batch 1600, loss: 0.4857, instance_loss: 0.3071, weighted_loss: 0.4321, label: 1, bag_size: 786batch 1700, loss: 0.0063, instance_loss: 0.0333, weighted_loss: 0.0144, label: 2, bag_size: 474batch 1800, loss: 0.4768, instance_loss: 0.5146, weighted_loss: 0.4882, label: 2, bag_size: 52batch 1900, loss: 0.0741, instance_loss: 0.0391, weighted_loss: 0.0636, label: 1, bag_size: 1817batch 2000, loss: 2.1019, instance_loss: 0.6343, weighted_loss: 1.6616, label: 2, bag_size: 853batch 2100, loss: 0.0117, instance_loss: 0.0296, weighted_loss: 0.0171, label: 2, bag_size: 1211Instance Classifier Statsclass 0 clustering acc 0.9856134792626728: correct 68441/69440class 1 clustering acc 0.4444700460829493: correct 7716/17360Epoch: 28, train_loss: 0.4305, train_clustering_loss:  0.3609, train_error: 0.1535class 0: acc 0.4772727272727273, correct 21/44 class 1: acc 0.850383631713555, correct 665/782 class 2: acc 0.9172033118675254, correct 997/1087 class 3: acc 0.5992217898832685, correct 154/257 Overall Accuracy: 0.8465
Val Set, val_loss: 0.8641, auc: 0.7744 class 0 clustering acc 0.9775094696969697: correct 8258/8448 class 1 clustering acc 0.4588068181818182: correct 969/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6666666666666666, correct 64/96 class 2: acc 0.8134328358208955, correct 109/134 class 3: acc 0.16666666666666666, correct 5/30 Overall Accuracy: 0.6742Overall F1 Score: 0.4174Training for coarse level...batch 100, loss: 0.2777, instance_loss: 0.2705, weighted_loss: 0.2755, label: 2, bag_size: 649batch 200, loss: 0.8117, instance_loss: 0.3606, weighted_loss: 0.6764, label: 2, bag_size: 1422batch 300, loss: 0.5402, instance_loss: 0.6176, weighted_loss: 0.5634, label: 3, bag_size: 281batch 400, loss: 0.4774, instance_loss: 0.8773, weighted_loss: 0.5974, label: 2, bag_size: 276batch 500, loss: 0.4885, instance_loss: 1.0887, weighted_loss: 0.6686, label: 1, bag_size: 406batch 600, loss: 0.2961, instance_loss: 0.5377, weighted_loss: 0.3686, label: 1, bag_size: 224batch 700, loss: 0.0226, instance_loss: 0.0418, weighted_loss: 0.0284, label: 2, bag_size: 645batch 800, loss: 0.3005, instance_loss: 0.5107, weighted_loss: 0.3636, label: 1, bag_size: 611batch 900, loss: 0.0874, instance_loss: 0.2052, weighted_loss: 0.1227, label: 1, bag_size: 1726batch 1000, loss: 1.3668, instance_loss: 0.7401, weighted_loss: 1.1788, label: 1, bag_size: 276batch 1100, loss: 0.1685, instance_loss: 0.1705, weighted_loss: 0.1691, label: 1, bag_size: 512batch 1200, loss: 0.0438, instance_loss: 0.3322, weighted_loss: 0.1303, label: 3, bag_size: 850batch 1300, loss: 0.0065, instance_loss: 0.0144, weighted_loss: 0.0088, label: 2, bag_size: 1105batch 1400, loss: 0.0489, instance_loss: 0.0299, weighted_loss: 0.0432, label: 1, bag_size: 507batch 1500, loss: 1.2561, instance_loss: 0.6912, weighted_loss: 1.0866, label: 3, bag_size: 430batch 1600, loss: 0.0255, instance_loss: 0.0926, weighted_loss: 0.0456, label: 2, bag_size: 893batch 1700, loss: 0.6927, instance_loss: 0.6931, weighted_loss: 0.6928, label: 0, bag_size: 113batch 1800, loss: 0.0173, instance_loss: 0.0851, weighted_loss: 0.0376, label: 2, bag_size: 360batch 1900, loss: 0.3688, instance_loss: 0.3169, weighted_loss: 0.3532, label: 2, bag_size: 344batch 2000, loss: 0.0090, instance_loss: 0.1543, weighted_loss: 0.0525, label: 2, bag_size: 609batch 2100, loss: 0.0092, instance_loss: 0.0466, weighted_loss: 0.0204, label: 1, bag_size: 310Instance Classifier Statsclass 0 clustering acc 0.9855702764976959: correct 68438/69440class 1 clustering acc 0.44815668202764974: correct 7780/17360Epoch: 29, train_loss: 0.4159, train_clustering_loss:  0.3580, train_error: 0.1419class 0: acc 0.45454545454545453, correct 20/44 class 1: acc 0.8670076726342711, correct 678/782 class 2: acc 0.9273229070837167, correct 1008/1087 class 3: acc 0.6070038910505836, correct 156/257 Overall Accuracy: 0.8581
Val Set, val_loss: 0.9051, auc: 0.7633 class 0 clustering acc 0.9767992424242424: correct 8252/8448 class 1 clustering acc 0.4493371212121212: correct 949/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.7686567164179104, correct 103/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6705Overall F1 Score: 0.4449Training for coarse level...batch 100, loss: 0.0389, instance_loss: 0.0440, weighted_loss: 0.0404, label: 1, bag_size: 392batch 200, loss: 0.1133, instance_loss: 0.5863, weighted_loss: 0.2552, label: 1, bag_size: 409batch 300, loss: 0.0988, instance_loss: 0.4629, weighted_loss: 0.2080, label: 2, bag_size: 106batch 400, loss: 0.7069, instance_loss: 0.4263, weighted_loss: 0.6227, label: 2, bag_size: 396batch 500, loss: 1.3757, instance_loss: 0.6094, weighted_loss: 1.1458, label: 1, bag_size: 505batch 600, loss: 0.0467, instance_loss: 0.0339, weighted_loss: 0.0429, label: 1, bag_size: 556batch 700, loss: 0.0027, instance_loss: 0.0143, weighted_loss: 0.0062, label: 1, bag_size: 847batch 800, loss: 0.2251, instance_loss: 0.3637, weighted_loss: 0.2667, label: 1, bag_size: 611batch 900, loss: 0.1254, instance_loss: 0.1843, weighted_loss: 0.1431, label: 1, bag_size: 497batch 1000, loss: 0.1264, instance_loss: 0.1443, weighted_loss: 0.1317, label: 1, bag_size: 334batch 1100, loss: 0.3051, instance_loss: 0.4526, weighted_loss: 0.3493, label: 2, bag_size: 106batch 1200, loss: 0.3404, instance_loss: 0.4780, weighted_loss: 0.3817, label: 1, bag_size: 1618batch 1300, loss: 0.3372, instance_loss: 0.5169, weighted_loss: 0.3911, label: 2, bag_size: 1506batch 1400, loss: 0.0762, instance_loss: 0.1349, weighted_loss: 0.0938, label: 1, bag_size: 685batch 1500, loss: 0.0059, instance_loss: 0.0308, weighted_loss: 0.0133, label: 2, bag_size: 624batch 1600, loss: 1.1596, instance_loss: 0.6580, weighted_loss: 1.0091, label: 1, bag_size: 534batch 1700, loss: 1.7894, instance_loss: 0.7133, weighted_loss: 1.4665, label: 3, bag_size: 417batch 1800, loss: 0.0342, instance_loss: 0.0861, weighted_loss: 0.0497, label: 2, bag_size: 603batch 1900, loss: 1.4020, instance_loss: 1.3326, weighted_loss: 1.3812, label: 1, bag_size: 633batch 2000, loss: 0.3544, instance_loss: 0.1982, weighted_loss: 0.3075, label: 2, bag_size: 318batch 2100, loss: 0.0161, instance_loss: 0.1048, weighted_loss: 0.0427, label: 2, bag_size: 600Instance Classifier Statsclass 0 clustering acc 0.9852966589861751: correct 68419/69440class 1 clustering acc 0.45380184331797235: correct 7878/17360Epoch: 30, train_loss: 0.3946, train_clustering_loss:  0.3581, train_error: 0.1332class 0: acc 0.5, correct 22/44 class 1: acc 0.8695652173913043, correct 680/782 class 2: acc 0.9328426862925483, correct 1014/1087 class 3: acc 0.642023346303502, correct 165/257 Overall Accuracy: 0.8668
Val Set, val_loss: 0.9047, auc: 0.7608 class 0 clustering acc 0.9776278409090909: correct 8259/8448 class 1 clustering acc 0.4512310606060606: correct 953/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.7083333333333334, correct 68/96 class 2: acc 0.7238805970149254, correct 97/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6591Overall F1 Score: 0.4374Training for coarse level...batch 100, loss: 1.0326, instance_loss: 0.6953, weighted_loss: 0.9314, label: 3, bag_size: 682batch 200, loss: 5.0905, instance_loss: 1.8426, weighted_loss: 4.1161, label: 3, bag_size: 868batch 300, loss: 0.0133, instance_loss: 0.0149, weighted_loss: 0.0138, label: 2, bag_size: 307batch 400, loss: 0.7377, instance_loss: 0.7035, weighted_loss: 0.7274, label: 1, bag_size: 436batch 500, loss: 0.0115, instance_loss: 0.0246, weighted_loss: 0.0155, label: 2, bag_size: 821batch 600, loss: 1.0947, instance_loss: 0.6283, weighted_loss: 0.9548, label: 2, bag_size: 387batch 700, loss: 0.7013, instance_loss: 0.3754, weighted_loss: 0.6036, label: 2, bag_size: 929batch 800, loss: 0.4798, instance_loss: 0.5427, weighted_loss: 0.4987, label: 3, bag_size: 204batch 900, loss: 0.1238, instance_loss: 0.5267, weighted_loss: 0.2446, label: 3, bag_size: 888batch 1000, loss: 0.0323, instance_loss: 0.3789, weighted_loss: 0.1363, label: 3, bag_size: 464batch 1100, loss: 0.1170, instance_loss: 0.1199, weighted_loss: 0.1179, label: 1, bag_size: 334batch 1200, loss: 0.3089, instance_loss: 0.3673, weighted_loss: 0.3264, label: 2, bag_size: 223batch 1300, loss: 1.1447, instance_loss: 0.6897, weighted_loss: 1.0082, label: 3, bag_size: 528batch 1400, loss: 0.0638, instance_loss: 0.0510, weighted_loss: 0.0600, label: 2, bag_size: 745batch 1500, loss: 0.0395, instance_loss: 0.0843, weighted_loss: 0.0529, label: 2, bag_size: 434batch 1600, loss: 0.4370, instance_loss: 0.5107, weighted_loss: 0.4591, label: 1, bag_size: 228batch 1700, loss: 0.1020, instance_loss: 0.6259, weighted_loss: 0.2591, label: 1, bag_size: 746batch 1800, loss: 0.0071, instance_loss: 0.0225, weighted_loss: 0.0117, label: 2, bag_size: 334batch 1900, loss: 0.0048, instance_loss: 0.0298, weighted_loss: 0.0123, label: 2, bag_size: 457batch 2000, loss: 0.1849, instance_loss: 0.4792, weighted_loss: 0.2732, label: 3, bag_size: 756batch 2100, loss: 0.5764, instance_loss: 0.4559, weighted_loss: 0.5402, label: 2, bag_size: 489Instance Classifier Statsclass 0 clustering acc 0.9846486175115208: correct 68374/69440class 1 clustering acc 0.4542626728110599: correct 7886/17360Epoch: 31, train_loss: 0.3780, train_clustering_loss:  0.3561, train_error: 0.1313class 0: acc 0.5454545454545454, correct 24/44 class 1: acc 0.8797953964194374, correct 688/782 class 2: acc 0.9337626494940202, correct 1015/1087 class 3: acc 0.6147859922178989, correct 158/257 Overall Accuracy: 0.8687
Val Set, val_loss: 0.9339, auc: 0.7383 class 0 clustering acc 0.9717092803030303: correct 8209/8448 class 1 clustering acc 0.4706439393939394: correct 994/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.625, correct 60/96 class 2: acc 0.8283582089552238, correct 111/134 class 3: acc 0.23333333333333334, correct 7/30 Overall Accuracy: 0.6742Overall F1 Score: 0.4296Training for coarse level...batch 100, loss: 0.0805, instance_loss: 0.1853, weighted_loss: 0.1119, label: 2, bag_size: 511batch 200, loss: 0.3770, instance_loss: 0.4146, weighted_loss: 0.3883, label: 2, bag_size: 2046batch 300, loss: 0.0818, instance_loss: 0.1098, weighted_loss: 0.0902, label: 2, bag_size: 498batch 400, loss: 0.0196, instance_loss: 0.0413, weighted_loss: 0.0261, label: 2, bag_size: 192batch 500, loss: 0.2303, instance_loss: 0.2250, weighted_loss: 0.2287, label: 2, bag_size: 1555batch 600, loss: 0.1754, instance_loss: 0.5017, weighted_loss: 0.2733, label: 2, bag_size: 853batch 700, loss: 0.0127, instance_loss: 0.0299, weighted_loss: 0.0179, label: 1, bag_size: 389batch 800, loss: 0.0228, instance_loss: 0.2799, weighted_loss: 0.0999, label: 2, bag_size: 377batch 900, loss: 0.1372, instance_loss: 0.4341, weighted_loss: 0.2262, label: 2, bag_size: 621batch 1000, loss: 0.0089, instance_loss: 0.0335, weighted_loss: 0.0163, label: 2, bag_size: 713batch 1100, loss: 0.2460, instance_loss: 0.1996, weighted_loss: 0.2321, label: 1, bag_size: 780batch 1200, loss: 0.8553, instance_loss: 0.4671, weighted_loss: 0.7388, label: 2, bag_size: 243batch 1300, loss: 0.6606, instance_loss: 0.4416, weighted_loss: 0.5949, label: 2, bag_size: 322batch 1400, loss: 0.0432, instance_loss: 0.0275, weighted_loss: 0.0385, label: 1, bag_size: 1827batch 1500, loss: 0.4711, instance_loss: 0.3638, weighted_loss: 0.4389, label: 2, bag_size: 462batch 1600, loss: 0.2776, instance_loss: 0.4844, weighted_loss: 0.3397, label: 3, bag_size: 256batch 1700, loss: 0.5632, instance_loss: 0.5981, weighted_loss: 0.5737, label: 3, bag_size: 168batch 1800, loss: 1.0588, instance_loss: 0.7258, weighted_loss: 0.9589, label: 1, bag_size: 78batch 1900, loss: 0.0035, instance_loss: 0.0526, weighted_loss: 0.0182, label: 2, bag_size: 358batch 2000, loss: 0.0017, instance_loss: 0.0204, weighted_loss: 0.0073, label: 2, bag_size: 250batch 2100, loss: 0.2461, instance_loss: 0.3157, weighted_loss: 0.2670, label: 2, bag_size: 335Instance Classifier Statsclass 0 clustering acc 0.9844902073732719: correct 68363/69440class 1 clustering acc 0.4599078341013825: correct 7984/17360Epoch: 32, train_loss: 0.3613, train_clustering_loss:  0.3549, train_error: 0.1157class 0: acc 0.6136363636363636, correct 27/44 class 1: acc 0.8964194373401535, correct 701/782 class 2: acc 0.9438822447102115, correct 1026/1087 class 3: acc 0.642023346303502, correct 165/257 Overall Accuracy: 0.8843
Val Set, val_loss: 0.9142, auc: 0.7727 class 0 clustering acc 0.9765625: correct 8250/8448 class 1 clustering acc 0.44554924242424243: correct 941/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.65625, correct 63/96 class 2: acc 0.7835820895522388, correct 105/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6742Overall F1 Score: 0.4497Training for coarse level...batch 100, loss: 0.3608, instance_loss: 0.2423, weighted_loss: 0.3253, label: 1, bag_size: 663batch 200, loss: 0.4197, instance_loss: 0.3944, weighted_loss: 0.4121, label: 2, bag_size: 348batch 300, loss: 0.0174, instance_loss: 0.0630, weighted_loss: 0.0311, label: 2, bag_size: 537batch 400, loss: 0.0577, instance_loss: 0.3738, weighted_loss: 0.1525, label: 2, bag_size: 220batch 500, loss: 0.0945, instance_loss: 0.0672, weighted_loss: 0.0863, label: 1, bag_size: 1892batch 600, loss: 0.2983, instance_loss: 0.5288, weighted_loss: 0.3674, label: 2, bag_size: 814batch 700, loss: 1.3541, instance_loss: 0.7219, weighted_loss: 1.1644, label: 2, bag_size: 128batch 800, loss: 0.0470, instance_loss: 0.0927, weighted_loss: 0.0607, label: 2, bag_size: 353batch 900, loss: 0.2493, instance_loss: 0.4888, weighted_loss: 0.3211, label: 2, bag_size: 718batch 1000, loss: 0.0051, instance_loss: 0.0571, weighted_loss: 0.0207, label: 2, bag_size: 533batch 1100, loss: 1.4809, instance_loss: 1.4563, weighted_loss: 1.4735, label: 3, bag_size: 981batch 1200, loss: 0.0432, instance_loss: 0.0574, weighted_loss: 0.0475, label: 2, bag_size: 443batch 1300, loss: 0.2310, instance_loss: 0.5471, weighted_loss: 0.3259, label: 3, bag_size: 581batch 1400, loss: 0.0007, instance_loss: 0.0151, weighted_loss: 0.0051, label: 2, bag_size: 969batch 1500, loss: 0.0034, instance_loss: 0.0199, weighted_loss: 0.0083, label: 2, bag_size: 329batch 1600, loss: 0.0158, instance_loss: 0.3590, weighted_loss: 0.1188, label: 1, bag_size: 483batch 1700, loss: 0.1775, instance_loss: 0.5019, weighted_loss: 0.2748, label: 3, bag_size: 388batch 1800, loss: 0.3020, instance_loss: 0.6191, weighted_loss: 0.3971, label: 3, bag_size: 440batch 1900, loss: 0.4198, instance_loss: 0.6966, weighted_loss: 0.5029, label: 3, bag_size: 333batch 2000, loss: 0.0886, instance_loss: 0.2597, weighted_loss: 0.1400, label: 2, bag_size: 679batch 2100, loss: 0.8007, instance_loss: 0.4706, weighted_loss: 0.7016, label: 2, bag_size: 292Instance Classifier Statsclass 0 clustering acc 0.9847206221198157: correct 68379/69440class 1 clustering acc 0.4627304147465438: correct 8033/17360Epoch: 33, train_loss: 0.3507, train_clustering_loss:  0.3528, train_error: 0.1171class 0: acc 0.5681818181818182, correct 25/44 class 1: acc 0.8913043478260869, correct 697/782 class 2: acc 0.937442502299908, correct 1019/1087 class 3: acc 0.6809338521400778, correct 175/257 Overall Accuracy: 0.8829
Val Set, val_loss: 0.9456, auc: 0.7739 class 0 clustering acc 0.9773910984848485: correct 8257/8448 class 1 clustering acc 0.44365530303030304: correct 937/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.7291666666666666, correct 70/96 class 2: acc 0.7238805970149254, correct 97/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6705Overall F1 Score: 0.4482Training for coarse level...batch 100, loss: 0.2784, instance_loss: 0.6083, weighted_loss: 0.3774, label: 2, bag_size: 663batch 200, loss: 0.0008, instance_loss: 0.0838, weighted_loss: 0.0257, label: 2, bag_size: 789batch 300, loss: 0.1268, instance_loss: 0.5129, weighted_loss: 0.2426, label: 2, bag_size: 154batch 400, loss: 0.4315, instance_loss: 0.3569, weighted_loss: 0.4091, label: 2, bag_size: 599batch 500, loss: 0.0182, instance_loss: 0.2194, weighted_loss: 0.0786, label: 2, bag_size: 661batch 600, loss: 0.9341, instance_loss: 0.7904, weighted_loss: 0.8910, label: 1, bag_size: 393batch 700, loss: 0.3712, instance_loss: 0.3416, weighted_loss: 0.3624, label: 2, bag_size: 595batch 800, loss: 0.0641, instance_loss: 0.0911, weighted_loss: 0.0722, label: 1, bag_size: 207batch 900, loss: 1.2948, instance_loss: 0.4968, weighted_loss: 1.0554, label: 1, bag_size: 179batch 1000, loss: 0.1245, instance_loss: 0.4911, weighted_loss: 0.2345, label: 1, bag_size: 374batch 1100, loss: 2.8349, instance_loss: 1.8805, weighted_loss: 2.5486, label: 2, bag_size: 362batch 1200, loss: 0.0703, instance_loss: 0.0895, weighted_loss: 0.0760, label: 2, bag_size: 482batch 1300, loss: 0.2516, instance_loss: 0.3950, weighted_loss: 0.2946, label: 2, bag_size: 309batch 1400, loss: 0.0383, instance_loss: 0.0382, weighted_loss: 0.0382, label: 1, bag_size: 199batch 1500, loss: 0.0039, instance_loss: 0.2056, weighted_loss: 0.0644, label: 2, bag_size: 182batch 1600, loss: 0.0361, instance_loss: 0.0984, weighted_loss: 0.0548, label: 2, bag_size: 466batch 1700, loss: 0.5539, instance_loss: 0.3443, weighted_loss: 0.4910, label: 2, bag_size: 465batch 1800, loss: 0.0055, instance_loss: 0.0477, weighted_loss: 0.0182, label: 2, bag_size: 238batch 1900, loss: 0.0132, instance_loss: 0.0556, weighted_loss: 0.0259, label: 1, bag_size: 1762batch 2000, loss: 0.2285, instance_loss: 0.3310, weighted_loss: 0.2593, label: 1, bag_size: 501batch 2100, loss: 0.7701, instance_loss: 0.5331, weighted_loss: 0.6990, label: 1, bag_size: 37Instance Classifier Statsclass 0 clustering acc 0.9846918202764977: correct 68377/69440class 1 clustering acc 0.46601382488479265: correct 8090/17360Epoch: 34, train_loss: 0.3281, train_clustering_loss:  0.3503, train_error: 0.1074class 0: acc 0.5, correct 22/44 class 1: acc 0.9053708439897699, correct 708/782 class 2: acc 0.9466421343146274, correct 1029/1087 class 3: acc 0.6926070038910506, correct 178/257 Overall Accuracy: 0.8926
Val Set, val_loss: 0.9719, auc: 0.7407 class 0 clustering acc 0.9760890151515151: correct 8246/8448 class 1 clustering acc 0.4550189393939394: correct 961/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.7686567164179104, correct 103/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6742Overall F1 Score: 0.4480Training for coarse level...batch 100, loss: 0.6841, instance_loss: 0.6967, weighted_loss: 0.6879, label: 3, bag_size: 269batch 200, loss: 0.1369, instance_loss: 0.2551, weighted_loss: 0.1723, label: 2, bag_size: 333batch 300, loss: 1.4823, instance_loss: 0.5916, weighted_loss: 1.2151, label: 1, bag_size: 119batch 400, loss: 0.3793, instance_loss: 0.5538, weighted_loss: 0.4317, label: 1, bag_size: 522batch 500, loss: 0.0635, instance_loss: 0.4487, weighted_loss: 0.1791, label: 2, bag_size: 253batch 600, loss: 0.8836, instance_loss: 0.5513, weighted_loss: 0.7839, label: 1, bag_size: 1168batch 700, loss: 0.0030, instance_loss: 0.1744, weighted_loss: 0.0544, label: 2, bag_size: 287batch 800, loss: 0.0010, instance_loss: 0.0289, weighted_loss: 0.0094, label: 2, bag_size: 318batch 900, loss: 0.3103, instance_loss: 0.3751, weighted_loss: 0.3297, label: 2, bag_size: 449batch 1000, loss: 0.1201, instance_loss: 0.2513, weighted_loss: 0.1595, label: 2, bag_size: 525batch 1100, loss: 0.2609, instance_loss: 0.3408, weighted_loss: 0.2848, label: 2, bag_size: 478batch 1200, loss: 0.0312, instance_loss: 0.4527, weighted_loss: 0.1577, label: 3, bag_size: 22batch 1300, loss: 0.6232, instance_loss: 0.6041, weighted_loss: 0.6175, label: 3, bag_size: 162batch 1400, loss: 0.6418, instance_loss: 0.8188, weighted_loss: 0.6949, label: 1, bag_size: 165batch 1500, loss: 0.0037, instance_loss: 0.1934, weighted_loss: 0.0606, label: 2, bag_size: 796batch 1600, loss: 0.3913, instance_loss: 0.7183, weighted_loss: 0.4894, label: 2, bag_size: 658batch 1700, loss: 0.0191, instance_loss: 0.1272, weighted_loss: 0.0515, label: 2, bag_size: 279batch 1800, loss: 0.5680, instance_loss: 0.5546, weighted_loss: 0.5640, label: 2, bag_size: 770batch 1900, loss: 0.1266, instance_loss: 0.4245, weighted_loss: 0.2160, label: 2, bag_size: 331batch 2000, loss: 0.5924, instance_loss: 0.4239, weighted_loss: 0.5419, label: 1, bag_size: 1381batch 2100, loss: 0.2295, instance_loss: 0.3539, weighted_loss: 0.2668, label: 2, bag_size: 308Instance Classifier Statsclass 0 clustering acc 0.9850950460829493: correct 68405/69440class 1 clustering acc 0.4671658986175115: correct 8110/17360Epoch: 35, train_loss: 0.3118, train_clustering_loss:  0.3488, train_error: 0.0972class 0: acc 0.5909090909090909, correct 26/44 class 1: acc 0.9040920716112532, correct 707/782 class 2: acc 0.9576816927322908, correct 1041/1087 class 3: acc 0.7198443579766537, correct 185/257 Overall Accuracy: 0.9028
Val Set, val_loss: 0.9996, auc: 0.7543 class 0 clustering acc 0.9760890151515151: correct 8246/8448 class 1 clustering acc 0.4493371212121212: correct 949/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.7611940298507462, correct 102/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6705Overall F1 Score: 0.4452Training for coarse level...batch 100, loss: 0.3929, instance_loss: 0.6875, weighted_loss: 0.4813, label: 0, bag_size: 419batch 200, loss: 0.1133, instance_loss: 0.2255, weighted_loss: 0.1470, label: 1, bag_size: 605batch 300, loss: 0.1407, instance_loss: 0.4569, weighted_loss: 0.2355, label: 3, bag_size: 665batch 400, loss: 0.0076, instance_loss: 0.0150, weighted_loss: 0.0098, label: 1, bag_size: 1673batch 500, loss: 0.2636, instance_loss: 0.5238, weighted_loss: 0.3417, label: 1, bag_size: 271batch 600, loss: 0.0156, instance_loss: 0.7875, weighted_loss: 0.2472, label: 1, bag_size: 98batch 700, loss: 0.0019, instance_loss: 0.0288, weighted_loss: 0.0099, label: 2, bag_size: 290batch 800, loss: 0.3743, instance_loss: 0.2614, weighted_loss: 0.3405, label: 2, bag_size: 481batch 900, loss: 0.0249, instance_loss: 0.2238, weighted_loss: 0.0846, label: 2, bag_size: 346batch 1000, loss: 0.1518, instance_loss: 0.9444, weighted_loss: 0.3896, label: 1, bag_size: 530batch 1100, loss: 0.0870, instance_loss: 0.2510, weighted_loss: 0.1362, label: 2, bag_size: 1865batch 1200, loss: 0.5931, instance_loss: 0.4786, weighted_loss: 0.5587, label: 1, bag_size: 454batch 1300, loss: 0.6425, instance_loss: 0.7615, weighted_loss: 0.6782, label: 3, bag_size: 2244batch 1400, loss: 0.3651, instance_loss: 0.5366, weighted_loss: 0.4166, label: 2, bag_size: 182batch 1500, loss: 0.1372, instance_loss: 0.0701, weighted_loss: 0.1171, label: 1, bag_size: 1847batch 1600, loss: 0.1571, instance_loss: 0.1759, weighted_loss: 0.1627, label: 2, bag_size: 351batch 1700, loss: 0.0011, instance_loss: 0.0343, weighted_loss: 0.0110, label: 2, bag_size: 866batch 1800, loss: 0.1272, instance_loss: 0.4908, weighted_loss: 0.2363, label: 3, bag_size: 478batch 1900, loss: 1.8196, instance_loss: 0.6197, weighted_loss: 1.4596, label: 1, bag_size: 568batch 2000, loss: 1.2099, instance_loss: 0.6755, weighted_loss: 1.0496, label: 0, bag_size: 212batch 2100, loss: 0.0271, instance_loss: 0.0311, weighted_loss: 0.0283, label: 2, bag_size: 902Instance Classifier Statsclass 0 clustering acc 0.9849654377880185: correct 68396/69440class 1 clustering acc 0.47102534562211984: correct 8177/17360Epoch: 36, train_loss: 0.2998, train_clustering_loss:  0.3501, train_error: 0.0889class 0: acc 0.6363636363636364, correct 28/44 class 1: acc 0.9092071611253197, correct 711/782 class 2: acc 0.9632014719411224, correct 1047/1087 class 3: acc 0.7431906614785992, correct 191/257 Overall Accuracy: 0.9111
Val Set, val_loss: 1.0342, auc: 0.7261 class 0 clustering acc 0.9750236742424242: correct 8237/8448 class 1 clustering acc 0.4498106060606061: correct 950/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.7164179104477612, correct 96/134 class 3: acc 0.36666666666666664, correct 11/30 Overall Accuracy: 0.6515Overall F1 Score: 0.4431Training for coarse level...batch 100, loss: 0.0053, instance_loss: 0.0256, weighted_loss: 0.0114, label: 1, bag_size: 260batch 200, loss: 0.0452, instance_loss: 0.0587, weighted_loss: 0.0492, label: 1, bag_size: 1049batch 300, loss: 0.0010, instance_loss: 0.0312, weighted_loss: 0.0101, label: 2, bag_size: 249batch 400, loss: 0.0810, instance_loss: 0.5680, weighted_loss: 0.2271, label: 3, bag_size: 479batch 500, loss: 0.0010, instance_loss: 0.0256, weighted_loss: 0.0084, label: 2, bag_size: 416batch 600, loss: 0.0171, instance_loss: 0.0204, weighted_loss: 0.0181, label: 1, bag_size: 1981batch 700, loss: 0.0943, instance_loss: 0.3194, weighted_loss: 0.1618, label: 2, bag_size: 641batch 800, loss: 0.0024, instance_loss: 0.0693, weighted_loss: 0.0224, label: 2, bag_size: 765batch 900, loss: 0.2359, instance_loss: 0.3838, weighted_loss: 0.2803, label: 2, bag_size: 337batch 1000, loss: 3.4810, instance_loss: 1.8903, weighted_loss: 3.0038, label: 3, bag_size: 1875batch 1100, loss: 0.1025, instance_loss: 0.5059, weighted_loss: 0.2235, label: 2, bag_size: 259batch 1200, loss: 0.5960, instance_loss: 0.5202, weighted_loss: 0.5732, label: 2, bag_size: 968batch 1300, loss: 0.0296, instance_loss: 0.2780, weighted_loss: 0.1041, label: 2, bag_size: 459batch 1400, loss: 0.3648, instance_loss: 0.4631, weighted_loss: 0.3942, label: 3, bag_size: 312batch 1500, loss: 1.1762, instance_loss: 0.6589, weighted_loss: 1.0210, label: 2, bag_size: 537batch 1600, loss: 0.0014, instance_loss: 0.2545, weighted_loss: 0.0773, label: 2, bag_size: 209batch 1700, loss: 0.0639, instance_loss: 0.0573, weighted_loss: 0.0620, label: 1, bag_size: 357batch 1800, loss: 1.0140, instance_loss: 0.6488, weighted_loss: 0.9044, label: 3, bag_size: 478batch 1900, loss: 0.0480, instance_loss: 0.0890, weighted_loss: 0.0603, label: 2, bag_size: 225batch 2000, loss: 0.0024, instance_loss: 0.0525, weighted_loss: 0.0174, label: 1, bag_size: 292batch 2100, loss: 0.7247, instance_loss: 0.3644, weighted_loss: 0.6166, label: 2, bag_size: 485Instance Classifier Statsclass 0 clustering acc 0.9852390552995391: correct 68415/69440class 1 clustering acc 0.4660714285714286: correct 8091/17360Epoch: 37, train_loss: 0.2927, train_clustering_loss:  0.3493, train_error: 0.0926class 0: acc 0.6590909090909091, correct 29/44 class 1: acc 0.9168797953964194, correct 717/782 class 2: acc 0.953081876724931, correct 1036/1087 class 3: acc 0.7276264591439688, correct 187/257 Overall Accuracy: 0.9074
Val Set, val_loss: 1.0231, auc: 0.7529 class 0 clustering acc 0.9737215909090909: correct 8226/8448 class 1 clustering acc 0.4635416666666667: correct 979/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.65625, correct 63/96 class 2: acc 0.753731343283582, correct 101/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6591Overall F1 Score: 0.4412Training for coarse level...batch 100, loss: 0.0147, instance_loss: 0.2001, weighted_loss: 0.0704, label: 2, bag_size: 408batch 200, loss: 4.9074, instance_loss: 0.4731, weighted_loss: 3.5771, label: 2, bag_size: 148batch 300, loss: 0.0834, instance_loss: 0.1066, weighted_loss: 0.0904, label: 1, bag_size: 177batch 400, loss: 0.0678, instance_loss: 0.5176, weighted_loss: 0.2028, label: 1, bag_size: 262batch 500, loss: 0.0251, instance_loss: 0.4625, weighted_loss: 0.1563, label: 2, bag_size: 206batch 600, loss: 0.0003, instance_loss: 0.0236, weighted_loss: 0.0073, label: 2, bag_size: 312batch 700, loss: 0.2762, instance_loss: 0.4080, weighted_loss: 0.3157, label: 1, bag_size: 238batch 800, loss: 0.0164, instance_loss: 0.1580, weighted_loss: 0.0589, label: 2, bag_size: 545batch 900, loss: 0.8800, instance_loss: 0.3132, weighted_loss: 0.7100, label: 2, bag_size: 386batch 1000, loss: 0.2617, instance_loss: 0.5626, weighted_loss: 0.3520, label: 3, bag_size: 628batch 1100, loss: 0.1431, instance_loss: 0.1974, weighted_loss: 0.1594, label: 2, bag_size: 954batch 1200, loss: 1.0549, instance_loss: 0.6850, weighted_loss: 0.9439, label: 3, bag_size: 149batch 1300, loss: 0.6686, instance_loss: 0.6789, weighted_loss: 0.6717, label: 1, bag_size: 394batch 1400, loss: 0.0461, instance_loss: 0.1112, weighted_loss: 0.0656, label: 1, bag_size: 506batch 1500, loss: 0.1498, instance_loss: 0.7502, weighted_loss: 0.3299, label: 3, bag_size: 274batch 1600, loss: 0.0017, instance_loss: 0.0335, weighted_loss: 0.0113, label: 2, bag_size: 658batch 1700, loss: 0.4362, instance_loss: 0.4193, weighted_loss: 0.4311, label: 1, bag_size: 65batch 1800, loss: 0.1619, instance_loss: 0.5575, weighted_loss: 0.2806, label: 1, bag_size: 2019batch 1900, loss: 0.0481, instance_loss: 0.1092, weighted_loss: 0.0664, label: 2, bag_size: 796batch 2000, loss: 0.0034, instance_loss: 0.0286, weighted_loss: 0.0110, label: 2, bag_size: 539batch 2100, loss: 0.1850, instance_loss: 0.2981, weighted_loss: 0.2189, label: 1, bag_size: 1616Instance Classifier Statsclass 0 clustering acc 0.9846486175115208: correct 68374/69440class 1 clustering acc 0.470852534562212: correct 8174/17360Epoch: 38, train_loss: 0.2720, train_clustering_loss:  0.3485, train_error: 0.0779class 0: acc 0.6590909090909091, correct 29/44 class 1: acc 0.9245524296675192, correct 723/782 class 2: acc 0.9613615455381784, correct 1045/1087 class 3: acc 0.7937743190661478, correct 204/257 Overall Accuracy: 0.9221
Val Set, val_loss: 1.0481, auc: 0.7209 class 0 clustering acc 0.9744318181818182: correct 8232/8448 class 1 clustering acc 0.45454545454545453: correct 960/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6875, correct 66/96 class 2: acc 0.7238805970149254, correct 97/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6515Overall F1 Score: 0.4326Training for coarse level...batch 100, loss: 0.0046, instance_loss: 0.0333, weighted_loss: 0.0133, label: 2, bag_size: 815batch 200, loss: 0.1796, instance_loss: 0.6750, weighted_loss: 0.3282, label: 1, bag_size: 952batch 300, loss: 0.0125, instance_loss: 0.2871, weighted_loss: 0.0949, label: 2, bag_size: 279batch 400, loss: 0.0342, instance_loss: 0.0665, weighted_loss: 0.0439, label: 1, bag_size: 214batch 500, loss: 0.1053, instance_loss: 0.4762, weighted_loss: 0.2166, label: 2, bag_size: 644batch 600, loss: 0.2606, instance_loss: 0.3591, weighted_loss: 0.2902, label: 2, bag_size: 2209batch 700, loss: 0.0693, instance_loss: 0.2652, weighted_loss: 0.1281, label: 2, bag_size: 1043batch 800, loss: 0.0004, instance_loss: 0.0564, weighted_loss: 0.0172, label: 2, bag_size: 324batch 900, loss: 0.0269, instance_loss: 0.0495, weighted_loss: 0.0337, label: 1, bag_size: 836batch 1000, loss: 0.0018, instance_loss: 0.0205, weighted_loss: 0.0074, label: 2, bag_size: 266batch 1100, loss: 1.6463, instance_loss: 0.5852, weighted_loss: 1.3280, label: 2, bag_size: 281batch 1200, loss: 0.1070, instance_loss: 0.0648, weighted_loss: 0.0943, label: 1, bag_size: 224batch 1300, loss: 0.2735, instance_loss: 0.5457, weighted_loss: 0.3552, label: 3, bag_size: 665batch 1400, loss: 1.5050, instance_loss: 0.6963, weighted_loss: 1.2624, label: 1, bag_size: 446batch 1500, loss: 0.1038, instance_loss: 0.5088, weighted_loss: 0.2253, label: 1, bag_size: 823batch 1600, loss: 0.0177, instance_loss: 0.1545, weighted_loss: 0.0587, label: 1, bag_size: 185batch 1700, loss: 0.0007, instance_loss: 0.0634, weighted_loss: 0.0195, label: 2, bag_size: 206batch 1800, loss: 0.1585, instance_loss: 0.3972, weighted_loss: 0.2301, label: 1, bag_size: 324batch 1900, loss: 0.0006, instance_loss: 0.0183, weighted_loss: 0.0059, label: 2, bag_size: 296batch 2000, loss: 0.0295, instance_loss: 0.0260, weighted_loss: 0.0285, label: 2, bag_size: 201batch 2100, loss: 0.7412, instance_loss: 0.6369, weighted_loss: 0.7099, label: 1, bag_size: 250Instance Classifier Statsclass 0 clustering acc 0.9844758064516129: correct 68362/69440class 1 clustering acc 0.47453917050691247: correct 8238/17360Epoch: 39, train_loss: 0.2616, train_clustering_loss:  0.3473, train_error: 0.0770class 0: acc 0.6818181818181818, correct 30/44 class 1: acc 0.9258312020460358, correct 724/782 class 2: acc 0.9641214351425943, correct 1048/1087 class 3: acc 0.7821011673151751, correct 201/257 Overall Accuracy: 0.9230
Val Set, val_loss: 1.0262, auc: 0.7621 class 0 clustering acc 0.97265625: correct 8217/8448 class 1 clustering acc 0.4616477272727273: correct 975/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6875, correct 66/96 class 2: acc 0.7611940298507462, correct 102/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6742Overall F1 Score: 0.4504Training for coarse level...batch 100, loss: 0.1112, instance_loss: 0.3983, weighted_loss: 0.1973, label: 2, bag_size: 641batch 200, loss: 0.4344, instance_loss: 0.5881, weighted_loss: 0.4805, label: 1, bag_size: 411batch 300, loss: 0.4158, instance_loss: 0.4620, weighted_loss: 0.4296, label: 2, bag_size: 338batch 400, loss: 0.6084, instance_loss: 0.6921, weighted_loss: 0.6335, label: 3, bag_size: 151batch 500, loss: 2.7700, instance_loss: 1.0932, weighted_loss: 2.2670, label: 2, bag_size: 444batch 600, loss: 0.1312, instance_loss: 0.2314, weighted_loss: 0.1613, label: 2, bag_size: 847batch 700, loss: 0.6765, instance_loss: 0.3151, weighted_loss: 0.5681, label: 2, bag_size: 147batch 800, loss: 0.1847, instance_loss: 0.2466, weighted_loss: 0.2032, label: 2, bag_size: 838batch 900, loss: 0.2947, instance_loss: 0.5250, weighted_loss: 0.3638, label: 3, bag_size: 168batch 1000, loss: 0.0612, instance_loss: 0.3582, weighted_loss: 0.1503, label: 1, bag_size: 1120batch 1100, loss: 0.1620, instance_loss: 0.3563, weighted_loss: 0.2203, label: 2, bag_size: 284batch 1200, loss: 0.0082, instance_loss: 0.0115, weighted_loss: 0.0092, label: 1, bag_size: 1226batch 1300, loss: 0.1823, instance_loss: 0.1117, weighted_loss: 0.1611, label: 2, bag_size: 422batch 1400, loss: 0.5842, instance_loss: 0.6334, weighted_loss: 0.5989, label: 3, bag_size: 1555batch 1500, loss: 1.9827, instance_loss: 0.7987, weighted_loss: 1.6275, label: 1, bag_size: 407batch 1600, loss: 0.0197, instance_loss: 0.0581, weighted_loss: 0.0312, label: 1, bag_size: 2030batch 1700, loss: 0.0052, instance_loss: 0.0347, weighted_loss: 0.0141, label: 2, bag_size: 1239batch 1800, loss: 5.2526, instance_loss: 1.8244, weighted_loss: 4.2241, label: 3, bag_size: 1009batch 1900, loss: 0.7700, instance_loss: 0.7593, weighted_loss: 0.7668, label: 1, bag_size: 115batch 2000, loss: 0.0079, instance_loss: 0.0493, weighted_loss: 0.0203, label: 2, bag_size: 254batch 2100, loss: 0.4388, instance_loss: 0.1501, weighted_loss: 0.3522, label: 2, bag_size: 849Instance Classifier Statsclass 0 clustering acc 0.9840293778801843: correct 68331/69440class 1 clustering acc 0.47632488479262675: correct 8269/17360Epoch: 40, train_loss: 0.2465, train_clustering_loss:  0.3474, train_error: 0.0668class 0: acc 0.6818181818181818, correct 30/44 class 1: acc 0.9398976982097187, correct 735/782 class 2: acc 0.9742410303587856, correct 1059/1087 class 3: acc 0.7821011673151751, correct 201/257 Overall Accuracy: 0.9332
Val Set, val_loss: 1.0893, auc: 0.7376 class 0 clustering acc 0.9739583333333334: correct 8228/8448 class 1 clustering acc 0.4521780303030303: correct 955/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6979166666666666, correct 67/96 class 2: acc 0.7014925373134329, correct 94/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6477Overall F1 Score: 0.4343Training for coarse level...batch 100, loss: 0.2333, instance_loss: 0.4764, weighted_loss: 0.3062, label: 2, bag_size: 30batch 200, loss: 0.0205, instance_loss: 0.0532, weighted_loss: 0.0303, label: 1, bag_size: 786batch 300, loss: 0.0030, instance_loss: 0.0328, weighted_loss: 0.0120, label: 2, bag_size: 1330batch 400, loss: 0.5545, instance_loss: 0.1451, weighted_loss: 0.4316, label: 1, bag_size: 1052batch 500, loss: 0.0102, instance_loss: 0.0667, weighted_loss: 0.0271, label: 2, bag_size: 599batch 600, loss: 1.0901, instance_loss: 0.4178, weighted_loss: 0.8884, label: 2, bag_size: 450batch 700, loss: 0.3613, instance_loss: 0.5176, weighted_loss: 0.4082, label: 2, bag_size: 506batch 800, loss: 0.0829, instance_loss: 0.4379, weighted_loss: 0.1894, label: 2, bag_size: 1564batch 900, loss: 0.1129, instance_loss: 0.4629, weighted_loss: 0.2179, label: 1, bag_size: 1144batch 1000, loss: 0.1344, instance_loss: 0.4042, weighted_loss: 0.2154, label: 2, bag_size: 590batch 1100, loss: 0.0006, instance_loss: 0.0578, weighted_loss: 0.0178, label: 2, bag_size: 292batch 1200, loss: 0.7482, instance_loss: 0.7051, weighted_loss: 0.7352, label: 1, bag_size: 398batch 1300, loss: 0.8451, instance_loss: 0.5764, weighted_loss: 0.7645, label: 1, bag_size: 862batch 1400, loss: 0.5980, instance_loss: 0.6302, weighted_loss: 0.6077, label: 1, bag_size: 347batch 1500, loss: 0.9520, instance_loss: 0.7004, weighted_loss: 0.8765, label: 3, bag_size: 901batch 1600, loss: 1.7015, instance_loss: 1.1339, weighted_loss: 1.5312, label: 3, bag_size: 2813batch 1700, loss: 0.7885, instance_loss: 0.6409, weighted_loss: 0.7442, label: 2, bag_size: 231batch 1800, loss: 0.0035, instance_loss: 0.0145, weighted_loss: 0.0068, label: 2, bag_size: 1161batch 1900, loss: 0.0454, instance_loss: 0.2065, weighted_loss: 0.0937, label: 2, bag_size: 91batch 2000, loss: 0.0026, instance_loss: 0.0791, weighted_loss: 0.0255, label: 1, bag_size: 292batch 2100, loss: 0.7043, instance_loss: 0.5863, weighted_loss: 0.6689, label: 3, bag_size: 435Instance Classifier Statsclass 0 clustering acc 0.9856710829493087: correct 68445/69440class 1 clustering acc 0.4758640552995392: correct 8261/17360Epoch: 41, train_loss: 0.2387, train_clustering_loss:  0.3427, train_error: 0.0677class 0: acc 0.75, correct 33/44 class 1: acc 0.9514066496163683, correct 744/782 class 2: acc 0.9622815087396505, correct 1046/1087 class 3: acc 0.7782101167315175, correct 200/257 Overall Accuracy: 0.9323
Val Set, val_loss: 1.1176, auc: 0.7334 class 0 clustering acc 0.9712357954545454: correct 8205/8448 class 1 clustering acc 0.46117424242424243: correct 974/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6666666666666666, correct 64/96 class 2: acc 0.7686567164179104, correct 103/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6667Overall F1 Score: 0.4381Training for coarse level...batch 100, loss: 0.0424, instance_loss: 0.4087, weighted_loss: 0.1523, label: 3, bag_size: 307batch 200, loss: 0.0012, instance_loss: 0.0272, weighted_loss: 0.0090, label: 1, bag_size: 1490batch 300, loss: 1.2742, instance_loss: 0.4765, weighted_loss: 1.0349, label: 1, bag_size: 371batch 400, loss: 0.2177, instance_loss: 0.7816, weighted_loss: 0.3869, label: 2, bag_size: 201batch 500, loss: 0.3169, instance_loss: 0.8967, weighted_loss: 0.4909, label: 1, bag_size: 566batch 600, loss: 0.0329, instance_loss: 0.0547, weighted_loss: 0.0394, label: 1, bag_size: 1397batch 700, loss: 0.2159, instance_loss: 0.3095, weighted_loss: 0.2440, label: 2, bag_size: 273batch 800, loss: 0.0094, instance_loss: 0.4407, weighted_loss: 0.1388, label: 3, bag_size: 464batch 900, loss: 0.0764, instance_loss: 0.3962, weighted_loss: 0.1723, label: 2, bag_size: 390batch 1000, loss: 0.0033, instance_loss: 0.0244, weighted_loss: 0.0096, label: 2, bag_size: 371batch 1100, loss: 0.0131, instance_loss: 0.3846, weighted_loss: 0.1245, label: 3, bag_size: 619batch 1200, loss: 0.0014, instance_loss: 0.0529, weighted_loss: 0.0169, label: 2, bag_size: 576batch 1300, loss: 0.0065, instance_loss: 0.0720, weighted_loss: 0.0261, label: 1, bag_size: 955batch 1400, loss: 0.0082, instance_loss: 0.0081, weighted_loss: 0.0082, label: 1, bag_size: 3615batch 1500, loss: 0.7849, instance_loss: 0.6430, weighted_loss: 0.7423, label: 1, bag_size: 205batch 1600, loss: 0.0007, instance_loss: 0.0177, weighted_loss: 0.0058, label: 2, bag_size: 668batch 1700, loss: 1.5769, instance_loss: 0.5637, weighted_loss: 1.2729, label: 1, bag_size: 119batch 1800, loss: 0.0054, instance_loss: 0.0501, weighted_loss: 0.0188, label: 2, bag_size: 728batch 1900, loss: 0.0113, instance_loss: 0.0411, weighted_loss: 0.0202, label: 1, bag_size: 3550batch 2000, loss: 0.0042, instance_loss: 0.1090, weighted_loss: 0.0356, label: 2, bag_size: 607batch 2100, loss: 0.0704, instance_loss: 0.1718, weighted_loss: 0.1008, label: 1, bag_size: 1269Instance Classifier Statsclass 0 clustering acc 0.9840869815668203: correct 68335/69440class 1 clustering acc 0.4796082949308756: correct 8326/17360Epoch: 42, train_loss: 0.2275, train_clustering_loss:  0.3453, train_error: 0.0641class 0: acc 0.6818181818181818, correct 30/44 class 1: acc 0.9462915601023018, correct 740/782 class 2: acc 0.9760809567617296, correct 1061/1087 class 3: acc 0.7782101167315175, correct 200/257 Overall Accuracy: 0.9359
Val Set, val_loss: 1.0942, auc: 0.7457 class 0 clustering acc 0.9762073863636364: correct 8247/8448 class 1 clustering acc 0.44365530303030304: correct 937/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6979166666666666, correct 67/96 class 2: acc 0.7089552238805971, correct 95/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6477Overall F1 Score: 0.4267Training for coarse level...batch 100, loss: 0.1772, instance_loss: 0.3432, weighted_loss: 0.2270, label: 2, bag_size: 867batch 200, loss: 0.0026, instance_loss: 0.0462, weighted_loss: 0.0157, label: 2, bag_size: 432batch 300, loss: 0.0545, instance_loss: 0.2025, weighted_loss: 0.0989, label: 2, bag_size: 389batch 400, loss: 0.0921, instance_loss: 0.0616, weighted_loss: 0.0829, label: 2, bag_size: 353batch 500, loss: 0.0114, instance_loss: 0.3220, weighted_loss: 0.1046, label: 1, bag_size: 837batch 600, loss: 0.1564, instance_loss: 0.5476, weighted_loss: 0.2737, label: 3, bag_size: 489batch 700, loss: 0.0053, instance_loss: 0.0304, weighted_loss: 0.0128, label: 1, bag_size: 304batch 800, loss: 0.1413, instance_loss: 0.3537, weighted_loss: 0.2050, label: 2, bag_size: 743batch 900, loss: 0.4623, instance_loss: 0.4347, weighted_loss: 0.4541, label: 2, bag_size: 566batch 1000, loss: 0.0379, instance_loss: 0.4302, weighted_loss: 0.1556, label: 2, bag_size: 377batch 1100, loss: 0.0020, instance_loss: 0.0815, weighted_loss: 0.0259, label: 2, bag_size: 705batch 1200, loss: 0.1199, instance_loss: 0.4725, weighted_loss: 0.2257, label: 2, bag_size: 401batch 1300, loss: 0.0014, instance_loss: 0.5123, weighted_loss: 0.1547, label: 2, bag_size: 146batch 1400, loss: 0.0130, instance_loss: 0.0852, weighted_loss: 0.0347, label: 2, bag_size: 887batch 1500, loss: 0.0327, instance_loss: 0.3956, weighted_loss: 0.1416, label: 0, bag_size: 101batch 1600, loss: 0.0576, instance_loss: 0.4721, weighted_loss: 0.1820, label: 2, bag_size: 405batch 1700, loss: 0.0158, instance_loss: 0.5423, weighted_loss: 0.1737, label: 1, bag_size: 1223batch 1800, loss: 0.0104, instance_loss: 0.0730, weighted_loss: 0.0292, label: 1, bag_size: 1534batch 1900, loss: 0.0159, instance_loss: 0.0375, weighted_loss: 0.0224, label: 2, bag_size: 656batch 2000, loss: 0.2759, instance_loss: 0.4537, weighted_loss: 0.3293, label: 1, bag_size: 738batch 2100, loss: 0.0154, instance_loss: 0.1240, weighted_loss: 0.0480, label: 2, bag_size: 620Instance Classifier Statsclass 0 clustering acc 0.9845478110599079: correct 68367/69440class 1 clustering acc 0.48254608294930873: correct 8377/17360Epoch: 43, train_loss: 0.2085, train_clustering_loss:  0.3431, train_error: 0.0576class 0: acc 0.7727272727272727, correct 34/44 class 1: acc 0.9514066496163683, correct 744/782 class 2: acc 0.9760809567617296, correct 1061/1087 class 3: acc 0.8015564202334631, correct 206/257 Overall Accuracy: 0.9424
Val Set, val_loss: 1.0784, auc: 0.7491 class 0 clustering acc 0.9725378787878788: correct 8216/8448 class 1 clustering acc 0.4602272727272727: correct 972/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6979166666666666, correct 67/96 class 2: acc 0.7238805970149254, correct 97/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6591Overall F1 Score: 0.4386Training for coarse level...batch 100, loss: 0.0098, instance_loss: 0.1275, weighted_loss: 0.0451, label: 1, bag_size: 862batch 200, loss: 0.0594, instance_loss: 0.1462, weighted_loss: 0.0855, label: 1, bag_size: 3773batch 300, loss: 0.5757, instance_loss: 0.4933, weighted_loss: 0.5510, label: 2, bag_size: 409batch 400, loss: 0.2899, instance_loss: 0.9105, weighted_loss: 0.4761, label: 3, bag_size: 542batch 500, loss: 0.0283, instance_loss: 0.1083, weighted_loss: 0.0523, label: 1, bag_size: 1567batch 600, loss: 0.5218, instance_loss: 0.1665, weighted_loss: 0.4152, label: 2, bag_size: 649batch 700, loss: 0.0045, instance_loss: 0.0565, weighted_loss: 0.0201, label: 2, bag_size: 562batch 800, loss: 1.3625, instance_loss: 1.1011, weighted_loss: 1.2841, label: 3, bag_size: 2813batch 900, loss: 0.6401, instance_loss: 0.9994, weighted_loss: 0.7479, label: 0, bag_size: 313batch 1000, loss: 0.0382, instance_loss: 0.5074, weighted_loss: 0.1790, label: 3, bag_size: 120batch 1100, loss: 0.0849, instance_loss: 0.4187, weighted_loss: 0.1850, label: 2, bag_size: 299batch 1200, loss: 0.6811, instance_loss: 0.3746, weighted_loss: 0.5892, label: 2, bag_size: 370batch 1300, loss: 0.0163, instance_loss: 0.0145, weighted_loss: 0.0158, label: 1, bag_size: 1445batch 1400, loss: 0.0588, instance_loss: 0.9697, weighted_loss: 0.3320, label: 1, bag_size: 170batch 1500, loss: 0.1744, instance_loss: 0.4053, weighted_loss: 0.2437, label: 1, bag_size: 1006batch 1600, loss: 0.2198, instance_loss: 0.3934, weighted_loss: 0.2719, label: 1, bag_size: 975batch 1700, loss: 0.4323, instance_loss: 0.4900, weighted_loss: 0.4497, label: 1, bag_size: 303batch 1800, loss: 1.2969, instance_loss: 0.7119, weighted_loss: 1.1214, label: 3, bag_size: 1001batch 1900, loss: 0.6952, instance_loss: 0.9669, weighted_loss: 0.7767, label: 3, bag_size: 558batch 2000, loss: 0.0471, instance_loss: 0.0388, weighted_loss: 0.0446, label: 1, bag_size: 650batch 2100, loss: 0.1387, instance_loss: 0.3358, weighted_loss: 0.1978, label: 2, bag_size: 317Instance Classifier Statsclass 0 clustering acc 0.9845046082949309: correct 68364/69440class 1 clustering acc 0.48076036866359445: correct 8346/17360Epoch: 44, train_loss: 0.2010, train_clustering_loss:  0.3424, train_error: 0.0567class 0: acc 0.8181818181818182, correct 36/44 class 1: acc 0.9475703324808185, correct 741/782 class 2: acc 0.9733210671573137, correct 1058/1087 class 3: acc 0.8249027237354085, correct 212/257 Overall Accuracy: 0.9433
Val Set, val_loss: 1.0826, auc: 0.7708 class 0 clustering acc 0.9744318181818182: correct 8232/8448 class 1 clustering acc 0.45075757575757575: correct 952/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.7611940298507462, correct 102/134 class 3: acc 0.36666666666666664, correct 11/30 Overall Accuracy: 0.6742Overall F1 Score: 0.4555Training for coarse level...batch 100, loss: 0.0148, instance_loss: 0.1764, weighted_loss: 0.0633, label: 2, bag_size: 375batch 200, loss: 0.2990, instance_loss: 0.4069, weighted_loss: 0.3314, label: 2, bag_size: 104batch 300, loss: 0.0799, instance_loss: 0.6328, weighted_loss: 0.2457, label: 2, bag_size: 509batch 400, loss: 0.1600, instance_loss: 0.2372, weighted_loss: 0.1832, label: 2, bag_size: 578batch 500, loss: 0.0127, instance_loss: 0.0649, weighted_loss: 0.0283, label: 2, bag_size: 458batch 600, loss: 0.0186, instance_loss: 0.0630, weighted_loss: 0.0319, label: 2, bag_size: 887batch 700, loss: 0.1050, instance_loss: 0.5315, weighted_loss: 0.2330, label: 3, bag_size: 307batch 800, loss: 0.1705, instance_loss: 0.5443, weighted_loss: 0.2826, label: 0, bag_size: 235batch 900, loss: 5.9089, instance_loss: 1.7867, weighted_loss: 4.6722, label: 1, bag_size: 477batch 1000, loss: 0.1576, instance_loss: 0.5118, weighted_loss: 0.2638, label: 2, bag_size: 387batch 1100, loss: 0.0006, instance_loss: 0.0248, weighted_loss: 0.0078, label: 2, bag_size: 457batch 1200, loss: 0.0044, instance_loss: 0.1198, weighted_loss: 0.0390, label: 2, bag_size: 364batch 1300, loss: 0.0152, instance_loss: 0.0396, weighted_loss: 0.0225, label: 1, bag_size: 1353batch 1400, loss: 0.0525, instance_loss: 0.5990, weighted_loss: 0.2165, label: 1, bag_size: 267batch 1500, loss: 0.0015, instance_loss: 0.0176, weighted_loss: 0.0064, label: 2, bag_size: 346batch 1600, loss: 0.0009, instance_loss: 0.3081, weighted_loss: 0.0931, label: 2, bag_size: 209batch 1700, loss: 5.4271, instance_loss: 1.7385, weighted_loss: 4.3205, label: 3, bag_size: 1009batch 1800, loss: 0.1088, instance_loss: 0.0818, weighted_loss: 0.1007, label: 2, bag_size: 451batch 1900, loss: 0.0002, instance_loss: 0.0745, weighted_loss: 0.0225, label: 2, bag_size: 337batch 2000, loss: 0.0026, instance_loss: 0.0618, weighted_loss: 0.0204, label: 2, bag_size: 686batch 2100, loss: 0.6303, instance_loss: 0.9487, weighted_loss: 0.7258, label: 1, bag_size: 475Instance Classifier Statsclass 0 clustering acc 0.9844182027649769: correct 68358/69440class 1 clustering acc 0.48024193548387095: correct 8337/17360Epoch: 45, train_loss: 0.1900, train_clustering_loss:  0.3432, train_error: 0.0530class 0: acc 0.7954545454545454, correct 35/44 class 1: acc 0.9565217391304348, correct 748/782 class 2: acc 0.9733210671573137, correct 1058/1087 class 3: acc 0.8326848249027238, correct 214/257 Overall Accuracy: 0.9470
Val Set, val_loss: 1.1584, auc: 0.7264 class 0 clustering acc 0.9721827651515151: correct 8213/8448 class 1 clustering acc 0.4474431818181818: correct 945/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.7083333333333334, correct 68/96 class 2: acc 0.7164179104477612, correct 96/134 class 3: acc 0.36666666666666664, correct 11/30 Overall Accuracy: 0.6629Overall F1 Score: 0.4501Training for coarse level...batch 100, loss: 0.0869, instance_loss: 0.0314, weighted_loss: 0.0703, label: 2, bag_size: 357batch 200, loss: 0.0005, instance_loss: 0.0250, weighted_loss: 0.0078, label: 2, bag_size: 658batch 300, loss: 0.4179, instance_loss: 0.6331, weighted_loss: 0.4825, label: 3, bag_size: 228batch 400, loss: 0.0389, instance_loss: 0.3191, weighted_loss: 0.1230, label: 2, bag_size: 435batch 500, loss: 0.0036, instance_loss: 0.2619, weighted_loss: 0.0811, label: 1, bag_size: 202batch 600, loss: 0.0829, instance_loss: 0.4742, weighted_loss: 0.2003, label: 2, bag_size: 311batch 700, loss: 0.0683, instance_loss: 0.2337, weighted_loss: 0.1179, label: 1, bag_size: 2047batch 800, loss: 0.0277, instance_loss: 0.2963, weighted_loss: 0.1083, label: 1, bag_size: 135batch 900, loss: 0.0012, instance_loss: 0.0426, weighted_loss: 0.0136, label: 1, bag_size: 1958batch 1000, loss: 0.1136, instance_loss: 0.5252, weighted_loss: 0.2371, label: 1, bag_size: 592batch 1100, loss: 0.4555, instance_loss: 0.6372, weighted_loss: 0.5100, label: 0, bag_size: 220batch 1200, loss: 0.0044, instance_loss: 0.0428, weighted_loss: 0.0159, label: 1, bag_size: 1046batch 1300, loss: 0.0239, instance_loss: 0.3691, weighted_loss: 0.1274, label: 2, bag_size: 1655batch 1400, loss: 0.0040, instance_loss: 0.0552, weighted_loss: 0.0193, label: 2, bag_size: 974batch 1500, loss: 0.0585, instance_loss: 0.3676, weighted_loss: 0.1512, label: 1, bag_size: 774batch 1600, loss: 0.0261, instance_loss: 0.2877, weighted_loss: 0.1046, label: 2, bag_size: 1135batch 1700, loss: 0.0135, instance_loss: 0.0374, weighted_loss: 0.0207, label: 2, bag_size: 1211batch 1800, loss: 0.0055, instance_loss: 0.0562, weighted_loss: 0.0207, label: 1, bag_size: 795batch 1900, loss: 0.0289, instance_loss: 0.0747, weighted_loss: 0.0426, label: 2, bag_size: 341batch 2000, loss: 0.0312, instance_loss: 0.0320, weighted_loss: 0.0315, label: 1, bag_size: 1549batch 2100, loss: 0.1400, instance_loss: 0.4132, weighted_loss: 0.2219, label: 1, bag_size: 613Instance Classifier Statsclass 0 clustering acc 0.9843894009216589: correct 68356/69440class 1 clustering acc 0.4865207373271889: correct 8446/17360Epoch: 46, train_loss: 0.1810, train_clustering_loss:  0.3421, train_error: 0.0475class 0: acc 0.8636363636363636, correct 38/44 class 1: acc 0.9629156010230179, correct 753/782 class 2: acc 0.9733210671573137, correct 1058/1087 class 3: acc 0.8482490272373541, correct 218/257 Overall Accuracy: 0.9525
Val Set, val_loss: 1.1765, auc: 0.7135 class 0 clustering acc 0.9720643939393939: correct 8212/8448 class 1 clustering acc 0.4569128787878788: correct 965/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6979166666666666, correct 67/96 class 2: acc 0.7761194029850746, correct 104/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6818Overall F1 Score: 0.4475Training for coarse level...batch 100, loss: 0.0319, instance_loss: 0.4901, weighted_loss: 0.1694, label: 1, bag_size: 162batch 200, loss: 0.0017, instance_loss: 0.0404, weighted_loss: 0.0133, label: 1, bag_size: 904batch 300, loss: 0.0227, instance_loss: 0.4226, weighted_loss: 0.1427, label: 2, bag_size: 1716batch 400, loss: 0.3788, instance_loss: 0.6020, weighted_loss: 0.4457, label: 1, bag_size: 187batch 500, loss: 0.0080, instance_loss: 0.0314, weighted_loss: 0.0150, label: 2, bag_size: 403batch 600, loss: 0.0248, instance_loss: 0.1275, weighted_loss: 0.0556, label: 2, bag_size: 359batch 700, loss: 0.0326, instance_loss: 0.9685, weighted_loss: 0.3133, label: 1, bag_size: 306batch 800, loss: 0.0137, instance_loss: 0.0504, weighted_loss: 0.0248, label: 2, bag_size: 330batch 900, loss: 0.7067, instance_loss: 0.4588, weighted_loss: 0.6323, label: 0, bag_size: 37batch 1000, loss: 0.0207, instance_loss: 0.3580, weighted_loss: 0.1219, label: 2, bag_size: 576batch 1100, loss: 0.0001, instance_loss: 0.0273, weighted_loss: 0.0083, label: 2, bag_size: 1015batch 1200, loss: 0.0042, instance_loss: 0.2895, weighted_loss: 0.0898, label: 2, bag_size: 552batch 1300, loss: 0.0012, instance_loss: 0.0852, weighted_loss: 0.0264, label: 2, bag_size: 422batch 1400, loss: 0.0001, instance_loss: 0.0567, weighted_loss: 0.0171, label: 2, bag_size: 605batch 1500, loss: 0.1539, instance_loss: 0.4996, weighted_loss: 0.2576, label: 0, bag_size: 482batch 1600, loss: 0.1843, instance_loss: 0.3881, weighted_loss: 0.2454, label: 2, bag_size: 348batch 1700, loss: 0.0036, instance_loss: 0.0732, weighted_loss: 0.0245, label: 1, bag_size: 554batch 1800, loss: 0.0945, instance_loss: 0.1566, weighted_loss: 0.1131, label: 1, bag_size: 510batch 1900, loss: 0.0606, instance_loss: 0.0478, weighted_loss: 0.0567, label: 1, bag_size: 813batch 2000, loss: 0.0149, instance_loss: 0.3702, weighted_loss: 0.1214, label: 1, bag_size: 637batch 2100, loss: 1.4178, instance_loss: 0.7209, weighted_loss: 1.2087, label: 1, bag_size: 634Instance Classifier Statsclass 0 clustering acc 0.9839285714285714: correct 68324/69440class 1 clustering acc 0.48559907834101385: correct 8430/17360Epoch: 47, train_loss: 0.1822, train_clustering_loss:  0.3409, train_error: 0.0498class 0: acc 0.7272727272727273, correct 32/44 class 1: acc 0.9539641943734015, correct 746/782 class 2: acc 0.9770009199632015, correct 1062/1087 class 3: acc 0.8638132295719845, correct 222/257 Overall Accuracy: 0.9502
Val Set, val_loss: 1.1727, auc: 0.7376 class 0 clustering acc 0.9731297348484849: correct 8221/8448 class 1 clustering acc 0.45075757575757575: correct 952/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.65625, correct 63/96 class 2: acc 0.7388059701492538, correct 99/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6515Overall F1 Score: 0.4352Training for coarse level...batch 100, loss: 0.0356, instance_loss: 0.0676, weighted_loss: 0.0452, label: 2, bag_size: 761batch 200, loss: 0.0535, instance_loss: 0.1480, weighted_loss: 0.0819, label: 2, bag_size: 691batch 300, loss: 0.0879, instance_loss: 0.5278, weighted_loss: 0.2199, label: 1, bag_size: 187batch 400, loss: 0.0190, instance_loss: 0.0616, weighted_loss: 0.0318, label: 1, bag_size: 480batch 500, loss: 0.2095, instance_loss: 0.6641, weighted_loss: 0.3459, label: 2, bag_size: 404batch 600, loss: 0.0361, instance_loss: 0.0971, weighted_loss: 0.0544, label: 2, bag_size: 451batch 700, loss: 0.0313, instance_loss: 0.0557, weighted_loss: 0.0386, label: 1, bag_size: 1075batch 800, loss: 0.1282, instance_loss: 0.1090, weighted_loss: 0.1224, label: 2, bag_size: 499batch 900, loss: 0.0017, instance_loss: 0.0918, weighted_loss: 0.0287, label: 1, bag_size: 1628batch 1000, loss: 0.0005, instance_loss: 0.0317, weighted_loss: 0.0098, label: 1, bag_size: 941batch 1100, loss: 0.0865, instance_loss: 0.5275, weighted_loss: 0.2188, label: 1, bag_size: 792batch 1200, loss: 0.0139, instance_loss: 0.2085, weighted_loss: 0.0723, label: 2, bag_size: 523batch 1300, loss: 0.5047, instance_loss: 1.2246, weighted_loss: 0.7207, label: 3, bag_size: 512batch 1400, loss: 0.5953, instance_loss: 0.8778, weighted_loss: 0.6801, label: 1, bag_size: 127batch 1500, loss: 0.2556, instance_loss: 0.0672, weighted_loss: 0.1990, label: 2, bag_size: 597batch 1600, loss: 0.0228, instance_loss: 0.4646, weighted_loss: 0.1553, label: 3, bag_size: 207batch 1700, loss: 0.0054, instance_loss: 0.1430, weighted_loss: 0.0467, label: 2, bag_size: 545batch 1800, loss: 0.8260, instance_loss: 0.7902, weighted_loss: 0.8153, label: 0, bag_size: 277batch 1900, loss: 0.0095, instance_loss: 0.0271, weighted_loss: 0.0148, label: 2, bag_size: 507batch 2000, loss: 0.0296, instance_loss: 0.5295, weighted_loss: 0.1796, label: 1, bag_size: 162batch 2100, loss: 0.7317, instance_loss: 0.5637, weighted_loss: 0.6813, label: 2, bag_size: 169Instance Classifier Statsclass 0 clustering acc 0.9844758064516129: correct 68362/69440class 1 clustering acc 0.49055299539170505: correct 8516/17360Epoch: 48, train_loss: 0.1610, train_clustering_loss:  0.3369, train_error: 0.0406class 0: acc 0.8409090909090909, correct 37/44 class 1: acc 0.969309462915601, correct 758/782 class 2: acc 0.9797608095676172, correct 1065/1087 class 3: acc 0.8638132295719845, correct 222/257 Overall Accuracy: 0.9594
Val Set, val_loss: 1.2106, auc: 0.7091 class 0 clustering acc 0.9727746212121212: correct 8218/8448 class 1 clustering acc 0.45265151515151514: correct 956/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.7083333333333334, correct 68/96 class 2: acc 0.7238805970149254, correct 97/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6591Overall F1 Score: 0.4336Training for coarse level...batch 100, loss: 0.1378, instance_loss: 0.1313, weighted_loss: 0.1358, label: 2, bag_size: 424batch 200, loss: 0.0177, instance_loss: 0.8619, weighted_loss: 0.2710, label: 2, bag_size: 276batch 300, loss: 0.0025, instance_loss: 0.1372, weighted_loss: 0.0429, label: 2, bag_size: 773batch 400, loss: 0.0361, instance_loss: 0.5051, weighted_loss: 0.1768, label: 1, bag_size: 823batch 500, loss: 0.0013, instance_loss: 0.2885, weighted_loss: 0.0875, label: 2, bag_size: 315batch 600, loss: 0.5247, instance_loss: 0.5913, weighted_loss: 0.5447, label: 3, bag_size: 478batch 700, loss: 0.0967, instance_loss: 0.4970, weighted_loss: 0.2168, label: 3, bag_size: 312batch 800, loss: 0.0093, instance_loss: 0.0454, weighted_loss: 0.0202, label: 1, bag_size: 3982batch 900, loss: 0.0961, instance_loss: 0.7691, weighted_loss: 0.2980, label: 3, bag_size: 542batch 1000, loss: 0.0008, instance_loss: 0.0424, weighted_loss: 0.0132, label: 2, bag_size: 238batch 1100, loss: 0.0005, instance_loss: 0.0686, weighted_loss: 0.0209, label: 2, bag_size: 226batch 1200, loss: 0.2195, instance_loss: 0.6935, weighted_loss: 0.3617, label: 3, bag_size: 481batch 1300, loss: 1.0376, instance_loss: 0.7740, weighted_loss: 0.9585, label: 1, bag_size: 529batch 1400, loss: 0.0035, instance_loss: 0.2874, weighted_loss: 0.0886, label: 1, bag_size: 900batch 1500, loss: 0.1986, instance_loss: 0.5785, weighted_loss: 0.3126, label: 1, bag_size: 183batch 1600, loss: 0.0144, instance_loss: 0.3827, weighted_loss: 0.1249, label: 1, bag_size: 473batch 1700, loss: 0.0032, instance_loss: 0.0868, weighted_loss: 0.0283, label: 2, bag_size: 193batch 1800, loss: 0.0002, instance_loss: 0.0587, weighted_loss: 0.0177, label: 2, bag_size: 576batch 1900, loss: 0.1717, instance_loss: 0.7860, weighted_loss: 0.3560, label: 1, bag_size: 424batch 2000, loss: 0.0048, instance_loss: 0.0425, weighted_loss: 0.0161, label: 2, bag_size: 887batch 2100, loss: 0.1709, instance_loss: 0.1509, weighted_loss: 0.1649, label: 1, bag_size: 1726Instance Classifier Statsclass 0 clustering acc 0.984432603686636: correct 68359/69440class 1 clustering acc 0.4925691244239631: correct 8551/17360Epoch: 49, train_loss: 0.1486, train_clustering_loss:  0.3374, train_error: 0.0373class 0: acc 0.8181818181818182, correct 36/44 class 1: acc 0.9718670076726342, correct 760/782 class 2: acc 0.9825206991720331, correct 1068/1087 class 3: acc 0.8754863813229572, correct 225/257 Overall Accuracy: 0.9627
Val Set, val_loss: 1.2525, auc: 0.7424 class 0 clustering acc 0.974313446969697: correct 8231/8448 class 1 clustering acc 0.45359848484848486: correct 958/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.6940298507462687, correct 93/134 class 3: acc 0.36666666666666664, correct 11/30 Overall Accuracy: 0.6402Overall F1 Score: 0.4316Training for coarse level...batch 100, loss: 0.0029, instance_loss: 0.0081, weighted_loss: 0.0045, label: 1, bag_size: 1771batch 200, loss: 0.0036, instance_loss: 0.3012, weighted_loss: 0.0929, label: 2, bag_size: 284batch 300, loss: 0.0126, instance_loss: 0.0517, weighted_loss: 0.0243, label: 1, bag_size: 1253batch 400, loss: 0.0012, instance_loss: 0.0222, weighted_loss: 0.0075, label: 1, bag_size: 313batch 500, loss: 0.0024, instance_loss: 0.0523, weighted_loss: 0.0174, label: 2, bag_size: 280batch 600, loss: 0.0000, instance_loss: 0.0199, weighted_loss: 0.0060, label: 2, bag_size: 266batch 700, loss: 0.0016, instance_loss: 0.1044, weighted_loss: 0.0325, label: 2, bag_size: 615batch 800, loss: 0.0218, instance_loss: 0.3793, weighted_loss: 0.1291, label: 3, bag_size: 536batch 900, loss: 0.0680, instance_loss: 0.6021, weighted_loss: 0.2283, label: 1, bag_size: 1654batch 1000, loss: 0.0765, instance_loss: 0.7370, weighted_loss: 0.2746, label: 1, bag_size: 495batch 1100, loss: 0.0745, instance_loss: 0.1784, weighted_loss: 0.1056, label: 1, bag_size: 1404batch 1200, loss: 0.0020, instance_loss: 0.0165, weighted_loss: 0.0063, label: 1, bag_size: 2536batch 1300, loss: 0.0357, instance_loss: 0.4613, weighted_loss: 0.1634, label: 2, bag_size: 621batch 1400, loss: 0.0045, instance_loss: 0.0082, weighted_loss: 0.0056, label: 1, bag_size: 1883batch 1500, loss: 0.2563, instance_loss: 0.2713, weighted_loss: 0.2608, label: 2, bag_size: 765batch 1600, loss: 0.0011, instance_loss: 0.2203, weighted_loss: 0.0669, label: 1, bag_size: 1659batch 1700, loss: 0.7841, instance_loss: 0.7834, weighted_loss: 0.7839, label: 3, bag_size: 153batch 1800, loss: 0.0011, instance_loss: 0.3917, weighted_loss: 0.1183, label: 3, bag_size: 229batch 1900, loss: 0.0659, instance_loss: 0.2123, weighted_loss: 0.1098, label: 1, bag_size: 1172batch 2000, loss: 0.0040, instance_loss: 0.3161, weighted_loss: 0.0976, label: 2, bag_size: 795batch 2100, loss: 0.0053, instance_loss: 0.0190, weighted_loss: 0.0094, label: 1, bag_size: 534Instance Classifier Statsclass 0 clustering acc 0.9836549539170507: correct 68305/69440class 1 clustering acc 0.4921082949308756: correct 8543/17360Epoch: 50, train_loss: 0.1444, train_clustering_loss:  0.3384, train_error: 0.0336class 0: acc 0.9090909090909091, correct 40/44 class 1: acc 0.9757033248081841, correct 763/782 class 2: acc 0.9797608095676172, correct 1065/1087 class 3: acc 0.8910505836575876, correct 229/257 Overall Accuracy: 0.9664
Val Set, val_loss: 1.2484, auc: 0.7378 class 0 clustering acc 0.9739583333333334: correct 8228/8448 class 1 clustering acc 0.4559659090909091: correct 963/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6875, correct 66/96 class 2: acc 0.746268656716418, correct 100/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6629Overall F1 Score: 0.4349Training for coarse level...batch 100, loss: 0.0274, instance_loss: 0.1475, weighted_loss: 0.0634, label: 2, bag_size: 624batch 200, loss: 0.0160, instance_loss: 0.4831, weighted_loss: 0.1561, label: 3, bag_size: 239batch 300, loss: 0.1703, instance_loss: 0.3018, weighted_loss: 0.2098, label: 2, bag_size: 532batch 400, loss: 0.0355, instance_loss: 0.8150, weighted_loss: 0.2694, label: 3, bag_size: 751batch 500, loss: 0.0031, instance_loss: 0.0938, weighted_loss: 0.0303, label: 2, bag_size: 1222batch 600, loss: 0.0034, instance_loss: 0.2872, weighted_loss: 0.0885, label: 2, bag_size: 552batch 700, loss: 0.1214, instance_loss: 0.0874, weighted_loss: 0.1112, label: 2, bag_size: 518batch 800, loss: 0.0388, instance_loss: 0.2585, weighted_loss: 0.1047, label: 1, bag_size: 476batch 900, loss: 0.0001, instance_loss: 0.0182, weighted_loss: 0.0055, label: 2, bag_size: 169batch 1000, loss: 0.0005, instance_loss: 0.1772, weighted_loss: 0.0535, label: 2, bag_size: 376batch 1100, loss: 0.0002, instance_loss: 0.0279, weighted_loss: 0.0085, label: 2, bag_size: 475batch 1200, loss: 0.0119, instance_loss: 0.3114, weighted_loss: 0.1017, label: 2, bag_size: 315batch 1300, loss: 0.0019, instance_loss: 0.1053, weighted_loss: 0.0329, label: 2, bag_size: 956batch 1400, loss: 0.4084, instance_loss: 1.1657, weighted_loss: 0.6356, label: 3, bag_size: 512batch 1500, loss: 0.0135, instance_loss: 0.1234, weighted_loss: 0.0465, label: 1, bag_size: 848batch 1600, loss: 0.2926, instance_loss: 0.6070, weighted_loss: 0.3869, label: 3, bag_size: 307batch 1700, loss: 0.0766, instance_loss: 0.7214, weighted_loss: 0.2700, label: 2, bag_size: 231batch 1800, loss: 0.0117, instance_loss: 0.3095, weighted_loss: 0.1010, label: 2, bag_size: 1550batch 1900, loss: 0.3821, instance_loss: 0.6357, weighted_loss: 0.4582, label: 3, bag_size: 13batch 2000, loss: 0.0003, instance_loss: 0.0267, weighted_loss: 0.0083, label: 2, bag_size: 371batch 2100, loss: 0.0159, instance_loss: 0.1588, weighted_loss: 0.0587, label: 1, bag_size: 732Instance Classifier Statsclass 0 clustering acc 0.9844902073732719: correct 68363/69440class 1 clustering acc 0.49066820276497697: correct 8518/17360Epoch: 51, train_loss: 0.1404, train_clustering_loss:  0.3364, train_error: 0.0318class 0: acc 0.9090909090909091, correct 40/44 class 1: acc 0.9718670076726342, correct 760/782 class 2: acc 0.9797608095676172, correct 1065/1087 class 3: acc 0.9182879377431906, correct 236/257 Overall Accuracy: 0.9682
Val Set, val_loss: 1.2594, auc: 0.7282 class 0 clustering acc 0.9706439393939394: correct 8200/8448 class 1 clustering acc 0.46638257575757575: correct 985/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6770833333333334, correct 65/96 class 2: acc 0.7910447761194029, correct 106/134 class 3: acc 0.3, correct 9/30 Overall Accuracy: 0.6818Overall F1 Score: 0.4479Training for coarse level...batch 100, loss: 0.0823, instance_loss: 0.3187, weighted_loss: 0.1532, label: 1, bag_size: 807batch 200, loss: 0.0575, instance_loss: 0.4608, weighted_loss: 0.1785, label: 3, bag_size: 338batch 300, loss: 0.0007, instance_loss: 0.0242, weighted_loss: 0.0078, label: 1, bag_size: 1762batch 400, loss: 0.2910, instance_loss: 0.4117, weighted_loss: 0.3272, label: 2, bag_size: 742batch 500, loss: 0.0091, instance_loss: 0.0142, weighted_loss: 0.0107, label: 1, bag_size: 447batch 600, loss: 0.1165, instance_loss: 0.7167, weighted_loss: 0.2965, label: 2, bag_size: 537batch 700, loss: 0.0002, instance_loss: 0.1049, weighted_loss: 0.0316, label: 2, bag_size: 1246batch 800, loss: 0.0281, instance_loss: 0.0197, weighted_loss: 0.0256, label: 2, bag_size: 507batch 900, loss: 0.0004, instance_loss: 0.2943, weighted_loss: 0.0886, label: 1, bag_size: 607batch 1000, loss: 0.0321, instance_loss: 0.4554, weighted_loss: 0.1591, label: 2, bag_size: 649batch 1100, loss: 0.0018, instance_loss: 0.0256, weighted_loss: 0.0089, label: 1, bag_size: 2302batch 1200, loss: 0.0230, instance_loss: 0.4696, weighted_loss: 0.1570, label: 1, bag_size: 328batch 1300, loss: 0.2956, instance_loss: 0.6716, weighted_loss: 0.4084, label: 1, bag_size: 488batch 1400, loss: 0.4646, instance_loss: 0.2149, weighted_loss: 0.3897, label: 2, bag_size: 318batch 1500, loss: 0.0531, instance_loss: 0.3303, weighted_loss: 0.1363, label: 2, bag_size: 635batch 1600, loss: 0.2409, instance_loss: 0.3970, weighted_loss: 0.2877, label: 3, bag_size: 472batch 1700, loss: 0.0047, instance_loss: 0.1460, weighted_loss: 0.0471, label: 2, bag_size: 148batch 1800, loss: 0.3480, instance_loss: 0.1542, weighted_loss: 0.2899, label: 1, bag_size: 129batch 1900, loss: 0.3272, instance_loss: 0.4235, weighted_loss: 0.3561, label: 2, bag_size: 463batch 2000, loss: 0.0694, instance_loss: 0.4342, weighted_loss: 0.1788, label: 1, bag_size: 271batch 2100, loss: 0.0192, instance_loss: 0.2942, weighted_loss: 0.1017, label: 1, bag_size: 382Instance Classifier Statsclass 0 clustering acc 0.9846342165898617: correct 68373/69440class 1 clustering acc 0.4926267281105991: correct 8552/17360Epoch: 52, train_loss: 0.1299, train_clustering_loss:  0.3361, train_error: 0.0318class 0: acc 0.8409090909090909, correct 37/44 class 1: acc 0.9782608695652174, correct 765/782 class 2: acc 0.9862005519779209, correct 1072/1087 class 3: acc 0.8832684824902723, correct 227/257 Overall Accuracy: 0.9682
Val Set, val_loss: 1.2696, auc: 0.7505 class 0 clustering acc 0.9711174242424242: correct 8204/8448 class 1 clustering acc 0.4588068181818182: correct 969/2112 class 0: acc 0.0, correct 0/4 class 1: acc 0.6875, correct 66/96 class 2: acc 0.753731343283582, correct 101/134 class 3: acc 0.3333333333333333, correct 10/30 Overall Accuracy: 0.6705Overall F1 Score: 0.4451