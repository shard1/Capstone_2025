Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for coarse level...
batch 100, loss: 1.3305, instance_loss: 1.1809, weighted_loss: 1.2857, label: 1, bag_size: 1374
batch 200, loss: 1.1134, instance_loss: 1.1243, weighted_loss: 1.1167, label: 2, bag_size: 138
batch 300, loss: 1.0558, instance_loss: 1.2064, weighted_loss: 1.1010, label: 2, bag_size: 325
batch 400, loss: 1.2019, instance_loss: 1.1636, weighted_loss: 1.1904, label: 1, bag_size: 454
batch 500, loss: 1.5852, instance_loss: 1.1589, weighted_loss: 1.4573, label: 3, bag_size: 163
batch 600, loss: 0.8741, instance_loss: 1.1632, weighted_loss: 0.9608, label: 2, bag_size: 274
batch 700, loss: 1.8819, instance_loss: 1.1269, weighted_loss: 1.6554, label: 3, bag_size: 704
batch 800, loss: 1.1496, instance_loss: 1.0779, weighted_loss: 1.1281, label: 1, bag_size: 618
batch 900, loss: 0.7839, instance_loss: 1.0466, weighted_loss: 0.8627, label: 2, bag_size: 446
batch 1000, loss: 1.2111, instance_loss: 0.9603, weighted_loss: 1.1359, label: 1, bag_size: 296
batch 1100, loss: 1.8532, instance_loss: 0.9837, weighted_loss: 1.5923, label: 3, bag_size: 888
batch 1200, loss: 0.7109, instance_loss: 0.9779, weighted_loss: 0.7910, label: 2, bag_size: 602
batch 1300, loss: 0.7451, instance_loss: 0.9018, weighted_loss: 0.7921, label: 2, bag_size: 691
batch 1400, loss: 1.7345, instance_loss: 1.0307, weighted_loss: 1.5234, label: 3, bag_size: 13
batch 1500, loss: 0.6709, instance_loss: 0.9650, weighted_loss: 0.7592, label: 2, bag_size: 364
batch 1600, loss: 0.7076, instance_loss: 0.8209, weighted_loss: 0.7416, label: 2, bag_size: 355
batch 1700, loss: 1.1762, instance_loss: 0.9607, weighted_loss: 1.1115, label: 1, bag_size: 616
batch 1800, loss: 1.0311, instance_loss: 0.9354, weighted_loss: 1.0024, label: 1, bag_size: 224
batch 1900, loss: 0.8470, instance_loss: 0.8162, weighted_loss: 0.8377, label: 2, bag_size: 109
batch 2000, loss: 0.5986, instance_loss: 0.8336, weighted_loss: 0.6691, label: 2, bag_size: 258
batch 2100, loss: 0.7998, instance_loss: 0.7349, weighted_loss: 0.7803, label: 2, bag_size: 589

Instance Classifier Stats
class 0 clustering acc 0.8785858294930876: correct 61009/69440
class 1 clustering acc 0.13346774193548386: correct 2317/17360

Epoch: 1, train_loss: 1.1187, train_clustering_loss:  1.0244, train_error: 0.4995
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.0025575447570332483, correct coarse 2/782 
coarse class 2: coarse acc 0.9972401103955841, correct coarse 1084/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.5005

Val Set, val_loss: 1.0143, val_error: 0.4924, auc: 0.6743
class 0 clustering acc 0.99609375: correct 8415/8448 
class 1 clustering acc 0.005681818181818182: correct 12/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.0, correct coarse 0/96 
coarse class 2: coarse acc 1.0, correct coarse 134/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1683

Training for coarse level...
batch 100, loss: 1.0519, instance_loss: 0.9121, weighted_loss: 1.0099, label: 1, bag_size: 202
batch 200, loss: 1.1461, instance_loss: 0.7828, weighted_loss: 1.0371, label: 1, bag_size: 946
batch 300, loss: 1.0778, instance_loss: 0.8307, weighted_loss: 1.0037, label: 1, bag_size: 837
batch 400, loss: 1.2077, instance_loss: 0.7592, weighted_loss: 1.0731, label: 1, bag_size: 501
batch 500, loss: 1.2318, instance_loss: 0.7764, weighted_loss: 1.0952, label: 1, bag_size: 190
batch 600, loss: 0.7051, instance_loss: 0.7848, weighted_loss: 0.7290, label: 2, bag_size: 200
batch 700, loss: 0.9597, instance_loss: 0.8309, weighted_loss: 0.9211, label: 1, bag_size: 584
batch 800, loss: 1.1433, instance_loss: 0.7697, weighted_loss: 1.0312, label: 1, bag_size: 1168
batch 900, loss: 0.5121, instance_loss: 0.7363, weighted_loss: 0.5794, label: 2, bag_size: 705
batch 1000, loss: 0.6005, instance_loss: 0.7056, weighted_loss: 0.6320, label: 2, bag_size: 1048
batch 1100, loss: 2.2292, instance_loss: 0.7563, weighted_loss: 1.7873, label: 3, bag_size: 751
batch 1200, loss: 0.9699, instance_loss: 0.6450, weighted_loss: 0.8724, label: 2, bag_size: 764
batch 1300, loss: 0.9842, instance_loss: 0.7520, weighted_loss: 0.9145, label: 1, bag_size: 1918
batch 1400, loss: 0.7039, instance_loss: 0.5921, weighted_loss: 0.6704, label: 2, bag_size: 1716
batch 1500, loss: 0.7270, instance_loss: 0.5528, weighted_loss: 0.6747, label: 2, bag_size: 670
batch 1600, loss: 1.0251, instance_loss: 0.6854, weighted_loss: 0.9232, label: 1, bag_size: 1534
batch 1700, loss: 1.0950, instance_loss: 0.6533, weighted_loss: 0.9625, label: 1, bag_size: 976
batch 1800, loss: 0.6710, instance_loss: 0.6049, weighted_loss: 0.6512, label: 2, bag_size: 713
batch 1900, loss: 0.6357, instance_loss: 0.5871, weighted_loss: 0.6211, label: 2, bag_size: 214
batch 2000, loss: 1.8903, instance_loss: 0.8008, weighted_loss: 1.5634, label: 3, bag_size: 628
batch 2100, loss: 0.5375, instance_loss: 0.6387, weighted_loss: 0.5678, label: 2, bag_size: 409

Instance Classifier Stats
class 0 clustering acc 0.9967885944700461: correct 69217/69440
class 1 clustering acc 0.004205069124423963: correct 73/17360

Epoch: 2, train_loss: 1.0069, train_clustering_loss:  0.7145, train_error: 0.4719
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.0959079283887468, correct coarse 75/782 
coarse class 2: coarse acc 0.985280588776449, correct coarse 1071/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.5281

Val Set, val_loss: 0.9574, val_error: 0.4356, auc: 0.6882
class 0 clustering acc 1.0: correct 8448/8448 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.1875, correct coarse 18/96 
coarse class 2: coarse acc 0.9776119402985075, correct coarse 131/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.5644
Overall F1 Score: 0.2505

Training for coarse level...
batch 100, loss: 1.0656, instance_loss: 0.6578, weighted_loss: 0.9433, label: 1, bag_size: 637
batch 200, loss: 1.0877, instance_loss: 0.6548, weighted_loss: 0.9579, label: 1, bag_size: 1628
batch 300, loss: 0.9505, instance_loss: 0.6880, weighted_loss: 0.8717, label: 1, bag_size: 382
batch 400, loss: 0.8464, instance_loss: 0.6547, weighted_loss: 0.7889, label: 1, bag_size: 2948
batch 500, loss: 0.4692, instance_loss: 0.5055, weighted_loss: 0.4801, label: 2, bag_size: 857
batch 600, loss: 1.2466, instance_loss: 0.6972, weighted_loss: 1.0818, label: 1, bag_size: 37
batch 700, loss: 0.6124, instance_loss: 0.5416, weighted_loss: 0.5912, label: 2, bag_size: 243
batch 800, loss: 0.7933, instance_loss: 0.5691, weighted_loss: 0.7260, label: 2, bag_size: 427
batch 900, loss: 0.9357, instance_loss: 0.6663, weighted_loss: 0.8549, label: 1, bag_size: 2107
batch 1000, loss: 0.8326, instance_loss: 0.6110, weighted_loss: 0.7661, label: 2, bag_size: 235
batch 1100, loss: 1.1070, instance_loss: 0.6077, weighted_loss: 0.9572, label: 1, bag_size: 501
batch 1200, loss: 0.6204, instance_loss: 0.4958, weighted_loss: 0.5830, label: 2, bag_size: 284
batch 1300, loss: 0.7064, instance_loss: 0.6421, weighted_loss: 0.6871, label: 1, bag_size: 1561
batch 1400, loss: 0.4348, instance_loss: 0.5452, weighted_loss: 0.4679, label: 2, bag_size: 1246
batch 1500, loss: 0.8869, instance_loss: 0.6800, weighted_loss: 0.8248, label: 1, bag_size: 1659
batch 1600, loss: 2.0557, instance_loss: 0.7308, weighted_loss: 1.6582, label: 3, bag_size: 168
batch 1700, loss: 1.1156, instance_loss: 0.6012, weighted_loss: 0.9613, label: 1, bag_size: 332
batch 1800, loss: 0.2990, instance_loss: 0.5387, weighted_loss: 0.3709, label: 2, bag_size: 439
batch 1900, loss: 0.4451, instance_loss: 0.5383, weighted_loss: 0.4731, label: 2, bag_size: 346
batch 2000, loss: 0.8601, instance_loss: 0.5420, weighted_loss: 0.7647, label: 2, bag_size: 292
batch 2100, loss: 0.8601, instance_loss: 0.6150, weighted_loss: 0.7866, label: 1, bag_size: 589

Instance Classifier Stats
class 0 clustering acc 0.9998415898617512: correct 69429/69440
class 1 clustering acc 0.0006336405529953918: correct 11/17360

Epoch: 3, train_loss: 0.9644, train_clustering_loss:  0.6110, train_error: 0.4323
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.2672634271099744, correct coarse 209/782 
coarse class 2: coarse acc 0.9411223551057958, correct coarse 1023/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.5677

Val Set, val_loss: 0.9251, val_error: 0.3712, auc: 0.6970
class 0 clustering acc 1.0: correct 8448/8448 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.4583333333333333, correct coarse 44/96 
coarse class 2: coarse acc 0.9104477611940298, correct coarse 122/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6288
Overall F1 Score: 0.3195

Training for coarse level...
batch 100, loss: 0.5504, instance_loss: 0.5175, weighted_loss: 0.5405, label: 2, bag_size: 847
batch 200, loss: 0.9567, instance_loss: 0.5864, weighted_loss: 0.8456, label: 1, bag_size: 983
batch 300, loss: 0.7795, instance_loss: 0.6550, weighted_loss: 0.7422, label: 1, bag_size: 725
batch 400, loss: 0.4032, instance_loss: 0.4598, weighted_loss: 0.4202, label: 2, bag_size: 358
batch 500, loss: 1.7053, instance_loss: 0.7152, weighted_loss: 1.4083, label: 3, bag_size: 210
batch 600, loss: 0.8113, instance_loss: 0.6066, weighted_loss: 0.7499, label: 1, bag_size: 663
batch 700, loss: 0.7334, instance_loss: 0.6671, weighted_loss: 0.7135, label: 1, bag_size: 554
batch 800, loss: 0.4634, instance_loss: 0.4647, weighted_loss: 0.4638, label: 2, bag_size: 284
batch 900, loss: 0.6650, instance_loss: 0.4859, weighted_loss: 0.6113, label: 2, bag_size: 387
batch 1000, loss: 0.5443, instance_loss: 0.4457, weighted_loss: 0.5147, label: 2, bag_size: 307
batch 1100, loss: 0.6266, instance_loss: 0.5917, weighted_loss: 0.6161, label: 1, bag_size: 198
batch 1200, loss: 1.0814, instance_loss: 0.6281, weighted_loss: 0.9454, label: 1, bag_size: 575
batch 1300, loss: 0.6964, instance_loss: 0.5880, weighted_loss: 0.6639, label: 1, bag_size: 697
batch 1400, loss: 1.9439, instance_loss: 0.6969, weighted_loss: 1.5698, label: 3, bag_size: 206
batch 1500, loss: 1.3637, instance_loss: 0.6084, weighted_loss: 1.1371, label: 1, bag_size: 235
batch 1600, loss: 0.5941, instance_loss: 0.5075, weighted_loss: 0.5681, label: 2, bag_size: 182
batch 1700, loss: 0.9785, instance_loss: 0.6260, weighted_loss: 0.8727, label: 1, bag_size: 356
batch 1800, loss: 0.9465, instance_loss: 0.5641, weighted_loss: 0.8318, label: 1, bag_size: 296
batch 1900, loss: 0.3903, instance_loss: 0.4971, weighted_loss: 0.4223, label: 2, bag_size: 123
batch 2000, loss: 0.3599, instance_loss: 0.4692, weighted_loss: 0.3927, label: 2, bag_size: 482
batch 2100, loss: 0.7138, instance_loss: 0.5849, weighted_loss: 0.6751, label: 1, bag_size: 2830

Instance Classifier Stats
class 0 clustering acc 0.9999567972350231: correct 69437/69440
class 1 clustering acc 0.0006336405529953918: correct 11/17360

Epoch: 4, train_loss: 0.9356, train_clustering_loss:  0.5702, train_error: 0.3871
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.4578005115089514, correct coarse 358/782 
coarse class 2: coarse acc 0.8942042318307267, correct coarse 972/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6129

Val Set, val_loss: 0.9027, val_error: 0.3561, auc: 0.7077
class 0 clustering acc 1.0: correct 8448/8448 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.53125, correct coarse 51/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6439
Overall F1 Score: 0.3325

Training for coarse level...
batch 100, loss: 0.8020, instance_loss: 0.4487, weighted_loss: 0.6960, label: 2, bag_size: 421
batch 200, loss: 0.8884, instance_loss: 0.6448, weighted_loss: 0.8153, label: 1, bag_size: 807
batch 300, loss: 0.4601, instance_loss: 0.3891, weighted_loss: 0.4388, label: 2, bag_size: 542
batch 400, loss: 1.1070, instance_loss: 0.6875, weighted_loss: 0.9811, label: 1, bag_size: 976
batch 500, loss: 0.8737, instance_loss: 0.5750, weighted_loss: 0.7841, label: 1, bag_size: 3892
batch 600, loss: 0.2437, instance_loss: 0.4177, weighted_loss: 0.2959, label: 2, bag_size: 599
batch 700, loss: 0.3512, instance_loss: 0.3742, weighted_loss: 0.3581, label: 2, bag_size: 324
batch 800, loss: 0.6966, instance_loss: 0.4469, weighted_loss: 0.6217, label: 2, bag_size: 236
batch 900, loss: 1.8862, instance_loss: 0.7212, weighted_loss: 1.5367, label: 3, bag_size: 543
batch 1000, loss: 2.2004, instance_loss: 0.6520, weighted_loss: 1.7359, label: 1, bag_size: 477
batch 1100, loss: 1.0167, instance_loss: 0.5457, weighted_loss: 0.8754, label: 2, bag_size: 75
batch 1200, loss: 0.7603, instance_loss: 0.5914, weighted_loss: 0.7096, label: 1, bag_size: 2107
batch 1300, loss: 2.1898, instance_loss: 0.7513, weighted_loss: 1.7583, label: 3, bag_size: 116
batch 1400, loss: 1.8500, instance_loss: 0.7469, weighted_loss: 1.5191, label: 3, bag_size: 1196
batch 1500, loss: 2.1730, instance_loss: 0.8605, weighted_loss: 1.7793, label: 3, bag_size: 558
batch 1600, loss: 0.5379, instance_loss: 0.4258, weighted_loss: 0.5043, label: 2, bag_size: 296
batch 1700, loss: 0.3812, instance_loss: 0.3620, weighted_loss: 0.3755, label: 2, bag_size: 1058
batch 1800, loss: 0.2433, instance_loss: 0.3815, weighted_loss: 0.2847, label: 2, bag_size: 835
batch 1900, loss: 0.5131, instance_loss: 0.4352, weighted_loss: 0.4897, label: 2, bag_size: 365
batch 2000, loss: 0.6267, instance_loss: 0.5478, weighted_loss: 0.6031, label: 2, bag_size: 154
batch 2100, loss: 0.6166, instance_loss: 0.4759, weighted_loss: 0.5744, label: 2, bag_size: 202

Instance Classifier Stats
class 0 clustering acc 0.9998127880184332: correct 69427/69440
class 1 clustering acc 0.004320276497695853: correct 75/17360

Epoch: 5, train_loss: 0.9130, train_clustering_loss:  0.5451, train_error: 0.3691
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5421994884910486, correct coarse 424/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6309

Val Set, val_loss: 0.8850, val_error: 0.3523, auc: 0.7140
class 0 clustering acc 1.0: correct 8448/8448 
class 1 clustering acc 0.0014204545454545455: correct 3/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5520833333333334, correct coarse 53/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6477
Overall F1 Score: 0.3353

Training for coarse level...
batch 100, loss: 1.5963, instance_loss: 0.7457, weighted_loss: 1.3411, label: 3, bag_size: 426
batch 200, loss: 0.6420, instance_loss: 0.3773, weighted_loss: 0.5626, label: 2, bag_size: 595
batch 300, loss: 1.0069, instance_loss: 0.5471, weighted_loss: 0.8689, label: 2, bag_size: 224
batch 400, loss: 0.6432, instance_loss: 0.5975, weighted_loss: 0.6295, label: 1, bag_size: 956
batch 500, loss: 0.2347, instance_loss: 0.3492, weighted_loss: 0.2690, label: 2, bag_size: 1044
batch 600, loss: 2.0061, instance_loss: 0.8715, weighted_loss: 1.6657, label: 3, bag_size: 253
batch 700, loss: 1.2407, instance_loss: 0.7200, weighted_loss: 1.0845, label: 1, bag_size: 566
batch 800, loss: 0.6989, instance_loss: 0.3672, weighted_loss: 0.5994, label: 2, bag_size: 431
batch 900, loss: 0.2473, instance_loss: 0.3640, weighted_loss: 0.2823, label: 2, bag_size: 225
batch 1000, loss: 0.3208, instance_loss: 0.2998, weighted_loss: 0.3145, label: 2, bag_size: 700
batch 1100, loss: 0.4376, instance_loss: 0.3925, weighted_loss: 0.4241, label: 2, bag_size: 473
batch 1200, loss: 0.5378, instance_loss: 0.3993, weighted_loss: 0.4962, label: 2, bag_size: 461
batch 1300, loss: 0.5144, instance_loss: 0.3862, weighted_loss: 0.4759, label: 2, bag_size: 194
batch 1400, loss: 2.1477, instance_loss: 0.8633, weighted_loss: 1.7624, label: 3, bag_size: 451
batch 1500, loss: 0.4112, instance_loss: 0.3335, weighted_loss: 0.3879, label: 2, bag_size: 712
batch 1600, loss: 0.7558, instance_loss: 0.5830, weighted_loss: 0.7040, label: 1, bag_size: 2019
batch 1700, loss: 1.0363, instance_loss: 0.5760, weighted_loss: 0.8982, label: 1, bag_size: 851
batch 1800, loss: 0.7325, instance_loss: 0.6081, weighted_loss: 0.6952, label: 1, bag_size: 574
batch 1900, loss: 0.3417, instance_loss: 0.3940, weighted_loss: 0.3574, label: 2, bag_size: 475
batch 2000, loss: 1.0968, instance_loss: 0.6084, weighted_loss: 0.9503, label: 2, bag_size: 132
batch 2100, loss: 0.3633, instance_loss: 0.3600, weighted_loss: 0.3623, label: 2, bag_size: 473

Instance Classifier Stats
class 0 clustering acc 0.9994239631336406: correct 69400/69440
class 1 clustering acc 0.016820276497695852: correct 292/17360

Epoch: 6, train_loss: 0.8946, train_clustering_loss:  0.5262, train_error: 0.3585
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5895140664961637, correct coarse 461/782 
coarse class 2: coarse acc 0.8564857405703772, correct coarse 931/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6415

Val Set, val_loss: 0.8706, val_error: 0.3485, auc: 0.7195
class 0 clustering acc 1.0: correct 8448/8448 
class 1 clustering acc 0.018465909090909092: correct 39/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5625, correct coarse 54/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6515
Overall F1 Score: 0.3379

Training for coarse level...
batch 100, loss: 0.4781, instance_loss: 0.3631, weighted_loss: 0.4436, label: 2, bag_size: 408
batch 200, loss: 1.2846, instance_loss: 0.5336, weighted_loss: 1.0593, label: 2, bag_size: 348
batch 300, loss: 1.2362, instance_loss: 0.6370, weighted_loss: 1.0565, label: 1, bag_size: 421
batch 400, loss: 0.2402, instance_loss: 0.2808, weighted_loss: 0.2524, label: 2, bag_size: 700
batch 500, loss: 0.3834, instance_loss: 0.3383, weighted_loss: 0.3699, label: 2, bag_size: 333
batch 600, loss: 0.5503, instance_loss: 0.4997, weighted_loss: 0.5351, label: 1, bag_size: 981
batch 700, loss: 1.5047, instance_loss: 0.6509, weighted_loss: 1.2485, label: 1, bag_size: 341
batch 800, loss: 0.9733, instance_loss: 0.5621, weighted_loss: 0.8500, label: 1, bag_size: 160
batch 900, loss: 1.1816, instance_loss: 0.6482, weighted_loss: 1.0216, label: 1, bag_size: 471
batch 1000, loss: 0.5660, instance_loss: 0.4253, weighted_loss: 0.5238, label: 2, bag_size: 202
batch 1100, loss: 0.5898, instance_loss: 0.3399, weighted_loss: 0.5148, label: 2, bag_size: 541
batch 1200, loss: 0.3729, instance_loss: 0.4795, weighted_loss: 0.4048, label: 1, bag_size: 2121
batch 1300, loss: 0.2227, instance_loss: 0.2691, weighted_loss: 0.2366, label: 2, bag_size: 446
batch 1400, loss: 0.4234, instance_loss: 0.4000, weighted_loss: 0.4164, label: 2, bag_size: 258
batch 1500, loss: 0.1326, instance_loss: 0.2471, weighted_loss: 0.1669, label: 2, bag_size: 537
batch 1600, loss: 0.5078, instance_loss: 0.4949, weighted_loss: 0.5039, label: 1, bag_size: 2214
batch 1700, loss: 0.1066, instance_loss: 0.3197, weighted_loss: 0.1705, label: 2, bag_size: 439
batch 1800, loss: 0.3523, instance_loss: 0.2962, weighted_loss: 0.3354, label: 2, bag_size: 712
batch 1900, loss: 0.4046, instance_loss: 0.2939, weighted_loss: 0.3714, label: 2, bag_size: 1304
batch 2000, loss: 0.2888, instance_loss: 0.4458, weighted_loss: 0.3359, label: 1, bag_size: 500
batch 2100, loss: 0.4890, instance_loss: 0.3442, weighted_loss: 0.4456, label: 2, bag_size: 534

Instance Classifier Stats
class 0 clustering acc 0.9977822580645161: correct 69286/69440
class 1 clustering acc 0.045737327188940094: correct 794/17360

Epoch: 7, train_loss: 0.8795, train_clustering_loss:  0.5122, train_error: 0.3599
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5895140664961637, correct coarse 461/782 
coarse class 2: coarse acc 0.8537258509659613, correct coarse 928/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6401

Val Set, val_loss: 0.8591, val_error: 0.3636, auc: 0.7279
class 0 clustering acc 0.9985795454545454: correct 8436/8448 
class 1 clustering acc 0.05303030303030303: correct 112/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5625, correct coarse 54/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6364
Overall F1 Score: 0.3304

Training for coarse level...
batch 100, loss: 0.6692, instance_loss: 0.3892, weighted_loss: 0.5852, label: 2, bag_size: 266
batch 200, loss: 0.1242, instance_loss: 0.2689, weighted_loss: 0.1676, label: 2, bag_size: 257
batch 300, loss: 0.4666, instance_loss: 0.4843, weighted_loss: 0.4719, label: 1, bag_size: 1304
batch 400, loss: 1.2683, instance_loss: 0.5472, weighted_loss: 1.0520, label: 2, bag_size: 472
batch 500, loss: 1.6996, instance_loss: 0.6491, weighted_loss: 1.3844, label: 3, bag_size: 22
batch 600, loss: 2.6709, instance_loss: 0.9010, weighted_loss: 2.1399, label: 3, bag_size: 94
batch 700, loss: 3.3725, instance_loss: 0.9089, weighted_loss: 2.6334, label: 0, bag_size: 67
batch 800, loss: 0.8645, instance_loss: 0.6053, weighted_loss: 0.7867, label: 1, bag_size: 1256
batch 900, loss: 0.3855, instance_loss: 0.2514, weighted_loss: 0.3453, label: 2, bag_size: 618
batch 1000, loss: 0.1525, instance_loss: 0.2601, weighted_loss: 0.1848, label: 2, bag_size: 403
batch 1100, loss: 0.5441, instance_loss: 0.5796, weighted_loss: 0.5548, label: 1, bag_size: 729
batch 1200, loss: 0.8598, instance_loss: 0.5443, weighted_loss: 0.7652, label: 1, bag_size: 483
batch 1300, loss: 0.9012, instance_loss: 0.3929, weighted_loss: 0.7487, label: 2, bag_size: 1122
batch 1400, loss: 0.6579, instance_loss: 0.3644, weighted_loss: 0.5699, label: 2, bag_size: 576
batch 1500, loss: 0.9096, instance_loss: 0.4591, weighted_loss: 0.7744, label: 2, bag_size: 367
batch 1600, loss: 0.7788, instance_loss: 0.4238, weighted_loss: 0.6723, label: 2, bag_size: 1865
batch 1700, loss: 0.3570, instance_loss: 0.3708, weighted_loss: 0.3611, label: 2, bag_size: 308
batch 1800, loss: 0.1764, instance_loss: 0.2793, weighted_loss: 0.2073, label: 2, bag_size: 252
batch 1900, loss: 0.1021, instance_loss: 0.2381, weighted_loss: 0.1429, label: 2, bag_size: 686
batch 2000, loss: 0.5472, instance_loss: 0.3909, weighted_loss: 0.5003, label: 1, bag_size: 1300
batch 2100, loss: 0.2651, instance_loss: 0.3943, weighted_loss: 0.3038, label: 2, bag_size: 240

Instance Classifier Stats
class 0 clustering acc 0.9965149769585253: correct 69198/69440
class 1 clustering acc 0.07626728110599078: correct 1324/17360

Epoch: 8, train_loss: 0.8669, train_clustering_loss:  0.4977, train_error: 0.3558
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6202046035805626, correct coarse 485/782 
coarse class 2: coarse acc 0.8399264029438822, correct coarse 913/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6442

Val Set, val_loss: 0.8484, val_error: 0.3485, auc: 0.7357
class 0 clustering acc 0.9952651515151515: correct 8408/8448 
class 1 clustering acc 0.10464015151515152: correct 221/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6515
Overall F1 Score: 0.3403

Training for coarse level...
batch 100, loss: 0.7648, instance_loss: 0.6077, weighted_loss: 0.7177, label: 1, bag_size: 356
batch 200, loss: 2.0216, instance_loss: 0.8397, weighted_loss: 1.6670, label: 3, bag_size: 901
batch 300, loss: 0.7127, instance_loss: 0.5422, weighted_loss: 0.6616, label: 1, bag_size: 989
batch 400, loss: 0.2816, instance_loss: 0.2560, weighted_loss: 0.2739, label: 2, bag_size: 242
batch 500, loss: 0.5803, instance_loss: 0.3578, weighted_loss: 0.5135, label: 2, bag_size: 216
batch 600, loss: 3.2633, instance_loss: 0.8866, weighted_loss: 2.5503, label: 0, bag_size: 482
batch 700, loss: 0.5719, instance_loss: 0.3267, weighted_loss: 0.4984, label: 2, bag_size: 304
batch 800, loss: 0.6219, instance_loss: 0.3629, weighted_loss: 0.5442, label: 2, bag_size: 1830
batch 900, loss: 1.7150, instance_loss: 0.7744, weighted_loss: 1.4328, label: 1, bag_size: 910
batch 1000, loss: 1.1486, instance_loss: 0.6311, weighted_loss: 0.9934, label: 1, bag_size: 851
batch 1100, loss: 1.1750, instance_loss: 0.5363, weighted_loss: 0.9833, label: 2, bag_size: 305
batch 1200, loss: 0.4748, instance_loss: 0.5777, weighted_loss: 0.5056, label: 1, bag_size: 1365
batch 1300, loss: 0.9228, instance_loss: 0.4440, weighted_loss: 0.7792, label: 2, bag_size: 160
batch 1400, loss: 0.9061, instance_loss: 0.4316, weighted_loss: 0.7638, label: 2, bag_size: 291
batch 1500, loss: 0.2326, instance_loss: 0.4518, weighted_loss: 0.2984, label: 1, bag_size: 298
batch 1600, loss: 0.7919, instance_loss: 0.6145, weighted_loss: 0.7387, label: 1, bag_size: 454
batch 1700, loss: 1.9340, instance_loss: 0.9069, weighted_loss: 1.6259, label: 3, bag_size: 278
batch 1800, loss: 3.4449, instance_loss: 0.8855, weighted_loss: 2.6771, label: 0, bag_size: 220
batch 1900, loss: 1.1879, instance_loss: 0.3785, weighted_loss: 0.9451, label: 2, bag_size: 718
batch 2000, loss: 0.3313, instance_loss: 0.3917, weighted_loss: 0.3494, label: 2, bag_size: 200
batch 2100, loss: 1.1648, instance_loss: 0.5081, weighted_loss: 0.9678, label: 2, bag_size: 72

Instance Classifier Stats
class 0 clustering acc 0.9938796082949308: correct 69015/69440
class 1 clustering acc 0.11808755760368664: correct 2050/17360

Epoch: 9, train_loss: 0.8556, train_clustering_loss:  0.4863, train_error: 0.3576
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.828886844526219, correct coarse 901/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6424

Val Set, val_loss: 0.8394, val_error: 0.3485, auc: 0.7426
class 0 clustering acc 0.9924242424242424: correct 8384/8448 
class 1 clustering acc 0.14299242424242425: correct 302/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6515
Overall F1 Score: 0.3403

Training for coarse level...
batch 100, loss: 0.7377, instance_loss: 0.3804, weighted_loss: 0.6305, label: 2, bag_size: 431
batch 200, loss: 0.6636, instance_loss: 0.5184, weighted_loss: 0.6201, label: 2, bag_size: 124
batch 300, loss: 1.2593, instance_loss: 0.5875, weighted_loss: 1.0578, label: 2, bag_size: 233
batch 400, loss: 0.0919, instance_loss: 0.2949, weighted_loss: 0.1528, label: 2, bag_size: 193
batch 500, loss: 1.4122, instance_loss: 0.6464, weighted_loss: 1.1825, label: 2, bag_size: 182
batch 600, loss: 0.1752, instance_loss: 0.3400, weighted_loss: 0.2246, label: 1, bag_size: 447
batch 700, loss: 1.3011, instance_loss: 0.6478, weighted_loss: 1.1051, label: 1, bag_size: 371
batch 800, loss: 0.5513, instance_loss: 0.2831, weighted_loss: 0.4709, label: 2, bag_size: 1214
batch 900, loss: 2.1844, instance_loss: 0.7855, weighted_loss: 1.7648, label: 3, bag_size: 1342
batch 1000, loss: 0.2884, instance_loss: 0.3153, weighted_loss: 0.2965, label: 2, bag_size: 292
batch 1100, loss: 0.2689, instance_loss: 0.2588, weighted_loss: 0.2659, label: 2, bag_size: 311
batch 1200, loss: 0.8170, instance_loss: 0.4779, weighted_loss: 0.7153, label: 1, bag_size: 473
batch 1300, loss: 0.6916, instance_loss: 0.6792, weighted_loss: 0.6879, label: 1, bag_size: 1404
batch 1400, loss: 0.7097, instance_loss: 0.5011, weighted_loss: 0.6471, label: 1, bag_size: 1087
batch 1500, loss: 0.2817, instance_loss: 0.3457, weighted_loss: 0.3009, label: 2, bag_size: 117
batch 1600, loss: 1.8953, instance_loss: 0.7605, weighted_loss: 1.5549, label: 3, bag_size: 116
batch 1700, loss: 0.2276, instance_loss: 0.2602, weighted_loss: 0.2374, label: 2, bag_size: 640
batch 1800, loss: 1.0352, instance_loss: 0.4027, weighted_loss: 0.8455, label: 2, bag_size: 562
batch 1900, loss: 0.5233, instance_loss: 0.2883, weighted_loss: 0.4528, label: 2, bag_size: 320
batch 2000, loss: 0.9190, instance_loss: 0.4906, weighted_loss: 0.7905, label: 1, bag_size: 779
batch 2100, loss: 0.8662, instance_loss: 0.4026, weighted_loss: 0.7271, label: 1, bag_size: 1781

Instance Classifier Stats
class 0 clustering acc 0.9929003456221198: correct 68947/69440
class 1 clustering acc 0.14648617511520737: correct 2543/17360

Epoch: 10, train_loss: 0.8449, train_clustering_loss:  0.4770, train_error: 0.3516
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.8261269549218031, correct coarse 898/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
Overall Accuracy: 0.6484

Val Set, val_loss: 0.8316, val_error: 0.3447, auc: 0.7461
class 0 clustering acc 0.9891098484848485: correct 8356/8448 
class 1 clustering acc 0.19649621212121213: correct 415/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5729166666666666, correct coarse 55/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6553
Overall F1 Score: 0.3402

Training for coarse level...
batch 100, loss: 0.7760, instance_loss: 0.4966, weighted_loss: 0.6922, label: 1, bag_size: 303
batch 200, loss: 0.2912, instance_loss: 0.3543, weighted_loss: 0.3101, label: 2, bag_size: 113
batch 300, loss: 0.9041, instance_loss: 0.6508, weighted_loss: 0.8281, label: 1, bag_size: 1174
batch 400, loss: 0.3175, instance_loss: 0.3066, weighted_loss: 0.3142, label: 2, bag_size: 249
batch 500, loss: 2.6554, instance_loss: 1.0514, weighted_loss: 2.1742, label: 3, bag_size: 462
batch 600, loss: 0.8315, instance_loss: 0.4632, weighted_loss: 0.7210, label: 1, bag_size: 445
batch 700, loss: 1.6450, instance_loss: 0.7921, weighted_loss: 1.3891, label: 3, bag_size: 338
batch 800, loss: 2.0935, instance_loss: 0.7913, weighted_loss: 1.7028, label: 3, bag_size: 162
batch 900, loss: 0.5327, instance_loss: 0.3902, weighted_loss: 0.4900, label: 2, bag_size: 193
batch 1000, loss: 4.2786, instance_loss: 1.2607, weighted_loss: 3.3732, label: 0, bag_size: 260
batch 1100, loss: 0.3136, instance_loss: 0.3765, weighted_loss: 0.3325, label: 1, bag_size: 309
batch 1200, loss: 0.2894, instance_loss: 0.2501, weighted_loss: 0.2776, label: 2, bag_size: 330
batch 1300, loss: 0.6602, instance_loss: 0.2355, weighted_loss: 0.5328, label: 2, bag_size: 434
batch 1400, loss: 3.6108, instance_loss: 0.9975, weighted_loss: 2.8268, label: 0, bag_size: 451
batch 1500, loss: 0.4284, instance_loss: 0.2389, weighted_loss: 0.3715, label: 2, bag_size: 689
batch 1600, loss: 0.5190, instance_loss: 0.3805, weighted_loss: 0.4774, label: 1, bag_size: 687
batch 1700, loss: 0.4806, instance_loss: 0.2358, weighted_loss: 0.4072, label: 2, bag_size: 546
batch 1800, loss: 0.3428, instance_loss: 0.3030, weighted_loss: 0.3308, label: 2, bag_size: 492
batch 1900, loss: 0.3080, instance_loss: 0.3730, weighted_loss: 0.3275, label: 1, bag_size: 1892
batch 2000, loss: 0.4718, instance_loss: 0.2329, weighted_loss: 0.4001, label: 2, bag_size: 1364
batch 2100, loss: 0.4575, instance_loss: 0.2966, weighted_loss: 0.4092, label: 2, bag_size: 299

Instance Classifier Stats
class 0 clustering acc 0.989602534562212: correct 68718/69440
class 1 clustering acc 0.19141705069124423: correct 3323/17360

Epoch: 11, train_loss: 0.8367, train_clustering_loss:  0.4679, train_error: 0.3488
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8417663293468262, correct coarse 915/1087 
coarse class 3: coarse acc 0.0038910505836575876, correct coarse 1/257 
Overall Accuracy: 0.6512

Val Set, val_loss: 0.8232, val_error: 0.3447, auc: 0.7535
class 0 clustering acc 0.9880445075757576: correct 8347/8448 
class 1 clustering acc 0.24100378787878787: correct 509/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6553
Overall F1 Score: 0.3584

Training for coarse level...
batch 100, loss: 0.7222, instance_loss: 0.5302, weighted_loss: 0.6646, label: 2, bag_size: 124
batch 200, loss: 2.3790, instance_loss: 1.0797, weighted_loss: 1.9892, label: 3, bag_size: 599
batch 300, loss: 0.9982, instance_loss: 0.5899, weighted_loss: 0.8757, label: 1, bag_size: 692
batch 400, loss: 0.6648, instance_loss: 0.5187, weighted_loss: 0.6210, label: 1, bag_size: 2019
batch 500, loss: 0.2637, instance_loss: 0.3284, weighted_loss: 0.2831, label: 1, bag_size: 207
batch 600, loss: 1.0397, instance_loss: 0.5387, weighted_loss: 0.8894, label: 1, bag_size: 558
batch 700, loss: 0.4166, instance_loss: 0.4453, weighted_loss: 0.4252, label: 1, bag_size: 270
batch 800, loss: 0.1893, instance_loss: 0.3050, weighted_loss: 0.2240, label: 1, bag_size: 357
batch 900, loss: 0.2066, instance_loss: 0.2341, weighted_loss: 0.2148, label: 2, bag_size: 600
batch 1000, loss: 0.6162, instance_loss: 0.2846, weighted_loss: 0.5167, label: 1, bag_size: 217
batch 1100, loss: 0.1955, instance_loss: 0.1445, weighted_loss: 0.1802, label: 2, bag_size: 1235
batch 1200, loss: 0.9303, instance_loss: 0.3458, weighted_loss: 0.7549, label: 2, bag_size: 338
batch 1300, loss: 0.3299, instance_loss: 0.2436, weighted_loss: 0.3040, label: 2, bag_size: 534
batch 1400, loss: 0.1703, instance_loss: 0.2002, weighted_loss: 0.1793, label: 2, bag_size: 318
batch 1500, loss: 0.0942, instance_loss: 0.2073, weighted_loss: 0.1281, label: 2, bag_size: 204
batch 1600, loss: 1.6609, instance_loss: 0.8287, weighted_loss: 1.4113, label: 3, bag_size: 720
batch 1700, loss: 0.1987, instance_loss: 0.3719, weighted_loss: 0.2507, label: 1, bag_size: 334
batch 1800, loss: 0.4537, instance_loss: 0.3437, weighted_loss: 0.4207, label: 2, bag_size: 376
batch 1900, loss: 2.6178, instance_loss: 0.9414, weighted_loss: 2.1149, label: 3, bag_size: 139
batch 2000, loss: 0.2261, instance_loss: 0.2212, weighted_loss: 0.2246, label: 2, bag_size: 229
batch 2100, loss: 0.4326, instance_loss: 0.2513, weighted_loss: 0.3782, label: 2, bag_size: 636

Instance Classifier Stats
class 0 clustering acc 0.988479262672811: correct 68640/69440
class 1 clustering acc 0.22367511520737327: correct 3883/17360

Epoch: 12, train_loss: 0.8291, train_clustering_loss:  0.4587, train_error: 0.3424
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6585677749360613, correct coarse 515/782 
coarse class 2: coarse acc 0.8371665133394665, correct coarse 910/1087 
coarse class 3: coarse acc 0.007782101167315175, correct coarse 2/257 
Overall Accuracy: 0.6576

Val Set, val_loss: 0.8156, val_error: 0.3409, auc: 0.7589
class 0 clustering acc 0.9855587121212122: correct 8326/8448 
class 1 clustering acc 0.2864583333333333: correct 605/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6591
Overall F1 Score: 0.3603

Training for coarse level...
batch 100, loss: 1.3924, instance_loss: 0.7570, weighted_loss: 1.2018, label: 1, bag_size: 241
batch 200, loss: 0.9238, instance_loss: 0.4945, weighted_loss: 0.7950, label: 2, bag_size: 291
batch 300, loss: 1.4406, instance_loss: 0.8926, weighted_loss: 1.2762, label: 3, bag_size: 1555
batch 400, loss: 1.1024, instance_loss: 0.6299, weighted_loss: 0.9607, label: 2, bag_size: 968
batch 500, loss: 1.0235, instance_loss: 0.5633, weighted_loss: 0.8855, label: 2, bag_size: 367
batch 600, loss: 2.0156, instance_loss: 0.8264, weighted_loss: 1.6589, label: 1, bag_size: 655
batch 700, loss: 0.9604, instance_loss: 0.5798, weighted_loss: 0.8462, label: 2, bag_size: 206
batch 800, loss: 0.0989, instance_loss: 0.3079, weighted_loss: 0.1616, label: 1, bag_size: 1445
batch 900, loss: 0.2505, instance_loss: 0.2325, weighted_loss: 0.2451, label: 1, bag_size: 909
batch 1000, loss: 0.9831, instance_loss: 0.6094, weighted_loss: 0.8710, label: 2, bag_size: 473
batch 1100, loss: 0.4902, instance_loss: 0.2811, weighted_loss: 0.4275, label: 2, bag_size: 1736
batch 1200, loss: 1.0283, instance_loss: 0.7380, weighted_loss: 0.9412, label: 1, bag_size: 347
batch 1300, loss: 1.5729, instance_loss: 0.7847, weighted_loss: 1.3365, label: 3, bag_size: 338
batch 1400, loss: 0.1711, instance_loss: 0.2363, weighted_loss: 0.1906, label: 1, bag_size: 410
batch 1500, loss: 0.2017, instance_loss: 0.1561, weighted_loss: 0.1880, label: 2, bag_size: 618
batch 1600, loss: 2.1613, instance_loss: 0.7902, weighted_loss: 1.7499, label: 3, bag_size: 229
batch 1700, loss: 1.1650, instance_loss: 0.6295, weighted_loss: 1.0043, label: 1, bag_size: 172
batch 1800, loss: 0.9294, instance_loss: 0.6138, weighted_loss: 0.8347, label: 1, bag_size: 1860
batch 1900, loss: 2.6535, instance_loss: 0.8310, weighted_loss: 2.1068, label: 3, bag_size: 205
batch 2000, loss: 0.2156, instance_loss: 0.3040, weighted_loss: 0.2421, label: 2, bag_size: 358
batch 2100, loss: 0.6366, instance_loss: 0.2976, weighted_loss: 0.5349, label: 2, bag_size: 654

Instance Classifier Stats
class 0 clustering acc 0.9865207373271889: correct 68504/69440
class 1 clustering acc 0.2624423963133641: correct 4556/17360

Epoch: 13, train_loss: 0.8206, train_clustering_loss:  0.4528, train_error: 0.3438
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.8399264029438822, correct coarse 913/1087 
coarse class 3: coarse acc 0.011673151750972763, correct coarse 3/257 
Overall Accuracy: 0.6562

Val Set, val_loss: 0.8097, val_error: 0.3523, auc: 0.7638
class 0 clustering acc 0.9842566287878788: correct 8315/8448 
class 1 clustering acc 0.32575757575757575: correct 688/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.7985074626865671, correct coarse 107/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6477
Overall F1 Score: 0.3565

Training for coarse level...
batch 100, loss: 0.5799, instance_loss: 0.3215, weighted_loss: 0.5024, label: 2, bag_size: 216
batch 200, loss: 0.5741, instance_loss: 0.3170, weighted_loss: 0.4969, label: 2, bag_size: 463
batch 300, loss: 0.3799, instance_loss: 0.2235, weighted_loss: 0.3330, label: 2, bag_size: 523
batch 400, loss: 0.7121, instance_loss: 0.2897, weighted_loss: 0.5854, label: 2, bag_size: 290
batch 500, loss: 1.0057, instance_loss: 0.5352, weighted_loss: 0.8645, label: 1, bag_size: 298
batch 600, loss: 3.0564, instance_loss: 0.8920, weighted_loss: 2.4071, label: 0, bag_size: 68
batch 700, loss: 0.1626, instance_loss: 0.2919, weighted_loss: 0.2014, label: 1, bag_size: 504
batch 800, loss: 1.5621, instance_loss: 0.7878, weighted_loss: 1.3298, label: 3, bag_size: 681
batch 900, loss: 0.4880, instance_loss: 0.3313, weighted_loss: 0.4410, label: 2, bag_size: 296
batch 1000, loss: 0.7142, instance_loss: 0.7441, weighted_loss: 0.7232, label: 1, bag_size: 1700
batch 1100, loss: 1.0659, instance_loss: 0.8745, weighted_loss: 1.0085, label: 1, bag_size: 976
batch 1200, loss: 1.4625, instance_loss: 0.5536, weighted_loss: 1.1898, label: 2, bag_size: 1206
batch 1300, loss: 0.0541, instance_loss: 0.1291, weighted_loss: 0.0766, label: 2, bag_size: 329
batch 1400, loss: 0.0754, instance_loss: 0.1366, weighted_loss: 0.0938, label: 2, bag_size: 403
batch 1500, loss: 0.1525, instance_loss: 0.2565, weighted_loss: 0.1837, label: 1, bag_size: 873
batch 1600, loss: 1.2571, instance_loss: 0.5280, weighted_loss: 1.0384, label: 2, bag_size: 228
batch 1700, loss: 0.2237, instance_loss: 0.1923, weighted_loss: 0.2143, label: 2, bag_size: 2141
batch 1800, loss: 0.6710, instance_loss: 0.2249, weighted_loss: 0.5372, label: 2, bag_size: 595
batch 1900, loss: 1.3261, instance_loss: 0.6032, weighted_loss: 1.1093, label: 2, bag_size: 259
batch 2000, loss: 0.2662, instance_loss: 0.3275, weighted_loss: 0.2846, label: 1, bag_size: 185
batch 2100, loss: 0.1108, instance_loss: 0.1668, weighted_loss: 0.1276, label: 2, bag_size: 544

Instance Classifier Stats
class 0 clustering acc 0.9854550691244239: correct 68430/69440
class 1 clustering acc 0.2851958525345622: correct 4951/17360

Epoch: 14, train_loss: 0.8146, train_clustering_loss:  0.4476, train_error: 0.3470
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6585677749360613, correct coarse 515/782 
coarse class 2: coarse acc 0.827046918123275, correct coarse 899/1087 
coarse class 3: coarse acc 0.011673151750972763, correct coarse 3/257 
Overall Accuracy: 0.6530

Val Set, val_loss: 0.8029, val_error: 0.3371, auc: 0.7672
class 0 clustering acc 0.982717803030303: correct 8302/8448 
class 1 clustering acc 0.35321969696969696: correct 746/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6629
Overall F1 Score: 0.3626

Training for coarse level...
batch 100, loss: 0.3563, instance_loss: 0.1542, weighted_loss: 0.2957, label: 1, bag_size: 723
batch 200, loss: 4.0190, instance_loss: 1.2152, weighted_loss: 3.1779, label: 0, bag_size: 505
batch 300, loss: 1.9168, instance_loss: 0.8391, weighted_loss: 1.5935, label: 3, bag_size: 751
batch 400, loss: 0.1088, instance_loss: 0.2251, weighted_loss: 0.1437, label: 1, bag_size: 214
batch 500, loss: 1.5126, instance_loss: 0.7074, weighted_loss: 1.2710, label: 3, bag_size: 415
batch 600, loss: 0.7682, instance_loss: 0.4915, weighted_loss: 0.6852, label: 1, bag_size: 179
batch 700, loss: 0.9955, instance_loss: 0.5940, weighted_loss: 0.8750, label: 2, bag_size: 401
batch 800, loss: 0.2613, instance_loss: 0.2199, weighted_loss: 0.2489, label: 2, bag_size: 2032
batch 900, loss: 0.2896, instance_loss: 0.3152, weighted_loss: 0.2973, label: 2, bag_size: 379
batch 1000, loss: 2.2899, instance_loss: 0.8898, weighted_loss: 1.8699, label: 3, bag_size: 1800
batch 1100, loss: 0.1812, instance_loss: 0.2503, weighted_loss: 0.2020, label: 2, bag_size: 291
batch 1200, loss: 0.1938, instance_loss: 0.1375, weighted_loss: 0.1769, label: 2, bag_size: 1005
batch 1300, loss: 1.3975, instance_loss: 0.9891, weighted_loss: 1.2750, label: 1, bag_size: 621
batch 1400, loss: 1.3288, instance_loss: 0.6586, weighted_loss: 1.1277, label: 3, bag_size: 151
batch 1500, loss: 0.2635, instance_loss: 0.2961, weighted_loss: 0.2733, label: 1, bag_size: 526
batch 1600, loss: 2.9136, instance_loss: 0.9406, weighted_loss: 2.3217, label: 0, bag_size: 235
batch 1700, loss: 0.3450, instance_loss: 0.2207, weighted_loss: 0.3077, label: 1, bag_size: 618
batch 1800, loss: 0.1927, instance_loss: 0.1502, weighted_loss: 0.1800, label: 1, bag_size: 2239
batch 1900, loss: 0.3653, instance_loss: 0.2889, weighted_loss: 0.3423, label: 2, bag_size: 307
batch 2000, loss: 0.1680, instance_loss: 0.1479, weighted_loss: 0.1620, label: 1, bag_size: 1181
batch 2100, loss: 0.5230, instance_loss: 0.3372, weighted_loss: 0.4673, label: 1, bag_size: 1323

Instance Classifier Stats
class 0 clustering acc 0.9845910138248848: correct 68370/69440
class 1 clustering acc 0.3063364055299539: correct 5318/17360

Epoch: 15, train_loss: 0.8086, train_clustering_loss:  0.4432, train_error: 0.3396
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6547314578005116, correct coarse 512/782 
coarse class 2: coarse acc 0.8426862925482981, correct coarse 916/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
Overall Accuracy: 0.6604

Val Set, val_loss: 0.7976, val_error: 0.3371, auc: 0.7694
class 0 clustering acc 0.9803503787878788: correct 8282/8448 
class 1 clustering acc 0.3716856060606061: correct 785/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6629
Overall F1 Score: 0.3636

Training for coarse level...
batch 100, loss: 1.6001, instance_loss: 0.9410, weighted_loss: 1.4024, label: 1, bag_size: 559
batch 200, loss: 1.5012, instance_loss: 0.9581, weighted_loss: 1.3383, label: 1, bag_size: 1168
batch 300, loss: 0.2097, instance_loss: 0.2773, weighted_loss: 0.2300, label: 1, bag_size: 334
batch 400, loss: 0.2774, instance_loss: 0.3129, weighted_loss: 0.2880, label: 2, bag_size: 379
batch 500, loss: 0.0857, instance_loss: 0.1279, weighted_loss: 0.0983, label: 2, bag_size: 288
batch 600, loss: 0.8139, instance_loss: 0.3789, weighted_loss: 0.6834, label: 2, bag_size: 421
batch 700, loss: 1.8123, instance_loss: 0.9044, weighted_loss: 1.5399, label: 3, bag_size: 289
batch 800, loss: 0.6716, instance_loss: 0.4478, weighted_loss: 0.6045, label: 2, bag_size: 416
batch 900, loss: 0.1819, instance_loss: 0.1424, weighted_loss: 0.1700, label: 2, bag_size: 249
batch 1000, loss: 1.1485, instance_loss: 0.5269, weighted_loss: 0.9620, label: 2, bag_size: 1897
batch 1100, loss: 0.0678, instance_loss: 0.1444, weighted_loss: 0.0908, label: 2, bag_size: 393
batch 1200, loss: 2.3027, instance_loss: 1.0896, weighted_loss: 1.9387, label: 3, bag_size: 981
batch 1300, loss: 0.0564, instance_loss: 0.1239, weighted_loss: 0.0767, label: 2, bag_size: 651
batch 1400, loss: 1.3192, instance_loss: 0.8287, weighted_loss: 1.1721, label: 3, bag_size: 1274
batch 1500, loss: 0.2516, instance_loss: 0.1474, weighted_loss: 0.2203, label: 1, bag_size: 623
batch 1600, loss: 0.9322, instance_loss: 0.6290, weighted_loss: 0.8412, label: 1, bag_size: 65
batch 1700, loss: 1.6442, instance_loss: 0.9375, weighted_loss: 1.4322, label: 2, bag_size: 3052
batch 1800, loss: 1.1366, instance_loss: 0.6498, weighted_loss: 0.9906, label: 1, bag_size: 430
batch 1900, loss: 0.3053, instance_loss: 0.2023, weighted_loss: 0.2744, label: 1, bag_size: 1090
batch 2000, loss: 0.3081, instance_loss: 0.2712, weighted_loss: 0.2970, label: 1, bag_size: 1120
batch 2100, loss: 1.8424, instance_loss: 0.7751, weighted_loss: 1.5222, label: 1, bag_size: 983

Instance Classifier Stats
class 0 clustering acc 0.9835253456221198: correct 68296/69440
class 1 clustering acc 0.3259216589861751: correct 5658/17360

Epoch: 16, train_loss: 0.8024, train_clustering_loss:  0.4399, train_error: 0.3359
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.858325666973321, correct coarse 933/1087 
coarse class 3: coarse acc 0.03501945525291829, correct coarse 9/257 
Overall Accuracy: 0.6641

Val Set, val_loss: 0.7931, val_error: 0.3523, auc: 0.7726
class 0 clustering acc 0.9790482954545454: correct 8271/8448 
class 1 clustering acc 0.3740530303030303: correct 790/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8059701492537313, correct coarse 108/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6477
Overall F1 Score: 0.3560

Training for coarse level...
batch 100, loss: 0.1083, instance_loss: 0.1731, weighted_loss: 0.1277, label: 2, bag_size: 239
batch 200, loss: 0.6861, instance_loss: 0.2835, weighted_loss: 0.5653, label: 1, bag_size: 1767
batch 300, loss: 0.1814, instance_loss: 0.2147, weighted_loss: 0.1914, label: 2, bag_size: 369
batch 400, loss: 1.9632, instance_loss: 0.9515, weighted_loss: 1.6597, label: 3, bag_size: 558
batch 500, loss: 0.5335, instance_loss: 0.3062, weighted_loss: 0.4654, label: 1, bag_size: 643
batch 600, loss: 0.2234, instance_loss: 0.1621, weighted_loss: 0.2050, label: 2, bag_size: 629
batch 700, loss: 1.4993, instance_loss: 0.8605, weighted_loss: 1.3076, label: 3, bag_size: 748
batch 800, loss: 0.4294, instance_loss: 0.2406, weighted_loss: 0.3727, label: 1, bag_size: 177
batch 900, loss: 0.1351, instance_loss: 0.2194, weighted_loss: 0.1604, label: 2, bag_size: 506
batch 1000, loss: 1.1962, instance_loss: 0.7330, weighted_loss: 1.0572, label: 3, bag_size: 312
batch 1100, loss: 2.7802, instance_loss: 1.1614, weighted_loss: 2.2945, label: 3, bag_size: 435
batch 1200, loss: 0.0765, instance_loss: 0.1135, weighted_loss: 0.0876, label: 2, bag_size: 987
batch 1300, loss: 0.3543, instance_loss: 0.2445, weighted_loss: 0.3214, label: 2, bag_size: 461
batch 1400, loss: 0.5611, instance_loss: 0.2802, weighted_loss: 0.4769, label: 2, bag_size: 735
batch 1500, loss: 0.7366, instance_loss: 0.3890, weighted_loss: 0.6323, label: 2, bag_size: 667
batch 1600, loss: 0.1654, instance_loss: 0.1958, weighted_loss: 0.1745, label: 2, bag_size: 849
batch 1700, loss: 0.1071, instance_loss: 0.1320, weighted_loss: 0.1146, label: 2, bag_size: 645
batch 1800, loss: 0.0576, instance_loss: 0.0880, weighted_loss: 0.0667, label: 2, bag_size: 460
batch 1900, loss: 1.3168, instance_loss: 0.6053, weighted_loss: 1.1034, label: 2, bag_size: 112
batch 2000, loss: 0.1828, instance_loss: 0.1237, weighted_loss: 0.1650, label: 1, bag_size: 723
batch 2100, loss: 0.4392, instance_loss: 0.3515, weighted_loss: 0.4129, label: 2, bag_size: 888

Instance Classifier Stats
class 0 clustering acc 0.9828629032258065: correct 68250/69440
class 1 clustering acc 0.338536866359447: correct 5877/17360

Epoch: 17, train_loss: 0.7988, train_clustering_loss:  0.4383, train_error: 0.3442
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6419437340153452, correct coarse 502/782 
coarse class 2: coarse acc 0.8399264029438822, correct coarse 913/1087 
coarse class 3: coarse acc 0.0311284046692607, correct coarse 8/257 
Overall Accuracy: 0.6558

Val Set, val_loss: 0.7880, val_error: 0.3371, auc: 0.7744
class 0 clustering acc 0.9783380681818182: correct 8265/8448 
class 1 clustering acc 0.38825757575757575: correct 820/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6629
Overall F1 Score: 0.3635

Training for coarse level...
batch 100, loss: 0.4040, instance_loss: 0.2982, weighted_loss: 0.3722, label: 2, bag_size: 361
batch 200, loss: 0.5664, instance_loss: 0.3008, weighted_loss: 0.4867, label: 1, bag_size: 691
batch 300, loss: 0.4025, instance_loss: 0.4763, weighted_loss: 0.4246, label: 2, bag_size: 1853
batch 400, loss: 0.2342, instance_loss: 0.2426, weighted_loss: 0.2367, label: 2, bag_size: 2114
batch 500, loss: 0.7796, instance_loss: 0.4867, weighted_loss: 0.6917, label: 1, bag_size: 1049
batch 600, loss: 0.0667, instance_loss: 0.1143, weighted_loss: 0.0810, label: 2, bag_size: 859
batch 700, loss: 0.5058, instance_loss: 0.3962, weighted_loss: 0.4729, label: 2, bag_size: 258
batch 800, loss: 0.2126, instance_loss: 0.2110, weighted_loss: 0.2121, label: 2, bag_size: 542
batch 900, loss: 0.8975, instance_loss: 0.6924, weighted_loss: 0.8360, label: 2, bag_size: 338
batch 1000, loss: 1.2040, instance_loss: 0.6404, weighted_loss: 1.0349, label: 2, bag_size: 405
batch 1100, loss: 1.0124, instance_loss: 0.6382, weighted_loss: 0.9002, label: 2, bag_size: 608
batch 1200, loss: 0.0666, instance_loss: 0.1146, weighted_loss: 0.0810, label: 2, bag_size: 827
batch 1300, loss: 0.0579, instance_loss: 0.1374, weighted_loss: 0.0817, label: 2, bag_size: 255
batch 1400, loss: 0.3602, instance_loss: 0.2193, weighted_loss: 0.3179, label: 2, bag_size: 833
batch 1500, loss: 1.4834, instance_loss: 0.7344, weighted_loss: 1.2587, label: 3, bag_size: 212
batch 1600, loss: 0.6462, instance_loss: 0.4531, weighted_loss: 0.5883, label: 2, bag_size: 317
batch 1700, loss: 0.2141, instance_loss: 0.2347, weighted_loss: 0.2203, label: 2, bag_size: 597
batch 1800, loss: 0.8124, instance_loss: 0.3968, weighted_loss: 0.6877, label: 1, bag_size: 374
batch 1900, loss: 0.7786, instance_loss: 0.3144, weighted_loss: 0.6393, label: 2, bag_size: 314
batch 2000, loss: 0.4174, instance_loss: 0.2762, weighted_loss: 0.3751, label: 2, bag_size: 1214
batch 2100, loss: 1.6675, instance_loss: 1.0714, weighted_loss: 1.4887, label: 1, bag_size: 559

Instance Classifier Stats
class 0 clustering acc 0.982315668202765: correct 68212/69440
class 1 clustering acc 0.3506336405529954: correct 6087/17360

Epoch: 18, train_loss: 0.7943, train_clustering_loss:  0.4343, train_error: 0.3406
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8491260349586016, correct coarse 923/1087 
coarse class 3: coarse acc 0.042801556420233464, correct coarse 11/257 
Overall Accuracy: 0.6594

Val Set, val_loss: 0.7847, val_error: 0.3409, auc: 0.7782
class 0 clustering acc 0.9784564393939394: correct 8266/8448 
class 1 clustering acc 0.39678030303030304: correct 838/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6591
Overall F1 Score: 0.3616

Training for coarse level...
batch 100, loss: 0.0183, instance_loss: 0.1562, weighted_loss: 0.0597, label: 2, bag_size: 83
batch 200, loss: 0.0327, instance_loss: 0.1307, weighted_loss: 0.0621, label: 2, bag_size: 439
batch 300, loss: 1.2188, instance_loss: 0.5341, weighted_loss: 1.0134, label: 1, bag_size: 334
batch 400, loss: 0.8286, instance_loss: 0.5326, weighted_loss: 0.7398, label: 2, bag_size: 124
batch 500, loss: 1.3107, instance_loss: 0.4926, weighted_loss: 1.0653, label: 1, bag_size: 185
batch 600, loss: 1.0290, instance_loss: 0.5647, weighted_loss: 0.8897, label: 2, bag_size: 202
batch 700, loss: 0.6304, instance_loss: 0.4110, weighted_loss: 0.5646, label: 2, bag_size: 464
batch 800, loss: 0.5193, instance_loss: 0.4285, weighted_loss: 0.4921, label: 2, bag_size: 206
batch 900, loss: 0.0876, instance_loss: 0.1292, weighted_loss: 0.1001, label: 2, bag_size: 834
batch 1000, loss: 0.2423, instance_loss: 0.1278, weighted_loss: 0.2080, label: 2, bag_size: 1330
batch 1100, loss: 0.3916, instance_loss: 0.1765, weighted_loss: 0.3271, label: 1, bag_size: 1150
batch 1200, loss: 0.0464, instance_loss: 0.1164, weighted_loss: 0.0674, label: 2, bag_size: 679
batch 1300, loss: 0.8523, instance_loss: 0.4154, weighted_loss: 0.7212, label: 1, bag_size: 258
batch 1400, loss: 0.1302, instance_loss: 0.2236, weighted_loss: 0.1582, label: 1, bag_size: 762
batch 1500, loss: 0.2208, instance_loss: 0.2091, weighted_loss: 0.2173, label: 1, bag_size: 128
batch 1600, loss: 0.9077, instance_loss: 0.4036, weighted_loss: 0.7565, label: 2, bag_size: 1506
batch 1700, loss: 1.3124, instance_loss: 0.5860, weighted_loss: 1.0945, label: 1, bag_size: 471
batch 1800, loss: 2.6856, instance_loss: 0.8912, weighted_loss: 2.1472, label: 2, bag_size: 585
batch 1900, loss: 0.1823, instance_loss: 0.2168, weighted_loss: 0.1926, label: 2, bag_size: 1023
batch 2000, loss: 0.3194, instance_loss: 0.1839, weighted_loss: 0.2788, label: 2, bag_size: 732
batch 2100, loss: 0.9742, instance_loss: 0.6777, weighted_loss: 0.8853, label: 2, bag_size: 387

Instance Classifier Stats
class 0 clustering acc 0.9817108294930875: correct 68170/69440
class 1 clustering acc 0.36503456221198155: correct 6337/17360

Epoch: 19, train_loss: 0.7907, train_clustering_loss:  0.4317, train_error: 0.3387
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8528058877644894, correct coarse 927/1087 
coarse class 3: coarse acc 0.042801556420233464, correct coarse 11/257 
Overall Accuracy: 0.6613

Val Set, val_loss: 0.7810, val_error: 0.3371, auc: 0.7798
class 0 clustering acc 0.9777462121212122: correct 8260/8448 
class 1 clustering acc 0.4034090909090909: correct 852/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6629
Overall F1 Score: 0.3642

Training for coarse level...
batch 100, loss: 2.7859, instance_loss: 0.9117, weighted_loss: 2.2237, label: 0, bag_size: 320
batch 200, loss: 3.8293, instance_loss: 1.1080, weighted_loss: 3.0129, label: 0, bag_size: 439
batch 300, loss: 0.6494, instance_loss: 0.3535, weighted_loss: 0.5606, label: 2, bag_size: 641
batch 400, loss: 0.1490, instance_loss: 0.2898, weighted_loss: 0.1912, label: 2, bag_size: 244
batch 500, loss: 0.5076, instance_loss: 0.3486, weighted_loss: 0.4599, label: 2, bag_size: 266
batch 600, loss: 1.5519, instance_loss: 0.7539, weighted_loss: 1.3125, label: 2, bag_size: 182
batch 700, loss: 0.3044, instance_loss: 0.2626, weighted_loss: 0.2919, label: 2, bag_size: 307
batch 800, loss: 2.5332, instance_loss: 1.0317, weighted_loss: 2.0827, label: 1, bag_size: 510
batch 900, loss: 0.0975, instance_loss: 0.1383, weighted_loss: 0.1098, label: 1, bag_size: 1947
batch 1000, loss: 1.6237, instance_loss: 0.8041, weighted_loss: 1.3778, label: 2, bag_size: 231
batch 1100, loss: 1.5436, instance_loss: 0.7336, weighted_loss: 1.3006, label: 3, bag_size: 565
batch 1200, loss: 0.3927, instance_loss: 0.2331, weighted_loss: 0.3448, label: 2, bag_size: 206
batch 1300, loss: 0.6922, instance_loss: 0.3534, weighted_loss: 0.5905, label: 2, bag_size: 599
batch 1400, loss: 2.3661, instance_loss: 0.8992, weighted_loss: 1.9261, label: 0, bag_size: 388
batch 1500, loss: 0.0556, instance_loss: 0.1882, weighted_loss: 0.0954, label: 2, bag_size: 1096
batch 1600, loss: 0.0289, instance_loss: 0.1309, weighted_loss: 0.0595, label: 1, bag_size: 305
batch 1700, loss: 0.0329, instance_loss: 0.0783, weighted_loss: 0.0465, label: 1, bag_size: 1883
batch 1800, loss: 0.9615, instance_loss: 0.4914, weighted_loss: 0.8205, label: 1, bag_size: 637
batch 1900, loss: 0.0168, instance_loss: 0.1168, weighted_loss: 0.0468, label: 2, bag_size: 336
batch 2000, loss: 0.1296, instance_loss: 0.2437, weighted_loss: 0.1638, label: 1, bag_size: 762
batch 2100, loss: 0.8026, instance_loss: 0.4289, weighted_loss: 0.6905, label: 1, bag_size: 641

Instance Classifier Stats
class 0 clustering acc 0.9813364055299539: correct 68144/69440
class 1 clustering acc 0.36612903225806454: correct 6356/17360

Epoch: 20, train_loss: 0.7866, train_clustering_loss:  0.4298, train_error: 0.3336
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6278772378516624, correct coarse 491/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.038910505836575876, correct coarse 10/257 
Overall Accuracy: 0.6664

Val Set, val_loss: 0.7801, val_error: 0.3447, auc: 0.7801
class 0 clustering acc 0.9781013257575758: correct 8263/8448 
class 1 clustering acc 0.40672348484848486: correct 859/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8134328358208955, correct coarse 109/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6553
Overall F1 Score: 0.3619

Training for coarse level...
batch 100, loss: 0.2266, instance_loss: 0.2072, weighted_loss: 0.2208, label: 1, bag_size: 457
batch 200, loss: 0.4396, instance_loss: 0.1453, weighted_loss: 0.3513, label: 2, bag_size: 703
batch 300, loss: 1.3423, instance_loss: 0.6453, weighted_loss: 1.1332, label: 2, bag_size: 325
batch 400, loss: 0.4758, instance_loss: 0.1815, weighted_loss: 0.3875, label: 2, bag_size: 510
batch 500, loss: 0.0327, instance_loss: 0.0762, weighted_loss: 0.0458, label: 2, bag_size: 905
batch 600, loss: 1.4519, instance_loss: 0.6698, weighted_loss: 1.2173, label: 1, bag_size: 933
batch 700, loss: 1.1805, instance_loss: 0.6900, weighted_loss: 1.0334, label: 1, bag_size: 161
batch 800, loss: 1.3286, instance_loss: 0.7726, weighted_loss: 1.1618, label: 3, bag_size: 338
batch 900, loss: 1.1742, instance_loss: 0.5914, weighted_loss: 0.9994, label: 1, bag_size: 558
batch 1000, loss: 0.4188, instance_loss: 0.3575, weighted_loss: 0.4004, label: 2, bag_size: 888
batch 1100, loss: 1.1146, instance_loss: 0.6813, weighted_loss: 0.9846, label: 3, bag_size: 209
batch 1200, loss: 1.0186, instance_loss: 0.4837, weighted_loss: 0.8581, label: 2, bag_size: 596
batch 1300, loss: 0.9172, instance_loss: 0.5852, weighted_loss: 0.8176, label: 1, bag_size: 1616
batch 1400, loss: 1.6604, instance_loss: 0.5493, weighted_loss: 1.3271, label: 1, bag_size: 169
batch 1500, loss: 0.4034, instance_loss: 0.3234, weighted_loss: 0.3794, label: 1, bag_size: 252
batch 1600, loss: 1.1213, instance_loss: 0.6352, weighted_loss: 0.9754, label: 2, bag_size: 132
batch 1700, loss: 0.2825, instance_loss: 0.2881, weighted_loss: 0.2842, label: 2, bag_size: 206
batch 1800, loss: 0.5376, instance_loss: 0.2312, weighted_loss: 0.4456, label: 2, bag_size: 450
batch 1900, loss: 0.3003, instance_loss: 0.1817, weighted_loss: 0.2647, label: 1, bag_size: 610
batch 2000, loss: 1.1707, instance_loss: 0.7895, weighted_loss: 1.0564, label: 1, bag_size: 371
batch 2100, loss: 0.6975, instance_loss: 0.3142, weighted_loss: 0.5825, label: 2, bag_size: 485

Instance Classifier Stats
class 0 clustering acc 0.9824452764976959: correct 68221/69440
class 1 clustering acc 0.3673963133640553: correct 6378/17360

Epoch: 21, train_loss: 0.7840, train_clustering_loss:  0.4284, train_error: 0.3350
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6406649616368286, correct coarse 501/782 
coarse class 2: coarse acc 0.8537258509659613, correct coarse 928/1087 
coarse class 3: coarse acc 0.054474708171206226, correct coarse 14/257 
Overall Accuracy: 0.6650

Val Set, val_loss: 0.7762, val_error: 0.3258, auc: 0.7815
class 0 clustering acc 0.9769176136363636: correct 8253/8448 
class 1 clustering acc 0.41382575757575757: correct 874/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
Overall Accuracy: 0.6742
Overall F1 Score: 0.3840

Training for coarse level...
batch 100, loss: 1.3065, instance_loss: 0.5694, weighted_loss: 1.0854, label: 1, bag_size: 217
batch 200, loss: 0.5057, instance_loss: 0.2727, weighted_loss: 0.4358, label: 2, bag_size: 202
batch 300, loss: 1.4668, instance_loss: 0.7405, weighted_loss: 1.2489, label: 1, bag_size: 540
batch 400, loss: 3.1812, instance_loss: 1.2217, weighted_loss: 2.5933, label: 2, bag_size: 1414
batch 500, loss: 0.9302, instance_loss: 0.5587, weighted_loss: 0.8188, label: 2, bag_size: 104
batch 600, loss: 0.0496, instance_loss: 0.0784, weighted_loss: 0.0583, label: 1, bag_size: 833
batch 700, loss: 0.0370, instance_loss: 0.1379, weighted_loss: 0.0672, label: 2, bag_size: 295
batch 800, loss: 0.0473, instance_loss: 0.1081, weighted_loss: 0.0655, label: 2, bag_size: 178
batch 900, loss: 0.4780, instance_loss: 0.2919, weighted_loss: 0.4221, label: 2, bag_size: 247
batch 1000, loss: 0.4534, instance_loss: 0.2338, weighted_loss: 0.3875, label: 1, bag_size: 265
batch 1100, loss: 0.3181, instance_loss: 0.3684, weighted_loss: 0.3332, label: 1, bag_size: 235
batch 1200, loss: 0.2300, instance_loss: 0.1575, weighted_loss: 0.2083, label: 1, bag_size: 457
batch 1300, loss: 0.7625, instance_loss: 0.4339, weighted_loss: 0.6639, label: 2, bag_size: 283
batch 1400, loss: 0.8139, instance_loss: 0.4050, weighted_loss: 0.6912, label: 2, bag_size: 225
batch 1500, loss: 0.0773, instance_loss: 0.1471, weighted_loss: 0.0983, label: 1, bag_size: 1561
batch 1600, loss: 1.0568, instance_loss: 0.4663, weighted_loss: 0.8796, label: 1, bag_size: 522
batch 1700, loss: 0.2296, instance_loss: 0.1287, weighted_loss: 0.1993, label: 2, bag_size: 1304
batch 1800, loss: 0.0308, instance_loss: 0.1096, weighted_loss: 0.0545, label: 2, bag_size: 407
batch 1900, loss: 0.0346, instance_loss: 0.0935, weighted_loss: 0.0523, label: 1, bag_size: 728
batch 2000, loss: 0.8898, instance_loss: 0.6450, weighted_loss: 0.8163, label: 3, bag_size: 172
batch 2100, loss: 2.1759, instance_loss: 1.0254, weighted_loss: 1.8307, label: 1, bag_size: 306

Instance Classifier Stats
class 0 clustering acc 0.9809187788018433: correct 68115/69440
class 1 clustering acc 0.3810483870967742: correct 6615/17360

Epoch: 22, train_loss: 0.7808, train_clustering_loss:  0.4262, train_error: 0.3373
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6253196930946292, correct coarse 489/782 
coarse class 2: coarse acc 0.8610855565777369, correct coarse 936/1087 
coarse class 3: coarse acc 0.05058365758754864, correct coarse 13/257 
Overall Accuracy: 0.6627

Val Set, val_loss: 0.7747, val_error: 0.3333, auc: 0.7842
class 0 clustering acc 0.9773910984848485: correct 8257/8448 
class 1 clustering acc 0.4161931818181818: correct 879/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.3805

Training for coarse level...
batch 100, loss: 0.8358, instance_loss: 0.5259, weighted_loss: 0.7428, label: 2, bag_size: 298
batch 200, loss: 1.5034, instance_loss: 0.7272, weighted_loss: 1.2705, label: 2, bag_size: 216
batch 300, loss: 1.1581, instance_loss: 0.6194, weighted_loss: 0.9965, label: 2, bag_size: 1897
batch 400, loss: 1.2225, instance_loss: 0.4989, weighted_loss: 1.0054, label: 1, bag_size: 282
batch 500, loss: 1.0884, instance_loss: 0.4944, weighted_loss: 0.9102, label: 2, bag_size: 375
batch 600, loss: 0.5065, instance_loss: 0.4100, weighted_loss: 0.4775, label: 2, bag_size: 770
batch 700, loss: 0.3191, instance_loss: 0.1633, weighted_loss: 0.2723, label: 2, bag_size: 1364
batch 800, loss: 0.1331, instance_loss: 0.1334, weighted_loss: 0.1332, label: 2, bag_size: 341
batch 900, loss: 0.1205, instance_loss: 0.0987, weighted_loss: 0.1140, label: 1, bag_size: 2352
batch 1000, loss: 0.6084, instance_loss: 0.3504, weighted_loss: 0.5310, label: 1, bag_size: 1897
batch 1100, loss: 0.7948, instance_loss: 0.3487, weighted_loss: 0.6609, label: 2, bag_size: 314
batch 1200, loss: 0.3678, instance_loss: 0.4055, weighted_loss: 0.3791, label: 1, bag_size: 685
batch 1300, loss: 0.5127, instance_loss: 0.3346, weighted_loss: 0.4593, label: 1, bag_size: 1667
batch 1400, loss: 1.6407, instance_loss: 0.9798, weighted_loss: 1.4424, label: 1, bag_size: 449
batch 1500, loss: 1.0840, instance_loss: 0.5850, weighted_loss: 0.9343, label: 1, bag_size: 366
batch 1600, loss: 1.0195, instance_loss: 0.4402, weighted_loss: 0.8457, label: 1, bag_size: 522
batch 1700, loss: 0.3559, instance_loss: 0.2833, weighted_loss: 0.3341, label: 1, bag_size: 927
batch 1800, loss: 0.0193, instance_loss: 0.0809, weighted_loss: 0.0378, label: 2, bag_size: 201
batch 1900, loss: 0.0408, instance_loss: 0.1011, weighted_loss: 0.0589, label: 2, bag_size: 289
batch 2000, loss: 1.0693, instance_loss: 0.4728, weighted_loss: 0.8904, label: 2, bag_size: 267
batch 2100, loss: 1.1799, instance_loss: 0.7963, weighted_loss: 1.0648, label: 3, bag_size: 149

Instance Classifier Stats
class 0 clustering acc 0.9816820276497696: correct 68168/69440
class 1 clustering acc 0.37839861751152076: correct 6569/17360

Epoch: 23, train_loss: 0.7782, train_clustering_loss:  0.4252, train_error: 0.3341
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6470588235294118, correct coarse 506/782 
coarse class 2: coarse acc 0.8482060717571297, correct coarse 922/1087 
coarse class 3: coarse acc 0.06614785992217899, correct coarse 17/257 
Overall Accuracy: 0.6659

Val Set, val_loss: 0.7715, val_error: 0.3371, auc: 0.7849
class 0 clustering acc 0.9754971590909091: correct 8241/8448 
class 1 clustering acc 0.4266098484848485: correct 901/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.59375, correct coarse 57/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
Overall Accuracy: 0.6629
Overall F1 Score: 0.3767

Training for coarse level...
batch 100, loss: 0.2991, instance_loss: 0.2562, weighted_loss: 0.2862, label: 1, bag_size: 601
batch 200, loss: 0.3517, instance_loss: 0.2891, weighted_loss: 0.3330, label: 2, bag_size: 180
batch 300, loss: 0.0894, instance_loss: 0.1144, weighted_loss: 0.0969, label: 1, bag_size: 392
batch 400, loss: 1.2209, instance_loss: 0.8521, weighted_loss: 1.1103, label: 1, bag_size: 1061
batch 500, loss: 0.5367, instance_loss: 0.3709, weighted_loss: 0.4870, label: 1, bag_size: 1667
batch 600, loss: 0.0284, instance_loss: 0.0619, weighted_loss: 0.0384, label: 2, bag_size: 397
batch 700, loss: 1.0751, instance_loss: 0.6453, weighted_loss: 0.9462, label: 1, bag_size: 501
batch 800, loss: 0.7156, instance_loss: 0.6057, weighted_loss: 0.6826, label: 1, bag_size: 1441
batch 900, loss: 1.4024, instance_loss: 0.7884, weighted_loss: 1.2182, label: 3, bag_size: 270
batch 1000, loss: 0.6243, instance_loss: 0.3822, weighted_loss: 0.5517, label: 2, bag_size: 386
batch 1100, loss: 0.9112, instance_loss: 0.5780, weighted_loss: 0.8112, label: 2, bag_size: 336
batch 1200, loss: 0.0441, instance_loss: 0.1005, weighted_loss: 0.0610, label: 2, bag_size: 349
batch 1300, loss: 0.1089, instance_loss: 0.2323, weighted_loss: 0.1460, label: 2, bag_size: 307
batch 1400, loss: 0.1926, instance_loss: 0.2632, weighted_loss: 0.2138, label: 2, bag_size: 817
batch 1500, loss: 0.5644, instance_loss: 0.3832, weighted_loss: 0.5100, label: 2, bag_size: 463
batch 1600, loss: 1.1716, instance_loss: 0.5168, weighted_loss: 0.9752, label: 1, bag_size: 248
batch 1700, loss: 1.3285, instance_loss: 0.5344, weighted_loss: 1.0903, label: 1, bag_size: 282
batch 1800, loss: 1.5628, instance_loss: 0.8946, weighted_loss: 1.3623, label: 1, bag_size: 437
batch 1900, loss: 0.1287, instance_loss: 0.1292, weighted_loss: 0.1288, label: 2, bag_size: 482
batch 2000, loss: 3.1740, instance_loss: 0.8484, weighted_loss: 2.4763, label: 0, bag_size: 352
batch 2100, loss: 1.2161, instance_loss: 0.6803, weighted_loss: 1.0553, label: 3, bag_size: 707

Instance Classifier Stats
class 0 clustering acc 0.9805731566820276: correct 68091/69440
class 1 clustering acc 0.3850230414746544: correct 6684/17360

Epoch: 24, train_loss: 0.7769, train_clustering_loss:  0.4240, train_error: 0.3300
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6163682864450127, correct coarse 482/782 
coarse class 2: coarse acc 0.8785648574057038, correct coarse 955/1087 
coarse class 3: coarse acc 0.06614785992217899, correct coarse 17/257 
Overall Accuracy: 0.6700

Val Set, val_loss: 0.7703, val_error: 0.3258, auc: 0.7857
class 0 clustering acc 0.9765625: correct 8250/8448 
class 1 clustering acc 0.4228219696969697: correct 893/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
Overall Accuracy: 0.6742
Overall F1 Score: 0.3961

Training for coarse level...
batch 100, loss: 0.1104, instance_loss: 0.0714, weighted_loss: 0.0987, label: 2, bag_size: 475
batch 200, loss: 0.2622, instance_loss: 0.1914, weighted_loss: 0.2410, label: 1, bag_size: 610
batch 300, loss: 0.0670, instance_loss: 0.1213, weighted_loss: 0.0833, label: 2, bag_size: 1140
batch 400, loss: 1.1799, instance_loss: 0.6628, weighted_loss: 1.0248, label: 1, bag_size: 205
batch 500, loss: 1.3112, instance_loss: 0.7727, weighted_loss: 1.1496, label: 1, bag_size: 250
batch 600, loss: 0.8456, instance_loss: 0.7134, weighted_loss: 0.8059, label: 1, bag_size: 975
batch 700, loss: 0.8020, instance_loss: 0.4625, weighted_loss: 0.7002, label: 2, bag_size: 644
batch 800, loss: 0.0530, instance_loss: 0.1027, weighted_loss: 0.0679, label: 2, bag_size: 637
batch 900, loss: 0.9525, instance_loss: 0.5770, weighted_loss: 0.8398, label: 2, bag_size: 334
batch 1000, loss: 0.4443, instance_loss: 0.2141, weighted_loss: 0.3752, label: 2, bag_size: 463
batch 1100, loss: 0.0556, instance_loss: 0.2693, weighted_loss: 0.1197, label: 2, bag_size: 815
batch 1200, loss: 0.6474, instance_loss: 0.3313, weighted_loss: 0.5525, label: 2, bag_size: 1135
batch 1300, loss: 0.1391, instance_loss: 0.0703, weighted_loss: 0.1185, label: 2, bag_size: 1157
batch 1400, loss: 0.1846, instance_loss: 0.1389, weighted_loss: 0.1709, label: 2, bag_size: 857
batch 1500, loss: 1.1363, instance_loss: 0.5665, weighted_loss: 0.9654, label: 2, bag_size: 331
batch 1600, loss: 0.1190, instance_loss: 0.1803, weighted_loss: 0.1374, label: 2, bag_size: 517
batch 1700, loss: 0.2736, instance_loss: 0.1854, weighted_loss: 0.2472, label: 1, bag_size: 600
batch 1800, loss: 0.0526, instance_loss: 0.2045, weighted_loss: 0.0982, label: 2, bag_size: 400
batch 1900, loss: 1.5840, instance_loss: 0.7871, weighted_loss: 1.3449, label: 3, bag_size: 850
batch 2000, loss: 0.8404, instance_loss: 0.5224, weighted_loss: 0.7450, label: 2, bag_size: 174
batch 2100, loss: 1.0990, instance_loss: 0.6288, weighted_loss: 0.9579, label: 2, bag_size: 132

Instance Classifier Stats
class 0 clustering acc 0.9811491935483871: correct 68131/69440
class 1 clustering acc 0.38173963133640554: correct 6627/17360

Epoch: 25, train_loss: 0.7751, train_clustering_loss:  0.4247, train_error: 0.3281
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8656853725850966, correct coarse 941/1087 
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257 
Overall Accuracy: 0.6719

Val Set, val_loss: 0.7685, val_error: 0.3182, auc: 0.7867
class 0 clustering acc 0.9760890151515151: correct 8246/8448 
class 1 clustering acc 0.4275568181818182: correct 903/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4111

Training for coarse level...
batch 100, loss: 0.7822, instance_loss: 0.5656, weighted_loss: 0.7172, label: 1, bag_size: 459
batch 200, loss: 0.2770, instance_loss: 0.1499, weighted_loss: 0.2389, label: 1, bag_size: 1781
batch 300, loss: 1.2965, instance_loss: 0.5431, weighted_loss: 1.0705, label: 1, bag_size: 228
batch 400, loss: 0.8603, instance_loss: 0.5849, weighted_loss: 0.7777, label: 1, bag_size: 2367
batch 500, loss: 0.0526, instance_loss: 0.0859, weighted_loss: 0.0626, label: 2, bag_size: 357
batch 600, loss: 0.5817, instance_loss: 0.3573, weighted_loss: 0.5144, label: 2, bag_size: 483
batch 700, loss: 0.4611, instance_loss: 0.2583, weighted_loss: 0.4003, label: 2, bag_size: 313
batch 800, loss: 0.5394, instance_loss: 0.3769, weighted_loss: 0.4906, label: 2, bag_size: 256
batch 900, loss: 1.3474, instance_loss: 0.6413, weighted_loss: 1.1355, label: 3, bag_size: 130
batch 1000, loss: 2.1033, instance_loss: 0.9440, weighted_loss: 1.7555, label: 3, bag_size: 388
batch 1100, loss: 0.9911, instance_loss: 0.5577, weighted_loss: 0.8611, label: 2, bag_size: 242
batch 1200, loss: 0.8329, instance_loss: 0.3677, weighted_loss: 0.6933, label: 2, bag_size: 283
batch 1300, loss: 0.5775, instance_loss: 0.2866, weighted_loss: 0.4903, label: 2, bag_size: 565
batch 1400, loss: 1.1229, instance_loss: 0.6822, weighted_loss: 0.9907, label: 3, bag_size: 888
batch 1500, loss: 0.0985, instance_loss: 0.0923, weighted_loss: 0.0966, label: 2, bag_size: 475
batch 1600, loss: 1.2890, instance_loss: 0.4686, weighted_loss: 1.0428, label: 1, bag_size: 1666
batch 1700, loss: 0.0223, instance_loss: 0.0981, weighted_loss: 0.0450, label: 2, bag_size: 190
batch 1800, loss: 0.3654, instance_loss: 0.3391, weighted_loss: 0.3575, label: 1, bag_size: 1727
batch 1900, loss: 0.6166, instance_loss: 0.3392, weighted_loss: 0.5334, label: 1, bag_size: 1293
batch 2000, loss: 1.8269, instance_loss: 1.1867, weighted_loss: 1.6349, label: 3, bag_size: 708
batch 2100, loss: 1.1288, instance_loss: 0.7014, weighted_loss: 1.0006, label: 3, bag_size: 391

Instance Classifier Stats
class 0 clustering acc 0.9805011520737327: correct 68086/69440
class 1 clustering acc 0.3912442396313364: correct 6792/17360

Epoch: 26, train_loss: 0.7730, train_clustering_loss:  0.4224, train_error: 0.3272
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6253196930946292, correct coarse 489/782 
coarse class 2: coarse acc 0.874885004599816, correct coarse 951/1087 
coarse class 3: coarse acc 0.07782101167315175, correct coarse 20/257 
Overall Accuracy: 0.6728

Val Set, val_loss: 0.7680, val_error: 0.3220, auc: 0.7889
class 0 clustering acc 0.9766808712121212: correct 8251/8448 
class 1 clustering acc 0.42329545454545453: correct 894/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.4101

Training for coarse level...
batch 100, loss: 0.4503, instance_loss: 0.3994, weighted_loss: 0.4350, label: 1, bag_size: 1628
batch 200, loss: 1.0745, instance_loss: 0.5005, weighted_loss: 0.9023, label: 2, bag_size: 305
batch 300, loss: 1.3247, instance_loss: 0.6949, weighted_loss: 1.1358, label: 2, bag_size: 216
batch 400, loss: 0.1045, instance_loss: 0.0777, weighted_loss: 0.0965, label: 1, bag_size: 1803
batch 500, loss: 0.7724, instance_loss: 0.4814, weighted_loss: 0.6851, label: 1, bag_size: 102
batch 600, loss: 0.0410, instance_loss: 0.0747, weighted_loss: 0.0511, label: 1, bag_size: 833
batch 700, loss: 1.2099, instance_loss: 0.6810, weighted_loss: 1.0513, label: 1, bag_size: 265
batch 800, loss: 0.2247, instance_loss: 0.1856, weighted_loss: 0.2130, label: 2, bag_size: 603
batch 900, loss: 0.0835, instance_loss: 0.1249, weighted_loss: 0.0959, label: 2, bag_size: 755
batch 1000, loss: 0.1262, instance_loss: 0.1562, weighted_loss: 0.1352, label: 2, bag_size: 1211
batch 1100, loss: 0.0923, instance_loss: 0.1212, weighted_loss: 0.1010, label: 2, bag_size: 265
batch 1200, loss: 0.0571, instance_loss: 0.0693, weighted_loss: 0.0608, label: 2, bag_size: 890
batch 1300, loss: 0.2605, instance_loss: 0.2344, weighted_loss: 0.2527, label: 2, bag_size: 216
batch 1400, loss: 0.4389, instance_loss: 0.2507, weighted_loss: 0.3824, label: 2, bag_size: 636
batch 1500, loss: 0.0474, instance_loss: 0.0643, weighted_loss: 0.0525, label: 2, bag_size: 206
batch 1600, loss: 0.8369, instance_loss: 0.6162, weighted_loss: 0.7707, label: 3, bag_size: 172
batch 1700, loss: 0.0391, instance_loss: 0.1038, weighted_loss: 0.0585, label: 2, bag_size: 432
batch 1800, loss: 0.2188, instance_loss: 0.1396, weighted_loss: 0.1950, label: 2, bag_size: 568
batch 1900, loss: 0.0496, instance_loss: 0.0896, weighted_loss: 0.0616, label: 2, bag_size: 874
batch 2000, loss: 2.2104, instance_loss: 1.2450, weighted_loss: 1.9208, label: 3, bag_size: 380
batch 2100, loss: 0.0414, instance_loss: 0.0716, weighted_loss: 0.0504, label: 2, bag_size: 821

Instance Classifier Stats
class 0 clustering acc 0.9811203917050692: correct 68129/69440
class 1 clustering acc 0.3888248847926267: correct 6750/17360

Epoch: 27, train_loss: 0.7713, train_clustering_loss:  0.4221, train_error: 0.3263
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8666053357865685, correct coarse 942/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
Overall Accuracy: 0.6737

Val Set, val_loss: 0.7658, val_error: 0.3182, auc: 0.7901
class 0 clustering acc 0.9764441287878788: correct 8249/8448 
class 1 clustering acc 0.42992424242424243: correct 908/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4116

Training for coarse level...
batch 100, loss: 0.1257, instance_loss: 0.1446, weighted_loss: 0.1313, label: 2, bag_size: 574
batch 200, loss: 0.1953, instance_loss: 0.1595, weighted_loss: 0.1846, label: 2, bag_size: 706
batch 300, loss: 1.0813, instance_loss: 0.6550, weighted_loss: 0.9534, label: 1, bag_size: 347
batch 400, loss: 3.5713, instance_loss: 1.0697, weighted_loss: 2.8208, label: 0, bag_size: 244
batch 500, loss: 0.3152, instance_loss: 0.2791, weighted_loss: 0.3044, label: 2, bag_size: 124
batch 600, loss: 0.0512, instance_loss: 0.0663, weighted_loss: 0.0558, label: 2, bag_size: 300
batch 700, loss: 2.2135, instance_loss: 0.9356, weighted_loss: 1.8301, label: 3, bag_size: 444
batch 800, loss: 0.0820, instance_loss: 0.0657, weighted_loss: 0.0771, label: 1, bag_size: 1947
batch 900, loss: 0.0350, instance_loss: 0.0717, weighted_loss: 0.0460, label: 2, bag_size: 371
batch 1000, loss: 0.7056, instance_loss: 0.4176, weighted_loss: 0.6192, label: 1, bag_size: 398
batch 1100, loss: 0.0209, instance_loss: 0.0842, weighted_loss: 0.0399, label: 1, bag_size: 199
batch 1200, loss: 0.7274, instance_loss: 0.5380, weighted_loss: 0.6706, label: 1, bag_size: 183
batch 1300, loss: 0.1226, instance_loss: 0.1628, weighted_loss: 0.1347, label: 1, bag_size: 983
batch 1400, loss: 1.0009, instance_loss: 0.5627, weighted_loss: 0.8694, label: 2, bag_size: 252
batch 1500, loss: 0.8674, instance_loss: 0.4625, weighted_loss: 0.7459, label: 2, bag_size: 243
batch 1600, loss: 0.3758, instance_loss: 0.2249, weighted_loss: 0.3305, label: 1, bag_size: 786
batch 1700, loss: 0.0287, instance_loss: 0.0481, weighted_loss: 0.0346, label: 2, bag_size: 474
batch 1800, loss: 1.1313, instance_loss: 0.5928, weighted_loss: 0.9698, label: 2, bag_size: 52
batch 1900, loss: 0.0826, instance_loss: 0.0989, weighted_loss: 0.0875, label: 1, bag_size: 1817
batch 2000, loss: 0.9334, instance_loss: 0.5357, weighted_loss: 0.8141, label: 2, bag_size: 853
batch 2100, loss: 0.1281, instance_loss: 0.1153, weighted_loss: 0.1242, label: 2, bag_size: 1211

Instance Classifier Stats
class 0 clustering acc 0.9814084101382489: correct 68149/69440
class 1 clustering acc 0.39395161290322583: correct 6839/17360

Epoch: 28, train_loss: 0.7699, train_clustering_loss:  0.4192, train_error: 0.3203
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8712051517939282, correct coarse 947/1087 
coarse class 3: coarse acc 0.10894941634241245, correct coarse 28/257 
Overall Accuracy: 0.6797

Val Set, val_loss: 0.7638, val_error: 0.3144, auc: 0.7912
class 0 clustering acc 0.9762073863636364: correct 8247/8448 
class 1 clustering acc 0.4303977272727273: correct 909/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4131

Training for coarse level...
batch 100, loss: 0.5248, instance_loss: 0.2901, weighted_loss: 0.4544, label: 2, bag_size: 649
batch 200, loss: 0.7730, instance_loss: 0.3607, weighted_loss: 0.6493, label: 2, bag_size: 1422
batch 300, loss: 1.7169, instance_loss: 0.7766, weighted_loss: 1.4348, label: 3, bag_size: 281
batch 400, loss: 1.5427, instance_loss: 0.5943, weighted_loss: 1.2582, label: 2, bag_size: 276
batch 500, loss: 2.2929, instance_loss: 1.0996, weighted_loss: 1.9349, label: 1, bag_size: 406
batch 600, loss: 1.3638, instance_loss: 0.6106, weighted_loss: 1.1379, label: 1, bag_size: 224
batch 700, loss: 0.0613, instance_loss: 0.0785, weighted_loss: 0.0665, label: 2, bag_size: 645
batch 800, loss: 0.9896, instance_loss: 0.5961, weighted_loss: 0.8715, label: 1, bag_size: 611
batch 900, loss: 0.2725, instance_loss: 0.1081, weighted_loss: 0.2232, label: 1, bag_size: 1726
batch 1000, loss: 1.3951, instance_loss: 0.5608, weighted_loss: 1.1448, label: 1, bag_size: 276
batch 1100, loss: 0.0698, instance_loss: 0.1123, weighted_loss: 0.0825, label: 1, bag_size: 512
batch 1200, loss: 1.5275, instance_loss: 0.7239, weighted_loss: 1.2864, label: 3, bag_size: 850
batch 1300, loss: 0.1170, instance_loss: 0.1056, weighted_loss: 0.1136, label: 2, bag_size: 1105
batch 1400, loss: 0.0533, instance_loss: 0.0857, weighted_loss: 0.0630, label: 1, bag_size: 507
batch 1500, loss: 1.7362, instance_loss: 0.7442, weighted_loss: 1.4386, label: 3, bag_size: 430
batch 1600, loss: 0.0592, instance_loss: 0.0668, weighted_loss: 0.0615, label: 2, bag_size: 893
batch 1700, loss: 2.0669, instance_loss: 0.7601, weighted_loss: 1.6748, label: 0, bag_size: 113
batch 1800, loss: 0.0825, instance_loss: 0.1327, weighted_loss: 0.0976, label: 2, bag_size: 360
batch 1900, loss: 0.6457, instance_loss: 0.3332, weighted_loss: 0.5520, label: 2, bag_size: 344
batch 2000, loss: 0.5621, instance_loss: 0.2418, weighted_loss: 0.4660, label: 2, bag_size: 609
batch 2100, loss: 0.0703, instance_loss: 0.1123, weighted_loss: 0.0829, label: 1, bag_size: 310

Instance Classifier Stats
class 0 clustering acc 0.98125: correct 68138/69440
class 1 clustering acc 0.39441244239631335: correct 6847/17360

Epoch: 29, train_loss: 0.7677, train_clustering_loss:  0.4191, train_error: 0.3244
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8702851885924563, correct coarse 946/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
Overall Accuracy: 0.6756

Val Set, val_loss: 0.7623, val_error: 0.3220, auc: 0.7916
class 0 clustering acc 0.9762073863636364: correct 8247/8448 
class 1 clustering acc 0.42945075757575757: correct 907/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.4082

Training for coarse level...
batch 100, loss: 0.0789, instance_loss: 0.0900, weighted_loss: 0.0823, label: 1, bag_size: 392
batch 200, loss: 1.0014, instance_loss: 0.4990, weighted_loss: 0.8507, label: 1, bag_size: 409
batch 300, loss: 0.7631, instance_loss: 0.4819, weighted_loss: 0.6787, label: 2, bag_size: 106
batch 400, loss: 0.8145, instance_loss: 0.2792, weighted_loss: 0.6539, label: 2, bag_size: 396
batch 500, loss: 1.3722, instance_loss: 0.7195, weighted_loss: 1.1764, label: 1, bag_size: 505
batch 600, loss: 0.0401, instance_loss: 0.0716, weighted_loss: 0.0496, label: 1, bag_size: 556
batch 700, loss: 0.1146, instance_loss: 0.1818, weighted_loss: 0.1348, label: 1, bag_size: 847
batch 800, loss: 0.9728, instance_loss: 0.5196, weighted_loss: 0.8369, label: 1, bag_size: 611
batch 900, loss: 0.3158, instance_loss: 0.3440, weighted_loss: 0.3242, label: 1, bag_size: 497
batch 1000, loss: 0.1509, instance_loss: 0.2068, weighted_loss: 0.1677, label: 1, bag_size: 334
batch 1100, loss: 1.2147, instance_loss: 0.5949, weighted_loss: 1.0288, label: 2, bag_size: 106
batch 1200, loss: 0.7487, instance_loss: 0.5537, weighted_loss: 0.6902, label: 1, bag_size: 1618
batch 1300, loss: 0.9301, instance_loss: 0.3899, weighted_loss: 0.7680, label: 2, bag_size: 1506
batch 1400, loss: 0.3422, instance_loss: 0.4164, weighted_loss: 0.3645, label: 1, bag_size: 685
batch 1500, loss: 0.2096, instance_loss: 0.1797, weighted_loss: 0.2006, label: 2, bag_size: 624
batch 1600, loss: 1.3648, instance_loss: 0.8039, weighted_loss: 1.1965, label: 1, bag_size: 534
batch 1700, loss: 1.5001, instance_loss: 0.7510, weighted_loss: 1.2754, label: 3, bag_size: 417
batch 1800, loss: 0.1858, instance_loss: 0.1502, weighted_loss: 0.1751, label: 2, bag_size: 603
batch 1900, loss: 2.4780, instance_loss: 1.1016, weighted_loss: 2.0651, label: 1, bag_size: 633
batch 2000, loss: 0.4982, instance_loss: 0.2759, weighted_loss: 0.4315, label: 2, bag_size: 318
batch 2100, loss: 0.1261, instance_loss: 0.1394, weighted_loss: 0.1301, label: 2, bag_size: 600

Instance Classifier Stats
class 0 clustering acc 0.9814084101382489: correct 68149/69440
class 1 clustering acc 0.3903225806451613: correct 6776/17360

Epoch: 30, train_loss: 0.7654, train_clustering_loss:  0.4183, train_error: 0.3217
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8712051517939282, correct coarse 947/1087 
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257 
Overall Accuracy: 0.6783

Val Set, val_loss: 0.7613, val_error: 0.3295, auc: 0.7922
class 0 clustering acc 0.9758522727272727: correct 8244/8448 
class 1 clustering acc 0.4308712121212121: correct 910/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6705
Overall F1 Score: 0.4031

Training for coarse level...
batch 100, loss: 1.9981, instance_loss: 0.8679, weighted_loss: 1.6590, label: 3, bag_size: 682
batch 200, loss: 4.8859, instance_loss: 1.5966, weighted_loss: 3.8991, label: 3, bag_size: 868
batch 300, loss: 0.0193, instance_loss: 0.0574, weighted_loss: 0.0307, label: 2, bag_size: 307
batch 400, loss: 1.2859, instance_loss: 0.6186, weighted_loss: 1.0857, label: 1, bag_size: 436
batch 500, loss: 0.0385, instance_loss: 0.0679, weighted_loss: 0.0473, label: 2, bag_size: 821
batch 600, loss: 1.0122, instance_loss: 0.6089, weighted_loss: 0.8912, label: 2, bag_size: 387
batch 700, loss: 0.6219, instance_loss: 0.4193, weighted_loss: 0.5611, label: 2, bag_size: 929
batch 800, loss: 1.4740, instance_loss: 0.7823, weighted_loss: 1.2664, label: 3, bag_size: 204
batch 900, loss: 1.0643, instance_loss: 0.6934, weighted_loss: 0.9530, label: 3, bag_size: 888
batch 1000, loss: 1.2457, instance_loss: 0.7501, weighted_loss: 1.0971, label: 3, bag_size: 464
batch 1100, loss: 0.1400, instance_loss: 0.2030, weighted_loss: 0.1589, label: 1, bag_size: 334
batch 1200, loss: 0.6480, instance_loss: 0.3409, weighted_loss: 0.5559, label: 2, bag_size: 223
batch 1300, loss: 2.1014, instance_loss: 0.9236, weighted_loss: 1.7481, label: 3, bag_size: 528
batch 1400, loss: 0.0691, instance_loss: 0.1411, weighted_loss: 0.0907, label: 2, bag_size: 745
batch 1500, loss: 0.3291, instance_loss: 0.1156, weighted_loss: 0.2650, label: 2, bag_size: 434
batch 1600, loss: 1.2480, instance_loss: 0.5755, weighted_loss: 1.0462, label: 1, bag_size: 228
batch 1700, loss: 1.1832, instance_loss: 0.8238, weighted_loss: 1.0754, label: 1, bag_size: 746
batch 1800, loss: 0.0551, instance_loss: 0.0746, weighted_loss: 0.0609, label: 2, bag_size: 334
batch 1900, loss: 0.1181, instance_loss: 0.1175, weighted_loss: 0.1179, label: 2, bag_size: 457
batch 2000, loss: 1.1815, instance_loss: 0.6732, weighted_loss: 1.0290, label: 3, bag_size: 756
batch 2100, loss: 0.8180, instance_loss: 0.3558, weighted_loss: 0.6793, label: 2, bag_size: 489

Instance Classifier Stats
class 0 clustering acc 0.9811347926267281: correct 68130/69440
class 1 clustering acc 0.3908986175115207: correct 6786/17360

Epoch: 31, train_loss: 0.7635, train_clustering_loss:  0.4192, train_error: 0.3244
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6317135549872123, correct coarse 494/782 
coarse class 2: coarse acc 0.8712051517939282, correct coarse 947/1087 
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257 
Overall Accuracy: 0.6756

Val Set, val_loss: 0.7607, val_error: 0.3258, auc: 0.7931
class 0 clustering acc 0.9757339015151515: correct 8243/8448 
class 1 clustering acc 0.4308712121212121: correct 910/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
Overall Accuracy: 0.6742
Overall F1 Score: 0.3941

Training for coarse level...
batch 100, loss: 0.2725, instance_loss: 0.2433, weighted_loss: 0.2637, label: 2, bag_size: 511
batch 200, loss: 0.7111, instance_loss: 0.5327, weighted_loss: 0.6576, label: 2, bag_size: 2046
batch 300, loss: 0.1376, instance_loss: 0.2094, weighted_loss: 0.1591, label: 2, bag_size: 498
batch 400, loss: 0.0559, instance_loss: 0.0818, weighted_loss: 0.0637, label: 2, bag_size: 192
batch 500, loss: 0.4050, instance_loss: 0.2769, weighted_loss: 0.3666, label: 2, bag_size: 1555
batch 600, loss: 0.9001, instance_loss: 0.5179, weighted_loss: 0.7855, label: 2, bag_size: 853
batch 700, loss: 0.0980, instance_loss: 0.1419, weighted_loss: 0.1112, label: 1, bag_size: 389
batch 800, loss: 0.5834, instance_loss: 0.2575, weighted_loss: 0.4856, label: 2, bag_size: 377
batch 900, loss: 1.7425, instance_loss: 0.7690, weighted_loss: 1.4504, label: 2, bag_size: 621
batch 1000, loss: 0.0726, instance_loss: 0.0956, weighted_loss: 0.0795, label: 2, bag_size: 713
batch 1100, loss: 0.2725, instance_loss: 0.2449, weighted_loss: 0.2642, label: 1, bag_size: 780
batch 1200, loss: 0.8406, instance_loss: 0.4242, weighted_loss: 0.7157, label: 2, bag_size: 243
batch 1300, loss: 0.6195, instance_loss: 0.3419, weighted_loss: 0.5362, label: 2, bag_size: 322
batch 1400, loss: 0.0824, instance_loss: 0.0687, weighted_loss: 0.0783, label: 1, bag_size: 1827
batch 1500, loss: 0.7250, instance_loss: 0.3250, weighted_loss: 0.6050, label: 2, bag_size: 462
batch 1600, loss: 1.7541, instance_loss: 0.8510, weighted_loss: 1.4832, label: 3, bag_size: 256
batch 1700, loss: 1.4422, instance_loss: 0.7547, weighted_loss: 1.2359, label: 3, bag_size: 168
batch 1800, loss: 1.6736, instance_loss: 0.7175, weighted_loss: 1.3868, label: 1, bag_size: 78
batch 1900, loss: 0.1547, instance_loss: 0.1582, weighted_loss: 0.1558, label: 2, bag_size: 358
batch 2000, loss: 0.0444, instance_loss: 0.0619, weighted_loss: 0.0496, label: 2, bag_size: 250
batch 2100, loss: 0.6376, instance_loss: 0.5105, weighted_loss: 0.5995, label: 2, bag_size: 335

Instance Classifier Stats
class 0 clustering acc 0.9810051843317973: correct 68121/69440
class 1 clustering acc 0.3986175115207373: correct 6920/17360

Epoch: 32, train_loss: 0.7630, train_clustering_loss:  0.4162, train_error: 0.3249
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6138107416879796, correct coarse 480/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
Overall Accuracy: 0.6751

Val Set, val_loss: 0.7594, val_error: 0.3144, auc: 0.7936
class 0 clustering acc 0.9760890151515151: correct 8246/8448 
class 1 clustering acc 0.4308712121212121: correct 910/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4131

Training for coarse level...
batch 100, loss: 0.3360, instance_loss: 0.2767, weighted_loss: 0.3182, label: 1, bag_size: 663
batch 200, loss: 1.3699, instance_loss: 0.6290, weighted_loss: 1.1476, label: 2, bag_size: 348
batch 300, loss: 0.0747, instance_loss: 0.1038, weighted_loss: 0.0834, label: 2, bag_size: 537
batch 400, loss: 1.1453, instance_loss: 0.6269, weighted_loss: 0.9897, label: 2, bag_size: 220
batch 500, loss: 0.2273, instance_loss: 0.1883, weighted_loss: 0.2156, label: 1, bag_size: 1892
batch 600, loss: 0.6632, instance_loss: 0.3033, weighted_loss: 0.5553, label: 2, bag_size: 814
batch 700, loss: 1.1014, instance_loss: 0.6590, weighted_loss: 0.9687, label: 2, bag_size: 128
batch 800, loss: 0.4224, instance_loss: 0.4277, weighted_loss: 0.4240, label: 2, bag_size: 353
batch 900, loss: 1.2591, instance_loss: 0.5354, weighted_loss: 1.0420, label: 2, bag_size: 718
batch 1000, loss: 0.0605, instance_loss: 0.0779, weighted_loss: 0.0657, label: 2, bag_size: 533
batch 1100, loss: 3.4777, instance_loss: 1.5235, weighted_loss: 2.8914, label: 3, bag_size: 981
batch 1200, loss: 0.0698, instance_loss: 0.0920, weighted_loss: 0.0764, label: 2, bag_size: 443
batch 1300, loss: 1.3235, instance_loss: 0.6661, weighted_loss: 1.1263, label: 3, bag_size: 581
batch 1400, loss: 0.0285, instance_loss: 0.0617, weighted_loss: 0.0384, label: 2, bag_size: 969
batch 1500, loss: 0.0341, instance_loss: 0.0784, weighted_loss: 0.0474, label: 2, bag_size: 329
batch 1600, loss: 0.5402, instance_loss: 0.3907, weighted_loss: 0.4954, label: 1, bag_size: 483
batch 1700, loss: 1.1633, instance_loss: 0.6486, weighted_loss: 1.0089, label: 3, bag_size: 388
batch 1800, loss: 1.2795, instance_loss: 0.7166, weighted_loss: 1.1106, label: 3, bag_size: 440
batch 1900, loss: 1.8263, instance_loss: 0.9316, weighted_loss: 1.5579, label: 3, bag_size: 333
batch 2000, loss: 0.4210, instance_loss: 0.1914, weighted_loss: 0.3521, label: 2, bag_size: 679
batch 2100, loss: 0.6301, instance_loss: 0.3264, weighted_loss: 0.5390, label: 2, bag_size: 292

Instance Classifier Stats
class 0 clustering acc 0.981235599078341: correct 68137/69440
class 1 clustering acc 0.3975230414746544: correct 6901/17360

Epoch: 33, train_loss: 0.7611, train_clustering_loss:  0.4162, train_error: 0.3244
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6227621483375959, correct coarse 487/782 
coarse class 2: coarse acc 0.8730450781968722, correct coarse 949/1087 
coarse class 3: coarse acc 0.11673151750972763, correct coarse 30/257 
Overall Accuracy: 0.6756

Val Set, val_loss: 0.7588, val_error: 0.3182, auc: 0.7940
class 0 clustering acc 0.9763257575757576: correct 8248/8448 
class 1 clustering acc 0.42992424242424243: correct 908/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4112

Training for coarse level...
batch 100, loss: 1.1498, instance_loss: 0.7160, weighted_loss: 1.0197, label: 2, bag_size: 663
batch 200, loss: 0.0573, instance_loss: 0.1288, weighted_loss: 0.0787, label: 2, bag_size: 789
batch 300, loss: 0.7183, instance_loss: 0.5601, weighted_loss: 0.6708, label: 2, bag_size: 154
batch 400, loss: 0.7555, instance_loss: 0.3537, weighted_loss: 0.6350, label: 2, bag_size: 599
batch 500, loss: 0.2713, instance_loss: 0.1755, weighted_loss: 0.2426, label: 2, bag_size: 661
batch 600, loss: 1.8323, instance_loss: 0.8931, weighted_loss: 1.5505, label: 1, bag_size: 393
batch 700, loss: 0.8828, instance_loss: 0.4358, weighted_loss: 0.7487, label: 2, bag_size: 595
batch 800, loss: 0.0714, instance_loss: 0.1171, weighted_loss: 0.0851, label: 1, bag_size: 207
batch 900, loss: 1.1556, instance_loss: 0.5498, weighted_loss: 0.9739, label: 1, bag_size: 179
batch 1000, loss: 0.9617, instance_loss: 0.4944, weighted_loss: 0.8215, label: 1, bag_size: 374
batch 1100, loss: 4.4366, instance_loss: 1.7151, weighted_loss: 3.6201, label: 2, bag_size: 362
batch 1200, loss: 0.2201, instance_loss: 0.3000, weighted_loss: 0.2441, label: 2, bag_size: 482
batch 1300, loss: 1.0076, instance_loss: 0.5028, weighted_loss: 0.8561, label: 2, bag_size: 309
batch 1400, loss: 0.0207, instance_loss: 0.0833, weighted_loss: 0.0395, label: 1, bag_size: 199
batch 1500, loss: 0.3997, instance_loss: 0.2868, weighted_loss: 0.3658, label: 2, bag_size: 182
batch 1600, loss: 0.3798, instance_loss: 0.2714, weighted_loss: 0.3473, label: 2, bag_size: 466
batch 1700, loss: 0.7535, instance_loss: 0.2880, weighted_loss: 0.6139, label: 2, bag_size: 465
batch 1800, loss: 0.0800, instance_loss: 0.1056, weighted_loss: 0.0877, label: 2, bag_size: 238
batch 1900, loss: 0.1704, instance_loss: 0.2010, weighted_loss: 0.1796, label: 1, bag_size: 1762
batch 2000, loss: 0.6399, instance_loss: 0.3576, weighted_loss: 0.5552, label: 1, bag_size: 501
batch 2100, loss: 1.2675, instance_loss: 0.7038, weighted_loss: 1.0983, label: 1, bag_size: 37

Instance Classifier Stats
class 0 clustering acc 0.981293202764977: correct 68141/69440
class 1 clustering acc 0.3975806451612903: correct 6902/17360

Epoch: 34, train_loss: 0.7598, train_clustering_loss:  0.4157, train_error: 0.3212
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.10894941634241245, correct coarse 28/257 
Overall Accuracy: 0.6788

Val Set, val_loss: 0.7590, val_error: 0.3220, auc: 0.7948
class 0 clustering acc 0.9770359848484849: correct 8254/8448 
class 1 clustering acc 0.4289772727272727: correct 906/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.4088

Training for coarse level...
batch 100, loss: 2.1261, instance_loss: 0.8848, weighted_loss: 1.7537, label: 3, bag_size: 269
batch 200, loss: 0.6176, instance_loss: 0.4125, weighted_loss: 0.5561, label: 2, bag_size: 333
batch 300, loss: 1.5634, instance_loss: 0.5551, weighted_loss: 1.2609, label: 1, bag_size: 119
batch 400, loss: 1.1023, instance_loss: 0.4444, weighted_loss: 0.9049, label: 1, bag_size: 522
batch 500, loss: 0.8704, instance_loss: 0.5052, weighted_loss: 0.7609, label: 2, bag_size: 253
batch 600, loss: 1.2229, instance_loss: 0.9723, weighted_loss: 1.1477, label: 1, bag_size: 1168
batch 700, loss: 0.0711, instance_loss: 0.0751, weighted_loss: 0.0723, label: 2, bag_size: 287
batch 800, loss: 0.0414, instance_loss: 0.0790, weighted_loss: 0.0527, label: 2, bag_size: 318
batch 900, loss: 0.7720, instance_loss: 0.3511, weighted_loss: 0.6458, label: 2, bag_size: 449
batch 1000, loss: 0.6745, instance_loss: 0.3129, weighted_loss: 0.5660, label: 2, bag_size: 525
batch 1100, loss: 0.5687, instance_loss: 0.3276, weighted_loss: 0.4964, label: 2, bag_size: 478
batch 1200, loss: 1.2463, instance_loss: 0.5706, weighted_loss: 1.0436, label: 3, bag_size: 22
batch 1300, loss: 1.6430, instance_loss: 0.6323, weighted_loss: 1.3398, label: 3, bag_size: 162
batch 1400, loss: 1.4332, instance_loss: 0.6120, weighted_loss: 1.1868, label: 1, bag_size: 165
batch 1500, loss: 0.1500, instance_loss: 0.2120, weighted_loss: 0.1686, label: 2, bag_size: 796
batch 1600, loss: 0.6003, instance_loss: 0.9133, weighted_loss: 0.6942, label: 2, bag_size: 658
batch 1700, loss: 0.3160, instance_loss: 0.1953, weighted_loss: 0.2798, label: 2, bag_size: 279
batch 1800, loss: 1.0431, instance_loss: 0.6014, weighted_loss: 0.9106, label: 2, bag_size: 770
batch 1900, loss: 0.9788, instance_loss: 0.6052, weighted_loss: 0.8667, label: 2, bag_size: 331
batch 2000, loss: 1.3057, instance_loss: 0.9100, weighted_loss: 1.1870, label: 1, bag_size: 1381
batch 2100, loss: 0.4548, instance_loss: 0.3729, weighted_loss: 0.4302, label: 2, bag_size: 308

Instance Classifier Stats
class 0 clustering acc 0.9814948156682027: correct 68155/69440
class 1 clustering acc 0.3988479262672811: correct 6924/17360

Epoch: 35, train_loss: 0.7582, train_clustering_loss:  0.4148, train_error: 0.3244
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8730450781968722, correct coarse 949/1087 
coarse class 3: coarse acc 0.09727626459143969, correct coarse 25/257 
Overall Accuracy: 0.6756

Val Set, val_loss: 0.7570, val_error: 0.3220, auc: 0.7951
class 0 clustering acc 0.9770359848484849: correct 8254/8448 
class 1 clustering acc 0.4308712121212121: correct 910/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.4082

Training for coarse level...
batch 100, loss: 1.7637, instance_loss: 0.7646, weighted_loss: 1.4640, label: 0, bag_size: 419
batch 200, loss: 0.2389, instance_loss: 0.2488, weighted_loss: 0.2419, label: 1, bag_size: 605
batch 300, loss: 0.7524, instance_loss: 0.7384, weighted_loss: 0.7482, label: 3, bag_size: 665
batch 400, loss: 0.0645, instance_loss: 0.0688, weighted_loss: 0.0658, label: 1, bag_size: 1673
batch 500, loss: 1.0110, instance_loss: 0.5732, weighted_loss: 0.8796, label: 1, bag_size: 271
batch 600, loss: 1.3688, instance_loss: 0.8183, weighted_loss: 1.2037, label: 1, bag_size: 98
batch 700, loss: 0.0499, instance_loss: 0.0897, weighted_loss: 0.0619, label: 2, bag_size: 290
batch 800, loss: 0.3787, instance_loss: 0.3728, weighted_loss: 0.3769, label: 2, bag_size: 481
batch 900, loss: 0.4598, instance_loss: 0.3224, weighted_loss: 0.4186, label: 2, bag_size: 346
batch 1000, loss: 1.2273, instance_loss: 0.9352, weighted_loss: 1.1397, label: 1, bag_size: 530
batch 1100, loss: 0.5798, instance_loss: 0.4002, weighted_loss: 0.5259, label: 2, bag_size: 1865
batch 1200, loss: 1.0098, instance_loss: 0.5313, weighted_loss: 0.8662, label: 1, bag_size: 454
batch 1300, loss: 1.6571, instance_loss: 0.8888, weighted_loss: 1.4266, label: 3, bag_size: 2244
batch 1400, loss: 1.5108, instance_loss: 0.7282, weighted_loss: 1.2760, label: 2, bag_size: 182
batch 1500, loss: 0.0734, instance_loss: 0.0800, weighted_loss: 0.0754, label: 1, bag_size: 1847
batch 1600, loss: 0.5359, instance_loss: 0.4039, weighted_loss: 0.4963, label: 2, bag_size: 351
batch 1700, loss: 0.1119, instance_loss: 0.1095, weighted_loss: 0.1112, label: 2, bag_size: 866
batch 1800, loss: 1.2281, instance_loss: 0.6912, weighted_loss: 1.0670, label: 3, bag_size: 478
batch 1900, loss: 0.9701, instance_loss: 0.6769, weighted_loss: 0.8821, label: 1, bag_size: 568
batch 2000, loss: 2.2740, instance_loss: 0.8011, weighted_loss: 1.8322, label: 0, bag_size: 212
batch 2100, loss: 0.1023, instance_loss: 0.1243, weighted_loss: 0.1089, label: 2, bag_size: 902

Instance Classifier Stats
class 0 clustering acc 0.9820132488479263: correct 68191/69440
class 1 clustering acc 0.39942396313364054: correct 6934/17360

Epoch: 36, train_loss: 0.7583, train_clustering_loss:  0.4139, train_error: 0.3212
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6317135549872123, correct coarse 494/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.11284046692607004, correct coarse 29/257 
Overall Accuracy: 0.6788

Val Set, val_loss: 0.7565, val_error: 0.3182, auc: 0.7955
class 0 clustering acc 0.9771543560606061: correct 8255/8448 
class 1 clustering acc 0.43323863636363635: correct 915/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4109

Training for coarse level...
batch 100, loss: 0.0346, instance_loss: 0.0914, weighted_loss: 0.0516, label: 1, bag_size: 260
batch 200, loss: 0.1554, instance_loss: 0.1497, weighted_loss: 0.1537, label: 1, bag_size: 1049
batch 300, loss: 0.0902, instance_loss: 0.1178, weighted_loss: 0.0985, label: 2, bag_size: 249
batch 400, loss: 1.0983, instance_loss: 0.5872, weighted_loss: 0.9449, label: 3, bag_size: 479
batch 500, loss: 0.0631, instance_loss: 0.0596, weighted_loss: 0.0620, label: 2, bag_size: 416
batch 600, loss: 0.0469, instance_loss: 0.0607, weighted_loss: 0.0510, label: 1, bag_size: 1981
batch 700, loss: 0.8300, instance_loss: 0.4154, weighted_loss: 0.7056, label: 2, bag_size: 641
batch 800, loss: 0.1698, instance_loss: 0.1177, weighted_loss: 0.1542, label: 2, bag_size: 765
batch 900, loss: 0.7273, instance_loss: 0.3931, weighted_loss: 0.6270, label: 2, bag_size: 337
batch 1000, loss: 4.7161, instance_loss: 1.7289, weighted_loss: 3.8199, label: 3, bag_size: 1875
batch 1100, loss: 1.1742, instance_loss: 0.5539, weighted_loss: 0.9881, label: 2, bag_size: 259
batch 1200, loss: 1.0472, instance_loss: 0.6005, weighted_loss: 0.9132, label: 2, bag_size: 968
batch 1300, loss: 0.3121, instance_loss: 0.2024, weighted_loss: 0.2792, label: 2, bag_size: 459
batch 1400, loss: 0.9163, instance_loss: 0.6429, weighted_loss: 0.8343, label: 3, bag_size: 312
batch 1500, loss: 1.5717, instance_loss: 0.7800, weighted_loss: 1.3342, label: 2, bag_size: 537
batch 1600, loss: 0.7502, instance_loss: 0.5989, weighted_loss: 0.7048, label: 2, bag_size: 209
batch 1700, loss: 0.1004, instance_loss: 0.1450, weighted_loss: 0.1138, label: 1, bag_size: 357
batch 1800, loss: 1.3718, instance_loss: 0.7103, weighted_loss: 1.1733, label: 3, bag_size: 478
batch 1900, loss: 0.0637, instance_loss: 0.1530, weighted_loss: 0.0905, label: 2, bag_size: 225
batch 2000, loss: 0.1764, instance_loss: 0.2024, weighted_loss: 0.1842, label: 1, bag_size: 292
batch 2100, loss: 0.7184, instance_loss: 0.4175, weighted_loss: 0.6281, label: 2, bag_size: 485

Instance Classifier Stats
class 0 clustering acc 0.9818836405529954: correct 68182/69440
class 1 clustering acc 0.3993663594470046: correct 6933/17360

Epoch: 37, train_loss: 0.7563, train_clustering_loss:  0.4129, train_error: 0.3207
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782 
coarse class 2: coarse acc 0.8712051517939282, correct coarse 947/1087 
coarse class 3: coarse acc 0.11284046692607004, correct coarse 29/257 
Overall Accuracy: 0.6793

Val Set, val_loss: 0.7558, val_error: 0.3182, auc: 0.7961
class 0 clustering acc 0.9767992424242424: correct 8252/8448 
class 1 clustering acc 0.43607954545454547: correct 921/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4101

Training for coarse level...
batch 100, loss: 0.4190, instance_loss: 0.2345, weighted_loss: 0.3636, label: 2, bag_size: 408
batch 200, loss: 0.5292, instance_loss: 0.3314, weighted_loss: 0.4699, label: 2, bag_size: 148
batch 300, loss: 0.1820, instance_loss: 0.1756, weighted_loss: 0.1801, label: 1, bag_size: 177
batch 400, loss: 1.2019, instance_loss: 0.6193, weighted_loss: 1.0271, label: 1, bag_size: 262
batch 500, loss: 0.8606, instance_loss: 0.5279, weighted_loss: 0.7608, label: 2, bag_size: 206
batch 600, loss: 0.0407, instance_loss: 0.0729, weighted_loss: 0.0504, label: 2, bag_size: 312
batch 700, loss: 0.7326, instance_loss: 0.4839, weighted_loss: 0.6580, label: 1, bag_size: 238
batch 800, loss: 0.2673, instance_loss: 0.1823, weighted_loss: 0.2418, label: 2, bag_size: 545
batch 900, loss: 0.6932, instance_loss: 0.4054, weighted_loss: 0.6069, label: 2, bag_size: 386
batch 1000, loss: 0.9502, instance_loss: 0.6369, weighted_loss: 0.8562, label: 3, bag_size: 628
batch 1100, loss: 0.3627, instance_loss: 0.2689, weighted_loss: 0.3346, label: 2, bag_size: 954
batch 1200, loss: 1.6048, instance_loss: 0.7622, weighted_loss: 1.3520, label: 3, bag_size: 149
batch 1300, loss: 1.3228, instance_loss: 0.8711, weighted_loss: 1.1873, label: 1, bag_size: 394
batch 1400, loss: 0.1907, instance_loss: 0.2187, weighted_loss: 0.1991, label: 1, bag_size: 506
batch 1500, loss: 1.4425, instance_loss: 0.6717, weighted_loss: 1.2112, label: 3, bag_size: 274
batch 1600, loss: 0.0861, instance_loss: 0.0689, weighted_loss: 0.0810, label: 2, bag_size: 658
batch 1700, loss: 0.8217, instance_loss: 0.5878, weighted_loss: 0.7515, label: 1, bag_size: 65
batch 1800, loss: 0.6222, instance_loss: 0.3292, weighted_loss: 0.5343, label: 1, bag_size: 2019
batch 1900, loss: 0.1004, instance_loss: 0.0902, weighted_loss: 0.0973, label: 2, bag_size: 796
batch 2000, loss: 0.0231, instance_loss: 0.0688, weighted_loss: 0.0368, label: 2, bag_size: 539
batch 2100, loss: 0.8269, instance_loss: 0.5666, weighted_loss: 0.7488, label: 1, bag_size: 1616

Instance Classifier Stats
class 0 clustering acc 0.981235599078341: correct 68137/69440
class 1 clustering acc 0.40397465437788016: correct 7013/17360

Epoch: 38, train_loss: 0.7550, train_clustering_loss:  0.4124, train_error: 0.3189
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6227621483375959, correct coarse 487/782 
coarse class 2: coarse acc 0.8859245630174793, correct coarse 963/1087 
coarse class 3: coarse acc 0.10894941634241245, correct coarse 28/257 
Overall Accuracy: 0.6811

Val Set, val_loss: 0.7558, val_error: 0.3182, auc: 0.7964
class 0 clustering acc 0.9773910984848485: correct 8257/8448 
class 1 clustering acc 0.4356060606060606: correct 920/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4109

Training for coarse level...
batch 100, loss: 0.0581, instance_loss: 0.1704, weighted_loss: 0.0918, label: 2, bag_size: 815
batch 200, loss: 1.1491, instance_loss: 0.7958, weighted_loss: 1.0431, label: 1, bag_size: 952
batch 300, loss: 0.1979, instance_loss: 0.2413, weighted_loss: 0.2109, label: 2, bag_size: 279
batch 400, loss: 0.0446, instance_loss: 0.1059, weighted_loss: 0.0630, label: 1, bag_size: 214
batch 500, loss: 0.8242, instance_loss: 0.4384, weighted_loss: 0.7085, label: 2, bag_size: 644
batch 600, loss: 1.5471, instance_loss: 0.9292, weighted_loss: 1.3617, label: 2, bag_size: 2209
batch 700, loss: 0.1913, instance_loss: 0.1385, weighted_loss: 0.1755, label: 2, bag_size: 1043
batch 800, loss: 0.1018, instance_loss: 0.1402, weighted_loss: 0.1133, label: 2, bag_size: 324
batch 900, loss: 0.0740, instance_loss: 0.0664, weighted_loss: 0.0717, label: 1, bag_size: 836
batch 1000, loss: 0.0317, instance_loss: 0.0829, weighted_loss: 0.0471, label: 2, bag_size: 266
batch 1100, loss: 1.0689, instance_loss: 0.6305, weighted_loss: 0.9374, label: 2, bag_size: 281
batch 1200, loss: 0.0715, instance_loss: 0.1267, weighted_loss: 0.0881, label: 1, bag_size: 224
batch 1300, loss: 0.7558, instance_loss: 0.7290, weighted_loss: 0.7478, label: 3, bag_size: 665
batch 1400, loss: 1.3772, instance_loss: 0.6564, weighted_loss: 1.1609, label: 1, bag_size: 446
batch 1500, loss: 1.3105, instance_loss: 0.8321, weighted_loss: 1.1670, label: 1, bag_size: 823
batch 1600, loss: 0.1379, instance_loss: 0.2035, weighted_loss: 0.1576, label: 1, bag_size: 185
batch 1700, loss: 0.0688, instance_loss: 0.1184, weighted_loss: 0.0837, label: 2, bag_size: 206
batch 1800, loss: 1.3802, instance_loss: 0.7027, weighted_loss: 1.1770, label: 1, bag_size: 324
batch 1900, loss: 0.0457, instance_loss: 0.0869, weighted_loss: 0.0581, label: 2, bag_size: 296
batch 2000, loss: 0.0146, instance_loss: 0.0511, weighted_loss: 0.0255, label: 2, bag_size: 201
batch 2100, loss: 1.7418, instance_loss: 0.6539, weighted_loss: 1.4155, label: 1, bag_size: 250

Instance Classifier Stats
class 0 clustering acc 0.9820996543778802: correct 68197/69440
class 1 clustering acc 0.40455069124423965: correct 7023/17360

Epoch: 39, train_loss: 0.7532, train_clustering_loss:  0.4118, train_error: 0.3198
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.12840466926070038, correct coarse 33/257 
Overall Accuracy: 0.6802

Val Set, val_loss: 0.7554, val_error: 0.3182, auc: 0.7969
class 0 clustering acc 0.9773910984848485: correct 8257/8448 
class 1 clustering acc 0.4384469696969697: correct 926/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4109

Training for coarse level...
batch 100, loss: 0.7606, instance_loss: 0.3918, weighted_loss: 0.6500, label: 2, bag_size: 641
batch 200, loss: 1.1272, instance_loss: 0.7173, weighted_loss: 1.0042, label: 1, bag_size: 411
batch 300, loss: 1.0964, instance_loss: 0.5317, weighted_loss: 0.9270, label: 2, bag_size: 338
batch 400, loss: 1.1281, instance_loss: 0.6217, weighted_loss: 0.9762, label: 3, bag_size: 151
batch 500, loss: 3.1383, instance_loss: 1.0724, weighted_loss: 2.5185, label: 2, bag_size: 444
batch 600, loss: 0.6750, instance_loss: 0.3626, weighted_loss: 0.5813, label: 2, bag_size: 847
batch 700, loss: 0.6311, instance_loss: 0.4021, weighted_loss: 0.5624, label: 2, bag_size: 147
batch 800, loss: 0.4286, instance_loss: 0.2146, weighted_loss: 0.3644, label: 2, bag_size: 838
batch 900, loss: 1.4127, instance_loss: 0.6695, weighted_loss: 1.1897, label: 3, bag_size: 168
batch 1000, loss: 0.1964, instance_loss: 0.2976, weighted_loss: 0.2267, label: 1, bag_size: 1120
batch 1100, loss: 0.9851, instance_loss: 0.5546, weighted_loss: 0.8560, label: 2, bag_size: 284
batch 1200, loss: 0.0189, instance_loss: 0.0378, weighted_loss: 0.0245, label: 1, bag_size: 1226
batch 1300, loss: 0.2636, instance_loss: 0.1884, weighted_loss: 0.2411, label: 2, bag_size: 422
batch 1400, loss: 1.0097, instance_loss: 0.7909, weighted_loss: 0.9441, label: 3, bag_size: 1555
batch 1500, loss: 1.4372, instance_loss: 0.9045, weighted_loss: 1.2774, label: 1, bag_size: 407
batch 1600, loss: 0.1110, instance_loss: 0.1729, weighted_loss: 0.1295, label: 1, bag_size: 2030
batch 1700, loss: 0.0927, instance_loss: 0.0912, weighted_loss: 0.0923, label: 2, bag_size: 1239
batch 1800, loss: 4.0892, instance_loss: 1.5703, weighted_loss: 3.3335, label: 3, bag_size: 1009
batch 1900, loss: 1.7686, instance_loss: 0.8558, weighted_loss: 1.4948, label: 1, bag_size: 115
batch 2000, loss: 0.0693, instance_loss: 0.1063, weighted_loss: 0.0804, label: 2, bag_size: 254
batch 2100, loss: 0.1420, instance_loss: 0.1821, weighted_loss: 0.1540, label: 2, bag_size: 849

Instance Classifier Stats
class 0 clustering acc 0.9817396313364055: correct 68172/69440
class 1 clustering acc 0.4038594470046083: correct 7011/17360

Epoch: 40, train_loss: 0.7525, train_clustering_loss:  0.4107, train_error: 0.3217
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6278772378516624, correct coarse 491/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.11284046692607004, correct coarse 29/257 
Overall Accuracy: 0.6783

Val Set, val_loss: 0.7551, val_error: 0.3295, auc: 0.7973
class 0 clustering acc 0.9773910984848485: correct 8257/8448 
class 1 clustering acc 0.43607954545454547: correct 921/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6705
Overall F1 Score: 0.4044

Training for coarse level...
batch 100, loss: 1.0679, instance_loss: 0.6425, weighted_loss: 0.9403, label: 2, bag_size: 30
batch 200, loss: 0.0925, instance_loss: 0.0808, weighted_loss: 0.0890, label: 1, bag_size: 786
batch 300, loss: 0.1512, instance_loss: 0.1107, weighted_loss: 0.1391, label: 2, bag_size: 1330
batch 400, loss: 0.1260, instance_loss: 0.1374, weighted_loss: 0.1294, label: 1, bag_size: 1052
batch 500, loss: 0.0554, instance_loss: 0.0947, weighted_loss: 0.0672, label: 2, bag_size: 599
batch 600, loss: 0.8177, instance_loss: 0.4168, weighted_loss: 0.6974, label: 2, bag_size: 450
batch 700, loss: 1.8699, instance_loss: 0.8178, weighted_loss: 1.5543, label: 2, bag_size: 506
batch 800, loss: 0.7376, instance_loss: 0.4105, weighted_loss: 0.6395, label: 2, bag_size: 1564
batch 900, loss: 1.0577, instance_loss: 0.6779, weighted_loss: 0.9438, label: 1, bag_size: 1144
batch 1000, loss: 0.8465, instance_loss: 0.4169, weighted_loss: 0.7177, label: 2, bag_size: 590
batch 1100, loss: 0.1123, instance_loss: 0.1686, weighted_loss: 0.1292, label: 2, bag_size: 292
batch 1200, loss: 0.8186, instance_loss: 0.4349, weighted_loss: 0.7035, label: 1, bag_size: 398
batch 1300, loss: 0.9530, instance_loss: 0.5408, weighted_loss: 0.8294, label: 1, bag_size: 862
batch 1400, loss: 1.1763, instance_loss: 0.6533, weighted_loss: 1.0194, label: 1, bag_size: 347
batch 1500, loss: 1.6014, instance_loss: 0.7942, weighted_loss: 1.3592, label: 3, bag_size: 901
batch 1600, loss: 3.0571, instance_loss: 1.3802, weighted_loss: 2.5540, label: 3, bag_size: 2813
batch 1700, loss: 1.5706, instance_loss: 0.7082, weighted_loss: 1.3119, label: 2, bag_size: 231
batch 1800, loss: 0.1505, instance_loss: 0.0511, weighted_loss: 0.1207, label: 2, bag_size: 1161
batch 1900, loss: 0.3611, instance_loss: 0.3051, weighted_loss: 0.3443, label: 2, bag_size: 91
batch 2000, loss: 0.1691, instance_loss: 0.2455, weighted_loss: 0.1920, label: 1, bag_size: 292
batch 2100, loss: 1.6718, instance_loss: 0.7298, weighted_loss: 1.3892, label: 3, bag_size: 435

Instance Classifier Stats
class 0 clustering acc 0.982286866359447: correct 68210/69440
class 1 clustering acc 0.4019585253456221: correct 6978/17360

Epoch: 41, train_loss: 0.7501, train_clustering_loss:  0.4099, train_error: 0.3198
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8702851885924563, correct coarse 946/1087 
coarse class 3: coarse acc 0.12840466926070038, correct coarse 33/257 
Overall Accuracy: 0.6802

Val Set, val_loss: 0.7543, val_error: 0.3182, auc: 0.7968
class 0 clustering acc 0.9772727272727273: correct 8256/8448 
class 1 clustering acc 0.43892045454545453: correct 927/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4103

Training for coarse level...
batch 100, loss: 1.3573, instance_loss: 0.6659, weighted_loss: 1.1499, label: 3, bag_size: 307
batch 200, loss: 0.0712, instance_loss: 0.0548, weighted_loss: 0.0663, label: 1, bag_size: 1490
batch 300, loss: 1.0208, instance_loss: 0.5566, weighted_loss: 0.8816, label: 1, bag_size: 371
batch 400, loss: 1.6338, instance_loss: 0.7677, weighted_loss: 1.3740, label: 2, bag_size: 201
batch 500, loss: 1.2845, instance_loss: 0.9706, weighted_loss: 1.1903, label: 1, bag_size: 566
batch 600, loss: 0.2403, instance_loss: 0.1721, weighted_loss: 0.2198, label: 1, bag_size: 1397
batch 700, loss: 0.9007, instance_loss: 0.4325, weighted_loss: 0.7602, label: 2, bag_size: 273
batch 800, loss: 1.1865, instance_loss: 0.7034, weighted_loss: 1.0416, label: 3, bag_size: 464
batch 900, loss: 0.9590, instance_loss: 0.4935, weighted_loss: 0.8193, label: 2, bag_size: 390
batch 1000, loss: 0.0284, instance_loss: 0.0761, weighted_loss: 0.0427, label: 2, bag_size: 371
batch 1100, loss: 0.9213, instance_loss: 0.7072, weighted_loss: 0.8571, label: 3, bag_size: 619
batch 1200, loss: 0.0768, instance_loss: 0.1867, weighted_loss: 0.1098, label: 2, bag_size: 576
batch 1300, loss: 0.1911, instance_loss: 0.1344, weighted_loss: 0.1741, label: 1, bag_size: 955
batch 1400, loss: 0.0329, instance_loss: 0.0356, weighted_loss: 0.0337, label: 1, bag_size: 3615
batch 1500, loss: 1.0803, instance_loss: 0.6144, weighted_loss: 0.9405, label: 1, bag_size: 205
batch 1600, loss: 0.0499, instance_loss: 0.0489, weighted_loss: 0.0496, label: 2, bag_size: 668
batch 1700, loss: 1.6042, instance_loss: 0.5587, weighted_loss: 1.2905, label: 1, bag_size: 119
batch 1800, loss: 0.0592, instance_loss: 0.1036, weighted_loss: 0.0725, label: 2, bag_size: 728
batch 1900, loss: 0.1610, instance_loss: 0.1893, weighted_loss: 0.1695, label: 1, bag_size: 3550
batch 2000, loss: 0.0864, instance_loss: 0.1358, weighted_loss: 0.1012, label: 2, bag_size: 607
batch 2100, loss: 0.5683, instance_loss: 0.4024, weighted_loss: 0.5186, label: 1, bag_size: 1269

Instance Classifier Stats
class 0 clustering acc 0.9816964285714286: correct 68169/69440
class 1 clustering acc 0.4060483870967742: correct 7049/17360

Epoch: 42, train_loss: 0.7504, train_clustering_loss:  0.4094, train_error: 0.3175
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6317135549872123, correct coarse 494/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.10894941634241245, correct coarse 28/257 
Overall Accuracy: 0.6825

Val Set, val_loss: 0.7534, val_error: 0.3220, auc: 0.7967
class 0 clustering acc 0.9777462121212122: correct 8260/8448 
class 1 clustering acc 0.4384469696969697: correct 926/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.4078

Training for coarse level...
batch 100, loss: 0.5785, instance_loss: 0.3022, weighted_loss: 0.4956, label: 2, bag_size: 867
batch 200, loss: 0.0332, instance_loss: 0.0917, weighted_loss: 0.0508, label: 2, bag_size: 432
batch 300, loss: 0.5935, instance_loss: 0.2532, weighted_loss: 0.4914, label: 2, bag_size: 389
batch 400, loss: 0.3342, instance_loss: 0.2841, weighted_loss: 0.3191, label: 2, bag_size: 353
batch 500, loss: 0.4543, instance_loss: 0.4913, weighted_loss: 0.4654, label: 1, bag_size: 837
batch 600, loss: 1.2400, instance_loss: 0.6420, weighted_loss: 1.0606, label: 3, bag_size: 489
batch 700, loss: 0.0983, instance_loss: 0.1367, weighted_loss: 0.1098, label: 1, bag_size: 304
batch 800, loss: 0.2826, instance_loss: 0.1359, weighted_loss: 0.2386, label: 2, bag_size: 743
batch 900, loss: 0.7130, instance_loss: 0.3452, weighted_loss: 0.6027, label: 2, bag_size: 566
batch 1000, loss: 0.6813, instance_loss: 0.3595, weighted_loss: 0.5848, label: 2, bag_size: 377
batch 1100, loss: 0.0611, instance_loss: 0.0923, weighted_loss: 0.0705, label: 2, bag_size: 705
batch 1200, loss: 0.6873, instance_loss: 0.4749, weighted_loss: 0.6235, label: 2, bag_size: 401
batch 1300, loss: 0.8936, instance_loss: 0.4766, weighted_loss: 0.7685, label: 2, bag_size: 146
batch 1400, loss: 0.1094, instance_loss: 0.1200, weighted_loss: 0.1126, label: 2, bag_size: 887
batch 1500, loss: 2.1967, instance_loss: 0.8769, weighted_loss: 1.8008, label: 0, bag_size: 101
batch 1600, loss: 1.0353, instance_loss: 0.6390, weighted_loss: 0.9164, label: 2, bag_size: 405
batch 1700, loss: 1.0032, instance_loss: 0.6480, weighted_loss: 0.8967, label: 1, bag_size: 1223
batch 1800, loss: 0.0273, instance_loss: 0.0295, weighted_loss: 0.0280, label: 1, bag_size: 1534
batch 1900, loss: 0.1463, instance_loss: 0.1203, weighted_loss: 0.1385, label: 2, bag_size: 656
batch 2000, loss: 1.1753, instance_loss: 0.5340, weighted_loss: 0.9829, label: 1, bag_size: 738
batch 2100, loss: 0.0699, instance_loss: 0.0735, weighted_loss: 0.0710, label: 2, bag_size: 620

Instance Classifier Stats
class 0 clustering acc 0.9816388248847926: correct 68165/69440
class 1 clustering acc 0.4032258064516129: correct 7000/17360

Epoch: 43, train_loss: 0.7487, train_clustering_loss:  0.4095, train_error: 0.3184
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6278772378516624, correct coarse 491/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
Overall Accuracy: 0.6816

Val Set, val_loss: 0.7536, val_error: 0.3258, auc: 0.7975
class 0 clustering acc 0.9776278409090909: correct 8259/8448 
class 1 clustering acc 0.43607954545454547: correct 921/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6742
Overall F1 Score: 0.4070

Training for coarse level...
batch 100, loss: 0.6509, instance_loss: 0.4969, weighted_loss: 0.6047, label: 1, bag_size: 862
batch 200, loss: 0.3226, instance_loss: 0.2961, weighted_loss: 0.3146, label: 1, bag_size: 3773
batch 300, loss: 1.1895, instance_loss: 0.6163, weighted_loss: 1.0176, label: 2, bag_size: 409
batch 400, loss: 1.9566, instance_loss: 0.8463, weighted_loss: 1.6235, label: 3, bag_size: 542
batch 500, loss: 0.1903, instance_loss: 0.1579, weighted_loss: 0.1806, label: 1, bag_size: 1567
batch 600, loss: 0.1747, instance_loss: 0.1738, weighted_loss: 0.1745, label: 2, bag_size: 649
batch 700, loss: 0.0471, instance_loss: 0.0787, weighted_loss: 0.0566, label: 2, bag_size: 562
batch 800, loss: 3.0385, instance_loss: 1.3547, weighted_loss: 2.5334, label: 3, bag_size: 2813
batch 900, loss: 3.3362, instance_loss: 0.9300, weighted_loss: 2.6143, label: 0, bag_size: 313
batch 1000, loss: 1.0416, instance_loss: 0.5594, weighted_loss: 0.8970, label: 3, bag_size: 120
batch 1100, loss: 0.5512, instance_loss: 0.3348, weighted_loss: 0.4863, label: 2, bag_size: 299
batch 1200, loss: 0.6121, instance_loss: 0.3039, weighted_loss: 0.5196, label: 2, bag_size: 370
batch 1300, loss: 0.0375, instance_loss: 0.0638, weighted_loss: 0.0454, label: 1, bag_size: 1445
batch 1400, loss: 0.9409, instance_loss: 0.6259, weighted_loss: 0.8464, label: 1, bag_size: 170
batch 1500, loss: 0.4204, instance_loss: 0.2858, weighted_loss: 0.3800, label: 1, bag_size: 1006
batch 1600, loss: 0.9943, instance_loss: 0.8891, weighted_loss: 0.9627, label: 1, bag_size: 975
batch 1700, loss: 0.8891, instance_loss: 0.5147, weighted_loss: 0.7768, label: 1, bag_size: 303
batch 1800, loss: 1.5286, instance_loss: 0.9264, weighted_loss: 1.3480, label: 3, bag_size: 1001
batch 1900, loss: 1.9753, instance_loss: 0.8137, weighted_loss: 1.6268, label: 3, bag_size: 558
batch 2000, loss: 0.0584, instance_loss: 0.0590, weighted_loss: 0.0586, label: 1, bag_size: 650
batch 2100, loss: 0.6228, instance_loss: 0.4150, weighted_loss: 0.5605, label: 2, bag_size: 317

Instance Classifier Stats
class 0 clustering acc 0.9817108294930875: correct 68170/69440
class 1 clustering acc 0.4035714285714286: correct 7006/17360

Epoch: 44, train_loss: 0.7468, train_clustering_loss:  0.4092, train_error: 0.3189
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.12840466926070038, correct coarse 33/257 
Overall Accuracy: 0.6811

Val Set, val_loss: 0.7525, val_error: 0.3220, auc: 0.7982
class 0 clustering acc 0.9773910984848485: correct 8257/8448 
class 1 clustering acc 0.4384469696969697: correct 926/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.4089

Training for coarse level...
batch 100, loss: 0.3376, instance_loss: 0.2661, weighted_loss: 0.3162, label: 2, bag_size: 375
batch 200, loss: 0.7411, instance_loss: 0.5236, weighted_loss: 0.6758, label: 2, bag_size: 104
batch 300, loss: 1.1351, instance_loss: 0.4744, weighted_loss: 0.9369, label: 2, bag_size: 509
batch 400, loss: 0.3599, instance_loss: 0.1560, weighted_loss: 0.2987, label: 2, bag_size: 578
batch 500, loss: 0.0527, instance_loss: 0.0783, weighted_loss: 0.0603, label: 2, bag_size: 458
batch 600, loss: 0.1076, instance_loss: 0.0898, weighted_loss: 0.1023, label: 2, bag_size: 887
batch 700, loss: 1.3627, instance_loss: 0.6326, weighted_loss: 1.1437, label: 3, bag_size: 307
batch 800, loss: 1.9719, instance_loss: 0.8478, weighted_loss: 1.6346, label: 0, bag_size: 235
batch 900, loss: 4.9176, instance_loss: 1.5908, weighted_loss: 3.9196, label: 1, bag_size: 477
batch 1000, loss: 0.9855, instance_loss: 0.5428, weighted_loss: 0.8527, label: 2, bag_size: 387
batch 1100, loss: 0.0758, instance_loss: 0.0773, weighted_loss: 0.0762, label: 2, bag_size: 457
batch 1200, loss: 0.0994, instance_loss: 0.0883, weighted_loss: 0.0961, label: 2, bag_size: 364
batch 1300, loss: 0.0414, instance_loss: 0.0474, weighted_loss: 0.0432, label: 1, bag_size: 1353
batch 1400, loss: 0.8848, instance_loss: 0.4368, weighted_loss: 0.7504, label: 1, bag_size: 267
batch 1500, loss: 0.0825, instance_loss: 0.4329, weighted_loss: 0.1876, label: 2, bag_size: 346
batch 1600, loss: 0.6360, instance_loss: 0.5749, weighted_loss: 0.6177, label: 2, bag_size: 209
batch 1700, loss: 4.1119, instance_loss: 1.5738, weighted_loss: 3.3505, label: 3, bag_size: 1009
batch 1800, loss: 0.1265, instance_loss: 0.1878, weighted_loss: 0.1449, label: 2, bag_size: 451
batch 1900, loss: 0.0220, instance_loss: 0.1255, weighted_loss: 0.0530, label: 2, bag_size: 337
batch 2000, loss: 0.1051, instance_loss: 0.1564, weighted_loss: 0.1205, label: 2, bag_size: 686
batch 2100, loss: 1.7675, instance_loss: 0.8891, weighted_loss: 1.5040, label: 1, bag_size: 475

Instance Classifier Stats
class 0 clustering acc 0.9819124423963134: correct 68184/69440
class 1 clustering acc 0.4068548387096774: correct 7063/17360

Epoch: 45, train_loss: 0.7467, train_clustering_loss:  0.4082, train_error: 0.3194
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
Overall Accuracy: 0.6806

Val Set, val_loss: 0.7523, val_error: 0.3258, auc: 0.7988
class 0 clustering acc 0.9783380681818182: correct 8265/8448 
class 1 clustering acc 0.4375: correct 924/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6742
Overall F1 Score: 0.4064

Training for coarse level...
batch 100, loss: 0.0430, instance_loss: 0.0651, weighted_loss: 0.0496, label: 2, bag_size: 357
batch 200, loss: 0.0523, instance_loss: 0.0558, weighted_loss: 0.0533, label: 2, bag_size: 658
batch 300, loss: 0.9956, instance_loss: 0.6499, weighted_loss: 0.8919, label: 3, bag_size: 228
batch 400, loss: 0.7477, instance_loss: 0.4178, weighted_loss: 0.6487, label: 2, bag_size: 435
batch 500, loss: 0.8664, instance_loss: 0.4652, weighted_loss: 0.7461, label: 1, bag_size: 202
batch 600, loss: 0.9356, instance_loss: 0.5804, weighted_loss: 0.8290, label: 2, bag_size: 311
batch 700, loss: 0.2042, instance_loss: 0.2225, weighted_loss: 0.2097, label: 1, bag_size: 2047
batch 800, loss: 0.6886, instance_loss: 0.5827, weighted_loss: 0.6569, label: 1, bag_size: 135
batch 900, loss: 0.1834, instance_loss: 0.0958, weighted_loss: 0.1571, label: 1, bag_size: 1958
batch 1000, loss: 1.1125, instance_loss: 0.5428, weighted_loss: 0.9416, label: 1, bag_size: 592
batch 1100, loss: 2.5924, instance_loss: 0.9378, weighted_loss: 2.0960, label: 0, bag_size: 220
batch 1200, loss: 0.0567, instance_loss: 0.0347, weighted_loss: 0.0501, label: 1, bag_size: 1046
batch 1300, loss: 0.7925, instance_loss: 0.4966, weighted_loss: 0.7038, label: 2, bag_size: 1655
batch 1400, loss: 0.1056, instance_loss: 0.1368, weighted_loss: 0.1150, label: 2, bag_size: 974
batch 1500, loss: 1.3323, instance_loss: 0.5814, weighted_loss: 1.1071, label: 1, bag_size: 774
batch 1600, loss: 0.6220, instance_loss: 0.3540, weighted_loss: 0.5416, label: 2, bag_size: 1135
batch 1700, loss: 0.1036, instance_loss: 0.1169, weighted_loss: 0.1076, label: 2, bag_size: 1211
batch 1800, loss: 0.0969, instance_loss: 0.1163, weighted_loss: 0.1028, label: 1, bag_size: 795
batch 1900, loss: 0.1148, instance_loss: 0.0862, weighted_loss: 0.1062, label: 2, bag_size: 341
batch 2000, loss: 0.0640, instance_loss: 0.0567, weighted_loss: 0.0618, label: 1, bag_size: 1549
batch 2100, loss: 1.0450, instance_loss: 0.4913, weighted_loss: 0.8789, label: 1, bag_size: 613

Instance Classifier Stats
class 0 clustering acc 0.9821572580645161: correct 68201/69440
class 1 clustering acc 0.4069700460829493: correct 7065/17360

Epoch: 46, train_loss: 0.7457, train_clustering_loss:  0.4070, train_error: 0.3184
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.11284046692607004, correct coarse 29/257 
Overall Accuracy: 0.6816

Val Set, val_loss: 0.7526, val_error: 0.3333, auc: 0.7978
class 0 clustering acc 0.9784564393939394: correct 8266/8448 
class 1 clustering acc 0.43702651515151514: correct 923/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.4017

Training for coarse level...
batch 100, loss: 1.3349, instance_loss: 0.6310, weighted_loss: 1.1237, label: 1, bag_size: 162
batch 200, loss: 0.0291, instance_loss: 0.0419, weighted_loss: 0.0329, label: 1, bag_size: 904
batch 300, loss: 0.6149, instance_loss: 0.3041, weighted_loss: 0.5217, label: 2, bag_size: 1716
batch 400, loss: 1.2577, instance_loss: 0.8560, weighted_loss: 1.1372, label: 1, bag_size: 187
batch 500, loss: 0.0258, instance_loss: 0.0368, weighted_loss: 0.0291, label: 2, bag_size: 403
batch 600, loss: 0.2469, instance_loss: 0.1194, weighted_loss: 0.2087, label: 2, bag_size: 359
batch 700, loss: 1.7693, instance_loss: 1.0292, weighted_loss: 1.5472, label: 1, bag_size: 306
batch 800, loss: 0.0824, instance_loss: 0.1043, weighted_loss: 0.0890, label: 2, bag_size: 330
batch 900, loss: 2.0855, instance_loss: 0.6873, weighted_loss: 1.6661, label: 0, bag_size: 37
batch 1000, loss: 0.7209, instance_loss: 0.6722, weighted_loss: 0.7063, label: 2, bag_size: 576
batch 1100, loss: 0.0282, instance_loss: 0.0525, weighted_loss: 0.0355, label: 2, bag_size: 1015
batch 1200, loss: 0.6710, instance_loss: 0.4124, weighted_loss: 0.5934, label: 2, bag_size: 552
batch 1300, loss: 0.1236, instance_loss: 0.0949, weighted_loss: 0.1150, label: 2, bag_size: 422
batch 1400, loss: 0.1452, instance_loss: 0.1395, weighted_loss: 0.1435, label: 2, bag_size: 605
batch 1500, loss: 2.2088, instance_loss: 0.8796, weighted_loss: 1.8100, label: 0, bag_size: 482
batch 1600, loss: 1.3183, instance_loss: 0.5782, weighted_loss: 1.0963, label: 2, bag_size: 348
batch 1700, loss: 0.0607, instance_loss: 0.1029, weighted_loss: 0.0734, label: 1, bag_size: 554
batch 1800, loss: 0.5568, instance_loss: 0.5540, weighted_loss: 0.5559, label: 1, bag_size: 510
batch 1900, loss: 0.0594, instance_loss: 0.0999, weighted_loss: 0.0716, label: 1, bag_size: 813
batch 2000, loss: 1.0828, instance_loss: 0.5643, weighted_loss: 0.9272, label: 1, bag_size: 637
batch 2100, loss: 1.2657, instance_loss: 0.7192, weighted_loss: 1.1017, label: 1, bag_size: 634

Instance Classifier Stats
class 0 clustering acc 0.9815668202764977: correct 68160/69440
class 1 clustering acc 0.4069700460829493: correct 7065/17360

Epoch: 47, train_loss: 0.7441, train_clustering_loss:  0.4086, train_error: 0.3166
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
Overall Accuracy: 0.6834

Val Set, val_loss: 0.7514, val_error: 0.3333, auc: 0.7985
class 0 clustering acc 0.9784564393939394: correct 8266/8448 
class 1 clustering acc 0.4375: correct 924/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.4017

Training for coarse level...
batch 100, loss: 0.0285, instance_loss: 0.0516, weighted_loss: 0.0354, label: 2, bag_size: 761
batch 200, loss: 0.1326, instance_loss: 0.0853, weighted_loss: 0.1184, label: 2, bag_size: 691
batch 300, loss: 1.1296, instance_loss: 0.6237, weighted_loss: 0.9778, label: 1, bag_size: 187
batch 400, loss: 0.0991, instance_loss: 0.1213, weighted_loss: 0.1057, label: 1, bag_size: 480
batch 500, loss: 0.6781, instance_loss: 0.6817, weighted_loss: 0.6792, label: 2, bag_size: 404
batch 600, loss: 0.1329, instance_loss: 0.2641, weighted_loss: 0.1723, label: 2, bag_size: 451
batch 700, loss: 0.1364, instance_loss: 0.1351, weighted_loss: 0.1360, label: 1, bag_size: 1075
batch 800, loss: 0.1942, instance_loss: 0.2895, weighted_loss: 0.2228, label: 2, bag_size: 499
batch 900, loss: 0.3248, instance_loss: 0.3223, weighted_loss: 0.3240, label: 1, bag_size: 1628
batch 1000, loss: 0.0700, instance_loss: 0.0931, weighted_loss: 0.0770, label: 1, bag_size: 941
batch 1100, loss: 1.1189, instance_loss: 0.7725, weighted_loss: 1.0150, label: 1, bag_size: 792
batch 1200, loss: 0.4600, instance_loss: 0.2980, weighted_loss: 0.4114, label: 2, bag_size: 523
batch 1300, loss: 2.3861, instance_loss: 1.0226, weighted_loss: 1.9770, label: 3, bag_size: 512
batch 1400, loss: 1.8014, instance_loss: 0.8807, weighted_loss: 1.5252, label: 1, bag_size: 127
batch 1500, loss: 0.1026, instance_loss: 0.0965, weighted_loss: 0.1007, label: 2, bag_size: 597
batch 1600, loss: 1.0876, instance_loss: 0.5956, weighted_loss: 0.9400, label: 3, bag_size: 207
batch 1700, loss: 0.2849, instance_loss: 0.1693, weighted_loss: 0.2502, label: 2, bag_size: 545
batch 1800, loss: 2.0774, instance_loss: 0.8262, weighted_loss: 1.7020, label: 0, bag_size: 277
batch 1900, loss: 0.0287, instance_loss: 0.0468, weighted_loss: 0.0341, label: 2, bag_size: 507
batch 2000, loss: 1.3247, instance_loss: 0.6037, weighted_loss: 1.1084, label: 1, bag_size: 162
batch 2100, loss: 0.8976, instance_loss: 0.4982, weighted_loss: 0.7778, label: 2, bag_size: 169

Instance Classifier Stats
class 0 clustering acc 0.9817684331797235: correct 68174/69440
class 1 clustering acc 0.4080069124423963: correct 7083/17360

Epoch: 48, train_loss: 0.7439, train_clustering_loss:  0.4069, train_error: 0.3147
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6317135549872123, correct coarse 494/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.1245136186770428, correct coarse 32/257 
Overall Accuracy: 0.6853

Val Set, val_loss: 0.7525, val_error: 0.3371, auc: 0.7974
class 0 clustering acc 0.9786931818181818: correct 8268/8448 
class 1 clustering acc 0.43323863636363635: correct 915/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6629
Overall F1 Score: 0.3994

Training for coarse level...
batch 100, loss: 0.0979, instance_loss: 0.0956, weighted_loss: 0.0972, label: 2, bag_size: 424
batch 200, loss: 1.4473, instance_loss: 0.7104, weighted_loss: 1.2262, label: 2, bag_size: 276
batch 300, loss: 0.3187, instance_loss: 0.2231, weighted_loss: 0.2900, label: 2, bag_size: 773
batch 400, loss: 1.1370, instance_loss: 0.7720, weighted_loss: 1.0275, label: 1, bag_size: 823
batch 500, loss: 0.6450, instance_loss: 0.3477, weighted_loss: 0.5558, label: 2, bag_size: 315
batch 600, loss: 1.3647, instance_loss: 0.6504, weighted_loss: 1.1504, label: 3, bag_size: 478
batch 700, loss: 0.8960, instance_loss: 0.6547, weighted_loss: 0.8237, label: 3, bag_size: 312
batch 800, loss: 0.0955, instance_loss: 0.0724, weighted_loss: 0.0886, label: 1, bag_size: 3982
batch 900, loss: 1.9255, instance_loss: 0.8590, weighted_loss: 1.6055, label: 3, bag_size: 542
batch 1000, loss: 0.0737, instance_loss: 0.0993, weighted_loss: 0.0814, label: 2, bag_size: 238
batch 1100, loss: 0.0744, instance_loss: 0.0798, weighted_loss: 0.0760, label: 2, bag_size: 226
batch 1200, loss: 2.1803, instance_loss: 1.2542, weighted_loss: 1.9024, label: 3, bag_size: 481
batch 1300, loss: 1.4966, instance_loss: 0.8286, weighted_loss: 1.2962, label: 1, bag_size: 529
batch 1400, loss: 0.4510, instance_loss: 0.2933, weighted_loss: 0.4037, label: 1, bag_size: 900
batch 1500, loss: 1.0423, instance_loss: 0.4338, weighted_loss: 0.8597, label: 1, bag_size: 183
batch 1600, loss: 0.7680, instance_loss: 0.5310, weighted_loss: 0.6969, label: 1, bag_size: 473
batch 1700, loss: 0.0513, instance_loss: 0.1034, weighted_loss: 0.0669, label: 2, bag_size: 193
batch 1800, loss: 0.0723, instance_loss: 0.1482, weighted_loss: 0.0951, label: 2, bag_size: 576
batch 1900, loss: 2.2298, instance_loss: 1.2197, weighted_loss: 1.9268, label: 1, bag_size: 424
batch 2000, loss: 0.0998, instance_loss: 0.0800, weighted_loss: 0.0939, label: 2, bag_size: 887
batch 2100, loss: 0.2785, instance_loss: 0.1015, weighted_loss: 0.2254, label: 1, bag_size: 1726

Instance Classifier Stats
class 0 clustering acc 0.9828629032258065: correct 68250/69440
class 1 clustering acc 0.40339861751152073: correct 7003/17360

Epoch: 49, train_loss: 0.7417, train_clustering_loss:  0.4061, train_error: 0.3157
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.1245136186770428, correct coarse 32/257 
Overall Accuracy: 0.6843

Val Set, val_loss: 0.7519, val_error: 0.3371, auc: 0.7973
class 0 clustering acc 0.9786931818181818: correct 8268/8448 
class 1 clustering acc 0.4341856060606061: correct 917/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6629
Overall F1 Score: 0.3994

