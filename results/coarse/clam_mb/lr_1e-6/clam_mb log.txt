Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for coarse level...
batch 100, loss: 1.2325, instance_loss: 1.3906, weighted_loss: 1.2799, label: 2, bag_size: 905
batch 200, loss: 1.6120, instance_loss: 1.4374, weighted_loss: 1.5596, label: 3, bag_size: 288
batch 300, loss: 1.3120, instance_loss: 1.3513, weighted_loss: 1.3238, label: 1, bag_size: 1704
batch 400, loss: 1.5583, instance_loss: 1.4411, weighted_loss: 1.5231, label: 3, bag_size: 1529
batch 500, loss: 1.5657, instance_loss: 1.4947, weighted_loss: 1.5444, label: 3, bag_size: 256
batch 600, loss: 1.2525, instance_loss: 1.2541, weighted_loss: 1.2530, label: 1, bag_size: 706
batch 700, loss: 0.9329, instance_loss: 1.1777, weighted_loss: 1.0063, label: 2, bag_size: 234
batch 800, loss: 0.9492, instance_loss: 1.1142, weighted_loss: 0.9987, label: 2, bag_size: 1364
batch 900, loss: 1.8228, instance_loss: 1.2767, weighted_loss: 1.6589, label: 3, bag_size: 174
batch 1000, loss: 0.8125, instance_loss: 1.1169, weighted_loss: 0.9039, label: 2, bag_size: 732
batch 1100, loss: 0.8191, instance_loss: 1.0870, weighted_loss: 0.8995, label: 2, bag_size: 317
batch 1200, loss: 0.9320, instance_loss: 1.1741, weighted_loss: 1.0046, label: 2, bag_size: 409
batch 1300, loss: 0.8543, instance_loss: 0.9847, weighted_loss: 0.8934, label: 2, bag_size: 390
batch 1400, loss: 0.8048, instance_loss: 1.0853, weighted_loss: 0.8889, label: 2, bag_size: 357
batch 1500, loss: 0.8563, instance_loss: 0.9734, weighted_loss: 0.8915, label: 2, bag_size: 2033
batch 1600, loss: 0.7264, instance_loss: 1.0305, weighted_loss: 0.8176, label: 2, bag_size: 628
batch 1700, loss: 0.8288, instance_loss: 0.8887, weighted_loss: 0.8468, label: 2, bag_size: 267
batch 1800, loss: 1.1531, instance_loss: 0.9245, weighted_loss: 1.0845, label: 1, bag_size: 1522
batch 1900, loss: 1.0773, instance_loss: 0.9362, weighted_loss: 1.0350, label: 1, bag_size: 350
batch 2000, loss: 0.7126, instance_loss: 0.8602, weighted_loss: 0.7569, label: 2, bag_size: 485
batch 2100, loss: 1.2426, instance_loss: 0.9112, weighted_loss: 1.1432, label: 1, bag_size: 1323

Instance Classifier Stats
class 0 clustering acc 0.7112903225806452: correct 49392/69440
class 1 clustering acc 0.3588709677419355: correct 6230/17360

Epoch: 1, train_loss: 1.1680, train_clustering_loss:  1.1415, train_error: 0.5055
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.015345268542199489, correct coarse 12/782 
coarse class 2: coarse acc 0.9760809567617296, correct coarse 1061/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.4945

Val Set, val_loss: 1.0483, val_error: 0.4924, auc: 0.5952
class 0 clustering acc 0.9718276515151515: correct 8210/8448 
class 1 clustering acc 0.028409090909090908: correct 60/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.0, correct coarse 0/96 
coarse class 2: coarse acc 1.0, correct coarse 134/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1688

Training for coarse level...
batch 100, loss: 1.0917, instance_loss: 0.8428, weighted_loss: 1.0170, label: 1, bag_size: 476
batch 200, loss: 1.1647, instance_loss: 0.9190, weighted_loss: 1.0910, label: 1, bag_size: 237
batch 300, loss: 0.8706, instance_loss: 0.8167, weighted_loss: 0.8545, label: 2, bag_size: 252
batch 400, loss: 0.6347, instance_loss: 0.8394, weighted_loss: 0.6961, label: 2, bag_size: 331
batch 500, loss: 0.8238, instance_loss: 0.7484, weighted_loss: 0.8012, label: 2, bag_size: 471
batch 600, loss: 0.9558, instance_loss: 0.8321, weighted_loss: 0.9187, label: 2, bag_size: 544
batch 700, loss: 0.6969, instance_loss: 0.7011, weighted_loss: 0.6982, label: 2, bag_size: 580
batch 800, loss: 0.8238, instance_loss: 0.9071, weighted_loss: 0.8488, label: 2, bag_size: 651
batch 900, loss: 0.6324, instance_loss: 0.7770, weighted_loss: 0.6758, label: 2, bag_size: 330
batch 1000, loss: 1.2251, instance_loss: 0.7052, weighted_loss: 1.0691, label: 1, bag_size: 190
batch 1100, loss: 0.6560, instance_loss: 0.7005, weighted_loss: 0.6693, label: 2, bag_size: 933
batch 1200, loss: 0.7542, instance_loss: 0.6296, weighted_loss: 0.7168, label: 2, bag_size: 337
batch 1300, loss: 2.0026, instance_loss: 0.8363, weighted_loss: 1.6527, label: 3, bag_size: 479
batch 1400, loss: 0.6442, instance_loss: 0.7258, weighted_loss: 0.6687, label: 2, bag_size: 712
batch 1500, loss: 0.9178, instance_loss: 0.7197, weighted_loss: 0.8584, label: 1, bag_size: 660
batch 1600, loss: 0.6296, instance_loss: 0.6542, weighted_loss: 0.6370, label: 2, bag_size: 305
batch 1700, loss: 0.7220, instance_loss: 0.6565, weighted_loss: 0.7024, label: 2, bag_size: 595
batch 1800, loss: 1.0159, instance_loss: 0.7723, weighted_loss: 0.9428, label: 1, bag_size: 1447
batch 1900, loss: 1.0440, instance_loss: 0.8164, weighted_loss: 0.9757, label: 1, bag_size: 167
batch 2000, loss: 1.2065, instance_loss: 0.7102, weighted_loss: 1.0576, label: 1, bag_size: 326
batch 2100, loss: 1.0431, instance_loss: 0.6810, weighted_loss: 0.9345, label: 1, bag_size: 1229

Instance Classifier Stats
class 0 clustering acc 0.9857718894009216: correct 68452/69440
class 1 clustering acc 0.02171658986175115: correct 377/17360

Epoch: 2, train_loss: 1.0281, train_clustering_loss:  0.7676, train_error: 0.4747
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.08439897698209718, correct coarse 66/782 
coarse class 2: coarse acc 0.9880404783808647, correct coarse 1074/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.5253

Val Set, val_loss: 0.9830, val_error: 0.4470, auc: 0.6433
class 0 clustering acc 0.9989346590909091: correct 8439/8448 
class 1 clustering acc 0.0004734848484848485: correct 1/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.16666666666666666, correct coarse 16/96 
coarse class 2: coarse acc 0.9701492537313433, correct coarse 130/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.5530
Overall F1 Score: 0.2408

Training for coarse level...
batch 100, loss: 3.0977, instance_loss: 0.8124, weighted_loss: 2.4121, label: 0, bag_size: 482
batch 200, loss: 0.6041, instance_loss: 0.6487, weighted_loss: 0.6175, label: 2, bag_size: 291
batch 300, loss: 2.0039, instance_loss: 0.7627, weighted_loss: 1.6316, label: 3, bag_size: 435
batch 400, loss: 1.1592, instance_loss: 0.6751, weighted_loss: 1.0140, label: 1, bag_size: 363
batch 500, loss: 0.9906, instance_loss: 0.9154, weighted_loss: 0.9680, label: 2, bag_size: 473
batch 600, loss: 0.7566, instance_loss: 0.5233, weighted_loss: 0.6866, label: 2, bag_size: 683
batch 700, loss: 0.9238, instance_loss: 0.6524, weighted_loss: 0.8424, label: 1, bag_size: 267
batch 800, loss: 1.0702, instance_loss: 0.6159, weighted_loss: 0.9339, label: 1, bag_size: 421
batch 900, loss: 1.1746, instance_loss: 0.6829, weighted_loss: 1.0271, label: 1, bag_size: 65
batch 1000, loss: 0.6564, instance_loss: 0.5644, weighted_loss: 0.6288, label: 2, bag_size: 858
batch 1100, loss: 0.4533, instance_loss: 0.5139, weighted_loss: 0.4714, label: 2, bag_size: 587
batch 1200, loss: 0.4810, instance_loss: 0.5420, weighted_loss: 0.4993, label: 2, bag_size: 360
batch 1300, loss: 2.3090, instance_loss: 0.9259, weighted_loss: 1.8941, label: 0, bag_size: 258
batch 1400, loss: 0.6404, instance_loss: 0.4753, weighted_loss: 0.5909, label: 2, bag_size: 714
batch 1500, loss: 0.4341, instance_loss: 0.5531, weighted_loss: 0.4698, label: 2, bag_size: 198
batch 1600, loss: 1.9456, instance_loss: 0.7271, weighted_loss: 1.5800, label: 3, bag_size: 383
batch 1700, loss: 0.5916, instance_loss: 0.5818, weighted_loss: 0.5886, label: 2, bag_size: 333
batch 1800, loss: 2.1338, instance_loss: 0.7555, weighted_loss: 1.7203, label: 3, bag_size: 876
batch 1900, loss: 2.0866, instance_loss: 0.8603, weighted_loss: 1.7188, label: 3, bag_size: 427
batch 2000, loss: 0.6715, instance_loss: 0.4972, weighted_loss: 0.6193, label: 2, bag_size: 625
batch 2100, loss: 1.0169, instance_loss: 0.5848, weighted_loss: 0.8872, label: 1, bag_size: 189

Instance Classifier Stats
class 0 clustering acc 0.9990783410138249: correct 69376/69440
class 1 clustering acc 0.0016705069124423964: correct 29/17360

Epoch: 3, train_loss: 0.9823, train_clustering_loss:  0.6267, train_error: 0.4226
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.2813299232736573, correct coarse 220/782 
coarse class 2: coarse acc 0.9503219871205152, correct coarse 1033/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.5774

Val Set, val_loss: 0.9487, val_error: 0.3788, auc: 0.6724
class 0 clustering acc 1.0: correct 8448/8448 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.3958333333333333, correct coarse 38/96 
coarse class 2: coarse acc 0.9402985074626866, correct coarse 126/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6212
Overall F1 Score: 0.3101

Training for coarse level...
batch 100, loss: 0.6666, instance_loss: 0.5411, weighted_loss: 0.6290, label: 2, bag_size: 343
batch 200, loss: 0.5161, instance_loss: 0.5482, weighted_loss: 0.5257, label: 2, bag_size: 979
batch 300, loss: 0.4592, instance_loss: 0.5187, weighted_loss: 0.4771, label: 2, bag_size: 1301
batch 400, loss: 0.8763, instance_loss: 0.6128, weighted_loss: 0.7972, label: 1, bag_size: 1120
batch 500, loss: 1.2499, instance_loss: 0.6341, weighted_loss: 1.0651, label: 1, bag_size: 57
batch 600, loss: 0.6085, instance_loss: 0.5149, weighted_loss: 0.5804, label: 2, bag_size: 690
batch 700, loss: 0.5647, instance_loss: 0.4784, weighted_loss: 0.5388, label: 2, bag_size: 1068
batch 800, loss: 0.9358, instance_loss: 0.6334, weighted_loss: 0.8451, label: 1, bag_size: 536
batch 900, loss: 0.9840, instance_loss: 0.5719, weighted_loss: 0.8604, label: 1, bag_size: 278
batch 1000, loss: 0.8577, instance_loss: 0.5445, weighted_loss: 0.7638, label: 1, bag_size: 488
batch 1100, loss: 0.8010, instance_loss: 0.6092, weighted_loss: 0.7435, label: 1, bag_size: 773
batch 1200, loss: 0.9467, instance_loss: 0.5806, weighted_loss: 0.8368, label: 1, bag_size: 343
batch 1300, loss: 0.4868, instance_loss: 0.4780, weighted_loss: 0.4842, label: 2, bag_size: 400
batch 1400, loss: 0.8038, instance_loss: 0.6263, weighted_loss: 0.7505, label: 1, bag_size: 476
batch 1500, loss: 1.0572, instance_loss: 0.7176, weighted_loss: 0.9553, label: 1, bag_size: 190
batch 1600, loss: 0.6481, instance_loss: 0.5026, weighted_loss: 0.6045, label: 1, bag_size: 500
batch 1700, loss: 1.0275, instance_loss: 0.7059, weighted_loss: 0.9310, label: 1, bag_size: 167
batch 1800, loss: 1.0514, instance_loss: 0.6353, weighted_loss: 0.9266, label: 1, bag_size: 456
batch 1900, loss: 0.8187, instance_loss: 0.5671, weighted_loss: 0.7433, label: 1, bag_size: 724
batch 2000, loss: 0.2656, instance_loss: 0.4066, weighted_loss: 0.3079, label: 2, bag_size: 333
batch 2100, loss: 2.1305, instance_loss: 0.6933, weighted_loss: 1.6993, label: 3, bag_size: 388

Instance Classifier Stats
class 0 clustering acc 0.9998415898617512: correct 69429/69440
class 1 clustering acc 0.0014976958525345623: correct 26/17360

Epoch: 4, train_loss: 0.9523, train_clustering_loss:  0.5748, train_error: 0.3903
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.42071611253196933, correct coarse 329/782 
coarse class 2: coarse acc 0.9144434222631095, correct coarse 994/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6097

Val Set, val_loss: 0.9242, val_error: 0.3674, auc: 0.6861
class 0 clustering acc 1.0: correct 8448/8448 
class 1 clustering acc 0.0: correct 0/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.4895833333333333, correct coarse 47/96 
coarse class 2: coarse acc 0.8955223880597015, correct coarse 120/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6326
Overall F1 Score: 0.3239

Training for coarse level...
batch 100, loss: 0.8745, instance_loss: 0.4341, weighted_loss: 0.7424, label: 2, bag_size: 1744
batch 200, loss: 0.8520, instance_loss: 0.6224, weighted_loss: 0.7831, label: 1, bag_size: 1536
batch 300, loss: 0.6199, instance_loss: 0.4414, weighted_loss: 0.5663, label: 2, bag_size: 460
batch 400, loss: 0.8457, instance_loss: 0.5187, weighted_loss: 0.7476, label: 2, bag_size: 229
batch 500, loss: 0.6605, instance_loss: 0.5659, weighted_loss: 0.6321, label: 1, bag_size: 2830
batch 600, loss: 0.4511, instance_loss: 0.4226, weighted_loss: 0.4425, label: 2, bag_size: 258
batch 700, loss: 0.7857, instance_loss: 0.6343, weighted_loss: 0.7403, label: 1, bag_size: 605
batch 800, loss: 0.9252, instance_loss: 0.5049, weighted_loss: 0.7991, label: 2, bag_size: 174
batch 900, loss: 1.0805, instance_loss: 0.5907, weighted_loss: 0.9335, label: 1, bag_size: 517
batch 1000, loss: 0.3610, instance_loss: 0.4423, weighted_loss: 0.3854, label: 2, bag_size: 305
batch 1100, loss: 0.8117, instance_loss: 0.5270, weighted_loss: 0.7263, label: 1, bag_size: 310
batch 1200, loss: 0.5456, instance_loss: 0.4245, weighted_loss: 0.5092, label: 2, bag_size: 838
batch 1300, loss: 1.8778, instance_loss: 0.7387, weighted_loss: 1.5360, label: 3, bag_size: 490
batch 1400, loss: 0.6343, instance_loss: 0.4272, weighted_loss: 0.5721, label: 2, bag_size: 534
batch 1500, loss: 2.0655, instance_loss: 0.7586, weighted_loss: 1.6734, label: 3, bag_size: 141
batch 1600, loss: 0.6222, instance_loss: 0.5505, weighted_loss: 0.6007, label: 1, bag_size: 567
batch 1700, loss: 1.3292, instance_loss: 0.6272, weighted_loss: 1.1186, label: 1, bag_size: 562
batch 1800, loss: 0.8471, instance_loss: 0.4544, weighted_loss: 0.7293, label: 1, bag_size: 84
batch 1900, loss: 0.8108, instance_loss: 0.5703, weighted_loss: 0.7386, label: 1, bag_size: 257
batch 2000, loss: 0.2784, instance_loss: 0.3818, weighted_loss: 0.3094, label: 2, bag_size: 761
batch 2100, loss: 0.6126, instance_loss: 0.3998, weighted_loss: 0.5487, label: 2, bag_size: 534

Instance Classifier Stats
class 0 clustering acc 0.9997119815668203: correct 69420/69440
class 1 clustering acc 0.0033410138248847927: correct 58/17360

Epoch: 5, train_loss: 0.9289, train_clustering_loss:  0.5458, train_error: 0.3765
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5115089514066496, correct coarse 400/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6235

Val Set, val_loss: 0.9054, val_error: 0.3598, auc: 0.6956
class 0 clustering acc 1.0: correct 8448/8448 
class 1 clustering acc 0.0004734848484848485: correct 1/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5208333333333334, correct coarse 50/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6402
Overall F1 Score: 0.3292

Training for coarse level...
batch 100, loss: 1.0679, instance_loss: 0.4959, weighted_loss: 0.8963, label: 2, bag_size: 151
batch 200, loss: 0.6477, instance_loss: 0.4237, weighted_loss: 0.5805, label: 2, bag_size: 596
batch 300, loss: 0.8486, instance_loss: 0.5893, weighted_loss: 0.7708, label: 1, bag_size: 250
batch 400, loss: 0.7397, instance_loss: 0.5029, weighted_loss: 0.6687, label: 1, bag_size: 897
batch 500, loss: 0.9661, instance_loss: 0.6431, weighted_loss: 0.8692, label: 1, bag_size: 779
batch 600, loss: 0.8198, instance_loss: 0.6628, weighted_loss: 0.7727, label: 1, bag_size: 760
batch 700, loss: 1.0156, instance_loss: 0.4817, weighted_loss: 0.8555, label: 2, bag_size: 464
batch 800, loss: 0.5857, instance_loss: 0.4857, weighted_loss: 0.5557, label: 1, bag_size: 1263
batch 900, loss: 1.0251, instance_loss: 0.5325, weighted_loss: 0.8773, label: 2, bag_size: 52
batch 1000, loss: 2.3982, instance_loss: 0.8673, weighted_loss: 1.9389, label: 3, bag_size: 675
batch 1100, loss: 1.2070, instance_loss: 0.6729, weighted_loss: 1.0468, label: 1, bag_size: 1170
batch 1200, loss: 0.4497, instance_loss: 0.4758, weighted_loss: 0.4575, label: 1, bag_size: 2121
batch 1300, loss: 1.8809, instance_loss: 0.9355, weighted_loss: 1.5973, label: 3, bag_size: 1001
batch 1400, loss: 0.8571, instance_loss: 0.4740, weighted_loss: 0.7421, label: 2, bag_size: 432
batch 1500, loss: 0.5789, instance_loss: 0.4844, weighted_loss: 0.5505, label: 1, bag_size: 1249
batch 1600, loss: 0.2572, instance_loss: 0.3552, weighted_loss: 0.2866, label: 2, bag_size: 441
batch 1700, loss: 0.7512, instance_loss: 0.5605, weighted_loss: 0.6940, label: 1, bag_size: 986
batch 1800, loss: 2.0317, instance_loss: 0.8597, weighted_loss: 1.6801, label: 3, bag_size: 1875
batch 1900, loss: 0.6497, instance_loss: 0.5327, weighted_loss: 0.6146, label: 1, bag_size: 501
batch 2000, loss: 0.6002, instance_loss: 0.4755, weighted_loss: 0.5628, label: 1, bag_size: 1490
batch 2100, loss: 0.3229, instance_loss: 0.3611, weighted_loss: 0.3344, label: 2, bag_size: 482

Instance Classifier Stats
class 0 clustering acc 0.9993663594470046: correct 69396/69440
class 1 clustering acc 0.010599078341013824: correct 184/17360

Epoch: 6, train_loss: 0.9093, train_clustering_loss:  0.5265, train_error: 0.3677
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5370843989769821, correct coarse 420/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6323

Val Set, val_loss: 0.8901, val_error: 0.3598, auc: 0.7059
class 0 clustering acc 0.9998816287878788: correct 8447/8448 
class 1 clustering acc 0.0033143939393939395: correct 7/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5625, correct coarse 54/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6402
Overall F1 Score: 0.3320

Training for coarse level...
batch 100, loss: 1.9195, instance_loss: 0.7820, weighted_loss: 1.5783, label: 3, bag_size: 384
batch 200, loss: 0.2588, instance_loss: 0.3642, weighted_loss: 0.2904, label: 2, bag_size: 728
batch 300, loss: 0.3966, instance_loss: 0.3784, weighted_loss: 0.3911, label: 2, bag_size: 581
batch 400, loss: 0.3069, instance_loss: 0.3733, weighted_loss: 0.3268, label: 2, bag_size: 225
batch 500, loss: 0.8310, instance_loss: 0.5230, weighted_loss: 0.7386, label: 1, bag_size: 420
batch 600, loss: 0.5399, instance_loss: 0.3753, weighted_loss: 0.4905, label: 2, bag_size: 320
batch 700, loss: 0.4643, instance_loss: 0.3855, weighted_loss: 0.4406, label: 2, bag_size: 322
batch 800, loss: 0.2813, instance_loss: 0.3562, weighted_loss: 0.3038, label: 2, bag_size: 385
batch 900, loss: 2.0649, instance_loss: 0.7812, weighted_loss: 1.6798, label: 3, bag_size: 876
batch 1000, loss: 0.2090, instance_loss: 0.3557, weighted_loss: 0.2530, label: 2, bag_size: 599
batch 1100, loss: 0.2103, instance_loss: 0.3414, weighted_loss: 0.2496, label: 2, bag_size: 761
batch 1200, loss: 0.2601, instance_loss: 0.3701, weighted_loss: 0.2931, label: 2, bag_size: 206
batch 1300, loss: 0.7165, instance_loss: 0.4491, weighted_loss: 0.6363, label: 2, bag_size: 483
batch 1400, loss: 0.8173, instance_loss: 0.5382, weighted_loss: 0.7335, label: 1, bag_size: 250
batch 1500, loss: 0.1490, instance_loss: 0.2982, weighted_loss: 0.1937, label: 2, bag_size: 403
batch 1600, loss: 0.3584, instance_loss: 0.3800, weighted_loss: 0.3649, label: 2, bag_size: 229
batch 1700, loss: 0.2870, instance_loss: 0.3441, weighted_loss: 0.3041, label: 2, bag_size: 328
batch 1800, loss: 1.8023, instance_loss: 0.7730, weighted_loss: 1.4935, label: 3, bag_size: 590
batch 1900, loss: 1.9942, instance_loss: 0.7152, weighted_loss: 1.6105, label: 2, bag_size: 362
batch 2000, loss: 1.3656, instance_loss: 0.6472, weighted_loss: 1.1501, label: 1, bag_size: 167
batch 2100, loss: 1.9353, instance_loss: 0.8729, weighted_loss: 1.6166, label: 3, bag_size: 289

Instance Classifier Stats
class 0 clustering acc 0.9985743087557604: correct 69341/69440
class 1 clustering acc 0.0293778801843318: correct 510/17360

Epoch: 7, train_loss: 0.8936, train_clustering_loss:  0.5123, train_error: 0.3618
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.5946291560102301, correct coarse 465/782 
coarse class 2: coarse acc 0.8463661453541859, correct coarse 920/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6382

Val Set, val_loss: 0.8764, val_error: 0.3598, auc: 0.7127
class 0 clustering acc 0.9996448863636364: correct 8445/8448 
class 1 clustering acc 0.017992424242424244: correct 38/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5625, correct coarse 54/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6402
Overall F1 Score: 0.3322

Training for coarse level...
batch 100, loss: 0.2697, instance_loss: 0.3730, weighted_loss: 0.3007, label: 2, bag_size: 225
batch 200, loss: 0.6940, instance_loss: 0.4264, weighted_loss: 0.6137, label: 2, bag_size: 596
batch 300, loss: 0.6492, instance_loss: 0.3770, weighted_loss: 0.5675, label: 1, bag_size: 1110
batch 400, loss: 1.7012, instance_loss: 0.7817, weighted_loss: 1.4253, label: 3, bag_size: 344
batch 500, loss: 0.1017, instance_loss: 0.3106, weighted_loss: 0.1644, label: 2, bag_size: 965
batch 600, loss: 0.4030, instance_loss: 0.3415, weighted_loss: 0.3845, label: 2, bag_size: 263
batch 700, loss: 0.1538, instance_loss: 0.3565, weighted_loss: 0.2146, label: 2, bag_size: 400
batch 800, loss: 0.8640, instance_loss: 0.5055, weighted_loss: 0.7564, label: 2, bag_size: 450
batch 900, loss: 0.4015, instance_loss: 0.3474, weighted_loss: 0.3853, label: 2, bag_size: 503
batch 1000, loss: 0.7237, instance_loss: 0.3941, weighted_loss: 0.6248, label: 1, bag_size: 310
batch 1100, loss: 0.4510, instance_loss: 0.3068, weighted_loss: 0.4077, label: 2, bag_size: 1798
batch 1200, loss: 0.1563, instance_loss: 0.2740, weighted_loss: 0.1916, label: 2, bag_size: 651
batch 1300, loss: 1.8265, instance_loss: 0.7197, weighted_loss: 1.4945, label: 1, bag_size: 655
batch 1400, loss: 0.4853, instance_loss: 0.3623, weighted_loss: 0.4484, label: 2, bag_size: 385
batch 1500, loss: 0.5782, instance_loss: 0.5497, weighted_loss: 0.5697, label: 1, bag_size: 1211
batch 1600, loss: 0.9239, instance_loss: 0.5476, weighted_loss: 0.8110, label: 2, bag_size: 482
batch 1700, loss: 2.2516, instance_loss: 0.8757, weighted_loss: 1.8388, label: 3, bag_size: 235
batch 1800, loss: 1.3656, instance_loss: 0.5972, weighted_loss: 1.1351, label: 1, bag_size: 205
batch 1900, loss: 0.8398, instance_loss: 0.5352, weighted_loss: 0.7484, label: 1, bag_size: 257
batch 2000, loss: 0.3557, instance_loss: 0.3764, weighted_loss: 0.3619, label: 2, bag_size: 665
batch 2100, loss: 0.4088, instance_loss: 0.3678, weighted_loss: 0.3965, label: 2, bag_size: 658

Instance Classifier Stats
class 0 clustering acc 0.9970334101382489: correct 69234/69440
class 1 clustering acc 0.055817972350230415: correct 969/17360

Epoch: 8, train_loss: 0.8796, train_clustering_loss:  0.5003, train_error: 0.3585
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6112531969309463, correct coarse 478/782 
coarse class 2: coarse acc 0.8408463661453542, correct coarse 914/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6415

Val Set, val_loss: 0.8651, val_error: 0.3561, auc: 0.7216
class 0 clustering acc 0.9985795454545454: correct 8436/8448 
class 1 clustering acc 0.06297348484848485: correct 133/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5833333333333334, correct coarse 56/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6439
Overall F1 Score: 0.3352

Training for coarse level...
batch 100, loss: 0.7414, instance_loss: 0.5274, weighted_loss: 0.6772, label: 1, bag_size: 785
batch 200, loss: 0.5891, instance_loss: 0.4256, weighted_loss: 0.5400, label: 2, bag_size: 431
batch 300, loss: 0.6095, instance_loss: 0.4275, weighted_loss: 0.5549, label: 2, bag_size: 667
batch 400, loss: 1.3828, instance_loss: 0.5535, weighted_loss: 1.1340, label: 2, bag_size: 1123
batch 500, loss: 2.3993, instance_loss: 0.8981, weighted_loss: 1.9489, label: 3, bag_size: 79
batch 600, loss: 0.4367, instance_loss: 0.2535, weighted_loss: 0.3817, label: 2, bag_size: 658
batch 700, loss: 0.2332, instance_loss: 0.3100, weighted_loss: 0.2562, label: 2, bag_size: 504
batch 800, loss: 1.1061, instance_loss: 0.6547, weighted_loss: 0.9707, label: 1, bag_size: 65
batch 900, loss: 0.8948, instance_loss: 0.3836, weighted_loss: 0.7414, label: 2, bag_size: 1271
batch 1000, loss: 0.2391, instance_loss: 0.2716, weighted_loss: 0.2488, label: 2, bag_size: 705
batch 1100, loss: 1.1919, instance_loss: 0.5056, weighted_loss: 0.9860, label: 2, bag_size: 232
batch 1200, loss: 1.0478, instance_loss: 0.5386, weighted_loss: 0.8951, label: 2, bag_size: 367
batch 1300, loss: 0.3678, instance_loss: 0.3180, weighted_loss: 0.3528, label: 2, bag_size: 518
batch 1400, loss: 1.0530, instance_loss: 0.4833, weighted_loss: 0.8821, label: 2, bag_size: 427
batch 1500, loss: 0.4398, instance_loss: 0.4620, weighted_loss: 0.4465, label: 1, bag_size: 1841
batch 1600, loss: 1.5755, instance_loss: 0.8380, weighted_loss: 1.3542, label: 3, bag_size: 430
batch 1700, loss: 0.2194, instance_loss: 0.2973, weighted_loss: 0.2427, label: 2, bag_size: 681
batch 1800, loss: 1.2185, instance_loss: 0.6874, weighted_loss: 1.0592, label: 1, bag_size: 347
batch 1900, loss: 0.1808, instance_loss: 0.3221, weighted_loss: 0.2232, label: 1, bag_size: 361
batch 2000, loss: 0.9905, instance_loss: 0.3927, weighted_loss: 0.8112, label: 2, bag_size: 379
batch 2100, loss: 1.0436, instance_loss: 0.5337, weighted_loss: 0.8906, label: 1, bag_size: 119

Instance Classifier Stats
class 0 clustering acc 0.9960109447004608: correct 69163/69440
class 1 clustering acc 0.09049539170506912: correct 1571/17360

Epoch: 9, train_loss: 0.8677, train_clustering_loss:  0.4890, train_error: 0.3571
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.8298068077276909, correct coarse 902/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6429

Val Set, val_loss: 0.8546, val_error: 0.3561, auc: 0.7274
class 0 clustering acc 0.9959753787878788: correct 8414/8448 
class 1 clustering acc 0.13257575757575757: correct 280/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.5729166666666666, correct coarse 55/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6439
Overall F1 Score: 0.3349

Training for coarse level...
batch 100, loss: 0.5586, instance_loss: 0.3695, weighted_loss: 0.5019, label: 2, bag_size: 200
batch 200, loss: 0.2038, instance_loss: 0.2484, weighted_loss: 0.2172, label: 2, bag_size: 1140
batch 300, loss: 0.2599, instance_loss: 0.2115, weighted_loss: 0.2454, label: 2, bag_size: 711
batch 400, loss: 1.6331, instance_loss: 0.7241, weighted_loss: 1.3604, label: 1, bag_size: 775
batch 500, loss: 1.2409, instance_loss: 0.5715, weighted_loss: 1.0401, label: 1, bag_size: 366
batch 600, loss: 1.4670, instance_loss: 0.7379, weighted_loss: 1.2483, label: 3, bag_size: 128
batch 700, loss: 0.1921, instance_loss: 0.3042, weighted_loss: 0.2257, label: 2, bag_size: 600
batch 800, loss: 0.6442, instance_loss: 0.5397, weighted_loss: 0.6128, label: 1, bag_size: 936
batch 900, loss: 0.1006, instance_loss: 0.2508, weighted_loss: 0.1457, label: 2, bag_size: 381
batch 1000, loss: 0.5739, instance_loss: 0.4056, weighted_loss: 0.5234, label: 2, bag_size: 667
batch 1100, loss: 1.7955, instance_loss: 0.8273, weighted_loss: 1.5050, label: 1, bag_size: 823
batch 1200, loss: 0.4244, instance_loss: 0.3375, weighted_loss: 0.3983, label: 2, bag_size: 733
batch 1300, loss: 0.8653, instance_loss: 0.5185, weighted_loss: 0.7613, label: 2, bag_size: 128
batch 1400, loss: 1.2192, instance_loss: 0.6430, weighted_loss: 1.0463, label: 1, bag_size: 575
batch 1500, loss: 0.2211, instance_loss: 0.3461, weighted_loss: 0.2586, label: 2, bag_size: 1023
batch 1600, loss: 0.3108, instance_loss: 0.3205, weighted_loss: 0.3137, label: 1, bag_size: 1632
batch 1700, loss: 0.8687, instance_loss: 0.3739, weighted_loss: 0.7203, label: 2, bag_size: 1600
batch 1800, loss: 0.8868, instance_loss: 0.3629, weighted_loss: 0.7296, label: 2, bag_size: 739
batch 1900, loss: 3.6929, instance_loss: 1.2078, weighted_loss: 2.9473, label: 0, bag_size: 1452
batch 2000, loss: 0.3654, instance_loss: 0.2686, weighted_loss: 0.3363, label: 2, bag_size: 298
batch 2100, loss: 1.2664, instance_loss: 0.4402, weighted_loss: 1.0185, label: 2, bag_size: 1796

Instance Classifier Stats
class 0 clustering acc 0.9934187788018434: correct 68983/69440
class 1 clustering acc 0.13784562211981566: correct 2393/17360

Epoch: 10, train_loss: 0.8566, train_clustering_loss:  0.4806, train_error: 0.3530
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6214833759590793, correct coarse 486/782 
coarse class 2: coarse acc 0.8445262189512419, correct coarse 918/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6470

Val Set, val_loss: 0.8455, val_error: 0.3447, auc: 0.7353
class 0 clustering acc 0.993844696969697: correct 8396/8448 
class 1 clustering acc 0.19318181818181818: correct 408/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6553
Overall F1 Score: 0.3439

Training for coarse level...
batch 100, loss: 0.4717, instance_loss: 0.3157, weighted_loss: 0.4249, label: 2, bag_size: 714
batch 200, loss: 2.1098, instance_loss: 0.8373, weighted_loss: 1.7280, label: 3, bag_size: 1800
batch 300, loss: 0.2560, instance_loss: 0.3653, weighted_loss: 0.2888, label: 1, bag_size: 2535
batch 400, loss: 0.5364, instance_loss: 0.3875, weighted_loss: 0.4917, label: 2, bag_size: 488
batch 500, loss: 1.3074, instance_loss: 0.5525, weighted_loss: 1.0809, label: 2, bag_size: 409
batch 600, loss: 1.6515, instance_loss: 0.7520, weighted_loss: 1.3817, label: 3, bag_size: 452
batch 700, loss: 0.1091, instance_loss: 0.2834, weighted_loss: 0.1614, label: 2, bag_size: 193
batch 800, loss: 0.5384, instance_loss: 0.3360, weighted_loss: 0.4777, label: 2, bag_size: 2224
batch 900, loss: 0.6047, instance_loss: 0.4280, weighted_loss: 0.5517, label: 2, bag_size: 635
batch 1000, loss: 0.2004, instance_loss: 0.2375, weighted_loss: 0.2115, label: 2, bag_size: 673
batch 1100, loss: 0.6190, instance_loss: 0.5269, weighted_loss: 0.5914, label: 1, bag_size: 683
batch 1200, loss: 1.3296, instance_loss: 0.6208, weighted_loss: 1.1170, label: 1, bag_size: 190
batch 1300, loss: 1.0332, instance_loss: 0.5906, weighted_loss: 0.9005, label: 1, bag_size: 167
batch 1400, loss: 0.3679, instance_loss: 0.4386, weighted_loss: 0.3891, label: 1, bag_size: 872
batch 1500, loss: 0.5588, instance_loss: 0.4823, weighted_loss: 0.5358, label: 1, bag_size: 476
batch 1600, loss: 2.8633, instance_loss: 1.0749, weighted_loss: 2.3268, label: 0, bag_size: 277
batch 1700, loss: 0.1971, instance_loss: 0.2485, weighted_loss: 0.2125, label: 2, bag_size: 287
batch 1800, loss: 0.9466, instance_loss: 0.3188, weighted_loss: 0.7583, label: 2, bag_size: 389
batch 1900, loss: 1.6042, instance_loss: 0.6361, weighted_loss: 1.3138, label: 1, bag_size: 326
batch 2000, loss: 1.7245, instance_loss: 0.8421, weighted_loss: 1.4598, label: 3, bag_size: 159
batch 2100, loss: 1.7383, instance_loss: 0.7075, weighted_loss: 1.4291, label: 3, bag_size: 116

Instance Classifier Stats
class 0 clustering acc 0.9923099078341013: correct 68906/69440
class 1 clustering acc 0.16532258064516128: correct 2870/17360

Epoch: 11, train_loss: 0.8464, train_clustering_loss:  0.4754, train_error: 0.3493
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.659846547314578, correct coarse 516/782 
coarse class 2: coarse acc 0.8242870285188593, correct coarse 896/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6507

Val Set, val_loss: 0.8367, val_error: 0.3409, auc: 0.7397
class 0 clustering acc 0.9924242424242424: correct 8384/8448 
class 1 clustering acc 0.2362689393939394: correct 499/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6591
Overall F1 Score: 0.3445

Training for coarse level...
batch 100, loss: 0.6468, instance_loss: 0.4197, weighted_loss: 0.5787, label: 2, bag_size: 373
batch 200, loss: 1.0532, instance_loss: 0.5169, weighted_loss: 0.8923, label: 2, bag_size: 220
batch 300, loss: 0.3378, instance_loss: 0.3728, weighted_loss: 0.3483, label: 2, bag_size: 239
batch 400, loss: 1.8463, instance_loss: 0.5584, weighted_loss: 1.4600, label: 2, bag_size: 621
batch 500, loss: 0.3875, instance_loss: 0.3089, weighted_loss: 0.3639, label: 1, bag_size: 1466
batch 600, loss: 1.2844, instance_loss: 0.6164, weighted_loss: 1.0840, label: 1, bag_size: 233
batch 700, loss: 0.8633, instance_loss: 0.4532, weighted_loss: 0.7403, label: 1, bag_size: 1665
batch 800, loss: 1.4502, instance_loss: 0.8098, weighted_loss: 1.2581, label: 1, bag_size: 566
batch 900, loss: 0.1432, instance_loss: 0.2086, weighted_loss: 0.1628, label: 2, bag_size: 834
batch 1000, loss: 1.6619, instance_loss: 0.8614, weighted_loss: 1.4218, label: 3, bag_size: 431
batch 1100, loss: 1.2181, instance_loss: 0.5130, weighted_loss: 1.0066, label: 2, bag_size: 320
batch 1200, loss: 0.4330, instance_loss: 0.3430, weighted_loss: 0.4060, label: 2, bag_size: 206
batch 1300, loss: 0.8513, instance_loss: 0.3593, weighted_loss: 0.7037, label: 2, bag_size: 714
batch 1400, loss: 0.3035, instance_loss: 0.2970, weighted_loss: 0.3016, label: 2, bag_size: 473
batch 1500, loss: 0.3327, instance_loss: 0.3056, weighted_loss: 0.3246, label: 2, bag_size: 424
batch 1600, loss: 0.1000, instance_loss: 0.2081, weighted_loss: 0.1325, label: 2, bag_size: 178
batch 1700, loss: 1.3002, instance_loss: 0.7091, weighted_loss: 1.1229, label: 3, bag_size: 119
batch 1800, loss: 1.0350, instance_loss: 0.5300, weighted_loss: 0.8835, label: 1, bag_size: 520
batch 1900, loss: 1.4580, instance_loss: 0.8879, weighted_loss: 1.2869, label: 3, bag_size: 850
batch 2000, loss: 0.2444, instance_loss: 0.3342, weighted_loss: 0.2713, label: 1, bag_size: 333
batch 2100, loss: 0.2457, instance_loss: 0.3343, weighted_loss: 0.2723, label: 1, bag_size: 691

Instance Classifier Stats
class 0 clustering acc 0.9909274193548387: correct 68810/69440
class 1 clustering acc 0.20138248847926268: correct 3496/17360

Epoch: 12, train_loss: 0.8378, train_clustering_loss:  0.4690, train_error: 0.3461
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.8390064397424103, correct coarse 912/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6539

Val Set, val_loss: 0.8285, val_error: 0.3447, auc: 0.7473
class 0 clustering acc 0.9908854166666666: correct 8371/8448 
class 1 clustering acc 0.2765151515151515: correct 584/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.59375, correct coarse 57/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6553
Overall F1 Score: 0.3420

Training for coarse level...
batch 100, loss: 0.1063, instance_loss: 0.2117, weighted_loss: 0.1380, label: 2, bag_size: 874
batch 200, loss: 0.6965, instance_loss: 0.4968, weighted_loss: 0.6366, label: 1, bag_size: 1522
batch 300, loss: 0.1360, instance_loss: 0.2627, weighted_loss: 0.1740, label: 2, bag_size: 597
batch 400, loss: 1.2256, instance_loss: 0.5608, weighted_loss: 1.0262, label: 2, bag_size: 463
batch 500, loss: 0.6586, instance_loss: 0.4358, weighted_loss: 0.5918, label: 2, bag_size: 545
batch 600, loss: 0.1575, instance_loss: 0.2325, weighted_loss: 0.1800, label: 2, bag_size: 574
batch 700, loss: 0.7533, instance_loss: 0.3916, weighted_loss: 0.6448, label: 2, bag_size: 448
batch 800, loss: 0.1154, instance_loss: 0.2598, weighted_loss: 0.1587, label: 2, bag_size: 296
batch 900, loss: 0.6373, instance_loss: 0.4070, weighted_loss: 0.5682, label: 2, bag_size: 92
batch 1000, loss: 0.4716, instance_loss: 0.2700, weighted_loss: 0.4111, label: 2, bag_size: 546
batch 1100, loss: 0.6528, instance_loss: 0.4895, weighted_loss: 0.6038, label: 2, bag_size: 124
batch 1200, loss: 0.4231, instance_loss: 0.3229, weighted_loss: 0.3930, label: 2, bag_size: 361
batch 1300, loss: 0.6383, instance_loss: 0.2724, weighted_loss: 0.5285, label: 1, bag_size: 313
batch 1400, loss: 2.1020, instance_loss: 0.9297, weighted_loss: 1.7503, label: 3, bag_size: 457
batch 1500, loss: 1.4249, instance_loss: 0.5052, weighted_loss: 1.1490, label: 2, bag_size: 608
batch 1600, loss: 0.6571, instance_loss: 0.4881, weighted_loss: 0.6064, label: 1, bag_size: 643
batch 1700, loss: 1.5141, instance_loss: 0.7579, weighted_loss: 1.2872, label: 3, bag_size: 361
batch 1800, loss: 0.7931, instance_loss: 0.4266, weighted_loss: 0.6832, label: 2, bag_size: 548
batch 1900, loss: 0.1394, instance_loss: 0.2251, weighted_loss: 0.1651, label: 2, bag_size: 1301
batch 2000, loss: 1.5461, instance_loss: 0.8719, weighted_loss: 1.3438, label: 3, bag_size: 1274
batch 2100, loss: 0.4400, instance_loss: 0.3625, weighted_loss: 0.4168, label: 2, bag_size: 394

Instance Classifier Stats
class 0 clustering acc 0.9893289170506913: correct 68699/69440
class 1 clustering acc 0.23341013824884793: correct 4052/17360

Epoch: 13, train_loss: 0.8295, train_clustering_loss:  0.4633, train_error: 0.3470
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6457800511508951, correct coarse 505/782 
coarse class 2: coarse acc 0.8390064397424103, correct coarse 912/1087 
coarse class 3: coarse acc 0.0, correct coarse 0/257 
Overall Accuracy: 0.6530

Val Set, val_loss: 0.8213, val_error: 0.3447, auc: 0.7546
class 0 clustering acc 0.9891098484848485: correct 8356/8448 
class 1 clustering acc 0.3068181818181818: correct 648/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6553
Overall F1 Score: 0.3424

Training for coarse level...
batch 100, loss: 1.6254, instance_loss: 0.7423, weighted_loss: 1.3605, label: 3, bag_size: 492
batch 200, loss: 0.2099, instance_loss: 0.1871, weighted_loss: 0.2031, label: 2, bag_size: 475
batch 300, loss: 0.3332, instance_loss: 0.2947, weighted_loss: 0.3216, label: 1, bag_size: 1460
batch 400, loss: 0.6570, instance_loss: 0.3547, weighted_loss: 0.5663, label: 2, bag_size: 431
batch 500, loss: 1.2049, instance_loss: 0.7436, weighted_loss: 1.0665, label: 3, bag_size: 321
batch 600, loss: 0.3059, instance_loss: 0.3084, weighted_loss: 0.3066, label: 1, bag_size: 1973
batch 700, loss: 0.9373, instance_loss: 0.4834, weighted_loss: 0.8012, label: 2, bag_size: 331
batch 800, loss: 0.4167, instance_loss: 0.3255, weighted_loss: 0.3893, label: 2, bag_size: 776
batch 900, loss: 1.0679, instance_loss: 0.4829, weighted_loss: 0.8924, label: 1, bag_size: 308
batch 1000, loss: 0.4117, instance_loss: 0.2692, weighted_loss: 0.3689, label: 2, bag_size: 578
batch 1100, loss: 0.3509, instance_loss: 0.3960, weighted_loss: 0.3644, label: 1, bag_size: 983
batch 1200, loss: 0.1972, instance_loss: 0.2150, weighted_loss: 0.2025, label: 2, bag_size: 620
batch 1300, loss: 0.1737, instance_loss: 0.2725, weighted_loss: 0.2034, label: 2, bag_size: 332
batch 1400, loss: 1.1560, instance_loss: 0.6081, weighted_loss: 0.9917, label: 1, bag_size: 1299
batch 1500, loss: 0.4264, instance_loss: 0.3415, weighted_loss: 0.4009, label: 2, bag_size: 358
batch 1600, loss: 1.4279, instance_loss: 0.6510, weighted_loss: 1.1948, label: 1, bag_size: 746
batch 1700, loss: 2.2573, instance_loss: 0.7730, weighted_loss: 1.8120, label: 3, bag_size: 164
batch 1800, loss: 0.8582, instance_loss: 0.5862, weighted_loss: 0.7766, label: 1, bag_size: 271
batch 1900, loss: 1.4647, instance_loss: 0.7959, weighted_loss: 1.2640, label: 1, bag_size: 1667
batch 2000, loss: 0.3385, instance_loss: 0.2774, weighted_loss: 0.3202, label: 2, bag_size: 457
batch 2100, loss: 1.6383, instance_loss: 0.7223, weighted_loss: 1.3635, label: 3, bag_size: 116

Instance Classifier Stats
class 0 clustering acc 0.9886520737327189: correct 68652/69440
class 1 clustering acc 0.2605414746543779: correct 4523/17360

Epoch: 14, train_loss: 0.8225, train_clustering_loss:  0.4581, train_error: 0.3447
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.8390064397424103, correct coarse 912/1087 
coarse class 3: coarse acc 0.007782101167315175, correct coarse 2/257 
Overall Accuracy: 0.6553

Val Set, val_loss: 0.8151, val_error: 0.3409, auc: 0.7596
class 0 clustering acc 0.9880445075757576: correct 8347/8448 
class 1 clustering acc 0.3214962121212121: correct 679/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6591
Overall F1 Score: 0.3451

Training for coarse level...
batch 100, loss: 1.4830, instance_loss: 0.7353, weighted_loss: 1.2586, label: 3, bag_size: 431
batch 200, loss: 1.2346, instance_loss: 0.3493, weighted_loss: 0.9690, label: 2, bag_size: 1744
batch 300, loss: 0.3139, instance_loss: 0.3574, weighted_loss: 0.3269, label: 1, bag_size: 112
batch 400, loss: 0.2589, instance_loss: 0.2697, weighted_loss: 0.2621, label: 2, bag_size: 637
batch 500, loss: 1.1230, instance_loss: 0.5663, weighted_loss: 0.9560, label: 1, bag_size: 437
batch 600, loss: 1.0811, instance_loss: 0.6261, weighted_loss: 0.9446, label: 2, bag_size: 777
batch 700, loss: 1.3122, instance_loss: 0.4919, weighted_loss: 1.0661, label: 2, bag_size: 376
batch 800, loss: 0.5973, instance_loss: 0.3341, weighted_loss: 0.5183, label: 2, bag_size: 318
batch 900, loss: 1.3512, instance_loss: 0.6700, weighted_loss: 1.1468, label: 1, bag_size: 369
batch 1000, loss: 0.0639, instance_loss: 0.1749, weighted_loss: 0.0972, label: 1, bag_size: 1445
batch 1100, loss: 0.6601, instance_loss: 0.3790, weighted_loss: 0.5758, label: 2, bag_size: 453
batch 1200, loss: 1.0134, instance_loss: 0.6260, weighted_loss: 0.8972, label: 3, bag_size: 65
batch 1300, loss: 0.2361, instance_loss: 0.2348, weighted_loss: 0.2357, label: 2, bag_size: 280
batch 1400, loss: 0.3561, instance_loss: 0.3490, weighted_loss: 0.3539, label: 1, bag_size: 1374
batch 1500, loss: 1.3690, instance_loss: 0.6151, weighted_loss: 1.1428, label: 1, bag_size: 165
batch 1600, loss: 0.5205, instance_loss: 0.4572, weighted_loss: 0.5015, label: 2, bag_size: 896
batch 1700, loss: 1.5219, instance_loss: 0.7916, weighted_loss: 1.3028, label: 3, bag_size: 132
batch 1800, loss: 0.0637, instance_loss: 0.1227, weighted_loss: 0.0814, label: 2, bag_size: 1015
batch 1900, loss: 1.2189, instance_loss: 0.6906, weighted_loss: 1.0604, label: 1, bag_size: 421
batch 2000, loss: 0.3443, instance_loss: 0.2682, weighted_loss: 0.3214, label: 2, bag_size: 603
batch 2100, loss: 1.6590, instance_loss: 0.7278, weighted_loss: 1.3796, label: 3, bag_size: 565

Instance Classifier Stats
class 0 clustering acc 0.9878456221198156: correct 68596/69440
class 1 clustering acc 0.27609447004608295: correct 4793/17360

Epoch: 15, train_loss: 0.8161, train_clustering_loss:  0.4547, train_error: 0.3429
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.8417663293468262, correct coarse 915/1087 
coarse class 3: coarse acc 0.011673151750972763, correct coarse 3/257 
Overall Accuracy: 0.6571

Val Set, val_loss: 0.8082, val_error: 0.3447, auc: 0.7643
class 0 clustering acc 0.9868607954545454: correct 8337/8448 
class 1 clustering acc 0.33428030303030304: correct 706/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6553
Overall F1 Score: 0.3432

Training for coarse level...
batch 100, loss: 0.1565, instance_loss: 0.2943, weighted_loss: 0.1978, label: 2, bag_size: 506
batch 200, loss: 2.6733, instance_loss: 0.9740, weighted_loss: 2.1635, label: 0, bag_size: 419
batch 300, loss: 0.1693, instance_loss: 0.2148, weighted_loss: 0.1829, label: 1, bag_size: 3011
batch 400, loss: 0.7218, instance_loss: 0.3385, weighted_loss: 0.6068, label: 2, bag_size: 344
batch 500, loss: 0.9479, instance_loss: 0.4444, weighted_loss: 0.7969, label: 1, bag_size: 1214
batch 600, loss: 0.0870, instance_loss: 0.2417, weighted_loss: 0.1334, label: 1, bag_size: 350
batch 700, loss: 0.1131, instance_loss: 0.1677, weighted_loss: 0.1295, label: 2, bag_size: 596
batch 800, loss: 0.1760, instance_loss: 0.2711, weighted_loss: 0.2045, label: 1, bag_size: 1231
batch 900, loss: 0.1277, instance_loss: 0.2235, weighted_loss: 0.1565, label: 2, bag_size: 318
batch 1000, loss: 1.2739, instance_loss: 0.5921, weighted_loss: 1.0693, label: 3, bag_size: 13
batch 1100, loss: 0.6673, instance_loss: 0.3103, weighted_loss: 0.5602, label: 2, bag_size: 266
batch 1200, loss: 1.6016, instance_loss: 0.8982, weighted_loss: 1.3906, label: 3, bag_size: 450
batch 1300, loss: 0.9832, instance_loss: 0.4887, weighted_loss: 0.8349, label: 2, bag_size: 401
batch 1400, loss: 0.4599, instance_loss: 0.3590, weighted_loss: 0.4296, label: 2, bag_size: 665
batch 1500, loss: 0.1831, instance_loss: 0.1737, weighted_loss: 0.1803, label: 1, bag_size: 732
batch 1600, loss: 1.4749, instance_loss: 0.7627, weighted_loss: 1.2612, label: 3, bag_size: 679
batch 1700, loss: 1.2243, instance_loss: 0.5443, weighted_loss: 1.0203, label: 1, bag_size: 115
batch 1800, loss: 0.7828, instance_loss: 0.5812, weighted_loss: 0.7223, label: 1, bag_size: 2367
batch 1900, loss: 2.3374, instance_loss: 0.9626, weighted_loss: 1.9249, label: 3, bag_size: 367
batch 2000, loss: 1.8085, instance_loss: 0.8328, weighted_loss: 1.5158, label: 3, bag_size: 268
batch 2100, loss: 0.8910, instance_loss: 0.5929, weighted_loss: 0.8015, label: 1, bag_size: 349

Instance Classifier Stats
class 0 clustering acc 0.9868231566820277: correct 68525/69440
class 1 clustering acc 0.28859447004608296: correct 5010/17360

Epoch: 16, train_loss: 0.8101, train_clustering_loss:  0.4517, train_error: 0.3419
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6406649616368286, correct coarse 501/782 
coarse class 2: coarse acc 0.8491260349586016, correct coarse 923/1087 
coarse class 3: coarse acc 0.01556420233463035, correct coarse 4/257 
Overall Accuracy: 0.6581

Val Set, val_loss: 0.8027, val_error: 0.3333, auc: 0.7683
class 0 clustering acc 0.9855587121212122: correct 8326/8448 
class 1 clustering acc 0.3484848484848485: correct 736/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.3652

Training for coarse level...
batch 100, loss: 0.9740, instance_loss: 0.4839, weighted_loss: 0.8269, label: 2, bag_size: 1347
batch 200, loss: 0.4774, instance_loss: 0.2432, weighted_loss: 0.4072, label: 2, bag_size: 909
batch 300, loss: 1.0782, instance_loss: 0.6472, weighted_loss: 0.9489, label: 1, bag_size: 1299
batch 400, loss: 0.0945, instance_loss: 0.2048, weighted_loss: 0.1275, label: 2, bag_size: 349
batch 500, loss: 0.1786, instance_loss: 0.2407, weighted_loss: 0.1972, label: 1, bag_size: 367
batch 600, loss: 0.3575, instance_loss: 0.3633, weighted_loss: 0.3592, label: 2, bag_size: 390
batch 700, loss: 0.1066, instance_loss: 0.2165, weighted_loss: 0.1396, label: 2, bag_size: 290
batch 800, loss: 0.6878, instance_loss: 0.3491, weighted_loss: 0.5862, label: 2, bag_size: 843
batch 900, loss: 0.6754, instance_loss: 0.3330, weighted_loss: 0.5727, label: 2, bag_size: 889
batch 1000, loss: 0.1494, instance_loss: 0.2320, weighted_loss: 0.1742, label: 2, bag_size: 681
batch 1100, loss: 0.4641, instance_loss: 0.5170, weighted_loss: 0.4800, label: 2, bag_size: 1066
batch 1200, loss: 1.0708, instance_loss: 0.6913, weighted_loss: 0.9569, label: 3, bag_size: 321
batch 1300, loss: 0.8674, instance_loss: 0.5314, weighted_loss: 0.7666, label: 1, bag_size: 459
batch 1400, loss: 1.0194, instance_loss: 0.6216, weighted_loss: 0.9001, label: 1, bag_size: 425
batch 1500, loss: 1.1967, instance_loss: 0.6492, weighted_loss: 1.0325, label: 1, bag_size: 616
batch 1600, loss: 0.3990, instance_loss: 0.2914, weighted_loss: 0.3667, label: 2, bag_size: 492
batch 1700, loss: 2.5653, instance_loss: 1.4333, weighted_loss: 2.2257, label: 3, bag_size: 981
batch 1800, loss: 0.2265, instance_loss: 0.1853, weighted_loss: 0.2141, label: 1, bag_size: 724
batch 1900, loss: 0.2867, instance_loss: 0.2187, weighted_loss: 0.2663, label: 2, bag_size: 534
batch 2000, loss: 0.8589, instance_loss: 0.4672, weighted_loss: 0.7414, label: 2, bag_size: 245
batch 2100, loss: 1.1001, instance_loss: 0.6282, weighted_loss: 0.9585, label: 1, bag_size: 267

Instance Classifier Stats
class 0 clustering acc 0.9865495391705069: correct 68506/69440
class 1 clustering acc 0.3003456221198157: correct 5214/17360

Epoch: 17, train_loss: 0.8043, train_clustering_loss:  0.4490, train_error: 0.3401
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8408463661453542, correct coarse 914/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
Overall Accuracy: 0.6599

Val Set, val_loss: 0.7980, val_error: 0.3409, auc: 0.7707
class 0 clustering acc 0.9841382575757576: correct 8314/8448 
class 1 clustering acc 0.35984848484848486: correct 760/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.0, correct coarse 0/30 
Overall Accuracy: 0.6591
Overall F1 Score: 0.3458

Training for coarse level...
batch 100, loss: 1.2019, instance_loss: 0.7308, weighted_loss: 1.0605, label: 1, bag_size: 421
batch 200, loss: 0.7444, instance_loss: 0.3795, weighted_loss: 0.6349, label: 2, bag_size: 448
batch 300, loss: 0.0777, instance_loss: 0.1729, weighted_loss: 0.1063, label: 1, bag_size: 410
batch 400, loss: 0.2354, instance_loss: 0.3511, weighted_loss: 0.2701, label: 1, bag_size: 389
batch 500, loss: 0.1573, instance_loss: 0.2433, weighted_loss: 0.1831, label: 1, bag_size: 2030
batch 600, loss: 0.2123, instance_loss: 0.5469, weighted_loss: 0.3127, label: 2, bag_size: 11
batch 700, loss: 1.4455, instance_loss: 0.6738, weighted_loss: 1.2140, label: 3, bag_size: 144
batch 800, loss: 2.2384, instance_loss: 0.8009, weighted_loss: 1.8071, label: 1, bag_size: 107
batch 900, loss: 0.8711, instance_loss: 0.4425, weighted_loss: 0.7425, label: 1, bag_size: 311
batch 1000, loss: 0.2522, instance_loss: 0.3769, weighted_loss: 0.2896, label: 1, bag_size: 1172
batch 1100, loss: 0.0970, instance_loss: 0.1807, weighted_loss: 0.1221, label: 2, bag_size: 1110
batch 1200, loss: 0.4662, instance_loss: 0.4528, weighted_loss: 0.4622, label: 2, bag_size: 280
batch 1300, loss: 1.1722, instance_loss: 0.5610, weighted_loss: 0.9888, label: 2, bag_size: 359
batch 1400, loss: 0.6651, instance_loss: 0.3743, weighted_loss: 0.5778, label: 2, bag_size: 431
batch 1500, loss: 1.3990, instance_loss: 0.7550, weighted_loss: 1.2058, label: 3, bag_size: 344
batch 1600, loss: 0.3212, instance_loss: 0.2513, weighted_loss: 0.3002, label: 2, bag_size: 216
batch 1700, loss: 1.5117, instance_loss: 0.8558, weighted_loss: 1.3149, label: 1, bag_size: 1667
batch 1800, loss: 0.3873, instance_loss: 0.3539, weighted_loss: 0.3773, label: 1, bag_size: 3530
batch 1900, loss: 1.3463, instance_loss: 0.7441, weighted_loss: 1.1657, label: 3, bag_size: 461
batch 2000, loss: 1.1729, instance_loss: 0.7396, weighted_loss: 1.0429, label: 1, bag_size: 495
batch 2100, loss: 0.4658, instance_loss: 0.3201, weighted_loss: 0.4221, label: 2, bag_size: 431

Instance Classifier Stats
class 0 clustering acc 0.9858294930875576: correct 68456/69440
class 1 clustering acc 0.3095622119815668: correct 5374/17360

Epoch: 18, train_loss: 0.8000, train_clustering_loss:  0.4464, train_error: 0.3382
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782 
coarse class 2: coarse acc 0.8656853725850966, correct coarse 941/1087 
coarse class 3: coarse acc 0.019455252918287938, correct coarse 5/257 
Overall Accuracy: 0.6618

Val Set, val_loss: 0.7942, val_error: 0.3333, auc: 0.7728
class 0 clustering acc 0.9839015151515151: correct 8312/8448 
class 1 clustering acc 0.37547348484848486: correct 793/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.3652

Training for coarse level...
batch 100, loss: 0.3414, instance_loss: 0.3403, weighted_loss: 0.3411, label: 2, bag_size: 263
batch 200, loss: 0.5801, instance_loss: 0.3789, weighted_loss: 0.5198, label: 2, bag_size: 193
batch 300, loss: 0.0550, instance_loss: 0.1542, weighted_loss: 0.0848, label: 2, bag_size: 969
batch 400, loss: 1.4564, instance_loss: 0.7431, weighted_loss: 1.2424, label: 3, bag_size: 679
batch 500, loss: 1.8902, instance_loss: 0.8574, weighted_loss: 1.5804, label: 3, bag_size: 256
batch 600, loss: 0.0495, instance_loss: 0.1293, weighted_loss: 0.0734, label: 2, bag_size: 1015
batch 700, loss: 0.5299, instance_loss: 0.3747, weighted_loss: 0.4834, label: 2, bag_size: 386
batch 800, loss: 1.4499, instance_loss: 0.6961, weighted_loss: 1.2238, label: 3, bag_size: 327
batch 900, loss: 0.3576, instance_loss: 0.2890, weighted_loss: 0.3370, label: 2, bag_size: 433
batch 1000, loss: 2.2871, instance_loss: 0.9064, weighted_loss: 1.8729, label: 1, bag_size: 406
batch 1100, loss: 0.3957, instance_loss: 0.2976, weighted_loss: 0.3663, label: 2, bag_size: 253
batch 1200, loss: 1.0929, instance_loss: 0.7008, weighted_loss: 0.9753, label: 3, bag_size: 209
batch 1300, loss: 1.2576, instance_loss: 0.6387, weighted_loss: 1.0719, label: 3, bag_size: 216
batch 1400, loss: 0.7061, instance_loss: 0.4129, weighted_loss: 0.6182, label: 2, bag_size: 350
batch 1500, loss: 0.7304, instance_loss: 0.5360, weighted_loss: 0.6721, label: 1, bag_size: 1006
batch 1600, loss: 0.1793, instance_loss: 0.2494, weighted_loss: 0.2003, label: 2, bag_size: 857
batch 1700, loss: 1.8517, instance_loss: 0.7447, weighted_loss: 1.5196, label: 1, bag_size: 302
batch 1800, loss: 0.6909, instance_loss: 0.4670, weighted_loss: 0.6237, label: 1, bag_size: 135
batch 1900, loss: 0.5431, instance_loss: 0.2558, weighted_loss: 0.4569, label: 2, bag_size: 696
batch 2000, loss: 0.5113, instance_loss: 0.3371, weighted_loss: 0.4590, label: 2, bag_size: 625
batch 2100, loss: 0.9343, instance_loss: 0.6421, weighted_loss: 0.8466, label: 1, bag_size: 637

Instance Classifier Stats
class 0 clustering acc 0.9850806451612903: correct 68404/69440
class 1 clustering acc 0.3241359447004608: correct 5627/17360

Epoch: 19, train_loss: 0.7957, train_clustering_loss:  0.4435, train_error: 0.3401
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782 
coarse class 2: coarse acc 0.8528058877644894, correct coarse 927/1087 
coarse class 3: coarse acc 0.027237354085603113, correct coarse 7/257 
Overall Accuracy: 0.6599

Val Set, val_loss: 0.7903, val_error: 0.3333, auc: 0.7748
class 0 clustering acc 0.9834280303030303: correct 8308/8448 
class 1 clustering acc 0.3835227272727273: correct 810/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.3652

Training for coarse level...
batch 100, loss: 0.0956, instance_loss: 0.1403, weighted_loss: 0.1090, label: 2, bag_size: 834
batch 200, loss: 2.5202, instance_loss: 0.9606, weighted_loss: 2.0523, label: 0, bag_size: 235
batch 300, loss: 0.1525, instance_loss: 0.2074, weighted_loss: 0.1690, label: 2, bag_size: 1211
batch 400, loss: 1.0404, instance_loss: 0.6552, weighted_loss: 0.9249, label: 1, bag_size: 296
batch 500, loss: 0.5714, instance_loss: 0.4749, weighted_loss: 0.5425, label: 2, bag_size: 373
batch 600, loss: 1.1565, instance_loss: 0.6819, weighted_loss: 1.0141, label: 1, bag_size: 858
batch 700, loss: 3.4269, instance_loss: 1.5917, weighted_loss: 2.8764, label: 3, bag_size: 2158
batch 800, loss: 0.8359, instance_loss: 0.5275, weighted_loss: 0.7434, label: 2, bag_size: 131
batch 900, loss: 1.1555, instance_loss: 0.4871, weighted_loss: 0.9550, label: 2, bag_size: 2023
batch 1000, loss: 1.3005, instance_loss: 0.6902, weighted_loss: 1.1174, label: 1, bag_size: 952
batch 1100, loss: 0.0866, instance_loss: 0.2048, weighted_loss: 0.1221, label: 1, bag_size: 534
batch 1200, loss: 1.0994, instance_loss: 0.5147, weighted_loss: 0.9240, label: 2, bag_size: 95
batch 1300, loss: 0.3477, instance_loss: 0.3201, weighted_loss: 0.3394, label: 1, bag_size: 600
batch 1400, loss: 1.2286, instance_loss: 0.5379, weighted_loss: 1.0214, label: 1, bag_size: 298
batch 1500, loss: 0.9324, instance_loss: 0.5187, weighted_loss: 0.8083, label: 2, bag_size: 401
batch 1600, loss: 0.6032, instance_loss: 0.4969, weighted_loss: 0.5713, label: 1, bag_size: 1744
batch 1700, loss: 0.0901, instance_loss: 0.2796, weighted_loss: 0.1469, label: 1, bag_size: 836
batch 1800, loss: 1.3565, instance_loss: 0.8258, weighted_loss: 1.1973, label: 3, bag_size: 490
batch 1900, loss: 0.3905, instance_loss: 0.2554, weighted_loss: 0.3500, label: 2, bag_size: 690
batch 2000, loss: 1.5266, instance_loss: 0.7510, weighted_loss: 1.2939, label: 3, bag_size: 159
batch 2100, loss: 0.5570, instance_loss: 0.3622, weighted_loss: 0.4986, label: 2, bag_size: 577

Instance Classifier Stats
class 0 clustering acc 0.985411866359447: correct 68427/69440
class 1 clustering acc 0.32764976958525344: correct 5688/17360

Epoch: 20, train_loss: 0.7931, train_clustering_loss:  0.4426, train_error: 0.3382
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.860165593376265, correct coarse 935/1087 
coarse class 3: coarse acc 0.0311284046692607, correct coarse 8/257 
Overall Accuracy: 0.6618

Val Set, val_loss: 0.7871, val_error: 0.3333, auc: 0.7761
class 0 clustering acc 0.9824810606060606: correct 8300/8448 
class 1 clustering acc 0.3953598484848485: correct 835/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.3650

Training for coarse level...
batch 100, loss: 0.5798, instance_loss: 0.4969, weighted_loss: 0.5549, label: 1, bag_size: 1205
batch 200, loss: 0.1450, instance_loss: 0.2290, weighted_loss: 0.1702, label: 2, bag_size: 506
batch 300, loss: 0.4080, instance_loss: 0.2927, weighted_loss: 0.3734, label: 2, bag_size: 714
batch 400, loss: 0.4386, instance_loss: 0.2601, weighted_loss: 0.3850, label: 2, bag_size: 264
batch 500, loss: 0.7695, instance_loss: 0.3675, weighted_loss: 0.6489, label: 2, bag_size: 448
batch 600, loss: 0.2202, instance_loss: 0.1686, weighted_loss: 0.2047, label: 2, bag_size: 1798
batch 700, loss: 0.6869, instance_loss: 0.2913, weighted_loss: 0.5682, label: 2, bag_size: 259
batch 800, loss: 1.5807, instance_loss: 0.8718, weighted_loss: 1.3680, label: 3, bag_size: 450
batch 900, loss: 1.0420, instance_loss: 0.6360, weighted_loss: 0.9202, label: 2, bag_size: 40
batch 1000, loss: 1.2764, instance_loss: 0.5942, weighted_loss: 1.0717, label: 1, bag_size: 402
batch 1100, loss: 0.1482, instance_loss: 0.1775, weighted_loss: 0.1570, label: 2, bag_size: 341
batch 1200, loss: 0.2413, instance_loss: 0.2648, weighted_loss: 0.2484, label: 2, bag_size: 424
batch 1300, loss: 2.1280, instance_loss: 0.9728, weighted_loss: 1.7814, label: 3, bag_size: 682
batch 1400, loss: 3.6173, instance_loss: 1.2036, weighted_loss: 2.8932, label: 2, bag_size: 3015
batch 1500, loss: 0.0677, instance_loss: 0.1836, weighted_loss: 0.1025, label: 2, bag_size: 764
batch 1600, loss: 2.2156, instance_loss: 0.7701, weighted_loss: 1.7820, label: 3, bag_size: 243
batch 1700, loss: 0.0540, instance_loss: 0.1148, weighted_loss: 0.0722, label: 2, bag_size: 424
batch 1800, loss: 0.1644, instance_loss: 0.1563, weighted_loss: 0.1620, label: 1, bag_size: 1867
batch 1900, loss: 2.3836, instance_loss: 0.9751, weighted_loss: 1.9610, label: 3, bag_size: 481
batch 2000, loss: 0.7843, instance_loss: 0.3823, weighted_loss: 0.6637, label: 2, bag_size: 444
batch 2100, loss: 1.1340, instance_loss: 0.5452, weighted_loss: 0.9574, label: 2, bag_size: 132

Instance Classifier Stats
class 0 clustering acc 0.9851526497695853: correct 68409/69440
class 1 clustering acc 0.3389976958525346: correct 5885/17360

Epoch: 21, train_loss: 0.7887, train_clustering_loss:  0.4393, train_error: 0.3359
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8610855565777369, correct coarse 936/1087 
coarse class 3: coarse acc 0.0311284046692607, correct coarse 8/257 
Overall Accuracy: 0.6641

Val Set, val_loss: 0.7842, val_error: 0.3333, auc: 0.7774
class 0 clustering acc 0.9820075757575758: correct 8296/8448 
class 1 clustering acc 0.3972537878787879: correct 839/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.3661

Training for coarse level...
batch 100, loss: 0.1008, instance_loss: 0.1684, weighted_loss: 0.1211, label: 2, bag_size: 505
batch 200, loss: 1.0832, instance_loss: 0.5525, weighted_loss: 0.9240, label: 2, bag_size: 242
batch 300, loss: 0.0537, instance_loss: 0.1356, weighted_loss: 0.0783, label: 1, bag_size: 467
batch 400, loss: 3.1750, instance_loss: 1.0167, weighted_loss: 2.5275, label: 0, bag_size: 474
batch 500, loss: 0.5675, instance_loss: 0.2694, weighted_loss: 0.4780, label: 2, bag_size: 355
batch 600, loss: 0.2429, instance_loss: 0.1990, weighted_loss: 0.2297, label: 2, bag_size: 424
batch 700, loss: 1.1268, instance_loss: 0.4991, weighted_loss: 0.9385, label: 1, bag_size: 823
batch 800, loss: 1.6584, instance_loss: 0.7064, weighted_loss: 1.3728, label: 3, bag_size: 185
batch 900, loss: 0.0522, instance_loss: 0.1614, weighted_loss: 0.0850, label: 2, bag_size: 178
batch 1000, loss: 0.1257, instance_loss: 0.1605, weighted_loss: 0.1361, label: 2, bag_size: 208
batch 1100, loss: 0.0850, instance_loss: 0.1790, weighted_loss: 0.1132, label: 2, bag_size: 192
batch 1200, loss: 0.3154, instance_loss: 0.3664, weighted_loss: 0.3307, label: 1, bag_size: 780
batch 1300, loss: 2.8815, instance_loss: 0.9316, weighted_loss: 2.2965, label: 0, bag_size: 320
batch 1400, loss: 0.9387, instance_loss: 0.5364, weighted_loss: 0.8180, label: 1, bag_size: 344
batch 1500, loss: 0.9568, instance_loss: 0.4395, weighted_loss: 0.8016, label: 1, bag_size: 308
batch 1600, loss: 0.9291, instance_loss: 0.4846, weighted_loss: 0.7958, label: 1, bag_size: 179
batch 1700, loss: 0.0943, instance_loss: 0.3293, weighted_loss: 0.1648, label: 1, bag_size: 606
batch 1800, loss: 1.8343, instance_loss: 0.7639, weighted_loss: 1.5132, label: 1, bag_size: 360
batch 1900, loss: 0.0579, instance_loss: 0.1269, weighted_loss: 0.0786, label: 2, bag_size: 637
batch 2000, loss: 0.7960, instance_loss: 0.4522, weighted_loss: 0.6929, label: 2, bag_size: 110
batch 2100, loss: 0.1024, instance_loss: 0.1918, weighted_loss: 0.1292, label: 2, bag_size: 409

Instance Classifier Stats
class 0 clustering acc 0.9847638248847926: correct 68382/69440
class 1 clustering acc 0.34170506912442394: correct 5932/17360

Epoch: 22, train_loss: 0.7871, train_clustering_loss:  0.4377, train_error: 0.3346
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6240409207161125, correct coarse 488/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.042801556420233464, correct coarse 11/257 
Overall Accuracy: 0.6654

Val Set, val_loss: 0.7817, val_error: 0.3333, auc: 0.7781
class 0 clustering acc 0.9820075757575758: correct 8296/8448 
class 1 clustering acc 0.3991477272727273: correct 843/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.3656

Training for coarse level...
batch 100, loss: 2.5057, instance_loss: 0.8344, weighted_loss: 2.0043, label: 3, bag_size: 205
batch 200, loss: 0.5035, instance_loss: 0.3160, weighted_loss: 0.4472, label: 2, bag_size: 202
batch 300, loss: 0.2555, instance_loss: 0.2654, weighted_loss: 0.2585, label: 2, bag_size: 393
batch 400, loss: 3.9425, instance_loss: 1.2254, weighted_loss: 3.1274, label: 0, bag_size: 807
batch 500, loss: 1.1957, instance_loss: 0.6776, weighted_loss: 1.0403, label: 3, bag_size: 391
batch 600, loss: 0.4431, instance_loss: 0.3443, weighted_loss: 0.4135, label: 2, bag_size: 1062
batch 700, loss: 1.1246, instance_loss: 0.5393, weighted_loss: 0.9490, label: 2, bag_size: 3471
batch 800, loss: 0.0937, instance_loss: 0.1595, weighted_loss: 0.1135, label: 1, bag_size: 483
batch 900, loss: 0.3549, instance_loss: 0.2923, weighted_loss: 0.3361, label: 2, bag_size: 1853
batch 1000, loss: 1.0275, instance_loss: 0.6089, weighted_loss: 0.9019, label: 2, bag_size: 242
batch 1100, loss: 1.4641, instance_loss: 0.7096, weighted_loss: 1.2378, label: 3, bag_size: 478
batch 1200, loss: 0.1563, instance_loss: 0.2996, weighted_loss: 0.1993, label: 1, bag_size: 112
batch 1300, loss: 2.4043, instance_loss: 1.1050, weighted_loss: 2.0145, label: 1, bag_size: 665
batch 1400, loss: 1.2951, instance_loss: 0.6166, weighted_loss: 1.0915, label: 2, bag_size: 409
batch 1500, loss: 1.3133, instance_loss: 0.7935, weighted_loss: 1.1574, label: 3, bag_size: 263
batch 1600, loss: 1.1756, instance_loss: 0.8144, weighted_loss: 1.0672, label: 1, bag_size: 972
batch 1700, loss: 0.9624, instance_loss: 0.5556, weighted_loss: 0.8404, label: 1, bag_size: 49
batch 1800, loss: 0.9777, instance_loss: 0.6532, weighted_loss: 0.8803, label: 3, bag_size: 120
batch 1900, loss: 0.1609, instance_loss: 0.2356, weighted_loss: 0.1833, label: 1, bag_size: 848
batch 2000, loss: 0.0223, instance_loss: 0.0852, weighted_loss: 0.0412, label: 1, bag_size: 199
batch 2100, loss: 1.2546, instance_loss: 0.5506, weighted_loss: 1.0434, label: 1, bag_size: 558

Instance Classifier Stats
class 0 clustering acc 0.9849222350230414: correct 68393/69440
class 1 clustering acc 0.3434331797235023: correct 5962/17360

Epoch: 23, train_loss: 0.7847, train_clustering_loss:  0.4374, train_error: 0.3355
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6278772378516624, correct coarse 491/782 
coarse class 2: coarse acc 0.8675252989880404, correct coarse 943/1087 
coarse class 3: coarse acc 0.0311284046692607, correct coarse 8/257 
Overall Accuracy: 0.6645

Val Set, val_loss: 0.7792, val_error: 0.3295, auc: 0.7802
class 0 clustering acc 0.9818892045454546: correct 8295/8448 
class 1 clustering acc 0.40198863636363635: correct 849/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6705
Overall F1 Score: 0.3676

Training for coarse level...
batch 100, loss: 1.1404, instance_loss: 0.6373, weighted_loss: 0.9894, label: 1, bag_size: 568
batch 200, loss: 0.2503, instance_loss: 0.4221, weighted_loss: 0.3018, label: 1, bag_size: 1365
batch 300, loss: 1.7090, instance_loss: 0.7159, weighted_loss: 1.4110, label: 1, bag_size: 1009
batch 400, loss: 3.8084, instance_loss: 0.9727, weighted_loss: 2.9577, label: 3, bag_size: 393
batch 500, loss: 0.3254, instance_loss: 0.3893, weighted_loss: 0.3446, label: 1, bag_size: 697
batch 600, loss: 0.4115, instance_loss: 0.2318, weighted_loss: 0.3576, label: 2, bag_size: 510
batch 700, loss: 0.3200, instance_loss: 0.3394, weighted_loss: 0.3258, label: 2, bag_size: 394
batch 800, loss: 0.5719, instance_loss: 0.2924, weighted_loss: 0.4880, label: 2, bag_size: 337
batch 900, loss: 0.7781, instance_loss: 0.3767, weighted_loss: 0.6577, label: 2, bag_size: 344
batch 1000, loss: 0.7571, instance_loss: 0.6240, weighted_loss: 0.7172, label: 1, bag_size: 1124
batch 1100, loss: 0.0752, instance_loss: 0.3152, weighted_loss: 0.1472, label: 1, bag_size: 388
batch 1200, loss: 0.0364, instance_loss: 0.1072, weighted_loss: 0.0576, label: 1, bag_size: 556
batch 1300, loss: 2.0942, instance_loss: 0.8284, weighted_loss: 1.7145, label: 3, bag_size: 243
batch 1400, loss: 0.3074, instance_loss: 0.2449, weighted_loss: 0.2886, label: 2, bag_size: 732
batch 1500, loss: 0.5753, instance_loss: 0.4226, weighted_loss: 0.5295, label: 2, bag_size: 258
batch 1600, loss: 0.2202, instance_loss: 0.2455, weighted_loss: 0.2278, label: 2, bag_size: 346
batch 1700, loss: 0.2188, instance_loss: 0.2809, weighted_loss: 0.2374, label: 1, bag_size: 1692
batch 1800, loss: 0.1196, instance_loss: 0.3703, weighted_loss: 0.1948, label: 1, bag_size: 650
batch 1900, loss: 0.2419, instance_loss: 0.2373, weighted_loss: 0.2405, label: 2, bag_size: 359
batch 2000, loss: 1.2758, instance_loss: 0.5438, weighted_loss: 1.0562, label: 1, bag_size: 298
batch 2100, loss: 1.1492, instance_loss: 0.5155, weighted_loss: 0.9591, label: 2, bag_size: 297

Instance Classifier Stats
class 0 clustering acc 0.9843894009216589: correct 68356/69440
class 1 clustering acc 0.3540898617511521: correct 6147/17360

Epoch: 24, train_loss: 0.7814, train_clustering_loss:  0.4357, train_error: 0.3341
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6329923273657289, correct coarse 495/782 
coarse class 2: coarse acc 0.8675252989880404, correct coarse 943/1087 
coarse class 3: coarse acc 0.027237354085603113, correct coarse 7/257 
Overall Accuracy: 0.6659

Val Set, val_loss: 0.7768, val_error: 0.3220, auc: 0.7808
class 0 clustering acc 0.9818892045454546: correct 8295/8448 
class 1 clustering acc 0.40482954545454547: correct 855/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.3713

Training for coarse level...
batch 100, loss: 0.6715, instance_loss: 0.4638, weighted_loss: 0.6092, label: 2, bag_size: 896
batch 200, loss: 0.1700, instance_loss: 0.1779, weighted_loss: 0.1724, label: 2, bag_size: 304
batch 300, loss: 0.0999, instance_loss: 0.1702, weighted_loss: 0.1210, label: 1, bag_size: 942
batch 400, loss: 0.0848, instance_loss: 0.1686, weighted_loss: 0.1099, label: 1, bag_size: 1301
batch 500, loss: 0.3581, instance_loss: 0.1497, weighted_loss: 0.2956, label: 1, bag_size: 2159
batch 600, loss: 1.2210, instance_loss: 0.7920, weighted_loss: 1.0923, label: 1, bag_size: 495
batch 700, loss: 0.7539, instance_loss: 0.3887, weighted_loss: 0.6444, label: 2, bag_size: 233
batch 800, loss: 0.2585, instance_loss: 0.2826, weighted_loss: 0.2657, label: 2, bag_size: 2114
batch 900, loss: 0.2110, instance_loss: 0.2004, weighted_loss: 0.2078, label: 2, bag_size: 624
batch 1000, loss: 0.0678, instance_loss: 0.1378, weighted_loss: 0.0888, label: 1, bag_size: 786
batch 1100, loss: 1.0698, instance_loss: 0.5595, weighted_loss: 0.9167, label: 2, bag_size: 248
batch 1200, loss: 1.1835, instance_loss: 0.5751, weighted_loss: 1.0010, label: 1, bag_size: 285
batch 1300, loss: 0.1075, instance_loss: 0.1655, weighted_loss: 0.1249, label: 2, bag_size: 221
batch 1400, loss: 0.7951, instance_loss: 0.3721, weighted_loss: 0.6682, label: 2, bag_size: 677
batch 1500, loss: 0.1146, instance_loss: 0.1592, weighted_loss: 0.1280, label: 2, bag_size: 305
batch 1600, loss: 1.4247, instance_loss: 0.7243, weighted_loss: 1.2146, label: 2, bag_size: 957
batch 1700, loss: 0.2009, instance_loss: 0.2034, weighted_loss: 0.2016, label: 2, bag_size: 457
batch 1800, loss: 0.2571, instance_loss: 0.3159, weighted_loss: 0.2747, label: 2, bag_size: 482
batch 1900, loss: 0.8155, instance_loss: 0.4090, weighted_loss: 0.6936, label: 2, bag_size: 317
batch 2000, loss: 3.1418, instance_loss: 0.9939, weighted_loss: 2.4974, label: 0, bag_size: 474
batch 2100, loss: 1.1256, instance_loss: 0.5844, weighted_loss: 0.9632, label: 3, bag_size: 120

Instance Classifier Stats
class 0 clustering acc 0.9840581797235023: correct 68333/69440
class 1 clustering acc 0.35184331797235024: correct 6108/17360

Epoch: 25, train_loss: 0.7791, train_clustering_loss:  0.4353, train_error: 0.3327
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8684452621895125, correct coarse 944/1087 
coarse class 3: coarse acc 0.04669260700389105, correct coarse 12/257 
Overall Accuracy: 0.6673

Val Set, val_loss: 0.7746, val_error: 0.3258, auc: 0.7811
class 0 clustering acc 0.9814157196969697: correct 8291/8448 
class 1 clustering acc 0.4071969696969697: correct 860/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6742
Overall F1 Score: 0.3694

Training for coarse level...
batch 100, loss: 0.9041, instance_loss: 0.4636, weighted_loss: 0.7720, label: 1, bag_size: 2085
batch 200, loss: 0.6996, instance_loss: 0.3169, weighted_loss: 0.5848, label: 2, bag_size: 259
batch 300, loss: 0.1436, instance_loss: 0.1153, weighted_loss: 0.1351, label: 1, bag_size: 1867
batch 400, loss: 0.1457, instance_loss: 0.1694, weighted_loss: 0.1528, label: 2, bag_size: 225
batch 500, loss: 1.4661, instance_loss: 0.5635, weighted_loss: 1.1953, label: 2, bag_size: 153
batch 600, loss: 1.4580, instance_loss: 0.7168, weighted_loss: 1.2357, label: 1, bag_size: 188
batch 700, loss: 0.0502, instance_loss: 0.1246, weighted_loss: 0.0725, label: 2, bag_size: 484
batch 800, loss: 0.1372, instance_loss: 0.1490, weighted_loss: 0.1408, label: 2, bag_size: 796
batch 900, loss: 0.2905, instance_loss: 0.3808, weighted_loss: 0.3176, label: 1, bag_size: 685
batch 1000, loss: 0.7865, instance_loss: 0.6402, weighted_loss: 0.7426, label: 1, bag_size: 1049
batch 1100, loss: 0.1208, instance_loss: 0.1989, weighted_loss: 0.1442, label: 1, bag_size: 1049
batch 1200, loss: 1.0707, instance_loss: 0.5729, weighted_loss: 0.9214, label: 2, bag_size: 770
batch 1300, loss: 0.2462, instance_loss: 0.4111, weighted_loss: 0.2957, label: 1, bag_size: 2186
batch 1400, loss: 0.0775, instance_loss: 0.1450, weighted_loss: 0.0977, label: 2, bag_size: 651
batch 1500, loss: 0.8934, instance_loss: 0.5765, weighted_loss: 0.7983, label: 1, bag_size: 49
batch 1600, loss: 0.8815, instance_loss: 0.4801, weighted_loss: 0.7611, label: 2, bag_size: 590
batch 1700, loss: 0.1734, instance_loss: 0.2221, weighted_loss: 0.1880, label: 1, bag_size: 177
batch 1800, loss: 0.8868, instance_loss: 0.5039, weighted_loss: 0.7720, label: 2, bag_size: 188
batch 1900, loss: 1.4227, instance_loss: 0.8777, weighted_loss: 1.2592, label: 3, bag_size: 2218
batch 2000, loss: 0.0271, instance_loss: 0.0962, weighted_loss: 0.0478, label: 2, bag_size: 331
batch 2100, loss: 0.3106, instance_loss: 0.3492, weighted_loss: 0.3221, label: 2, bag_size: 353

Instance Classifier Stats
class 0 clustering acc 0.9840293778801843: correct 68331/69440
class 1 clustering acc 0.356221198156682: correct 6184/17360

Epoch: 26, train_loss: 0.7774, train_clustering_loss:  0.4335, train_error: 0.3313
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8656853725850966, correct coarse 941/1087 
coarse class 3: coarse acc 0.05058365758754864, correct coarse 13/257 
Overall Accuracy: 0.6687

Val Set, val_loss: 0.7725, val_error: 0.3295, auc: 0.7817
class 0 clustering acc 0.9808238636363636: correct 8286/8448 
class 1 clustering acc 0.4095643939393939: correct 865/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.59375, correct coarse 57/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6705
Overall F1 Score: 0.3661

Training for coarse level...
batch 100, loss: 1.1076, instance_loss: 0.6274, weighted_loss: 0.9635, label: 2, bag_size: 463
batch 200, loss: 0.8610, instance_loss: 0.5771, weighted_loss: 0.7759, label: 1, bag_size: 183
batch 300, loss: 2.3635, instance_loss: 0.9462, weighted_loss: 1.9383, label: 1, bag_size: 406
batch 400, loss: 0.5426, instance_loss: 0.4748, weighted_loss: 0.5222, label: 1, bag_size: 1174
batch 500, loss: 1.0432, instance_loss: 0.7065, weighted_loss: 0.9422, label: 1, bag_size: 170
batch 600, loss: 0.2568, instance_loss: 0.2144, weighted_loss: 0.2441, label: 2, bag_size: 1045
batch 700, loss: 0.7848, instance_loss: 0.5806, weighted_loss: 0.7235, label: 1, bag_size: 238
batch 800, loss: 0.9149, instance_loss: 0.5525, weighted_loss: 0.8062, label: 1, bag_size: 459
batch 900, loss: 0.2108, instance_loss: 0.3313, weighted_loss: 0.2469, label: 1, bag_size: 3530
batch 1000, loss: 0.7043, instance_loss: 0.4268, weighted_loss: 0.6211, label: 2, bag_size: 335
batch 1100, loss: 0.4767, instance_loss: 0.2968, weighted_loss: 0.4227, label: 2, bag_size: 206
batch 1200, loss: 0.0923, instance_loss: 0.1433, weighted_loss: 0.1076, label: 1, bag_size: 224
batch 1300, loss: 0.9394, instance_loss: 0.5788, weighted_loss: 0.8312, label: 1, bag_size: 454
batch 1400, loss: 0.3779, instance_loss: 0.2449, weighted_loss: 0.3380, label: 2, bag_size: 2443
batch 1500, loss: 0.0716, instance_loss: 0.2205, weighted_loss: 0.1163, label: 2, bag_size: 400
batch 1600, loss: 1.5592, instance_loss: 0.6533, weighted_loss: 1.2874, label: 1, bag_size: 98
batch 1700, loss: 1.4279, instance_loss: 0.7959, weighted_loss: 1.2383, label: 3, bag_size: 159
batch 1800, loss: 0.2406, instance_loss: 0.1577, weighted_loss: 0.2157, label: 1, bag_size: 313
batch 1900, loss: 1.1324, instance_loss: 0.7484, weighted_loss: 1.0172, label: 3, bag_size: 461
batch 2000, loss: 0.0883, instance_loss: 0.1095, weighted_loss: 0.0947, label: 2, bag_size: 162
batch 2100, loss: 0.1142, instance_loss: 0.2339, weighted_loss: 0.1501, label: 1, bag_size: 389

Instance Classifier Stats
class 0 clustering acc 0.9836117511520738: correct 68302/69440
class 1 clustering acc 0.36082949308755763: correct 6264/17360

Epoch: 27, train_loss: 0.7752, train_clustering_loss:  0.4332, train_error: 0.3304
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6240409207161125, correct coarse 488/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.04669260700389105, correct coarse 12/257 
Overall Accuracy: 0.6696

Val Set, val_loss: 0.7713, val_error: 0.3295, auc: 0.7828
class 0 clustering acc 0.9810606060606061: correct 8288/8448 
class 1 clustering acc 0.4114583333333333: correct 869/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6705
Overall F1 Score: 0.3691

Training for coarse level...
batch 100, loss: 0.9279, instance_loss: 0.5282, weighted_loss: 0.8080, label: 2, bag_size: 284
batch 200, loss: 1.4683, instance_loss: 0.5667, weighted_loss: 1.1978, label: 1, bag_size: 254
batch 300, loss: 0.1933, instance_loss: 0.2886, weighted_loss: 0.2219, label: 1, bag_size: 2214
batch 400, loss: 0.0651, instance_loss: 0.1458, weighted_loss: 0.0893, label: 2, bag_size: 254
batch 500, loss: 0.0364, instance_loss: 0.0986, weighted_loss: 0.0550, label: 2, bag_size: 634
batch 600, loss: 1.3889, instance_loss: 0.8620, weighted_loss: 1.2308, label: 1, bag_size: 1381
batch 700, loss: 2.3533, instance_loss: 1.0106, weighted_loss: 1.9505, label: 2, bag_size: 1555
batch 800, loss: 0.0782, instance_loss: 0.1320, weighted_loss: 0.0943, label: 2, bag_size: 728
batch 900, loss: 0.0422, instance_loss: 0.1804, weighted_loss: 0.0837, label: 1, bag_size: 714
batch 1000, loss: 1.3868, instance_loss: 0.6985, weighted_loss: 1.1803, label: 1, bag_size: 142
batch 1100, loss: 0.4404, instance_loss: 0.3836, weighted_loss: 0.4234, label: 2, bag_size: 665
batch 1200, loss: 1.3612, instance_loss: 0.7240, weighted_loss: 1.1700, label: 3, bag_size: 259
batch 1300, loss: 0.1209, instance_loss: 0.1785, weighted_loss: 0.1382, label: 1, bag_size: 1231
batch 1400, loss: 1.0135, instance_loss: 0.6073, weighted_loss: 0.8916, label: 2, bag_size: 471
batch 1500, loss: 0.7728, instance_loss: 0.4031, weighted_loss: 0.6619, label: 2, bag_size: 233
batch 1600, loss: 0.0767, instance_loss: 0.1823, weighted_loss: 0.1084, label: 2, bag_size: 290
batch 1700, loss: 1.7505, instance_loss: 0.7698, weighted_loss: 1.4563, label: 1, bag_size: 359
batch 1800, loss: 0.4679, instance_loss: 0.5371, weighted_loss: 0.4886, label: 1, bag_size: 3773
batch 1900, loss: 0.0203, instance_loss: 0.1365, weighted_loss: 0.0552, label: 1, bag_size: 2272
batch 2000, loss: 0.0656, instance_loss: 0.1199, weighted_loss: 0.0819, label: 2, bag_size: 745
batch 2100, loss: 0.8226, instance_loss: 0.4569, weighted_loss: 0.7129, label: 2, bag_size: 513

Instance Classifier Stats
class 0 clustering acc 0.9841157834101383: correct 68337/69440
class 1 clustering acc 0.3664746543778802: correct 6362/17360

Epoch: 28, train_loss: 0.7735, train_clustering_loss:  0.4315, train_error: 0.3272
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.058365758754863814, correct coarse 15/257 
Overall Accuracy: 0.6728

Val Set, val_loss: 0.7696, val_error: 0.3295, auc: 0.7828
class 0 clustering acc 0.9811789772727273: correct 8289/8448 
class 1 clustering acc 0.4090909090909091: correct 864/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.06666666666666667, correct coarse 2/30 
Overall Accuracy: 0.6705
Overall F1 Score: 0.3821

Training for coarse level...
batch 100, loss: 0.5801, instance_loss: 0.2422, weighted_loss: 0.4787, label: 2, bag_size: 1339
batch 200, loss: 3.2343, instance_loss: 1.0115, weighted_loss: 2.5675, label: 0, bag_size: 863
batch 300, loss: 1.5099, instance_loss: 0.8060, weighted_loss: 1.2987, label: 3, bag_size: 501
batch 400, loss: 0.6452, instance_loss: 0.3492, weighted_loss: 0.5564, label: 2, bag_size: 343
batch 500, loss: 2.3311, instance_loss: 0.8705, weighted_loss: 1.8929, label: 1, bag_size: 406
batch 600, loss: 1.5765, instance_loss: 0.7807, weighted_loss: 1.3378, label: 3, bag_size: 149
batch 700, loss: 0.4731, instance_loss: 0.2866, weighted_loss: 0.4172, label: 2, bag_size: 630
batch 800, loss: 0.1017, instance_loss: 0.1598, weighted_loss: 0.1191, label: 2, bag_size: 221
batch 900, loss: 0.9079, instance_loss: 0.4316, weighted_loss: 0.7650, label: 1, bag_size: 1257
batch 1000, loss: 0.0974, instance_loss: 0.1296, weighted_loss: 0.1070, label: 2, bag_size: 518
batch 1100, loss: 0.3284, instance_loss: 0.2822, weighted_loss: 0.3146, label: 2, bag_size: 244
batch 1200, loss: 2.7864, instance_loss: 0.8978, weighted_loss: 2.2198, label: 0, bag_size: 129
batch 1300, loss: 0.9334, instance_loss: 0.5009, weighted_loss: 0.8036, label: 2, bag_size: 452
batch 1400, loss: 0.7447, instance_loss: 0.3619, weighted_loss: 0.6298, label: 2, bag_size: 448
batch 1500, loss: 0.8418, instance_loss: 0.4459, weighted_loss: 0.7230, label: 2, bag_size: 595
batch 1600, loss: 0.8413, instance_loss: 0.4261, weighted_loss: 0.7167, label: 2, bag_size: 373
batch 1700, loss: 1.4660, instance_loss: 0.5753, weighted_loss: 1.1988, label: 1, bag_size: 185
batch 1800, loss: 0.0690, instance_loss: 0.1336, weighted_loss: 0.0884, label: 2, bag_size: 290
batch 1900, loss: 1.6355, instance_loss: 0.6152, weighted_loss: 1.3294, label: 3, bag_size: 79
batch 2000, loss: 1.1137, instance_loss: 0.6658, weighted_loss: 0.9793, label: 1, bag_size: 287
batch 2100, loss: 0.4252, instance_loss: 0.3075, weighted_loss: 0.3899, label: 2, bag_size: 838

Instance Classifier Stats
class 0 clustering acc 0.9830069124423964: correct 68260/69440
class 1 clustering acc 0.36566820276497697: correct 6348/17360

Epoch: 29, train_loss: 0.7720, train_clustering_loss:  0.4309, train_error: 0.3258
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.07392996108949416, correct coarse 19/257 
Overall Accuracy: 0.6742

Val Set, val_loss: 0.7680, val_error: 0.3258, auc: 0.7837
class 0 clustering acc 0.9809422348484849: correct 8287/8448 
class 1 clustering acc 0.4114583333333333: correct 869/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6742
Overall F1 Score: 0.3695

Training for coarse level...
batch 100, loss: 0.1810, instance_loss: 0.2233, weighted_loss: 0.1937, label: 2, bag_size: 422
batch 200, loss: 0.7345, instance_loss: 0.4466, weighted_loss: 0.6481, label: 2, bag_size: 526
batch 300, loss: 0.6725, instance_loss: 0.4185, weighted_loss: 0.5963, label: 2, bag_size: 655
batch 400, loss: 0.8507, instance_loss: 0.6618, weighted_loss: 0.7941, label: 1, bag_size: 818
batch 500, loss: 1.1626, instance_loss: 0.8112, weighted_loss: 1.0572, label: 3, bag_size: 568
batch 600, loss: 0.6737, instance_loss: 0.3890, weighted_loss: 0.5882, label: 2, bag_size: 115
batch 700, loss: 1.0465, instance_loss: 0.5974, weighted_loss: 0.9118, label: 1, bag_size: 551
batch 800, loss: 0.0222, instance_loss: 0.0907, weighted_loss: 0.0427, label: 2, bag_size: 169
batch 900, loss: 0.0299, instance_loss: 0.0897, weighted_loss: 0.0479, label: 1, bag_size: 1181
batch 1000, loss: 2.6466, instance_loss: 1.0205, weighted_loss: 2.1588, label: 3, bag_size: 139
batch 1100, loss: 0.6504, instance_loss: 0.4946, weighted_loss: 0.6037, label: 1, bag_size: 1193
batch 1200, loss: 0.0241, instance_loss: 0.0838, weighted_loss: 0.0420, label: 1, bag_size: 848
batch 1300, loss: 0.7365, instance_loss: 0.4474, weighted_loss: 0.6497, label: 1, bag_size: 785
batch 1400, loss: 0.2310, instance_loss: 0.2690, weighted_loss: 0.2424, label: 2, bag_size: 585
batch 1500, loss: 1.8517, instance_loss: 0.9482, weighted_loss: 1.5806, label: 1, bag_size: 559
batch 1600, loss: 1.3119, instance_loss: 0.9079, weighted_loss: 1.1907, label: 1, bag_size: 621
batch 1700, loss: 0.1387, instance_loss: 0.2413, weighted_loss: 0.1694, label: 1, bag_size: 1827
batch 1800, loss: 0.5694, instance_loss: 0.3571, weighted_loss: 0.5057, label: 2, bag_size: 449
batch 1900, loss: 1.1768, instance_loss: 0.7136, weighted_loss: 1.0378, label: 1, bag_size: 169
batch 2000, loss: 0.2106, instance_loss: 0.2925, weighted_loss: 0.2352, label: 1, bag_size: 680
batch 2100, loss: 1.7098, instance_loss: 0.6658, weighted_loss: 1.3966, label: 2, bag_size: 506

Instance Classifier Stats
class 0 clustering acc 0.9841877880184332: correct 68342/69440
class 1 clustering acc 0.36664746543778803: correct 6365/17360

Epoch: 30, train_loss: 0.7708, train_clustering_loss:  0.4297, train_error: 0.3286
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.629156010230179, correct coarse 492/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.058365758754863814, correct coarse 15/257 
Overall Accuracy: 0.6714

Val Set, val_loss: 0.7664, val_error: 0.3220, auc: 0.7838
class 0 clustering acc 0.98046875: correct 8283/8448 
class 1 clustering acc 0.4161931818181818: correct 879/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.03333333333333333, correct coarse 1/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.3718

Training for coarse level...
batch 100, loss: 0.2039, instance_loss: 0.2455, weighted_loss: 0.2164, label: 1, bag_size: 1336
batch 200, loss: 1.0613, instance_loss: 0.6067, weighted_loss: 0.9250, label: 2, bag_size: 469
batch 300, loss: 0.7999, instance_loss: 0.5862, weighted_loss: 0.7358, label: 1, bag_size: 459
batch 400, loss: 0.2398, instance_loss: 0.1737, weighted_loss: 0.2200, label: 2, bag_size: 1874
batch 500, loss: 0.1666, instance_loss: 0.2252, weighted_loss: 0.1842, label: 2, bag_size: 581
batch 600, loss: 1.0335, instance_loss: 0.5223, weighted_loss: 0.8802, label: 1, bag_size: 654
batch 700, loss: 0.3611, instance_loss: 0.1952, weighted_loss: 0.3114, label: 2, bag_size: 860
batch 800, loss: 1.8716, instance_loss: 0.8276, weighted_loss: 1.5584, label: 1, bag_size: 359
batch 900, loss: 0.4964, instance_loss: 0.3487, weighted_loss: 0.4521, label: 1, bag_size: 1665
batch 1000, loss: 1.2370, instance_loss: 0.6233, weighted_loss: 1.0529, label: 1, bag_size: 448
batch 1100, loss: 0.4306, instance_loss: 0.4467, weighted_loss: 0.4354, label: 1, bag_size: 729
batch 1200, loss: 0.1429, instance_loss: 0.2133, weighted_loss: 0.1640, label: 1, bag_size: 755
batch 1300, loss: 0.0576, instance_loss: 0.1168, weighted_loss: 0.0753, label: 2, bag_size: 256
batch 1400, loss: 0.8228, instance_loss: 0.4941, weighted_loss: 0.7242, label: 2, bag_size: 131
batch 1500, loss: 0.4216, instance_loss: 0.3514, weighted_loss: 0.4006, label: 1, bag_size: 2612
batch 1600, loss: 0.5509, instance_loss: 0.3513, weighted_loss: 0.4911, label: 2, bag_size: 488
batch 1700, loss: 0.2548, instance_loss: 0.2513, weighted_loss: 0.2537, label: 2, bag_size: 328
batch 1800, loss: 1.3185, instance_loss: 0.6631, weighted_loss: 1.1219, label: 3, bag_size: 327
batch 1900, loss: 0.8382, instance_loss: 0.4633, weighted_loss: 0.7257, label: 2, bag_size: 466
batch 2000, loss: 2.4360, instance_loss: 0.8306, weighted_loss: 1.9544, label: 0, bag_size: 324
batch 2100, loss: 2.1596, instance_loss: 0.7450, weighted_loss: 1.7352, label: 3, bag_size: 164

Instance Classifier Stats
class 0 clustering acc 0.9837557603686636: correct 68312/69440
class 1 clustering acc 0.37540322580645163: correct 6517/17360

Epoch: 31, train_loss: 0.7695, train_clustering_loss:  0.4285, train_error: 0.3327
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6163682864450127, correct coarse 482/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.04669260700389105, correct coarse 12/257 
Overall Accuracy: 0.6673

Val Set, val_loss: 0.7659, val_error: 0.3333, auc: 0.7840
class 0 clustering acc 0.9808238636363636: correct 8286/8448 
class 1 clustering acc 0.4161931818181818: correct 879/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.835820895522388, correct coarse 112/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
Overall Accuracy: 0.6667
Overall F1 Score: 0.3923

Training for coarse level...
batch 100, loss: 0.0691, instance_loss: 0.1982, weighted_loss: 0.1078, label: 2, bag_size: 400
batch 200, loss: 0.1956, instance_loss: 0.1703, weighted_loss: 0.1880, label: 2, bag_size: 534
batch 300, loss: 0.7672, instance_loss: 0.5158, weighted_loss: 0.6918, label: 2, bag_size: 111
batch 400, loss: 1.6296, instance_loss: 0.7923, weighted_loss: 1.3784, label: 3, bag_size: 625
batch 500, loss: 0.5654, instance_loss: 0.3261, weighted_loss: 0.4936, label: 2, bag_size: 392
batch 600, loss: 1.1311, instance_loss: 0.5131, weighted_loss: 0.9457, label: 2, bag_size: 305
batch 700, loss: 0.3121, instance_loss: 0.2914, weighted_loss: 0.3059, label: 2, bag_size: 353
batch 800, loss: 0.6457, instance_loss: 0.4631, weighted_loss: 0.5909, label: 2, bag_size: 277
batch 900, loss: 1.1839, instance_loss: 0.5058, weighted_loss: 0.9805, label: 2, bag_size: 742
batch 1000, loss: 0.2125, instance_loss: 0.1864, weighted_loss: 0.2047, label: 2, bag_size: 569
batch 1100, loss: 1.1097, instance_loss: 0.5875, weighted_loss: 0.9531, label: 1, bag_size: 304
batch 1200, loss: 0.7682, instance_loss: 0.4845, weighted_loss: 0.6831, label: 2, bag_size: 552
batch 1300, loss: 2.3889, instance_loss: 1.0619, weighted_loss: 1.9908, label: 3, bag_size: 481
batch 1400, loss: 0.2837, instance_loss: 0.3289, weighted_loss: 0.2972, label: 1, bag_size: 206
batch 1500, loss: 1.9160, instance_loss: 0.8694, weighted_loss: 1.6020, label: 3, bag_size: 751
batch 1600, loss: 0.0157, instance_loss: 0.1008, weighted_loss: 0.0412, label: 1, bag_size: 305
batch 1700, loss: 1.3258, instance_loss: 0.7835, weighted_loss: 1.1631, label: 3, bag_size: 450
batch 1800, loss: 0.2923, instance_loss: 0.3445, weighted_loss: 0.3079, label: 1, bag_size: 292
batch 1900, loss: 2.2951, instance_loss: 1.0774, weighted_loss: 1.9298, label: 3, bag_size: 380
batch 2000, loss: 0.0264, instance_loss: 0.0620, weighted_loss: 0.0371, label: 1, bag_size: 919
batch 2100, loss: 1.4584, instance_loss: 0.6483, weighted_loss: 1.2154, label: 1, bag_size: 437

Instance Classifier Stats
class 0 clustering acc 0.9838709677419355: correct 68320/69440
class 1 clustering acc 0.3742511520737327: correct 6497/17360

Epoch: 32, train_loss: 0.7672, train_clustering_loss:  0.4280, train_error: 0.3267
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.07392996108949416, correct coarse 19/257 
Overall Accuracy: 0.6733

Val Set, val_loss: 0.7650, val_error: 0.3295, auc: 0.7843
class 0 clustering acc 0.9808238636363636: correct 8286/8448 
class 1 clustering acc 0.4152462121212121: correct 877/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8432835820895522, correct coarse 113/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
Overall Accuracy: 0.6705
Overall F1 Score: 0.3942

Training for coarse level...
batch 100, loss: 0.0302, instance_loss: 0.0971, weighted_loss: 0.0502, label: 2, bag_size: 257
batch 200, loss: 1.9005, instance_loss: 1.0352, weighted_loss: 1.6409, label: 3, bag_size: 829
batch 300, loss: 0.6973, instance_loss: 0.3390, weighted_loss: 0.5898, label: 2, bag_size: 259
batch 400, loss: 1.1566, instance_loss: 0.5519, weighted_loss: 0.9752, label: 1, bag_size: 175
batch 500, loss: 3.1248, instance_loss: 1.2833, weighted_loss: 2.5723, label: 1, bag_size: 608
batch 600, loss: 0.6255, instance_loss: 0.4966, weighted_loss: 0.5869, label: 2, bag_size: 404
batch 700, loss: 1.7838, instance_loss: 0.8705, weighted_loss: 1.5098, label: 1, bag_size: 234
batch 800, loss: 0.3988, instance_loss: 0.2598, weighted_loss: 0.3571, label: 2, bag_size: 770
batch 900, loss: 0.0678, instance_loss: 0.1213, weighted_loss: 0.0838, label: 2, bag_size: 596
batch 1000, loss: 1.2924, instance_loss: 0.6371, weighted_loss: 1.0958, label: 3, bag_size: 378
batch 1100, loss: 0.0672, instance_loss: 0.0956, weighted_loss: 0.0757, label: 1, bag_size: 558
batch 1200, loss: 0.0329, instance_loss: 0.0963, weighted_loss: 0.0519, label: 2, bag_size: 329
batch 1300, loss: 0.8725, instance_loss: 0.6220, weighted_loss: 0.7974, label: 1, bag_size: 365
batch 1400, loss: 1.8427, instance_loss: 0.8867, weighted_loss: 1.5559, label: 3, bag_size: 310
batch 1500, loss: 0.4276, instance_loss: 0.2632, weighted_loss: 0.3783, label: 2, bag_size: 1555
batch 1600, loss: 0.4193, instance_loss: 0.2826, weighted_loss: 0.3783, label: 1, bag_size: 691
batch 1700, loss: 0.5394, instance_loss: 0.3996, weighted_loss: 0.4975, label: 1, bag_size: 760
batch 1800, loss: 0.7898, instance_loss: 0.6992, weighted_loss: 0.7627, label: 1, bag_size: 1860
batch 1900, loss: 0.7127, instance_loss: 0.3409, weighted_loss: 0.6012, label: 2, bag_size: 449
batch 2000, loss: 1.3132, instance_loss: 0.6602, weighted_loss: 1.1173, label: 1, bag_size: 214
batch 2100, loss: 0.0510, instance_loss: 0.1300, weighted_loss: 0.0747, label: 1, bag_size: 214

Instance Classifier Stats
class 0 clustering acc 0.9834245391705069: correct 68289/69440
class 1 clustering acc 0.371831797235023: correct 6455/17360

Epoch: 33, train_loss: 0.7661, train_clustering_loss:  0.4284, train_error: 0.3276
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6227621483375959, correct coarse 487/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.07392996108949416, correct coarse 19/257 
Overall Accuracy: 0.6724

Val Set, val_loss: 0.7634, val_error: 0.3295, auc: 0.7853
class 0 clustering acc 0.9807054924242424: correct 8285/8448 
class 1 clustering acc 0.4166666666666667: correct 880/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
Overall Accuracy: 0.6705
Overall F1 Score: 0.3941

Training for coarse level...
batch 100, loss: 0.0536, instance_loss: 0.0981, weighted_loss: 0.0669, label: 2, bag_size: 463
batch 200, loss: 0.0527, instance_loss: 0.1164, weighted_loss: 0.0718, label: 2, bag_size: 1325
batch 300, loss: 0.8258, instance_loss: 0.4600, weighted_loss: 0.7161, label: 2, bag_size: 121
batch 400, loss: 1.1928, instance_loss: 0.6730, weighted_loss: 1.0368, label: 3, bag_size: 111
batch 500, loss: 0.7633, instance_loss: 0.4596, weighted_loss: 0.6722, label: 2, bag_size: 450
batch 600, loss: 0.9722, instance_loss: 0.4912, weighted_loss: 0.8279, label: 2, bag_size: 225
batch 700, loss: 0.1324, instance_loss: 0.2282, weighted_loss: 0.1611, label: 2, bag_size: 474
batch 800, loss: 0.1175, instance_loss: 0.1511, weighted_loss: 0.1276, label: 2, bag_size: 357
batch 900, loss: 0.0253, instance_loss: 0.0597, weighted_loss: 0.0356, label: 2, bag_size: 861
batch 1000, loss: 1.2610, instance_loss: 0.5394, weighted_loss: 1.0446, label: 1, bag_size: 364
batch 1100, loss: 0.2076, instance_loss: 0.3540, weighted_loss: 0.2515, label: 1, bag_size: 1171
batch 1200, loss: 1.0930, instance_loss: 0.5673, weighted_loss: 0.9353, label: 1, bag_size: 1256
batch 1300, loss: 0.1728, instance_loss: 0.2653, weighted_loss: 0.2006, label: 2, bag_size: 817
batch 1400, loss: 0.0622, instance_loss: 0.1505, weighted_loss: 0.0887, label: 2, bag_size: 289
batch 1500, loss: 0.8469, instance_loss: 0.8322, weighted_loss: 0.8425, label: 1, bag_size: 1516
batch 1600, loss: 0.1050, instance_loss: 0.1055, weighted_loss: 0.1051, label: 2, bag_size: 249
batch 1700, loss: 0.1162, instance_loss: 0.1145, weighted_loss: 0.1157, label: 2, bag_size: 1005
batch 1800, loss: 1.2115, instance_loss: 0.5794, weighted_loss: 1.0218, label: 1, bag_size: 298
batch 1900, loss: 1.0894, instance_loss: 0.5737, weighted_loss: 0.9347, label: 2, bag_size: 248
batch 2000, loss: 1.6989, instance_loss: 0.6882, weighted_loss: 1.3957, label: 2, bag_size: 1364
batch 2100, loss: 0.0469, instance_loss: 0.1206, weighted_loss: 0.0690, label: 1, bag_size: 942

Instance Classifier Stats
class 0 clustering acc 0.9841157834101383: correct 68337/69440
class 1 clustering acc 0.37430875576036865: correct 6498/17360

Epoch: 34, train_loss: 0.7643, train_clustering_loss:  0.4268, train_error: 0.3240
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6240409207161125, correct coarse 488/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.07003891050583658, correct coarse 18/257 
Overall Accuracy: 0.6760

Val Set, val_loss: 0.7626, val_error: 0.3295, auc: 0.7857
class 0 clustering acc 0.9805871212121212: correct 8284/8448 
class 1 clustering acc 0.41950757575757575: correct 886/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
Overall Accuracy: 0.6705
Overall F1 Score: 0.3935

Training for coarse level...
batch 100, loss: 0.1855, instance_loss: 0.1952, weighted_loss: 0.1884, label: 2, bag_size: 468
batch 200, loss: 0.3071, instance_loss: 0.2954, weighted_loss: 0.3036, label: 1, bag_size: 974
batch 300, loss: 0.6001, instance_loss: 0.2661, weighted_loss: 0.4999, label: 2, bag_size: 375
batch 400, loss: 0.1100, instance_loss: 0.1375, weighted_loss: 0.1183, label: 1, bag_size: 1466
batch 500, loss: 0.9367, instance_loss: 0.4453, weighted_loss: 0.7893, label: 2, bag_size: 344
batch 600, loss: 1.1307, instance_loss: 0.5777, weighted_loss: 0.9648, label: 2, bag_size: 406
batch 700, loss: 0.0919, instance_loss: 0.1391, weighted_loss: 0.1061, label: 1, bag_size: 633
batch 800, loss: 0.0318, instance_loss: 0.0703, weighted_loss: 0.0433, label: 1, bag_size: 1535
batch 900, loss: 1.1498, instance_loss: 0.5716, weighted_loss: 0.9763, label: 1, bag_size: 592
batch 1000, loss: 0.3183, instance_loss: 0.4403, weighted_loss: 0.3549, label: 1, bag_size: 2154
batch 1100, loss: 0.0268, instance_loss: 0.0965, weighted_loss: 0.0477, label: 1, bag_size: 556
batch 1200, loss: 1.5215, instance_loss: 0.6947, weighted_loss: 1.2734, label: 1, bag_size: 475
batch 1300, loss: 0.7510, instance_loss: 0.4944, weighted_loss: 0.6740, label: 1, bag_size: 398
batch 1400, loss: 0.0673, instance_loss: 0.1265, weighted_loss: 0.0850, label: 1, bag_size: 512
batch 1500, loss: 0.3816, instance_loss: 0.2859, weighted_loss: 0.3529, label: 1, bag_size: 244
batch 1600, loss: 1.6489, instance_loss: 0.6425, weighted_loss: 1.3470, label: 1, bag_size: 305
batch 1700, loss: 1.0737, instance_loss: 0.4825, weighted_loss: 0.8964, label: 2, bag_size: 548
batch 1800, loss: 0.8920, instance_loss: 0.4370, weighted_loss: 0.7555, label: 2, bag_size: 1549
batch 1900, loss: 1.0526, instance_loss: 0.6838, weighted_loss: 0.9420, label: 2, bag_size: 204
batch 2000, loss: 1.8710, instance_loss: 0.9166, weighted_loss: 1.5847, label: 1, bag_size: 542
batch 2100, loss: 0.1456, instance_loss: 0.2910, weighted_loss: 0.1892, label: 1, bag_size: 270

Instance Classifier Stats
class 0 clustering acc 0.9840581797235023: correct 68333/69440
class 1 clustering acc 0.3747695852534562: correct 6506/17360

Epoch: 35, train_loss: 0.7639, train_clustering_loss:  0.4259, train_error: 0.3267
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6214833759590793, correct coarse 486/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.0622568093385214, correct coarse 16/257 
Overall Accuracy: 0.6733

Val Set, val_loss: 0.7610, val_error: 0.3182, auc: 0.7858
class 0 clustering acc 0.98046875: correct 8283/8448 
class 1 clustering acc 0.42140151515151514: correct 890/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.3993

Training for coarse level...
batch 100, loss: 0.3776, instance_loss: 0.3932, weighted_loss: 0.3823, label: 1, bag_size: 440
batch 200, loss: 1.3640, instance_loss: 0.6834, weighted_loss: 1.1598, label: 1, bag_size: 657
batch 300, loss: 0.0853, instance_loss: 0.1398, weighted_loss: 0.1016, label: 2, bag_size: 409
batch 400, loss: 0.1125, instance_loss: 0.1536, weighted_loss: 0.1248, label: 1, bag_size: 334
batch 500, loss: 0.5945, instance_loss: 0.2996, weighted_loss: 0.5060, label: 2, bag_size: 1339
batch 600, loss: 0.6110, instance_loss: 0.3550, weighted_loss: 0.5342, label: 2, bag_size: 216
batch 700, loss: 0.0671, instance_loss: 0.0916, weighted_loss: 0.0745, label: 2, bag_size: 1140
batch 800, loss: 1.7413, instance_loss: 0.7523, weighted_loss: 1.4446, label: 1, bag_size: 655
batch 900, loss: 1.4266, instance_loss: 0.7083, weighted_loss: 1.2111, label: 3, bag_size: 274
batch 1000, loss: 0.0214, instance_loss: 0.0610, weighted_loss: 0.0333, label: 2, bag_size: 223
batch 1100, loss: 0.2110, instance_loss: 0.2296, weighted_loss: 0.2166, label: 2, bag_size: 1547
batch 1200, loss: 1.2186, instance_loss: 0.6517, weighted_loss: 1.0485, label: 1, bag_size: 347
batch 1300, loss: 1.2743, instance_loss: 0.4623, weighted_loss: 1.0307, label: 1, bag_size: 427
batch 1400, loss: 0.0497, instance_loss: 0.1152, weighted_loss: 0.0694, label: 2, bag_size: 762
batch 1500, loss: 0.1962, instance_loss: 0.3287, weighted_loss: 0.2360, label: 1, bag_size: 1573
batch 1600, loss: 0.4049, instance_loss: 0.2825, weighted_loss: 0.3682, label: 2, bag_size: 740
batch 1700, loss: 1.0782, instance_loss: 0.5127, weighted_loss: 0.9085, label: 2, bag_size: 968
batch 1800, loss: 1.6279, instance_loss: 0.7243, weighted_loss: 1.3569, label: 3, bag_size: 716
batch 1900, loss: 0.1507, instance_loss: 0.1660, weighted_loss: 0.1553, label: 2, bag_size: 691
batch 2000, loss: 0.0665, instance_loss: 0.1759, weighted_loss: 0.0993, label: 1, bag_size: 757
batch 2100, loss: 0.1083, instance_loss: 0.1168, weighted_loss: 0.1109, label: 2, bag_size: 328

Instance Classifier Stats
class 0 clustering acc 0.9830789170506913: correct 68265/69440
class 1 clustering acc 0.38122119815668204: correct 6618/17360

Epoch: 36, train_loss: 0.7618, train_clustering_loss:  0.4261, train_error: 0.3258
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6176470588235294, correct coarse 483/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
Overall Accuracy: 0.6742

Val Set, val_loss: 0.7605, val_error: 0.3220, auc: 0.7866
class 0 clustering acc 0.9808238636363636: correct 8286/8448 
class 1 clustering acc 0.41950757575757575: correct 886/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.3980

Training for coarse level...
batch 100, loss: 0.2544, instance_loss: 0.2589, weighted_loss: 0.2557, label: 1, bag_size: 362
batch 200, loss: 1.1223, instance_loss: 0.5651, weighted_loss: 0.9551, label: 2, bag_size: 331
batch 300, loss: 0.4609, instance_loss: 0.2271, weighted_loss: 0.3908, label: 1, bag_size: 1477
batch 400, loss: 0.0983, instance_loss: 0.1288, weighted_loss: 0.1074, label: 1, bag_size: 248
batch 500, loss: 0.1380, instance_loss: 0.1841, weighted_loss: 0.1519, label: 2, bag_size: 225
batch 600, loss: 0.3249, instance_loss: 0.2489, weighted_loss: 0.3021, label: 2, bag_size: 322
batch 700, loss: 0.1274, instance_loss: 0.1611, weighted_loss: 0.1375, label: 1, bag_size: 1075
batch 800, loss: 2.4940, instance_loss: 0.9235, weighted_loss: 2.0228, label: 3, bag_size: 704
batch 900, loss: 3.5899, instance_loss: 0.8860, weighted_loss: 2.7787, label: 0, bag_size: 207
batch 1000, loss: 1.5894, instance_loss: 0.8737, weighted_loss: 1.3747, label: 3, bag_size: 542
batch 1100, loss: 4.2613, instance_loss: 1.1604, weighted_loss: 3.3310, label: 3, bag_size: 378
batch 1200, loss: 0.2214, instance_loss: 0.3526, weighted_loss: 0.2607, label: 1, bag_size: 1313
batch 1300, loss: 0.0934, instance_loss: 0.1335, weighted_loss: 0.1054, label: 1, bag_size: 691
batch 1400, loss: 0.2180, instance_loss: 0.2102, weighted_loss: 0.2156, label: 2, bag_size: 451
batch 1500, loss: 0.1176, instance_loss: 0.1459, weighted_loss: 0.1261, label: 2, bag_size: 574
batch 1600, loss: 0.0818, instance_loss: 0.1092, weighted_loss: 0.0900, label: 1, bag_size: 1110
batch 1700, loss: 0.9704, instance_loss: 0.4775, weighted_loss: 0.8225, label: 2, bag_size: 427
batch 1800, loss: 0.0298, instance_loss: 0.0900, weighted_loss: 0.0479, label: 2, bag_size: 381
batch 1900, loss: 0.5493, instance_loss: 0.2918, weighted_loss: 0.4720, label: 2, bag_size: 565
batch 2000, loss: 1.0647, instance_loss: 0.5315, weighted_loss: 0.9047, label: 2, bag_size: 305
batch 2100, loss: 0.5382, instance_loss: 0.4489, weighted_loss: 0.5114, label: 2, bag_size: 333

Instance Classifier Stats
class 0 clustering acc 0.9838133640552995: correct 68316/69440
class 1 clustering acc 0.3775921658986175: correct 6555/17360

Epoch: 37, train_loss: 0.7612, train_clustering_loss:  0.4242, train_error: 0.3249
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6278772378516624, correct coarse 491/782 
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087 
coarse class 3: coarse acc 0.07003891050583658, correct coarse 18/257 
Overall Accuracy: 0.6751

Val Set, val_loss: 0.7596, val_error: 0.3220, auc: 0.7871
class 0 clustering acc 0.9808238636363636: correct 8286/8448 
class 1 clustering acc 0.4199810606060606: correct 887/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.1, correct coarse 3/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.3980

Training for coarse level...
batch 100, loss: 0.9226, instance_loss: 0.6027, weighted_loss: 0.8266, label: 3, bag_size: 472
batch 200, loss: 0.0430, instance_loss: 0.1273, weighted_loss: 0.0683, label: 2, bag_size: 368
batch 300, loss: 0.0734, instance_loss: 0.1427, weighted_loss: 0.0942, label: 2, bag_size: 540
batch 400, loss: 1.3399, instance_loss: 0.6735, weighted_loss: 1.1400, label: 1, bag_size: 264
batch 500, loss: 1.3674, instance_loss: 0.6699, weighted_loss: 1.1581, label: 2, bag_size: 405
batch 600, loss: 0.0177, instance_loss: 0.0854, weighted_loss: 0.0380, label: 1, bag_size: 484
batch 700, loss: 0.0542, instance_loss: 0.1151, weighted_loss: 0.0724, label: 2, bag_size: 439
batch 800, loss: 0.0632, instance_loss: 0.0960, weighted_loss: 0.0731, label: 1, bag_size: 192
batch 900, loss: 2.3559, instance_loss: 0.9339, weighted_loss: 1.9293, label: 3, bag_size: 512
batch 1000, loss: 0.7395, instance_loss: 0.3477, weighted_loss: 0.6220, label: 2, bag_size: 290
batch 1100, loss: 1.4187, instance_loss: 0.7302, weighted_loss: 1.2122, label: 2, bag_size: 182
batch 1200, loss: 1.0834, instance_loss: 0.6566, weighted_loss: 0.9553, label: 1, bag_size: 341
batch 1300, loss: 0.9467, instance_loss: 0.6667, weighted_loss: 0.8627, label: 1, bag_size: 565
batch 1400, loss: 0.0317, instance_loss: 0.0793, weighted_loss: 0.0460, label: 2, bag_size: 634
batch 1500, loss: 0.0311, instance_loss: 0.0910, weighted_loss: 0.0491, label: 2, bag_size: 329
batch 1600, loss: 0.8564, instance_loss: 0.4267, weighted_loss: 0.7275, label: 2, bag_size: 464
batch 1700, loss: 0.9185, instance_loss: 0.6237, weighted_loss: 0.8300, label: 3, bag_size: 172
batch 1800, loss: 1.3768, instance_loss: 0.6912, weighted_loss: 1.1711, label: 1, bag_size: 618
batch 1900, loss: 0.7396, instance_loss: 0.5060, weighted_loss: 0.6695, label: 2, bag_size: 338
batch 2000, loss: 2.7737, instance_loss: 1.2903, weighted_loss: 2.3287, label: 3, bag_size: 568
batch 2100, loss: 0.8617, instance_loss: 0.3259, weighted_loss: 0.7009, label: 2, bag_size: 316

Instance Classifier Stats
class 0 clustering acc 0.9834245391705069: correct 68289/69440
class 1 clustering acc 0.3783410138248848: correct 6568/17360

Epoch: 38, train_loss: 0.7595, train_clustering_loss:  0.4238, train_error: 0.3240
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6278772378516624, correct coarse 491/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
Overall Accuracy: 0.6760

Val Set, val_loss: 0.7591, val_error: 0.3182, auc: 0.7873
class 0 clustering acc 0.9809422348484849: correct 8287/8448 
class 1 clustering acc 0.421875: correct 891/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4117

Training for coarse level...
batch 100, loss: 0.9950, instance_loss: 0.4654, weighted_loss: 0.8361, label: 1, bag_size: 106
batch 200, loss: 0.5153, instance_loss: 0.4059, weighted_loss: 0.4825, label: 2, bag_size: 214
batch 300, loss: 0.0280, instance_loss: 0.0946, weighted_loss: 0.0480, label: 1, bag_size: 556
batch 400, loss: 0.7427, instance_loss: 0.5119, weighted_loss: 0.6735, label: 2, bag_size: 298
batch 500, loss: 0.1952, instance_loss: 0.1678, weighted_loss: 0.1870, label: 2, bag_size: 1816
batch 600, loss: 0.7234, instance_loss: 0.5231, weighted_loss: 0.6633, label: 2, bag_size: 338
batch 700, loss: 1.4861, instance_loss: 0.6303, weighted_loss: 1.2294, label: 3, bag_size: 313
batch 800, loss: 1.0316, instance_loss: 0.4114, weighted_loss: 0.8455, label: 2, bag_size: 362
batch 900, loss: 0.9501, instance_loss: 0.5173, weighted_loss: 0.8203, label: 1, bag_size: 459
batch 1000, loss: 0.8518, instance_loss: 0.4061, weighted_loss: 0.7181, label: 2, bag_size: 291
batch 1100, loss: 4.0439, instance_loss: 1.1750, weighted_loss: 3.1832, label: 0, bag_size: 505
batch 1200, loss: 0.1013, instance_loss: 0.1067, weighted_loss: 0.1029, label: 1, bag_size: 2535
batch 1300, loss: 0.8303, instance_loss: 0.4164, weighted_loss: 0.7062, label: 2, bag_size: 513
batch 1400, loss: 0.0656, instance_loss: 0.1077, weighted_loss: 0.0783, label: 2, bag_size: 1137
batch 1500, loss: 0.0961, instance_loss: 0.1591, weighted_loss: 0.1150, label: 2, bag_size: 360
batch 1600, loss: 1.0287, instance_loss: 0.5206, weighted_loss: 0.8763, label: 2, bag_size: 72
batch 1700, loss: 0.1090, instance_loss: 0.1217, weighted_loss: 0.1128, label: 2, bag_size: 1014
batch 1800, loss: 0.1009, instance_loss: 0.1168, weighted_loss: 0.1057, label: 1, bag_size: 2879
batch 1900, loss: 0.3164, instance_loss: 0.2230, weighted_loss: 0.2884, label: 2, bag_size: 1062
batch 2000, loss: 0.4094, instance_loss: 0.2719, weighted_loss: 0.3682, label: 1, bag_size: 602
batch 2100, loss: 0.9166, instance_loss: 0.6108, weighted_loss: 0.8248, label: 2, bag_size: 276

Instance Classifier Stats
class 0 clustering acc 0.9841877880184332: correct 68342/69440
class 1 clustering acc 0.38179723502304147: correct 6628/17360

Epoch: 39, train_loss: 0.7583, train_clustering_loss:  0.4218, train_error: 0.3244
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.0933852140077821, correct coarse 24/257 
Overall Accuracy: 0.6756

Val Set, val_loss: 0.7581, val_error: 0.3144, auc: 0.7880
class 0 clustering acc 0.9808238636363636: correct 8286/8448 
class 1 clustering acc 0.42329545454545453: correct 894/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4136

Training for coarse level...
batch 100, loss: 0.5459, instance_loss: 0.3172, weighted_loss: 0.4773, label: 2, bag_size: 621
batch 200, loss: 1.2127, instance_loss: 0.6120, weighted_loss: 1.0325, label: 2, bag_size: 228
batch 300, loss: 0.0390, instance_loss: 0.0657, weighted_loss: 0.0470, label: 1, bag_size: 620
batch 400, loss: 0.3647, instance_loss: 0.2938, weighted_loss: 0.3435, label: 1, bag_size: 2830
batch 500, loss: 3.2887, instance_loss: 1.0062, weighted_loss: 2.6040, label: 0, bag_size: 313
batch 600, loss: 0.3715, instance_loss: 0.2256, weighted_loss: 0.3277, label: 2, bag_size: 653
batch 700, loss: 1.3367, instance_loss: 0.6731, weighted_loss: 1.1376, label: 1, bag_size: 544
batch 800, loss: 0.0489, instance_loss: 0.1514, weighted_loss: 0.0796, label: 1, bag_size: 1279
batch 900, loss: 0.5236, instance_loss: 0.3792, weighted_loss: 0.4803, label: 2, bag_size: 392
batch 1000, loss: 0.0601, instance_loss: 0.1013, weighted_loss: 0.0725, label: 1, bag_size: 1827
batch 1100, loss: 1.4135, instance_loss: 0.7132, weighted_loss: 1.2034, label: 3, bag_size: 862
batch 1200, loss: 0.0607, instance_loss: 0.0986, weighted_loss: 0.0721, label: 2, bag_size: 764
batch 1300, loss: 0.3776, instance_loss: 0.2738, weighted_loss: 0.3465, label: 1, bag_size: 1727
batch 1400, loss: 1.1896, instance_loss: 0.6530, weighted_loss: 1.0286, label: 1, bag_size: 399
batch 1500, loss: 0.0915, instance_loss: 0.1186, weighted_loss: 0.0996, label: 2, bag_size: 755
batch 1600, loss: 1.0266, instance_loss: 0.6765, weighted_loss: 0.9216, label: 2, bag_size: 311
batch 1700, loss: 0.3229, instance_loss: 0.4535, weighted_loss: 0.3621, label: 2, bag_size: 12
batch 1800, loss: 0.7094, instance_loss: 0.3664, weighted_loss: 0.6065, label: 2, bag_size: 462
batch 1900, loss: 0.1031, instance_loss: 0.1063, weighted_loss: 0.1041, label: 2, bag_size: 1014
batch 2000, loss: 1.0977, instance_loss: 0.8372, weighted_loss: 1.0195, label: 1, bag_size: 901
batch 2100, loss: 0.6070, instance_loss: 0.5073, weighted_loss: 0.5771, label: 2, bag_size: 116

Instance Classifier Stats
class 0 clustering acc 0.9833237327188941: correct 68282/69440
class 1 clustering acc 0.3845046082949309: correct 6675/17360

Epoch: 40, train_loss: 0.7572, train_clustering_loss:  0.4223, train_error: 0.3221
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6253196930946292, correct coarse 489/782 
coarse class 2: coarse acc 0.8785648574057038, correct coarse 955/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
Overall Accuracy: 0.6779

Val Set, val_loss: 0.7569, val_error: 0.3144, auc: 0.7886
class 0 clustering acc 0.9808238636363636: correct 8286/8448 
class 1 clustering acc 0.42329545454545453: correct 894/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4126

Training for coarse level...
batch 100, loss: 0.1383, instance_loss: 0.1664, weighted_loss: 0.1467, label: 1, bag_size: 334
batch 200, loss: 0.0224, instance_loss: 0.1251, weighted_loss: 0.0532, label: 1, bag_size: 1204
batch 300, loss: 0.2873, instance_loss: 0.2384, weighted_loss: 0.2726, label: 2, bag_size: 511
batch 400, loss: 0.0310, instance_loss: 0.0910, weighted_loss: 0.0490, label: 2, bag_size: 756
batch 500, loss: 0.2630, instance_loss: 0.2546, weighted_loss: 0.2605, label: 1, bag_size: 780
batch 600, loss: 0.0261, instance_loss: 0.0814, weighted_loss: 0.0427, label: 2, bag_size: 455
batch 700, loss: 1.0211, instance_loss: 0.6362, weighted_loss: 0.9056, label: 2, bag_size: 220
batch 800, loss: 0.0879, instance_loss: 0.1248, weighted_loss: 0.0989, label: 2, bag_size: 396
batch 900, loss: 0.0445, instance_loss: 0.0622, weighted_loss: 0.0498, label: 1, bag_size: 1632
batch 1000, loss: 0.0606, instance_loss: 0.1415, weighted_loss: 0.0849, label: 2, bag_size: 289
batch 1100, loss: 0.4636, instance_loss: 0.3238, weighted_loss: 0.4217, label: 2, bag_size: 363
batch 1200, loss: 2.1147, instance_loss: 1.0684, weighted_loss: 1.8008, label: 3, bag_size: 1800
batch 1300, loss: 0.4062, instance_loss: 0.2183, weighted_loss: 0.3498, label: 2, bag_size: 604
batch 1400, loss: 1.5782, instance_loss: 0.7657, weighted_loss: 1.3344, label: 1, bag_size: 533
batch 1500, loss: 0.6973, instance_loss: 0.4673, weighted_loss: 0.6283, label: 1, bag_size: 1205
batch 1600, loss: 0.8510, instance_loss: 0.3644, weighted_loss: 0.7050, label: 2, bag_size: 316
batch 1700, loss: 1.0989, instance_loss: 0.5210, weighted_loss: 0.9255, label: 2, bag_size: 406
batch 1800, loss: 0.0335, instance_loss: 0.0836, weighted_loss: 0.0485, label: 2, bag_size: 371
batch 1900, loss: 2.9232, instance_loss: 0.9518, weighted_loss: 2.3318, label: 0, bag_size: 352
batch 2000, loss: 1.6351, instance_loss: 0.7196, weighted_loss: 1.3604, label: 3, bag_size: 571
batch 2100, loss: 0.0903, instance_loss: 0.1156, weighted_loss: 0.0979, label: 1, bag_size: 941

Instance Classifier Stats
class 0 clustering acc 0.9836261520737327: correct 68303/69440
class 1 clustering acc 0.3832373271889401: correct 6653/17360

Epoch: 41, train_loss: 0.7559, train_clustering_loss:  0.4218, train_error: 0.3226
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6253196930946292, correct coarse 489/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
Overall Accuracy: 0.6774

Val Set, val_loss: 0.7559, val_error: 0.3182, auc: 0.7888
class 0 clustering acc 0.9810606060606061: correct 8288/8448 
class 1 clustering acc 0.42234848484848486: correct 892/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4101

Training for coarse level...
batch 100, loss: 0.2254, instance_loss: 0.3437, weighted_loss: 0.2609, label: 1, bag_size: 1101
batch 200, loss: 3.6098, instance_loss: 0.9695, weighted_loss: 2.8177, label: 0, bag_size: 439
batch 300, loss: 0.0957, instance_loss: 0.1507, weighted_loss: 0.1122, label: 2, bag_size: 396
batch 400, loss: 0.1193, instance_loss: 0.2010, weighted_loss: 0.1438, label: 2, bag_size: 433
batch 500, loss: 0.2605, instance_loss: 0.4301, weighted_loss: 0.3114, label: 1, bag_size: 1323
batch 600, loss: 0.3066, instance_loss: 0.1951, weighted_loss: 0.2731, label: 1, bag_size: 2601
batch 700, loss: 0.7521, instance_loss: 0.5870, weighted_loss: 0.7025, label: 1, bag_size: 1691
batch 800, loss: 1.0791, instance_loss: 0.5458, weighted_loss: 0.9191, label: 1, bag_size: 226
batch 900, loss: 1.5472, instance_loss: 0.8735, weighted_loss: 1.3451, label: 1, bag_size: 315
batch 1000, loss: 1.1702, instance_loss: 0.6016, weighted_loss: 0.9996, label: 3, bag_size: 327
batch 1100, loss: 1.1513, instance_loss: 0.4779, weighted_loss: 0.9493, label: 2, bag_size: 359
batch 1200, loss: 0.5733, instance_loss: 0.2977, weighted_loss: 0.4906, label: 2, bag_size: 377
batch 1300, loss: 0.8120, instance_loss: 0.5893, weighted_loss: 0.7452, label: 2, bag_size: 125
batch 1400, loss: 0.7037, instance_loss: 0.5023, weighted_loss: 0.6433, label: 2, bag_size: 222
batch 1500, loss: 0.2601, instance_loss: 0.1955, weighted_loss: 0.2407, label: 2, bag_size: 620
batch 1600, loss: 0.7549, instance_loss: 0.4529, weighted_loss: 0.6643, label: 2, bag_size: 576
batch 1700, loss: 0.0332, instance_loss: 0.0869, weighted_loss: 0.0493, label: 2, bag_size: 371
batch 1800, loss: 0.3681, instance_loss: 0.3590, weighted_loss: 0.3654, label: 1, bag_size: 189
batch 1900, loss: 0.0849, instance_loss: 0.1975, weighted_loss: 0.1187, label: 1, bag_size: 304
batch 2000, loss: 4.3876, instance_loss: 1.1930, weighted_loss: 3.4292, label: 3, bag_size: 378
batch 2100, loss: 0.0258, instance_loss: 0.0987, weighted_loss: 0.0477, label: 1, bag_size: 1534

Instance Classifier Stats
class 0 clustering acc 0.9838997695852535: correct 68322/69440
class 1 clustering acc 0.3821428571428571: correct 6634/17360

Epoch: 42, train_loss: 0.7544, train_clustering_loss:  0.4204, train_error: 0.3184
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
Overall Accuracy: 0.6816

Val Set, val_loss: 0.7558, val_error: 0.3144, auc: 0.7896
class 0 clustering acc 0.9810606060606061: correct 8288/8448 
class 1 clustering acc 0.4247159090909091: correct 897/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4126

Training for coarse level...
batch 100, loss: 0.0872, instance_loss: 0.0960, weighted_loss: 0.0898, label: 1, bag_size: 748
batch 200, loss: 0.0488, instance_loss: 0.1385, weighted_loss: 0.0757, label: 2, bag_size: 296
batch 300, loss: 0.5806, instance_loss: 0.3835, weighted_loss: 0.5215, label: 2, bag_size: 245
batch 400, loss: 0.0605, instance_loss: 0.0932, weighted_loss: 0.0703, label: 2, bag_size: 846
batch 500, loss: 0.3248, instance_loss: 0.3301, weighted_loss: 0.3264, label: 1, bag_size: 1628
batch 600, loss: 1.6847, instance_loss: 0.7472, weighted_loss: 1.4034, label: 1, bag_size: 533
batch 700, loss: 1.6827, instance_loss: 0.5931, weighted_loss: 1.3558, label: 1, bag_size: 254
batch 800, loss: 0.8760, instance_loss: 0.4640, weighted_loss: 0.7524, label: 2, bag_size: 316
batch 900, loss: 1.3677, instance_loss: 0.7004, weighted_loss: 1.1675, label: 3, bag_size: 274
batch 1000, loss: 0.9319, instance_loss: 0.5788, weighted_loss: 0.8259, label: 1, bag_size: 898
batch 1100, loss: 0.2064, instance_loss: 0.2744, weighted_loss: 0.2268, label: 1, bag_size: 506
batch 1200, loss: 0.1460, instance_loss: 0.2183, weighted_loss: 0.1677, label: 2, bag_size: 841
batch 1300, loss: 0.4198, instance_loss: 0.3040, weighted_loss: 0.3851, label: 2, bag_size: 523
batch 1400, loss: 0.8567, instance_loss: 0.4542, weighted_loss: 0.7359, label: 2, bag_size: 429
batch 1500, loss: 1.4229, instance_loss: 0.7644, weighted_loss: 1.2254, label: 1, bag_size: 821
batch 1600, loss: 0.5155, instance_loss: 0.4340, weighted_loss: 0.4911, label: 1, bag_size: 692
batch 1700, loss: 0.2313, instance_loss: 0.2053, weighted_loss: 0.2235, label: 2, bag_size: 482
batch 1800, loss: 0.6449, instance_loss: 0.3138, weighted_loss: 0.5456, label: 2, bag_size: 847
batch 1900, loss: 0.8423, instance_loss: 0.4487, weighted_loss: 0.7242, label: 2, bag_size: 397
batch 2000, loss: 0.5390, instance_loss: 0.4017, weighted_loss: 0.4978, label: 1, bag_size: 483
batch 2100, loss: 0.0271, instance_loss: 0.0704, weighted_loss: 0.0401, label: 2, bag_size: 359

Instance Classifier Stats
class 0 clustering acc 0.9839141705069124: correct 68323/69440
class 1 clustering acc 0.38410138248847925: correct 6668/17360

Epoch: 43, train_loss: 0.7531, train_clustering_loss:  0.4201, train_error: 0.3189
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6138107416879796, correct coarse 480/782 
coarse class 2: coarse acc 0.891444342226311, correct coarse 969/1087 
coarse class 3: coarse acc 0.11284046692607004, correct coarse 29/257 
Overall Accuracy: 0.6811

Val Set, val_loss: 0.7574, val_error: 0.3220, auc: 0.7887
class 0 clustering acc 0.9817708333333334: correct 8294/8448 
class 1 clustering acc 0.4256628787878788: correct 899/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.4084

Training for coarse level...
batch 100, loss: 4.0328, instance_loss: 1.2699, weighted_loss: 3.2039, label: 0, bag_size: 440
batch 200, loss: 0.8305, instance_loss: 0.5324, weighted_loss: 0.7410, label: 2, bag_size: 338
batch 300, loss: 0.8542, instance_loss: 0.4572, weighted_loss: 0.7351, label: 2, bag_size: 979
batch 400, loss: 0.2188, instance_loss: 0.1856, weighted_loss: 0.2088, label: 2, bag_size: 310
batch 500, loss: 1.2900, instance_loss: 0.7719, weighted_loss: 1.1346, label: 1, bag_size: 775
batch 600, loss: 0.1349, instance_loss: 0.1882, weighted_loss: 0.1509, label: 2, bag_size: 234
batch 700, loss: 0.0195, instance_loss: 0.0585, weighted_loss: 0.0312, label: 1, bag_size: 542
batch 800, loss: 0.0297, instance_loss: 0.0790, weighted_loss: 0.0445, label: 2, bag_size: 104
batch 900, loss: 0.9651, instance_loss: 0.5273, weighted_loss: 0.8337, label: 1, bag_size: 435
batch 1000, loss: 0.9695, instance_loss: 0.4807, weighted_loss: 0.8229, label: 2, bag_size: 466
batch 1100, loss: 0.0409, instance_loss: 0.0438, weighted_loss: 0.0418, label: 1, bag_size: 206
batch 1200, loss: 0.1892, instance_loss: 0.2791, weighted_loss: 0.2162, label: 1, bag_size: 567
batch 1300, loss: 1.0287, instance_loss: 0.6362, weighted_loss: 0.9110, label: 3, bag_size: 590
batch 1400, loss: 0.6006, instance_loss: 0.3349, weighted_loss: 0.5209, label: 2, bag_size: 370
batch 1500, loss: 0.3792, instance_loss: 0.4567, weighted_loss: 0.4024, label: 1, bag_size: 806
batch 1600, loss: 1.3617, instance_loss: 0.5949, weighted_loss: 1.1317, label: 2, bag_size: 304
batch 1700, loss: 0.3618, instance_loss: 0.2603, weighted_loss: 0.3314, label: 2, bag_size: 375
batch 1800, loss: 0.1107, instance_loss: 0.1136, weighted_loss: 0.1116, label: 2, bag_size: 1005
batch 1900, loss: 0.8077, instance_loss: 0.4875, weighted_loss: 0.7116, label: 2, bag_size: 243
batch 2000, loss: 0.0450, instance_loss: 0.1219, weighted_loss: 0.0681, label: 1, bag_size: 926
batch 2100, loss: 0.1426, instance_loss: 0.1980, weighted_loss: 0.1592, label: 1, bag_size: 1781

Instance Classifier Stats
class 0 clustering acc 0.9838277649769586: correct 68317/69440
class 1 clustering acc 0.38421658986175117: correct 6670/17360

Epoch: 44, train_loss: 0.7529, train_clustering_loss:  0.4192, train_error: 0.3244
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8712051517939282, correct coarse 947/1087 
coarse class 3: coarse acc 0.08949416342412451, correct coarse 23/257 
Overall Accuracy: 0.6756

Val Set, val_loss: 0.7546, val_error: 0.3144, auc: 0.7897
class 0 clustering acc 0.9815340909090909: correct 8292/8448 
class 1 clustering acc 0.42613636363636365: correct 900/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4126

Training for coarse level...
batch 100, loss: 0.1190, instance_loss: 0.1596, weighted_loss: 0.1311, label: 2, bag_size: 330
batch 200, loss: 0.1412, instance_loss: 0.2079, weighted_loss: 0.1612, label: 1, bag_size: 1781
batch 300, loss: 0.4541, instance_loss: 0.4154, weighted_loss: 0.4425, label: 2, bag_size: 346
batch 400, loss: 0.8116, instance_loss: 0.5307, weighted_loss: 0.7273, label: 1, bag_size: 1124
batch 500, loss: 0.9090, instance_loss: 0.5497, weighted_loss: 0.8012, label: 1, bag_size: 862
batch 600, loss: 0.0410, instance_loss: 0.0717, weighted_loss: 0.0502, label: 1, bag_size: 1353
batch 700, loss: 1.0863, instance_loss: 0.4198, weighted_loss: 0.8863, label: 1, bag_size: 779
batch 800, loss: 0.9139, instance_loss: 0.5542, weighted_loss: 0.8060, label: 3, bag_size: 228
batch 900, loss: 0.0819, instance_loss: 0.1152, weighted_loss: 0.0919, label: 2, bag_size: 396
batch 1000, loss: 1.0306, instance_loss: 0.7143, weighted_loss: 0.9357, label: 3, bag_size: 568
batch 1100, loss: 0.9462, instance_loss: 0.7050, weighted_loss: 0.8738, label: 1, bag_size: 565
batch 1200, loss: 0.1024, instance_loss: 0.1676, weighted_loss: 0.1219, label: 2, bag_size: 517
batch 1300, loss: 0.0283, instance_loss: 0.0920, weighted_loss: 0.0474, label: 2, bag_size: 361
batch 1400, loss: 0.7998, instance_loss: 0.3944, weighted_loss: 0.6782, label: 2, bag_size: 397
batch 1500, loss: 0.0381, instance_loss: 0.0720, weighted_loss: 0.0483, label: 1, bag_size: 1189
batch 1600, loss: 0.2570, instance_loss: 0.3925, weighted_loss: 0.2976, label: 1, bag_size: 292
batch 1700, loss: 1.7951, instance_loss: 0.8305, weighted_loss: 1.5058, label: 1, bag_size: 115
batch 1800, loss: 1.1679, instance_loss: 0.5375, weighted_loss: 0.9788, label: 2, bag_size: 359
batch 1900, loss: 0.0816, instance_loss: 0.1120, weighted_loss: 0.0907, label: 2, bag_size: 435
batch 2000, loss: 1.4362, instance_loss: 0.7746, weighted_loss: 1.2377, label: 3, bag_size: 253
batch 2100, loss: 1.9498, instance_loss: 0.8855, weighted_loss: 1.6305, label: 3, bag_size: 235

Instance Classifier Stats
class 0 clustering acc 0.9837989631336406: correct 68315/69440
class 1 clustering acc 0.3869239631336406: correct 6717/17360

Epoch: 45, train_loss: 0.7513, train_clustering_loss:  0.4188, train_error: 0.3175
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.618925831202046, correct coarse 484/782 
coarse class 2: coarse acc 0.8923643054277829, correct coarse 970/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
Overall Accuracy: 0.6825

Val Set, val_loss: 0.7561, val_error: 0.3220, auc: 0.7885
class 0 clustering acc 0.9823626893939394: correct 8299/8448 
class 1 clustering acc 0.42329545454545453: correct 894/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.4084

Training for coarse level...
batch 100, loss: 0.4321, instance_loss: 0.3626, weighted_loss: 0.4112, label: 2, bag_size: 740
batch 200, loss: 1.1221, instance_loss: 0.6638, weighted_loss: 0.9846, label: 2, bag_size: 1863
batch 300, loss: 0.4816, instance_loss: 0.2261, weighted_loss: 0.4050, label: 2, bag_size: 1020
batch 400, loss: 0.0295, instance_loss: 0.0753, weighted_loss: 0.0433, label: 2, bag_size: 686
batch 500, loss: 1.8359, instance_loss: 0.7628, weighted_loss: 1.5140, label: 1, bag_size: 57
batch 600, loss: 0.0223, instance_loss: 0.0831, weighted_loss: 0.0406, label: 1, bag_size: 1181
batch 700, loss: 1.8072, instance_loss: 0.8445, weighted_loss: 1.5184, label: 2, bag_size: 2193
batch 800, loss: 0.0668, instance_loss: 0.1096, weighted_loss: 0.0796, label: 2, bag_size: 330
batch 900, loss: 0.6289, instance_loss: 0.3480, weighted_loss: 0.5447, label: 2, bag_size: 756
batch 1000, loss: 0.2042, instance_loss: 0.2928, weighted_loss: 0.2308, label: 2, bag_size: 138
batch 1100, loss: 0.1075, instance_loss: 0.1595, weighted_loss: 0.1231, label: 1, bag_size: 2879
batch 1200, loss: 1.1016, instance_loss: 0.6026, weighted_loss: 0.9519, label: 3, bag_size: 179
batch 1300, loss: 0.0670, instance_loss: 0.1020, weighted_loss: 0.0775, label: 2, bag_size: 707
batch 1400, loss: 0.1082, instance_loss: 0.1572, weighted_loss: 0.1229, label: 1, bag_size: 1447
batch 1500, loss: 0.0240, instance_loss: 0.0793, weighted_loss: 0.0406, label: 2, bag_size: 304
batch 1600, loss: 0.0521, instance_loss: 0.1076, weighted_loss: 0.0687, label: 2, bag_size: 668
batch 1700, loss: 0.5221, instance_loss: 0.3393, weighted_loss: 0.4672, label: 2, bag_size: 1145
batch 1800, loss: 0.0264, instance_loss: 0.0656, weighted_loss: 0.0382, label: 2, bag_size: 537
batch 1900, loss: 0.1319, instance_loss: 0.1248, weighted_loss: 0.1297, label: 2, bag_size: 788
batch 2000, loss: 1.0365, instance_loss: 0.7413, weighted_loss: 0.9479, label: 3, bag_size: 1274
batch 2100, loss: 2.6036, instance_loss: 0.9643, weighted_loss: 2.1118, label: 1, bag_size: 633

Instance Classifier Stats
class 0 clustering acc 0.9837701612903226: correct 68313/69440
class 1 clustering acc 0.38940092165898615: correct 6760/17360

Epoch: 46, train_loss: 0.7495, train_clustering_loss:  0.4186, train_error: 0.3180
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.10505836575875487, correct coarse 27/257 
Overall Accuracy: 0.6820

Val Set, val_loss: 0.7546, val_error: 0.3220, auc: 0.7896
class 0 clustering acc 0.982125946969697: correct 8297/8448 
class 1 clustering acc 0.42234848484848486: correct 892/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6780
Overall F1 Score: 0.4084

Training for coarse level...
batch 100, loss: 0.6029, instance_loss: 0.4137, weighted_loss: 0.5461, label: 2, bag_size: 1347
batch 200, loss: 0.9911, instance_loss: 0.6223, weighted_loss: 0.8804, label: 2, bag_size: 396
batch 300, loss: 1.0133, instance_loss: 0.5283, weighted_loss: 0.8678, label: 2, bag_size: 406
batch 400, loss: 1.6438, instance_loss: 0.6325, weighted_loss: 1.3404, label: 1, bag_size: 1134
batch 500, loss: 0.0780, instance_loss: 0.1176, weighted_loss: 0.0898, label: 2, bag_size: 162
batch 600, loss: 1.0502, instance_loss: 0.5485, weighted_loss: 0.8997, label: 1, bag_size: 405
batch 700, loss: 1.5255, instance_loss: 0.7316, weighted_loss: 1.2874, label: 3, bag_size: 416
batch 800, loss: 3.2532, instance_loss: 1.3557, weighted_loss: 2.6840, label: 2, bag_size: 2344
batch 900, loss: 0.0663, instance_loss: 0.0661, weighted_loss: 0.0662, label: 1, bag_size: 392
batch 1000, loss: 0.4777, instance_loss: 0.3406, weighted_loss: 0.4366, label: 2, bag_size: 509
batch 1100, loss: 1.9961, instance_loss: 0.8549, weighted_loss: 1.6537, label: 1, bag_size: 302
batch 1200, loss: 1.7968, instance_loss: 0.8133, weighted_loss: 1.5018, label: 1, bag_size: 361
batch 1300, loss: 0.0783, instance_loss: 0.0867, weighted_loss: 0.0808, label: 2, bag_size: 537
batch 1400, loss: 0.3036, instance_loss: 0.1894, weighted_loss: 0.2694, label: 2, bag_size: 600
batch 1500, loss: 1.7336, instance_loss: 0.7954, weighted_loss: 1.4522, label: 1, bag_size: 541
batch 1600, loss: 1.7043, instance_loss: 0.6744, weighted_loss: 1.3954, label: 3, bag_size: 383
batch 1700, loss: 1.0925, instance_loss: 0.8475, weighted_loss: 1.0190, label: 1, bag_size: 1168
batch 1800, loss: 0.0282, instance_loss: 0.0552, weighted_loss: 0.0363, label: 1, bag_size: 1535
batch 1900, loss: 0.0441, instance_loss: 0.2668, weighted_loss: 0.1109, label: 1, bag_size: 488
batch 2000, loss: 0.1697, instance_loss: 0.1399, weighted_loss: 0.1607, label: 2, bag_size: 1081
batch 2100, loss: 0.8552, instance_loss: 0.5303, weighted_loss: 0.7578, label: 2, bag_size: 519

Instance Classifier Stats
class 0 clustering acc 0.9838565668202764: correct 68319/69440
class 1 clustering acc 0.3874423963133641: correct 6726/17360

Epoch: 47, train_loss: 0.7492, train_clustering_loss:  0.4183, train_error: 0.3207
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6304347826086957, correct coarse 493/782 
coarse class 2: coarse acc 0.8767249310027599, correct coarse 953/1087 
coarse class 3: coarse acc 0.10894941634241245, correct coarse 28/257 
Overall Accuracy: 0.6793

Val Set, val_loss: 0.7531, val_error: 0.3182, auc: 0.7904
class 0 clustering acc 0.9820075757575758: correct 8296/8448 
class 1 clustering acc 0.4237689393939394: correct 895/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4107

Training for coarse level...
batch 100, loss: 0.2652, instance_loss: 0.2152, weighted_loss: 0.2502, label: 1, bag_size: 755
batch 200, loss: 0.9831, instance_loss: 0.6365, weighted_loss: 0.8791, label: 3, bag_size: 120
batch 300, loss: 0.6250, instance_loss: 0.3979, weighted_loss: 0.5568, label: 2, bag_size: 115
batch 400, loss: 0.1623, instance_loss: 0.2298, weighted_loss: 0.1826, label: 2, bag_size: 240
batch 500, loss: 0.5982, instance_loss: 0.4170, weighted_loss: 0.5438, label: 2, bag_size: 463
batch 600, loss: 1.6691, instance_loss: 0.7554, weighted_loss: 1.3950, label: 3, bag_size: 276
batch 700, loss: 0.8794, instance_loss: 0.4750, weighted_loss: 0.7581, label: 2, bag_size: 644
batch 800, loss: 0.0479, instance_loss: 0.0892, weighted_loss: 0.0603, label: 2, bag_size: 400
batch 900, loss: 0.1132, instance_loss: 0.2292, weighted_loss: 0.1480, label: 1, bag_size: 2080
batch 1000, loss: 0.0098, instance_loss: 0.0591, weighted_loss: 0.0246, label: 2, bag_size: 421
batch 1100, loss: 0.0247, instance_loss: 0.0921, weighted_loss: 0.0450, label: 2, bag_size: 554
batch 1200, loss: 0.0871, instance_loss: 0.1195, weighted_loss: 0.0968, label: 2, bag_size: 544
batch 1300, loss: 0.6180, instance_loss: 0.2847, weighted_loss: 0.5180, label: 2, bag_size: 466
batch 1400, loss: 0.3723, instance_loss: 0.2674, weighted_loss: 0.3408, label: 2, bag_size: 577
batch 1500, loss: 0.0224, instance_loss: 0.1576, weighted_loss: 0.0629, label: 2, bag_size: 337
batch 1600, loss: 0.2186, instance_loss: 0.3357, weighted_loss: 0.2537, label: 1, bag_size: 292
batch 1700, loss: 1.2215, instance_loss: 0.5079, weighted_loss: 1.0074, label: 2, bag_size: 464
batch 1800, loss: 0.1910, instance_loss: 0.2322, weighted_loss: 0.2034, label: 1, bag_size: 235
batch 1900, loss: 0.7664, instance_loss: 0.4081, weighted_loss: 0.6589, label: 2, bag_size: 729
batch 2000, loss: 0.8496, instance_loss: 0.4172, weighted_loss: 0.7199, label: 1, bag_size: 986
batch 2100, loss: 0.0650, instance_loss: 0.0974, weighted_loss: 0.0747, label: 1, bag_size: 263

Instance Classifier Stats
class 0 clustering acc 0.9835973502304147: correct 68301/69440
class 1 clustering acc 0.3893433179723502: correct 6759/17360

Epoch: 48, train_loss: 0.7483, train_clustering_loss:  0.4173, train_error: 0.3161
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6227621483375959, correct coarse 487/782 
coarse class 2: coarse acc 0.8886844526218951, correct coarse 966/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
Overall Accuracy: 0.6839

Val Set, val_loss: 0.7538, val_error: 0.3258, auc: 0.7898
class 0 clustering acc 0.9822443181818182: correct 8298/8448 
class 1 clustering acc 0.42140151515151514: correct 890/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6742
Overall F1 Score: 0.4059

Training for coarse level...
batch 100, loss: 0.2110, instance_loss: 0.2263, weighted_loss: 0.2156, label: 2, bag_size: 329
batch 200, loss: 0.3914, instance_loss: 0.2116, weighted_loss: 0.3375, label: 2, bag_size: 604
batch 300, loss: 0.6588, instance_loss: 0.2802, weighted_loss: 0.5453, label: 2, bag_size: 1048
batch 400, loss: 2.4980, instance_loss: 1.0016, weighted_loss: 2.0491, label: 1, bag_size: 633
batch 500, loss: 0.3509, instance_loss: 0.3072, weighted_loss: 0.3378, label: 2, bag_size: 156
batch 600, loss: 0.1723, instance_loss: 0.1808, weighted_loss: 0.1749, label: 2, bag_size: 581
batch 700, loss: 1.3666, instance_loss: 0.5789, weighted_loss: 1.1303, label: 1, bag_size: 334
batch 800, loss: 0.9750, instance_loss: 0.4602, weighted_loss: 0.8206, label: 2, bag_size: 373
batch 900, loss: 0.5483, instance_loss: 0.2935, weighted_loss: 0.4719, label: 2, bag_size: 460
batch 1000, loss: 0.2933, instance_loss: 0.3943, weighted_loss: 0.3236, label: 1, bag_size: 2154
batch 1100, loss: 0.6817, instance_loss: 0.4812, weighted_loss: 0.6215, label: 2, bag_size: 147
batch 1200, loss: 0.4134, instance_loss: 0.2134, weighted_loss: 0.3534, label: 2, bag_size: 873
batch 1300, loss: 1.0148, instance_loss: 0.5648, weighted_loss: 0.8798, label: 1, bag_size: 1223
batch 1400, loss: 0.6092, instance_loss: 0.2720, weighted_loss: 0.5081, label: 2, bag_size: 649
batch 1500, loss: 0.1015, instance_loss: 0.1463, weighted_loss: 0.1149, label: 2, bag_size: 643
batch 1600, loss: 1.2649, instance_loss: 0.5059, weighted_loss: 1.0372, label: 1, bag_size: 356
batch 1700, loss: 0.1052, instance_loss: 0.1065, weighted_loss: 0.1056, label: 2, bag_size: 1301
batch 1800, loss: 1.8899, instance_loss: 0.7834, weighted_loss: 1.5580, label: 2, bag_size: 150
batch 1900, loss: 0.7685, instance_loss: 0.4142, weighted_loss: 0.6622, label: 2, bag_size: 201
batch 2000, loss: 0.9684, instance_loss: 0.5181, weighted_loss: 0.8333, label: 2, bag_size: 246
batch 2100, loss: 0.0353, instance_loss: 0.0624, weighted_loss: 0.0434, label: 2, bag_size: 700

Instance Classifier Stats
class 0 clustering acc 0.9844902073732719: correct 68363/69440
class 1 clustering acc 0.38519585253456223: correct 6687/17360

Epoch: 49, train_loss: 0.7471, train_clustering_loss:  0.4177, train_error: 0.3194
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.11673151750972763, correct coarse 30/257 
Overall Accuracy: 0.6806

Val Set, val_loss: 0.7516, val_error: 0.3144, auc: 0.7896
class 0 clustering acc 0.9815340909090909: correct 8292/8448 
class 1 clustering acc 0.4270833333333333: correct 902/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4121

Training for coarse level...
batch 100, loss: 0.8766, instance_loss: 0.5449, weighted_loss: 0.7771, label: 2, bag_size: 275
batch 200, loss: 0.7722, instance_loss: 0.5557, weighted_loss: 0.7072, label: 1, bag_size: 1618
batch 300, loss: 0.9578, instance_loss: 0.5306, weighted_loss: 0.8296, label: 2, bag_size: 338
batch 400, loss: 1.2419, instance_loss: 0.6787, weighted_loss: 1.0730, label: 1, bag_size: 552
batch 500, loss: 1.0535, instance_loss: 0.4888, weighted_loss: 0.8841, label: 2, bag_size: 376
batch 600, loss: 1.8976, instance_loss: 0.8891, weighted_loss: 1.5951, label: 1, bag_size: 1654
batch 700, loss: 0.6365, instance_loss: 0.3691, weighted_loss: 0.5563, label: 2, bag_size: 245
batch 800, loss: 0.2024, instance_loss: 0.1833, weighted_loss: 0.1967, label: 2, bag_size: 330
batch 900, loss: 0.8913, instance_loss: 0.6399, weighted_loss: 0.8159, label: 2, bag_size: 387
batch 1000, loss: 0.7918, instance_loss: 0.4909, weighted_loss: 0.7015, label: 2, bag_size: 193
batch 1100, loss: 2.0854, instance_loss: 1.1257, weighted_loss: 1.7975, label: 1, bag_size: 559
batch 1200, loss: 0.1104, instance_loss: 0.1541, weighted_loss: 0.1235, label: 2, bag_size: 506
batch 1300, loss: 1.0436, instance_loss: 0.5414, weighted_loss: 0.8929, label: 2, bag_size: 548
batch 1400, loss: 0.0605, instance_loss: 0.0894, weighted_loss: 0.0691, label: 2, bag_size: 745
batch 1500, loss: 0.0629, instance_loss: 0.0660, weighted_loss: 0.0638, label: 1, bag_size: 2239
batch 1600, loss: 0.3852, instance_loss: 0.2243, weighted_loss: 0.3369, label: 2, bag_size: 403
batch 1700, loss: 0.0982, instance_loss: 0.1235, weighted_loss: 0.1058, label: 2, bag_size: 593
batch 1800, loss: 0.0807, instance_loss: 0.1668, weighted_loss: 0.1065, label: 2, bag_size: 221
batch 1900, loss: 3.5817, instance_loss: 0.8808, weighted_loss: 2.7714, label: 3, bag_size: 94
batch 2000, loss: 0.0839, instance_loss: 0.1132, weighted_loss: 0.0927, label: 2, bag_size: 779
batch 2100, loss: 0.6740, instance_loss: 0.3818, weighted_loss: 0.5864, label: 2, bag_size: 223

Instance Classifier Stats
class 0 clustering acc 0.9839429723502304: correct 68325/69440
class 1 clustering acc 0.3900921658986175: correct 6772/17360

Epoch: 50, train_loss: 0.7461, train_clustering_loss:  0.4166, train_error: 0.3152
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6240409207161125, correct coarse 488/782 
coarse class 2: coarse acc 0.8942042318307267, correct coarse 972/1087 
coarse class 3: coarse acc 0.10116731517509728, correct coarse 26/257 
Overall Accuracy: 0.6848

Val Set, val_loss: 0.7523, val_error: 0.3182, auc: 0.7899
class 0 clustering acc 0.9818892045454546: correct 8295/8448 
class 1 clustering acc 0.4247159090909091: correct 897/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4103

Training for coarse level...
batch 100, loss: 0.2102, instance_loss: 0.3362, weighted_loss: 0.2480, label: 1, bag_size: 601
batch 200, loss: 0.6609, instance_loss: 0.5932, weighted_loss: 0.6406, label: 1, bag_size: 225
batch 300, loss: 2.0234, instance_loss: 0.9158, weighted_loss: 1.6912, label: 3, bag_size: 180
batch 400, loss: 0.0194, instance_loss: 0.0472, weighted_loss: 0.0277, label: 1, bag_size: 199
batch 500, loss: 0.0604, instance_loss: 0.0925, weighted_loss: 0.0700, label: 2, bag_size: 1281
batch 600, loss: 2.3633, instance_loss: 1.0188, weighted_loss: 1.9600, label: 3, bag_size: 512
batch 700, loss: 0.3791, instance_loss: 0.3232, weighted_loss: 0.3624, label: 2, bag_size: 740
batch 800, loss: 0.8620, instance_loss: 0.5736, weighted_loss: 0.7755, label: 2, bag_size: 744
batch 900, loss: 1.6824, instance_loss: 0.7470, weighted_loss: 1.4018, label: 1, bag_size: 186
batch 1000, loss: 0.0193, instance_loss: 0.0554, weighted_loss: 0.0301, label: 1, bag_size: 919
batch 1100, loss: 0.2959, instance_loss: 0.2186, weighted_loss: 0.2727, label: 2, bag_size: 600
batch 1200, loss: 1.7423, instance_loss: 0.8576, weighted_loss: 1.4769, label: 1, bag_size: 983
batch 1300, loss: 0.0356, instance_loss: 0.1357, weighted_loss: 0.0657, label: 1, bag_size: 889
batch 1400, loss: 0.9506, instance_loss: 0.6428, weighted_loss: 0.8583, label: 2, bag_size: 311
batch 1500, loss: 1.2003, instance_loss: 0.6370, weighted_loss: 1.0313, label: 1, bag_size: 437
batch 1600, loss: 1.6353, instance_loss: 0.7542, weighted_loss: 1.3710, label: 1, bag_size: 73
batch 1700, loss: 0.0490, instance_loss: 0.1165, weighted_loss: 0.0693, label: 2, bag_size: 629
batch 1800, loss: 0.0600, instance_loss: 0.1081, weighted_loss: 0.0744, label: 2, bag_size: 202
batch 1900, loss: 0.6375, instance_loss: 0.4346, weighted_loss: 0.5766, label: 2, bag_size: 406
batch 2000, loss: 0.0574, instance_loss: 0.0858, weighted_loss: 0.0659, label: 2, bag_size: 252
batch 2100, loss: 1.1140, instance_loss: 0.5994, weighted_loss: 0.9596, label: 1, bag_size: 267

Instance Classifier Stats
class 0 clustering acc 0.9840005760368664: correct 68329/69440
class 1 clustering acc 0.3895161290322581: correct 6762/17360

Epoch: 51, train_loss: 0.7457, train_clustering_loss:  0.4154, train_error: 0.3129
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6419437340153452, correct coarse 502/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.11673151750972763, correct coarse 30/257 
Overall Accuracy: 0.6871

Val Set, val_loss: 0.7519, val_error: 0.3144, auc: 0.7895
class 0 clustering acc 0.982125946969697: correct 8297/8448 
class 1 clustering acc 0.42424242424242425: correct 896/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4123

Training for coarse level...
batch 100, loss: 0.5446, instance_loss: 0.3637, weighted_loss: 0.4903, label: 2, bag_size: 565
batch 200, loss: 3.9493, instance_loss: 0.8949, weighted_loss: 3.0330, label: 0, bag_size: 142
batch 300, loss: 0.9495, instance_loss: 0.5012, weighted_loss: 0.8150, label: 1, bag_size: 575
batch 400, loss: 0.0823, instance_loss: 0.0967, weighted_loss: 0.0866, label: 2, bag_size: 467
batch 500, loss: 1.0147, instance_loss: 0.5387, weighted_loss: 0.8719, label: 2, bag_size: 305
batch 600, loss: 0.9613, instance_loss: 0.6349, weighted_loss: 0.8634, label: 3, bag_size: 590
batch 700, loss: 0.6128, instance_loss: 0.4309, weighted_loss: 0.5582, label: 2, bag_size: 333
batch 800, loss: 1.4069, instance_loss: 0.6410, weighted_loss: 1.1772, label: 1, bag_size: 169
batch 900, loss: 0.0515, instance_loss: 0.0745, weighted_loss: 0.0584, label: 1, bag_size: 410
batch 1000, loss: 0.0742, instance_loss: 0.1285, weighted_loss: 0.0905, label: 1, bag_size: 757
batch 1100, loss: 2.8224, instance_loss: 1.1440, weighted_loss: 2.3189, label: 2, bag_size: 3052
batch 1200, loss: 0.0197, instance_loss: 0.0405, weighted_loss: 0.0259, label: 2, bag_size: 861
batch 1300, loss: 0.1952, instance_loss: 0.1851, weighted_loss: 0.1922, label: 1, bag_size: 1479
batch 1400, loss: 0.1653, instance_loss: 0.1681, weighted_loss: 0.1661, label: 2, bag_size: 624
batch 1500, loss: 1.1457, instance_loss: 0.5647, weighted_loss: 0.9714, label: 2, bag_size: 469
batch 1600, loss: 1.4638, instance_loss: 0.8676, weighted_loss: 1.2849, label: 1, bag_size: 664
batch 1700, loss: 0.0427, instance_loss: 0.1224, weighted_loss: 0.0666, label: 2, bag_size: 261
batch 1800, loss: 0.6953, instance_loss: 0.4454, weighted_loss: 0.6203, label: 1, bag_size: 1193
batch 1900, loss: 0.1850, instance_loss: 0.2103, weighted_loss: 0.1926, label: 1, bag_size: 365
batch 2000, loss: 1.4029, instance_loss: 0.8723, weighted_loss: 1.2437, label: 3, bag_size: 333
batch 2100, loss: 1.5598, instance_loss: 0.6364, weighted_loss: 1.2828, label: 3, bag_size: 130

Instance Classifier Stats
class 0 clustering acc 0.9837557603686636: correct 68312/69440
class 1 clustering acc 0.39256912442396313: correct 6815/17360

Epoch: 52, train_loss: 0.7442, train_clustering_loss:  0.4161, train_error: 0.3138
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782 
coarse class 2: coarse acc 0.8877644894204232, correct coarse 965/1087 
coarse class 3: coarse acc 0.10116731517509728, correct coarse 26/257 
Overall Accuracy: 0.6862

Val Set, val_loss: 0.7516, val_error: 0.3182, auc: 0.7897
class 0 clustering acc 0.982717803030303: correct 8302/8448 
class 1 clustering acc 0.42234848484848486: correct 892/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4098

Training for coarse level...
batch 100, loss: 1.4152, instance_loss: 0.7057, weighted_loss: 1.2023, label: 2, bag_size: 231
batch 200, loss: 3.9564, instance_loss: 0.9781, weighted_loss: 3.0629, label: 0, bag_size: 142
batch 300, loss: 1.4498, instance_loss: 0.7842, weighted_loss: 1.2501, label: 3, bag_size: 663
batch 400, loss: 0.1471, instance_loss: 0.2038, weighted_loss: 0.1641, label: 1, bag_size: 3892
batch 500, loss: 0.0453, instance_loss: 0.1088, weighted_loss: 0.0644, label: 1, bag_size: 926
batch 600, loss: 1.1062, instance_loss: 0.5732, weighted_loss: 0.9463, label: 2, bag_size: 274
batch 700, loss: 1.0218, instance_loss: 0.5653, weighted_loss: 0.8849, label: 1, bag_size: 613
batch 800, loss: 0.0980, instance_loss: 0.1388, weighted_loss: 0.1103, label: 2, bag_size: 658
batch 900, loss: 0.1360, instance_loss: 0.1411, weighted_loss: 0.1375, label: 1, bag_size: 1052
batch 1000, loss: 0.0154, instance_loss: 0.0846, weighted_loss: 0.0362, label: 1, bag_size: 305
batch 1100, loss: 0.2130, instance_loss: 0.2046, weighted_loss: 0.2105, label: 2, bag_size: 264
batch 1200, loss: 0.0529, instance_loss: 0.0647, weighted_loss: 0.0564, label: 1, bag_size: 813
batch 1300, loss: 0.2649, instance_loss: 0.2781, weighted_loss: 0.2689, label: 1, bag_size: 610
batch 1400, loss: 1.1669, instance_loss: 0.6488, weighted_loss: 1.0115, label: 3, bag_size: 338
batch 1500, loss: 1.0042, instance_loss: 0.6243, weighted_loss: 0.8902, label: 1, bag_size: 177
batch 1600, loss: 1.5653, instance_loss: 0.6550, weighted_loss: 1.2922, label: 3, bag_size: 130
batch 1700, loss: 0.0196, instance_loss: 0.0463, weighted_loss: 0.0276, label: 1, bag_size: 199
batch 1800, loss: 0.2202, instance_loss: 0.1909, weighted_loss: 0.2114, label: 2, bag_size: 482
batch 1900, loss: 0.2774, instance_loss: 0.2136, weighted_loss: 0.2582, label: 1, bag_size: 755
batch 2000, loss: 1.2145, instance_loss: 0.6155, weighted_loss: 1.0348, label: 1, bag_size: 187
batch 2100, loss: 0.9327, instance_loss: 0.5447, weighted_loss: 0.8163, label: 1, bag_size: 298

Instance Classifier Stats
class 0 clustering acc 0.9840869815668203: correct 68335/69440
class 1 clustering acc 0.38911290322580644: correct 6755/17360

Epoch: 53, train_loss: 0.7431, train_clustering_loss:  0.4158, train_error: 0.3161
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.8712051517939282, correct coarse 947/1087 
coarse class 3: coarse acc 0.11673151750972763, correct coarse 30/257 
Overall Accuracy: 0.6839

Val Set, val_loss: 0.7498, val_error: 0.3144, auc: 0.7899
class 0 clustering acc 0.982125946969697: correct 8297/8448 
class 1 clustering acc 0.4228219696969697: correct 893/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4117

Training for coarse level...
batch 100, loss: 0.0199, instance_loss: 0.0598, weighted_loss: 0.0319, label: 2, bag_size: 274
batch 200, loss: 0.1695, instance_loss: 0.4894, weighted_loss: 0.2654, label: 2, bag_size: 11
batch 300, loss: 1.0646, instance_loss: 0.5943, weighted_loss: 0.9235, label: 2, bag_size: 220
batch 400, loss: 0.5547, instance_loss: 0.3445, weighted_loss: 0.4916, label: 2, bag_size: 268
batch 500, loss: 0.2935, instance_loss: 0.2266, weighted_loss: 0.2734, label: 1, bag_size: 780
batch 600, loss: 1.0062, instance_loss: 0.5195, weighted_loss: 0.8602, label: 2, bag_size: 242
batch 700, loss: 0.0451, instance_loss: 0.0846, weighted_loss: 0.0570, label: 2, bag_size: 893
batch 800, loss: 1.1381, instance_loss: 0.5175, weighted_loss: 0.9519, label: 2, bag_size: 187
batch 900, loss: 0.1030, instance_loss: 0.1568, weighted_loss: 0.1191, label: 1, bag_size: 2037
batch 1000, loss: 1.2853, instance_loss: 0.6735, weighted_loss: 1.1018, label: 3, bag_size: 441
batch 1100, loss: 0.7608, instance_loss: 0.3988, weighted_loss: 0.6522, label: 1, bag_size: 501
batch 1200, loss: 0.0838, instance_loss: 0.1607, weighted_loss: 0.1069, label: 1, bag_size: 128
batch 1300, loss: 0.2374, instance_loss: 0.4338, weighted_loss: 0.2963, label: 1, bag_size: 1279
batch 1400, loss: 0.5015, instance_loss: 0.2926, weighted_loss: 0.4388, label: 2, bag_size: 394
batch 1500, loss: 1.5911, instance_loss: 0.7092, weighted_loss: 1.3265, label: 3, bag_size: 661
batch 1600, loss: 0.9963, instance_loss: 0.5606, weighted_loss: 0.8656, label: 1, bag_size: 965
batch 1700, loss: 1.5628, instance_loss: 0.6876, weighted_loss: 1.3002, label: 1, bag_size: 657
batch 1800, loss: 0.0527, instance_loss: 0.1249, weighted_loss: 0.0744, label: 2, bag_size: 289
batch 1900, loss: 0.2348, instance_loss: 0.2852, weighted_loss: 0.2500, label: 1, bag_size: 1987
batch 2000, loss: 0.7535, instance_loss: 0.4460, weighted_loss: 0.6612, label: 2, bag_size: 435
batch 2100, loss: 0.8485, instance_loss: 0.5386, weighted_loss: 0.7555, label: 1, bag_size: 74

Instance Classifier Stats
class 0 clustering acc 0.9841157834101383: correct 68337/69440
class 1 clustering acc 0.38888248847926266: correct 6751/17360

Epoch: 54, train_loss: 0.7422, train_clustering_loss:  0.4150, train_error: 0.3157
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6265984654731458, correct coarse 490/782 
coarse class 2: coarse acc 0.8859245630174793, correct coarse 963/1087 
coarse class 3: coarse acc 0.1245136186770428, correct coarse 32/257 
Overall Accuracy: 0.6843

Val Set, val_loss: 0.7502, val_error: 0.3144, auc: 0.7892
class 0 clustering acc 0.982125946969697: correct 8297/8448 
class 1 clustering acc 0.42424242424242425: correct 896/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4123

Training for coarse level...
batch 100, loss: 1.1341, instance_loss: 0.7507, weighted_loss: 1.0191, label: 3, bag_size: 263
batch 200, loss: 0.0549, instance_loss: 0.1244, weighted_loss: 0.0757, label: 2, bag_size: 705
batch 300, loss: 1.4001, instance_loss: 0.7173, weighted_loss: 1.1953, label: 3, bag_size: 356
batch 400, loss: 0.3762, instance_loss: 0.2856, weighted_loss: 0.3490, label: 2, bag_size: 1555
batch 500, loss: 0.9144, instance_loss: 0.6141, weighted_loss: 0.8243, label: 2, bag_size: 206
batch 600, loss: 0.7240, instance_loss: 0.3380, weighted_loss: 0.6082, label: 2, bag_size: 814
batch 700, loss: 0.0290, instance_loss: 0.1055, weighted_loss: 0.0520, label: 2, bag_size: 405
batch 800, loss: 1.1155, instance_loss: 0.5104, weighted_loss: 0.9339, label: 2, bag_size: 562
batch 900, loss: 2.5288, instance_loss: 0.8997, weighted_loss: 2.0401, label: 0, bag_size: 320
batch 1000, loss: 1.6580, instance_loss: 0.8208, weighted_loss: 1.4068, label: 1, bag_size: 260
batch 1100, loss: 0.5493, instance_loss: 0.3701, weighted_loss: 0.4956, label: 2, bag_size: 268
batch 1200, loss: 1.8775, instance_loss: 0.9382, weighted_loss: 1.5957, label: 0, bag_size: 388
batch 1300, loss: 0.1134, instance_loss: 0.1881, weighted_loss: 0.1358, label: 1, bag_size: 379
batch 1400, loss: 0.8014, instance_loss: 0.4658, weighted_loss: 0.7007, label: 2, bag_size: 1165
batch 1500, loss: 0.7324, instance_loss: 0.4095, weighted_loss: 0.6355, label: 2, bag_size: 334
batch 1600, loss: 0.0655, instance_loss: 0.1002, weighted_loss: 0.0759, label: 2, bag_size: 330
batch 1700, loss: 0.8438, instance_loss: 0.5458, weighted_loss: 0.7544, label: 2, bag_size: 519
batch 1800, loss: 0.0364, instance_loss: 0.0601, weighted_loss: 0.0435, label: 2, bag_size: 463
batch 1900, loss: 0.0401, instance_loss: 0.1376, weighted_loss: 0.0694, label: 1, bag_size: 1617
batch 2000, loss: 0.0835, instance_loss: 0.1133, weighted_loss: 0.0924, label: 1, bag_size: 633
batch 2100, loss: 1.7826, instance_loss: 0.9785, weighted_loss: 1.5414, label: 1, bag_size: 306

Instance Classifier Stats
class 0 clustering acc 0.9835541474654378: correct 68298/69440
class 1 clustering acc 0.39262672811059907: correct 6816/17360

Epoch: 55, train_loss: 0.7405, train_clustering_loss:  0.4154, train_error: 0.3161
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6342710997442456, correct coarse 496/782 
coarse class 2: coarse acc 0.8831646734130635, correct coarse 960/1087 
coarse class 3: coarse acc 0.10894941634241245, correct coarse 28/257 
Overall Accuracy: 0.6839

Val Set, val_loss: 0.7501, val_error: 0.3182, auc: 0.7886
class 0 clustering acc 0.9823626893939394: correct 8299/8448 
class 1 clustering acc 0.421875: correct 891/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4098

Training for coarse level...
batch 100, loss: 0.4339, instance_loss: 0.3065, weighted_loss: 0.3957, label: 2, bag_size: 543
batch 200, loss: 1.9569, instance_loss: 0.8262, weighted_loss: 1.6177, label: 3, bag_size: 486
batch 300, loss: 0.8588, instance_loss: 0.4128, weighted_loss: 0.7250, label: 2, bag_size: 290
batch 400, loss: 0.7138, instance_loss: 0.3098, weighted_loss: 0.5926, label: 2, bag_size: 259
batch 500, loss: 0.0424, instance_loss: 0.1002, weighted_loss: 0.0597, label: 2, bag_size: 333
batch 600, loss: 1.1945, instance_loss: 0.5119, weighted_loss: 0.9897, label: 2, bag_size: 248
batch 700, loss: 1.2302, instance_loss: 0.5959, weighted_loss: 1.0399, label: 1, bag_size: 116
batch 800, loss: 0.4549, instance_loss: 0.3490, weighted_loss: 0.4231, label: 2, bag_size: 488
batch 900, loss: 0.5086, instance_loss: 0.3605, weighted_loss: 0.4642, label: 2, bag_size: 503
batch 1000, loss: 3.0125, instance_loss: 1.3111, weighted_loss: 2.5021, label: 3, bag_size: 2813
batch 1100, loss: 0.9396, instance_loss: 0.5802, weighted_loss: 0.8318, label: 3, bag_size: 487
batch 1200, loss: 0.0649, instance_loss: 0.0853, weighted_loss: 0.0710, label: 2, bag_size: 442
batch 1300, loss: 1.0943, instance_loss: 0.5686, weighted_loss: 0.9366, label: 2, bag_size: 331
batch 1400, loss: 0.1088, instance_loss: 0.1697, weighted_loss: 0.1271, label: 2, bag_size: 457
batch 1500, loss: 2.6905, instance_loss: 0.9401, weighted_loss: 2.1654, label: 0, bag_size: 132
batch 1600, loss: 0.1410, instance_loss: 0.1597, weighted_loss: 0.1466, label: 2, bag_size: 2032
batch 1700, loss: 0.0468, instance_loss: 0.0822, weighted_loss: 0.0574, label: 2, bag_size: 859
batch 1800, loss: 1.6166, instance_loss: 0.6471, weighted_loss: 1.3257, label: 1, bag_size: 185
batch 1900, loss: 1.0195, instance_loss: 0.4961, weighted_loss: 0.8625, label: 2, bag_size: 305
batch 2000, loss: 0.0299, instance_loss: 0.0321, weighted_loss: 0.0305, label: 1, bag_size: 174
batch 2100, loss: 0.6701, instance_loss: 0.4277, weighted_loss: 0.5974, label: 2, bag_size: 544

Instance Classifier Stats
class 0 clustering acc 0.984375: correct 68355/69440
class 1 clustering acc 0.3902073732718894: correct 6774/17360

Epoch: 56, train_loss: 0.7401, train_clustering_loss:  0.4149, train_error: 0.3120
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6457800511508951, correct coarse 505/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
Overall Accuracy: 0.6880

Val Set, val_loss: 0.7497, val_error: 0.3144, auc: 0.7884
class 0 clustering acc 0.9822443181818182: correct 8298/8448 
class 1 clustering acc 0.4228219696969697: correct 893/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4123

Training for coarse level...
batch 100, loss: 0.5743, instance_loss: 0.3135, weighted_loss: 0.4960, label: 2, bag_size: 466
batch 200, loss: 0.6069, instance_loss: 0.3731, weighted_loss: 0.5368, label: 2, bag_size: 237
batch 300, loss: 0.0965, instance_loss: 0.1594, weighted_loss: 0.1154, label: 1, bag_size: 526
batch 400, loss: 1.2473, instance_loss: 0.6369, weighted_loss: 1.0642, label: 1, bag_size: 442
batch 500, loss: 1.2594, instance_loss: 0.5477, weighted_loss: 1.0459, label: 2, bag_size: 1796
batch 600, loss: 0.9905, instance_loss: 0.5348, weighted_loss: 0.8538, label: 2, bag_size: 224
batch 700, loss: 0.1201, instance_loss: 0.1732, weighted_loss: 0.1360, label: 1, bag_size: 1781
batch 800, loss: 0.1588, instance_loss: 0.1613, weighted_loss: 0.1596, label: 2, bag_size: 240
batch 900, loss: 1.2480, instance_loss: 0.6498, weighted_loss: 1.0686, label: 1, bag_size: 933
batch 1000, loss: 0.2580, instance_loss: 0.2654, weighted_loss: 0.2602, label: 1, bag_size: 398
batch 1100, loss: 0.3908, instance_loss: 0.3429, weighted_loss: 0.3764, label: 2, bag_size: 740
batch 1200, loss: 1.0637, instance_loss: 0.6390, weighted_loss: 0.9363, label: 2, bag_size: 663
batch 1300, loss: 0.1024, instance_loss: 0.1038, weighted_loss: 0.1028, label: 2, bag_size: 441
batch 1400, loss: 0.9296, instance_loss: 0.4101, weighted_loss: 0.7738, label: 2, bag_size: 604
batch 1500, loss: 0.8900, instance_loss: 0.5845, weighted_loss: 0.7984, label: 1, bag_size: 378
batch 1600, loss: 0.0741, instance_loss: 0.1023, weighted_loss: 0.0825, label: 2, bag_size: 435
batch 1700, loss: 1.3834, instance_loss: 0.6360, weighted_loss: 1.1592, label: 1, bag_size: 115
batch 1800, loss: 1.8251, instance_loss: 0.5940, weighted_loss: 1.4558, label: 1, bag_size: 254
batch 1900, loss: 1.6866, instance_loss: 0.8438, weighted_loss: 1.4338, label: 3, bag_size: 542
batch 2000, loss: 1.1774, instance_loss: 0.6326, weighted_loss: 1.0140, label: 1, bag_size: 622
batch 2100, loss: 0.3743, instance_loss: 0.4727, weighted_loss: 0.4038, label: 1, bag_size: 806

Instance Classifier Stats
class 0 clustering acc 0.9835973502304147: correct 68301/69440
class 1 clustering acc 0.39418202764976956: correct 6843/17360

Epoch: 57, train_loss: 0.7402, train_clustering_loss:  0.4144, train_error: 0.3147
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6355498721227621, correct coarse 497/782 
coarse class 2: coarse acc 0.8850045998160073, correct coarse 962/1087 
coarse class 3: coarse acc 0.10894941634241245, correct coarse 28/257 
Overall Accuracy: 0.6853

Val Set, val_loss: 0.7493, val_error: 0.3144, auc: 0.7880
class 0 clustering acc 0.9822443181818182: correct 8298/8448 
class 1 clustering acc 0.42140151515151514: correct 890/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4123

Training for coarse level...
batch 100, loss: 0.0415, instance_loss: 0.0840, weighted_loss: 0.0542, label: 2, bag_size: 393
batch 200, loss: 0.5676, instance_loss: 0.5029, weighted_loss: 0.5482, label: 2, bag_size: 477
batch 300, loss: 1.4888, instance_loss: 0.5773, weighted_loss: 1.2154, label: 3, bag_size: 119
batch 400, loss: 0.3002, instance_loss: 0.2599, weighted_loss: 0.2881, label: 2, bag_size: 431
batch 500, loss: 1.1086, instance_loss: 0.6558, weighted_loss: 0.9728, label: 3, bag_size: 178
batch 600, loss: 0.7350, instance_loss: 0.4658, weighted_loss: 0.6542, label: 2, bag_size: 106
batch 700, loss: 0.1079, instance_loss: 0.2266, weighted_loss: 0.1435, label: 1, bag_size: 1118
batch 800, loss: 0.4622, instance_loss: 0.2429, weighted_loss: 0.3964, label: 2, bag_size: 2272
batch 900, loss: 0.0525, instance_loss: 0.0958, weighted_loss: 0.0655, label: 2, bag_size: 228
batch 1000, loss: 1.0493, instance_loss: 0.7713, weighted_loss: 0.9659, label: 3, bag_size: 1274
batch 1100, loss: 1.9641, instance_loss: 0.9015, weighted_loss: 1.6453, label: 1, bag_size: 237
batch 1200, loss: 0.4048, instance_loss: 0.3836, weighted_loss: 0.3984, label: 2, bag_size: 200
batch 1300, loss: 5.1545, instance_loss: 1.4956, weighted_loss: 4.0568, label: 3, bag_size: 868
batch 1400, loss: 0.6415, instance_loss: 0.5481, weighted_loss: 0.6135, label: 3, bag_size: 665
batch 1500, loss: 0.2655, instance_loss: 0.3429, weighted_loss: 0.2887, label: 1, bag_size: 1628
batch 1600, loss: 0.3041, instance_loss: 0.2493, weighted_loss: 0.2877, label: 2, bag_size: 342
batch 1700, loss: 2.6350, instance_loss: 0.9582, weighted_loss: 2.1320, label: 0, bag_size: 132
batch 1800, loss: 0.7508, instance_loss: 0.2666, weighted_loss: 0.6056, label: 2, bag_size: 599
batch 1900, loss: 1.6720, instance_loss: 0.7991, weighted_loss: 1.4102, label: 3, bag_size: 829
batch 2000, loss: 1.0257, instance_loss: 0.6107, weighted_loss: 0.9012, label: 3, bag_size: 245
batch 2100, loss: 0.7205, instance_loss: 0.3455, weighted_loss: 0.6080, label: 2, bag_size: 802

Instance Classifier Stats
class 0 clustering acc 0.983395737327189: correct 68287/69440
class 1 clustering acc 0.39285714285714285: correct 6820/17360

Epoch: 58, train_loss: 0.7381, train_clustering_loss:  0.4144, train_error: 0.3134
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6278772378516624, correct coarse 491/782 
coarse class 2: coarse acc 0.891444342226311, correct coarse 969/1087 
coarse class 3: coarse acc 0.11673151750972763, correct coarse 30/257 
Overall Accuracy: 0.6866

Val Set, val_loss: 0.7513, val_error: 0.3106, auc: 0.7876
class 0 clustering acc 0.982717803030303: correct 8302/8448 
class 1 clustering acc 0.4199810606060606: correct 887/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6894
Overall F1 Score: 0.4142

Training for coarse level...
batch 100, loss: 0.2167, instance_loss: 0.1874, weighted_loss: 0.2079, label: 1, bag_size: 1973
batch 200, loss: 0.0703, instance_loss: 0.1387, weighted_loss: 0.0908, label: 2, bag_size: 673
batch 300, loss: 0.0275, instance_loss: 0.0762, weighted_loss: 0.0421, label: 2, bag_size: 371
batch 400, loss: 0.2894, instance_loss: 0.2985, weighted_loss: 0.2921, label: 1, bag_size: 1706
batch 500, loss: 2.6618, instance_loss: 1.1581, weighted_loss: 2.2107, label: 2, bag_size: 1555
batch 600, loss: 3.4127, instance_loss: 0.9583, weighted_loss: 2.6764, label: 0, bag_size: 313
batch 700, loss: 0.0559, instance_loss: 0.1109, weighted_loss: 0.0724, label: 2, bag_size: 533
batch 800, loss: 1.8464, instance_loss: 0.6719, weighted_loss: 1.4941, label: 1, bag_size: 168
batch 900, loss: 0.8546, instance_loss: 0.4990, weighted_loss: 0.7479, label: 1, bag_size: 1256
batch 1000, loss: 2.5583, instance_loss: 1.3537, weighted_loss: 2.1969, label: 3, bag_size: 1529
batch 1100, loss: 0.5024, instance_loss: 0.4656, weighted_loss: 0.4913, label: 2, bag_size: 333
batch 1200, loss: 0.6948, instance_loss: 0.4338, weighted_loss: 0.6165, label: 1, bag_size: 501
batch 1300, loss: 1.3530, instance_loss: 0.6613, weighted_loss: 1.1455, label: 1, bag_size: 304
batch 1400, loss: 1.3098, instance_loss: 0.6589, weighted_loss: 1.1145, label: 1, bag_size: 2112
batch 1500, loss: 1.4574, instance_loss: 0.5685, weighted_loss: 1.1908, label: 2, bag_size: 304
batch 1600, loss: 0.5480, instance_loss: 0.2916, weighted_loss: 0.4711, label: 1, bag_size: 252
batch 1700, loss: 1.0534, instance_loss: 0.5794, weighted_loss: 0.9112, label: 3, bag_size: 22
batch 1800, loss: 0.0890, instance_loss: 0.1299, weighted_loss: 0.1013, label: 1, bag_size: 1049
batch 1900, loss: 0.5170, instance_loss: 0.4962, weighted_loss: 0.5107, label: 3, bag_size: 163
batch 2000, loss: 0.3129, instance_loss: 0.1855, weighted_loss: 0.2746, label: 2, bag_size: 385
batch 2100, loss: 0.0280, instance_loss: 0.0797, weighted_loss: 0.0435, label: 2, bag_size: 104

Instance Classifier Stats
class 0 clustering acc 0.9840293778801843: correct 68331/69440
class 1 clustering acc 0.39475806451612905: correct 6853/17360

Epoch: 59, train_loss: 0.7371, train_clustering_loss:  0.4124, train_error: 0.3134
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.1245136186770428, correct coarse 32/257 
Overall Accuracy: 0.6866

Val Set, val_loss: 0.7500, val_error: 0.3106, auc: 0.7871
class 0 clustering acc 0.982717803030303: correct 8302/8448 
class 1 clustering acc 0.42045454545454547: correct 888/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6894
Overall F1 Score: 0.4144

Training for coarse level...
batch 100, loss: 0.0528, instance_loss: 0.1252, weighted_loss: 0.0745, label: 2, bag_size: 389
batch 200, loss: 0.0272, instance_loss: 0.0765, weighted_loss: 0.0420, label: 2, bag_size: 304
batch 300, loss: 0.8403, instance_loss: 0.5074, weighted_loss: 0.7404, label: 2, bag_size: 896
batch 400, loss: 0.2555, instance_loss: 0.1220, weighted_loss: 0.2155, label: 1, bag_size: 1726
batch 500, loss: 1.2344, instance_loss: 0.7063, weighted_loss: 1.0759, label: 1, bag_size: 946
batch 600, loss: 0.0422, instance_loss: 0.0919, weighted_loss: 0.0571, label: 1, bag_size: 1490
batch 700, loss: 0.0997, instance_loss: 0.1184, weighted_loss: 0.1053, label: 2, bag_size: 2141
batch 800, loss: 0.0170, instance_loss: 0.0589, weighted_loss: 0.0296, label: 2, bag_size: 495
batch 900, loss: 0.1143, instance_loss: 0.1035, weighted_loss: 0.1110, label: 1, bag_size: 975
batch 1000, loss: 0.0231, instance_loss: 0.0576, weighted_loss: 0.0335, label: 2, bag_size: 563
batch 1100, loss: 0.7350, instance_loss: 0.5177, weighted_loss: 0.6698, label: 2, bag_size: 1019
batch 1200, loss: 1.9468, instance_loss: 0.9658, weighted_loss: 1.6525, label: 3, bag_size: 838
batch 1300, loss: 0.0393, instance_loss: 0.0563, weighted_loss: 0.0444, label: 2, bag_size: 484
batch 1400, loss: 0.2110, instance_loss: 0.1324, weighted_loss: 0.1874, label: 2, bag_size: 541
batch 1500, loss: 0.0378, instance_loss: 0.0804, weighted_loss: 0.0506, label: 2, bag_size: 185
batch 1600, loss: 0.7273, instance_loss: 0.3951, weighted_loss: 0.6277, label: 2, bag_size: 131
batch 1700, loss: 3.0279, instance_loss: 1.0565, weighted_loss: 2.4365, label: 0, bag_size: 863
batch 1800, loss: 0.9443, instance_loss: 0.5720, weighted_loss: 0.8326, label: 1, bag_size: 1030
batch 1900, loss: 1.1803, instance_loss: 0.5744, weighted_loss: 0.9985, label: 1, bag_size: 448
batch 2000, loss: 0.9910, instance_loss: 0.5496, weighted_loss: 0.8586, label: 1, bag_size: 241
batch 2100, loss: 0.7801, instance_loss: 0.4461, weighted_loss: 0.6799, label: 2, bag_size: 301

Instance Classifier Stats
class 0 clustering acc 0.9836693548387097: correct 68306/69440
class 1 clustering acc 0.39400921658986177: correct 6840/17360

Epoch: 60, train_loss: 0.7373, train_clustering_loss:  0.4127, train_error: 0.3157
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6317135549872123, correct coarse 494/782 
coarse class 2: coarse acc 0.8831646734130635, correct coarse 960/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
Overall Accuracy: 0.6843

Val Set, val_loss: 0.7490, val_error: 0.3106, auc: 0.7873
class 0 clustering acc 0.982717803030303: correct 8302/8448 
class 1 clustering acc 0.42234848484848486: correct 892/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6894
Overall F1 Score: 0.4144

Training for coarse level...
batch 100, loss: 1.1564, instance_loss: 0.6054, weighted_loss: 0.9911, label: 3, bag_size: 249
batch 200, loss: 1.0658, instance_loss: 0.6372, weighted_loss: 0.9372, label: 3, bag_size: 478
batch 300, loss: 1.0272, instance_loss: 0.6501, weighted_loss: 0.9141, label: 1, bag_size: 188
batch 400, loss: 1.1190, instance_loss: 0.6578, weighted_loss: 0.9806, label: 3, bag_size: 490
batch 500, loss: 0.1946, instance_loss: 0.4897, weighted_loss: 0.2831, label: 2, bag_size: 11
batch 600, loss: 0.4421, instance_loss: 0.3550, weighted_loss: 0.4160, label: 2, bag_size: 351
batch 700, loss: 0.1027, instance_loss: 0.3089, weighted_loss: 0.1645, label: 1, bag_size: 3530
batch 800, loss: 0.1002, instance_loss: 0.1856, weighted_loss: 0.1258, label: 2, bag_size: 681
batch 900, loss: 0.5127, instance_loss: 0.4927, weighted_loss: 0.5067, label: 2, bag_size: 116
batch 1000, loss: 0.3221, instance_loss: 0.1889, weighted_loss: 0.2821, label: 2, bag_size: 1214
batch 1100, loss: 1.2637, instance_loss: 0.6385, weighted_loss: 1.0762, label: 1, bag_size: 402
batch 1200, loss: 0.0683, instance_loss: 0.1344, weighted_loss: 0.0882, label: 2, bag_size: 570
batch 1300, loss: 0.0844, instance_loss: 0.0779, weighted_loss: 0.0825, label: 2, bag_size: 1005
batch 1400, loss: 0.0347, instance_loss: 0.2367, weighted_loss: 0.0953, label: 1, bag_size: 1534
batch 1500, loss: 0.5579, instance_loss: 0.4192, weighted_loss: 0.5163, label: 2, bag_size: 843
batch 1600, loss: 0.1647, instance_loss: 0.0703, weighted_loss: 0.1364, label: 1, bag_size: 1867
batch 1700, loss: 1.6457, instance_loss: 0.8199, weighted_loss: 1.3980, label: 1, bag_size: 115
batch 1800, loss: 0.2741, instance_loss: 0.2277, weighted_loss: 0.2602, label: 2, bag_size: 379
batch 1900, loss: 0.0411, instance_loss: 0.1913, weighted_loss: 0.0862, label: 1, bag_size: 606
batch 2000, loss: 0.0659, instance_loss: 0.0927, weighted_loss: 0.0740, label: 1, bag_size: 483
batch 2100, loss: 0.9848, instance_loss: 0.6093, weighted_loss: 0.8722, label: 3, bag_size: 120

Instance Classifier Stats
class 0 clustering acc 0.9837989631336406: correct 68315/69440
class 1 clustering acc 0.39464285714285713: correct 6851/17360

Epoch: 61, train_loss: 0.7355, train_clustering_loss:  0.4119, train_error: 0.3097
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.649616368286445, correct coarse 508/782 
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6903

Val Set, val_loss: 0.7478, val_error: 0.3182, auc: 0.7877
class 0 clustering acc 0.9829545454545454: correct 8304/8448 
class 1 clustering acc 0.4228219696969697: correct 893/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4098

Training for coarse level...
batch 100, loss: 0.9761, instance_loss: 0.3499, weighted_loss: 0.7882, label: 2, bag_size: 532
batch 200, loss: 0.0285, instance_loss: 0.0579, weighted_loss: 0.0373, label: 1, bag_size: 537
batch 300, loss: 0.5558, instance_loss: 0.3595, weighted_loss: 0.4969, label: 1, bag_size: 483
batch 400, loss: 0.0223, instance_loss: 0.0491, weighted_loss: 0.0304, label: 2, bag_size: 371
batch 500, loss: 0.5999, instance_loss: 0.2855, weighted_loss: 0.5056, label: 2, bag_size: 463
batch 600, loss: 0.7167, instance_loss: 0.4662, weighted_loss: 0.6415, label: 2, bag_size: 178
batch 700, loss: 0.0700, instance_loss: 0.1290, weighted_loss: 0.0877, label: 2, bag_size: 540
batch 800, loss: 1.2015, instance_loss: 0.5714, weighted_loss: 1.0125, label: 3, bag_size: 756
batch 900, loss: 3.9516, instance_loss: 1.6330, weighted_loss: 3.2560, label: 2, bag_size: 362
batch 1000, loss: 0.1725, instance_loss: 0.1070, weighted_loss: 0.1528, label: 2, bag_size: 1816
batch 1100, loss: 0.0423, instance_loss: 0.1218, weighted_loss: 0.0661, label: 1, bag_size: 2213
batch 1200, loss: 1.4238, instance_loss: 0.7732, weighted_loss: 1.2286, label: 2, bag_size: 1206
batch 1300, loss: 1.1871, instance_loss: 0.7127, weighted_loss: 1.0448, label: 1, bag_size: 517
batch 1400, loss: 0.6794, instance_loss: 0.4434, weighted_loss: 0.6086, label: 2, bag_size: 386
batch 1500, loss: 0.6421, instance_loss: 0.6230, weighted_loss: 0.6364, label: 1, bag_size: 1632
batch 1600, loss: 0.0949, instance_loss: 0.1237, weighted_loss: 0.1036, label: 2, bag_size: 441
batch 1700, loss: 0.1451, instance_loss: 0.1668, weighted_loss: 0.1516, label: 1, bag_size: 706
batch 1800, loss: 0.0854, instance_loss: 0.1848, weighted_loss: 0.1152, label: 2, bag_size: 504
batch 1900, loss: 0.1463, instance_loss: 0.1437, weighted_loss: 0.1455, label: 2, bag_size: 358
batch 2000, loss: 1.0549, instance_loss: 0.5860, weighted_loss: 0.9142, label: 2, bag_size: 30
batch 2100, loss: 0.0657, instance_loss: 0.0719, weighted_loss: 0.0675, label: 1, bag_size: 1110

Instance Classifier Stats
class 0 clustering acc 0.9836549539170507: correct 68305/69440
class 1 clustering acc 0.39360599078341013: correct 6833/17360

Epoch: 62, train_loss: 0.7350, train_clustering_loss:  0.4125, train_error: 0.3143
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6381074168797954, correct coarse 499/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.11673151750972763, correct coarse 30/257 
Overall Accuracy: 0.6857

Val Set, val_loss: 0.7486, val_error: 0.3144, auc: 0.7873
class 0 clustering acc 0.9835464015151515: correct 8309/8448 
class 1 clustering acc 0.42045454545454547: correct 888/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4116

Training for coarse level...
batch 100, loss: 0.1667, instance_loss: 0.1367, weighted_loss: 0.1577, label: 2, bag_size: 534
batch 200, loss: 0.0324, instance_loss: 0.0745, weighted_loss: 0.0450, label: 2, bag_size: 206
batch 300, loss: 0.0918, instance_loss: 0.0968, weighted_loss: 0.0933, label: 2, bag_size: 661
batch 400, loss: 1.5597, instance_loss: 0.8523, weighted_loss: 1.3475, label: 1, bag_size: 315
batch 500, loss: 0.8622, instance_loss: 0.4555, weighted_loss: 0.7402, label: 2, bag_size: 232
batch 600, loss: 0.8802, instance_loss: 0.5388, weighted_loss: 0.7778, label: 2, bag_size: 110
batch 700, loss: 0.0211, instance_loss: 0.0647, weighted_loss: 0.0342, label: 2, bag_size: 474
batch 800, loss: 0.0895, instance_loss: 0.1162, weighted_loss: 0.0975, label: 2, bag_size: 328
batch 900, loss: 0.5088, instance_loss: 0.3381, weighted_loss: 0.4576, label: 2, bag_size: 194
batch 1000, loss: 0.0253, instance_loss: 0.0516, weighted_loss: 0.0332, label: 1, bag_size: 1387
batch 1100, loss: 1.1751, instance_loss: 0.6374, weighted_loss: 1.0138, label: 2, bag_size: 682
batch 1200, loss: 0.2342, instance_loss: 0.1189, weighted_loss: 0.1996, label: 2, bag_size: 622
batch 1300, loss: 3.2837, instance_loss: 1.4690, weighted_loss: 2.7393, label: 1, bag_size: 608
batch 1400, loss: 1.3303, instance_loss: 0.7531, weighted_loss: 1.1571, label: 1, bag_size: 1667
batch 1500, loss: 0.1602, instance_loss: 0.1819, weighted_loss: 0.1667, label: 2, bag_size: 688
batch 1600, loss: 0.1654, instance_loss: 0.0713, weighted_loss: 0.1372, label: 1, bag_size: 1867
batch 1700, loss: 1.2510, instance_loss: 0.5643, weighted_loss: 1.0450, label: 2, bag_size: 325
batch 1800, loss: 0.0241, instance_loss: 0.0487, weighted_loss: 0.0315, label: 2, bag_size: 634
batch 1900, loss: 0.7771, instance_loss: 0.4707, weighted_loss: 0.6852, label: 1, bag_size: 238
batch 2000, loss: 0.0191, instance_loss: 0.0694, weighted_loss: 0.0342, label: 2, bag_size: 705
batch 2100, loss: 0.6974, instance_loss: 0.5243, weighted_loss: 0.6455, label: 1, bag_size: 1049

Instance Classifier Stats
class 0 clustering acc 0.9842453917050691: correct 68346/69440
class 1 clustering acc 0.39550691244239633: correct 6866/17360

Epoch: 63, train_loss: 0.7342, train_clustering_loss:  0.4108, train_error: 0.3124
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6432225063938619, correct coarse 503/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.13618677042801555, correct coarse 35/257 
Overall Accuracy: 0.6876

Val Set, val_loss: 0.7472, val_error: 0.3144, auc: 0.7874
class 0 clustering acc 0.9834280303030303: correct 8308/8448 
class 1 clustering acc 0.4199810606060606: correct 887/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4123

Training for coarse level...
batch 100, loss: 0.0526, instance_loss: 0.0921, weighted_loss: 0.0644, label: 2, bag_size: 815
batch 200, loss: 0.2843, instance_loss: 0.1070, weighted_loss: 0.2311, label: 1, bag_size: 2159
batch 300, loss: 0.0204, instance_loss: 0.1184, weighted_loss: 0.0498, label: 2, bag_size: 337
batch 400, loss: 0.8477, instance_loss: 0.6316, weighted_loss: 0.7829, label: 2, bag_size: 224
batch 500, loss: 0.0808, instance_loss: 0.1380, weighted_loss: 0.0980, label: 2, bag_size: 593
batch 600, loss: 0.6345, instance_loss: 0.4226, weighted_loss: 0.5709, label: 2, bag_size: 483
batch 700, loss: 0.9909, instance_loss: 0.5604, weighted_loss: 0.8618, label: 1, bag_size: 74
batch 800, loss: 1.5175, instance_loss: 0.6815, weighted_loss: 1.2667, label: 3, bag_size: 130
batch 900, loss: 1.0786, instance_loss: 0.4526, weighted_loss: 0.8908, label: 2, bag_size: 742
batch 1000, loss: 1.2703, instance_loss: 0.6031, weighted_loss: 1.0701, label: 1, bag_size: 217
batch 1100, loss: 0.3642, instance_loss: 0.2242, weighted_loss: 0.3222, label: 2, bag_size: 298
batch 1200, loss: 1.0820, instance_loss: 0.7056, weighted_loss: 0.9691, label: 1, bag_size: 823
batch 1300, loss: 1.0605, instance_loss: 0.6141, weighted_loss: 0.9266, label: 3, bag_size: 111
batch 1400, loss: 1.3894, instance_loss: 0.8617, weighted_loss: 1.2311, label: 1, bag_size: 381
batch 1500, loss: 1.2175, instance_loss: 0.7923, weighted_loss: 1.0899, label: 3, bag_size: 2076
batch 1600, loss: 0.0424, instance_loss: 0.0990, weighted_loss: 0.0594, label: 2, bag_size: 295
batch 1700, loss: 1.0738, instance_loss: 0.5921, weighted_loss: 0.9293, label: 1, bag_size: 425
batch 1800, loss: 0.6567, instance_loss: 0.3958, weighted_loss: 0.5784, label: 2, bag_size: 986
batch 1900, loss: 0.0527, instance_loss: 0.1083, weighted_loss: 0.0694, label: 2, bag_size: 389
batch 2000, loss: 0.7678, instance_loss: 0.4117, weighted_loss: 0.6610, label: 2, bag_size: 131
batch 2100, loss: 0.3912, instance_loss: 0.2682, weighted_loss: 0.3543, label: 1, bag_size: 574

Instance Classifier Stats
class 0 clustering acc 0.9839717741935484: correct 68327/69440
class 1 clustering acc 0.39660138248847926: correct 6885/17360

Epoch: 64, train_loss: 0.7332, train_clustering_loss:  0.4113, train_error: 0.3120
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6368286445012787, correct coarse 498/782 
coarse class 2: coarse acc 0.8831646734130635, correct coarse 960/1087 
coarse class 3: coarse acc 0.13618677042801555, correct coarse 35/257 
Overall Accuracy: 0.6880

Val Set, val_loss: 0.7480, val_error: 0.3106, auc: 0.7871
class 0 clustering acc 0.9837831439393939: correct 8311/8448 
class 1 clustering acc 0.42329545454545453: correct 894/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6894
Overall F1 Score: 0.4141

Training for coarse level...
batch 100, loss: 3.5422, instance_loss: 0.8926, weighted_loss: 2.7473, label: 0, bag_size: 207
batch 200, loss: 1.4298, instance_loss: 0.6948, weighted_loss: 1.2093, label: 3, bag_size: 574
batch 300, loss: 0.7037, instance_loss: 0.5277, weighted_loss: 0.6509, label: 1, bag_size: 421
batch 400, loss: 0.1103, instance_loss: 0.1405, weighted_loss: 0.1194, label: 1, bag_size: 2214
batch 500, loss: 0.0113, instance_loss: 0.0662, weighted_loss: 0.0278, label: 1, bag_size: 88
batch 600, loss: 0.6444, instance_loss: 0.4318, weighted_loss: 0.5806, label: 1, bag_size: 862
batch 700, loss: 1.0009, instance_loss: 0.4763, weighted_loss: 0.8435, label: 2, bag_size: 390
batch 800, loss: 0.8208, instance_loss: 0.4997, weighted_loss: 0.7245, label: 1, bag_size: 823
batch 900, loss: 0.1113, instance_loss: 0.2074, weighted_loss: 0.1401, label: 2, bag_size: 132
batch 1000, loss: 0.2813, instance_loss: 0.2327, weighted_loss: 0.2668, label: 2, bag_size: 339
batch 1100, loss: 0.0346, instance_loss: 0.1524, weighted_loss: 0.0699, label: 1, bag_size: 687
batch 1200, loss: 0.1079, instance_loss: 0.1093, weighted_loss: 0.1083, label: 2, bag_size: 1211
batch 1300, loss: 1.4122, instance_loss: 0.6942, weighted_loss: 1.1968, label: 3, bag_size: 415
batch 1400, loss: 0.0448, instance_loss: 0.2086, weighted_loss: 0.0940, label: 1, bag_size: 650
batch 1500, loss: 4.2085, instance_loss: 1.2190, weighted_loss: 3.3117, label: 0, bag_size: 432
batch 1600, loss: 1.6193, instance_loss: 0.8886, weighted_loss: 1.4001, label: 1, bag_size: 315
batch 1700, loss: 0.3312, instance_loss: 0.4280, weighted_loss: 0.3602, label: 2, bag_size: 541
batch 1800, loss: 0.2002, instance_loss: 0.1941, weighted_loss: 0.1984, label: 1, bag_size: 725
batch 1900, loss: 0.1061, instance_loss: 0.1706, weighted_loss: 0.1255, label: 1, bag_size: 1423
batch 2000, loss: 0.6914, instance_loss: 0.3403, weighted_loss: 0.5861, label: 2, bag_size: 654
batch 2100, loss: 1.0643, instance_loss: 0.7130, weighted_loss: 0.9589, label: 1, bag_size: 1324

Instance Classifier Stats
class 0 clustering acc 0.9840869815668203: correct 68335/69440
class 1 clustering acc 0.39475806451612905: correct 6853/17360

Epoch: 65, train_loss: 0.7320, train_clustering_loss:  0.4110, train_error: 0.3124
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6876

Val Set, val_loss: 0.7474, val_error: 0.3106, auc: 0.7870
class 0 clustering acc 0.9833096590909091: correct 8307/8448 
class 1 clustering acc 0.4251893939393939: correct 898/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6894
Overall F1 Score: 0.4141

Training for coarse level...
batch 100, loss: 1.6835, instance_loss: 0.8031, weighted_loss: 1.4194, label: 3, bag_size: 751
batch 200, loss: 4.0144, instance_loss: 1.1873, weighted_loss: 3.1663, label: 3, bag_size: 393
batch 300, loss: 0.0347, instance_loss: 0.0798, weighted_loss: 0.0482, label: 2, bag_size: 208
batch 400, loss: 1.3099, instance_loss: 0.8481, weighted_loss: 1.1713, label: 3, bag_size: 160
batch 500, loss: 0.7632, instance_loss: 0.4180, weighted_loss: 0.6596, label: 2, bag_size: 522
batch 600, loss: 0.2797, instance_loss: 0.2654, weighted_loss: 0.2754, label: 1, bag_size: 605
batch 700, loss: 4.7858, instance_loss: 2.0840, weighted_loss: 3.9753, label: 3, bag_size: 1875
batch 800, loss: 0.1288, instance_loss: 0.1481, weighted_loss: 0.1346, label: 2, bag_size: 667
batch 900, loss: 0.7327, instance_loss: 0.4808, weighted_loss: 0.6571, label: 2, bag_size: 526
batch 1000, loss: 0.4917, instance_loss: 0.2797, weighted_loss: 0.4281, label: 2, bag_size: 636
batch 1100, loss: 0.0475, instance_loss: 0.0529, weighted_loss: 0.0491, label: 1, bag_size: 534
batch 1200, loss: 0.5076, instance_loss: 0.2477, weighted_loss: 0.4296, label: 2, bag_size: 559
batch 1300, loss: 0.3321, instance_loss: 0.2018, weighted_loss: 0.2930, label: 2, bag_size: 1214
batch 1400, loss: 1.2284, instance_loss: 0.8004, weighted_loss: 1.1000, label: 1, bag_size: 631
batch 1500, loss: 0.8342, instance_loss: 0.5765, weighted_loss: 0.7569, label: 2, bag_size: 275
batch 1600, loss: 1.5979, instance_loss: 0.8623, weighted_loss: 1.3772, label: 3, bag_size: 901
batch 1700, loss: 0.0263, instance_loss: 0.0605, weighted_loss: 0.0366, label: 2, bag_size: 371
batch 1800, loss: 1.5588, instance_loss: 0.6752, weighted_loss: 1.2937, label: 3, bag_size: 748
batch 1900, loss: 0.0901, instance_loss: 0.1569, weighted_loss: 0.1102, label: 2, bag_size: 387
batch 2000, loss: 1.0506, instance_loss: 0.5664, weighted_loss: 0.9053, label: 2, bag_size: 242
batch 2100, loss: 0.1297, instance_loss: 0.1302, weighted_loss: 0.1299, label: 2, bag_size: 603

Instance Classifier Stats
class 0 clustering acc 0.9837269585253456: correct 68310/69440
class 1 clustering acc 0.3978110599078341: correct 6906/17360

Epoch: 66, train_loss: 0.7308, train_clustering_loss:  0.4105, train_error: 0.3097
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.890524379024839, correct coarse 968/1087 
coarse class 3: coarse acc 0.11673151750972763, correct coarse 30/257 
Overall Accuracy: 0.6903

Val Set, val_loss: 0.7491, val_error: 0.3068, auc: 0.7880
class 0 clustering acc 0.9833096590909091: correct 8307/8448 
class 1 clustering acc 0.4228219696969697: correct 893/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4159

Training for coarse level...
batch 100, loss: 0.2400, instance_loss: 0.2351, weighted_loss: 0.2386, label: 1, bag_size: 943
batch 200, loss: 0.0238, instance_loss: 0.0426, weighted_loss: 0.0294, label: 1, bag_size: 418
batch 300, loss: 0.0670, instance_loss: 0.1349, weighted_loss: 0.0873, label: 2, bag_size: 468
batch 400, loss: 0.1961, instance_loss: 0.2073, weighted_loss: 0.1995, label: 1, bag_size: 725
batch 500, loss: 0.9085, instance_loss: 0.5044, weighted_loss: 0.7873, label: 2, bag_size: 125
batch 600, loss: 0.0139, instance_loss: 0.2472, weighted_loss: 0.0839, label: 1, bag_size: 1067
batch 700, loss: 0.0474, instance_loss: 0.1096, weighted_loss: 0.0661, label: 2, bag_size: 238
batch 800, loss: 1.5835, instance_loss: 0.9666, weighted_loss: 1.3984, label: 0, bag_size: 1736
batch 900, loss: 1.4554, instance_loss: 0.7539, weighted_loss: 1.2450, label: 3, bag_size: 118
batch 1000, loss: 0.1054, instance_loss: 0.1659, weighted_loss: 0.1236, label: 1, bag_size: 1384
batch 1100, loss: 1.6931, instance_loss: 0.7334, weighted_loss: 1.4052, label: 3, bag_size: 285
batch 1200, loss: 1.2187, instance_loss: 0.6251, weighted_loss: 1.0406, label: 3, bag_size: 707
batch 1300, loss: 0.0925, instance_loss: 0.2367, weighted_loss: 0.1358, label: 1, bag_size: 3332
batch 1400, loss: 1.5128, instance_loss: 0.8110, weighted_loss: 1.3022, label: 1, bag_size: 366
batch 1500, loss: 0.7068, instance_loss: 0.4713, weighted_loss: 0.6362, label: 2, bag_size: 448
batch 1600, loss: 1.4122, instance_loss: 0.5717, weighted_loss: 1.1601, label: 1, bag_size: 179
batch 1700, loss: 0.8651, instance_loss: 0.5371, weighted_loss: 0.7667, label: 1, bag_size: 762
batch 1800, loss: 0.2119, instance_loss: 0.1977, weighted_loss: 0.2076, label: 2, bag_size: 329
batch 1900, loss: 0.0939, instance_loss: 0.1042, weighted_loss: 0.0970, label: 2, bag_size: 305
batch 2000, loss: 0.1277, instance_loss: 0.1506, weighted_loss: 0.1346, label: 2, bag_size: 974
batch 2100, loss: 0.5635, instance_loss: 0.4160, weighted_loss: 0.5193, label: 1, bag_size: 862

Instance Classifier Stats
class 0 clustering acc 0.9837845622119815: correct 68314/69440
class 1 clustering acc 0.39896313364055297: correct 6926/17360

Epoch: 67, train_loss: 0.7309, train_clustering_loss:  0.4103, train_error: 0.3083
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.8868445262189513, correct coarse 964/1087 
coarse class 3: coarse acc 0.11673151750972763, correct coarse 30/257 
Overall Accuracy: 0.6917

Val Set, val_loss: 0.7478, val_error: 0.3068, auc: 0.7886
class 0 clustering acc 0.9834280303030303: correct 8308/8448 
class 1 clustering acc 0.421875: correct 891/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4165

Training for coarse level...
batch 100, loss: 1.5929, instance_loss: 0.6161, weighted_loss: 1.2998, label: 1, bag_size: 119
batch 200, loss: 0.7508, instance_loss: 0.5572, weighted_loss: 0.6927, label: 2, bag_size: 701
batch 300, loss: 0.8648, instance_loss: 0.5602, weighted_loss: 0.7734, label: 1, bag_size: 762
batch 400, loss: 0.0503, instance_loss: 0.1172, weighted_loss: 0.0704, label: 2, bag_size: 1257
batch 500, loss: 0.4631, instance_loss: 0.3765, weighted_loss: 0.4372, label: 2, bag_size: 334
batch 600, loss: 1.0834, instance_loss: 0.5536, weighted_loss: 0.9245, label: 1, bag_size: 472
batch 700, loss: 0.7392, instance_loss: 0.5071, weighted_loss: 0.6695, label: 1, bag_size: 204
batch 800, loss: 0.5391, instance_loss: 0.2774, weighted_loss: 0.4606, label: 2, bag_size: 377
batch 900, loss: 1.0964, instance_loss: 0.4821, weighted_loss: 0.9121, label: 1, bag_size: 405
batch 1000, loss: 0.9117, instance_loss: 0.5004, weighted_loss: 0.7883, label: 2, bag_size: 350
batch 1100, loss: 0.2764, instance_loss: 0.3162, weighted_loss: 0.2883, label: 1, bag_size: 497
batch 1200, loss: 1.2092, instance_loss: 0.7441, weighted_loss: 1.0697, label: 1, bag_size: 449
batch 1300, loss: 0.8803, instance_loss: 0.4918, weighted_loss: 0.7637, label: 1, bag_size: 766
batch 1400, loss: 1.2214, instance_loss: 0.6782, weighted_loss: 1.0585, label: 3, bag_size: 618
batch 1500, loss: 0.0393, instance_loss: 0.0760, weighted_loss: 0.0503, label: 1, bag_size: 185
batch 1600, loss: 0.4968, instance_loss: 0.4083, weighted_loss: 0.4703, label: 2, bag_size: 256
batch 1700, loss: 0.3020, instance_loss: 0.2852, weighted_loss: 0.2969, label: 1, bag_size: 354
batch 1800, loss: 0.1802, instance_loss: 0.3339, weighted_loss: 0.2263, label: 1, bag_size: 1087
batch 1900, loss: 0.0810, instance_loss: 0.1955, weighted_loss: 0.1153, label: 2, bag_size: 460
batch 2000, loss: 1.1372, instance_loss: 0.5837, weighted_loss: 0.9712, label: 2, bag_size: 2023
batch 2100, loss: 0.6923, instance_loss: 0.4723, weighted_loss: 0.6263, label: 2, bag_size: 233

Instance Classifier Stats
class 0 clustering acc 0.9841445852534563: correct 68339/69440
class 1 clustering acc 0.3967165898617512: correct 6887/17360

Epoch: 68, train_loss: 0.7304, train_clustering_loss:  0.4099, train_error: 0.3124
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6419437340153452, correct coarse 502/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.1245136186770428, correct coarse 32/257 
Overall Accuracy: 0.6876

Val Set, val_loss: 0.7470, val_error: 0.3068, auc: 0.7885
class 0 clustering acc 0.9833096590909091: correct 8307/8448 
class 1 clustering acc 0.42329545454545453: correct 894/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4165

Training for coarse level...
batch 100, loss: 0.0410, instance_loss: 0.0574, weighted_loss: 0.0459, label: 1, bag_size: 897
batch 200, loss: 0.1827, instance_loss: 0.1730, weighted_loss: 0.1798, label: 2, bag_size: 329
batch 300, loss: 0.9107, instance_loss: 0.5182, weighted_loss: 0.7929, label: 2, bag_size: 1149
batch 400, loss: 0.0805, instance_loss: 0.2329, weighted_loss: 0.1262, label: 1, bag_size: 490
batch 500, loss: 1.7574, instance_loss: 0.8533, weighted_loss: 1.4862, label: 0, bag_size: 277
batch 600, loss: 0.7507, instance_loss: 0.5893, weighted_loss: 0.7023, label: 1, bag_size: 421
batch 700, loss: 0.4111, instance_loss: 0.3744, weighted_loss: 0.4001, label: 2, bag_size: 351
batch 800, loss: 0.9334, instance_loss: 0.5824, weighted_loss: 0.8281, label: 3, bag_size: 321
batch 900, loss: 0.0628, instance_loss: 0.0881, weighted_loss: 0.0704, label: 2, bag_size: 866
batch 1000, loss: 0.0311, instance_loss: 0.1095, weighted_loss: 0.0546, label: 1, bag_size: 2131
batch 1100, loss: 0.0181, instance_loss: 0.0600, weighted_loss: 0.0307, label: 2, bag_size: 451
batch 1200, loss: 0.7574, instance_loss: 0.6482, weighted_loss: 0.7246, label: 3, bag_size: 461
batch 1300, loss: 0.2087, instance_loss: 0.1522, weighted_loss: 0.1917, label: 2, bag_size: 229
batch 1400, loss: 0.0975, instance_loss: 0.1538, weighted_loss: 0.1144, label: 2, bag_size: 239
batch 1500, loss: 0.1757, instance_loss: 0.1786, weighted_loss: 0.1765, label: 2, bag_size: 240
batch 1600, loss: 0.9981, instance_loss: 0.5242, weighted_loss: 0.8559, label: 1, bag_size: 592
batch 1700, loss: 3.2735, instance_loss: 1.5688, weighted_loss: 2.7621, label: 3, bag_size: 289
batch 1800, loss: 1.2878, instance_loss: 0.6096, weighted_loss: 1.0844, label: 1, bag_size: 301
batch 1900, loss: 0.0123, instance_loss: 0.0500, weighted_loss: 0.0236, label: 1, bag_size: 2272
batch 2000, loss: 0.0388, instance_loss: 0.1164, weighted_loss: 0.0621, label: 2, bag_size: 728
batch 2100, loss: 0.4938, instance_loss: 0.6386, weighted_loss: 0.5373, label: 1, bag_size: 635

Instance Classifier Stats
class 0 clustering acc 0.9837413594470046: correct 68311/69440
class 1 clustering acc 0.3970046082949309: correct 6892/17360

Epoch: 69, train_loss: 0.7283, train_clustering_loss:  0.4101, train_error: 0.3124
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.639386189258312, correct coarse 500/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
Overall Accuracy: 0.6876

Val Set, val_loss: 0.7466, val_error: 0.3068, auc: 0.7887
class 0 clustering acc 0.9836647727272727: correct 8310/8448 
class 1 clustering acc 0.421875: correct 891/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4162

Training for coarse level...
batch 100, loss: 0.0711, instance_loss: 0.0869, weighted_loss: 0.0758, label: 2, bag_size: 435
batch 200, loss: 0.1781, instance_loss: 0.1923, weighted_loss: 0.1823, label: 2, bag_size: 346
batch 300, loss: 0.1075, instance_loss: 0.2828, weighted_loss: 0.1601, label: 1, bag_size: 112
batch 400, loss: 0.5268, instance_loss: 0.3269, weighted_loss: 0.4668, label: 2, bag_size: 408
batch 500, loss: 0.4524, instance_loss: 0.4515, weighted_loss: 0.4521, label: 2, bag_size: 275
batch 600, loss: 0.0535, instance_loss: 0.0661, weighted_loss: 0.0573, label: 2, bag_size: 525
batch 700, loss: 0.0396, instance_loss: 0.0530, weighted_loss: 0.0436, label: 2, bag_size: 246
batch 800, loss: 0.8391, instance_loss: 0.4368, weighted_loss: 0.7184, label: 2, bag_size: 232
batch 900, loss: 0.9970, instance_loss: 0.5831, weighted_loss: 0.8728, label: 3, bag_size: 207
batch 1000, loss: 2.1383, instance_loss: 0.8997, weighted_loss: 1.7667, label: 1, bag_size: 339
batch 1100, loss: 0.1801, instance_loss: 0.5106, weighted_loss: 0.2792, label: 2, bag_size: 11
batch 1200, loss: 1.0747, instance_loss: 0.7251, weighted_loss: 0.9698, label: 3, bag_size: 386
batch 1300, loss: 0.4111, instance_loss: 0.4241, weighted_loss: 0.4150, label: 2, bag_size: 271
batch 1400, loss: 1.5188, instance_loss: 0.6025, weighted_loss: 1.2439, label: 1, bag_size: 334
batch 1500, loss: 1.0849, instance_loss: 0.5886, weighted_loss: 0.9360, label: 1, bag_size: 425
batch 1600, loss: 0.7576, instance_loss: 0.5115, weighted_loss: 0.6838, label: 2, bag_size: 526
batch 1700, loss: 0.9936, instance_loss: 0.6296, weighted_loss: 0.8844, label: 3, bag_size: 209
batch 1800, loss: 0.6318, instance_loss: 0.3665, weighted_loss: 0.5522, label: 2, bag_size: 1122
batch 1900, loss: 0.1755, instance_loss: 0.1482, weighted_loss: 0.1673, label: 2, bag_size: 629
batch 2000, loss: 0.5079, instance_loss: 0.2890, weighted_loss: 0.4422, label: 2, bag_size: 358
batch 2100, loss: 0.2839, instance_loss: 0.2228, weighted_loss: 0.2656, label: 2, bag_size: 339

Instance Classifier Stats
class 0 clustering acc 0.9839573732718894: correct 68326/69440
class 1 clustering acc 0.3961405529953917: correct 6877/17360

Epoch: 70, train_loss: 0.7280, train_clustering_loss:  0.4095, train_error: 0.3120
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6432225063938619, correct coarse 503/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.1245136186770428, correct coarse 32/257 
Overall Accuracy: 0.6880

Val Set, val_loss: 0.7460, val_error: 0.3068, auc: 0.7886
class 0 clustering acc 0.9835464015151515: correct 8309/8448 
class 1 clustering acc 0.4237689393939394: correct 895/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4165

Training for coarse level...
batch 100, loss: 0.0763, instance_loss: 0.2002, weighted_loss: 0.1135, label: 2, bag_size: 278
batch 200, loss: 0.0595, instance_loss: 0.0790, weighted_loss: 0.0654, label: 2, bag_size: 620
batch 300, loss: 0.9478, instance_loss: 0.4796, weighted_loss: 0.8073, label: 1, bag_size: 267
batch 400, loss: 0.9733, instance_loss: 0.6867, weighted_loss: 0.8873, label: 1, bag_size: 566
batch 500, loss: 1.8873, instance_loss: 0.8768, weighted_loss: 1.5842, label: 3, bag_size: 310
batch 600, loss: 0.1528, instance_loss: 0.1950, weighted_loss: 0.1655, label: 2, bag_size: 307
batch 700, loss: 0.3996, instance_loss: 0.2394, weighted_loss: 0.3515, label: 1, bag_size: 602
batch 800, loss: 1.6542, instance_loss: 0.8182, weighted_loss: 1.4034, label: 3, bag_size: 521
batch 900, loss: 0.2828, instance_loss: 0.2672, weighted_loss: 0.2781, label: 2, bag_size: 236
batch 1000, loss: 0.1074, instance_loss: 0.1258, weighted_loss: 0.1129, label: 1, bag_size: 248
batch 1100, loss: 0.9991, instance_loss: 0.4944, weighted_loss: 0.8477, label: 2, bag_size: 190
batch 1200, loss: 0.0287, instance_loss: 0.0902, weighted_loss: 0.0472, label: 2, bag_size: 756
batch 1300, loss: 0.7216, instance_loss: 0.4482, weighted_loss: 0.6395, label: 2, bag_size: 146
batch 1400, loss: 0.9430, instance_loss: 0.5227, weighted_loss: 0.8169, label: 2, bag_size: 336
batch 1500, loss: 0.8560, instance_loss: 0.4079, weighted_loss: 0.7215, label: 2, bag_size: 696
batch 1600, loss: 0.8245, instance_loss: 0.5158, weighted_loss: 0.7319, label: 2, bag_size: 1549
batch 1700, loss: 1.4291, instance_loss: 0.6952, weighted_loss: 1.2089, label: 3, bag_size: 574
batch 1800, loss: 1.0082, instance_loss: 0.5076, weighted_loss: 0.8580, label: 2, bag_size: 338
batch 1900, loss: 1.3642, instance_loss: 0.7033, weighted_loss: 1.1660, label: 3, bag_size: 347
batch 2000, loss: 0.0202, instance_loss: 0.0340, weighted_loss: 0.0244, label: 2, bag_size: 448
batch 2100, loss: 0.1248, instance_loss: 0.2254, weighted_loss: 0.1550, label: 2, bag_size: 656

Instance Classifier Stats
class 0 clustering acc 0.9844614055299539: correct 68361/69440
class 1 clustering acc 0.3959101382488479: correct 6873/17360

Epoch: 71, train_loss: 0.7265, train_clustering_loss:  0.4092, train_error: 0.3111
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6572890025575447, correct coarse 514/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
Overall Accuracy: 0.6889

Val Set, val_loss: 0.7451, val_error: 0.3182, auc: 0.7890
class 0 clustering acc 0.9829545454545454: correct 8304/8448 
class 1 clustering acc 0.4275568181818182: correct 903/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4098

Training for coarse level...
batch 100, loss: 0.1936, instance_loss: 0.2444, weighted_loss: 0.2088, label: 2, bag_size: 368
batch 200, loss: 0.5752, instance_loss: 0.5331, weighted_loss: 0.5626, label: 2, bag_size: 406
batch 300, loss: 0.6596, instance_loss: 0.3435, weighted_loss: 0.5648, label: 2, bag_size: 1048
batch 400, loss: 1.4206, instance_loss: 0.6609, weighted_loss: 1.1927, label: 1, bag_size: 544
batch 500, loss: 0.0492, instance_loss: 0.0560, weighted_loss: 0.0512, label: 1, bag_size: 1216
batch 600, loss: 0.1186, instance_loss: 0.1166, weighted_loss: 0.1180, label: 2, bag_size: 607
batch 700, loss: 0.1823, instance_loss: 0.3313, weighted_loss: 0.2270, label: 2, bag_size: 585
batch 800, loss: 0.9950, instance_loss: 0.5867, weighted_loss: 0.8725, label: 2, bag_size: 30
batch 900, loss: 1.2739, instance_loss: 0.5521, weighted_loss: 1.0574, label: 1, bag_size: 681
batch 1000, loss: 0.3348, instance_loss: 0.2485, weighted_loss: 0.3089, label: 2, bag_size: 335
batch 1100, loss: 0.0361, instance_loss: 0.0869, weighted_loss: 0.0513, label: 2, bag_size: 728
batch 1200, loss: 0.9328, instance_loss: 0.7192, weighted_loss: 0.8687, label: 3, bag_size: 149
batch 1300, loss: 0.4780, instance_loss: 0.3295, weighted_loss: 0.4334, label: 2, bag_size: 194
batch 1400, loss: 0.7804, instance_loss: 0.4180, weighted_loss: 0.6717, label: 1, bag_size: 501
batch 1500, loss: 1.2127, instance_loss: 0.7027, weighted_loss: 1.0597, label: 3, bag_size: 229
batch 1600, loss: 1.0990, instance_loss: 0.4907, weighted_loss: 0.9165, label: 2, bag_size: 187
batch 1700, loss: 0.0520, instance_loss: 0.0460, weighted_loss: 0.0502, label: 1, bag_size: 1981
batch 1800, loss: 0.2369, instance_loss: 0.2441, weighted_loss: 0.2391, label: 1, bag_size: 936
batch 1900, loss: 1.2226, instance_loss: 0.8110, weighted_loss: 1.0991, label: 2, bag_size: 182
batch 2000, loss: 0.0528, instance_loss: 0.0660, weighted_loss: 0.0568, label: 2, bag_size: 467
batch 2100, loss: 1.0770, instance_loss: 0.4576, weighted_loss: 0.8912, label: 1, bag_size: 779

Instance Classifier Stats
class 0 clustering acc 0.9836837557603687: correct 68307/69440
class 1 clustering acc 0.39792626728110597: correct 6908/17360

Epoch: 72, train_loss: 0.7260, train_clustering_loss:  0.4086, train_error: 0.3097
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6406649616368286, correct coarse 501/782 
coarse class 2: coarse acc 0.8877644894204232, correct coarse 965/1087 
coarse class 3: coarse acc 0.1245136186770428, correct coarse 32/257 
Overall Accuracy: 0.6903

Val Set, val_loss: 0.7453, val_error: 0.3144, auc: 0.7889
class 0 clustering acc 0.9828361742424242: correct 8303/8448 
class 1 clustering acc 0.4275568181818182: correct 903/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4119

Training for coarse level...
batch 100, loss: 0.4160, instance_loss: 0.3274, weighted_loss: 0.3894, label: 2, bag_size: 364
batch 200, loss: 1.1513, instance_loss: 0.4224, weighted_loss: 0.9326, label: 2, bag_size: 359
batch 300, loss: 1.0049, instance_loss: 0.4676, weighted_loss: 0.8437, label: 2, bag_size: 151
batch 400, loss: 1.2248, instance_loss: 0.6344, weighted_loss: 1.0477, label: 3, bag_size: 229
batch 500, loss: 2.1796, instance_loss: 1.0796, weighted_loss: 1.8496, label: 3, bag_size: 1105
batch 600, loss: 0.0267, instance_loss: 0.0647, weighted_loss: 0.0381, label: 1, bag_size: 2818
batch 700, loss: 0.0288, instance_loss: 0.0809, weighted_loss: 0.0444, label: 2, bag_size: 323
batch 800, loss: 0.0351, instance_loss: 0.1030, weighted_loss: 0.0554, label: 2, bag_size: 444
batch 900, loss: 0.9931, instance_loss: 0.4748, weighted_loss: 0.8376, label: 1, bag_size: 202
batch 1000, loss: 1.3999, instance_loss: 0.8029, weighted_loss: 1.2208, label: 2, bag_size: 1206
batch 1100, loss: 0.1156, instance_loss: 0.1708, weighted_loss: 0.1321, label: 2, bag_size: 600
batch 1200, loss: 0.4272, instance_loss: 0.2202, weighted_loss: 0.3651, label: 2, bag_size: 873
batch 1300, loss: 0.0382, instance_loss: 0.0790, weighted_loss: 0.0504, label: 2, bag_size: 334
batch 1400, loss: 4.9261, instance_loss: 1.7191, weighted_loss: 3.9640, label: 1, bag_size: 477
batch 1500, loss: 0.6108, instance_loss: 0.5863, weighted_loss: 0.6034, label: 2, bag_size: 104
batch 1600, loss: 1.6499, instance_loss: 0.6529, weighted_loss: 1.3508, label: 0, bag_size: 37
batch 1700, loss: 1.0461, instance_loss: 0.6724, weighted_loss: 0.9340, label: 1, bag_size: 823
batch 1800, loss: 1.4670, instance_loss: 0.6670, weighted_loss: 1.2270, label: 3, bag_size: 663
batch 1900, loss: 0.0406, instance_loss: 0.0701, weighted_loss: 0.0494, label: 2, bag_size: 393
batch 2000, loss: 1.8011, instance_loss: 0.7846, weighted_loss: 1.4961, label: 1, bag_size: 78
batch 2100, loss: 0.2476, instance_loss: 0.4811, weighted_loss: 0.3176, label: 1, bag_size: 1628

Instance Classifier Stats
class 0 clustering acc 0.9842741935483871: correct 68348/69440
class 1 clustering acc 0.39890552995391704: correct 6925/17360

Epoch: 73, train_loss: 0.7249, train_clustering_loss:  0.4077, train_error: 0.3120
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6317135549872123, correct coarse 494/782 
coarse class 2: coarse acc 0.8850045998160073, correct coarse 962/1087 
coarse class 3: coarse acc 0.14396887159533073, correct coarse 37/257 
Overall Accuracy: 0.6880

Val Set, val_loss: 0.7472, val_error: 0.3068, auc: 0.7888
class 0 clustering acc 0.9835464015151515: correct 8309/8448 
class 1 clustering acc 0.42613636363636365: correct 900/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4159

Training for coarse level...
batch 100, loss: 0.9618, instance_loss: 0.6377, weighted_loss: 0.8646, label: 3, bag_size: 888
batch 200, loss: 1.7996, instance_loss: 0.6793, weighted_loss: 1.4635, label: 2, bag_size: 201
batch 300, loss: 0.4002, instance_loss: 0.3596, weighted_loss: 0.3880, label: 2, bag_size: 346
batch 400, loss: 1.0016, instance_loss: 0.4736, weighted_loss: 0.8432, label: 2, bag_size: 1355
batch 500, loss: 0.9466, instance_loss: 0.6289, weighted_loss: 0.8513, label: 3, bag_size: 258
batch 600, loss: 1.7258, instance_loss: 0.8069, weighted_loss: 1.4501, label: 1, bag_size: 234
batch 700, loss: 0.5516, instance_loss: 0.1982, weighted_loss: 0.4456, label: 2, bag_size: 721
batch 800, loss: 1.3518, instance_loss: 0.6811, weighted_loss: 1.1506, label: 3, bag_size: 492
batch 900, loss: 1.5281, instance_loss: 0.8407, weighted_loss: 1.3219, label: 3, bag_size: 829
batch 1000, loss: 0.0852, instance_loss: 0.1359, weighted_loss: 0.1004, label: 2, bag_size: 330
batch 1100, loss: 0.2235, instance_loss: 0.3090, weighted_loss: 0.2492, label: 1, bag_size: 53
batch 1200, loss: 1.2955, instance_loss: 0.6066, weighted_loss: 1.0888, label: 1, bag_size: 169
batch 1300, loss: 0.0727, instance_loss: 0.1220, weighted_loss: 0.0875, label: 2, bag_size: 745
batch 1400, loss: 0.0688, instance_loss: 0.0911, weighted_loss: 0.0755, label: 1, bag_size: 263
batch 1500, loss: 0.3051, instance_loss: 0.2560, weighted_loss: 0.2904, label: 2, bag_size: 249
batch 1600, loss: 0.1825, instance_loss: 0.2319, weighted_loss: 0.1973, label: 1, bag_size: 589
batch 1700, loss: 0.7525, instance_loss: 0.5365, weighted_loss: 0.6877, label: 2, bag_size: 188
batch 1800, loss: 0.9832, instance_loss: 0.5397, weighted_loss: 0.8501, label: 2, bag_size: 373
batch 1900, loss: 0.0669, instance_loss: 0.1066, weighted_loss: 0.0788, label: 1, bag_size: 1803
batch 2000, loss: 0.2722, instance_loss: 0.2598, weighted_loss: 0.2685, label: 2, bag_size: 393
batch 2100, loss: 1.0356, instance_loss: 0.5773, weighted_loss: 0.8981, label: 2, bag_size: 274

Instance Classifier Stats
class 0 clustering acc 0.9846630184331797: correct 68375/69440
class 1 clustering acc 0.39660138248847926: correct 6885/17360

Epoch: 74, train_loss: 0.7244, train_clustering_loss:  0.4084, train_error: 0.3115
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6470588235294118, correct coarse 506/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6885

Val Set, val_loss: 0.7454, val_error: 0.3144, auc: 0.7894
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.4285037878787879: correct 905/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4119

Training for coarse level...
batch 100, loss: 0.8663, instance_loss: 0.4511, weighted_loss: 0.7417, label: 2, bag_size: 604
batch 200, loss: 0.0620, instance_loss: 0.1573, weighted_loss: 0.0906, label: 1, bag_size: 128
batch 300, loss: 0.0541, instance_loss: 0.0760, weighted_loss: 0.0607, label: 2, bag_size: 225
batch 400, loss: 0.3636, instance_loss: 0.3768, weighted_loss: 0.3676, label: 2, bag_size: 740
batch 500, loss: 0.0247, instance_loss: 0.0886, weighted_loss: 0.0439, label: 2, bag_size: 178
batch 600, loss: 1.0864, instance_loss: 0.5398, weighted_loss: 0.9224, label: 2, bag_size: 519
batch 700, loss: 1.1456, instance_loss: 0.6052, weighted_loss: 0.9835, label: 3, bag_size: 479
batch 800, loss: 0.6683, instance_loss: 0.3879, weighted_loss: 0.5842, label: 2, bag_size: 92
batch 900, loss: 1.8098, instance_loss: 0.7520, weighted_loss: 1.4924, label: 3, bag_size: 751
batch 1000, loss: 0.0398, instance_loss: 0.0298, weighted_loss: 0.0368, label: 1, bag_size: 1147
batch 1100, loss: 0.0315, instance_loss: 0.0714, weighted_loss: 0.0435, label: 2, bag_size: 365
batch 1200, loss: 2.5639, instance_loss: 0.8884, weighted_loss: 2.0612, label: 2, bag_size: 1555
batch 1300, loss: 1.2474, instance_loss: 0.6207, weighted_loss: 1.0594, label: 3, bag_size: 307
batch 1400, loss: 0.0826, instance_loss: 0.1548, weighted_loss: 0.1043, label: 1, bag_size: 1827
batch 1500, loss: 0.2352, instance_loss: 0.2205, weighted_loss: 0.2308, label: 2, bag_size: 358
batch 1600, loss: 0.8099, instance_loss: 0.4701, weighted_loss: 0.7079, label: 2, bag_size: 566
batch 1700, loss: 3.5553, instance_loss: 1.5070, weighted_loss: 2.9408, label: 2, bag_size: 3015
batch 1800, loss: 0.0233, instance_loss: 0.2725, weighted_loss: 0.0981, label: 1, bag_size: 1300
batch 1900, loss: 0.4560, instance_loss: 0.2839, weighted_loss: 0.4044, label: 1, bag_size: 333
batch 2000, loss: 0.0869, instance_loss: 0.1170, weighted_loss: 0.0959, label: 1, bag_size: 1075
batch 2100, loss: 0.0845, instance_loss: 0.2273, weighted_loss: 0.1273, label: 1, bag_size: 837

Instance Classifier Stats
class 0 clustering acc 0.9836837557603687: correct 68307/69440
class 1 clustering acc 0.40276497695852537: correct 6992/17360

Epoch: 75, train_loss: 0.7228, train_clustering_loss:  0.4069, train_error: 0.3069
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.8877644894204232, correct coarse 965/1087 
coarse class 3: coarse acc 0.1245136186770428, correct coarse 32/257 
Overall Accuracy: 0.6931

Val Set, val_loss: 0.7457, val_error: 0.3106, auc: 0.7892
class 0 clustering acc 0.9835464015151515: correct 8309/8448 
class 1 clustering acc 0.4266098484848485: correct 901/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6894
Overall F1 Score: 0.4141

Training for coarse level...
batch 100, loss: 0.3884, instance_loss: 0.3187, weighted_loss: 0.3675, label: 2, bag_size: 726
batch 200, loss: 1.3484, instance_loss: 0.7901, weighted_loss: 1.1809, label: 1, bag_size: 366
batch 300, loss: 0.6700, instance_loss: 0.5071, weighted_loss: 0.6211, label: 1, bag_size: 225
batch 400, loss: 0.0987, instance_loss: 0.1100, weighted_loss: 0.1021, label: 1, bag_size: 691
batch 500, loss: 0.8841, instance_loss: 0.5565, weighted_loss: 0.7859, label: 3, bag_size: 487
batch 600, loss: 0.0310, instance_loss: 0.0671, weighted_loss: 0.0418, label: 1, bag_size: 1138
batch 700, loss: 0.1808, instance_loss: 0.1142, weighted_loss: 0.1609, label: 2, bag_size: 225
batch 800, loss: 0.8028, instance_loss: 0.6977, weighted_loss: 0.7713, label: 3, bag_size: 619
batch 900, loss: 0.0129, instance_loss: 0.0592, weighted_loss: 0.0268, label: 1, bag_size: 88
batch 1000, loss: 1.1637, instance_loss: 0.6341, weighted_loss: 1.0048, label: 1, bag_size: 437
batch 1100, loss: 0.0625, instance_loss: 0.0655, weighted_loss: 0.0634, label: 1, bag_size: 2119
batch 1200, loss: 0.8058, instance_loss: 0.5368, weighted_loss: 0.7251, label: 1, bag_size: 248
batch 1300, loss: 0.0177, instance_loss: 0.0657, weighted_loss: 0.0321, label: 2, bag_size: 485
batch 1400, loss: 0.9789, instance_loss: 0.4739, weighted_loss: 0.8274, label: 2, bag_size: 373
batch 1500, loss: 1.1419, instance_loss: 0.6505, weighted_loss: 0.9945, label: 2, bag_size: 509
batch 1600, loss: 0.7676, instance_loss: 0.4770, weighted_loss: 0.6804, label: 2, bag_size: 202
batch 1700, loss: 0.7918, instance_loss: 0.5525, weighted_loss: 0.7200, label: 2, bag_size: 52
batch 1800, loss: 0.1070, instance_loss: 0.2460, weighted_loss: 0.1487, label: 1, bag_size: 3530
batch 1900, loss: 0.3340, instance_loss: 0.3978, weighted_loss: 0.3531, label: 2, bag_size: 108
batch 2000, loss: 0.5729, instance_loss: 0.4237, weighted_loss: 0.5281, label: 2, bag_size: 480
batch 2100, loss: 0.3728, instance_loss: 0.3433, weighted_loss: 0.3639, label: 2, bag_size: 444

Instance Classifier Stats
class 0 clustering acc 0.9839861751152074: correct 68328/69440
class 1 clustering acc 0.39792626728110597: correct 6908/17360

Epoch: 76, train_loss: 0.7220, train_clustering_loss:  0.4085, train_error: 0.3129
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6508951406649617, correct coarse 509/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6871

Val Set, val_loss: 0.7448, val_error: 0.3144, auc: 0.7898
class 0 clustering acc 0.9824810606060606: correct 8300/8448 
class 1 clustering acc 0.42945075757575757: correct 907/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4121

Training for coarse level...
batch 100, loss: 0.1590, instance_loss: 0.1139, weighted_loss: 0.1455, label: 2, bag_size: 229
batch 200, loss: 0.0542, instance_loss: 0.0904, weighted_loss: 0.0651, label: 1, bag_size: 313
batch 300, loss: 1.7078, instance_loss: 0.7754, weighted_loss: 1.4281, label: 3, bag_size: 216
batch 400, loss: 0.2318, instance_loss: 0.1972, weighted_loss: 0.2214, label: 2, bag_size: 358
batch 500, loss: 0.5398, instance_loss: 0.3849, weighted_loss: 0.4933, label: 1, bag_size: 785
batch 600, loss: 0.8859, instance_loss: 0.3814, weighted_loss: 0.7346, label: 2, bag_size: 316
batch 700, loss: 0.0605, instance_loss: 0.0651, weighted_loss: 0.0619, label: 2, bag_size: 537
batch 800, loss: 0.3079, instance_loss: 0.2535, weighted_loss: 0.2916, label: 2, bag_size: 1250
batch 900, loss: 0.0836, instance_loss: 0.2850, weighted_loss: 0.1440, label: 1, bag_size: 3530
batch 1000, loss: 0.7498, instance_loss: 0.5105, weighted_loss: 0.6780, label: 1, bag_size: 356
batch 1100, loss: 0.7853, instance_loss: 0.3938, weighted_loss: 0.6678, label: 2, bag_size: 266
batch 1200, loss: 0.0927, instance_loss: 0.1320, weighted_loss: 0.1045, label: 2, bag_size: 330
batch 1300, loss: 0.0385, instance_loss: 0.0431, weighted_loss: 0.0399, label: 1, bag_size: 897
batch 1400, loss: 0.1444, instance_loss: 0.1713, weighted_loss: 0.1525, label: 2, bag_size: 656
batch 1500, loss: 0.7161, instance_loss: 0.4177, weighted_loss: 0.6266, label: 1, bag_size: 332
batch 1600, loss: 0.0817, instance_loss: 0.1151, weighted_loss: 0.0917, label: 2, bag_size: 1301
batch 1700, loss: 0.6445, instance_loss: 0.7349, weighted_loss: 0.6716, label: 1, bag_size: 265
batch 1800, loss: 0.0795, instance_loss: 0.0858, weighted_loss: 0.0814, label: 2, bag_size: 328
batch 1900, loss: 0.9230, instance_loss: 0.4211, weighted_loss: 0.7724, label: 1, bag_size: 430
batch 2000, loss: 0.9211, instance_loss: 0.5807, weighted_loss: 0.8190, label: 1, bag_size: 501
batch 2100, loss: 0.1188, instance_loss: 0.1884, weighted_loss: 0.1397, label: 2, bag_size: 402

Instance Classifier Stats
class 0 clustering acc 0.9843605990783411: correct 68354/69440
class 1 clustering acc 0.40080645161290324: correct 6958/17360

Epoch: 77, train_loss: 0.7218, train_clustering_loss:  0.4058, train_error: 0.3097
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6419437340153452, correct coarse 502/782 
coarse class 2: coarse acc 0.8850045998160073, correct coarse 962/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6903

Val Set, val_loss: 0.7445, val_error: 0.3182, auc: 0.7892
class 0 clustering acc 0.9830729166666666: correct 8305/8448 
class 1 clustering acc 0.42803030303030304: correct 904/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4094

Training for coarse level...
batch 100, loss: 2.9988, instance_loss: 1.3660, weighted_loss: 2.5089, label: 3, bag_size: 2813
batch 200, loss: 0.7541, instance_loss: 0.3199, weighted_loss: 0.6238, label: 2, bag_size: 729
batch 300, loss: 0.0614, instance_loss: 0.1047, weighted_loss: 0.0744, label: 2, bag_size: 193
batch 400, loss: 0.8097, instance_loss: 0.5282, weighted_loss: 0.7253, label: 1, bag_size: 356
batch 500, loss: 0.0594, instance_loss: 0.1298, weighted_loss: 0.0805, label: 2, bag_size: 533
batch 600, loss: 1.9678, instance_loss: 0.8705, weighted_loss: 1.6386, label: 3, bag_size: 486
batch 700, loss: 0.9809, instance_loss: 0.6024, weighted_loss: 0.8673, label: 2, bag_size: 310
batch 800, loss: 0.1371, instance_loss: 0.1224, weighted_loss: 0.1327, label: 1, bag_size: 2536
batch 900, loss: 0.7847, instance_loss: 0.4291, weighted_loss: 0.6780, label: 1, bag_size: 986
batch 1000, loss: 0.0223, instance_loss: 0.0367, weighted_loss: 0.0266, label: 1, bag_size: 994
batch 1100, loss: 0.9101, instance_loss: 0.4740, weighted_loss: 0.7793, label: 2, bag_size: 639
batch 1200, loss: 0.1534, instance_loss: 0.2358, weighted_loss: 0.1781, label: 1, bag_size: 1470
batch 1300, loss: 1.2055, instance_loss: 0.4861, weighted_loss: 0.9897, label: 2, bag_size: 187
batch 1400, loss: 1.8956, instance_loss: 0.6486, weighted_loss: 1.5215, label: 1, bag_size: 276
batch 1500, loss: 0.7647, instance_loss: 0.4450, weighted_loss: 0.6688, label: 2, bag_size: 1687
batch 1600, loss: 0.0222, instance_loss: 0.0373, weighted_loss: 0.0267, label: 1, bag_size: 454
batch 1700, loss: 0.9792, instance_loss: 0.6290, weighted_loss: 0.8741, label: 1, bag_size: 233
batch 1800, loss: 0.9424, instance_loss: 0.5827, weighted_loss: 0.8345, label: 2, bag_size: 432
batch 1900, loss: 0.0711, instance_loss: 0.1040, weighted_loss: 0.0810, label: 2, bag_size: 665
batch 2000, loss: 0.2291, instance_loss: 0.2342, weighted_loss: 0.2306, label: 2, bag_size: 379
batch 2100, loss: 0.0349, instance_loss: 0.0537, weighted_loss: 0.0405, label: 2, bag_size: 300

Instance Classifier Stats
class 0 clustering acc 0.9840581797235023: correct 68333/69440
class 1 clustering acc 0.40057603686635945: correct 6954/17360

Epoch: 78, train_loss: 0.7210, train_clustering_loss:  0.4067, train_error: 0.3078
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6419437340153452, correct coarse 502/782 
coarse class 2: coarse acc 0.8886844526218951, correct coarse 966/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6922

Val Set, val_loss: 0.7454, val_error: 0.3068, auc: 0.7878
class 0 clustering acc 0.9833096590909091: correct 8307/8448 
class 1 clustering acc 0.4270833333333333: correct 902/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4165

Training for coarse level...
batch 100, loss: 1.5687, instance_loss: 0.7936, weighted_loss: 1.3362, label: 1, bag_size: 98
batch 200, loss: 1.9090, instance_loss: 0.8398, weighted_loss: 1.5882, label: 3, bag_size: 269
batch 300, loss: 0.6032, instance_loss: 0.4025, weighted_loss: 0.5429, label: 2, bag_size: 315
batch 400, loss: 0.1483, instance_loss: 0.1113, weighted_loss: 0.1372, label: 1, bag_size: 1360
batch 500, loss: 0.7311, instance_loss: 0.3366, weighted_loss: 0.6128, label: 2, bag_size: 1010
batch 600, loss: 0.1146, instance_loss: 0.2822, weighted_loss: 0.1649, label: 1, bag_size: 778
batch 700, loss: 0.2187, instance_loss: 0.1693, weighted_loss: 0.2039, label: 1, bag_size: 1374
batch 800, loss: 1.0671, instance_loss: 0.5379, weighted_loss: 0.9083, label: 1, bag_size: 364
batch 900, loss: 0.7655, instance_loss: 0.3736, weighted_loss: 0.6480, label: 2, bag_size: 802
batch 1000, loss: 0.0599, instance_loss: 0.0666, weighted_loss: 0.0619, label: 2, bag_size: 424
batch 1100, loss: 0.1775, instance_loss: 0.2379, weighted_loss: 0.1956, label: 1, bag_size: 1232
batch 1200, loss: 1.8474, instance_loss: 0.9198, weighted_loss: 1.5691, label: 1, bag_size: 359
batch 1300, loss: 0.1473, instance_loss: 0.1913, weighted_loss: 0.1605, label: 2, bag_size: 688
batch 1400, loss: 0.7724, instance_loss: 0.4958, weighted_loss: 0.6894, label: 2, bag_size: 202
batch 1500, loss: 0.0253, instance_loss: 0.0927, weighted_loss: 0.0455, label: 2, bag_size: 178
batch 1600, loss: 0.7473, instance_loss: 0.4244, weighted_loss: 0.6504, label: 2, bag_size: 1655
batch 1700, loss: 0.6245, instance_loss: 0.2495, weighted_loss: 0.5120, label: 1, bag_size: 1667
batch 1800, loss: 1.6941, instance_loss: 0.9320, weighted_loss: 1.4655, label: 3, bag_size: 752
batch 1900, loss: 0.7990, instance_loss: 0.4617, weighted_loss: 0.6978, label: 2, bag_size: 298
batch 2000, loss: 0.5567, instance_loss: 0.2574, weighted_loss: 0.4669, label: 2, bag_size: 510
batch 2100, loss: 1.1430, instance_loss: 0.6758, weighted_loss: 1.0028, label: 1, bag_size: 517

Instance Classifier Stats
class 0 clustering acc 0.9841733870967742: correct 68341/69440
class 1 clustering acc 0.3994815668202765: correct 6935/17360

Epoch: 79, train_loss: 0.7192, train_clustering_loss:  0.4068, train_error: 0.3083
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6917

Val Set, val_loss: 0.7439, val_error: 0.3182, auc: 0.7886
class 0 clustering acc 0.9828361742424242: correct 8303/8448 
class 1 clustering acc 0.4266098484848485: correct 901/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6818
Overall F1 Score: 0.4094

Training for coarse level...
batch 100, loss: 0.0402, instance_loss: 0.0728, weighted_loss: 0.0500, label: 2, bag_size: 368
batch 200, loss: 0.7470, instance_loss: 0.3888, weighted_loss: 0.6395, label: 2, bag_size: 802
batch 300, loss: 0.6751, instance_loss: 0.4143, weighted_loss: 0.5969, label: 2, bag_size: 756
batch 400, loss: 0.4838, instance_loss: 0.4304, weighted_loss: 0.4678, label: 1, bag_size: 1184
batch 500, loss: 2.3864, instance_loss: 0.7948, weighted_loss: 1.9089, label: 3, bag_size: 345
batch 600, loss: 0.0287, instance_loss: 0.0458, weighted_loss: 0.0338, label: 1, bag_size: 1046
batch 700, loss: 0.0475, instance_loss: 0.1566, weighted_loss: 0.0802, label: 1, bag_size: 1346
batch 800, loss: 0.2482, instance_loss: 0.2693, weighted_loss: 0.2545, label: 2, bag_size: 507
batch 900, loss: 0.0197, instance_loss: 0.0401, weighted_loss: 0.0258, label: 2, bag_size: 1049
batch 1000, loss: 2.4191, instance_loss: 1.0539, weighted_loss: 2.0095, label: 3, bag_size: 704
batch 1100, loss: 0.8417, instance_loss: 0.6489, weighted_loss: 0.7839, label: 1, bag_size: 167
batch 1200, loss: 0.0604, instance_loss: 0.0955, weighted_loss: 0.0709, label: 2, bag_size: 505
batch 1300, loss: 0.6105, instance_loss: 0.5161, weighted_loss: 0.5822, label: 2, bag_size: 544
batch 1400, loss: 0.0976, instance_loss: 0.2922, weighted_loss: 0.1560, label: 1, bag_size: 3530
batch 1500, loss: 0.0782, instance_loss: 0.1279, weighted_loss: 0.0931, label: 1, bag_size: 2302
batch 1600, loss: 0.1279, instance_loss: 0.1709, weighted_loss: 0.1408, label: 2, bag_size: 2032
batch 1700, loss: 1.0710, instance_loss: 0.4657, weighted_loss: 0.8894, label: 2, bag_size: 734
batch 1800, loss: 0.0374, instance_loss: 0.0562, weighted_loss: 0.0430, label: 1, bag_size: 310
batch 1900, loss: 0.0524, instance_loss: 0.1306, weighted_loss: 0.0758, label: 1, bag_size: 836
batch 2000, loss: 0.5630, instance_loss: 0.4356, weighted_loss: 0.5248, label: 1, bag_size: 223
batch 2100, loss: 0.8842, instance_loss: 0.4168, weighted_loss: 0.7440, label: 2, bag_size: 193

Instance Classifier Stats
class 0 clustering acc 0.9837269585253456: correct 68310/69440
class 1 clustering acc 0.4014400921658986: correct 6969/17360

Epoch: 80, train_loss: 0.7201, train_clustering_loss:  0.4063, train_error: 0.3083
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6457800511508951, correct coarse 505/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.13618677042801555, correct coarse 35/257 
Overall Accuracy: 0.6917

Val Set, val_loss: 0.7439, val_error: 0.3106, auc: 0.7881
class 0 clustering acc 0.9830729166666666: correct 8305/8448 
class 1 clustering acc 0.42613636363636365: correct 900/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6894
Overall F1 Score: 0.4141

Training for coarse level...
batch 100, loss: 0.2546, instance_loss: 0.2185, weighted_loss: 0.2437, label: 2, bag_size: 1000
batch 200, loss: 1.2355, instance_loss: 0.7958, weighted_loss: 1.1036, label: 3, bag_size: 2218
batch 300, loss: 0.2620, instance_loss: 0.2113, weighted_loss: 0.2468, label: 1, bag_size: 700
batch 400, loss: 0.3666, instance_loss: 0.3240, weighted_loss: 0.3538, label: 2, bag_size: 488
batch 500, loss: 1.3573, instance_loss: 0.7657, weighted_loss: 1.1798, label: 1, bag_size: 366
batch 600, loss: 3.7787, instance_loss: 0.9033, weighted_loss: 2.9161, label: 0, bag_size: 142
batch 700, loss: 0.0316, instance_loss: 0.0545, weighted_loss: 0.0385, label: 2, bag_size: 761
batch 800, loss: 0.0174, instance_loss: 0.0358, weighted_loss: 0.0229, label: 2, bag_size: 861
batch 900, loss: 0.1967, instance_loss: 0.2485, weighted_loss: 0.2123, label: 2, bag_size: 444
batch 1000, loss: 0.7266, instance_loss: 0.3670, weighted_loss: 0.6187, label: 2, bag_size: 270
batch 1100, loss: 0.0982, instance_loss: 0.1678, weighted_loss: 0.1191, label: 2, bag_size: 475
batch 1200, loss: 0.0908, instance_loss: 0.1098, weighted_loss: 0.0965, label: 2, bag_size: 665
batch 1300, loss: 0.0442, instance_loss: 0.0568, weighted_loss: 0.0480, label: 1, bag_size: 534
batch 1400, loss: 0.0709, instance_loss: 0.0552, weighted_loss: 0.0662, label: 2, bag_size: 435
batch 1500, loss: 0.6093, instance_loss: 0.3388, weighted_loss: 0.5282, label: 2, bag_size: 266
batch 1600, loss: 1.0243, instance_loss: 0.5479, weighted_loss: 0.8814, label: 2, bag_size: 1506
batch 1700, loss: 0.1553, instance_loss: 0.1398, weighted_loss: 0.1507, label: 1, bag_size: 1090
batch 1800, loss: 0.3676, instance_loss: 0.3815, weighted_loss: 0.3718, label: 1, bag_size: 385
batch 1900, loss: 0.1357, instance_loss: 0.1714, weighted_loss: 0.1464, label: 2, bag_size: 1248
batch 2000, loss: 2.3077, instance_loss: 0.9779, weighted_loss: 1.9088, label: 1, bag_size: 406
batch 2100, loss: 0.6533, instance_loss: 0.5120, weighted_loss: 0.6109, label: 1, bag_size: 473

Instance Classifier Stats
class 0 clustering acc 0.9841013824884792: correct 68336/69440
class 1 clustering acc 0.3994815668202765: correct 6935/17360

Epoch: 81, train_loss: 0.7181, train_clustering_loss:  0.4056, train_error: 0.3046
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6508951406649617, correct coarse 509/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.1517509727626459, correct coarse 39/257 
Overall Accuracy: 0.6954

Val Set, val_loss: 0.7440, val_error: 0.3144, auc: 0.7876
class 0 clustering acc 0.9829545454545454: correct 8304/8448 
class 1 clustering acc 0.4266098484848485: correct 901/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4116

Training for coarse level...
batch 100, loss: 0.0223, instance_loss: 0.0473, weighted_loss: 0.0298, label: 1, bag_size: 1883
batch 200, loss: 0.2314, instance_loss: 0.2780, weighted_loss: 0.2454, label: 1, bag_size: 936
batch 300, loss: 0.2832, instance_loss: 0.4947, weighted_loss: 0.3467, label: 2, bag_size: 473
batch 400, loss: 0.1901, instance_loss: 0.2154, weighted_loss: 0.1977, label: 1, bag_size: 1523
batch 500, loss: 2.1363, instance_loss: 0.8840, weighted_loss: 1.7606, label: 1, bag_size: 393
batch 600, loss: 0.9522, instance_loss: 0.5218, weighted_loss: 0.8231, label: 2, bag_size: 1506
batch 700, loss: 0.0706, instance_loss: 0.0792, weighted_loss: 0.0732, label: 2, bag_size: 292
batch 800, loss: 0.2196, instance_loss: 0.1892, weighted_loss: 0.2105, label: 1, bag_size: 780
batch 900, loss: 0.6617, instance_loss: 0.3512, weighted_loss: 0.5685, label: 2, bag_size: 317
batch 1000, loss: 0.6586, instance_loss: 0.3123, weighted_loss: 0.5547, label: 2, bag_size: 343
batch 1100, loss: 2.4871, instance_loss: 1.0467, weighted_loss: 2.0550, label: 2, bag_size: 1555
batch 1200, loss: 0.0126, instance_loss: 0.0388, weighted_loss: 0.0205, label: 2, bag_size: 732
batch 1300, loss: 0.0504, instance_loss: 0.0484, weighted_loss: 0.0498, label: 1, bag_size: 1189
batch 1400, loss: 0.4118, instance_loss: 0.4858, weighted_loss: 0.4340, label: 1, bag_size: 820
batch 1500, loss: 3.5386, instance_loss: 1.8214, weighted_loss: 3.0235, label: 3, bag_size: 2158
batch 1600, loss: 0.4577, instance_loss: 0.3926, weighted_loss: 0.4382, label: 2, bag_size: 210
batch 1700, loss: 0.0215, instance_loss: 0.0528, weighted_loss: 0.0309, label: 1, bag_size: 994
batch 1800, loss: 1.0281, instance_loss: 0.5708, weighted_loss: 0.8909, label: 1, bag_size: 183
batch 1900, loss: 0.3551, instance_loss: 0.3529, weighted_loss: 0.3545, label: 1, bag_size: 1006
batch 2000, loss: 2.9894, instance_loss: 1.3743, weighted_loss: 2.5049, label: 3, bag_size: 2813
batch 2100, loss: 0.0591, instance_loss: 0.0888, weighted_loss: 0.0680, label: 2, bag_size: 467

Instance Classifier Stats
class 0 clustering acc 0.9837125576036866: correct 68309/69440
class 1 clustering acc 0.40184331797235023: correct 6976/17360

Epoch: 82, train_loss: 0.7170, train_clustering_loss:  0.4056, train_error: 0.3088
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6432225063938619, correct coarse 503/782 
coarse class 2: coarse acc 0.8859245630174793, correct coarse 963/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6912

Val Set, val_loss: 0.7457, val_error: 0.3068, auc: 0.7872
class 0 clustering acc 0.9834280303030303: correct 8308/8448 
class 1 clustering acc 0.4256628787878788: correct 899/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4259

Training for coarse level...
batch 100, loss: 0.4257, instance_loss: 0.1113, weighted_loss: 0.3314, label: 2, bag_size: 703
batch 200, loss: 0.0249, instance_loss: 0.0640, weighted_loss: 0.0366, label: 2, bag_size: 266
batch 300, loss: 1.7353, instance_loss: 0.6090, weighted_loss: 1.3974, label: 1, bag_size: 526
batch 400, loss: 0.1443, instance_loss: 0.1465, weighted_loss: 0.1449, label: 2, bag_size: 1364
batch 500, loss: 1.3753, instance_loss: 0.6560, weighted_loss: 1.1595, label: 1, bag_size: 169
batch 600, loss: 0.1263, instance_loss: 0.0845, weighted_loss: 0.1137, label: 1, bag_size: 334
batch 700, loss: 1.1343, instance_loss: 0.6241, weighted_loss: 0.9813, label: 2, bag_size: 2023
batch 800, loss: 0.4975, instance_loss: 0.5271, weighted_loss: 0.5064, label: 1, bag_size: 1918
batch 900, loss: 1.1894, instance_loss: 0.8409, weighted_loss: 1.0849, label: 3, bag_size: 2076
batch 1000, loss: 0.3429, instance_loss: 0.2015, weighted_loss: 0.3005, label: 2, bag_size: 298
batch 1100, loss: 2.1002, instance_loss: 0.9298, weighted_loss: 1.7491, label: 3, bag_size: 278
batch 1200, loss: 0.5699, instance_loss: 0.6035, weighted_loss: 0.5800, label: 3, bag_size: 665
batch 1300, loss: 0.6011, instance_loss: 0.3406, weighted_loss: 0.5230, label: 2, bag_size: 253
batch 1400, loss: 0.0175, instance_loss: 0.0812, weighted_loss: 0.0366, label: 1, bag_size: 989
batch 1500, loss: 0.6980, instance_loss: 0.4109, weighted_loss: 0.6119, label: 2, bag_size: 448
batch 1600, loss: 0.0391, instance_loss: 0.0610, weighted_loss: 0.0457, label: 1, bag_size: 310
batch 1700, loss: 0.0218, instance_loss: 0.0557, weighted_loss: 0.0319, label: 2, bag_size: 635
batch 1800, loss: 0.1269, instance_loss: 0.1496, weighted_loss: 0.1337, label: 1, bag_size: 774
batch 1900, loss: 1.3014, instance_loss: 0.6224, weighted_loss: 1.0977, label: 3, bag_size: 274
batch 2000, loss: 1.1352, instance_loss: 0.6954, weighted_loss: 1.0032, label: 3, bag_size: 388
batch 2100, loss: 0.0906, instance_loss: 0.0778, weighted_loss: 0.0867, label: 1, bag_size: 504

Instance Classifier Stats
class 0 clustering acc 0.9833813364055299: correct 68286/69440
class 1 clustering acc 0.4007488479262673: correct 6957/17360

Epoch: 83, train_loss: 0.7161, train_clustering_loss:  0.4047, train_error: 0.3078
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6624040920716112, correct coarse 518/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6922

Val Set, val_loss: 0.7436, val_error: 0.3144, auc: 0.7873
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.4256628787878788: correct 899/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4116

Training for coarse level...
batch 100, loss: 2.0241, instance_loss: 0.9672, weighted_loss: 1.7070, label: 3, bag_size: 838
batch 200, loss: 2.1678, instance_loss: 0.8145, weighted_loss: 1.7618, label: 1, bag_size: 127
batch 300, loss: 0.0338, instance_loss: 0.0949, weighted_loss: 0.0521, label: 2, bag_size: 289
batch 400, loss: 0.3358, instance_loss: 0.3811, weighted_loss: 0.3494, label: 2, bag_size: 271
batch 500, loss: 0.0842, instance_loss: 0.1203, weighted_loss: 0.0950, label: 2, bag_size: 328
batch 600, loss: 0.1051, instance_loss: 0.1185, weighted_loss: 0.1091, label: 2, bag_size: 603
batch 700, loss: 2.1598, instance_loss: 0.9907, weighted_loss: 1.8091, label: 3, bag_size: 675
batch 800, loss: 0.0874, instance_loss: 0.0685, weighted_loss: 0.0817, label: 2, bag_size: 844
batch 900, loss: 1.2251, instance_loss: 0.7828, weighted_loss: 1.0924, label: 3, bag_size: 243
batch 1000, loss: 1.0299, instance_loss: 0.5306, weighted_loss: 0.8801, label: 2, bag_size: 297
batch 1100, loss: 0.2404, instance_loss: 0.1849, weighted_loss: 0.2238, label: 2, bag_size: 359
batch 1200, loss: 0.1145, instance_loss: 0.2659, weighted_loss: 0.1599, label: 2, bag_size: 244
batch 1300, loss: 0.3152, instance_loss: 0.3225, weighted_loss: 0.3174, label: 1, bag_size: 610
batch 1400, loss: 0.1989, instance_loss: 0.0824, weighted_loss: 0.1639, label: 1, bag_size: 1867
batch 1500, loss: 0.1005, instance_loss: 0.1513, weighted_loss: 0.1157, label: 2, bag_size: 280
batch 1600, loss: 0.2442, instance_loss: 0.3598, weighted_loss: 0.2789, label: 2, bag_size: 244
batch 1700, loss: 0.2453, instance_loss: 0.1610, weighted_loss: 0.2200, label: 1, bag_size: 780
batch 1800, loss: 0.7408, instance_loss: 0.4993, weighted_loss: 0.6683, label: 2, bag_size: 431
batch 1900, loss: 0.0256, instance_loss: 0.0311, weighted_loss: 0.0272, label: 1, bag_size: 1387
batch 2000, loss: 0.0503, instance_loss: 0.0566, weighted_loss: 0.0522, label: 1, bag_size: 1394
batch 2100, loss: 0.0313, instance_loss: 0.1033, weighted_loss: 0.0529, label: 2, bag_size: 676

Instance Classifier Stats
class 0 clustering acc 0.9841445852534563: correct 68339/69440
class 1 clustering acc 0.4028225806451613: correct 6993/17360

Epoch: 84, train_loss: 0.7157, train_clustering_loss:  0.4045, train_error: 0.3060
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6432225063938619, correct coarse 503/782 
coarse class 2: coarse acc 0.891444342226311, correct coarse 969/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6940

Val Set, val_loss: 0.7460, val_error: 0.3030, auc: 0.7871
class 0 clustering acc 0.9839015151515151: correct 8312/8448 
class 1 clustering acc 0.4266098484848485: correct 901/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4283

Training for coarse level...
batch 100, loss: 1.0113, instance_loss: 0.5620, weighted_loss: 0.8765, label: 2, bag_size: 311
batch 200, loss: 0.3900, instance_loss: 0.2535, weighted_loss: 0.3490, label: 2, bag_size: 661
batch 300, loss: 0.0414, instance_loss: 0.0790, weighted_loss: 0.0527, label: 2, bag_size: 1140
batch 400, loss: 1.4488, instance_loss: 0.7783, weighted_loss: 1.2476, label: 1, bag_size: 315
batch 500, loss: 1.5073, instance_loss: 0.6533, weighted_loss: 1.2511, label: 0, bag_size: 37
batch 600, loss: 0.1094, instance_loss: 0.0975, weighted_loss: 0.1058, label: 1, bag_size: 298
batch 700, loss: 0.5599, instance_loss: 0.3487, weighted_loss: 0.4965, label: 2, bag_size: 389
batch 800, loss: 0.8614, instance_loss: 0.5308, weighted_loss: 0.7622, label: 2, bag_size: 110
batch 900, loss: 1.7664, instance_loss: 0.7480, weighted_loss: 1.4609, label: 1, bag_size: 165
batch 1000, loss: 0.8782, instance_loss: 0.5344, weighted_loss: 0.7750, label: 1, bag_size: 225
batch 1100, loss: 0.0166, instance_loss: 0.0553, weighted_loss: 0.0282, label: 1, bag_size: 88
batch 1200, loss: 0.0767, instance_loss: 0.1116, weighted_loss: 0.0872, label: 2, bag_size: 409
batch 1300, loss: 0.0279, instance_loss: 0.0443, weighted_loss: 0.0328, label: 2, bag_size: 711
batch 1400, loss: 0.4139, instance_loss: 0.3433, weighted_loss: 0.3927, label: 1, bag_size: 1897
batch 1500, loss: 0.7341, instance_loss: 0.5022, weighted_loss: 0.6645, label: 2, bag_size: 421
batch 1600, loss: 0.0954, instance_loss: 0.1069, weighted_loss: 0.0988, label: 1, bag_size: 1875
batch 1700, loss: 2.1605, instance_loss: 0.9140, weighted_loss: 1.7866, label: 0, bag_size: 258
batch 1800, loss: 0.0524, instance_loss: 0.1339, weighted_loss: 0.0768, label: 2, bag_size: 468
batch 1900, loss: 0.4091, instance_loss: 0.4172, weighted_loss: 0.4115, label: 2, bag_size: 271
batch 2000, loss: 0.3336, instance_loss: 0.2623, weighted_loss: 0.3122, label: 2, bag_size: 342
batch 2100, loss: 0.0789, instance_loss: 0.1083, weighted_loss: 0.0878, label: 2, bag_size: 441

Instance Classifier Stats
class 0 clustering acc 0.9841877880184332: correct 68342/69440
class 1 clustering acc 0.39971198156682025: correct 6939/17360

Epoch: 85, train_loss: 0.7148, train_clustering_loss:  0.4051, train_error: 0.3037
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6572890025575447, correct coarse 514/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.1517509727626459, correct coarse 39/257 
Overall Accuracy: 0.6963

Val Set, val_loss: 0.7445, val_error: 0.3068, auc: 0.7868
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.4303977272727273: correct 909/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4165

Training for coarse level...
batch 100, loss: 0.0558, instance_loss: 0.1149, weighted_loss: 0.0735, label: 1, bag_size: 278
batch 200, loss: 0.2443, instance_loss: 0.3103, weighted_loss: 0.2641, label: 2, bag_size: 200
batch 300, loss: 0.0200, instance_loss: 0.0458, weighted_loss: 0.0278, label: 2, bag_size: 200
batch 400, loss: 0.0384, instance_loss: 0.1057, weighted_loss: 0.0586, label: 2, bag_size: 699
batch 500, loss: 0.0335, instance_loss: 0.0954, weighted_loss: 0.0520, label: 1, bag_size: 313
batch 600, loss: 0.0512, instance_loss: 0.0785, weighted_loss: 0.0594, label: 1, bag_size: 1078
batch 700, loss: 0.9211, instance_loss: 0.5953, weighted_loss: 0.8234, label: 1, bag_size: 2085
batch 800, loss: 0.2569, instance_loss: 0.2078, weighted_loss: 0.2422, label: 2, bag_size: 478
batch 900, loss: 0.4297, instance_loss: 0.2884, weighted_loss: 0.3873, label: 2, bag_size: 640
batch 1000, loss: 1.6694, instance_loss: 0.7146, weighted_loss: 1.3829, label: 3, bag_size: 241
batch 1100, loss: 0.1066, instance_loss: 0.2099, weighted_loss: 0.1376, label: 2, bag_size: 205
batch 1200, loss: 3.2412, instance_loss: 0.9616, weighted_loss: 2.5574, label: 0, bag_size: 244
batch 1300, loss: 0.6939, instance_loss: 0.4453, weighted_loss: 0.6193, label: 2, bag_size: 229
batch 1400, loss: 2.1827, instance_loss: 0.9154, weighted_loss: 1.8025, label: 1, bag_size: 191
batch 1500, loss: 0.8278, instance_loss: 0.4451, weighted_loss: 0.7130, label: 2, bag_size: 373
batch 1600, loss: 0.0366, instance_loss: 0.0592, weighted_loss: 0.0434, label: 2, bag_size: 691
batch 1700, loss: 0.3249, instance_loss: 0.2746, weighted_loss: 0.3098, label: 1, bag_size: 244
batch 1800, loss: 1.7087, instance_loss: 0.8789, weighted_loss: 1.4597, label: 1, bag_size: 562
batch 1900, loss: 0.9490, instance_loss: 0.5410, weighted_loss: 0.8266, label: 1, bag_size: 792
batch 2000, loss: 0.1426, instance_loss: 0.1687, weighted_loss: 0.1504, label: 2, bag_size: 1530
batch 2100, loss: 0.0626, instance_loss: 0.0810, weighted_loss: 0.0681, label: 2, bag_size: 658

Instance Classifier Stats
class 0 clustering acc 0.9832949308755761: correct 68280/69440
class 1 clustering acc 0.40432027649769586: correct 7019/17360

Epoch: 86, train_loss: 0.7140, train_clustering_loss:  0.4059, train_error: 0.3097
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.12062256809338522, correct coarse 31/257 
Overall Accuracy: 0.6903

Val Set, val_loss: 0.7438, val_error: 0.3068, auc: 0.7869
class 0 clustering acc 0.9835464015151515: correct 8309/8448 
class 1 clustering acc 0.4270833333333333: correct 902/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4262

Training for coarse level...
batch 100, loss: 1.2671, instance_loss: 0.6316, weighted_loss: 1.0765, label: 1, bag_size: 445
batch 200, loss: 1.9375, instance_loss: 0.6172, weighted_loss: 1.5414, label: 1, bag_size: 254
batch 300, loss: 0.9892, instance_loss: 0.4724, weighted_loss: 0.8341, label: 1, bag_size: 267
batch 400, loss: 0.1000, instance_loss: 0.1276, weighted_loss: 0.1083, label: 1, bag_size: 367
batch 500, loss: 0.2382, instance_loss: 0.2244, weighted_loss: 0.2341, label: 1, bag_size: 725
batch 600, loss: 0.7093, instance_loss: 0.2770, weighted_loss: 0.5796, label: 1, bag_size: 1667
batch 700, loss: 0.8477, instance_loss: 0.3438, weighted_loss: 0.6965, label: 2, bag_size: 316
batch 800, loss: 0.0418, instance_loss: 0.0763, weighted_loss: 0.0522, label: 2, bag_size: 442
batch 900, loss: 0.2126, instance_loss: 0.1821, weighted_loss: 0.2035, label: 2, bag_size: 909
batch 1000, loss: 0.0171, instance_loss: 0.0390, weighted_loss: 0.0237, label: 1, bag_size: 563
batch 1100, loss: 1.6118, instance_loss: 0.7167, weighted_loss: 1.3433, label: 3, bag_size: 661
batch 1200, loss: 0.0739, instance_loss: 0.0805, weighted_loss: 0.0759, label: 2, bag_size: 593
batch 1300, loss: 0.1944, instance_loss: 0.3079, weighted_loss: 0.2285, label: 1, bag_size: 1087
batch 1400, loss: 0.1242, instance_loss: 0.1319, weighted_loss: 0.1265, label: 2, bag_size: 643
batch 1500, loss: 1.7899, instance_loss: 0.6876, weighted_loss: 1.4592, label: 3, bag_size: 175
batch 1600, loss: 1.3949, instance_loss: 0.6535, weighted_loss: 1.1725, label: 1, bag_size: 334
batch 1700, loss: 0.8632, instance_loss: 0.3734, weighted_loss: 0.7163, label: 2, bag_size: 465
batch 1800, loss: 0.0790, instance_loss: 0.0957, weighted_loss: 0.0840, label: 2, bag_size: 369
batch 1900, loss: 0.1066, instance_loss: 0.1283, weighted_loss: 0.1131, label: 2, bag_size: 341
batch 2000, loss: 0.9641, instance_loss: 0.6040, weighted_loss: 0.8561, label: 2, bag_size: 387
batch 2100, loss: 0.2338, instance_loss: 0.2084, weighted_loss: 0.2262, label: 2, bag_size: 860

Instance Classifier Stats
class 0 clustering acc 0.9840149769585254: correct 68330/69440
class 1 clustering acc 0.39896313364055297: correct 6926/17360

Epoch: 87, train_loss: 0.7132, train_clustering_loss:  0.4047, train_error: 0.3069
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8785648574057038, correct coarse 955/1087 
coarse class 3: coarse acc 0.14007782101167315, correct coarse 36/257 
Overall Accuracy: 0.6931

Val Set, val_loss: 0.7433, val_error: 0.3030, auc: 0.7870
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.4285037878787879: correct 905/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4282

Training for coarse level...
batch 100, loss: 0.8122, instance_loss: 0.4090, weighted_loss: 0.6912, label: 2, bag_size: 696
batch 200, loss: 0.2492, instance_loss: 0.2271, weighted_loss: 0.2426, label: 1, bag_size: 232
batch 300, loss: 0.0118, instance_loss: 0.0366, weighted_loss: 0.0192, label: 2, bag_size: 732
batch 400, loss: 0.9175, instance_loss: 0.4181, weighted_loss: 0.7677, label: 2, bag_size: 193
batch 500, loss: 4.0212, instance_loss: 1.8729, weighted_loss: 3.3767, label: 3, bag_size: 1009
batch 600, loss: 0.0342, instance_loss: 0.0535, weighted_loss: 0.0400, label: 2, bag_size: 761
batch 700, loss: 0.1552, instance_loss: 0.1281, weighted_loss: 0.1471, label: 2, bag_size: 517
batch 800, loss: 0.0485, instance_loss: 0.0720, weighted_loss: 0.0555, label: 1, bag_size: 623
batch 900, loss: 1.2460, instance_loss: 0.5810, weighted_loss: 1.0465, label: 1, bag_size: 298
batch 1000, loss: 0.7925, instance_loss: 0.4610, weighted_loss: 0.6931, label: 1, bag_size: 1049
batch 1100, loss: 1.1632, instance_loss: 0.7259, weighted_loss: 1.0320, label: 2, bag_size: 2209
batch 1200, loss: 0.2252, instance_loss: 0.1875, weighted_loss: 0.2139, label: 2, bag_size: 545
batch 1300, loss: 1.0727, instance_loss: 0.6234, weighted_loss: 0.9379, label: 1, bag_size: 218
batch 1400, loss: 0.8653, instance_loss: 0.5117, weighted_loss: 0.7592, label: 2, bag_size: 429
batch 1500, loss: 0.6050, instance_loss: 0.3653, weighted_loss: 0.5331, label: 2, bag_size: 1122
batch 1600, loss: 0.0996, instance_loss: 0.1133, weighted_loss: 0.1037, label: 1, bag_size: 2658
batch 1700, loss: 0.0930, instance_loss: 0.1515, weighted_loss: 0.1105, label: 2, bag_size: 387
batch 1800, loss: 0.0303, instance_loss: 0.0886, weighted_loss: 0.0478, label: 2, bag_size: 287
batch 1900, loss: 1.9583, instance_loss: 0.8883, weighted_loss: 1.6373, label: 1, bag_size: 302
batch 2000, loss: 0.4142, instance_loss: 0.3600, weighted_loss: 0.3980, label: 2, bag_size: 210
batch 2100, loss: 0.8082, instance_loss: 0.4148, weighted_loss: 0.6901, label: 2, bag_size: 174

Instance Classifier Stats
class 0 clustering acc 0.9836837557603687: correct 68307/69440
class 1 clustering acc 0.4024769585253456: correct 6987/17360

Epoch: 88, train_loss: 0.7123, train_clustering_loss:  0.4040, train_error: 0.3060
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6521739130434783, correct coarse 510/782 
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087 
coarse class 3: coarse acc 0.1556420233463035, correct coarse 40/257 
Overall Accuracy: 0.6940

Val Set, val_loss: 0.7438, val_error: 0.3068, auc: 0.7867
class 0 clustering acc 0.9836647727272727: correct 8310/8448 
class 1 clustering acc 0.4275568181818182: correct 903/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4262

Training for coarse level...
batch 100, loss: 0.0417, instance_loss: 0.1789, weighted_loss: 0.0828, label: 1, bag_size: 2627
batch 200, loss: 0.0291, instance_loss: 0.0730, weighted_loss: 0.0423, label: 1, bag_size: 660
batch 300, loss: 0.5637, instance_loss: 0.3985, weighted_loss: 0.5141, label: 1, bag_size: 785
batch 400, loss: 0.9529, instance_loss: 0.4737, weighted_loss: 0.8091, label: 2, bag_size: 489
batch 500, loss: 0.6999, instance_loss: 0.3488, weighted_loss: 0.5946, label: 2, bag_size: 654
batch 600, loss: 1.9733, instance_loss: 1.1625, weighted_loss: 1.7301, label: 2, bag_size: 395
batch 700, loss: 0.0621, instance_loss: 0.1250, weighted_loss: 0.0810, label: 2, bag_size: 533
batch 800, loss: 0.0465, instance_loss: 0.0728, weighted_loss: 0.0544, label: 2, bag_size: 198
batch 900, loss: 0.7299, instance_loss: 0.3558, weighted_loss: 0.6177, label: 2, bag_size: 115
batch 1000, loss: 0.0254, instance_loss: 0.0518, weighted_loss: 0.0333, label: 1, bag_size: 620
batch 1100, loss: 1.3464, instance_loss: 0.6710, weighted_loss: 1.1438, label: 1, bag_size: 217
batch 1200, loss: 0.7533, instance_loss: 0.5249, weighted_loss: 0.6848, label: 1, bag_size: 248
batch 1300, loss: 1.4969, instance_loss: 0.7582, weighted_loss: 1.2753, label: 3, bag_size: 253
batch 1400, loss: 0.5296, instance_loss: 0.2640, weighted_loss: 0.4499, label: 2, bag_size: 449
batch 1500, loss: 0.3358, instance_loss: 0.2028, weighted_loss: 0.2959, label: 2, bag_size: 661
batch 1600, loss: 3.1600, instance_loss: 1.3834, weighted_loss: 2.6270, label: 2, bag_size: 2344
batch 1700, loss: 0.0592, instance_loss: 0.1347, weighted_loss: 0.0819, label: 1, bag_size: 128
batch 1800, loss: 1.1963, instance_loss: 0.6279, weighted_loss: 1.0258, label: 1, bag_size: 435
batch 1900, loss: 0.4570, instance_loss: 0.3437, weighted_loss: 0.4230, label: 2, bag_size: 807
batch 2000, loss: 0.6407, instance_loss: 0.3262, weighted_loss: 0.5464, label: 2, bag_size: 1716
batch 2100, loss: 0.7598, instance_loss: 0.5845, weighted_loss: 0.7072, label: 3, bag_size: 206

Instance Classifier Stats
class 0 clustering acc 0.9838277649769586: correct 68317/69440
class 1 clustering acc 0.4012096774193548: correct 6965/17360

Epoch: 89, train_loss: 0.7120, train_clustering_loss:  0.4044, train_error: 0.3083
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6521739130434783, correct coarse 510/782 
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087 
coarse class 3: coarse acc 0.13618677042801555, correct coarse 35/257 
Overall Accuracy: 0.6917

Val Set, val_loss: 0.7437, val_error: 0.3030, auc: 0.7867
class 0 clustering acc 0.9834280303030303: correct 8308/8448 
class 1 clustering acc 0.4303977272727273: correct 909/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4281

Training for coarse level...
batch 100, loss: 0.3552, instance_loss: 0.2877, weighted_loss: 0.3349, label: 1, bag_size: 663
batch 200, loss: 0.0153, instance_loss: 0.0278, weighted_loss: 0.0190, label: 1, bag_size: 418
batch 300, loss: 4.1286, instance_loss: 2.0237, weighted_loss: 3.4971, label: 3, bag_size: 1009
batch 400, loss: 0.3747, instance_loss: 0.2032, weighted_loss: 0.3233, label: 2, bag_size: 661
batch 500, loss: 0.0227, instance_loss: 0.0553, weighted_loss: 0.0325, label: 2, bag_size: 756
batch 600, loss: 1.2349, instance_loss: 0.6956, weighted_loss: 1.0731, label: 3, bag_size: 361
batch 700, loss: 0.3072, instance_loss: 0.2647, weighted_loss: 0.2945, label: 2, bag_size: 434
batch 800, loss: 0.6095, instance_loss: 0.3531, weighted_loss: 0.5326, label: 1, bag_size: 1193
batch 900, loss: 0.3802, instance_loss: 0.3242, weighted_loss: 0.3634, label: 2, bag_size: 726
batch 1000, loss: 0.9098, instance_loss: 0.5334, weighted_loss: 0.7969, label: 1, bag_size: 298
batch 1100, loss: 2.5862, instance_loss: 1.2987, weighted_loss: 2.2000, label: 3, bag_size: 380
batch 1200, loss: 1.2886, instance_loss: 0.6834, weighted_loss: 1.1071, label: 1, bag_size: 348
batch 1300, loss: 0.0348, instance_loss: 0.0680, weighted_loss: 0.0447, label: 2, bag_size: 334
batch 1400, loss: 0.0539, instance_loss: 0.0522, weighted_loss: 0.0534, label: 1, bag_size: 1549
batch 1500, loss: 2.3258, instance_loss: 0.9175, weighted_loss: 1.9033, label: 1, bag_size: 360
batch 1600, loss: 1.5428, instance_loss: 0.7746, weighted_loss: 1.3124, label: 1, bag_size: 475
batch 1700, loss: 0.9410, instance_loss: 0.4320, weighted_loss: 0.7883, label: 1, bag_size: 779
batch 1800, loss: 0.0110, instance_loss: 0.0347, weighted_loss: 0.0181, label: 1, bag_size: 784
batch 1900, loss: 0.7564, instance_loss: 0.4462, weighted_loss: 0.6633, label: 2, bag_size: 463
batch 2000, loss: 0.0198, instance_loss: 0.0659, weighted_loss: 0.0336, label: 1, bag_size: 1534
batch 2100, loss: 0.0414, instance_loss: 0.0745, weighted_loss: 0.0513, label: 2, bag_size: 180

Instance Classifier Stats
class 0 clustering acc 0.9841301843317972: correct 68338/69440
class 1 clustering acc 0.40397465437788016: correct 7013/17360

Epoch: 90, train_loss: 0.7102, train_clustering_loss:  0.4036, train_error: 0.3055
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.14007782101167315, correct coarse 36/257 
Overall Accuracy: 0.6945

Val Set, val_loss: 0.7437, val_error: 0.3030, auc: 0.7866
class 0 clustering acc 0.9837831439393939: correct 8311/8448 
class 1 clustering acc 0.4289772727272727: correct 906/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4281

Training for coarse level...
batch 100, loss: 0.5182, instance_loss: 0.2719, weighted_loss: 0.4443, label: 1, bag_size: 1477
batch 200, loss: 0.0730, instance_loss: 0.1219, weighted_loss: 0.0877, label: 1, bag_size: 483
batch 300, loss: 0.8329, instance_loss: 0.4155, weighted_loss: 0.7077, label: 2, bag_size: 232
batch 400, loss: 0.1421, instance_loss: 0.1838, weighted_loss: 0.1546, label: 2, bag_size: 849
batch 500, loss: 0.5954, instance_loss: 0.4328, weighted_loss: 0.5466, label: 2, bag_size: 473
batch 600, loss: 0.4052, instance_loss: 0.2122, weighted_loss: 0.3473, label: 2, bag_size: 1238
batch 700, loss: 1.8801, instance_loss: 1.1090, weighted_loss: 1.6488, label: 1, bag_size: 1654
batch 800, loss: 0.6343, instance_loss: 0.4283, weighted_loss: 0.5725, label: 2, bag_size: 355
batch 900, loss: 0.0258, instance_loss: 0.0560, weighted_loss: 0.0349, label: 2, bag_size: 323
batch 1000, loss: 1.2638, instance_loss: 0.5222, weighted_loss: 1.0414, label: 1, bag_size: 308
batch 1100, loss: 3.0834, instance_loss: 1.2433, weighted_loss: 2.5314, label: 2, bag_size: 1331
batch 1200, loss: 0.9390, instance_loss: 0.6048, weighted_loss: 0.8387, label: 2, bag_size: 316
batch 1300, loss: 0.7941, instance_loss: 0.5050, weighted_loss: 0.7074, label: 2, bag_size: 193
batch 1400, loss: 4.2016, instance_loss: 1.7023, weighted_loss: 3.4518, label: 3, bag_size: 561
batch 1500, loss: 0.3767, instance_loss: 0.4271, weighted_loss: 0.3918, label: 1, bag_size: 837
batch 1600, loss: 0.3432, instance_loss: 0.2140, weighted_loss: 0.3044, label: 1, bag_size: 697
batch 1700, loss: 0.1533, instance_loss: 0.3129, weighted_loss: 0.2012, label: 1, bag_size: 1573
batch 1800, loss: 2.1406, instance_loss: 0.7254, weighted_loss: 1.7160, label: 1, bag_size: 339
batch 1900, loss: 0.6260, instance_loss: 0.5202, weighted_loss: 0.5942, label: 2, bag_size: 986
batch 2000, loss: 0.0377, instance_loss: 0.0674, weighted_loss: 0.0466, label: 2, bag_size: 679
batch 2100, loss: 0.9174, instance_loss: 0.3648, weighted_loss: 0.7516, label: 2, bag_size: 397

Instance Classifier Stats
class 0 clustering acc 0.9845622119815668: correct 68368/69440
class 1 clustering acc 0.4009216589861751: correct 6960/17360

Epoch: 91, train_loss: 0.7096, train_clustering_loss:  0.4036, train_error: 0.3005
coarse class 0: coarse acc 0.022727272727272728, correct coarse 1/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.1828793774319066, correct coarse 47/257 
Overall Accuracy: 0.6995

Val Set, val_loss: 0.7442, val_error: 0.3030, auc: 0.7864
class 0 clustering acc 0.9835464015151515: correct 8309/8448 
class 1 clustering acc 0.4318181818181818: correct 912/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4185

Training for coarse level...
batch 100, loss: 0.1256, instance_loss: 0.1156, weighted_loss: 0.1226, label: 2, bag_size: 857
batch 200, loss: 0.0464, instance_loss: 0.0786, weighted_loss: 0.0561, label: 2, bag_size: 599
batch 300, loss: 0.4689, instance_loss: 0.2423, weighted_loss: 0.4009, label: 1, bag_size: 1727
batch 400, loss: 0.0162, instance_loss: 0.0718, weighted_loss: 0.0328, label: 2, bag_size: 405
batch 500, loss: 0.8085, instance_loss: 0.3372, weighted_loss: 0.6671, label: 2, bag_size: 465
batch 600, loss: 0.1900, instance_loss: 0.2306, weighted_loss: 0.2022, label: 2, bag_size: 444
batch 700, loss: 0.5703, instance_loss: 0.3340, weighted_loss: 0.4994, label: 2, bag_size: 422
batch 800, loss: 1.6996, instance_loss: 0.7114, weighted_loss: 1.4032, label: 3, bag_size: 430
batch 900, loss: 0.8858, instance_loss: 0.7213, weighted_loss: 0.8364, label: 3, bag_size: 568
batch 1000, loss: 0.8968, instance_loss: 0.5121, weighted_loss: 0.7814, label: 2, bag_size: 252
batch 1100, loss: 2.8175, instance_loss: 0.9040, weighted_loss: 2.2435, label: 0, bag_size: 461
batch 1200, loss: 0.0163, instance_loss: 0.0614, weighted_loss: 0.0299, label: 2, bag_size: 198
batch 1300, loss: 0.7358, instance_loss: 0.3596, weighted_loss: 0.6229, label: 2, bag_size: 322
batch 1400, loss: 0.0278, instance_loss: 0.0497, weighted_loss: 0.0344, label: 2, bag_size: 361
batch 1500, loss: 2.1375, instance_loss: 0.9296, weighted_loss: 1.7752, label: 3, bag_size: 945
batch 1600, loss: 1.2900, instance_loss: 0.6644, weighted_loss: 1.1023, label: 2, bag_size: 294
batch 1700, loss: 0.2055, instance_loss: 0.3668, weighted_loss: 0.2539, label: 1, bag_size: 1120
batch 1800, loss: 0.0166, instance_loss: 0.0704, weighted_loss: 0.0328, label: 2, bag_size: 705
batch 1900, loss: 0.0111, instance_loss: 0.0476, weighted_loss: 0.0220, label: 1, bag_size: 784
batch 2000, loss: 0.9089, instance_loss: 0.5312, weighted_loss: 0.7956, label: 1, bag_size: 894
batch 2100, loss: 0.3569, instance_loss: 0.3489, weighted_loss: 0.3545, label: 2, bag_size: 216

Instance Classifier Stats
class 0 clustering acc 0.984317396313364: correct 68351/69440
class 1 clustering acc 0.40455069124423965: correct 7023/17360

Epoch: 92, train_loss: 0.7082, train_clustering_loss:  0.4027, train_error: 0.3069
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6585677749360613, correct coarse 515/782 
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087 
coarse class 3: coarse acc 0.12840466926070038, correct coarse 33/257 
Overall Accuracy: 0.6931

Val Set, val_loss: 0.7445, val_error: 0.3030, auc: 0.7851
class 0 clustering acc 0.9834280303030303: correct 8308/8448 
class 1 clustering acc 0.43134469696969696: correct 911/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4185

Training for coarse level...
batch 100, loss: 3.6718, instance_loss: 1.4444, weighted_loss: 3.0036, label: 1, bag_size: 738
batch 200, loss: 1.4723, instance_loss: 0.6634, weighted_loss: 1.2296, label: 3, bag_size: 130
batch 300, loss: 0.0418, instance_loss: 0.1056, weighted_loss: 0.0610, label: 2, bag_size: 206
batch 400, loss: 1.4706, instance_loss: 0.7343, weighted_loss: 1.2497, label: 3, bag_size: 760
batch 500, loss: 0.4776, instance_loss: 0.5210, weighted_loss: 0.4906, label: 1, bag_size: 1632
batch 600, loss: 0.6020, instance_loss: 0.3805, weighted_loss: 0.5355, label: 2, bag_size: 129
batch 700, loss: 0.5673, instance_loss: 0.4819, weighted_loss: 0.5416, label: 2, bag_size: 1066
batch 800, loss: 0.0944, instance_loss: 0.1660, weighted_loss: 0.1159, label: 2, bag_size: 209
batch 900, loss: 0.8376, instance_loss: 0.6738, weighted_loss: 0.7884, label: 2, bag_size: 204
batch 1000, loss: 0.8236, instance_loss: 0.5445, weighted_loss: 0.7398, label: 2, bag_size: 242
batch 1100, loss: 0.0644, instance_loss: 0.0714, weighted_loss: 0.0665, label: 2, bag_size: 658
batch 1200, loss: 1.9024, instance_loss: 0.9360, weighted_loss: 1.6125, label: 1, bag_size: 237
batch 1300, loss: 0.9487, instance_loss: 0.5251, weighted_loss: 0.8216, label: 1, bag_size: 172
batch 1400, loss: 0.4260, instance_loss: 0.3022, weighted_loss: 0.3889, label: 2, bag_size: 367
batch 1500, loss: 0.9323, instance_loss: 0.4705, weighted_loss: 0.7938, label: 2, bag_size: 242
batch 1600, loss: 0.0518, instance_loss: 0.0724, weighted_loss: 0.0580, label: 1, bag_size: 2213
batch 1700, loss: 0.0856, instance_loss: 0.1963, weighted_loss: 0.1188, label: 1, bag_size: 177
batch 1800, loss: 0.0354, instance_loss: 0.0961, weighted_loss: 0.0536, label: 2, bag_size: 1137
batch 1900, loss: 1.9854, instance_loss: 0.7553, weighted_loss: 1.6164, label: 3, bag_size: 567
batch 2000, loss: 0.8002, instance_loss: 0.5281, weighted_loss: 0.7186, label: 2, bag_size: 1010
batch 2100, loss: 1.0662, instance_loss: 0.7482, weighted_loss: 0.9708, label: 3, bag_size: 151

Instance Classifier Stats
class 0 clustering acc 0.9838853686635944: correct 68321/69440
class 1 clustering acc 0.404147465437788: correct 7016/17360

Epoch: 93, train_loss: 0.7077, train_clustering_loss:  0.4034, train_error: 0.3023
coarse class 0: coarse acc 0.0, correct coarse 0/44 
coarse class 1: coarse acc 0.6636828644501279, correct coarse 519/782 
coarse class 2: coarse acc 0.8850045998160073, correct coarse 962/1087 
coarse class 3: coarse acc 0.12840466926070038, correct coarse 33/257 
Overall Accuracy: 0.6977

Val Set, val_loss: 0.7445, val_error: 0.3030, auc: 0.7849
class 0 clustering acc 0.9836647727272727: correct 8310/8448 
class 1 clustering acc 0.42992424242424243: correct 908/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4281

Training for coarse level...
batch 100, loss: 0.6027, instance_loss: 0.3886, weighted_loss: 0.5385, label: 2, bag_size: 147
batch 200, loss: 0.0577, instance_loss: 0.0658, weighted_loss: 0.0601, label: 2, bag_size: 416
batch 300, loss: 0.8213, instance_loss: 0.5565, weighted_loss: 0.7419, label: 1, bag_size: 344
batch 400, loss: 3.6866, instance_loss: 1.6172, weighted_loss: 3.0658, label: 1, bag_size: 486
batch 500, loss: 0.1536, instance_loss: 0.1255, weighted_loss: 0.1451, label: 1, bag_size: 1052
batch 600, loss: 0.1092, instance_loss: 0.1481, weighted_loss: 0.1208, label: 2, bag_size: 461
batch 700, loss: 0.2126, instance_loss: 0.3646, weighted_loss: 0.2582, label: 1, bag_size: 536
batch 800, loss: 0.6115, instance_loss: 0.2937, weighted_loss: 0.5161, label: 2, bag_size: 343
batch 900, loss: 1.3034, instance_loss: 0.6161, weighted_loss: 1.0972, label: 1, bag_size: 402
batch 1000, loss: 0.4879, instance_loss: 0.3169, weighted_loss: 0.4366, label: 1, bag_size: 900
batch 1100, loss: 0.3654, instance_loss: 0.2492, weighted_loss: 0.3305, label: 2, bag_size: 2443
batch 1200, loss: 0.0904, instance_loss: 0.1364, weighted_loss: 0.1042, label: 2, bag_size: 489
batch 1300, loss: 1.2186, instance_loss: 0.4519, weighted_loss: 0.9886, label: 2, bag_size: 359
batch 1400, loss: 0.7940, instance_loss: 0.4268, weighted_loss: 0.6839, label: 2, bag_size: 361
batch 1500, loss: 1.0368, instance_loss: 0.6525, weighted_loss: 0.9215, label: 3, bag_size: 681
batch 1600, loss: 0.9981, instance_loss: 0.4234, weighted_loss: 0.8257, label: 1, bag_size: 779
batch 1700, loss: 0.4970, instance_loss: 0.4888, weighted_loss: 0.4945, label: 2, bag_size: 406
batch 1800, loss: 0.5146, instance_loss: 0.5303, weighted_loss: 0.5193, label: 2, bag_size: 521
batch 1900, loss: 0.1099, instance_loss: 0.1031, weighted_loss: 0.1078, label: 2, bag_size: 1308
batch 2000, loss: 1.1531, instance_loss: 0.6147, weighted_loss: 0.9916, label: 2, bag_size: 509
batch 2100, loss: 0.6876, instance_loss: 0.3366, weighted_loss: 0.5823, label: 2, bag_size: 847

Instance Classifier Stats
class 0 clustering acc 0.9843317972350231: correct 68352/69440
class 1 clustering acc 0.4040898617511521: correct 7015/17360

Epoch: 94, train_loss: 0.7067, train_clustering_loss:  0.4017, train_error: 0.3005
coarse class 0: coarse acc 0.022727272727272728, correct coarse 1/44 
coarse class 1: coarse acc 0.6508951406649617, correct coarse 509/782 
coarse class 2: coarse acc 0.8822447102115916, correct coarse 959/1087 
coarse class 3: coarse acc 0.19066147859922178, correct coarse 49/257 
Overall Accuracy: 0.6995

Val Set, val_loss: 0.7452, val_error: 0.3068, auc: 0.7848
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.4308712121212121: correct 910/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4167

Training for coarse level...
batch 100, loss: 0.5481, instance_loss: 0.5538, weighted_loss: 0.5498, label: 2, bag_size: 209
batch 200, loss: 1.3144, instance_loss: 0.8722, weighted_loss: 1.1817, label: 1, bag_size: 315
batch 300, loss: 1.4593, instance_loss: 0.9115, weighted_loss: 1.2950, label: 1, bag_size: 209
batch 400, loss: 0.6593, instance_loss: 0.4558, weighted_loss: 0.5982, label: 2, bag_size: 315
batch 500, loss: 0.1001, instance_loss: 0.2305, weighted_loss: 0.1393, label: 1, bag_size: 235
batch 600, loss: 0.9478, instance_loss: 0.5562, weighted_loss: 0.8303, label: 2, bag_size: 464
batch 700, loss: 0.6800, instance_loss: 0.4338, weighted_loss: 0.6061, label: 2, bag_size: 201
batch 800, loss: 1.0159, instance_loss: 0.6501, weighted_loss: 0.9061, label: 1, bag_size: 1324
batch 900, loss: 0.0319, instance_loss: 0.0977, weighted_loss: 0.0516, label: 2, bag_size: 1137
batch 1000, loss: 0.3609, instance_loss: 0.3039, weighted_loss: 0.3438, label: 2, bag_size: 714
batch 1100, loss: 0.8588, instance_loss: 0.5131, weighted_loss: 0.7551, label: 2, bag_size: 552
batch 1200, loss: 0.0428, instance_loss: 0.0982, weighted_loss: 0.0594, label: 2, bag_size: 682
batch 1300, loss: 0.1558, instance_loss: 0.1653, weighted_loss: 0.1587, label: 2, bag_size: 329
batch 1400, loss: 0.4941, instance_loss: 0.2671, weighted_loss: 0.4260, label: 2, bag_size: 2224
batch 1500, loss: 1.0367, instance_loss: 0.7737, weighted_loss: 0.9578, label: 1, bag_size: 407
batch 1600, loss: 2.9446, instance_loss: 1.1598, weighted_loss: 2.4092, label: 1, bag_size: 510
batch 1700, loss: 0.0603, instance_loss: 0.1208, weighted_loss: 0.0784, label: 1, bag_size: 1435
batch 1800, loss: 4.4517, instance_loss: 1.4304, weighted_loss: 3.5453, label: 3, bag_size: 378
batch 1900, loss: 0.0572, instance_loss: 0.0859, weighted_loss: 0.0658, label: 2, bag_size: 217
batch 2000, loss: 0.7520, instance_loss: 0.4627, weighted_loss: 0.6652, label: 2, bag_size: 277
batch 2100, loss: 0.2917, instance_loss: 0.2406, weighted_loss: 0.2764, label: 1, bag_size: 1006

Instance Classifier Stats
class 0 clustering acc 0.9842597926267281: correct 68347/69440
class 1 clustering acc 0.40691244239631336: correct 7064/17360

Epoch: 95, train_loss: 0.7072, train_clustering_loss:  0.4022, train_error: 0.3092
coarse class 0: coarse acc 0.022727272727272728, correct coarse 1/44 
coarse class 1: coarse acc 0.6713554987212276, correct coarse 525/782 
coarse class 2: coarse acc 0.8629254829806807, correct coarse 938/1087 
coarse class 3: coarse acc 0.13618677042801555, correct coarse 35/257 
Overall Accuracy: 0.6908

Val Set, val_loss: 0.7429, val_error: 0.2992, auc: 0.7863
class 0 clustering acc 0.9828361742424242: correct 8303/8448 
class 1 clustering acc 0.43134469696969696: correct 911/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8955223880597015, correct coarse 120/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.7008
Overall F1 Score: 0.4301

Training for coarse level...
batch 100, loss: 0.0631, instance_loss: 0.1448, weighted_loss: 0.0876, label: 2, bag_size: 256
batch 200, loss: 1.2234, instance_loss: 0.6141, weighted_loss: 1.0406, label: 3, bag_size: 185
batch 300, loss: 0.0158, instance_loss: 0.0532, weighted_loss: 0.0270, label: 2, bag_size: 705
batch 400, loss: 1.4332, instance_loss: 0.8156, weighted_loss: 1.2479, label: 1, bag_size: 1663
batch 500, loss: 0.4689, instance_loss: 0.4912, weighted_loss: 0.4756, label: 3, bag_size: 163
batch 600, loss: 0.2733, instance_loss: 0.1953, weighted_loss: 0.2499, label: 1, bag_size: 1336
batch 700, loss: 0.8919, instance_loss: 0.6583, weighted_loss: 0.8218, label: 1, bag_size: 910
batch 800, loss: 0.0228, instance_loss: 0.0448, weighted_loss: 0.0294, label: 2, bag_size: 331
batch 900, loss: 0.6327, instance_loss: 0.4021, weighted_loss: 0.5635, label: 2, bag_size: 284
batch 1000, loss: 0.8259, instance_loss: 0.5236, weighted_loss: 0.7352, label: 3, bag_size: 487
batch 1100, loss: 1.5931, instance_loss: 0.6973, weighted_loss: 1.3243, label: 1, bag_size: 851
batch 1200, loss: 0.4357, instance_loss: 0.5625, weighted_loss: 0.4738, label: 1, bag_size: 1860
batch 1300, loss: 1.2318, instance_loss: 0.6394, weighted_loss: 1.0541, label: 1, bag_size: 675
batch 1400, loss: 0.1443, instance_loss: 0.1815, weighted_loss: 0.1555, label: 1, bag_size: 270
batch 1500, loss: 0.4680, instance_loss: 0.3470, weighted_loss: 0.4317, label: 1, bag_size: 1184
batch 1600, loss: 0.0290, instance_loss: 0.0925, weighted_loss: 0.0480, label: 2, bag_size: 1137
batch 1700, loss: 0.3877, instance_loss: 0.2482, weighted_loss: 0.3459, label: 2, bag_size: 1238
batch 1800, loss: 0.3525, instance_loss: 0.2807, weighted_loss: 0.3310, label: 1, bag_size: 129
batch 1900, loss: 0.0427, instance_loss: 0.0893, weighted_loss: 0.0567, label: 2, bag_size: 456
batch 2000, loss: 3.3733, instance_loss: 1.4567, weighted_loss: 2.7983, label: 1, bag_size: 608
batch 2100, loss: 2.2353, instance_loss: 0.9676, weighted_loss: 1.8550, label: 3, bag_size: 2314

Instance Classifier Stats
class 0 clustering acc 0.9841013824884792: correct 68336/69440
class 1 clustering acc 0.40691244239631336: correct 7064/17360

Epoch: 96, train_loss: 0.7062, train_clustering_loss:  0.4014, train_error: 0.3046
coarse class 0: coarse acc 0.022727272727272728, correct coarse 1/44 
coarse class 1: coarse acc 0.6585677749360613, correct coarse 515/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.1517509727626459, correct coarse 39/257 
Overall Accuracy: 0.6954

Val Set, val_loss: 0.7430, val_error: 0.2992, auc: 0.7862
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.4303977272727273: correct 909/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8955223880597015, correct coarse 120/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.7008
Overall F1 Score: 0.4301

Training for coarse level...
batch 100, loss: 0.0400, instance_loss: 0.1075, weighted_loss: 0.0602, label: 2, bag_size: 202
batch 200, loss: 0.0556, instance_loss: 0.0881, weighted_loss: 0.0654, label: 2, bag_size: 457
batch 300, loss: 1.0582, instance_loss: 0.4648, weighted_loss: 0.8802, label: 2, bag_size: 734
batch 400, loss: 0.1707, instance_loss: 0.1741, weighted_loss: 0.1717, label: 2, bag_size: 329
batch 500, loss: 0.0142, instance_loss: 0.0260, weighted_loss: 0.0178, label: 2, bag_size: 359
batch 600, loss: 0.9216, instance_loss: 0.5948, weighted_loss: 0.8236, label: 2, bag_size: 387
batch 700, loss: 0.6086, instance_loss: 0.3164, weighted_loss: 0.5209, label: 2, bag_size: 337
batch 800, loss: 0.0312, instance_loss: 0.0314, weighted_loss: 0.0313, label: 1, bag_size: 537
batch 900, loss: 0.1275, instance_loss: 0.1813, weighted_loss: 0.1436, label: 1, bag_size: 755
batch 1000, loss: 1.9952, instance_loss: 0.8446, weighted_loss: 1.6500, label: 2, bag_size: 506
batch 1100, loss: 0.0674, instance_loss: 0.1228, weighted_loss: 0.0840, label: 2, bag_size: 1113
batch 1200, loss: 0.7981, instance_loss: 0.6439, weighted_loss: 0.7519, label: 1, bag_size: 118
batch 1300, loss: 1.4383, instance_loss: 0.7324, weighted_loss: 1.2265, label: 1, bag_size: 377
batch 1400, loss: 0.7848, instance_loss: 0.4243, weighted_loss: 0.6767, label: 2, bag_size: 131
batch 1500, loss: 0.5253, instance_loss: 0.3016, weighted_loss: 0.4582, label: 1, bag_size: 1739
batch 1600, loss: 0.0336, instance_loss: 0.0374, weighted_loss: 0.0347, label: 1, bag_size: 1229
batch 1700, loss: 0.7855, instance_loss: 0.4596, weighted_loss: 0.6877, label: 1, bag_size: 430
batch 1800, loss: 0.3826, instance_loss: 0.2593, weighted_loss: 0.3456, label: 2, bag_size: 280
batch 1900, loss: 0.0361, instance_loss: 0.0728, weighted_loss: 0.0471, label: 1, bag_size: 388
batch 2000, loss: 0.2612, instance_loss: 0.2167, weighted_loss: 0.2479, label: 2, bag_size: 478
batch 2100, loss: 0.0710, instance_loss: 0.0547, weighted_loss: 0.0661, label: 1, bag_size: 350

Instance Classifier Stats
class 0 clustering acc 0.9839285714285714: correct 68324/69440
class 1 clustering acc 0.40535714285714286: correct 7037/17360

Epoch: 97, train_loss: 0.7067, train_clustering_loss:  0.4023, train_error: 0.3000
coarse class 0: coarse acc 0.022727272727272728, correct coarse 1/44 
coarse class 1: coarse acc 0.6483375959079284, correct coarse 507/782 
coarse class 2: coarse acc 0.890524379024839, correct coarse 968/1087 
coarse class 3: coarse acc 0.16731517509727625, correct coarse 43/257 
Overall Accuracy: 0.7000

Val Set, val_loss: 0.7438, val_error: 0.2992, auc: 0.7853
class 0 clustering acc 0.9834280303030303: correct 8308/8448 
class 1 clustering acc 0.4308712121212121: correct 910/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.7008
Overall F1 Score: 0.4313

Training for coarse level...
batch 100, loss: 0.0313, instance_loss: 0.0388, weighted_loss: 0.0336, label: 1, bag_size: 889
batch 200, loss: 2.5496, instance_loss: 1.5265, weighted_loss: 2.2427, label: 2, bag_size: 735
batch 300, loss: 0.0151, instance_loss: 0.0595, weighted_loss: 0.0284, label: 1, bag_size: 1084
batch 400, loss: 0.0352, instance_loss: 0.1506, weighted_loss: 0.0698, label: 1, bag_size: 687
batch 500, loss: 0.0579, instance_loss: 0.1208, weighted_loss: 0.0768, label: 1, bag_size: 1346
batch 600, loss: 1.1186, instance_loss: 0.6813, weighted_loss: 0.9874, label: 3, bag_size: 479
batch 700, loss: 0.6086, instance_loss: 0.3022, weighted_loss: 0.5167, label: 2, bag_size: 343
batch 800, loss: 0.0333, instance_loss: 0.0518, weighted_loss: 0.0389, label: 1, bag_size: 1771
batch 900, loss: 1.2010, instance_loss: 0.5682, weighted_loss: 1.0112, label: 2, bag_size: 331
batch 1000, loss: 0.0480, instance_loss: 0.0719, weighted_loss: 0.0552, label: 1, bag_size: 1476
batch 1100, loss: 1.5913, instance_loss: 0.5036, weighted_loss: 1.2650, label: 1, bag_size: 522
batch 1200, loss: 1.4908, instance_loss: 0.6715, weighted_loss: 1.2450, label: 3, bag_size: 65
batch 1300, loss: 1.4549, instance_loss: 0.7810, weighted_loss: 1.2528, label: 2, bag_size: 3051
batch 1400, loss: 0.4663, instance_loss: 0.3136, weighted_loss: 0.4205, label: 2, bag_size: 313
batch 1500, loss: 3.4990, instance_loss: 1.3281, weighted_loss: 2.8477, label: 3, bag_size: 527
batch 1600, loss: 1.8692, instance_loss: 0.8975, weighted_loss: 1.5777, label: 3, bag_size: 708
batch 1700, loss: 0.6225, instance_loss: 0.4626, weighted_loss: 0.5745, label: 1, bag_size: 473
batch 1800, loss: 0.5347, instance_loss: 0.3649, weighted_loss: 0.4838, label: 2, bag_size: 478
batch 1900, loss: 1.3175, instance_loss: 0.6276, weighted_loss: 1.1105, label: 3, bag_size: 378
batch 2000, loss: 0.6990, instance_loss: 0.5869, weighted_loss: 0.6654, label: 3, bag_size: 152
batch 2100, loss: 1.9727, instance_loss: 0.7111, weighted_loss: 1.5942, label: 1, bag_size: 168

Instance Classifier Stats
class 0 clustering acc 0.9837557603686636: correct 68312/69440
class 1 clustering acc 0.40472350230414744: correct 7026/17360

Epoch: 98, train_loss: 0.7035, train_clustering_loss:  0.4023, train_error: 0.2986
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.659846547314578, correct coarse 516/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.16731517509727625, correct coarse 43/257 
Overall Accuracy: 0.7014

Val Set, val_loss: 0.7460, val_error: 0.3068, auc: 0.7846
class 0 clustering acc 0.9839015151515151: correct 8312/8448 
class 1 clustering acc 0.4308712121212121: correct 910/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6666666666666666, correct coarse 64/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4275

Training for coarse level...
batch 100, loss: 1.9189, instance_loss: 0.8321, weighted_loss: 1.5929, label: 0, bag_size: 482
batch 200, loss: 0.0286, instance_loss: 0.0955, weighted_loss: 0.0487, label: 2, bag_size: 676
batch 300, loss: 0.6820, instance_loss: 0.4961, weighted_loss: 0.6262, label: 2, bag_size: 148
batch 400, loss: 0.0521, instance_loss: 0.0933, weighted_loss: 0.0645, label: 1, bag_size: 1110
batch 500, loss: 0.9623, instance_loss: 0.5636, weighted_loss: 0.8427, label: 2, bag_size: 1897
batch 600, loss: 0.0204, instance_loss: 0.0157, weighted_loss: 0.0190, label: 1, bag_size: 728
batch 700, loss: 0.3527, instance_loss: 0.5398, weighted_loss: 0.4088, label: 1, bag_size: 1744
batch 800, loss: 1.1498, instance_loss: 0.6345, weighted_loss: 0.9952, label: 2, bag_size: 248
batch 900, loss: 1.2120, instance_loss: 0.6488, weighted_loss: 1.0431, label: 3, bag_size: 679
batch 1000, loss: 0.0721, instance_loss: 0.1446, weighted_loss: 0.0939, label: 2, bag_size: 132
batch 1100, loss: 1.0072, instance_loss: 0.5163, weighted_loss: 0.8600, label: 2, bag_size: 555
batch 1200, loss: 3.6503, instance_loss: 1.8808, weighted_loss: 3.1194, label: 3, bag_size: 2158
batch 1300, loss: 0.0535, instance_loss: 0.0747, weighted_loss: 0.0599, label: 1, bag_size: 2213
batch 1400, loss: 1.4170, instance_loss: 0.5710, weighted_loss: 1.1632, label: 3, bag_size: 119
batch 1500, loss: 3.5955, instance_loss: 0.9429, weighted_loss: 2.7997, label: 0, bag_size: 207
batch 1600, loss: 2.1804, instance_loss: 0.9533, weighted_loss: 1.8123, label: 3, bag_size: 945
batch 1700, loss: 1.2973, instance_loss: 0.5677, weighted_loss: 1.0784, label: 1, bag_size: 226
batch 1800, loss: 0.4849, instance_loss: 0.6796, weighted_loss: 0.5433, label: 1, bag_size: 1516
batch 1900, loss: 0.5145, instance_loss: 0.3635, weighted_loss: 0.4692, label: 2, bag_size: 194
batch 2000, loss: 0.1484, instance_loss: 0.1100, weighted_loss: 0.1369, label: 1, bag_size: 3892
batch 2100, loss: 0.0348, instance_loss: 0.0761, weighted_loss: 0.0472, label: 2, bag_size: 762

Instance Classifier Stats
class 0 clustering acc 0.9846342165898617: correct 68373/69440
class 1 clustering acc 0.40288018433179723: correct 6994/17360

Epoch: 99, train_loss: 0.7036, train_clustering_loss:  0.4017, train_error: 0.3051
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.670076726342711, correct coarse 524/782 
coarse class 2: coarse acc 0.8693652253909844, correct coarse 945/1087 
coarse class 3: coarse acc 0.14396887159533073, correct coarse 37/257 
Overall Accuracy: 0.6949

Val Set, val_loss: 0.7427, val_error: 0.3068, auc: 0.7862
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.43134469696969696: correct 911/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4158

Training for coarse level...
batch 100, loss: 0.3655, instance_loss: 0.3736, weighted_loss: 0.3680, label: 1, bag_size: 989
batch 200, loss: 0.7435, instance_loss: 0.5511, weighted_loss: 0.6857, label: 2, bag_size: 1010
batch 300, loss: 0.4867, instance_loss: 0.4037, weighted_loss: 0.4618, label: 1, bag_size: 1678
batch 400, loss: 1.4489, instance_loss: 0.7480, weighted_loss: 1.2386, label: 3, bag_size: 1196
batch 500, loss: 0.3162, instance_loss: 0.4196, weighted_loss: 0.3472, label: 2, bag_size: 271
batch 600, loss: 0.1738, instance_loss: 0.2532, weighted_loss: 0.1976, label: 2, bag_size: 365
batch 700, loss: 0.0259, instance_loss: 0.0649, weighted_loss: 0.0376, label: 2, bag_size: 645
batch 800, loss: 0.3162, instance_loss: 0.2750, weighted_loss: 0.3038, label: 1, bag_size: 333
batch 900, loss: 0.2191, instance_loss: 0.1605, weighted_loss: 0.2015, label: 2, bag_size: 279
batch 1000, loss: 3.7331, instance_loss: 1.7999, weighted_loss: 3.1531, label: 3, bag_size: 2158
batch 1100, loss: 1.0204, instance_loss: 0.4929, weighted_loss: 0.8622, label: 2, bag_size: 390
batch 1200, loss: 1.1150, instance_loss: 0.6491, weighted_loss: 0.9752, label: 1, bag_size: 202
batch 1300, loss: 2.1560, instance_loss: 0.7983, weighted_loss: 1.7487, label: 3, bag_size: 164
batch 1400, loss: 0.9240, instance_loss: 0.4380, weighted_loss: 0.7782, label: 2, bag_size: 555
batch 1500, loss: 0.0350, instance_loss: 0.0563, weighted_loss: 0.0414, label: 2, bag_size: 290
batch 1600, loss: 0.1449, instance_loss: 0.1255, weighted_loss: 0.1391, label: 2, bag_size: 841
batch 1700, loss: 0.8583, instance_loss: 0.3654, weighted_loss: 0.7105, label: 2, bag_size: 465
batch 1800, loss: 0.4590, instance_loss: 0.2760, weighted_loss: 0.4041, label: 2, bag_size: 802
batch 1900, loss: 2.0243, instance_loss: 1.1974, weighted_loss: 1.7762, label: 1, bag_size: 835
batch 2000, loss: 1.0643, instance_loss: 0.6835, weighted_loss: 0.9500, label: 0, bag_size: 113
batch 2100, loss: 0.0428, instance_loss: 0.0640, weighted_loss: 0.0492, label: 2, bag_size: 475

Instance Classifier Stats
class 0 clustering acc 0.9844470046082949: correct 68360/69440
class 1 clustering acc 0.4057603686635945: correct 7044/17360

Epoch: 100, train_loss: 0.7030, train_clustering_loss:  0.4013, train_error: 0.3041
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6624040920716112, correct coarse 518/782 
coarse class 2: coarse acc 0.8794848206071757, correct coarse 956/1087 
coarse class 3: coarse acc 0.13229571984435798, correct coarse 34/257 
Overall Accuracy: 0.6959

Val Set, val_loss: 0.7426, val_error: 0.3030, auc: 0.7864
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.4303977272727273: correct 909/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4280

Training for coarse level...
batch 100, loss: 0.0588, instance_loss: 0.1293, weighted_loss: 0.0799, label: 2, bag_size: 618
batch 200, loss: 1.3625, instance_loss: 0.7424, weighted_loss: 1.1765, label: 3, bag_size: 451
batch 300, loss: 2.5644, instance_loss: 1.0964, weighted_loss: 2.1240, label: 3, bag_size: 715
batch 400, loss: 0.4831, instance_loss: 0.4532, weighted_loss: 0.4741, label: 2, bag_size: 1135
batch 500, loss: 1.6868, instance_loss: 0.7620, weighted_loss: 1.4093, label: 3, bag_size: 216
batch 600, loss: 1.1754, instance_loss: 0.6909, weighted_loss: 1.0300, label: 3, bag_size: 307
batch 700, loss: 0.0527, instance_loss: 0.0315, weighted_loss: 0.0464, label: 1, bag_size: 1445
batch 800, loss: 0.4623, instance_loss: 0.2464, weighted_loss: 0.3975, label: 1, bag_size: 1727
batch 900, loss: 0.0234, instance_loss: 0.0460, weighted_loss: 0.0302, label: 2, bag_size: 563
batch 1000, loss: 0.0202, instance_loss: 0.0670, weighted_loss: 0.0342, label: 1, bag_size: 1534
batch 1100, loss: 2.4937, instance_loss: 1.1954, weighted_loss: 2.1042, label: 3, bag_size: 1529
batch 1200, loss: 0.0574, instance_loss: 0.0600, weighted_loss: 0.0582, label: 2, bag_size: 226
batch 1300, loss: 1.6443, instance_loss: 0.8478, weighted_loss: 1.4054, label: 3, bag_size: 149
batch 1400, loss: 1.4252, instance_loss: 0.7105, weighted_loss: 1.2108, label: 1, bag_size: 215
batch 1500, loss: 0.0589, instance_loss: 0.0813, weighted_loss: 0.0656, label: 1, bag_size: 884
batch 1600, loss: 1.0415, instance_loss: 0.5628, weighted_loss: 0.8979, label: 2, bag_size: 409
batch 1700, loss: 0.2089, instance_loss: 0.3005, weighted_loss: 0.2364, label: 1, bag_size: 497
batch 1800, loss: 0.0822, instance_loss: 0.1253, weighted_loss: 0.0952, label: 1, bag_size: 526
batch 1900, loss: 1.1669, instance_loss: 0.5020, weighted_loss: 0.9674, label: 1, bag_size: 308
batch 2000, loss: 0.5745, instance_loss: 0.2628, weighted_loss: 0.4810, label: 2, bag_size: 333
batch 2100, loss: 1.1147, instance_loss: 0.6366, weighted_loss: 0.9713, label: 3, bag_size: 96

Instance Classifier Stats
class 0 clustering acc 0.9842453917050691: correct 68346/69440
class 1 clustering acc 0.40345622119815666: correct 7004/17360

Epoch: 101, train_loss: 0.7018, train_clustering_loss:  0.4011, train_error: 0.3046
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6560102301790282, correct coarse 513/782 
coarse class 2: coarse acc 0.8776448942042319, correct coarse 954/1087 
coarse class 3: coarse acc 0.1556420233463035, correct coarse 40/257 
Overall Accuracy: 0.6954

Val Set, val_loss: 0.7430, val_error: 0.2955, auc: 0.7846
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.42992424242424243: correct 908/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.7045
Overall F1 Score: 0.4329

Training for coarse level...
batch 100, loss: 0.1505, instance_loss: 0.1389, weighted_loss: 0.1470, label: 1, bag_size: 1090
batch 200, loss: 1.0225, instance_loss: 0.8912, weighted_loss: 0.9831, label: 1, bag_size: 564
batch 300, loss: 0.2146, instance_loss: 0.1776, weighted_loss: 0.2035, label: 1, bag_size: 2433
batch 400, loss: 1.5983, instance_loss: 0.5655, weighted_loss: 1.2885, label: 1, bag_size: 1134
batch 500, loss: 0.2700, instance_loss: 0.3088, weighted_loss: 0.2816, label: 2, bag_size: 411
batch 600, loss: 0.7788, instance_loss: 0.5928, weighted_loss: 0.7230, label: 2, bag_size: 896
batch 700, loss: 0.8020, instance_loss: 0.4843, weighted_loss: 0.7067, label: 1, bag_size: 225
batch 800, loss: 0.6231, instance_loss: 0.4372, weighted_loss: 0.5673, label: 2, bag_size: 245
batch 900, loss: 0.5211, instance_loss: 0.4381, weighted_loss: 0.4962, label: 2, bag_size: 979
batch 1000, loss: 0.0799, instance_loss: 0.0875, weighted_loss: 0.0822, label: 1, bag_size: 1466
batch 1100, loss: 0.5483, instance_loss: 0.3240, weighted_loss: 0.4810, label: 2, bag_size: 833
batch 1200, loss: 0.0731, instance_loss: 0.1248, weighted_loss: 0.0886, label: 2, bag_size: 353
batch 1300, loss: 1.2617, instance_loss: 0.5367, weighted_loss: 1.0442, label: 2, bag_size: 304
batch 1400, loss: 0.8161, instance_loss: 0.5632, weighted_loss: 0.7402, label: 3, bag_size: 210
batch 1500, loss: 0.1235, instance_loss: 0.1521, weighted_loss: 0.1321, label: 1, bag_size: 671
batch 1600, loss: 0.4037, instance_loss: 0.3273, weighted_loss: 0.3808, label: 2, bag_size: 640
batch 1700, loss: 3.3938, instance_loss: 1.2816, weighted_loss: 2.7601, label: 1, bag_size: 665
batch 1800, loss: 0.0977, instance_loss: 0.0901, weighted_loss: 0.0954, label: 2, bag_size: 1072
batch 1900, loss: 0.0316, instance_loss: 0.0491, weighted_loss: 0.0369, label: 1, bag_size: 606
batch 2000, loss: 1.1102, instance_loss: 0.5692, weighted_loss: 0.9479, label: 1, bag_size: 520
batch 2100, loss: 1.4732, instance_loss: 0.7479, weighted_loss: 1.2556, label: 1, bag_size: 260

Instance Classifier Stats
class 0 clustering acc 0.9838709677419355: correct 68320/69440
class 1 clustering acc 0.40639400921658986: correct 7055/17360

Epoch: 102, train_loss: 0.7012, train_clustering_loss:  0.4009, train_error: 0.3046
coarse class 0: coarse acc 0.022727272727272728, correct coarse 1/44 
coarse class 1: coarse acc 0.6572890025575447, correct coarse 514/782 
coarse class 2: coarse acc 0.8702851885924563, correct coarse 946/1087 
coarse class 3: coarse acc 0.1867704280155642, correct coarse 48/257 
Overall Accuracy: 0.6954

Val Set, val_loss: 0.7431, val_error: 0.2992, auc: 0.7843
class 0 clustering acc 0.9828361742424242: correct 8303/8448 
class 1 clustering acc 0.42945075757575757: correct 907/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.7008
Overall F1 Score: 0.4208

Training for coarse level...
batch 100, loss: 0.2123, instance_loss: 0.3296, weighted_loss: 0.2475, label: 1, bag_size: 497
batch 200, loss: 0.7158, instance_loss: 0.3706, weighted_loss: 0.6123, label: 2, bag_size: 322
batch 300, loss: 0.7068, instance_loss: 0.4590, weighted_loss: 0.6324, label: 2, bag_size: 406
batch 400, loss: 1.2560, instance_loss: 0.6715, weighted_loss: 1.0807, label: 3, bag_size: 195
batch 500, loss: 0.3226, instance_loss: 0.3558, weighted_loss: 0.3325, label: 2, bag_size: 625
batch 600, loss: 0.6644, instance_loss: 0.4552, weighted_loss: 0.6016, label: 2, bag_size: 1549
batch 700, loss: 0.0978, instance_loss: 0.0666, weighted_loss: 0.0885, label: 1, bag_size: 2537
batch 800, loss: 2.1675, instance_loss: 0.9924, weighted_loss: 1.8150, label: 3, bag_size: 945
batch 900, loss: 0.0819, instance_loss: 0.1120, weighted_loss: 0.0909, label: 2, bag_size: 2663
batch 1000, loss: 0.6447, instance_loss: 0.5644, weighted_loss: 0.6206, label: 1, bag_size: 975
batch 1100, loss: 0.3880, instance_loss: 0.2158, weighted_loss: 0.3364, label: 1, bag_size: 2612
batch 1200, loss: 0.0788, instance_loss: 0.1302, weighted_loss: 0.0942, label: 2, bag_size: 728
batch 1300, loss: 1.0281, instance_loss: 0.4834, weighted_loss: 0.8647, label: 2, bag_size: 644
batch 1400, loss: 0.7355, instance_loss: 0.7495, weighted_loss: 0.7397, label: 1, bag_size: 49
batch 1500, loss: 0.1647, instance_loss: 0.1689, weighted_loss: 0.1660, label: 1, bag_size: 945
batch 1600, loss: 0.0236, instance_loss: 0.0631, weighted_loss: 0.0354, label: 2, bag_size: 393
batch 1700, loss: 0.0339, instance_loss: 0.0714, weighted_loss: 0.0452, label: 1, bag_size: 388
batch 1800, loss: 0.0852, instance_loss: 0.1272, weighted_loss: 0.0978, label: 2, bag_size: 412
batch 1900, loss: 1.4187, instance_loss: 0.7224, weighted_loss: 1.2098, label: 3, bag_size: 253
batch 2000, loss: 0.0763, instance_loss: 0.0634, weighted_loss: 0.0725, label: 2, bag_size: 518
batch 2100, loss: 0.8899, instance_loss: 0.5161, weighted_loss: 0.7778, label: 1, bag_size: 575

Instance Classifier Stats
class 0 clustering acc 0.984317396313364: correct 68351/69440
class 1 clustering acc 0.40858294930875577: correct 7093/17360

Epoch: 103, train_loss: 0.7002, train_clustering_loss:  0.4004, train_error: 0.3009
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6649616368286445, correct coarse 520/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.14396887159533073, correct coarse 37/257 
Overall Accuracy: 0.6991

Val Set, val_loss: 0.7445, val_error: 0.3068, auc: 0.7843
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.42992424242424243: correct 908/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4263

Training for coarse level...
batch 100, loss: 1.0104, instance_loss: 0.7408, weighted_loss: 0.9295, label: 1, bag_size: 823
batch 200, loss: 1.1382, instance_loss: 0.6146, weighted_loss: 0.9811, label: 3, bag_size: 490
batch 300, loss: 0.0305, instance_loss: 0.0403, weighted_loss: 0.0334, label: 1, bag_size: 606
batch 400, loss: 1.3790, instance_loss: 0.6542, weighted_loss: 1.1616, label: 1, bag_size: 295
batch 500, loss: 0.3614, instance_loss: 0.1868, weighted_loss: 0.3090, label: 2, bag_size: 679
batch 600, loss: 0.0402, instance_loss: 0.0704, weighted_loss: 0.0492, label: 2, bag_size: 699
batch 700, loss: 0.0196, instance_loss: 0.0585, weighted_loss: 0.0313, label: 2, bag_size: 474
batch 800, loss: 1.2635, instance_loss: 0.6684, weighted_loss: 1.0850, label: 1, bag_size: 320
batch 900, loss: 0.0254, instance_loss: 0.0370, weighted_loss: 0.0289, label: 2, bag_size: 331
batch 1000, loss: 1.1235, instance_loss: 0.5458, weighted_loss: 0.9502, label: 2, bag_size: 276
batch 1100, loss: 0.8088, instance_loss: 0.4665, weighted_loss: 0.7061, label: 2, bag_size: 1004
batch 1200, loss: 0.3224, instance_loss: 0.2861, weighted_loss: 0.3115, label: 2, bag_size: 543
batch 1300, loss: 3.4678, instance_loss: 1.2576, weighted_loss: 2.8048, label: 3, bag_size: 233
batch 1400, loss: 0.0464, instance_loss: 0.0852, weighted_loss: 0.0581, label: 2, bag_size: 332
batch 1500, loss: 1.5035, instance_loss: 0.6679, weighted_loss: 1.2528, label: 1, bag_size: 1299
batch 1600, loss: 0.4239, instance_loss: 0.4266, weighted_loss: 0.4247, label: 2, bag_size: 171
batch 1700, loss: 0.8002, instance_loss: 0.4344, weighted_loss: 0.6905, label: 2, bag_size: 599
batch 1800, loss: 0.1456, instance_loss: 0.1957, weighted_loss: 0.1606, label: 1, bag_size: 755
batch 1900, loss: 0.7275, instance_loss: 0.4862, weighted_loss: 0.6551, label: 2, bag_size: 347
batch 2000, loss: 0.0327, instance_loss: 0.0523, weighted_loss: 0.0386, label: 2, bag_size: 403
batch 2100, loss: 0.5025, instance_loss: 0.2662, weighted_loss: 0.4316, label: 2, bag_size: 311

Instance Classifier Stats
class 0 clustering acc 0.9842021889400921: correct 68343/69440
class 1 clustering acc 0.4058179723502304: correct 7045/17360

Epoch: 104, train_loss: 0.6991, train_clustering_loss:  0.4006, train_error: 0.3032
coarse class 0: coarse acc 0.022727272727272728, correct coarse 1/44 
coarse class 1: coarse acc 0.670076726342711, correct coarse 524/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.1517509727626459, correct coarse 39/257 
Overall Accuracy: 0.6968

Val Set, val_loss: 0.7428, val_error: 0.2992, auc: 0.7845
class 0 clustering acc 0.9829545454545454: correct 8304/8448 
class 1 clustering acc 0.42945075757575757: correct 907/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6354166666666666, correct coarse 61/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.7008
Overall F1 Score: 0.4307

Training for coarse level...
batch 100, loss: 0.1267, instance_loss: 0.0971, weighted_loss: 0.1178, label: 1, bag_size: 1231
batch 200, loss: 0.1769, instance_loss: 0.1037, weighted_loss: 0.1549, label: 2, bag_size: 229
batch 300, loss: 0.0402, instance_loss: 0.0528, weighted_loss: 0.0439, label: 2, bag_size: 221
batch 400, loss: 0.3692, instance_loss: 0.3515, weighted_loss: 0.3639, label: 2, bag_size: 129
batch 500, loss: 0.8431, instance_loss: 0.5675, weighted_loss: 0.7604, label: 3, bag_size: 209
batch 600, loss: 0.0403, instance_loss: 0.0865, weighted_loss: 0.0542, label: 2, bag_size: 311
batch 700, loss: 1.2243, instance_loss: 0.7753, weighted_loss: 1.0896, label: 1, bag_size: 394
batch 800, loss: 0.0345, instance_loss: 0.0870, weighted_loss: 0.0503, label: 2, bag_size: 456
batch 900, loss: 0.5894, instance_loss: 0.3931, weighted_loss: 0.5305, label: 2, bag_size: 808
batch 1000, loss: 0.0896, instance_loss: 0.0906, weighted_loss: 0.0899, label: 2, bag_size: 733
batch 1100, loss: 0.6028, instance_loss: 0.5516, weighted_loss: 0.5874, label: 3, bag_size: 172
batch 1200, loss: 0.4854, instance_loss: 0.3618, weighted_loss: 0.4483, label: 2, bag_size: 838
batch 1300, loss: 2.8434, instance_loss: 1.2735, weighted_loss: 2.3724, label: 3, bag_size: 427
batch 1400, loss: 2.6526, instance_loss: 1.0562, weighted_loss: 2.1737, label: 2, bag_size: 1555
batch 1500, loss: 2.2840, instance_loss: 1.0116, weighted_loss: 1.9022, label: 3, bag_size: 2314
batch 1600, loss: 0.1582, instance_loss: 0.1383, weighted_loss: 0.1522, label: 2, bag_size: 568
batch 1700, loss: 0.5576, instance_loss: 0.3337, weighted_loss: 0.4904, label: 2, bag_size: 394
batch 1800, loss: 0.3112, instance_loss: 0.3427, weighted_loss: 0.3207, label: 1, bag_size: 1279
batch 1900, loss: 0.0687, instance_loss: 0.0865, weighted_loss: 0.0740, label: 1, bag_size: 940
batch 2000, loss: 0.0118, instance_loss: 0.0226, weighted_loss: 0.0151, label: 2, bag_size: 732
batch 2100, loss: 0.0601, instance_loss: 0.0601, weighted_loss: 0.0601, label: 2, bag_size: 1325

Instance Classifier Stats
class 0 clustering acc 0.9838853686635944: correct 68321/69440
class 1 clustering acc 0.4067972350230415: correct 7062/17360

Epoch: 105, train_loss: 0.6975, train_clustering_loss:  0.4002, train_error: 0.3023
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.659846547314578, correct coarse 516/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.14785992217898833, correct coarse 38/257 
Overall Accuracy: 0.6977

Val Set, val_loss: 0.7438, val_error: 0.2992, auc: 0.7842
class 0 clustering acc 0.9830729166666666: correct 8305/8448 
class 1 clustering acc 0.4289772727272727: correct 906/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.7008
Overall F1 Score: 0.4303

Training for coarse level...
batch 100, loss: 0.9795, instance_loss: 0.5113, weighted_loss: 0.8390, label: 2, bag_size: 252
batch 200, loss: 0.0078, instance_loss: 0.0372, weighted_loss: 0.0166, label: 2, bag_size: 307
batch 300, loss: 1.2692, instance_loss: 0.5864, weighted_loss: 1.0644, label: 1, bag_size: 529
batch 400, loss: 0.8363, instance_loss: 0.6153, weighted_loss: 0.7700, label: 3, bag_size: 209
batch 500, loss: 1.1670, instance_loss: 0.6222, weighted_loss: 1.0035, label: 1, bag_size: 933
batch 600, loss: 0.0842, instance_loss: 0.0793, weighted_loss: 0.0827, label: 2, bag_size: 794
batch 700, loss: 1.2811, instance_loss: 0.6341, weighted_loss: 1.0870, label: 1, bag_size: 168
batch 800, loss: 0.1873, instance_loss: 0.4177, weighted_loss: 0.2564, label: 1, bag_size: 1700
batch 900, loss: 0.5147, instance_loss: 0.3857, weighted_loss: 0.4760, label: 1, bag_size: 818
batch 1000, loss: 0.2487, instance_loss: 0.2640, weighted_loss: 0.2533, label: 1, bag_size: 1006
batch 1100, loss: 0.7919, instance_loss: 0.4965, weighted_loss: 0.7033, label: 1, bag_size: 566
batch 1200, loss: 0.6482, instance_loss: 0.4666, weighted_loss: 0.5937, label: 2, bag_size: 233
batch 1300, loss: 0.0658, instance_loss: 0.1131, weighted_loss: 0.0800, label: 2, bag_size: 328
batch 1400, loss: 0.9079, instance_loss: 0.5860, weighted_loss: 0.8114, label: 1, bag_size: 204
batch 1500, loss: 0.0619, instance_loss: 0.0868, weighted_loss: 0.0694, label: 2, bag_size: 292
batch 1600, loss: 0.2010, instance_loss: 0.2198, weighted_loss: 0.2067, label: 1, bag_size: 398
batch 1700, loss: 1.4929, instance_loss: 0.6810, weighted_loss: 1.2493, label: 3, bag_size: 253
batch 1800, loss: 1.3525, instance_loss: 0.8089, weighted_loss: 1.1894, label: 3, bag_size: 451
batch 1900, loss: 0.2674, instance_loss: 0.3095, weighted_loss: 0.2801, label: 2, bag_size: 411
batch 2000, loss: 0.6140, instance_loss: 0.3792, weighted_loss: 0.5435, label: 2, bag_size: 704
batch 2100, loss: 0.1519, instance_loss: 0.4166, weighted_loss: 0.2313, label: 1, bag_size: 1404

Instance Classifier Stats
class 0 clustering acc 0.9840725806451613: correct 68334/69440
class 1 clustering acc 0.4074884792626728: correct 7074/17360

Epoch: 106, train_loss: 0.6967, train_clustering_loss:  0.4008, train_error: 0.2977
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6687979539641944, correct coarse 523/782 
coarse class 2: coarse acc 0.8785648574057038, correct coarse 955/1087 
coarse class 3: coarse acc 0.17120622568093385, correct coarse 44/257 
Overall Accuracy: 0.7023

Val Set, val_loss: 0.7426, val_error: 0.3144, auc: 0.7850
class 0 clustering acc 0.9825994318181818: correct 8301/8448 
class 1 clustering acc 0.4285037878787879: correct 905/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8805970149253731, correct coarse 118/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4205

Training for coarse level...
batch 100, loss: 0.3758, instance_loss: 0.4295, weighted_loss: 0.3919, label: 2, bag_size: 843
batch 200, loss: 0.0290, instance_loss: 0.0638, weighted_loss: 0.0395, label: 2, bag_size: 668
batch 300, loss: 1.1739, instance_loss: 0.6297, weighted_loss: 1.0107, label: 1, bag_size: 262
batch 400, loss: 0.6298, instance_loss: 0.3353, weighted_loss: 0.5414, label: 2, bag_size: 370
batch 500, loss: 0.2210, instance_loss: 0.1763, weighted_loss: 0.2076, label: 1, bag_size: 2045
batch 600, loss: 0.5401, instance_loss: 0.5520, weighted_loss: 0.5437, label: 3, bag_size: 665
batch 700, loss: 0.5213, instance_loss: 0.4385, weighted_loss: 0.4964, label: 1, bag_size: 223
batch 800, loss: 0.0163, instance_loss: 0.0518, weighted_loss: 0.0270, label: 2, bag_size: 274
batch 900, loss: 1.0027, instance_loss: 0.6459, weighted_loss: 0.8957, label: 1, bag_size: 50
batch 1000, loss: 0.0983, instance_loss: 0.1465, weighted_loss: 0.1128, label: 2, bag_size: 239
batch 1100, loss: 0.9527, instance_loss: 0.4130, weighted_loss: 0.7908, label: 2, bag_size: 224
batch 1200, loss: 0.6496, instance_loss: 0.4933, weighted_loss: 0.6027, label: 1, bag_size: 204
batch 1300, loss: 0.6934, instance_loss: 0.3690, weighted_loss: 0.5961, label: 2, bag_size: 654
batch 1400, loss: 1.3417, instance_loss: 0.7941, weighted_loss: 1.1775, label: 3, bag_size: 338
batch 1500, loss: 1.5060, instance_loss: 0.6531, weighted_loss: 1.2501, label: 0, bag_size: 37
batch 1600, loss: 0.8111, instance_loss: 0.5023, weighted_loss: 0.7185, label: 2, bag_size: 1271
batch 1700, loss: 0.5994, instance_loss: 0.3337, weighted_loss: 0.5197, label: 2, bag_size: 658
batch 1800, loss: 0.0463, instance_loss: 0.0835, weighted_loss: 0.0574, label: 2, bag_size: 488
batch 1900, loss: 0.3083, instance_loss: 0.2095, weighted_loss: 0.2787, label: 2, bag_size: 770
batch 2000, loss: 0.8938, instance_loss: 0.6279, weighted_loss: 0.8141, label: 1, bag_size: 169
batch 2100, loss: 1.5761, instance_loss: 0.7742, weighted_loss: 1.3355, label: 3, bag_size: 661

Instance Classifier Stats
class 0 clustering acc 0.9838565668202764: correct 68319/69440
class 1 clustering acc 0.4070852534562212: correct 7067/17360

Epoch: 107, train_loss: 0.6960, train_clustering_loss:  0.4004, train_error: 0.2945
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6636828644501279, correct coarse 519/782 
coarse class 2: coarse acc 0.8868445262189513, correct coarse 964/1087 
coarse class 3: coarse acc 0.17898832684824903, correct coarse 46/257 
Overall Accuracy: 0.7055

Val Set, val_loss: 0.7441, val_error: 0.3030, auc: 0.7841
class 0 clustering acc 0.9833096590909091: correct 8307/8448 
class 1 clustering acc 0.4275568181818182: correct 903/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4283

Training for coarse level...
batch 100, loss: 0.0337, instance_loss: 0.0737, weighted_loss: 0.0457, label: 2, bag_size: 835
batch 200, loss: 1.5431, instance_loss: 0.7890, weighted_loss: 1.3169, label: 3, bag_size: 483
batch 300, loss: 0.0675, instance_loss: 0.0998, weighted_loss: 0.0772, label: 2, bag_size: 788
batch 400, loss: 0.0226, instance_loss: 0.0613, weighted_loss: 0.0342, label: 1, bag_size: 1460
batch 500, loss: 0.0602, instance_loss: 0.0861, weighted_loss: 0.0680, label: 1, bag_size: 2213
batch 600, loss: 0.3469, instance_loss: 0.1879, weighted_loss: 0.2992, label: 2, bag_size: 604
batch 700, loss: 1.6194, instance_loss: 0.7342, weighted_loss: 1.3538, label: 1, bag_size: 1134
batch 800, loss: 0.8034, instance_loss: 0.3863, weighted_loss: 0.6783, label: 2, bag_size: 1004
batch 900, loss: 1.3395, instance_loss: 0.6449, weighted_loss: 1.1311, label: 1, bag_size: 411
batch 1000, loss: 0.8153, instance_loss: 0.4228, weighted_loss: 0.6976, label: 2, bag_size: 1271
batch 1100, loss: 0.0475, instance_loss: 0.0744, weighted_loss: 0.0556, label: 1, bag_size: 847
batch 1200, loss: 0.6830, instance_loss: 0.5423, weighted_loss: 0.6408, label: 1, bag_size: 976
batch 1300, loss: 1.3965, instance_loss: 0.6514, weighted_loss: 1.1730, label: 1, bag_size: 1299
batch 1400, loss: 0.8913, instance_loss: 0.4643, weighted_loss: 0.7632, label: 2, bag_size: 361
batch 1500, loss: 0.0766, instance_loss: 0.1074, weighted_loss: 0.0859, label: 2, bag_size: 690
batch 1600, loss: 0.1061, instance_loss: 0.1572, weighted_loss: 0.1215, label: 2, bag_size: 1246
batch 1700, loss: 1.2098, instance_loss: 0.6570, weighted_loss: 1.0439, label: 1, bag_size: 933
batch 1800, loss: 0.6290, instance_loss: 0.4370, weighted_loss: 0.5714, label: 1, bag_size: 398
batch 1900, loss: 0.5776, instance_loss: 0.4357, weighted_loss: 0.5350, label: 2, bag_size: 394
batch 2000, loss: 3.3154, instance_loss: 1.4184, weighted_loss: 2.7463, label: 1, bag_size: 665
batch 2100, loss: 0.0402, instance_loss: 0.0968, weighted_loss: 0.0572, label: 2, bag_size: 97

Instance Classifier Stats
class 0 clustering acc 0.9847062211981567: correct 68378/69440
class 1 clustering acc 0.40858294930875577: correct 7093/17360

Epoch: 108, train_loss: 0.6951, train_clustering_loss:  0.3998, train_error: 0.2945
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6739130434782609, correct coarse 527/782 
coarse class 2: coarse acc 0.8804047838086476, correct coarse 957/1087 
coarse class 3: coarse acc 0.17509727626459143, correct coarse 45/257 
Overall Accuracy: 0.7055

Val Set, val_loss: 0.7438, val_error: 0.3030, auc: 0.7842
class 0 clustering acc 0.9834280303030303: correct 8308/8448 
class 1 clustering acc 0.4275568181818182: correct 903/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4283

Training for coarse level...
batch 100, loss: 0.7367, instance_loss: 0.4019, weighted_loss: 0.6363, label: 2, bag_size: 1122
batch 200, loss: 1.0754, instance_loss: 0.7141, weighted_loss: 0.9670, label: 3, bag_size: 160
batch 300, loss: 0.6452, instance_loss: 0.4151, weighted_loss: 0.5762, label: 2, bag_size: 704
batch 400, loss: 0.2463, instance_loss: 0.3058, weighted_loss: 0.2642, label: 1, bag_size: 193
batch 500, loss: 0.0298, instance_loss: 0.0533, weighted_loss: 0.0369, label: 2, bag_size: 365
batch 600, loss: 0.0423, instance_loss: 0.0504, weighted_loss: 0.0447, label: 2, bag_size: 542
batch 700, loss: 0.4816, instance_loss: 0.3033, weighted_loss: 0.4281, label: 2, bag_size: 364
batch 800, loss: 1.0302, instance_loss: 0.6786, weighted_loss: 0.9247, label: 3, bag_size: 830
batch 900, loss: 0.9756, instance_loss: 0.4570, weighted_loss: 0.8200, label: 2, bag_size: 552
batch 1000, loss: 1.2587, instance_loss: 0.6187, weighted_loss: 1.0667, label: 3, bag_size: 378
batch 1100, loss: 0.7537, instance_loss: 0.5105, weighted_loss: 0.6807, label: 2, bag_size: 40
batch 1200, loss: 0.0558, instance_loss: 0.1297, weighted_loss: 0.0780, label: 2, bag_size: 330
batch 1300, loss: 0.5424, instance_loss: 0.3745, weighted_loss: 0.4920, label: 2, bag_size: 361
batch 1400, loss: 0.0394, instance_loss: 0.0882, weighted_loss: 0.0540, label: 2, bag_size: 762
batch 1500, loss: 0.4865, instance_loss: 0.3125, weighted_loss: 0.4343, label: 2, bag_size: 298
batch 1600, loss: 0.1506, instance_loss: 0.1652, weighted_loss: 0.1550, label: 1, bag_size: 1427
batch 1700, loss: 0.0227, instance_loss: 0.0441, weighted_loss: 0.0291, label: 2, bag_size: 280
batch 1800, loss: 0.0826, instance_loss: 0.1422, weighted_loss: 0.1005, label: 1, bag_size: 3332
batch 1900, loss: 0.5196, instance_loss: 0.2731, weighted_loss: 0.4457, label: 1, bag_size: 900
batch 2000, loss: 0.6666, instance_loss: 0.4097, weighted_loss: 0.5895, label: 2, bag_size: 206
batch 2100, loss: 0.5101, instance_loss: 0.3888, weighted_loss: 0.4737, label: 2, bag_size: 476

Instance Classifier Stats
class 0 clustering acc 0.9846486175115208: correct 68374/69440
class 1 clustering acc 0.40720046082949307: correct 7069/17360

Epoch: 109, train_loss: 0.6954, train_clustering_loss:  0.3991, train_error: 0.3023
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.659846547314578, correct coarse 516/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.17120622568093385, correct coarse 44/257 
Overall Accuracy: 0.6977

Val Set, val_loss: 0.7432, val_error: 0.2955, auc: 0.7844
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.4285037878787879: correct 905/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.7045
Overall F1 Score: 0.4331

Training for coarse level...
batch 100, loss: 0.2725, instance_loss: 0.2273, weighted_loss: 0.2589, label: 1, bag_size: 1772
batch 200, loss: 0.3469, instance_loss: 0.2527, weighted_loss: 0.3187, label: 2, bag_size: 1222
batch 300, loss: 1.5170, instance_loss: 0.6238, weighted_loss: 1.2490, label: 3, bag_size: 313
batch 400, loss: 0.0916, instance_loss: 0.1270, weighted_loss: 0.1022, label: 2, bag_size: 502
batch 500, loss: 1.2823, instance_loss: 0.5979, weighted_loss: 1.0770, label: 1, bag_size: 861
batch 600, loss: 0.0524, instance_loss: 0.1069, weighted_loss: 0.0688, label: 1, bag_size: 1967
batch 700, loss: 2.8991, instance_loss: 1.1292, weighted_loss: 2.3682, label: 2, bag_size: 1555
batch 800, loss: 0.2878, instance_loss: 0.3029, weighted_loss: 0.2923, label: 2, bag_size: 1360
batch 900, loss: 0.0507, instance_loss: 0.0729, weighted_loss: 0.0573, label: 1, bag_size: 1078
batch 1000, loss: 0.0771, instance_loss: 0.0797, weighted_loss: 0.0779, label: 1, bag_size: 748
batch 1100, loss: 1.0193, instance_loss: 0.6222, weighted_loss: 0.9002, label: 1, bag_size: 552
batch 1200, loss: 1.7247, instance_loss: 0.7991, weighted_loss: 1.4471, label: 3, bag_size: 149
batch 1300, loss: 1.2054, instance_loss: 0.5136, weighted_loss: 0.9978, label: 1, bag_size: 301
batch 1400, loss: 0.1843, instance_loss: 0.1531, weighted_loss: 0.1749, label: 2, bag_size: 1600
batch 1500, loss: 0.6513, instance_loss: 0.4414, weighted_loss: 0.5883, label: 2, bag_size: 338
batch 1600, loss: 0.2917, instance_loss: 0.2829, weighted_loss: 0.2891, label: 2, bag_size: 507
batch 1700, loss: 0.9736, instance_loss: 0.4685, weighted_loss: 0.8221, label: 2, bag_size: 373
batch 1800, loss: 1.1859, instance_loss: 0.5909, weighted_loss: 1.0074, label: 1, bag_size: 510
batch 1900, loss: 0.8769, instance_loss: 0.4410, weighted_loss: 0.7461, label: 2, bag_size: 1355
batch 2000, loss: 0.6440, instance_loss: 0.4206, weighted_loss: 0.5770, label: 2, bag_size: 148
batch 2100, loss: 0.0629, instance_loss: 0.1408, weighted_loss: 0.0863, label: 2, bag_size: 132

Instance Classifier Stats
class 0 clustering acc 0.9840581797235023: correct 68333/69440
class 1 clustering acc 0.40904377880184334: correct 7101/17360

Epoch: 110, train_loss: 0.6935, train_clustering_loss:  0.3988, train_error: 0.3000
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.659846547314578, correct coarse 516/782 
coarse class 2: coarse acc 0.8840846366145354, correct coarse 961/1087 
coarse class 3: coarse acc 0.1556420233463035, correct coarse 40/257 
Overall Accuracy: 0.7000

Val Set, val_loss: 0.7437, val_error: 0.3030, auc: 0.7841
class 0 clustering acc 0.9830729166666666: correct 8305/8448 
class 1 clustering acc 0.4285037878787879: correct 905/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4280

Training for coarse level...
batch 100, loss: 0.9650, instance_loss: 0.3252, weighted_loss: 0.7731, label: 2, bag_size: 714
batch 200, loss: 1.1286, instance_loss: 0.6251, weighted_loss: 0.9775, label: 3, bag_size: 490
batch 300, loss: 0.0474, instance_loss: 0.0586, weighted_loss: 0.0507, label: 1, bag_size: 623
batch 400, loss: 0.0584, instance_loss: 0.1080, weighted_loss: 0.0733, label: 1, bag_size: 334
batch 500, loss: 1.1856, instance_loss: 0.6661, weighted_loss: 1.0297, label: 1, bag_size: 197
batch 600, loss: 1.2140, instance_loss: 0.6099, weighted_loss: 1.0327, label: 1, bag_size: 675
batch 700, loss: 0.5364, instance_loss: 0.2608, weighted_loss: 0.4537, label: 1, bag_size: 1477
batch 800, loss: 2.1538, instance_loss: 0.9050, weighted_loss: 1.7792, label: 3, bag_size: 462
batch 900, loss: 1.5148, instance_loss: 0.7020, weighted_loss: 1.2709, label: 3, bag_size: 716
batch 1000, loss: 1.6502, instance_loss: 0.7073, weighted_loss: 1.3673, label: 3, bag_size: 571
batch 1100, loss: 0.8477, instance_loss: 0.4112, weighted_loss: 0.7167, label: 2, bag_size: 575
batch 1200, loss: 0.9048, instance_loss: 0.5529, weighted_loss: 0.7992, label: 2, bag_size: 316
batch 1300, loss: 1.6898, instance_loss: 0.6544, weighted_loss: 1.3792, label: 3, bag_size: 435
batch 1400, loss: 0.4912, instance_loss: 0.3643, weighted_loss: 0.4531, label: 1, bag_size: 1114
batch 1500, loss: 1.1122, instance_loss: 0.5489, weighted_loss: 0.9432, label: 1, bag_size: 613
batch 1600, loss: 0.7274, instance_loss: 0.4263, weighted_loss: 0.6371, label: 2, bag_size: 406
batch 1700, loss: 0.9272, instance_loss: 0.5764, weighted_loss: 0.8220, label: 1, bag_size: 237
batch 1800, loss: 0.7020, instance_loss: 0.2888, weighted_loss: 0.5780, label: 2, bag_size: 847
batch 1900, loss: 0.2054, instance_loss: 0.2256, weighted_loss: 0.2115, label: 1, bag_size: 425
batch 2000, loss: 1.2227, instance_loss: 0.7241, weighted_loss: 1.0731, label: 1, bag_size: 726
batch 2100, loss: 0.0602, instance_loss: 0.0914, weighted_loss: 0.0696, label: 2, bag_size: 619

Instance Classifier Stats
class 0 clustering acc 0.9841733870967742: correct 68341/69440
class 1 clustering acc 0.40875576036866357: correct 7096/17360

Epoch: 111, train_loss: 0.6928, train_clustering_loss:  0.3988, train_error: 0.2949
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6687979539641944, correct coarse 523/782 
coarse class 2: coarse acc 0.8739650413983441, correct coarse 950/1087 
coarse class 3: coarse acc 0.2140077821011673, correct coarse 55/257 
Overall Accuracy: 0.7051

Val Set, val_loss: 0.7451, val_error: 0.3030, auc: 0.7831
class 0 clustering acc 0.9831912878787878: correct 8306/8448 
class 1 clustering acc 0.4270833333333333: correct 902/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6666666666666666, correct coarse 64/96 
coarse class 2: coarse acc 0.8582089552238806, correct coarse 115/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4290

Training for coarse level...
batch 100, loss: 0.0304, instance_loss: 0.0569, weighted_loss: 0.0384, label: 2, bag_size: 185
batch 200, loss: 0.8573, instance_loss: 0.3904, weighted_loss: 0.7172, label: 2, bag_size: 462
batch 300, loss: 0.0848, instance_loss: 0.1088, weighted_loss: 0.0920, label: 2, bag_size: 624
batch 400, loss: 0.0341, instance_loss: 0.0611, weighted_loss: 0.0422, label: 1, bag_size: 260
batch 500, loss: 1.0197, instance_loss: 0.3647, weighted_loss: 0.8232, label: 2, bag_size: 394
batch 600, loss: 0.5200, instance_loss: 0.3275, weighted_loss: 0.4623, label: 2, bag_size: 523
batch 700, loss: 0.6180, instance_loss: 0.6187, weighted_loss: 0.6182, label: 3, bag_size: 472
batch 800, loss: 0.2749, instance_loss: 0.2124, weighted_loss: 0.2561, label: 2, bag_size: 1000
batch 900, loss: 0.1853, instance_loss: 0.1860, weighted_loss: 0.1856, label: 1, bag_size: 1706
batch 1000, loss: 0.1084, instance_loss: 0.1830, weighted_loss: 0.1308, label: 1, bag_size: 1118
batch 1100, loss: 0.9365, instance_loss: 0.4318, weighted_loss: 0.7851, label: 2, bag_size: 485
batch 1200, loss: 3.5023, instance_loss: 1.3508, weighted_loss: 2.8569, label: 3, bag_size: 233
batch 1300, loss: 1.4401, instance_loss: 0.6603, weighted_loss: 1.2062, label: 1, bag_size: 282
batch 1400, loss: 0.1069, instance_loss: 0.1122, weighted_loss: 0.1085, label: 2, bag_size: 857
batch 1500, loss: 0.1213, instance_loss: 0.0883, weighted_loss: 0.1114, label: 1, bag_size: 762
batch 1600, loss: 0.2200, instance_loss: 0.3260, weighted_loss: 0.2518, label: 1, bag_size: 515
batch 1700, loss: 1.4354, instance_loss: 0.5939, weighted_loss: 1.1830, label: 1, bag_size: 334
batch 1800, loss: 0.3378, instance_loss: 0.2723, weighted_loss: 0.3181, label: 2, bag_size: 629
batch 1900, loss: 0.0388, instance_loss: 0.0938, weighted_loss: 0.0553, label: 2, bag_size: 762
batch 2000, loss: 1.1403, instance_loss: 0.6890, weighted_loss: 1.0050, label: 3, bag_size: 489
batch 2100, loss: 1.0993, instance_loss: 0.7557, weighted_loss: 0.9963, label: 3, bag_size: 501

Instance Classifier Stats
class 0 clustering acc 0.9846342165898617: correct 68373/69440
class 1 clustering acc 0.4101958525345622: correct 7121/17360

Epoch: 112, train_loss: 0.6928, train_clustering_loss:  0.3988, train_error: 0.2959
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6790281329923273, correct coarse 531/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.1828793774319066, correct coarse 47/257 
Overall Accuracy: 0.7041

Val Set, val_loss: 0.7423, val_error: 0.3106, auc: 0.7845
class 0 clustering acc 0.9829545454545454: correct 8304/8448 
class 1 clustering acc 0.4289772727272727: correct 906/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6145833333333334, correct coarse 59/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6894
Overall F1 Score: 0.4133

Training for coarse level...
batch 100, loss: 0.5450, instance_loss: 0.3166, weighted_loss: 0.4765, label: 2, bag_size: 714
batch 200, loss: 0.4632, instance_loss: 0.3613, weighted_loss: 0.4326, label: 2, bag_size: 367
batch 300, loss: 1.0878, instance_loss: 0.5107, weighted_loss: 0.9147, label: 1, bag_size: 267
batch 400, loss: 0.0319, instance_loss: 0.0496, weighted_loss: 0.0372, label: 1, bag_size: 897
batch 500, loss: 1.0041, instance_loss: 0.5077, weighted_loss: 0.8552, label: 1, bag_size: 223
batch 600, loss: 1.1325, instance_loss: 0.4863, weighted_loss: 0.9387, label: 2, bag_size: 379
batch 700, loss: 0.3819, instance_loss: 0.2700, weighted_loss: 0.3483, label: 1, bag_size: 786
batch 800, loss: 0.8008, instance_loss: 0.2864, weighted_loss: 0.6465, label: 1, bag_size: 2104
batch 900, loss: 3.6294, instance_loss: 1.7608, weighted_loss: 3.0688, label: 3, bag_size: 2158
batch 1000, loss: 0.7047, instance_loss: 0.4042, weighted_loss: 0.6145, label: 2, bag_size: 654
batch 1100, loss: 1.3135, instance_loss: 0.6464, weighted_loss: 1.1134, label: 1, bag_size: 169
batch 1200, loss: 0.1525, instance_loss: 0.2530, weighted_loss: 0.1826, label: 2, bag_size: 394
batch 1300, loss: 0.0127, instance_loss: 0.0698, weighted_loss: 0.0298, label: 1, bag_size: 1204
batch 1400, loss: 0.0258, instance_loss: 0.0599, weighted_loss: 0.0360, label: 2, bag_size: 874
batch 1500, loss: 0.8018, instance_loss: 0.4934, weighted_loss: 0.7093, label: 1, bag_size: 328
batch 1600, loss: 0.0579, instance_loss: 0.0485, weighted_loss: 0.0551, label: 1, bag_size: 623
batch 1700, loss: 0.0255, instance_loss: 0.0482, weighted_loss: 0.0323, label: 2, bag_size: 331
batch 1800, loss: 0.3353, instance_loss: 0.2600, weighted_loss: 0.3127, label: 2, bag_size: 629
batch 1900, loss: 0.1060, instance_loss: 0.1631, weighted_loss: 0.1231, label: 1, bag_size: 367
batch 2000, loss: 0.0288, instance_loss: 0.0490, weighted_loss: 0.0348, label: 2, bag_size: 192
batch 2100, loss: 0.0524, instance_loss: 0.1050, weighted_loss: 0.0682, label: 2, bag_size: 396

Instance Classifier Stats
class 0 clustering acc 0.9846342165898617: correct 68373/69440
class 1 clustering acc 0.4063364055299539: correct 7054/17360

Epoch: 113, train_loss: 0.6925, train_clustering_loss:  0.3988, train_error: 0.2995
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6675191815856778, correct coarse 522/782 
coarse class 2: coarse acc 0.8730450781968722, correct coarse 949/1087 
coarse class 3: coarse acc 0.1828793774319066, correct coarse 47/257 
Overall Accuracy: 0.7005

Val Set, val_loss: 0.7430, val_error: 0.2992, auc: 0.7837
class 0 clustering acc 0.9828361742424242: correct 8303/8448 
class 1 clustering acc 0.4285037878787879: correct 905/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.7008
Overall F1 Score: 0.4208

Training for coarse level...
batch 100, loss: 1.2010, instance_loss: 0.6404, weighted_loss: 1.0328, label: 3, bag_size: 237
batch 200, loss: 0.7569, instance_loss: 0.4937, weighted_loss: 0.6779, label: 2, bag_size: 259
batch 300, loss: 0.6966, instance_loss: 0.3935, weighted_loss: 0.6056, label: 2, bag_size: 270
batch 400, loss: 0.0581, instance_loss: 0.1081, weighted_loss: 0.0731, label: 2, bag_size: 2141
batch 500, loss: 0.0988, instance_loss: 0.1028, weighted_loss: 0.1000, label: 1, bag_size: 758
batch 600, loss: 0.8553, instance_loss: 0.4468, weighted_loss: 0.7328, label: 2, bag_size: 190
batch 700, loss: 1.7329, instance_loss: 0.7401, weighted_loss: 1.4351, label: 1, bag_size: 234
batch 800, loss: 0.5566, instance_loss: 0.5400, weighted_loss: 0.5516, label: 3, bag_size: 354
batch 900, loss: 1.2681, instance_loss: 0.6365, weighted_loss: 1.0786, label: 3, bag_size: 361
batch 1000, loss: 1.1121, instance_loss: 0.4950, weighted_loss: 0.9269, label: 2, bag_size: 853
batch 1100, loss: 1.8161, instance_loss: 0.9235, weighted_loss: 1.5483, label: 3, bag_size: 309
batch 1200, loss: 1.3316, instance_loss: 0.7474, weighted_loss: 1.1563, label: 3, bag_size: 492
batch 1300, loss: 0.1235, instance_loss: 0.1256, weighted_loss: 0.1242, label: 2, bag_size: 732
batch 1400, loss: 1.4833, instance_loss: 0.5944, weighted_loss: 1.2166, label: 1, bag_size: 1134
batch 1500, loss: 0.4368, instance_loss: 0.3662, weighted_loss: 0.4157, label: 2, bag_size: 565
batch 1600, loss: 0.0826, instance_loss: 0.1012, weighted_loss: 0.0882, label: 1, bag_size: 1512
batch 1700, loss: 0.0643, instance_loss: 0.1034, weighted_loss: 0.0761, label: 1, bag_size: 2213
batch 1800, loss: 0.6078, instance_loss: 0.4126, weighted_loss: 0.5493, label: 2, bag_size: 355
batch 1900, loss: 0.1781, instance_loss: 0.1174, weighted_loss: 0.1599, label: 2, bag_size: 1304
batch 2000, loss: 0.1839, instance_loss: 0.2765, weighted_loss: 0.2117, label: 2, bag_size: 113
batch 2100, loss: 0.1605, instance_loss: 0.0635, weighted_loss: 0.1314, label: 1, bag_size: 981

Instance Classifier Stats
class 0 clustering acc 0.9846774193548387: correct 68376/69440
class 1 clustering acc 0.4046082949308756: correct 7024/17360

Epoch: 114, train_loss: 0.6899, train_clustering_loss:  0.3992, train_error: 0.2954
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6726342710997443, correct coarse 526/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.16731517509727625, correct coarse 43/257 
Overall Accuracy: 0.7046

Val Set, val_loss: 0.7426, val_error: 0.3068, auc: 0.7839
class 0 clustering acc 0.9823626893939394: correct 8299/8448 
class 1 clustering acc 0.42992424242424243: correct 908/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.625, correct coarse 60/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4158

Training for coarse level...
batch 100, loss: 1.6831, instance_loss: 0.7318, weighted_loss: 1.3977, label: 2, bag_size: 201
batch 200, loss: 0.4959, instance_loss: 0.3370, weighted_loss: 0.4482, label: 2, bag_size: 807
batch 300, loss: 0.0590, instance_loss: 0.1066, weighted_loss: 0.0732, label: 1, bag_size: 940
batch 400, loss: 1.2410, instance_loss: 0.6002, weighted_loss: 1.0488, label: 1, bag_size: 162
batch 500, loss: 0.0346, instance_loss: 0.0400, weighted_loss: 0.0363, label: 2, bag_size: 290
batch 600, loss: 0.0824, instance_loss: 0.1278, weighted_loss: 0.0960, label: 1, bag_size: 1049
batch 700, loss: 1.0674, instance_loss: 0.6960, weighted_loss: 0.9560, label: 3, bag_size: 372
batch 800, loss: 0.0520, instance_loss: 0.0521, weighted_loss: 0.0520, label: 2, bag_size: 416
batch 900, loss: 0.1324, instance_loss: 0.1899, weighted_loss: 0.1496, label: 2, bag_size: 1530
batch 1000, loss: 1.7524, instance_loss: 0.7655, weighted_loss: 1.4563, label: 3, bag_size: 457
batch 1100, loss: 0.9002, instance_loss: 0.3979, weighted_loss: 0.7495, label: 2, bag_size: 193
batch 1200, loss: 0.7696, instance_loss: 0.4941, weighted_loss: 0.6870, label: 1, bag_size: 972
batch 1300, loss: 0.1421, instance_loss: 0.3429, weighted_loss: 0.2024, label: 1, bag_size: 1404
batch 1400, loss: 0.7208, instance_loss: 0.4538, weighted_loss: 0.6407, label: 2, bag_size: 148
batch 1500, loss: 0.0210, instance_loss: 0.0441, weighted_loss: 0.0279, label: 1, bag_size: 994
batch 1600, loss: 0.2017, instance_loss: 0.1592, weighted_loss: 0.1889, label: 2, bag_size: 573
batch 1700, loss: 1.4732, instance_loss: 0.6191, weighted_loss: 1.2170, label: 2, bag_size: 325
batch 1800, loss: 0.0638, instance_loss: 0.0435, weighted_loss: 0.0577, label: 1, bag_size: 1216
batch 1900, loss: 0.1076, instance_loss: 0.0708, weighted_loss: 0.0965, label: 2, bag_size: 329
batch 2000, loss: 0.0249, instance_loss: 0.0436, weighted_loss: 0.0305, label: 1, bag_size: 1534
batch 2100, loss: 0.6599, instance_loss: 0.4462, weighted_loss: 0.5958, label: 2, bag_size: 480

Instance Classifier Stats
class 0 clustering acc 0.9841877880184332: correct 68342/69440
class 1 clustering acc 0.40691244239631336: correct 7064/17360

Epoch: 115, train_loss: 0.6894, train_clustering_loss:  0.3991, train_error: 0.2945
coarse class 0: coarse acc 0.06818181818181818, correct coarse 3/44 
coarse class 1: coarse acc 0.6662404092071611, correct coarse 521/782 
coarse class 2: coarse acc 0.8886844526218951, correct coarse 966/1087 
coarse class 3: coarse acc 0.15953307392996108, correct coarse 41/257 
Overall Accuracy: 0.7055

Val Set, val_loss: 0.7430, val_error: 0.3030, auc: 0.7834
class 0 clustering acc 0.9828361742424242: correct 8303/8448 
class 1 clustering acc 0.4289772727272727: correct 906/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8731343283582089, correct coarse 117/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6970
Overall F1 Score: 0.4278

Training for coarse level...
batch 100, loss: 0.1178, instance_loss: 0.1561, weighted_loss: 0.1292, label: 1, bag_size: 2536
batch 200, loss: 0.1323, instance_loss: 0.2198, weighted_loss: 0.1586, label: 1, bag_size: 755
batch 300, loss: 0.6923, instance_loss: 0.6479, weighted_loss: 0.6790, label: 2, bag_size: 663
batch 400, loss: 0.9359, instance_loss: 0.5451, weighted_loss: 0.8187, label: 2, bag_size: 160
batch 500, loss: 0.1849, instance_loss: 0.3495, weighted_loss: 0.2343, label: 2, bag_size: 113
batch 600, loss: 1.6904, instance_loss: 0.9005, weighted_loss: 1.4534, label: 1, bag_size: 493
batch 700, loss: 1.1711, instance_loss: 0.6638, weighted_loss: 1.0189, label: 2, bag_size: 128
batch 800, loss: 0.6460, instance_loss: 0.4814, weighted_loss: 0.5967, label: 2, bag_size: 259
batch 900, loss: 0.2724, instance_loss: 0.3160, weighted_loss: 0.2855, label: 2, bag_size: 519
batch 1000, loss: 0.0301, instance_loss: 0.0371, weighted_loss: 0.0322, label: 1, bag_size: 1535
batch 1100, loss: 0.1876, instance_loss: 0.2732, weighted_loss: 0.2133, label: 2, bag_size: 1479
batch 1200, loss: 0.8330, instance_loss: 0.5736, weighted_loss: 0.7552, label: 1, bag_size: 233
batch 1300, loss: 1.0316, instance_loss: 0.4133, weighted_loss: 0.8461, label: 2, bag_size: 352
batch 1400, loss: 1.0348, instance_loss: 0.5934, weighted_loss: 0.9024, label: 2, bag_size: 627
batch 1500, loss: 1.4446, instance_loss: 0.7840, weighted_loss: 1.2464, label: 1, bag_size: 361
batch 1600, loss: 0.7839, instance_loss: 0.6218, weighted_loss: 0.7352, label: 2, bag_size: 106
batch 1700, loss: 0.8202, instance_loss: 0.5254, weighted_loss: 0.7318, label: 1, bag_size: 454
batch 1800, loss: 0.9389, instance_loss: 0.4759, weighted_loss: 0.8000, label: 2, bag_size: 1564
batch 1900, loss: 1.8795, instance_loss: 0.7423, weighted_loss: 1.5383, label: 3, bag_size: 335
batch 2000, loss: 1.3592, instance_loss: 0.6348, weighted_loss: 1.1419, label: 1, bag_size: 217
batch 2100, loss: 0.4796, instance_loss: 0.3752, weighted_loss: 0.4483, label: 2, bag_size: 578

Instance Classifier Stats
class 0 clustering acc 0.9841589861751152: correct 68340/69440
class 1 clustering acc 0.4110599078341014: correct 7136/17360

Epoch: 116, train_loss: 0.6887, train_clustering_loss:  0.3977, train_error: 0.2995
coarse class 0: coarse acc 0.06818181818181818, correct coarse 3/44 
coarse class 1: coarse acc 0.659846547314578, correct coarse 516/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.16731517509727625, correct coarse 43/257 
Overall Accuracy: 0.7005

Val Set, val_loss: 0.7454, val_error: 0.3068, auc: 0.7820
class 0 clustering acc 0.9828361742424242: correct 8303/8448 
class 1 clustering acc 0.4266098484848485: correct 901/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.65625, correct coarse 63/96 
coarse class 2: coarse acc 0.8507462686567164, correct coarse 114/134 
coarse class 3: coarse acc 0.2, correct coarse 6/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4342

Training for coarse level...
batch 100, loss: 0.2355, instance_loss: 0.2265, weighted_loss: 0.2328, label: 2, bag_size: 148
batch 200, loss: 0.0461, instance_loss: 0.0556, weighted_loss: 0.0490, label: 1, bag_size: 1253
batch 300, loss: 0.1690, instance_loss: 0.1599, weighted_loss: 0.1663, label: 2, bag_size: 1043
batch 400, loss: 0.0436, instance_loss: 0.0649, weighted_loss: 0.0500, label: 1, bag_size: 847
batch 500, loss: 0.0863, instance_loss: 0.1412, weighted_loss: 0.1028, label: 2, bag_size: 2663
batch 600, loss: 1.9245, instance_loss: 0.8193, weighted_loss: 1.5929, label: 2, bag_size: 150
batch 700, loss: 0.0282, instance_loss: 0.0790, weighted_loss: 0.0434, label: 2, bag_size: 645
batch 800, loss: 1.8520, instance_loss: 0.5848, weighted_loss: 1.4718, label: 1, bag_size: 526
batch 900, loss: 1.2261, instance_loss: 0.6480, weighted_loss: 1.0527, label: 3, bag_size: 679
batch 1000, loss: 1.0299, instance_loss: 0.6871, weighted_loss: 0.9271, label: 1, bag_size: 102
batch 1100, loss: 0.1349, instance_loss: 0.1273, weighted_loss: 0.1326, label: 1, bag_size: 270
batch 1200, loss: 0.8373, instance_loss: 0.6829, weighted_loss: 0.7910, label: 2, bag_size: 1426
batch 1300, loss: 0.8907, instance_loss: 0.4769, weighted_loss: 0.7666, label: 2, bag_size: 548
batch 1400, loss: 1.2670, instance_loss: 0.6018, weighted_loss: 1.0674, label: 1, bag_size: 471
batch 1500, loss: 2.0715, instance_loss: 0.8130, weighted_loss: 1.6939, label: 1, bag_size: 393
batch 1600, loss: 0.2174, instance_loss: 0.2695, weighted_loss: 0.2331, label: 1, bag_size: 1374
batch 1700, loss: 1.1546, instance_loss: 0.6626, weighted_loss: 1.0070, label: 3, bag_size: 110
batch 1800, loss: 0.8951, instance_loss: 0.6459, weighted_loss: 0.8204, label: 3, bag_size: 486
batch 1900, loss: 0.5073, instance_loss: 0.3526, weighted_loss: 0.4609, label: 2, bag_size: 807
batch 2000, loss: 0.9851, instance_loss: 0.7231, weighted_loss: 0.9065, label: 2, bag_size: 1830
batch 2100, loss: 0.3288, instance_loss: 0.3104, weighted_loss: 0.3233, label: 2, bag_size: 332

Instance Classifier Stats
class 0 clustering acc 0.9847062211981567: correct 68378/69440
class 1 clustering acc 0.40921658986175113: correct 7104/17360

Epoch: 117, train_loss: 0.6862, train_clustering_loss:  0.3982, train_error: 0.2945
coarse class 0: coarse acc 0.06818181818181818, correct coarse 3/44 
coarse class 1: coarse acc 0.6726342710997443, correct coarse 526/782 
coarse class 2: coarse acc 0.8758049678012879, correct coarse 952/1087 
coarse class 3: coarse acc 0.19455252918287938, correct coarse 50/257 
Overall Accuracy: 0.7055

Val Set, val_loss: 0.7438, val_error: 0.3068, auc: 0.7819
class 0 clustering acc 0.9825994318181818: correct 8301/8448 
class 1 clustering acc 0.42945075757575757: correct 907/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8656716417910447, correct coarse 116/134 
coarse class 3: coarse acc 0.16666666666666666, correct coarse 5/30 
Overall Accuracy: 0.6932
Overall F1 Score: 0.4258

Training for coarse level...
batch 100, loss: 0.0374, instance_loss: 0.0965, weighted_loss: 0.0551, label: 2, bag_size: 682
batch 200, loss: 0.9855, instance_loss: 0.5544, weighted_loss: 0.8562, label: 1, bag_size: 459
batch 300, loss: 0.1218, instance_loss: 0.1272, weighted_loss: 0.1234, label: 2, bag_size: 1221
batch 400, loss: 0.7515, instance_loss: 0.4379, weighted_loss: 0.6574, label: 2, bag_size: 243
batch 500, loss: 1.3160, instance_loss: 0.7707, weighted_loss: 1.1524, label: 3, bag_size: 1196
batch 600, loss: 0.4537, instance_loss: 0.3673, weighted_loss: 0.4278, label: 2, bag_size: 640
batch 700, loss: 0.0482, instance_loss: 0.0973, weighted_loss: 0.0629, label: 2, bag_size: 332
batch 800, loss: 0.1048, instance_loss: 0.1965, weighted_loss: 0.1323, label: 2, bag_size: 569
batch 900, loss: 1.6894, instance_loss: 0.8990, weighted_loss: 1.4523, label: 1, bag_size: 493
batch 1000, loss: 0.3473, instance_loss: 0.4194, weighted_loss: 0.3689, label: 1, bag_size: 1744
batch 1100, loss: 0.0864, instance_loss: 0.0498, weighted_loss: 0.0754, label: 1, bag_size: 813
batch 1200, loss: 0.2095, instance_loss: 0.2967, weighted_loss: 0.2357, label: 2, bag_size: 244
batch 1300, loss: 1.0836, instance_loss: 0.5090, weighted_loss: 0.9112, label: 2, bag_size: 396
batch 1400, loss: 0.7790, instance_loss: 0.4861, weighted_loss: 0.6911, label: 1, bag_size: 225
batch 1500, loss: 0.5923, instance_loss: 0.3589, weighted_loss: 0.5223, label: 2, bag_size: 448
batch 1600, loss: 1.4102, instance_loss: 0.6743, weighted_loss: 1.1894, label: 3, bag_size: 340
batch 1700, loss: 0.0402, instance_loss: 0.0546, weighted_loss: 0.0445, label: 1, bag_size: 198
batch 1800, loss: 0.8239, instance_loss: 0.7113, weighted_loss: 0.7901, label: 2, bag_size: 1426
batch 1900, loss: 0.0131, instance_loss: 0.0318, weighted_loss: 0.0187, label: 1, bag_size: 1424
batch 2000, loss: 0.3228, instance_loss: 0.3250, weighted_loss: 0.3234, label: 2, bag_size: 286
batch 2100, loss: 1.2528, instance_loss: 0.6595, weighted_loss: 1.0748, label: 1, bag_size: 162

Instance Classifier Stats
class 0 clustering acc 0.9849078341013825: correct 68392/69440
class 1 clustering acc 0.40777649769585256: correct 7079/17360

Epoch: 118, train_loss: 0.6855, train_clustering_loss:  0.3974, train_error: 0.2917
coarse class 0: coarse acc 0.09090909090909091, correct coarse 4/44 
coarse class 1: coarse acc 0.6828644501278772, correct coarse 534/782 
coarse class 2: coarse acc 0.8721251149954001, correct coarse 948/1087 
coarse class 3: coarse acc 0.19844357976653695, correct coarse 51/257 
Overall Accuracy: 0.7083

Val Set, val_loss: 0.7433, val_error: 0.3144, auc: 0.7830
class 0 clustering acc 0.982125946969697: correct 8297/8448 
class 1 clustering acc 0.4318181818181818: correct 912/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4108

Training for coarse level...
batch 100, loss: 0.0377, instance_loss: 0.0389, weighted_loss: 0.0381, label: 1, bag_size: 1353
batch 200, loss: 0.0520, instance_loss: 0.0900, weighted_loss: 0.0634, label: 1, bag_size: 793
batch 300, loss: 1.5992, instance_loss: 0.6984, weighted_loss: 1.3289, label: 3, bag_size: 571
batch 400, loss: 1.9687, instance_loss: 0.7590, weighted_loss: 1.6058, label: 3, bag_size: 164
batch 500, loss: 0.0399, instance_loss: 0.0929, weighted_loss: 0.0558, label: 2, bag_size: 602
batch 600, loss: 1.6731, instance_loss: 0.6276, weighted_loss: 1.3595, label: 1, bag_size: 420
batch 700, loss: 0.8658, instance_loss: 0.6904, weighted_loss: 0.8131, label: 2, bag_size: 1426
batch 800, loss: 0.8160, instance_loss: 0.4463, weighted_loss: 0.7051, label: 2, bag_size: 245
batch 900, loss: 0.0647, instance_loss: 0.0944, weighted_loss: 0.0736, label: 2, bag_size: 193
batch 1000, loss: 0.4983, instance_loss: 0.3900, weighted_loss: 0.4658, label: 2, bag_size: 299
batch 1100, loss: 0.0332, instance_loss: 0.0920, weighted_loss: 0.0508, label: 2, bag_size: 238
batch 1200, loss: 0.9360, instance_loss: 0.3940, weighted_loss: 0.7734, label: 2, bag_size: 368
batch 1300, loss: 1.0702, instance_loss: 0.6460, weighted_loss: 0.9429, label: 3, bag_size: 388
batch 1400, loss: 0.0644, instance_loss: 0.0829, weighted_loss: 0.0700, label: 1, bag_size: 2170
batch 1500, loss: 1.2045, instance_loss: 0.6578, weighted_loss: 1.0405, label: 1, bag_size: 304
batch 1600, loss: 0.0998, instance_loss: 0.2533, weighted_loss: 0.1459, label: 1, bag_size: 2107
batch 1700, loss: 0.0733, instance_loss: 0.1245, weighted_loss: 0.0887, label: 2, bag_size: 498
batch 1800, loss: 0.1785, instance_loss: 0.2534, weighted_loss: 0.2010, label: 2, bag_size: 1736
batch 1900, loss: 0.4364, instance_loss: 0.1660, weighted_loss: 0.3553, label: 2, bag_size: 703
batch 2000, loss: 1.0595, instance_loss: 0.4667, weighted_loss: 0.8816, label: 2, bag_size: 276
batch 2100, loss: 0.9909, instance_loss: 0.4563, weighted_loss: 0.8305, label: 2, bag_size: 242

Instance Classifier Stats
class 0 clustering acc 0.9841013824884792: correct 68336/69440
class 1 clustering acc 0.40852534562211984: correct 7092/17360

Epoch: 119, train_loss: 0.6877, train_clustering_loss:  0.3990, train_error: 0.2922
coarse class 0: coarse acc 0.09090909090909091, correct coarse 4/44 
coarse class 1: coarse acc 0.6611253196930946, correct coarse 517/782 
coarse class 2: coarse acc 0.8868445262189513, correct coarse 964/1087 
coarse class 3: coarse acc 0.19844357976653695, correct coarse 51/257 
Overall Accuracy: 0.7078

Val Set, val_loss: 0.7438, val_error: 0.2992, auc: 0.7822
class 0 clustering acc 0.9822443181818182: correct 8298/8448 
class 1 clustering acc 0.4308712121212121: correct 910/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.7008
Overall F1 Score: 0.4208

Training for coarse level...
batch 100, loss: 1.3807, instance_loss: 0.6613, weighted_loss: 1.1649, label: 1, bag_size: 558
batch 200, loss: 0.7305, instance_loss: 0.5501, weighted_loss: 0.6764, label: 1, bag_size: 972
batch 300, loss: 0.9632, instance_loss: 0.5950, weighted_loss: 0.8527, label: 2, bag_size: 1506
batch 400, loss: 0.1579, instance_loss: 0.1268, weighted_loss: 0.1486, label: 1, bag_size: 1692
batch 500, loss: 0.0583, instance_loss: 0.0738, weighted_loss: 0.0630, label: 2, bag_size: 628
batch 600, loss: 1.2202, instance_loss: 0.6335, weighted_loss: 1.0442, label: 3, bag_size: 862
batch 700, loss: 0.1271, instance_loss: 0.1336, weighted_loss: 0.1290, label: 2, bag_size: 468
batch 800, loss: 0.1295, instance_loss: 0.1616, weighted_loss: 0.1391, label: 2, bag_size: 796
batch 900, loss: 0.0347, instance_loss: 0.0448, weighted_loss: 0.0377, label: 2, bag_size: 463
batch 1000, loss: 0.7771, instance_loss: 0.4630, weighted_loss: 0.6829, label: 1, bag_size: 225
batch 1100, loss: 0.2370, instance_loss: 0.2821, weighted_loss: 0.2505, label: 1, bag_size: 510
batch 1200, loss: 0.1526, instance_loss: 0.0993, weighted_loss: 0.1366, label: 2, bag_size: 691
batch 1300, loss: 0.0295, instance_loss: 0.0872, weighted_loss: 0.0468, label: 2, bag_size: 407
batch 1400, loss: 1.4110, instance_loss: 0.5861, weighted_loss: 1.1635, label: 2, bag_size: 708
batch 1500, loss: 1.0962, instance_loss: 0.6464, weighted_loss: 0.9613, label: 2, bag_size: 2023
batch 1600, loss: 1.1244, instance_loss: 0.5988, weighted_loss: 0.9667, label: 3, bag_size: 185
batch 1700, loss: 0.0626, instance_loss: 0.2444, weighted_loss: 0.1171, label: 2, bag_size: 264
batch 1800, loss: 0.5937, instance_loss: 0.3556, weighted_loss: 0.5223, label: 2, bag_size: 494
batch 1900, loss: 0.0517, instance_loss: 0.0790, weighted_loss: 0.0599, label: 2, bag_size: 665
batch 2000, loss: 0.8031, instance_loss: 0.5145, weighted_loss: 0.7165, label: 1, bag_size: 303
batch 2100, loss: 0.1884, instance_loss: 0.2411, weighted_loss: 0.2043, label: 2, bag_size: 1736

Instance Classifier Stats
class 0 clustering acc 0.9845766129032258: correct 68369/69440
class 1 clustering acc 0.40933179723502305: correct 7106/17360

Epoch: 120, train_loss: 0.6856, train_clustering_loss:  0.3981, train_error: 0.2917
coarse class 0: coarse acc 0.045454545454545456, correct coarse 2/44 
coarse class 1: coarse acc 0.6764705882352942, correct coarse 529/782 
coarse class 2: coarse acc 0.8813247470101196, correct coarse 958/1087 
coarse class 3: coarse acc 0.1867704280155642, correct coarse 48/257 
Overall Accuracy: 0.7083

Val Set, val_loss: 0.7429, val_error: 0.2992, auc: 0.7827
class 0 clustering acc 0.9823626893939394: correct 8299/8448 
class 1 clustering acc 0.4303977272727273: correct 909/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6458333333333334, correct coarse 62/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.7008
Overall F1 Score: 0.4208

Training for coarse level...
batch 100, loss: 1.0012, instance_loss: 0.4570, weighted_loss: 0.8380, label: 2, bag_size: 373
batch 200, loss: 0.0521, instance_loss: 0.0858, weighted_loss: 0.0622, label: 2, bag_size: 956
batch 300, loss: 0.8089, instance_loss: 0.7581, weighted_loss: 0.7937, label: 0, bag_size: 235
batch 400, loss: 0.0159, instance_loss: 0.0211, weighted_loss: 0.0175, label: 1, bag_size: 542
batch 500, loss: 0.1936, instance_loss: 0.2190, weighted_loss: 0.2012, label: 1, bag_size: 3112
batch 600, loss: 0.5932, instance_loss: 0.4802, weighted_loss: 0.5593, label: 2, bag_size: 233
batch 700, loss: 1.4098, instance_loss: 0.5348, weighted_loss: 1.1473, label: 2, bag_size: 231
batch 800, loss: 0.8078, instance_loss: 0.5103, weighted_loss: 0.7186, label: 1, bag_size: 568
batch 900, loss: 3.4068, instance_loss: 1.7634, weighted_loss: 2.9138, label: 3, bag_size: 2158
batch 1000, loss: 0.0635, instance_loss: 0.0867, weighted_loss: 0.0704, label: 2, bag_size: 764
batch 1100, loss: 1.7560, instance_loss: 0.8278, weighted_loss: 1.4775, label: 3, bag_size: 457
batch 1200, loss: 0.0204, instance_loss: 0.0691, weighted_loss: 0.0350, label: 2, bag_size: 668
batch 1300, loss: 0.0325, instance_loss: 0.1110, weighted_loss: 0.0560, label: 2, bag_size: 515
batch 1400, loss: 0.0397, instance_loss: 0.0578, weighted_loss: 0.0452, label: 2, bag_size: 458
batch 1500, loss: 1.1241, instance_loss: 0.6513, weighted_loss: 0.9823, label: 3, bag_size: 133
batch 1600, loss: 0.7364, instance_loss: 0.4803, weighted_loss: 0.6596, label: 2, bag_size: 106
batch 1700, loss: 1.2323, instance_loss: 0.6664, weighted_loss: 1.0625, label: 3, bag_size: 274
batch 1800, loss: 0.0875, instance_loss: 0.1177, weighted_loss: 0.0966, label: 1, bag_size: 1171
batch 1900, loss: 0.0572, instance_loss: 0.0690, weighted_loss: 0.0607, label: 2, bag_size: 525
batch 2000, loss: 1.5010, instance_loss: 0.6936, weighted_loss: 1.2588, label: 3, bag_size: 384
batch 2100, loss: 0.1018, instance_loss: 0.1049, weighted_loss: 0.1027, label: 1, bag_size: 732

Instance Classifier Stats
class 0 clustering acc 0.9839717741935484: correct 68327/69440
class 1 clustering acc 0.4113479262672811: correct 7141/17360

Epoch: 121, train_loss: 0.6836, train_clustering_loss:  0.3978, train_error: 0.2917
coarse class 0: coarse acc 0.06818181818181818, correct coarse 3/44 
coarse class 1: coarse acc 0.6636828644501279, correct coarse 519/782 
coarse class 2: coarse acc 0.889604415823367, correct coarse 967/1087 
coarse class 3: coarse acc 0.1867704280155642, correct coarse 48/257 
Overall Accuracy: 0.7083

Val Set, val_loss: 0.7465, val_error: 0.3106, auc: 0.7814
class 0 clustering acc 0.9829545454545454: correct 8304/8448 
class 1 clustering acc 0.42613636363636365: correct 900/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6770833333333334, correct coarse 65/96 
coarse class 2: coarse acc 0.8283582089552238, correct coarse 111/134 
coarse class 3: coarse acc 0.2, correct coarse 6/30 
Overall Accuracy: 0.6894
Overall F1 Score: 0.4331

Training for coarse level...
batch 100, loss: 0.8052, instance_loss: 0.4092, weighted_loss: 0.6864, label: 2, bag_size: 387
batch 200, loss: 0.7156, instance_loss: 0.5463, weighted_loss: 0.6648, label: 3, bag_size: 201
batch 300, loss: 0.6718, instance_loss: 0.5200, weighted_loss: 0.6263, label: 1, bag_size: 976
batch 400, loss: 0.7540, instance_loss: 0.4138, weighted_loss: 0.6520, label: 2, bag_size: 890
batch 500, loss: 1.4441, instance_loss: 0.8253, weighted_loss: 1.2584, label: 2, bag_size: 1123
batch 600, loss: 0.0733, instance_loss: 0.0774, weighted_loss: 0.0745, label: 1, bag_size: 633
batch 700, loss: 0.0373, instance_loss: 0.0743, weighted_loss: 0.0484, label: 1, bag_size: 909
batch 800, loss: 2.0018, instance_loss: 0.8145, weighted_loss: 1.6456, label: 3, bag_size: 1167
batch 900, loss: 0.0569, instance_loss: 0.0711, weighted_loss: 0.0612, label: 2, bag_size: 620
batch 1000, loss: 0.0389, instance_loss: 0.0920, weighted_loss: 0.0549, label: 2, bag_size: 289
batch 1100, loss: 0.2105, instance_loss: 0.4205, weighted_loss: 0.2735, label: 1, bag_size: 729
batch 1200, loss: 0.0227, instance_loss: 0.0604, weighted_loss: 0.0340, label: 2, bag_size: 200
batch 1300, loss: 0.0511, instance_loss: 0.0570, weighted_loss: 0.0529, label: 1, bag_size: 1216
batch 1400, loss: 0.8626, instance_loss: 0.6260, weighted_loss: 0.7916, label: 3, bag_size: 198
batch 1500, loss: 1.5625, instance_loss: 0.7478, weighted_loss: 1.3181, label: 3, bag_size: 876
batch 1600, loss: 1.3492, instance_loss: 0.5858, weighted_loss: 1.1201, label: 1, bag_size: 375
batch 1700, loss: 0.0445, instance_loss: 0.1088, weighted_loss: 0.0637, label: 2, bag_size: 515
batch 1800, loss: 0.6016, instance_loss: 0.6168, weighted_loss: 0.6062, label: 1, bag_size: 456
batch 1900, loss: 1.5178, instance_loss: 0.8001, weighted_loss: 1.3025, label: 1, bag_size: 57
batch 2000, loss: 1.7752, instance_loss: 0.8670, weighted_loss: 1.5027, label: 3, bag_size: 149
batch 2100, loss: 0.6075, instance_loss: 0.4527, weighted_loss: 0.5610, label: 2, bag_size: 1678

Instance Classifier Stats
class 0 clustering acc 0.9844182027649769: correct 68358/69440
class 1 clustering acc 0.4088709677419355: correct 7098/17360

Epoch: 122, train_loss: 0.6835, train_clustering_loss:  0.3973, train_error: 0.2862
coarse class 0: coarse acc 0.06818181818181818, correct coarse 3/44 
coarse class 1: coarse acc 0.7033248081841432, correct coarse 550/782 
coarse class 2: coarse acc 0.8666053357865685, correct coarse 942/1087 
coarse class 3: coarse acc 0.21011673151750973, correct coarse 54/257 
Overall Accuracy: 0.7138

Val Set, val_loss: 0.7432, val_error: 0.3144, auc: 0.7830
class 0 clustering acc 0.9822443181818182: correct 8298/8448 
class 1 clustering acc 0.4303977272727273: correct 909/2112 
coarse class 0: coarse acc 0.0, correct coarse 0/4 
coarse class 1: coarse acc 0.6041666666666666, correct coarse 58/96 
coarse class 2: coarse acc 0.8880597014925373, correct coarse 119/134 
coarse class 3: coarse acc 0.13333333333333333, correct coarse 4/30 
Overall Accuracy: 0.6856
Overall F1 Score: 0.4108

Val error: 0.2955, ROC AUC: 0.7846
