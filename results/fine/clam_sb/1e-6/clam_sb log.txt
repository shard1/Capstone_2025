Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for fine level...
batch 100, loss: 2.4225, instance_loss: 1.3350, weighted_loss: 2.0963, label: 10, bag_size: 2314
batch 200, loss: 2.3692, instance_loss: 1.2666, weighted_loss: 2.0384, label: 8, bag_size: 378
batch 300, loss: 2.3907, instance_loss: 1.2643, weighted_loss: 2.0528, label: 5, bag_size: 742
batch 400, loss: 2.3161, instance_loss: 1.2561, weighted_loss: 1.9981, label: 5, bag_size: 673
batch 500, loss: 2.7331, instance_loss: 1.2367, weighted_loss: 2.2842, label: 3, bag_size: 1692
batch 600, loss: 2.5097, instance_loss: 1.1409, weighted_loss: 2.0990, label: 10, bag_size: 335
batch 700, loss: 2.1154, instance_loss: 1.1380, weighted_loss: 1.8222, label: 5, bag_size: 180
batch 800, loss: 1.9286, instance_loss: 1.2033, weighted_loss: 1.7110, label: 5, bag_size: 702
batch 900, loss: 2.8013, instance_loss: 1.0797, weighted_loss: 2.2848, label: 3, bag_size: 2005
batch 1000, loss: 1.6856, instance_loss: 1.0664, weighted_loss: 1.4999, label: 5, bag_size: 902
batch 1100, loss: 2.5981, instance_loss: 1.0529, weighted_loss: 2.1346, label: 7, bag_size: 618
batch 1200, loss: 2.2329, instance_loss: 1.0152, weighted_loss: 1.8676, label: 6, bag_size: 504
batch 1300, loss: 1.7711, instance_loss: 1.0743, weighted_loss: 1.5621, label: 2, bag_size: 193
batch 1400, loss: 2.8039, instance_loss: 1.0524, weighted_loss: 2.2785, label: 7, bag_size: 149
batch 1500, loss: 1.7421, instance_loss: 1.0032, weighted_loss: 1.5204, label: 2, bag_size: 592
batch 1600, loss: 2.3888, instance_loss: 0.9347, weighted_loss: 1.9525, label: 6, bag_size: 735
batch 1700, loss: 1.7904, instance_loss: 0.9674, weighted_loss: 1.5435, label: 2, bag_size: 1435
batch 1800, loss: 1.6335, instance_loss: 0.9204, weighted_loss: 1.4196, label: 2, bag_size: 2220
batch 1900, loss: 1.4517, instance_loss: 0.8875, weighted_loss: 1.2824, label: 5, bag_size: 269
batch 2000, loss: 1.5261, instance_loss: 0.8726, weighted_loss: 1.3300, label: 5, bag_size: 463
batch 2100, loss: 2.8704, instance_loss: 0.8580, weighted_loss: 2.2667, label: 10, bag_size: 574

Instance Classifier Stats
class 0 clustering acc 0.795669250104734: correct 151941/190960
class 1 clustering acc 0.15213133640552995: correct 2641/17360

Epoch: 1, train_loss: 2.1015, train_clustering_loss: 1.0830, train_error: 0.6304
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5783365570599613, correct fine 299/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.5990453460620525, correct fine 502/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.3696

Val Set, val_loss: 1.8672, val_error: 0.5720, auc: 0.5620
class 0 clustering acc 0.9865272038567493: correct 22919/23232 
class 1 clustering acc 0.008522727272727272: correct 18/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.140625, correct fine 9/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4280
Overall F1 Score: 0.0745

Training for fine level...
batch 100, loss: 1.8105, instance_loss: 0.8263, weighted_loss: 1.5153, label: 2, bag_size: 235
batch 200, loss: 1.5790, instance_loss: 0.7803, weighted_loss: 1.3394, label: 2, bag_size: 206
batch 300, loss: 3.2397, instance_loss: 0.8266, weighted_loss: 2.5158, label: 1, bag_size: 67
batch 400, loss: 3.0671, instance_loss: 0.7023, weighted_loss: 2.3577, label: 7, bag_size: 438
batch 500, loss: 1.1727, instance_loss: 0.7515, weighted_loss: 1.0463, label: 5, bag_size: 408
batch 600, loss: 3.3110, instance_loss: 0.6434, weighted_loss: 2.5107, label: 1, bag_size: 369
batch 700, loss: 0.9477, instance_loss: 0.7032, weighted_loss: 0.8743, label: 5, bag_size: 651
batch 800, loss: 1.1986, instance_loss: 0.6512, weighted_loss: 1.0344, label: 5, bag_size: 620
batch 900, loss: 2.8481, instance_loss: 0.7008, weighted_loss: 2.2039, label: 3, bag_size: 1642
batch 1000, loss: 1.5515, instance_loss: 0.6511, weighted_loss: 1.2814, label: 2, bag_size: 374
batch 1100, loss: 3.1716, instance_loss: 0.6538, weighted_loss: 2.4163, label: 7, bag_size: 354
batch 1200, loss: 2.6216, instance_loss: 0.7494, weighted_loss: 2.0600, label: 4, bag_size: 1841
batch 1300, loss: 2.3793, instance_loss: 0.6072, weighted_loss: 1.8477, label: 6, bag_size: 2023
batch 1400, loss: 1.5711, instance_loss: 0.6223, weighted_loss: 1.2865, label: 2, bag_size: 691
batch 1500, loss: 2.8697, instance_loss: 0.5018, weighted_loss: 2.1594, label: 4, bag_size: 1079
batch 1600, loss: 1.6688, instance_loss: 0.5761, weighted_loss: 1.3410, label: 2, bag_size: 315
batch 1700, loss: 0.9599, instance_loss: 0.5160, weighted_loss: 0.8267, label: 5, bag_size: 289
batch 1800, loss: 2.4568, instance_loss: 0.5022, weighted_loss: 1.8705, label: 6, bag_size: 979
batch 1900, loss: 0.9233, instance_loss: 0.4833, weighted_loss: 0.7913, label: 5, bag_size: 854
batch 2000, loss: 2.9489, instance_loss: 0.4868, weighted_loss: 2.2103, label: 4, bag_size: 904
batch 2100, loss: 1.6068, instance_loss: 0.4867, weighted_loss: 1.2708, label: 2, bag_size: 629

Instance Classifier Stats
class 0 clustering acc 0.9926319648093842: correct 189553/190960
class 1 clustering acc 0.004665898617511521: correct 81/17360

Epoch: 2, train_loss: 1.8098, train_clustering_loss: 0.6478, train_error: 0.6009
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.07156673114119923, correct fine 37/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9892601431980907, correct fine 829/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.3991

Val Set, val_loss: 1.7362, val_error: 0.5682, auc: 0.5888
class 0 clustering acc 0.9998278236914601: correct 23228/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.15625, correct fine 10/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 1.0, correct fine 104/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4318
Overall F1 Score: 0.0767

Training for fine level...
batch 100, loss: 2.5433, instance_loss: 0.6005, weighted_loss: 1.9604, label: 8, bag_size: 333
batch 200, loss: 2.2940, instance_loss: 0.4755, weighted_loss: 1.7484, label: 6, bag_size: 506
batch 300, loss: 1.2626, instance_loss: 0.5424, weighted_loss: 1.0466, label: 5, bag_size: 544
batch 400, loss: 0.8195, instance_loss: 0.4627, weighted_loss: 0.7125, label: 5, bag_size: 1217
batch 500, loss: 3.0400, instance_loss: 0.4917, weighted_loss: 2.2755, label: 4, bag_size: 1030
batch 600, loss: 2.9842, instance_loss: 0.4380, weighted_loss: 2.2204, label: 4, bag_size: 616
batch 700, loss: 2.8472, instance_loss: 0.4603, weighted_loss: 2.1311, label: 4, bag_size: 1460
batch 800, loss: 3.4506, instance_loss: 0.3833, weighted_loss: 2.5304, label: 7, bag_size: 528
batch 900, loss: 0.8515, instance_loss: 0.3846, weighted_loss: 0.7114, label: 5, bag_size: 752
batch 1000, loss: 2.7382, instance_loss: 0.5438, weighted_loss: 2.0799, label: 8, bag_size: 2813
batch 1100, loss: 0.9088, instance_loss: 0.3968, weighted_loss: 0.7552, label: 5, bag_size: 700
batch 1200, loss: 2.3841, instance_loss: 0.3586, weighted_loss: 1.7765, label: 6, bag_size: 247
batch 1300, loss: 0.6905, instance_loss: 0.3736, weighted_loss: 0.5955, label: 5, bag_size: 705
batch 1400, loss: 1.4631, instance_loss: 0.4168, weighted_loss: 1.1492, label: 2, bag_size: 298
batch 1500, loss: 2.2540, instance_loss: 0.3761, weighted_loss: 1.6906, label: 6, bag_size: 1235
batch 1600, loss: 2.1720, instance_loss: 0.3812, weighted_loss: 1.6348, label: 6, bag_size: 276
batch 1700, loss: 3.0977, instance_loss: 0.3867, weighted_loss: 2.2844, label: 4, bag_size: 714
batch 1800, loss: 1.3525, instance_loss: 0.3657, weighted_loss: 1.0564, label: 2, bag_size: 456
batch 1900, loss: 2.3098, instance_loss: 0.3409, weighted_loss: 1.7192, label: 6, bag_size: 346
batch 2000, loss: 0.7559, instance_loss: 0.3128, weighted_loss: 0.6230, label: 5, bag_size: 370
batch 2100, loss: 3.0097, instance_loss: 0.3953, weighted_loss: 2.2254, label: 3, bag_size: 292

Instance Classifier Stats
class 0 clustering acc 0.9996020108923335: correct 190884/190960
class 1 clustering acc 0.0002304147465437788: correct 4/17360

Epoch: 3, train_loss: 1.7354, train_clustering_loss: 0.4157, train_error: 0.5770
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.17794970986460348, correct fine 92/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9856801909307876, correct fine 826/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4230

Val Set, val_loss: 1.6907, val_error: 0.5417, auc: 0.6053
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.296875, correct fine 19/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9807692307692307, correct fine 102/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4583
Overall F1 Score: 0.0912

Training for fine level...
batch 100, loss: 3.0734, instance_loss: 0.3387, weighted_loss: 2.2530, label: 4, bag_size: 155
batch 200, loss: 1.3427, instance_loss: 0.3197, weighted_loss: 1.0358, label: 2, bag_size: 456
batch 300, loss: 3.9570, instance_loss: 0.3934, weighted_loss: 2.8879, label: 10, bag_size: 162
batch 400, loss: 3.1437, instance_loss: 0.4055, weighted_loss: 2.3222, label: 7, bag_size: 478
batch 500, loss: 0.5925, instance_loss: 0.3208, weighted_loss: 0.5110, label: 5, bag_size: 555
batch 600, loss: 3.0941, instance_loss: 0.3535, weighted_loss: 2.2719, label: 7, bag_size: 1196
batch 700, loss: 0.7006, instance_loss: 0.3147, weighted_loss: 0.5849, label: 5, bag_size: 714
batch 800, loss: 0.9986, instance_loss: 0.2996, weighted_loss: 0.7889, label: 5, bag_size: 253
batch 900, loss: 2.1415, instance_loss: 0.3125, weighted_loss: 1.5928, label: 6, bag_size: 764
batch 1000, loss: 0.9584, instance_loss: 0.2956, weighted_loss: 0.7596, label: 5, bag_size: 442
batch 1100, loss: 1.3320, instance_loss: 0.3478, weighted_loss: 1.0368, label: 2, bag_size: 900
batch 1200, loss: 1.2850, instance_loss: 0.3790, weighted_loss: 1.0132, label: 5, bag_size: 1347
batch 1300, loss: 1.3563, instance_loss: 0.3586, weighted_loss: 1.0570, label: 2, bag_size: 265
batch 1400, loss: 2.8266, instance_loss: 0.3369, weighted_loss: 2.0797, label: 3, bag_size: 926
batch 1500, loss: 0.9543, instance_loss: 0.2682, weighted_loss: 0.7485, label: 5, bag_size: 377
batch 1600, loss: 1.4597, instance_loss: 0.3413, weighted_loss: 1.1242, label: 2, bag_size: 894
batch 1700, loss: 0.7724, instance_loss: 0.2935, weighted_loss: 0.6287, label: 5, bag_size: 753
batch 1800, loss: 3.6252, instance_loss: 0.3703, weighted_loss: 2.6488, label: 10, bag_size: 270
batch 1900, loss: 0.9980, instance_loss: 0.2674, weighted_loss: 0.7789, label: 5, bag_size: 229
batch 2000, loss: 0.8317, instance_loss: 0.2415, weighted_loss: 0.6547, label: 5, bag_size: 463
batch 2100, loss: 2.1052, instance_loss: 0.2896, weighted_loss: 1.5605, label: 6, bag_size: 563

Instance Classifier Stats
class 0 clustering acc 0.9998533724340176: correct 190932/190960
class 1 clustering acc 0.0: correct 0/17360

Epoch: 4, train_loss: 1.6973, train_clustering_loss: 0.3200, train_error: 0.5576
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.29206963249516443, correct fine 151/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9653937947494033, correct fine 809/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4424

Val Set, val_loss: 1.6627, val_error: 0.5492, auc: 0.6204
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.3125, correct fine 20/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9519230769230769, correct fine 99/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4508
Overall F1 Score: 0.0894

Training for fine level...
batch 100, loss: 1.5144, instance_loss: 0.2797, weighted_loss: 1.1440, label: 2, bag_size: 566
batch 200, loss: 0.5497, instance_loss: 0.2233, weighted_loss: 0.4518, label: 5, bag_size: 368
batch 300, loss: 0.7316, instance_loss: 0.2656, weighted_loss: 0.5918, label: 5, bag_size: 332
batch 400, loss: 0.7541, instance_loss: 0.2317, weighted_loss: 0.5974, label: 5, bag_size: 256
batch 500, loss: 0.8522, instance_loss: 0.2365, weighted_loss: 0.6675, label: 5, bag_size: 729
batch 600, loss: 0.9707, instance_loss: 0.2489, weighted_loss: 0.7541, label: 5, bag_size: 1145
batch 700, loss: 0.6291, instance_loss: 0.2376, weighted_loss: 0.5117, label: 5, bag_size: 525
batch 800, loss: 2.7480, instance_loss: 0.3226, weighted_loss: 2.0204, label: 4, bag_size: 425
batch 900, loss: 2.3194, instance_loss: 0.3150, weighted_loss: 1.7180, label: 6, bag_size: 566
batch 1000, loss: 1.3197, instance_loss: 0.2874, weighted_loss: 1.0100, label: 2, bag_size: 1628
batch 1100, loss: 3.0095, instance_loss: 0.2985, weighted_loss: 2.1962, label: 8, bag_size: 435
batch 1200, loss: 1.3016, instance_loss: 0.3723, weighted_loss: 1.0228, label: 2, bag_size: 748
batch 1300, loss: 2.9022, instance_loss: 0.3385, weighted_loss: 2.1331, label: 3, bag_size: 837
batch 1400, loss: 0.4232, instance_loss: 0.2453, weighted_loss: 0.3698, label: 5, bag_size: 185
batch 1500, loss: 3.1330, instance_loss: 0.3226, weighted_loss: 2.2899, label: 7, bag_size: 172
batch 1600, loss: 2.9207, instance_loss: 0.3116, weighted_loss: 2.1380, label: 4, bag_size: 244
batch 1700, loss: 0.7629, instance_loss: 0.2332, weighted_loss: 0.6040, label: 5, bag_size: 753
batch 1800, loss: 1.7658, instance_loss: 0.2606, weighted_loss: 1.3143, label: 2, bag_size: 217
batch 1900, loss: 3.1331, instance_loss: 0.2909, weighted_loss: 2.2804, label: 3, bag_size: 775
batch 2000, loss: 2.2571, instance_loss: 0.2717, weighted_loss: 1.6615, label: 6, bag_size: 523
batch 2100, loss: 1.8287, instance_loss: 0.4201, weighted_loss: 1.4061, label: 5, bag_size: 473

Instance Classifier Stats
class 0 clustering acc 0.9999633431085044: correct 190953/190960
class 1 clustering acc 0.0: correct 0/17360

Epoch: 5, train_loss: 1.6699, train_clustering_loss: 0.2795, train_error: 0.5438
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.38104448742746616, correct fine 197/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9463007159904535, correct fine 793/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4562

Val Set, val_loss: 1.6417, val_error: 0.5303, auc: 0.6324
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.4375, correct fine 28/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4697
Overall F1 Score: 0.0977

Training for fine level...
batch 100, loss: 2.2079, instance_loss: 0.3040, weighted_loss: 1.6368, label: 6, bag_size: 252
batch 200, loss: 0.6611, instance_loss: 0.2017, weighted_loss: 0.5233, label: 5, bag_size: 97
batch 300, loss: 0.6572, instance_loss: 0.2302, weighted_loss: 0.5291, label: 5, bag_size: 2141
batch 400, loss: 0.8226, instance_loss: 0.2087, weighted_loss: 0.6384, label: 5, bag_size: 115
batch 500, loss: 0.7337, instance_loss: 0.2099, weighted_loss: 0.5765, label: 5, bag_size: 405
batch 600, loss: 0.6261, instance_loss: 0.2192, weighted_loss: 0.5041, label: 5, bag_size: 576
batch 700, loss: 2.9403, instance_loss: 0.3044, weighted_loss: 2.1495, label: 3, bag_size: 197
batch 800, loss: 0.4971, instance_loss: 0.2082, weighted_loss: 0.4105, label: 5, bag_size: 482
batch 900, loss: 0.8509, instance_loss: 0.2046, weighted_loss: 0.6570, label: 5, bag_size: 667
batch 1000, loss: 2.0122, instance_loss: 0.3062, weighted_loss: 1.5004, label: 6, bag_size: 411
batch 1100, loss: 2.8947, instance_loss: 0.3127, weighted_loss: 2.1201, label: 4, bag_size: 2219
batch 1200, loss: 2.4168, instance_loss: 0.2935, weighted_loss: 1.7798, label: 6, bag_size: 492
batch 1300, loss: 2.2293, instance_loss: 0.2821, weighted_loss: 1.6451, label: 6, bag_size: 206
batch 1400, loss: 2.0382, instance_loss: 0.2903, weighted_loss: 1.5138, label: 6, bag_size: 344
batch 1500, loss: 2.7157, instance_loss: 0.3028, weighted_loss: 1.9918, label: 4, bag_size: 1867
batch 1600, loss: 0.4516, instance_loss: 0.2127, weighted_loss: 0.3799, label: 5, bag_size: 437
batch 1700, loss: 0.6936, instance_loss: 0.2084, weighted_loss: 0.5480, label: 5, bag_size: 332
batch 1800, loss: 0.7142, instance_loss: 0.2265, weighted_loss: 0.5679, label: 5, bag_size: 308
batch 1900, loss: 0.6122, instance_loss: 0.2130, weighted_loss: 0.4924, label: 5, bag_size: 393
batch 2000, loss: 1.1421, instance_loss: 0.2203, weighted_loss: 0.8656, label: 5, bag_size: 248
batch 2100, loss: 0.6912, instance_loss: 0.2092, weighted_loss: 0.5466, label: 5, bag_size: 819

Instance Classifier Stats
class 0 clustering acc 0.9999842899036447: correct 190957/190960
class 1 clustering acc 0.0: correct 0/17360

Epoch: 6, train_loss: 1.6473, train_clustering_loss: 0.2620, train_error: 0.5313
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.4564796905222437, correct fine 236/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.931980906921241, correct fine 781/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4687

Val Set, val_loss: 1.6251, val_error: 0.5265, auc: 0.6446
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.484375, correct fine 31/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4735
Overall F1 Score: 0.0992

Training for fine level...
batch 100, loss: 0.7151, instance_loss: 0.2128, weighted_loss: 0.5644, label: 5, bag_size: 743
batch 200, loss: 1.2944, instance_loss: 0.2488, weighted_loss: 0.9807, label: 5, bag_size: 271
batch 300, loss: 0.6742, instance_loss: 0.1999, weighted_loss: 0.5319, label: 5, bag_size: 542
batch 400, loss: 2.1614, instance_loss: 0.3007, weighted_loss: 1.6032, label: 6, bag_size: 320
batch 500, loss: 2.6908, instance_loss: 0.3001, weighted_loss: 1.9736, label: 3, bag_size: 522
batch 600, loss: 1.2692, instance_loss: 0.2626, weighted_loss: 0.9672, label: 2, bag_size: 123
batch 700, loss: 0.9696, instance_loss: 0.2642, weighted_loss: 0.7579, label: 2, bag_size: 1359
batch 800, loss: 1.5675, instance_loss: 0.2248, weighted_loss: 1.1647, label: 5, bag_size: 276
batch 900, loss: 2.1032, instance_loss: 0.2919, weighted_loss: 1.5598, label: 6, bag_size: 281
batch 1000, loss: 0.7853, instance_loss: 0.1926, weighted_loss: 0.6075, label: 5, bag_size: 458
batch 1100, loss: 0.4654, instance_loss: 0.2034, weighted_loss: 0.3868, label: 5, bag_size: 1023
batch 1200, loss: 2.6996, instance_loss: 0.2834, weighted_loss: 1.9748, label: 8, bag_size: 1342
batch 1300, loss: 2.2249, instance_loss: 0.3038, weighted_loss: 1.6486, label: 8, bag_size: 198
batch 1400, loss: 1.9655, instance_loss: 0.2795, weighted_loss: 1.4597, label: 6, bag_size: 361
batch 1500, loss: 1.1253, instance_loss: 0.2660, weighted_loss: 0.8675, label: 2, bag_size: 927
batch 1600, loss: 1.1437, instance_loss: 0.2142, weighted_loss: 0.8648, label: 5, bag_size: 1246
batch 1700, loss: 2.6511, instance_loss: 0.3134, weighted_loss: 1.9498, label: 3, bag_size: 175
batch 1800, loss: 2.8214, instance_loss: 0.3059, weighted_loss: 2.0668, label: 4, bag_size: 278
batch 1900, loss: 0.6575, instance_loss: 0.2018, weighted_loss: 0.5208, label: 5, bag_size: 499
batch 2000, loss: 1.6004, instance_loss: 0.2636, weighted_loss: 1.1993, label: 2, bag_size: 328
batch 2100, loss: 2.5679, instance_loss: 0.3026, weighted_loss: 1.8883, label: 3, bag_size: 901

Instance Classifier Stats
class 0 clustering acc 0.999994763301215: correct 190959/190960
class 1 clustering acc 0.0: correct 0/17360

Epoch: 7, train_loss: 1.6288, train_clustering_loss: 0.2523, train_error: 0.5286
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5145067698259188, correct fine 266/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.9033412887828163, correct fine 757/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4714

Val Set, val_loss: 1.6112, val_error: 0.5227, auc: 0.6538
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5, correct fine 32/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4773
Overall F1 Score: 0.1008

Training for fine level...
batch 100, loss: 0.8608, instance_loss: 0.1968, weighted_loss: 0.6616, label: 5, bag_size: 431
batch 200, loss: 0.9910, instance_loss: 0.2589, weighted_loss: 0.7714, label: 2, bag_size: 1531
batch 300, loss: 3.1838, instance_loss: 0.3108, weighted_loss: 2.3219, label: 7, bag_size: 139
batch 400, loss: 1.1571, instance_loss: 0.2571, weighted_loss: 0.8871, label: 2, bag_size: 671
batch 500, loss: 2.4115, instance_loss: 0.2959, weighted_loss: 1.7768, label: 3, bag_size: 2302
batch 600, loss: 0.9415, instance_loss: 0.2419, weighted_loss: 0.7316, label: 2, bag_size: 1447
batch 700, loss: 2.0075, instance_loss: 0.2954, weighted_loss: 1.4939, label: 6, bag_size: 334
batch 800, loss: 0.7540, instance_loss: 0.1762, weighted_loss: 0.5807, label: 5, bag_size: 658
batch 900, loss: 0.9324, instance_loss: 0.1948, weighted_loss: 0.7111, label: 5, bag_size: 462
batch 1000, loss: 1.5384, instance_loss: 0.2333, weighted_loss: 1.1469, label: 2, bag_size: 1257
batch 1100, loss: 0.9325, instance_loss: 0.2447, weighted_loss: 0.7262, label: 2, bag_size: 706
batch 1200, loss: 2.0689, instance_loss: 0.2756, weighted_loss: 1.5309, label: 6, bag_size: 2023
batch 1300, loss: 0.7079, instance_loss: 0.1915, weighted_loss: 0.5530, label: 5, bag_size: 180
batch 1400, loss: 0.2535, instance_loss: 0.1790, weighted_loss: 0.2311, label: 5, bag_size: 439
batch 1500, loss: 1.2476, instance_loss: 0.2543, weighted_loss: 0.9496, label: 2, bag_size: 1269
batch 1600, loss: 3.2552, instance_loss: 0.3230, weighted_loss: 2.3755, label: 4, bag_size: 525
batch 1700, loss: 0.5982, instance_loss: 0.1858, weighted_loss: 0.4745, label: 5, bag_size: 328
batch 1800, loss: 2.8053, instance_loss: 0.3033, weighted_loss: 2.0547, label: 8, bag_size: 457
batch 1900, loss: 0.2749, instance_loss: 0.1622, weighted_loss: 0.2411, label: 5, bag_size: 495
batch 2000, loss: 1.3448, instance_loss: 0.2211, weighted_loss: 1.0077, label: 5, bag_size: 297
batch 2100, loss: 0.3477, instance_loss: 0.1655, weighted_loss: 0.2931, label: 5, bag_size: 290

Instance Classifier Stats
class 0 clustering acc 1.0: correct 190960/190960
class 1 clustering acc 0.0: correct 0/17360

Epoch: 8, train_loss: 1.6125, train_clustering_loss: 0.2471, train_error: 0.5309
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5125725338491296, correct fine 265/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4691

Val Set, val_loss: 1.5986, val_error: 0.5038, auc: 0.6642
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1063

Training for fine level...
batch 100, loss: 1.0996, instance_loss: 0.1848, weighted_loss: 0.8252, label: 5, bag_size: 1600
batch 200, loss: 1.4625, instance_loss: 0.2487, weighted_loss: 1.0983, label: 2, bag_size: 544
batch 300, loss: 0.8451, instance_loss: 0.1933, weighted_loss: 0.6496, label: 5, bag_size: 333
batch 400, loss: 2.9226, instance_loss: 0.3053, weighted_loss: 2.1375, label: 3, bag_size: 401
batch 500, loss: 1.3605, instance_loss: 0.2355, weighted_loss: 1.0230, label: 2, bag_size: 235
batch 600, loss: 2.0523, instance_loss: 0.2789, weighted_loss: 1.5203, label: 6, bag_size: 156
batch 700, loss: 0.2595, instance_loss: 0.1831, weighted_loss: 0.2366, label: 5, bag_size: 905
batch 800, loss: 0.5160, instance_loss: 0.1707, weighted_loss: 0.4124, label: 5, bag_size: 342
batch 900, loss: 0.2905, instance_loss: 0.1632, weighted_loss: 0.2523, label: 5, bag_size: 539
batch 1000, loss: 1.0612, instance_loss: 0.2398, weighted_loss: 0.8148, label: 2, bag_size: 833
batch 1100, loss: 1.7587, instance_loss: 0.2697, weighted_loss: 1.3120, label: 6, bag_size: 326
batch 1200, loss: 0.2599, instance_loss: 0.1700, weighted_loss: 0.2329, label: 5, bag_size: 331
batch 1300, loss: 2.7627, instance_loss: 0.3129, weighted_loss: 2.0277, label: 4, bag_size: 665
batch 1400, loss: 2.9871, instance_loss: 0.3354, weighted_loss: 2.1916, label: 7, bag_size: 210
batch 1500, loss: 0.2861, instance_loss: 0.1704, weighted_loss: 0.2514, label: 5, bag_size: 764
batch 1600, loss: 2.0901, instance_loss: 0.2962, weighted_loss: 1.5519, label: 6, bag_size: 346
batch 1700, loss: 2.0110, instance_loss: 0.3517, weighted_loss: 1.5132, label: 8, bag_size: 130
batch 1800, loss: 0.6463, instance_loss: 0.1626, weighted_loss: 0.5012, label: 5, bag_size: 887
batch 1900, loss: 2.0248, instance_loss: 0.2823, weighted_loss: 1.5020, label: 6, bag_size: 129
batch 2000, loss: 2.5289, instance_loss: 0.3056, weighted_loss: 1.8619, label: 3, bag_size: 1781
batch 2100, loss: 0.9683, instance_loss: 0.1752, weighted_loss: 0.7304, label: 5, bag_size: 433

Instance Classifier Stats
class 0 clustering acc 1.0: correct 190960/190960
class 1 clustering acc 0.0: correct 0/17360

Epoch: 9, train_loss: 1.5982, train_clustering_loss: 0.2435, train_error: 0.5272
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5261121856866537, correct fine 272/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8997613365155132, correct fine 754/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4728

Val Set, val_loss: 1.5875, val_error: 0.5038, auc: 0.6727
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1058

Training for fine level...
batch 100, loss: 0.8664, instance_loss: 0.1892, weighted_loss: 0.6632, label: 5, bag_size: 721
batch 200, loss: 0.4871, instance_loss: 0.1713, weighted_loss: 0.3923, label: 5, bag_size: 1217
batch 300, loss: 2.2865, instance_loss: 0.3170, weighted_loss: 1.6956, label: 3, bag_size: 2045
batch 400, loss: 0.6121, instance_loss: 0.1811, weighted_loss: 0.4828, label: 5, bag_size: 667
batch 500, loss: 0.6694, instance_loss: 0.1957, weighted_loss: 0.5273, label: 5, bag_size: 249
batch 600, loss: 0.6784, instance_loss: 0.1726, weighted_loss: 0.5266, label: 5, bag_size: 244
batch 700, loss: 2.5051, instance_loss: 0.3140, weighted_loss: 1.8477, label: 3, bag_size: 901
batch 800, loss: 1.0697, instance_loss: 0.2293, weighted_loss: 0.8176, label: 2, bag_size: 356
batch 900, loss: 1.2313, instance_loss: 0.2197, weighted_loss: 0.9278, label: 5, bag_size: 331
batch 1000, loss: 1.7692, instance_loss: 0.3418, weighted_loss: 1.3410, label: 5, bag_size: 473
batch 1100, loss: 0.4019, instance_loss: 0.1618, weighted_loss: 0.3299, label: 5, bag_size: 462
batch 1200, loss: 2.8438, instance_loss: 0.3213, weighted_loss: 2.0870, label: 3, bag_size: 234
batch 1300, loss: 0.7108, instance_loss: 0.1634, weighted_loss: 0.5466, label: 5, bag_size: 2032
batch 1400, loss: 0.8793, instance_loss: 0.1771, weighted_loss: 0.6686, label: 5, bag_size: 1214
batch 1500, loss: 0.5923, instance_loss: 0.1752, weighted_loss: 0.4672, label: 5, bag_size: 841
batch 1600, loss: 1.3207, instance_loss: 0.2182, weighted_loss: 0.9900, label: 5, bag_size: 174
batch 1700, loss: 2.0865, instance_loss: 0.2854, weighted_loss: 1.5462, label: 6, bag_size: 979
batch 1800, loss: 4.0448, instance_loss: 0.3425, weighted_loss: 2.9341, label: 0, bag_size: 37
batch 1900, loss: 2.5759, instance_loss: 0.3057, weighted_loss: 1.8948, label: 4, bag_size: 1204
batch 2000, loss: 1.9396, instance_loss: 0.2883, weighted_loss: 1.4442, label: 6, bag_size: 689
batch 2100, loss: 2.5801, instance_loss: 0.2749, weighted_loss: 1.8886, label: 3, bag_size: 522

Instance Classifier Stats
class 0 clustering acc 1.0: correct 190960/190960
class 1 clustering acc 5.76036866359447e-05: correct 1/17360

Epoch: 10, train_loss: 1.5845, train_clustering_loss: 0.2406, train_error: 0.5240
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5783365570599613, correct fine 299/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8758949880668258, correct fine 734/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4760

Val Set, val_loss: 1.5769, val_error: 0.5038, auc: 0.6819
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1059

Training for fine level...
batch 100, loss: 2.1378, instance_loss: 0.2969, weighted_loss: 1.5855, label: 6, bag_size: 581
batch 200, loss: 0.7348, instance_loss: 0.1775, weighted_loss: 0.5676, label: 5, bag_size: 332
batch 300, loss: 4.1181, instance_loss: 0.3495, weighted_loss: 2.9875, label: 10, bag_size: 574
batch 400, loss: 1.3652, instance_loss: 0.2231, weighted_loss: 1.0225, label: 5, bag_size: 968
batch 500, loss: 0.8241, instance_loss: 0.1816, weighted_loss: 0.6314, label: 5, bag_size: 513
batch 600, loss: 2.1537, instance_loss: 0.3114, weighted_loss: 1.6011, label: 6, bag_size: 304
batch 700, loss: 1.6896, instance_loss: 0.2658, weighted_loss: 1.2624, label: 6, bag_size: 787
batch 800, loss: 1.1174, instance_loss: 0.1725, weighted_loss: 0.8339, label: 5, bag_size: 929
batch 900, loss: 0.8974, instance_loss: 0.2265, weighted_loss: 0.6961, label: 2, bag_size: 252
batch 1000, loss: 1.3415, instance_loss: 0.2291, weighted_loss: 1.0078, label: 2, bag_size: 193
batch 1100, loss: 1.9745, instance_loss: 0.2811, weighted_loss: 1.4665, label: 6, bag_size: 896
batch 1200, loss: 0.6403, instance_loss: 0.1555, weighted_loss: 0.4948, label: 5, bag_size: 458
batch 1300, loss: 1.1226, instance_loss: 0.2122, weighted_loss: 0.8495, label: 5, bag_size: 178
batch 1400, loss: 2.0305, instance_loss: 0.3137, weighted_loss: 1.5155, label: 8, bag_size: 120
batch 1500, loss: 2.7035, instance_loss: 0.3082, weighted_loss: 1.9849, label: 8, bag_size: 558
batch 1600, loss: 1.9713, instance_loss: 0.2663, weighted_loss: 1.4598, label: 6, bag_size: 396
batch 1700, loss: 2.0819, instance_loss: 0.2768, weighted_loss: 1.5404, label: 6, bag_size: 2046
batch 1800, loss: 2.1017, instance_loss: 0.2580, weighted_loss: 1.5486, label: 6, bag_size: 764
batch 1900, loss: 1.1748, instance_loss: 0.2055, weighted_loss: 0.8840, label: 5, bag_size: 129
batch 2000, loss: 2.3244, instance_loss: 0.2454, weighted_loss: 1.7007, label: 2, bag_size: 823
batch 2100, loss: 1.2828, instance_loss: 0.2279, weighted_loss: 0.9664, label: 2, bag_size: 1767

Instance Classifier Stats
class 0 clustering acc 0.999994763301215: correct 190959/190960
class 1 clustering acc 0.0001728110599078341: correct 3/17360

Epoch: 11, train_loss: 1.5719, train_clustering_loss: 0.2382, train_error: 0.5226
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5841392649903289, correct fine 302/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8758949880668258, correct fine 734/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4774

Val Set, val_loss: 1.5670, val_error: 0.5038, auc: 0.6890
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1060

Training for fine level...
batch 100, loss: 2.6641, instance_loss: 0.3016, weighted_loss: 1.9553, label: 4, bag_size: 889
batch 200, loss: 1.2865, instance_loss: 0.2271, weighted_loss: 0.9687, label: 2, bag_size: 631
batch 300, loss: 1.5429, instance_loss: 0.1927, weighted_loss: 1.1378, label: 5, bag_size: 297
batch 400, loss: 0.7336, instance_loss: 0.1568, weighted_loss: 0.5606, label: 5, bag_size: 1798
batch 500, loss: 2.0755, instance_loss: 0.3152, weighted_loss: 1.5474, label: 8, bag_size: 299
batch 600, loss: 2.1993, instance_loss: 0.2790, weighted_loss: 1.6232, label: 6, bag_size: 276
batch 700, loss: 1.1779, instance_loss: 0.1634, weighted_loss: 0.8736, label: 5, bag_size: 1364
batch 800, loss: 0.4499, instance_loss: 0.1727, weighted_loss: 0.3667, label: 5, bag_size: 381
batch 900, loss: 1.6067, instance_loss: 0.2202, weighted_loss: 1.1908, label: 5, bag_size: 1426
batch 1000, loss: 0.9354, instance_loss: 0.1897, weighted_loss: 0.7117, label: 5, bag_size: 333
batch 1100, loss: 2.0978, instance_loss: 0.3044, weighted_loss: 1.5598, label: 8, bag_size: 415
batch 1200, loss: 3.1852, instance_loss: 0.3251, weighted_loss: 2.3271, label: 4, bag_size: 287
batch 1300, loss: 2.0332, instance_loss: 0.2809, weighted_loss: 1.5075, label: 6, bag_size: 669
batch 1400, loss: 0.8516, instance_loss: 0.2136, weighted_loss: 0.6602, label: 2, bag_size: 826
batch 1500, loss: 2.8142, instance_loss: 0.3360, weighted_loss: 2.0707, label: 3, bag_size: 188
batch 1600, loss: 0.6905, instance_loss: 0.1815, weighted_loss: 0.5378, label: 5, bag_size: 69
batch 1700, loss: 0.7425, instance_loss: 0.1468, weighted_loss: 0.5638, label: 5, bag_size: 568
batch 1800, loss: 3.9909, instance_loss: 0.3674, weighted_loss: 2.9038, label: 1, bag_size: 67
batch 1900, loss: 1.0027, instance_loss: 0.2312, weighted_loss: 0.7712, label: 2, bag_size: 1293
batch 2000, loss: 0.8655, instance_loss: 0.2279, weighted_loss: 0.6742, label: 2, bag_size: 2536
batch 2100, loss: 0.4983, instance_loss: 0.1841, weighted_loss: 0.4040, label: 5, bag_size: 393

Instance Classifier Stats
class 0 clustering acc 0.9999895266024298: correct 190958/190960
class 1 clustering acc 0.000576036866359447: correct 10/17360

Epoch: 12, train_loss: 1.5593, train_clustering_loss: 0.2357, train_error: 0.5171
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6189555125725339, correct fine 320/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8687350835322196, correct fine 728/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4829

Val Set, val_loss: 1.5582, val_error: 0.5038, auc: 0.6955
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1058

Training for fine level...
batch 100, loss: 1.1547, instance_loss: 0.1727, weighted_loss: 0.8601, label: 5, bag_size: 363
batch 200, loss: 0.3435, instance_loss: 0.1484, weighted_loss: 0.2849, label: 5, bag_size: 334
batch 300, loss: 2.7193, instance_loss: 0.3326, weighted_loss: 2.0033, label: 3, bag_size: 433
batch 400, loss: 1.8937, instance_loss: 0.2106, weighted_loss: 1.3888, label: 5, bag_size: 3051
batch 500, loss: 1.7800, instance_loss: 0.2885, weighted_loss: 1.3325, label: 6, bag_size: 2272
batch 600, loss: 4.2752, instance_loss: 0.4040, weighted_loss: 3.1138, label: 9, bag_size: 936
batch 700, loss: 1.5490, instance_loss: 0.2211, weighted_loss: 1.1506, label: 2, bag_size: 366
batch 800, loss: 0.2980, instance_loss: 0.1345, weighted_loss: 0.2490, label: 5, bag_size: 252
batch 900, loss: 2.0036, instance_loss: 0.3134, weighted_loss: 1.4965, label: 8, bag_size: 241
batch 1000, loss: 1.1408, instance_loss: 0.1856, weighted_loss: 0.8542, label: 5, bag_size: 352
batch 1100, loss: 0.1358, instance_loss: 0.1198, weighted_loss: 0.1310, label: 5, bag_size: 329
batch 1200, loss: 1.9136, instance_loss: 0.2534, weighted_loss: 1.4155, label: 6, bag_size: 527
batch 1300, loss: 1.0597, instance_loss: 0.2300, weighted_loss: 0.8108, label: 2, bag_size: 1293
batch 1400, loss: 3.9320, instance_loss: 0.3595, weighted_loss: 2.8602, label: 10, bag_size: 270
batch 1500, loss: 0.7367, instance_loss: 0.2056, weighted_loss: 0.5774, label: 2, bag_size: 2220
batch 1600, loss: 0.3407, instance_loss: 0.1380, weighted_loss: 0.2799, label: 5, bag_size: 605
batch 1700, loss: 0.6707, instance_loss: 0.1962, weighted_loss: 0.5283, label: 2, bag_size: 1632
batch 1800, loss: 0.7866, instance_loss: 0.1546, weighted_loss: 0.5970, label: 5, bag_size: 324
batch 1900, loss: 0.0997, instance_loss: 0.1164, weighted_loss: 0.1047, label: 5, bag_size: 965
batch 2000, loss: 4.7330, instance_loss: 0.3608, weighted_loss: 3.4213, label: 9, bag_size: 237
batch 2100, loss: 0.1592, instance_loss: 0.1176, weighted_loss: 0.1467, label: 5, bag_size: 563

Instance Classifier Stats
class 0 clustering acc 0.9999633431085044: correct 190953/190960
class 1 clustering acc 0.002304147465437788: correct 40/17360

Epoch: 13, train_loss: 1.5489, train_clustering_loss: 0.2342, train_error: 0.5175
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6015473887814313, correct fine 311/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8782816229116945, correct fine 736/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4825

Val Set, val_loss: 1.5486, val_error: 0.5114, auc: 0.7031
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4886
Overall F1 Score: 0.1045

Training for fine level...
batch 100, loss: 0.3771, instance_loss: 0.1342, weighted_loss: 0.3042, label: 5, bag_size: 676
batch 200, loss: 2.7165, instance_loss: 0.3317, weighted_loss: 2.0011, label: 3, bag_size: 1678
batch 300, loss: 0.4394, instance_loss: 0.1564, weighted_loss: 0.3545, label: 5, bag_size: 221
batch 400, loss: 1.0784, instance_loss: 0.1745, weighted_loss: 0.8072, label: 5, bag_size: 929
batch 500, loss: 0.1448, instance_loss: 0.1237, weighted_loss: 0.1384, label: 5, bag_size: 280
batch 600, loss: 1.8083, instance_loss: 0.2687, weighted_loss: 1.3464, label: 6, bag_size: 394
batch 700, loss: 1.8548, instance_loss: 0.2267, weighted_loss: 1.3664, label: 5, bag_size: 237
batch 800, loss: 1.5506, instance_loss: 0.2094, weighted_loss: 1.1482, label: 5, bag_size: 472
batch 900, loss: 0.2489, instance_loss: 0.1164, weighted_loss: 0.2091, label: 5, bag_size: 699
batch 1000, loss: 1.2004, instance_loss: 0.1781, weighted_loss: 0.8937, label: 5, bag_size: 131
batch 1100, loss: 1.3581, instance_loss: 0.2095, weighted_loss: 1.0136, label: 5, bag_size: 331
batch 1200, loss: 0.2085, instance_loss: 0.1269, weighted_loss: 0.1840, label: 5, bag_size: 554
batch 1300, loss: 3.3639, instance_loss: 0.3152, weighted_loss: 2.4493, label: 8, bag_size: 233
batch 1400, loss: 1.4082, instance_loss: 0.2663, weighted_loss: 1.0656, label: 2, bag_size: 568
batch 1500, loss: 2.3024, instance_loss: 0.2848, weighted_loss: 1.6971, label: 4, bag_size: 1387
batch 1600, loss: 0.1700, instance_loss: 0.1186, weighted_loss: 0.1546, label: 5, bag_size: 361
batch 1700, loss: 1.2730, instance_loss: 0.2121, weighted_loss: 0.9547, label: 5, bag_size: 482
batch 1800, loss: 0.4491, instance_loss: 0.1319, weighted_loss: 0.3539, label: 5, bag_size: 866
batch 1900, loss: 2.7856, instance_loss: 0.3268, weighted_loss: 2.0479, label: 4, bag_size: 607
batch 2000, loss: 0.3385, instance_loss: 0.1252, weighted_loss: 0.2745, label: 5, bag_size: 779
batch 2100, loss: 1.2054, instance_loss: 0.2529, weighted_loss: 0.9196, label: 2, bag_size: 696

Instance Classifier Stats
class 0 clustering acc 0.999937159614579: correct 190948/190960
class 1 clustering acc 0.00391705069124424: correct 68/17360

Epoch: 14, train_loss: 1.5381, train_clustering_loss: 0.2325, train_error: 0.5175
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6228239845261122, correct fine 322/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8651551312649165, correct fine 725/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4825

Val Set, val_loss: 1.5398, val_error: 0.5076, auc: 0.7106
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1056

Training for fine level...
batch 100, loss: 0.9248, instance_loss: 0.2008, weighted_loss: 0.7076, label: 2, bag_size: 2159
batch 200, loss: 0.6721, instance_loss: 0.1947, weighted_loss: 0.5289, label: 2, bag_size: 1490
batch 300, loss: 1.8475, instance_loss: 0.2691, weighted_loss: 1.3740, label: 2, bag_size: 835
batch 400, loss: 1.7249, instance_loss: 0.2279, weighted_loss: 1.2758, label: 5, bag_size: 280
batch 500, loss: 2.6604, instance_loss: 0.2891, weighted_loss: 1.9490, label: 3, bag_size: 303
batch 600, loss: 0.2232, instance_loss: 0.1133, weighted_loss: 0.1902, label: 5, bag_size: 602
batch 700, loss: 0.2664, instance_loss: 0.1053, weighted_loss: 0.2180, label: 5, bag_size: 711
batch 800, loss: 2.2853, instance_loss: 0.2975, weighted_loss: 1.6889, label: 3, bag_size: 554
batch 900, loss: 1.7403, instance_loss: 0.2661, weighted_loss: 1.2981, label: 6, bag_size: 92
batch 1000, loss: 1.5355, instance_loss: 0.2698, weighted_loss: 1.1558, label: 2, bag_size: 861
batch 1100, loss: 2.3253, instance_loss: 0.3387, weighted_loss: 1.7293, label: 8, bag_size: 278
batch 1200, loss: 0.6454, instance_loss: 0.1463, weighted_loss: 0.4957, label: 5, bag_size: 726
batch 1300, loss: 1.0206, instance_loss: 0.2474, weighted_loss: 0.7886, label: 2, bag_size: 1700
batch 1400, loss: 2.4871, instance_loss: 0.2836, weighted_loss: 1.8260, label: 4, bag_size: 374
batch 1500, loss: 0.7534, instance_loss: 0.2004, weighted_loss: 0.5875, label: 2, bag_size: 1527
batch 1600, loss: 2.4459, instance_loss: 0.3092, weighted_loss: 1.8049, label: 3, bag_size: 945
batch 1700, loss: 0.2199, instance_loss: 0.1215, weighted_loss: 0.1904, label: 5, bag_size: 506
batch 1800, loss: 2.1991, instance_loss: 0.2939, weighted_loss: 1.6275, label: 8, bag_size: 565
batch 1900, loss: 0.3258, instance_loss: 0.1375, weighted_loss: 0.2693, label: 5, bag_size: 857
batch 2000, loss: 1.1124, instance_loss: 0.2401, weighted_loss: 0.8507, label: 2, bag_size: 425
batch 2100, loss: 0.4232, instance_loss: 0.2253, weighted_loss: 0.3638, label: 2, bag_size: 633

Instance Classifier Stats
class 0 clustering acc 0.9998586091328027: correct 190933/190960
class 1 clustering acc 0.006278801843317972: correct 109/17360

Epoch: 15, train_loss: 1.5278, train_clustering_loss: 0.2306, train_error: 0.5161
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6247582205029013, correct fine 323/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8675417661097852, correct fine 727/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.0, correct fine 0/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4839

Val Set, val_loss: 1.5314, val_error: 0.5076, auc: 0.7179
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.0004734848484848485: correct 1/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1056

Training for fine level...
batch 100, loss: 0.5530, instance_loss: 0.2017, weighted_loss: 0.4476, label: 2, bag_size: 248
batch 200, loss: 0.5518, instance_loss: 0.1288, weighted_loss: 0.4249, label: 5, bag_size: 696
batch 300, loss: 0.8530, instance_loss: 0.1474, weighted_loss: 0.6413, label: 5, bag_size: 301
batch 400, loss: 0.2613, instance_loss: 0.1348, weighted_loss: 0.2234, label: 5, bag_size: 261
batch 500, loss: 2.3114, instance_loss: 0.2732, weighted_loss: 1.6999, label: 3, bag_size: 428
batch 600, loss: 0.6864, instance_loss: 0.2100, weighted_loss: 0.5435, label: 2, bag_size: 497
batch 700, loss: 1.5165, instance_loss: 0.2681, weighted_loss: 1.1420, label: 2, bag_size: 267
batch 800, loss: 0.3722, instance_loss: 0.1472, weighted_loss: 0.3047, label: 5, bag_size: 369
batch 900, loss: 4.0733, instance_loss: 0.3974, weighted_loss: 2.9705, label: 1, bag_size: 1452
batch 1000, loss: 0.7921, instance_loss: 0.1541, weighted_loss: 0.6007, label: 5, bag_size: 735
batch 1100, loss: 2.2408, instance_loss: 0.2674, weighted_loss: 1.6488, label: 6, bag_size: 614
batch 1200, loss: 1.6465, instance_loss: 0.2429, weighted_loss: 1.2255, label: 2, bag_size: 334
batch 1300, loss: 2.2028, instance_loss: 0.2897, weighted_loss: 1.6289, label: 3, bag_size: 837
batch 1400, loss: 2.2854, instance_loss: 0.3226, weighted_loss: 1.6965, label: 8, bag_size: 307
batch 1500, loss: 1.6549, instance_loss: 0.2378, weighted_loss: 1.2298, label: 2, bag_size: 378
batch 1600, loss: 2.2527, instance_loss: 0.2942, weighted_loss: 1.6651, label: 3, bag_size: 774
batch 1700, loss: 1.9337, instance_loss: 0.2953, weighted_loss: 1.4422, label: 8, bag_size: 386
batch 1800, loss: 1.5882, instance_loss: 0.2850, weighted_loss: 1.1972, label: 8, bag_size: 216
batch 1900, loss: 1.8162, instance_loss: 0.2950, weighted_loss: 1.3599, label: 6, bag_size: 555
batch 2000, loss: 0.7332, instance_loss: 0.1722, weighted_loss: 0.5649, label: 5, bag_size: 543
batch 2100, loss: 1.9811, instance_loss: 0.2805, weighted_loss: 1.4709, label: 3, bag_size: 304

Instance Classifier Stats
class 0 clustering acc 0.9998324256388772: correct 190928/190960
class 1 clustering acc 0.01152073732718894: correct 200/17360

Epoch: 16, train_loss: 1.5177, train_clustering_loss: 0.2289, train_error: 0.5157
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6228239845261122, correct fine 322/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8687350835322196, correct fine 728/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4843

Val Set, val_loss: 1.5233, val_error: 0.5038, auc: 0.7261
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.000946969696969697: correct 2/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1065

Training for fine level...
batch 100, loss: 0.2672, instance_loss: 0.1254, weighted_loss: 0.2246, label: 5, bag_size: 334
batch 200, loss: 1.9237, instance_loss: 0.2658, weighted_loss: 1.4263, label: 2, bag_size: 533
batch 300, loss: 3.3172, instance_loss: 0.3468, weighted_loss: 2.4261, label: 3, bag_size: 406
batch 400, loss: 1.6973, instance_loss: 0.2663, weighted_loss: 1.2680, label: 6, bag_size: 334
batch 500, loss: 1.8305, instance_loss: 0.2223, weighted_loss: 1.3480, label: 5, bag_size: 112
batch 600, loss: 3.2372, instance_loss: 0.3365, weighted_loss: 2.3670, label: 8, bag_size: 615
batch 700, loss: 0.7722, instance_loss: 0.1205, weighted_loss: 0.5767, label: 5, bag_size: 515
batch 800, loss: 1.8117, instance_loss: 0.2886, weighted_loss: 1.3548, label: 8, bag_size: 383
batch 900, loss: 2.2283, instance_loss: 0.2622, weighted_loss: 1.6384, label: 3, bag_size: 428
batch 1000, loss: 2.6770, instance_loss: 0.3214, weighted_loss: 1.9703, label: 7, bag_size: 778
batch 1100, loss: 2.0024, instance_loss: 0.2952, weighted_loss: 1.4902, label: 6, bag_size: 424
batch 1200, loss: 1.9193, instance_loss: 0.2933, weighted_loss: 1.4315, label: 6, bag_size: 649
batch 1300, loss: 1.5192, instance_loss: 0.2248, weighted_loss: 1.1309, label: 2, bag_size: 193
batch 1400, loss: 0.4751, instance_loss: 0.1412, weighted_loss: 0.3749, label: 5, bag_size: 517
batch 1500, loss: 3.7639, instance_loss: 0.3283, weighted_loss: 2.7332, label: 2, bag_size: 641
batch 1600, loss: 1.0148, instance_loss: 0.1800, weighted_loss: 0.7643, label: 5, bag_size: 193
batch 1700, loss: 2.5413, instance_loss: 0.3008, weighted_loss: 1.8691, label: 7, bag_size: 435
batch 1800, loss: 1.7033, instance_loss: 0.2530, weighted_loss: 1.2682, label: 2, bag_size: 290
batch 1900, loss: 1.8017, instance_loss: 0.2819, weighted_loss: 1.3458, label: 6, bag_size: 239
batch 2000, loss: 2.0445, instance_loss: 0.2937, weighted_loss: 1.5192, label: 6, bag_size: 278
batch 2100, loss: 2.1785, instance_loss: 0.3008, weighted_loss: 1.6152, label: 3, bag_size: 3892

Instance Classifier Stats
class 0 clustering acc 0.9998114788437369: correct 190924/190960
class 1 clustering acc 0.014976958525345621: correct 260/17360

Epoch: 17, train_loss: 1.5084, train_clustering_loss: 0.2280, train_error: 0.5111
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6518375241779497, correct fine 337/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.0, correct fine 0/115 
fine class 5: fine acc 0.8627684964200477, correct fine 723/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4889

Val Set, val_loss: 1.5148, val_error: 0.5038, auc: 0.7309
class 0 clustering acc 1.0: correct 23232/23232 
class 1 clustering acc 0.001893939393939394: correct 4/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1066

Training for fine level...
batch 100, loss: 0.4350, instance_loss: 0.1737, weighted_loss: 0.3566, label: 2, bag_size: 2692
batch 200, loss: 0.5773, instance_loss: 0.1762, weighted_loss: 0.4569, label: 2, bag_size: 1817
batch 300, loss: 0.7088, instance_loss: 0.2045, weighted_loss: 0.5575, label: 2, bag_size: 526
batch 400, loss: 2.2542, instance_loss: 0.2701, weighted_loss: 1.6590, label: 6, bag_size: 259
batch 500, loss: 4.2755, instance_loss: 0.4010, weighted_loss: 3.1131, label: 1, bag_size: 505
batch 600, loss: 1.7441, instance_loss: 0.2175, weighted_loss: 1.2861, label: 5, bag_size: 309
batch 700, loss: 2.1806, instance_loss: 0.2578, weighted_loss: 1.6038, label: 2, bag_size: 315
batch 800, loss: 0.4719, instance_loss: 0.1848, weighted_loss: 0.3858, label: 2, bag_size: 714
batch 900, loss: 1.3000, instance_loss: 0.1855, weighted_loss: 0.9656, label: 5, bag_size: 290
batch 1000, loss: 1.7947, instance_loss: 0.2246, weighted_loss: 1.3236, label: 5, bag_size: 1897
batch 1100, loss: 0.2493, instance_loss: 0.1230, weighted_loss: 0.2114, label: 5, bag_size: 505
batch 1200, loss: 2.4232, instance_loss: 0.2940, weighted_loss: 1.7845, label: 4, bag_size: 556
batch 1300, loss: 0.7775, instance_loss: 0.1694, weighted_loss: 0.5951, label: 2, bag_size: 1090
batch 1400, loss: 1.9626, instance_loss: 0.2550, weighted_loss: 1.4503, label: 6, bag_size: 2046
batch 1500, loss: 2.0810, instance_loss: 0.3166, weighted_loss: 1.5517, label: 6, bag_size: 739
batch 1600, loss: 0.2774, instance_loss: 0.1031, weighted_loss: 0.2251, label: 5, bag_size: 2141
batch 1700, loss: 0.2717, instance_loss: 0.1256, weighted_loss: 0.2279, label: 5, bag_size: 332
batch 1800, loss: 2.3088, instance_loss: 0.3126, weighted_loss: 1.7099, label: 7, bag_size: 321
batch 1900, loss: 2.4121, instance_loss: 0.3383, weighted_loss: 1.7899, label: 7, bag_size: 568
batch 2000, loss: 0.2526, instance_loss: 0.1275, weighted_loss: 0.2151, label: 5, bag_size: 717
batch 2100, loss: 0.9173, instance_loss: 0.1752, weighted_loss: 0.6947, label: 2, bag_size: 2119

Instance Classifier Stats
class 0 clustering acc 0.9996229576874738: correct 190888/190960
class 1 clustering acc 0.020046082949308756: correct 348/17360

Epoch: 18, train_loss: 1.4987, train_clustering_loss: 0.2266, train_error: 0.5092
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6460348162475822, correct fine 334/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.869928400954654, correct fine 729/838 
fine class 6: fine acc 0.0, correct fine 0/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4908

Val Set, val_loss: 1.5071, val_error: 0.4962, auc: 0.7361
class 0 clustering acc 0.9998278236914601: correct 23228/23232 
class 1 clustering acc 0.007102272727272727: correct 15/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1081

Training for fine level...
batch 100, loss: 0.8603, instance_loss: 0.2232, weighted_loss: 0.6692, label: 2, bag_size: 165
batch 200, loss: 0.6434, instance_loss: 0.2060, weighted_loss: 0.5122, label: 2, bag_size: 983
batch 300, loss: 1.0506, instance_loss: 0.2351, weighted_loss: 0.8059, label: 2, bag_size: 1860
batch 400, loss: 1.9898, instance_loss: 0.2598, weighted_loss: 1.4708, label: 5, bag_size: 608
batch 500, loss: 3.3877, instance_loss: 0.4135, weighted_loss: 2.4955, label: 4, bag_size: 621
batch 600, loss: 0.6362, instance_loss: 0.1108, weighted_loss: 0.4786, label: 5, bag_size: 703
batch 700, loss: 0.9379, instance_loss: 0.1555, weighted_loss: 0.7032, label: 5, bag_size: 532
batch 800, loss: 0.9492, instance_loss: 0.2092, weighted_loss: 0.7272, label: 2, bag_size: 3530
batch 900, loss: 0.1378, instance_loss: 0.0990, weighted_loss: 0.1262, label: 5, bag_size: 883
batch 1000, loss: 0.2009, instance_loss: 0.1096, weighted_loss: 0.1735, label: 5, bag_size: 682
batch 1100, loss: 3.7575, instance_loss: 0.3825, weighted_loss: 2.7450, label: 0, bag_size: 419
batch 1200, loss: 0.9762, instance_loss: 0.1849, weighted_loss: 0.7388, label: 5, bag_size: 337
batch 1300, loss: 0.9159, instance_loss: 0.1832, weighted_loss: 0.6961, label: 5, bag_size: 382
batch 1400, loss: 0.8322, instance_loss: 0.1675, weighted_loss: 0.6328, label: 5, bag_size: 332
batch 1500, loss: 1.5970, instance_loss: 0.2034, weighted_loss: 1.1789, label: 5, bag_size: 376
batch 1600, loss: 2.2233, instance_loss: 0.3150, weighted_loss: 1.6508, label: 3, bag_size: 510
batch 1700, loss: 0.9599, instance_loss: 0.1819, weighted_loss: 0.7265, label: 5, bag_size: 286
batch 1800, loss: 0.1322, instance_loss: 0.0951, weighted_loss: 0.1210, label: 5, bag_size: 686
batch 1900, loss: 1.7992, instance_loss: 0.2713, weighted_loss: 1.3409, label: 8, bag_size: 175
batch 2000, loss: 0.8232, instance_loss: 0.1959, weighted_loss: 0.6350, label: 5, bag_size: 422
batch 2100, loss: 2.1242, instance_loss: 0.2926, weighted_loss: 1.5747, label: 4, bag_size: 2131

Instance Classifier Stats
class 0 clustering acc 0.9995391705069124: correct 190872/190960
class 1 clustering acc 0.0277073732718894: correct 481/17360

Epoch: 19, train_loss: 1.4893, train_clustering_loss: 0.2257, train_error: 0.5074
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6421663442940039, correct fine 332/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8747016706443914, correct fine 733/838 
fine class 6: fine acc 0.008032128514056224, correct fine 2/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4926

Val Set, val_loss: 1.4997, val_error: 0.4962, auc: 0.7415
class 0 clustering acc 0.9996986914600551: correct 23225/23232 
class 1 clustering acc 0.015625: correct 33/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1081

Training for fine level...
batch 100, loss: 1.3479, instance_loss: 0.2109, weighted_loss: 1.0068, label: 2, bag_size: 501
batch 200, loss: 0.7296, instance_loss: 0.1264, weighted_loss: 0.5487, label: 5, bag_size: 860
batch 300, loss: 1.7123, instance_loss: 0.2841, weighted_loss: 1.2838, label: 6, bag_size: 481
batch 400, loss: 2.3138, instance_loss: 0.2565, weighted_loss: 1.6966, label: 6, bag_size: 614
batch 500, loss: 0.7381, instance_loss: 0.1305, weighted_loss: 0.5558, label: 5, bag_size: 546
batch 600, loss: 1.7145, instance_loss: 0.2955, weighted_loss: 1.2888, label: 6, bag_size: 541
batch 700, loss: 1.6416, instance_loss: 0.2643, weighted_loss: 1.2284, label: 2, bag_size: 530
batch 800, loss: 1.0489, instance_loss: 0.2493, weighted_loss: 0.8090, label: 2, bag_size: 1744
batch 900, loss: 0.5602, instance_loss: 0.1854, weighted_loss: 0.4478, label: 2, bag_size: 795
batch 1000, loss: 0.0802, instance_loss: 0.0720, weighted_loss: 0.0777, label: 5, bag_size: 448
batch 1100, loss: 1.9754, instance_loss: 0.2866, weighted_loss: 1.4688, label: 2, bag_size: 353
batch 1200, loss: 0.5163, instance_loss: 0.1126, weighted_loss: 0.3952, label: 5, bag_size: 909
batch 1300, loss: 0.6432, instance_loss: 0.1611, weighted_loss: 0.4985, label: 2, bag_size: 2627
batch 1400, loss: 1.4235, instance_loss: 0.2590, weighted_loss: 1.0741, label: 2, bag_size: 472
batch 1500, loss: 2.2402, instance_loss: 0.2718, weighted_loss: 1.6497, label: 6, bag_size: 2033
batch 1600, loss: 0.2759, instance_loss: 0.1124, weighted_loss: 0.2268, label: 5, bag_size: 368
batch 1700, loss: 2.7629, instance_loss: 0.3359, weighted_loss: 2.0348, label: 4, bag_size: 471
batch 1800, loss: 0.2085, instance_loss: 0.1298, weighted_loss: 0.1849, label: 5, bag_size: 239
batch 1900, loss: 0.9450, instance_loss: 0.2151, weighted_loss: 0.7261, label: 2, bag_size: 374
batch 2000, loss: 0.5615, instance_loss: 0.1231, weighted_loss: 0.4299, label: 5, bag_size: 459
batch 2100, loss: 0.3690, instance_loss: 0.1729, weighted_loss: 0.3101, label: 2, bag_size: 633

Instance Classifier Stats
class 0 clustering acc 0.9994239631336406: correct 190850/190960
class 1 clustering acc 0.03796082949308756: correct 659/17360

Epoch: 20, train_loss: 1.4798, train_clustering_loss: 0.2243, train_error: 0.5060
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6363636363636364, correct fine 329/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8770883054892601, correct fine 735/838 
fine class 6: fine acc 0.020080321285140562, correct fine 5/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4940

Val Set, val_loss: 1.4928, val_error: 0.5000, auc: 0.7493
class 0 clustering acc 0.9996556473829201: correct 23224/23232 
class 1 clustering acc 0.024147727272727272: correct 51/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5000
Overall F1 Score: 0.1076

Training for fine level...
batch 100, loss: 0.8995, instance_loss: 0.1959, weighted_loss: 0.6884, label: 2, bag_size: 691
batch 200, loss: 2.6574, instance_loss: 0.3216, weighted_loss: 1.9566, label: 7, bag_size: 1196
batch 300, loss: 0.6768, instance_loss: 0.1965, weighted_loss: 0.5327, label: 2, bag_size: 697
batch 400, loss: 1.4613, instance_loss: 0.2525, weighted_loss: 1.0986, label: 2, bag_size: 556
batch 500, loss: 0.8330, instance_loss: 0.1733, weighted_loss: 0.6351, label: 5, bag_size: 187
batch 600, loss: 1.1199, instance_loss: 0.1892, weighted_loss: 0.8407, label: 2, bag_size: 792
batch 700, loss: 1.0448, instance_loss: 0.2118, weighted_loss: 0.7949, label: 5, bag_size: 368
batch 800, loss: 0.4712, instance_loss: 0.1532, weighted_loss: 0.3758, label: 2, bag_size: 3615
batch 900, loss: 1.7846, instance_loss: 0.2829, weighted_loss: 1.3341, label: 4, bag_size: 454
batch 1000, loss: 2.3348, instance_loss: 0.3412, weighted_loss: 1.7367, label: 8, bag_size: 571
batch 1100, loss: 0.6886, instance_loss: 0.1215, weighted_loss: 0.5185, label: 5, bag_size: 795
batch 1200, loss: 1.9455, instance_loss: 0.2941, weighted_loss: 1.4501, label: 6, bag_size: 451
batch 1300, loss: 0.5688, instance_loss: 0.0957, weighted_loss: 0.4269, label: 5, bag_size: 909
batch 1400, loss: 1.6442, instance_loss: 0.2936, weighted_loss: 1.2390, label: 4, bag_size: 1181
batch 1500, loss: 0.2642, instance_loss: 0.0959, weighted_loss: 0.2137, label: 5, bag_size: 1137
batch 1600, loss: 1.3021, instance_loss: 0.2086, weighted_loss: 0.9740, label: 5, bag_size: 371
batch 1700, loss: 3.9557, instance_loss: 0.3871, weighted_loss: 2.8851, label: 2, bag_size: 641
batch 1800, loss: 1.6913, instance_loss: 0.2746, weighted_loss: 1.2663, label: 8, bag_size: 245
batch 1900, loss: 0.2246, instance_loss: 0.0823, weighted_loss: 0.1820, label: 5, bag_size: 475
batch 2000, loss: 2.0308, instance_loss: 0.2431, weighted_loss: 1.4945, label: 5, bag_size: 348
batch 2100, loss: 0.3356, instance_loss: 0.1403, weighted_loss: 0.2770, label: 5, bag_size: 324

Instance Classifier Stats
class 0 clustering acc 0.9993611227482195: correct 190838/190960
class 1 clustering acc 0.04614055299539171: correct 801/17360

Epoch: 21, train_loss: 1.4716, train_clustering_loss: 0.2235, train_error: 0.5060
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6479690522243714, correct fine 335/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8711217183770883, correct fine 730/838 
fine class 6: fine acc 0.01606425702811245, correct fine 4/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4940

Val Set, val_loss: 1.4864, val_error: 0.4924, auc: 0.7523
class 0 clustering acc 0.9995695592286501: correct 23222/23232 
class 1 clustering acc 0.036931818181818184: correct 78/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.640625, correct fine 41/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1090

Training for fine level...
batch 100, loss: 0.2455, instance_loss: 0.0990, weighted_loss: 0.2015, label: 5, bag_size: 518
batch 200, loss: 0.8080, instance_loss: 0.1507, weighted_loss: 0.6108, label: 5, bag_size: 317
batch 300, loss: 3.3777, instance_loss: 0.3375, weighted_loss: 2.4656, label: 8, bag_size: 427
batch 400, loss: 0.1257, instance_loss: 0.0784, weighted_loss: 0.1115, label: 5, bag_size: 756
batch 500, loss: 1.3875, instance_loss: 0.2181, weighted_loss: 1.0366, label: 5, bag_size: 108
batch 600, loss: 0.8968, instance_loss: 0.1511, weighted_loss: 0.6731, label: 5, bag_size: 462
batch 700, loss: 2.4556, instance_loss: 0.2741, weighted_loss: 1.8011, label: 6, bag_size: 320
batch 800, loss: 1.9970, instance_loss: 0.1894, weighted_loss: 1.4547, label: 5, bag_size: 1830
batch 900, loss: 2.3839, instance_loss: 0.3106, weighted_loss: 1.7619, label: 3, bag_size: 657
batch 1000, loss: 1.3940, instance_loss: 0.2495, weighted_loss: 1.0506, label: 5, bag_size: 741
batch 1100, loss: 1.6423, instance_loss: 0.2092, weighted_loss: 1.2123, label: 5, bag_size: 275
batch 1200, loss: 2.0096, instance_loss: 0.3018, weighted_loss: 1.4973, label: 2, bag_size: 541
batch 1300, loss: 2.6704, instance_loss: 0.3118, weighted_loss: 1.9628, label: 7, bag_size: 1196
batch 1400, loss: 1.7037, instance_loss: 0.2769, weighted_loss: 1.2756, label: 6, bag_size: 1235
batch 1500, loss: 2.1850, instance_loss: 0.2721, weighted_loss: 1.6111, label: 5, bag_size: 2209
batch 1600, loss: 5.0677, instance_loss: 0.4339, weighted_loss: 3.6776, label: 7, bag_size: 868
batch 1700, loss: 1.2476, instance_loss: 0.1912, weighted_loss: 0.9307, label: 5, bag_size: 421
batch 1800, loss: 2.7277, instance_loss: 0.3380, weighted_loss: 2.0108, label: 3, bag_size: 952
batch 1900, loss: 2.1160, instance_loss: 0.2977, weighted_loss: 1.5705, label: 7, bag_size: 321
batch 2000, loss: 0.5633, instance_loss: 0.1764, weighted_loss: 0.4472, label: 2, bag_size: 2627
batch 2100, loss: 0.1352, instance_loss: 0.0818, weighted_loss: 0.1192, label: 5, bag_size: 250

Instance Classifier Stats
class 0 clustering acc 0.999272098868873: correct 190821/190960
class 1 clustering acc 0.052649769585253456: correct 914/17360

Epoch: 22, train_loss: 1.4637, train_clustering_loss: 0.2227, train_error: 0.5055
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6460348162475822, correct fine 334/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8735083532219571, correct fine 732/838 
fine class 6: fine acc 0.01606425702811245, correct fine 4/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4945

Val Set, val_loss: 1.4807, val_error: 0.4962, auc: 0.7549
class 0 clustering acc 0.9994404269972452: correct 23219/23232 
class 1 clustering acc 0.04971590909090909: correct 105/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1080

Training for fine level...
batch 100, loss: 0.9114, instance_loss: 0.1706, weighted_loss: 0.6892, label: 2, bag_size: 3773
batch 200, loss: 1.5385, instance_loss: 0.2777, weighted_loss: 1.1602, label: 6, bag_size: 732
batch 300, loss: 1.8458, instance_loss: 0.2750, weighted_loss: 1.3746, label: 8, bag_size: 79
batch 400, loss: 1.1981, instance_loss: 0.2173, weighted_loss: 0.9038, label: 2, bag_size: 161
batch 500, loss: 0.9799, instance_loss: 0.1583, weighted_loss: 0.7334, label: 5, bag_size: 237
batch 600, loss: 2.0300, instance_loss: 0.2762, weighted_loss: 1.5039, label: 3, bag_size: 1692
batch 700, loss: 1.2232, instance_loss: 0.2149, weighted_loss: 0.9207, label: 5, bag_size: 921
batch 800, loss: 4.3939, instance_loss: 0.4023, weighted_loss: 3.1964, label: 0, bag_size: 343
batch 900, loss: 0.6989, instance_loss: 0.1234, weighted_loss: 0.5263, label: 5, bag_size: 355
batch 1000, loss: 1.8611, instance_loss: 0.2695, weighted_loss: 1.3836, label: 2, bag_size: 215
batch 1100, loss: 2.1954, instance_loss: 0.3055, weighted_loss: 1.6285, label: 3, bag_size: 202
batch 1200, loss: 1.8221, instance_loss: 0.2351, weighted_loss: 1.3460, label: 5, bag_size: 237
batch 1300, loss: 0.8125, instance_loss: 0.1589, weighted_loss: 0.6164, label: 5, bag_size: 277
batch 1400, loss: 1.4696, instance_loss: 0.2616, weighted_loss: 1.1072, label: 6, bag_size: 1122
batch 1500, loss: 0.2880, instance_loss: 0.1193, weighted_loss: 0.2374, label: 5, bag_size: 629
batch 1600, loss: 0.4546, instance_loss: 0.1295, weighted_loss: 0.3571, label: 5, bag_size: 328
batch 1700, loss: 2.1566, instance_loss: 0.2834, weighted_loss: 1.5946, label: 6, bag_size: 379
batch 1800, loss: 0.1754, instance_loss: 0.0912, weighted_loss: 0.1501, label: 5, bag_size: 1005
batch 1900, loss: 0.8607, instance_loss: 0.1768, weighted_loss: 0.6555, label: 2, bag_size: 1232
batch 2000, loss: 0.1087, instance_loss: 0.1030, weighted_loss: 0.1070, label: 5, bag_size: 893
batch 2100, loss: 0.1428, instance_loss: 0.0808, weighted_loss: 0.1242, label: 5, bag_size: 890

Instance Classifier Stats
class 0 clustering acc 0.9989526602429828: correct 190760/190960
class 1 clustering acc 0.06261520737327189: correct 1087/17360

Epoch: 23, train_loss: 1.4566, train_clustering_loss: 0.2220, train_error: 0.5051
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6305609284332688, correct fine 326/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.008695652173913044, correct fine 1/115 
fine class 5: fine acc 0.8806682577565632, correct fine 738/838 
fine class 6: fine acc 0.028112449799196786, correct fine 7/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4949

Val Set, val_loss: 1.4750, val_error: 0.4962, auc: 0.7607
class 0 clustering acc 0.9995265151515151: correct 23221/23232 
class 1 clustering acc 0.061079545454545456: correct 129/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1080

Training for fine level...
batch 100, loss: 1.5452, instance_loss: 0.2306, weighted_loss: 1.1508, label: 5, bag_size: 463
batch 200, loss: 2.1944, instance_loss: 0.3075, weighted_loss: 1.6283, label: 7, bag_size: 172
batch 300, loss: 0.5846, instance_loss: 0.1511, weighted_loss: 0.4546, label: 2, bag_size: 2352
batch 400, loss: 0.0994, instance_loss: 0.1170, weighted_loss: 0.1047, label: 5, bag_size: 439
batch 500, loss: 0.4737, instance_loss: 0.1122, weighted_loss: 0.3653, label: 5, bag_size: 1262
batch 600, loss: 0.2248, instance_loss: 0.0938, weighted_loss: 0.1855, label: 5, bag_size: 565
batch 700, loss: 1.3071, instance_loss: 0.2384, weighted_loss: 0.9865, label: 5, bag_size: 544
batch 800, loss: 0.8777, instance_loss: 0.1380, weighted_loss: 0.6558, label: 5, bag_size: 485
batch 900, loss: 1.6733, instance_loss: 0.2462, weighted_loss: 1.2452, label: 2, bag_size: 290
batch 1000, loss: 1.6892, instance_loss: 0.2916, weighted_loss: 1.2699, label: 8, bag_size: 619
batch 1100, loss: 0.2804, instance_loss: 0.1056, weighted_loss: 0.2280, label: 5, bag_size: 221
batch 1200, loss: 1.7843, instance_loss: 0.2504, weighted_loss: 1.3241, label: 6, bag_size: 2046
batch 1300, loss: 2.0059, instance_loss: 0.2840, weighted_loss: 1.4893, label: 3, bag_size: 774
batch 1400, loss: 0.9848, instance_loss: 0.2081, weighted_loss: 0.7518, label: 5, bag_size: 344
batch 1500, loss: 1.7702, instance_loss: 0.3010, weighted_loss: 1.3294, label: 6, bag_size: 1043
batch 1600, loss: 1.3624, instance_loss: 0.2467, weighted_loss: 1.0277, label: 6, bag_size: 521
batch 1700, loss: 0.5827, instance_loss: 0.1359, weighted_loss: 0.4487, label: 5, bag_size: 524
batch 1800, loss: 0.5415, instance_loss: 0.1040, weighted_loss: 0.4102, label: 5, bag_size: 704
batch 1900, loss: 0.1548, instance_loss: 0.0941, weighted_loss: 0.1366, label: 5, bag_size: 228
batch 2000, loss: 0.2061, instance_loss: 0.1005, weighted_loss: 0.1744, label: 5, bag_size: 505
batch 2100, loss: 0.1286, instance_loss: 0.0908, weighted_loss: 0.1173, label: 5, bag_size: 724

Instance Classifier Stats
class 0 clustering acc 0.998842689568496: correct 190739/190960
class 1 clustering acc 0.07050691244239632: correct 1224/17360

Epoch: 24, train_loss: 1.4479, train_clustering_loss: 0.2215, train_error: 0.5046
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6363636363636364, correct fine 329/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.017391304347826087, correct fine 2/115 
fine class 5: fine acc 0.8735083532219571, correct fine 732/838 
fine class 6: fine acc 0.040160642570281124, correct fine 10/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.015151515151515152, correct fine 2/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4954

Val Set, val_loss: 1.4699, val_error: 0.4886, auc: 0.7636
class 0 clustering acc 0.9995695592286501: correct 23222/23232 
class 1 clustering acc 0.07196969696969698: correct 152/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1198

Training for fine level...
batch 100, loss: 2.1247, instance_loss: 0.2666, weighted_loss: 1.5672, label: 6, bag_size: 563
batch 200, loss: 3.0979, instance_loss: 0.3378, weighted_loss: 2.2699, label: 4, bag_size: 118
batch 300, loss: 1.9050, instance_loss: 0.3067, weighted_loss: 1.4255, label: 3, bag_size: 1706
batch 400, loss: 1.0480, instance_loss: 0.2122, weighted_loss: 0.7972, label: 2, bag_size: 374
batch 500, loss: 2.0084, instance_loss: 0.2842, weighted_loss: 1.4912, label: 8, bag_size: 185
batch 600, loss: 0.1355, instance_loss: 0.0919, weighted_loss: 0.1224, label: 5, bag_size: 620
batch 700, loss: 1.1657, instance_loss: 0.2030, weighted_loss: 0.8769, label: 2, bag_size: 692
batch 800, loss: 2.5232, instance_loss: 0.3302, weighted_loss: 1.8653, label: 7, bag_size: 263
batch 900, loss: 1.9334, instance_loss: 0.2912, weighted_loss: 1.4407, label: 3, bag_size: 605
batch 1000, loss: 0.3401, instance_loss: 0.1277, weighted_loss: 0.2764, label: 5, bag_size: 473
batch 1100, loss: 2.2118, instance_loss: 0.2829, weighted_loss: 1.6331, label: 8, bag_size: 361
batch 1200, loss: 4.8957, instance_loss: 0.4261, weighted_loss: 3.5548, label: 9, bag_size: 84
batch 1300, loss: 3.8754, instance_loss: 0.3973, weighted_loss: 2.8320, label: 8, bag_size: 435
batch 1400, loss: 0.0994, instance_loss: 0.0855, weighted_loss: 0.0952, label: 5, bag_size: 629
batch 1500, loss: 1.4594, instance_loss: 0.2904, weighted_loss: 1.1087, label: 4, bag_size: 606
batch 1600, loss: 0.6026, instance_loss: 0.1730, weighted_loss: 0.4737, label: 2, bag_size: 1231
batch 1700, loss: 3.1512, instance_loss: 0.3555, weighted_loss: 2.3125, label: 3, bag_size: 366
batch 1800, loss: 2.9583, instance_loss: 0.3256, weighted_loss: 2.1685, label: 4, bag_size: 37
batch 1900, loss: 1.7868, instance_loss: 0.2426, weighted_loss: 1.3235, label: 2, bag_size: 169
batch 2000, loss: 2.7601, instance_loss: 0.3244, weighted_loss: 2.0294, label: 8, bag_size: 253
batch 2100, loss: 2.0665, instance_loss: 0.2854, weighted_loss: 1.5322, label: 6, bag_size: 387

Instance Classifier Stats
class 0 clustering acc 0.9986803519061583: correct 190708/190960
class 1 clustering acc 0.08139400921658986: correct 1413/17360

Epoch: 25, train_loss: 1.4409, train_clustering_loss: 0.2206, train_error: 0.5018
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6247582205029013, correct fine 323/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.034782608695652174, correct fine 4/115 
fine class 5: fine acc 0.8794749403341289, correct fine 737/838 
fine class 6: fine acc 0.05220883534136546, correct fine 13/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4982

Val Set, val_loss: 1.4657, val_error: 0.4886, auc: 0.7665
class 0 clustering acc 0.9994834710743802: correct 23220/23232 
class 1 clustering acc 0.07859848484848485: correct 166/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1198

Training for fine level...
batch 100, loss: 1.0411, instance_loss: 0.1681, weighted_loss: 0.7792, label: 5, bag_size: 373
batch 200, loss: 0.6565, instance_loss: 0.1536, weighted_loss: 0.5056, label: 2, bag_size: 206
batch 300, loss: 0.4881, instance_loss: 0.1211, weighted_loss: 0.3780, label: 5, bag_size: 867
batch 400, loss: 1.0619, instance_loss: 0.2094, weighted_loss: 0.8062, label: 5, bag_size: 1165
batch 500, loss: 0.2429, instance_loss: 0.0764, weighted_loss: 0.1929, label: 5, bag_size: 713
batch 600, loss: 0.7624, instance_loss: 0.1652, weighted_loss: 0.5832, label: 2, bag_size: 666
batch 700, loss: 1.9222, instance_loss: 0.3244, weighted_loss: 1.4429, label: 3, bag_size: 806
batch 800, loss: 4.8234, instance_loss: 0.4279, weighted_loss: 3.5047, label: 10, bag_size: 724
batch 900, loss: 0.3537, instance_loss: 0.0924, weighted_loss: 0.2753, label: 5, bag_size: 239
batch 1000, loss: 2.2215, instance_loss: 0.2771, weighted_loss: 1.6382, label: 6, bag_size: 566
batch 1100, loss: 0.3130, instance_loss: 0.1032, weighted_loss: 0.2501, label: 5, bag_size: 304
batch 1200, loss: 3.2473, instance_loss: 0.3741, weighted_loss: 2.3853, label: 1, bag_size: 68
batch 1300, loss: 1.5948, instance_loss: 0.2307, weighted_loss: 1.1856, label: 2, bag_size: 123
batch 1400, loss: 0.1733, instance_loss: 0.1032, weighted_loss: 0.1523, label: 5, bag_size: 992
batch 1500, loss: 2.1400, instance_loss: 0.2787, weighted_loss: 1.5816, label: 6, bag_size: 304
batch 1600, loss: 2.4149, instance_loss: 0.3038, weighted_loss: 1.7816, label: 7, bag_size: 489
batch 1700, loss: 1.1189, instance_loss: 0.1923, weighted_loss: 0.8409, label: 5, bag_size: 644
batch 1800, loss: 1.0796, instance_loss: 0.2315, weighted_loss: 0.8252, label: 2, bag_size: 1744
batch 1900, loss: 1.2445, instance_loss: 0.2581, weighted_loss: 0.9486, label: 6, bag_size: 521
batch 2000, loss: 0.6637, instance_loss: 0.1495, weighted_loss: 0.5095, label: 2, bag_size: 623
batch 2100, loss: 2.6722, instance_loss: 0.3502, weighted_loss: 1.9756, label: 8, bag_size: 338

Instance Classifier Stats
class 0 clustering acc 0.9986227482195225: correct 190697/190960
class 1 clustering acc 0.0847926267281106: correct 1472/17360

Epoch: 26, train_loss: 1.4339, train_clustering_loss: 0.2201, train_error: 0.5037
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.620889748549323, correct fine 321/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.043478260869565216, correct fine 5/115 
fine class 5: fine acc 0.8758949880668258, correct fine 734/838 
fine class 6: fine acc 0.05622489959839357, correct fine 14/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4963

Val Set, val_loss: 1.4618, val_error: 0.4924, auc: 0.7683
class 0 clustering acc 0.9992252066115702: correct 23214/23232 
class 1 clustering acc 0.08901515151515152: correct 188/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.0, correct fine 0/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1187

Training for fine level...
batch 100, loss: 0.8911, instance_loss: 0.1884, weighted_loss: 0.6803, label: 5, bag_size: 1678
batch 200, loss: 0.1328, instance_loss: 0.0981, weighted_loss: 0.1224, label: 5, bag_size: 296
batch 300, loss: 3.9863, instance_loss: 0.3931, weighted_loss: 2.9084, label: 4, bag_size: 424
batch 400, loss: 1.7397, instance_loss: 0.2777, weighted_loss: 1.3011, label: 2, bag_size: 341
batch 500, loss: 1.8662, instance_loss: 0.2382, weighted_loss: 1.3778, label: 5, bag_size: 112
batch 600, loss: 0.8739, instance_loss: 0.1812, weighted_loss: 0.6661, label: 2, bag_size: 1897
batch 700, loss: 0.3187, instance_loss: 0.1443, weighted_loss: 0.2664, label: 2, bag_size: 873
batch 800, loss: 0.9710, instance_loss: 0.1948, weighted_loss: 0.7381, label: 2, bag_size: 1700
batch 900, loss: 2.1185, instance_loss: 0.2585, weighted_loss: 1.5605, label: 6, bag_size: 563
batch 1000, loss: 0.9116, instance_loss: 0.1618, weighted_loss: 0.6867, label: 2, bag_size: 659
batch 1100, loss: 1.6380, instance_loss: 0.2212, weighted_loss: 1.2130, label: 2, bag_size: 78
batch 1200, loss: 3.0094, instance_loss: 0.3515, weighted_loss: 2.2120, label: 7, bag_size: 479
batch 1300, loss: 2.5756, instance_loss: 0.2723, weighted_loss: 1.8846, label: 3, bag_size: 522
batch 1400, loss: 0.7385, instance_loss: 0.1816, weighted_loss: 0.5714, label: 2, bag_size: 270
batch 1500, loss: 0.0816, instance_loss: 0.0684, weighted_loss: 0.0777, label: 5, bag_size: 331
batch 1600, loss: 0.0706, instance_loss: 0.0806, weighted_loss: 0.0736, label: 5, bag_size: 190
batch 1700, loss: 0.7936, instance_loss: 0.1572, weighted_loss: 0.6027, label: 2, bag_size: 2601
batch 1800, loss: 2.4816, instance_loss: 0.2949, weighted_loss: 1.8256, label: 6, bag_size: 273
batch 1900, loss: 0.0735, instance_loss: 0.0644, weighted_loss: 0.0708, label: 5, bag_size: 365
batch 2000, loss: 0.5728, instance_loss: 0.1616, weighted_loss: 0.4495, label: 2, bag_size: 1817
batch 2100, loss: 1.4667, instance_loss: 0.2746, weighted_loss: 1.1091, label: 6, bag_size: 156

Instance Classifier Stats
class 0 clustering acc 0.9984604105571847: correct 190666/190960
class 1 clustering acc 0.09337557603686636: correct 1621/17360

Epoch: 27, train_loss: 1.4294, train_clustering_loss: 0.2195, train_error: 0.5014
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6189555125725339, correct fine 320/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.06086956521739131, correct fine 7/115 
fine class 5: fine acc 0.8794749403341289, correct fine 737/838 
fine class 6: fine acc 0.05622489959839357, correct fine 14/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4986

Val Set, val_loss: 1.4581, val_error: 0.4886, auc: 0.7693
class 0 clustering acc 0.9992252066115702: correct 23214/23232 
class 1 clustering acc 0.0946969696969697: correct 200/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1246

Training for fine level...
batch 100, loss: 1.3443, instance_loss: 0.2340, weighted_loss: 1.0112, label: 2, bag_size: 2085
batch 200, loss: 0.2887, instance_loss: 0.1000, weighted_loss: 0.2321, label: 5, bag_size: 629
batch 300, loss: 1.9943, instance_loss: 0.2452, weighted_loss: 1.4695, label: 2, bag_size: 1009
batch 400, loss: 0.0984, instance_loss: 0.0858, weighted_loss: 0.0946, label: 5, bag_size: 305
batch 500, loss: 1.3356, instance_loss: 0.2064, weighted_loss: 0.9969, label: 2, bag_size: 454
batch 600, loss: 0.9209, instance_loss: 0.2206, weighted_loss: 0.7108, label: 2, bag_size: 385
batch 700, loss: 1.0941, instance_loss: 0.1741, weighted_loss: 0.8181, label: 5, bag_size: 131
batch 800, loss: 1.8697, instance_loss: 0.2852, weighted_loss: 1.3943, label: 4, bag_size: 1147
batch 900, loss: 2.5854, instance_loss: 0.3109, weighted_loss: 1.9031, label: 8, bag_size: 268
batch 1000, loss: 0.4976, instance_loss: 0.1445, weighted_loss: 0.3917, label: 5, bag_size: 310
batch 1100, loss: 1.8580, instance_loss: 0.2894, weighted_loss: 1.3874, label: 3, bag_size: 605
batch 1200, loss: 0.7499, instance_loss: 0.1650, weighted_loss: 0.5744, label: 5, bag_size: 187
batch 1300, loss: 0.8203, instance_loss: 0.1637, weighted_loss: 0.6233, label: 5, bag_size: 258
batch 1400, loss: 0.9556, instance_loss: 0.2026, weighted_loss: 0.7297, label: 5, bag_size: 368
batch 1500, loss: 2.3843, instance_loss: 0.2704, weighted_loss: 1.7501, label: 6, bag_size: 276
batch 1600, loss: 1.7258, instance_loss: 0.2493, weighted_loss: 1.2828, label: 5, bag_size: 237
batch 1700, loss: 0.5562, instance_loss: 0.1691, weighted_loss: 0.4401, label: 2, bag_size: 1447
batch 1800, loss: 0.5226, instance_loss: 0.1601, weighted_loss: 0.4139, label: 2, bag_size: 1632
batch 1900, loss: 0.6626, instance_loss: 0.1540, weighted_loss: 0.5101, label: 2, bag_size: 313
batch 2000, loss: 0.8153, instance_loss: 0.1668, weighted_loss: 0.6207, label: 2, bag_size: 1234
batch 2100, loss: 0.7019, instance_loss: 0.1569, weighted_loss: 0.5384, label: 2, bag_size: 848

Instance Classifier Stats
class 0 clustering acc 0.9983661499790532: correct 190648/190960
class 1 clustering acc 0.09544930875576037: correct 1657/17360

Epoch: 28, train_loss: 1.4229, train_clustering_loss: 0.2193, train_error: 0.4977
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6170212765957447, correct fine 319/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.09565217391304348, correct fine 11/115 
fine class 5: fine acc 0.8806682577565632, correct fine 738/838 
fine class 6: fine acc 0.07228915662650602, correct fine 18/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5023

Val Set, val_loss: 1.4553, val_error: 0.4886, auc: 0.7713
class 0 clustering acc 0.9988808539944903: correct 23206/23232 
class 1 clustering acc 0.09895833333333333: correct 209/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.0, correct fine 0/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1246

Training for fine level...
batch 100, loss: 2.2477, instance_loss: 0.2884, weighted_loss: 1.6599, label: 6, bag_size: 641
batch 200, loss: 1.1563, instance_loss: 0.2975, weighted_loss: 0.8987, label: 2, bag_size: 1516
batch 300, loss: 0.3790, instance_loss: 0.0968, weighted_loss: 0.2944, label: 5, bag_size: 298
batch 400, loss: 1.7534, instance_loss: 0.2369, weighted_loss: 1.2984, label: 5, bag_size: 1897
batch 500, loss: 0.4994, instance_loss: 0.1120, weighted_loss: 0.3832, label: 5, bag_size: 342
batch 600, loss: 1.6061, instance_loss: 0.1516, weighted_loss: 1.1697, label: 5, bag_size: 746
batch 700, loss: 2.2340, instance_loss: 0.2441, weighted_loss: 1.6370, label: 5, bag_size: 621
batch 800, loss: 0.9361, instance_loss: 0.1599, weighted_loss: 0.7032, label: 5, bag_size: 525
batch 900, loss: 0.0933, instance_loss: 0.0753, weighted_loss: 0.0879, label: 5, bag_size: 198
batch 1000, loss: 1.4908, instance_loss: 0.2103, weighted_loss: 1.1066, label: 5, bag_size: 353
batch 1100, loss: 0.6826, instance_loss: 0.1357, weighted_loss: 0.5186, label: 5, bag_size: 838
batch 1200, loss: 0.3207, instance_loss: 0.1425, weighted_loss: 0.2673, label: 2, bag_size: 1189
batch 1300, loss: 0.6463, instance_loss: 0.1478, weighted_loss: 0.4968, label: 2, bag_size: 1229
batch 1400, loss: 0.1087, instance_loss: 0.0666, weighted_loss: 0.0961, label: 5, bag_size: 1281
batch 1500, loss: 0.1991, instance_loss: 0.0731, weighted_loss: 0.1613, label: 5, bag_size: 875
batch 1600, loss: 1.5219, instance_loss: 0.2559, weighted_loss: 1.1421, label: 2, bag_size: 442
batch 1700, loss: 0.2574, instance_loss: 0.0747, weighted_loss: 0.2026, label: 5, bag_size: 457
batch 1800, loss: 2.1640, instance_loss: 0.2630, weighted_loss: 1.5937, label: 6, bag_size: 344
batch 1900, loss: 0.5015, instance_loss: 0.1090, weighted_loss: 0.3838, label: 5, bag_size: 679
batch 2000, loss: 1.4030, instance_loss: 0.2286, weighted_loss: 1.0507, label: 2, bag_size: 654
batch 2100, loss: 1.0703, instance_loss: 0.2180, weighted_loss: 0.8146, label: 2, bag_size: 1691

Instance Classifier Stats
class 0 clustering acc 0.9982509426057813: correct 190626/190960
class 1 clustering acc 0.10161290322580645: correct 1764/17360

Epoch: 29, train_loss: 1.4173, train_clustering_loss: 0.2189, train_error: 0.5005
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6170212765957447, correct fine 319/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.10434782608695652, correct fine 12/115 
fine class 5: fine acc 0.8747016706443914, correct fine 733/838 
fine class 6: fine acc 0.06827309236947791, correct fine 17/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4995

Val Set, val_loss: 1.4520, val_error: 0.4886, auc: 0.7723
class 0 clustering acc 0.9987947658402204: correct 23204/23232 
class 1 clustering acc 0.10464015151515152: correct 221/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1355

Training for fine level...
batch 100, loss: 1.4687, instance_loss: 0.2043, weighted_loss: 1.0894, label: 2, bag_size: 779
batch 200, loss: 2.9849, instance_loss: 0.3236, weighted_loss: 2.1865, label: 7, bag_size: 479
batch 300, loss: 0.3916, instance_loss: 0.1000, weighted_loss: 0.3041, label: 5, bag_size: 482
batch 400, loss: 0.0889, instance_loss: 0.0894, weighted_loss: 0.0890, label: 5, bag_size: 475
batch 500, loss: 2.6672, instance_loss: 0.2718, weighted_loss: 1.9486, label: 6, bag_size: 1123
batch 600, loss: 1.5507, instance_loss: 0.1545, weighted_loss: 1.1318, label: 5, bag_size: 1145
batch 700, loss: 1.5079, instance_loss: 0.2932, weighted_loss: 1.1435, label: 2, bag_size: 534
batch 800, loss: 0.9402, instance_loss: 0.2032, weighted_loss: 0.7191, label: 5, bag_size: 350
batch 900, loss: 0.4464, instance_loss: 0.1280, weighted_loss: 0.3509, label: 5, bag_size: 390
batch 1000, loss: 1.6454, instance_loss: 0.2600, weighted_loss: 1.2298, label: 2, bag_size: 169
batch 1100, loss: 1.0554, instance_loss: 0.2729, weighted_loss: 0.8207, label: 4, bag_size: 606
batch 1200, loss: 1.2106, instance_loss: 0.1409, weighted_loss: 0.8897, label: 5, bag_size: 369
batch 1300, loss: 1.0309, instance_loss: 0.1642, weighted_loss: 0.7709, label: 5, bag_size: 742
batch 1400, loss: 2.3002, instance_loss: 0.3075, weighted_loss: 1.7024, label: 8, bag_size: 558
batch 1500, loss: 1.1977, instance_loss: 0.1466, weighted_loss: 0.8824, label: 5, bag_size: 658
batch 1600, loss: 4.2127, instance_loss: 0.4468, weighted_loss: 3.0829, label: 10, bag_size: 2314
batch 1700, loss: 0.5709, instance_loss: 0.1354, weighted_loss: 0.4403, label: 2, bag_size: 833
batch 1800, loss: 1.2304, instance_loss: 0.2179, weighted_loss: 0.9266, label: 5, bag_size: 271
batch 1900, loss: 0.0757, instance_loss: 0.0660, weighted_loss: 0.0727, label: 5, bag_size: 455
batch 2000, loss: 1.9005, instance_loss: 0.3243, weighted_loss: 1.4276, label: 2, bag_size: 675
batch 2100, loss: 1.7357, instance_loss: 0.2525, weighted_loss: 1.2907, label: 2, bag_size: 369

Instance Classifier Stats
class 0 clustering acc 0.9981043150397989: correct 190598/190960
class 1 clustering acc 0.10195852534562212: correct 1770/17360

Epoch: 30, train_loss: 1.4122, train_clustering_loss: 0.2183, train_error: 0.4982
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6073500967117988, correct fine 314/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1391304347826087, correct fine 16/115 
fine class 5: fine acc 0.8770883054892601, correct fine 735/838 
fine class 6: fine acc 0.07630522088353414, correct fine 19/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5018

Val Set, val_loss: 1.4500, val_error: 0.4886, auc: 0.7723
class 0 clustering acc 0.9985365013774105: correct 23198/23232 
class 1 clustering acc 0.11363636363636363: correct 240/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1357

Training for fine level...
batch 100, loss: 2.2153, instance_loss: 0.2572, weighted_loss: 1.6278, label: 6, bag_size: 361
batch 200, loss: 1.8433, instance_loss: 0.2458, weighted_loss: 1.3641, label: 2, bag_size: 562
batch 300, loss: 1.7572, instance_loss: 0.2504, weighted_loss: 1.3051, label: 2, bag_size: 544
batch 400, loss: 0.8197, instance_loss: 0.1412, weighted_loss: 0.6162, label: 2, bag_size: 1360
batch 500, loss: 0.4379, instance_loss: 0.1561, weighted_loss: 0.3533, label: 2, bag_size: 534
batch 600, loss: 1.8843, instance_loss: 0.2655, weighted_loss: 1.3987, label: 2, bag_size: 165
batch 700, loss: 2.9109, instance_loss: 0.3835, weighted_loss: 2.1527, label: 3, bag_size: 371
batch 800, loss: 0.7992, instance_loss: 0.1562, weighted_loss: 0.6063, label: 2, bag_size: 943
batch 900, loss: 2.8648, instance_loss: 0.4221, weighted_loss: 2.1320, label: 4, bag_size: 616
batch 1000, loss: 0.8999, instance_loss: 0.1684, weighted_loss: 0.6804, label: 2, bag_size: 476
batch 1100, loss: 1.6924, instance_loss: 0.2326, weighted_loss: 1.2544, label: 5, bag_size: 478
batch 1200, loss: 1.9904, instance_loss: 0.2766, weighted_loss: 1.4763, label: 2, bag_size: 493
batch 1300, loss: 3.0667, instance_loss: 0.3510, weighted_loss: 2.2520, label: 1, bag_size: 352
batch 1400, loss: 1.4337, instance_loss: 0.1691, weighted_loss: 1.0543, label: 5, bag_size: 1145
batch 1500, loss: 0.4995, instance_loss: 0.1508, weighted_loss: 0.3949, label: 2, bag_size: 334
batch 1600, loss: 2.1559, instance_loss: 0.3064, weighted_loss: 1.6010, label: 7, bag_size: 179
batch 1700, loss: 1.6308, instance_loss: 0.2236, weighted_loss: 1.2086, label: 2, bag_size: 437
batch 1800, loss: 0.0879, instance_loss: 0.0855, weighted_loss: 0.0872, label: 5, bag_size: 475
batch 1900, loss: 1.0486, instance_loss: 0.1541, weighted_loss: 0.7803, label: 5, bag_size: 890
batch 2000, loss: 2.2769, instance_loss: 0.2861, weighted_loss: 1.6796, label: 6, bag_size: 322
batch 2100, loss: 2.4426, instance_loss: 0.2801, weighted_loss: 1.7939, label: 4, bag_size: 121

Instance Classifier Stats
class 0 clustering acc 0.9980728948470884: correct 190592/190960
class 1 clustering acc 0.11370967741935484: correct 1974/17360

Epoch: 31, train_loss: 1.4086, train_clustering_loss: 0.2176, train_error: 0.4954
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6073500967117988, correct fine 314/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.14782608695652175, correct fine 17/115 
fine class 5: fine acc 0.8842482100238663, correct fine 741/838 
fine class 6: fine acc 0.07630522088353414, correct fine 19/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5046

Val Set, val_loss: 1.4467, val_error: 0.4848, auc: 0.7727
class 0 clustering acc 0.9985365013774105: correct 23198/23232 
class 1 clustering acc 0.11410984848484848: correct 241/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1460

Training for fine level...
batch 100, loss: 0.1934, instance_loss: 0.0990, weighted_loss: 0.1651, label: 5, bag_size: 574
batch 200, loss: 1.6701, instance_loss: 0.2137, weighted_loss: 1.2332, label: 5, bag_size: 1744
batch 300, loss: 1.4165, instance_loss: 0.2363, weighted_loss: 1.0625, label: 2, bag_size: 190
batch 400, loss: 2.1523, instance_loss: 0.2788, weighted_loss: 1.5903, label: 6, bag_size: 1010
batch 500, loss: 4.4678, instance_loss: 0.4262, weighted_loss: 3.2553, label: 10, bag_size: 625
batch 600, loss: 0.6444, instance_loss: 0.1612, weighted_loss: 0.4994, label: 2, bag_size: 1833
batch 700, loss: 0.0452, instance_loss: 0.0508, weighted_loss: 0.0469, label: 5, bag_size: 307
batch 800, loss: 1.0783, instance_loss: 0.2463, weighted_loss: 0.8287, label: 2, bag_size: 265
batch 900, loss: 0.5443, instance_loss: 0.1385, weighted_loss: 0.4226, label: 5, bag_size: 1222
batch 1000, loss: 1.0694, instance_loss: 0.2695, weighted_loss: 0.8294, label: 4, bag_size: 542
batch 1100, loss: 0.2062, instance_loss: 0.0608, weighted_loss: 0.1626, label: 5, bag_size: 467
batch 1200, loss: 0.1316, instance_loss: 0.0640, weighted_loss: 0.1113, label: 5, bag_size: 488
batch 1300, loss: 0.1970, instance_loss: 0.0796, weighted_loss: 0.1618, label: 5, bag_size: 511
batch 1400, loss: 1.3150, instance_loss: 0.2575, weighted_loss: 0.9978, label: 6, bag_size: 352
batch 1500, loss: 1.3067, instance_loss: 0.2184, weighted_loss: 0.9802, label: 5, bag_size: 359
batch 1600, loss: 1.0898, instance_loss: 0.2619, weighted_loss: 0.8414, label: 6, bag_size: 521
batch 1700, loss: 2.6505, instance_loss: 0.2855, weighted_loss: 1.9410, label: 4, bag_size: 691
batch 1800, loss: 1.0637, instance_loss: 0.2127, weighted_loss: 0.8084, label: 5, bag_size: 1165
batch 1900, loss: 1.9570, instance_loss: 0.3080, weighted_loss: 1.4623, label: 7, bag_size: 172
batch 2000, loss: 3.0002, instance_loss: 0.4260, weighted_loss: 2.2279, label: 7, bag_size: 388
batch 2100, loss: 1.3202, instance_loss: 0.3079, weighted_loss: 1.0165, label: 6, bag_size: 373

Instance Classifier Stats
class 0 clustering acc 0.9979157938835358: correct 190562/190960
class 1 clustering acc 0.11710829493087557: correct 2033/17360

Epoch: 32, train_loss: 1.4037, train_clustering_loss: 0.2175, train_error: 0.4954
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5918762088974855, correct fine 306/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1565217391304348, correct fine 18/115 
fine class 5: fine acc 0.8902147971360382, correct fine 746/838 
fine class 6: fine acc 0.08032128514056225, correct fine 20/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5046

Val Set, val_loss: 1.4447, val_error: 0.4886, auc: 0.7741
class 0 clustering acc 0.9986225895316805: correct 23200/23232 
class 1 clustering acc 0.11458333333333333: correct 242/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1459

Training for fine level...
batch 100, loss: 0.5683, instance_loss: 0.1593, weighted_loss: 0.4456, label: 2, bag_size: 1762
batch 200, loss: 1.2609, instance_loss: 0.2287, weighted_loss: 0.9512, label: 2, bag_size: 296
batch 300, loss: 1.9430, instance_loss: 0.2665, weighted_loss: 1.4401, label: 2, bag_size: 726
batch 400, loss: 0.1379, instance_loss: 0.0576, weighted_loss: 0.1139, label: 5, bag_size: 602
batch 500, loss: 1.3340, instance_loss: 0.2501, weighted_loss: 1.0089, label: 6, bag_size: 589
batch 600, loss: 1.0656, instance_loss: 0.2017, weighted_loss: 0.8064, label: 2, bag_size: 898
batch 700, loss: 2.5434, instance_loss: 0.3253, weighted_loss: 1.8780, label: 2, bag_size: 775
batch 800, loss: 2.1981, instance_loss: 0.2944, weighted_loss: 1.6270, label: 7, bag_size: 529
batch 900, loss: 1.0169, instance_loss: 0.2083, weighted_loss: 0.7743, label: 5, bag_size: 178
batch 1000, loss: 0.3753, instance_loss: 0.1369, weighted_loss: 0.3038, label: 5, bag_size: 473
batch 1100, loss: 1.9618, instance_loss: 0.2793, weighted_loss: 1.4571, label: 8, bag_size: 264
batch 1200, loss: 0.0821, instance_loss: 0.0459, weighted_loss: 0.0712, label: 5, bag_size: 474
batch 1300, loss: 1.7180, instance_loss: 0.2373, weighted_loss: 1.2738, label: 5, bag_size: 478
batch 1400, loss: 0.5462, instance_loss: 0.1449, weighted_loss: 0.4258, label: 2, bag_size: 1771
batch 1500, loss: 0.4400, instance_loss: 0.1330, weighted_loss: 0.3479, label: 5, bag_size: 573
batch 1600, loss: 0.8611, instance_loss: 0.1568, weighted_loss: 0.6498, label: 5, bag_size: 396
batch 1700, loss: 0.0762, instance_loss: 0.0487, weighted_loss: 0.0679, label: 5, bag_size: 495
batch 1800, loss: 0.2276, instance_loss: 0.0889, weighted_loss: 0.1860, label: 5, bag_size: 304
batch 1900, loss: 1.1756, instance_loss: 0.2018, weighted_loss: 0.8835, label: 2, bag_size: 424
batch 2000, loss: 1.1451, instance_loss: 0.1886, weighted_loss: 0.8582, label: 5, bag_size: 352
batch 2100, loss: 2.4486, instance_loss: 0.2642, weighted_loss: 1.7933, label: 5, bag_size: 100

Instance Classifier Stats
class 0 clustering acc 0.997926267281106: correct 190564/190960
class 1 clustering acc 0.11733870967741936: correct 2037/17360

Epoch: 33, train_loss: 1.4016, train_clustering_loss: 0.2173, train_error: 0.4986
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6150870406189555, correct fine 318/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1565217391304348, correct fine 18/115 
fine class 5: fine acc 0.8687350835322196, correct fine 728/838 
fine class 6: fine acc 0.07630522088353414, correct fine 19/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5014

Val Set, val_loss: 1.4421, val_error: 0.4848, auc: 0.7750
class 0 clustering acc 0.9982351928374655: correct 23191/23232 
class 1 clustering acc 0.125: correct 264/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1463

Training for fine level...
batch 100, loss: 0.5489, instance_loss: 0.1379, weighted_loss: 0.4256, label: 2, bag_size: 1535
batch 200, loss: 3.1328, instance_loss: 0.3983, weighted_loss: 2.3125, label: 2, bag_size: 665
batch 300, loss: 1.5731, instance_loss: 0.2777, weighted_loss: 1.1845, label: 6, bag_size: 247
batch 400, loss: 1.1518, instance_loss: 0.1803, weighted_loss: 0.8603, label: 5, bag_size: 280
batch 500, loss: 1.9005, instance_loss: 0.2853, weighted_loss: 1.4159, label: 8, bag_size: 285
batch 600, loss: 0.1138, instance_loss: 0.0619, weighted_loss: 0.0982, label: 5, bag_size: 658
batch 700, loss: 1.6070, instance_loss: 0.2237, weighted_loss: 1.1920, label: 5, bag_size: 375
batch 800, loss: 0.7670, instance_loss: 0.1418, weighted_loss: 0.5794, label: 2, bag_size: 1435
batch 900, loss: 0.3143, instance_loss: 0.0708, weighted_loss: 0.2413, label: 5, bag_size: 468
batch 1000, loss: 4.4468, instance_loss: 0.4434, weighted_loss: 3.2458, label: 4, bag_size: 424
batch 1100, loss: 0.5928, instance_loss: 0.1319, weighted_loss: 0.4545, label: 2, bag_size: 757
batch 1200, loss: 0.9483, instance_loss: 0.1587, weighted_loss: 0.7114, label: 2, bag_size: 659
batch 1300, loss: 0.5940, instance_loss: 0.1334, weighted_loss: 0.4558, label: 2, bag_size: 2047
batch 1400, loss: 3.2927, instance_loss: 0.4006, weighted_loss: 2.4250, label: 7, bag_size: 708
batch 1500, loss: 1.2137, instance_loss: 0.1660, weighted_loss: 0.8994, label: 2, bag_size: 537
batch 1600, loss: 4.0296, instance_loss: 0.3700, weighted_loss: 2.9317, label: 3, bag_size: 633
batch 1700, loss: 2.5026, instance_loss: 0.3152, weighted_loss: 1.8464, label: 7, bag_size: 778
batch 1800, loss: 1.3493, instance_loss: 0.2755, weighted_loss: 1.0272, label: 8, bag_size: 216
batch 1900, loss: 0.9165, instance_loss: 0.1199, weighted_loss: 0.6775, label: 5, bag_size: 466
batch 2000, loss: 2.2036, instance_loss: 0.3071, weighted_loss: 1.6347, label: 7, bag_size: 478
batch 2100, loss: 0.4095, instance_loss: 0.1381, weighted_loss: 0.3281, label: 2, bag_size: 660

Instance Classifier Stats
class 0 clustering acc 0.9977744030163385: correct 190535/190960
class 1 clustering acc 0.12263824884792626: correct 2129/17360

Epoch: 34, train_loss: 1.3961, train_clustering_loss: 0.2165, train_error: 0.4917
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5957446808510638, correct fine 308/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.1826086956521739, correct fine 21/115 
fine class 5: fine acc 0.8914081145584726, correct fine 747/838 
fine class 6: fine acc 0.08835341365461848, correct fine 22/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5083

Val Set, val_loss: 1.4400, val_error: 0.5000, auc: 0.7767
class 0 clustering acc 0.9983212809917356: correct 23193/23232 
class 1 clustering acc 0.125: correct 264/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5000
Overall F1 Score: 0.1431

Training for fine level...
batch 100, loss: 2.3963, instance_loss: 0.3856, weighted_loss: 1.7931, label: 6, bag_size: 266
batch 200, loss: 0.7908, instance_loss: 0.1545, weighted_loss: 0.5999, label: 5, bag_size: 473
batch 300, loss: 0.2451, instance_loss: 0.0925, weighted_loss: 0.1993, label: 5, bag_size: 345
batch 400, loss: 0.8494, instance_loss: 0.1492, weighted_loss: 0.6393, label: 5, bag_size: 370
batch 500, loss: 0.8325, instance_loss: 0.1813, weighted_loss: 0.6371, label: 2, bag_size: 691
batch 600, loss: 2.5561, instance_loss: 0.3075, weighted_loss: 1.8815, label: 4, bag_size: 169
batch 700, loss: 0.1996, instance_loss: 0.0886, weighted_loss: 0.1663, label: 5, bag_size: 673
batch 800, loss: 2.0237, instance_loss: 0.2757, weighted_loss: 1.4993, label: 6, bag_size: 562
batch 900, loss: 1.4667, instance_loss: 0.2871, weighted_loss: 1.1128, label: 3, bag_size: 1313
batch 1000, loss: 1.6677, instance_loss: 0.2848, weighted_loss: 1.2528, label: 6, bag_size: 1238
batch 1100, loss: 1.6905, instance_loss: 0.2628, weighted_loss: 1.2622, label: 5, bag_size: 276
batch 1200, loss: 2.0297, instance_loss: 0.2804, weighted_loss: 1.5049, label: 6, bag_size: 1019
batch 1300, loss: 1.7942, instance_loss: 0.2798, weighted_loss: 1.3399, label: 8, bag_size: 209
batch 1400, loss: 0.4950, instance_loss: 0.1409, weighted_loss: 0.3888, label: 2, bag_size: 2214
batch 1500, loss: 1.2017, instance_loss: 0.2153, weighted_loss: 0.9058, label: 5, bag_size: 188
batch 1600, loss: 0.0901, instance_loss: 0.0561, weighted_loss: 0.0799, label: 5, bag_size: 249
batch 1700, loss: 3.9701, instance_loss: 0.3837, weighted_loss: 2.8942, label: 7, bag_size: 2158
batch 1800, loss: 1.1424, instance_loss: 0.1906, weighted_loss: 0.8568, label: 2, bag_size: 785
batch 1900, loss: 5.0781, instance_loss: 0.4008, weighted_loss: 3.6749, label: 9, bag_size: 862
batch 2000, loss: 0.8631, instance_loss: 0.1885, weighted_loss: 0.6607, label: 2, bag_size: 333
batch 2100, loss: 0.0506, instance_loss: 0.0546, weighted_loss: 0.0518, label: 5, bag_size: 381

Instance Classifier Stats
class 0 clustering acc 0.9977272727272727: correct 190526/190960
class 1 clustering acc 0.12425115207373272: correct 2157/17360

Epoch: 35, train_loss: 1.3921, train_clustering_loss: 0.2164, train_error: 0.4866
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5899419729206963, correct fine 305/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.89618138424821, correct fine 751/838 
fine class 6: fine acc 0.10843373493975904, correct fine 27/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5134

Val Set, val_loss: 1.4387, val_error: 0.4962, auc: 0.7780
class 0 clustering acc 0.9983212809917356: correct 23193/23232 
class 1 clustering acc 0.1268939393939394: correct 268/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1441

Training for fine level...
batch 100, loss: 0.3359, instance_loss: 0.1920, weighted_loss: 0.2927, label: 5, bag_size: 11
batch 200, loss: 1.0080, instance_loss: 0.1593, weighted_loss: 0.7534, label: 5, bag_size: 337
batch 300, loss: 1.3275, instance_loss: 0.2014, weighted_loss: 0.9897, label: 5, bag_size: 95
batch 400, loss: 0.0638, instance_loss: 0.0604, weighted_loss: 0.0628, label: 5, bag_size: 451
batch 500, loss: 0.1634, instance_loss: 0.0836, weighted_loss: 0.1395, label: 5, bag_size: 193
batch 600, loss: 2.4909, instance_loss: 0.3022, weighted_loss: 1.8343, label: 6, bag_size: 283
batch 700, loss: 2.0343, instance_loss: 0.3318, weighted_loss: 1.5236, label: 2, bag_size: 268
batch 800, loss: 1.5051, instance_loss: 0.3073, weighted_loss: 1.1458, label: 3, bag_size: 2045
batch 900, loss: 1.4716, instance_loss: 0.2272, weighted_loss: 1.0983, label: 5, bag_size: 275
batch 1000, loss: 0.8077, instance_loss: 0.1496, weighted_loss: 0.6103, label: 5, bag_size: 355
batch 1100, loss: 3.4357, instance_loss: 0.3338, weighted_loss: 2.5051, label: 4, bag_size: 1827
batch 1200, loss: 1.2046, instance_loss: 0.1916, weighted_loss: 0.9007, label: 5, bag_size: 604
batch 1300, loss: 3.5164, instance_loss: 0.3370, weighted_loss: 2.5626, label: 3, bag_size: 933
batch 1400, loss: 2.4343, instance_loss: 0.3488, weighted_loss: 1.8087, label: 7, bag_size: 850
batch 1500, loss: 2.0964, instance_loss: 0.2967, weighted_loss: 1.5565, label: 8, bag_size: 661
batch 1600, loss: 0.4078, instance_loss: 0.0930, weighted_loss: 0.3134, label: 5, bag_size: 482
batch 1700, loss: 0.2478, instance_loss: 0.0643, weighted_loss: 0.1928, label: 5, bag_size: 622
batch 1800, loss: 1.6663, instance_loss: 0.2062, weighted_loss: 1.2283, label: 5, bag_size: 200
batch 1900, loss: 0.0769, instance_loss: 0.0542, weighted_loss: 0.0701, label: 5, bag_size: 874
batch 2000, loss: 0.5538, instance_loss: 0.1165, weighted_loss: 0.4226, label: 5, bag_size: 510
batch 2100, loss: 3.7033, instance_loss: 0.3829, weighted_loss: 2.7072, label: 0, bag_size: 558

Instance Classifier Stats
class 0 clustering acc 0.9977901131126937: correct 190538/190960
class 1 clustering acc 0.12626728110599078: correct 2192/17360

Epoch: 36, train_loss: 1.3897, train_clustering_loss: 0.2161, train_error: 0.4876
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6112185686653772, correct fine 316/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.19130434782608696, correct fine 22/115 
fine class 5: fine acc 0.8878281622911695, correct fine 744/838 
fine class 6: fine acc 0.10040160642570281, correct fine 25/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5124

Val Set, val_loss: 1.4361, val_error: 0.4962, auc: 0.7780
class 0 clustering acc 0.9981921487603306: correct 23190/23232 
class 1 clustering acc 0.13020833333333334: correct 275/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1444

Training for fine level...
batch 100, loss: 1.4030, instance_loss: 0.2477, weighted_loss: 1.0564, label: 2, bag_size: 201
batch 200, loss: 0.5600, instance_loss: 0.1331, weighted_loss: 0.4319, label: 5, bag_size: 597
batch 300, loss: 4.0493, instance_loss: 0.4282, weighted_loss: 2.9629, label: 10, bag_size: 357
batch 400, loss: 2.2866, instance_loss: 0.2654, weighted_loss: 1.6803, label: 5, bag_size: 100
batch 500, loss: 1.3555, instance_loss: 0.2202, weighted_loss: 1.0149, label: 2, bag_size: 1618
batch 600, loss: 1.3066, instance_loss: 0.2713, weighted_loss: 0.9960, label: 6, bag_size: 256
batch 700, loss: 1.8017, instance_loss: 0.3008, weighted_loss: 1.3514, label: 3, bag_size: 483
batch 800, loss: 2.1928, instance_loss: 0.3256, weighted_loss: 1.6326, label: 2, bag_size: 361
batch 900, loss: 3.0824, instance_loss: 0.3462, weighted_loss: 2.2615, label: 1, bag_size: 258
batch 1000, loss: 1.2320, instance_loss: 0.1848, weighted_loss: 0.9179, label: 2, bag_size: 792
batch 1100, loss: 1.6970, instance_loss: 0.2901, weighted_loss: 1.2749, label: 3, bag_size: 123
batch 1200, loss: 3.0487, instance_loss: 0.3385, weighted_loss: 2.2357, label: 8, bag_size: 378
batch 1300, loss: 3.0722, instance_loss: 0.2833, weighted_loss: 2.2355, label: 3, bag_size: 477
batch 1400, loss: 0.2434, instance_loss: 0.1040, weighted_loss: 0.2016, label: 5, bag_size: 817
batch 1500, loss: 1.7042, instance_loss: 0.3214, weighted_loss: 1.2893, label: 6, bag_size: 389
batch 1600, loss: 1.9747, instance_loss: 0.3021, weighted_loss: 1.4729, label: 7, bag_size: 311
batch 1700, loss: 0.8905, instance_loss: 0.1318, weighted_loss: 0.6629, label: 2, bag_size: 1617
batch 1800, loss: 0.6134, instance_loss: 0.1154, weighted_loss: 0.4640, label: 5, bag_size: 307
batch 1900, loss: 1.3641, instance_loss: 0.2581, weighted_loss: 1.0323, label: 2, bag_size: 343
batch 2000, loss: 0.7238, instance_loss: 0.1636, weighted_loss: 0.5557, label: 5, bag_size: 552
batch 2100, loss: 1.4609, instance_loss: 0.2109, weighted_loss: 1.0859, label: 5, bag_size: 347

Instance Classifier Stats
class 0 clustering acc 0.9976487222454964: correct 190511/190960
class 1 clustering acc 0.12776497695852534: correct 2218/17360

Epoch: 37, train_loss: 1.3869, train_clustering_loss: 0.2161, train_error: 0.4922
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5822050290135397, correct fine 301/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.883054892601432, correct fine 740/838 
fine class 6: fine acc 0.12449799196787148, correct fine 31/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5078

Val Set, val_loss: 1.4347, val_error: 0.5000, auc: 0.7793
class 0 clustering acc 0.9980630165289256: correct 23187/23232 
class 1 clustering acc 0.13446969696969696: correct 284/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5000
Overall F1 Score: 0.1433

Training for fine level...
batch 100, loss: 2.0543, instance_loss: 0.2925, weighted_loss: 1.5258, label: 4, bag_size: 556
batch 200, loss: 0.0544, instance_loss: 0.0358, weighted_loss: 0.0488, label: 5, bag_size: 883
batch 300, loss: 1.4852, instance_loss: 0.2500, weighted_loss: 1.1146, label: 2, bag_size: 177
batch 400, loss: 1.5751, instance_loss: 0.2426, weighted_loss: 1.1753, label: 2, bag_size: 531
batch 500, loss: 2.6829, instance_loss: 0.3838, weighted_loss: 1.9932, label: 8, bag_size: 278
batch 600, loss: 5.0407, instance_loss: 0.4486, weighted_loss: 3.6631, label: 10, bag_size: 724
batch 700, loss: 2.5788, instance_loss: 0.3070, weighted_loss: 1.8973, label: 6, bag_size: 281
batch 800, loss: 0.0843, instance_loss: 0.0567, weighted_loss: 0.0761, label: 5, bag_size: 223
batch 900, loss: 2.5801, instance_loss: 0.3316, weighted_loss: 1.9056, label: 8, bag_size: 367
batch 1000, loss: 0.3331, instance_loss: 0.1036, weighted_loss: 0.2643, label: 5, bag_size: 234
batch 1100, loss: 1.4014, instance_loss: 0.1449, weighted_loss: 1.0245, label: 2, bag_size: 848
batch 1200, loss: 1.8522, instance_loss: 0.3224, weighted_loss: 1.3933, label: 2, bag_size: 675
batch 1300, loss: 0.5161, instance_loss: 0.1432, weighted_loss: 0.4042, label: 2, bag_size: 1304
batch 1400, loss: 1.0367, instance_loss: 0.1843, weighted_loss: 0.7810, label: 2, bag_size: 900
batch 1500, loss: 0.9289, instance_loss: 0.2251, weighted_loss: 0.7178, label: 5, bag_size: 299
batch 1600, loss: 2.9616, instance_loss: 0.3304, weighted_loss: 2.1722, label: 8, bag_size: 388
batch 1700, loss: 0.3544, instance_loss: 0.0770, weighted_loss: 0.2712, label: 5, bag_size: 703
batch 1800, loss: 2.6321, instance_loss: 0.2863, weighted_loss: 1.9284, label: 6, bag_size: 252
batch 1900, loss: 0.1214, instance_loss: 0.0668, weighted_loss: 0.1050, label: 5, bag_size: 178
batch 2000, loss: 1.2111, instance_loss: 0.1580, weighted_loss: 0.8952, label: 2, bag_size: 537
batch 2100, loss: 1.1583, instance_loss: 0.2136, weighted_loss: 0.8749, label: 5, bag_size: 429

Instance Classifier Stats
class 0 clustering acc 0.9974916212819439: correct 190481/190960
class 1 clustering acc 0.13317972350230414: correct 2312/17360

Epoch: 38, train_loss: 1.3827, train_clustering_loss: 0.2155, train_error: 0.4843
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6092843326885881, correct fine 315/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.20869565217391303, correct fine 24/115 
fine class 5: fine acc 0.8914081145584726, correct fine 747/838 
fine class 6: fine acc 0.11244979919678715, correct fine 28/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5157

Val Set, val_loss: 1.4330, val_error: 0.5000, auc: 0.7805
class 0 clustering acc 0.9980630165289256: correct 23187/23232 
class 1 clustering acc 0.13541666666666666: correct 286/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5000
Overall F1 Score: 0.1431

Training for fine level...
batch 100, loss: 0.1604, instance_loss: 0.0683, weighted_loss: 0.1327, label: 5, bag_size: 437
batch 200, loss: 1.6942, instance_loss: 0.2357, weighted_loss: 1.2567, label: 2, bag_size: 334
batch 300, loss: 1.6434, instance_loss: 0.2791, weighted_loss: 1.2341, label: 3, bag_size: 1249
batch 400, loss: 0.2477, instance_loss: 0.0831, weighted_loss: 0.1984, label: 5, bag_size: 859
batch 500, loss: 0.9771, instance_loss: 0.2360, weighted_loss: 0.7548, label: 2, bag_size: 975
batch 600, loss: 3.2630, instance_loss: 0.3252, weighted_loss: 2.3816, label: 1, bag_size: 153
batch 700, loss: 1.7860, instance_loss: 0.3900, weighted_loss: 1.3672, label: 2, bag_size: 564
batch 800, loss: 2.3707, instance_loss: 0.3212, weighted_loss: 1.7558, label: 1, bag_size: 235
batch 900, loss: 0.8287, instance_loss: 0.1829, weighted_loss: 0.6350, label: 2, bag_size: 766
batch 1000, loss: 1.6950, instance_loss: 0.2225, weighted_loss: 1.2533, label: 2, bag_size: 169
batch 1100, loss: 2.4541, instance_loss: 0.3853, weighted_loss: 1.8335, label: 3, bag_size: 901
batch 1200, loss: 1.6829, instance_loss: 0.2678, weighted_loss: 1.2583, label: 3, bag_size: 755
batch 1300, loss: 1.3434, instance_loss: 0.2407, weighted_loss: 1.0126, label: 2, bag_size: 201
batch 1400, loss: 0.6765, instance_loss: 0.1379, weighted_loss: 0.5149, label: 5, bag_size: 296
batch 1500, loss: 4.9813, instance_loss: 0.4514, weighted_loss: 3.6223, label: 4, bag_size: 510
batch 1600, loss: 0.6527, instance_loss: 0.1361, weighted_loss: 0.4977, label: 2, bag_size: 592
batch 1700, loss: 0.7300, instance_loss: 0.1686, weighted_loss: 0.5616, label: 5, bag_size: 1564
batch 1800, loss: 1.8204, instance_loss: 0.2873, weighted_loss: 1.3605, label: 8, bag_size: 185
batch 1900, loss: 0.7858, instance_loss: 0.1489, weighted_loss: 0.5948, label: 5, bag_size: 422
batch 2000, loss: 0.4304, instance_loss: 0.1228, weighted_loss: 0.3382, label: 2, bag_size: 2692
batch 2100, loss: 0.6127, instance_loss: 0.1163, weighted_loss: 0.4638, label: 5, bag_size: 460

Instance Classifier Stats
class 0 clustering acc 0.9975335148722245: correct 190489/190960
class 1 clustering acc 0.13220046082949308: correct 2295/17360

Epoch: 39, train_loss: 1.3806, train_clustering_loss: 0.2153, train_error: 0.4848
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6092843326885881, correct fine 315/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.24347826086956523, correct fine 28/115 
fine class 5: fine acc 0.8782816229116945, correct fine 736/838 
fine class 6: fine acc 0.13654618473895583, correct fine 34/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5152

Val Set, val_loss: 1.4312, val_error: 0.4848, auc: 0.7809
class 0 clustering acc 0.9977617079889807: correct 23180/23232 
class 1 clustering acc 0.14488636363636365: correct 306/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1514

Training for fine level...
batch 100, loss: 0.7985, instance_loss: 0.1774, weighted_loss: 0.6122, label: 2, bag_size: 943
batch 200, loss: 0.7294, instance_loss: 0.1254, weighted_loss: 0.5482, label: 2, bag_size: 1360
batch 300, loss: 1.3936, instance_loss: 0.2169, weighted_loss: 1.0406, label: 5, bag_size: 336
batch 400, loss: 3.2849, instance_loss: 0.3897, weighted_loss: 2.4164, label: 7, bag_size: 599
batch 500, loss: 2.2406, instance_loss: 0.2737, weighted_loss: 1.6505, label: 6, bag_size: 696
batch 600, loss: 1.4744, instance_loss: 0.2120, weighted_loss: 1.0957, label: 5, bag_size: 311
batch 700, loss: 0.4015, instance_loss: 0.1588, weighted_loss: 0.3287, label: 2, bag_size: 309
batch 800, loss: 2.7800, instance_loss: 0.3108, weighted_loss: 2.0393, label: 8, bag_size: 542
batch 900, loss: 4.2997, instance_loss: 0.3730, weighted_loss: 3.1217, label: 9, bag_size: 307
batch 1000, loss: 1.4000, instance_loss: 0.3308, weighted_loss: 1.0792, label: 6, bag_size: 1096
batch 1100, loss: 0.9084, instance_loss: 0.1860, weighted_loss: 0.6917, label: 5, bag_size: 229
batch 1200, loss: 1.7150, instance_loss: 0.2674, weighted_loss: 1.2807, label: 6, bag_size: 682
batch 1300, loss: 4.6046, instance_loss: 0.4073, weighted_loss: 3.3454, label: 10, bag_size: 289
batch 1400, loss: 1.6459, instance_loss: 0.2733, weighted_loss: 1.2341, label: 8, bag_size: 619
batch 1500, loss: 1.6307, instance_loss: 0.2266, weighted_loss: 1.2095, label: 5, bag_size: 112
batch 1600, loss: 0.1073, instance_loss: 0.0714, weighted_loss: 0.0965, label: 5, bag_size: 667
batch 1700, loss: 2.3676, instance_loss: 0.2775, weighted_loss: 1.7406, label: 5, bag_size: 663
batch 1800, loss: 0.3238, instance_loss: 0.2362, weighted_loss: 0.2975, label: 4, bag_size: 260
batch 1900, loss: 1.3345, instance_loss: 0.3000, weighted_loss: 1.0241, label: 6, bag_size: 411
batch 2000, loss: 1.6646, instance_loss: 0.2401, weighted_loss: 1.2372, label: 5, bag_size: 104
batch 2100, loss: 2.3486, instance_loss: 0.3236, weighted_loss: 1.7411, label: 7, bag_size: 850

Instance Classifier Stats
class 0 clustering acc 0.9973973607038124: correct 190463/190960
class 1 clustering acc 0.13836405529953916: correct 2402/17360

Epoch: 40, train_loss: 1.3782, train_clustering_loss: 0.2148, train_error: 0.4839
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5938104448742747, correct fine 307/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.8949880668257757, correct fine 750/838 
fine class 6: fine acc 0.1285140562248996, correct fine 32/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5161

Val Set, val_loss: 1.4295, val_error: 0.4962, auc: 0.7828
class 0 clustering acc 0.9979338842975206: correct 23184/23232 
class 1 clustering acc 0.1425189393939394: correct 301/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1486

Training for fine level...
batch 100, loss: 5.2179, instance_loss: 0.4668, weighted_loss: 3.7926, label: 7, bag_size: 868
batch 200, loss: 1.7549, instance_loss: 0.2447, weighted_loss: 1.3018, label: 2, bag_size: 471
batch 300, loss: 1.7402, instance_loss: 0.3212, weighted_loss: 1.3145, label: 3, bag_size: 1987
batch 400, loss: 0.5476, instance_loss: 0.0962, weighted_loss: 0.4122, label: 5, bag_size: 308
batch 500, loss: 0.1079, instance_loss: 0.0503, weighted_loss: 0.0906, label: 5, bag_size: 1049
batch 600, loss: 0.3683, instance_loss: 0.1050, weighted_loss: 0.2893, label: 5, bag_size: 289
batch 700, loss: 0.7939, instance_loss: 0.1752, weighted_loss: 0.6083, label: 2, bag_size: 1659
batch 800, loss: 0.2478, instance_loss: 0.0892, weighted_loss: 0.2002, label: 5, bag_size: 226
batch 900, loss: 3.6534, instance_loss: 0.3684, weighted_loss: 2.6679, label: 1, bag_size: 439
batch 1000, loss: 0.9049, instance_loss: 0.1893, weighted_loss: 0.6902, label: 5, bag_size: 431
batch 1100, loss: 1.5961, instance_loss: 0.2772, weighted_loss: 1.2004, label: 3, bag_size: 292
batch 1200, loss: 2.4259, instance_loss: 0.2512, weighted_loss: 1.7735, label: 5, bag_size: 663
batch 1300, loss: 1.1449, instance_loss: 0.2802, weighted_loss: 0.8855, label: 4, bag_size: 919
batch 1400, loss: 2.2755, instance_loss: 0.3349, weighted_loss: 1.6933, label: 6, bag_size: 600
batch 1500, loss: 1.2619, instance_loss: 0.2620, weighted_loss: 0.9619, label: 6, bag_size: 209
batch 1600, loss: 2.4395, instance_loss: 0.2783, weighted_loss: 1.7912, label: 4, bag_size: 374
batch 1700, loss: 3.4762, instance_loss: 0.3426, weighted_loss: 2.5361, label: 1, bag_size: 451
batch 1800, loss: 1.1219, instance_loss: 0.2513, weighted_loss: 0.8607, label: 5, bag_size: 275
batch 1900, loss: 0.2154, instance_loss: 0.0699, weighted_loss: 0.1718, label: 5, bag_size: 857
batch 2000, loss: 1.1813, instance_loss: 0.1967, weighted_loss: 0.8859, label: 5, bag_size: 667
batch 2100, loss: 2.0809, instance_loss: 0.2835, weighted_loss: 1.5417, label: 7, bag_size: 452

Instance Classifier Stats
class 0 clustering acc 0.997564935064935: correct 190495/190960
class 1 clustering acc 0.1363479262672811: correct 2367/17360

Epoch: 41, train_loss: 1.3753, train_clustering_loss: 0.2147, train_error: 0.4848
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5938104448742747, correct fine 307/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.23478260869565218, correct fine 27/115 
fine class 5: fine acc 0.8854415274463007, correct fine 742/838 
fine class 6: fine acc 0.13654618473895583, correct fine 34/249 
fine class 7: fine acc 0.011235955056179775, correct fine 1/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5152

Val Set, val_loss: 1.4281, val_error: 0.4886, auc: 0.7835
class 0 clustering acc 0.9976756198347108: correct 23178/23232 
class 1 clustering acc 0.14678030303030304: correct 310/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1503

Training for fine level...
batch 100, loss: 0.9167, instance_loss: 0.2699, weighted_loss: 0.7227, label: 4, bag_size: 160
batch 200, loss: 0.1504, instance_loss: 0.0952, weighted_loss: 0.1338, label: 5, bag_size: 387
batch 300, loss: 1.9846, instance_loss: 0.3025, weighted_loss: 1.4799, label: 8, bag_size: 149
batch 400, loss: 0.1468, instance_loss: 0.0683, weighted_loss: 0.1232, label: 5, bag_size: 424
batch 500, loss: 0.1883, instance_loss: 0.0576, weighted_loss: 0.1491, label: 5, bag_size: 705
batch 600, loss: 3.6141, instance_loss: 0.3028, weighted_loss: 2.6207, label: 3, bag_size: 233
batch 700, loss: 1.3011, instance_loss: 0.2955, weighted_loss: 0.9994, label: 6, bag_size: 474
batch 800, loss: 2.5284, instance_loss: 0.3253, weighted_loss: 1.8674, label: 7, bag_size: 778
batch 900, loss: 1.5595, instance_loss: 0.3140, weighted_loss: 1.1858, label: 6, bag_size: 649
batch 1000, loss: 0.1729, instance_loss: 0.0684, weighted_loss: 0.1416, label: 5, bag_size: 451
batch 1100, loss: 1.3215, instance_loss: 0.2488, weighted_loss: 0.9997, label: 2, bag_size: 149
batch 1200, loss: 0.5754, instance_loss: 0.1699, weighted_loss: 0.4538, label: 2, bag_size: 1470
batch 1300, loss: 0.1007, instance_loss: 0.0358, weighted_loss: 0.0813, label: 5, bag_size: 1161
batch 1400, loss: 1.9728, instance_loss: 0.2943, weighted_loss: 1.4693, label: 2, bag_size: 726
batch 1500, loss: 1.4076, instance_loss: 0.2065, weighted_loss: 1.0473, label: 2, bag_size: 258
batch 1600, loss: 0.6412, instance_loss: 0.0764, weighted_loss: 0.4718, label: 5, bag_size: 1600
batch 1700, loss: 0.3504, instance_loss: 0.0974, weighted_loss: 0.2745, label: 5, bag_size: 593
batch 1800, loss: 1.8663, instance_loss: 0.3092, weighted_loss: 1.3992, label: 2, bag_size: 449
batch 1900, loss: 1.0503, instance_loss: 0.1378, weighted_loss: 0.7765, label: 5, bag_size: 369
batch 2000, loss: 1.6440, instance_loss: 0.2837, weighted_loss: 1.2359, label: 2, bag_size: 446
batch 2100, loss: 2.4427, instance_loss: 0.3941, weighted_loss: 1.8281, label: 2, bag_size: 559

Instance Classifier Stats
class 0 clustering acc 0.9972769166317553: correct 190440/190960
class 1 clustering acc 0.13922811059907833: correct 2417/17360

Epoch: 42, train_loss: 1.3731, train_clustering_loss: 0.2149, train_error: 0.4848
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5899419729206963, correct fine 305/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.8890214797136038, correct fine 745/838 
fine class 6: fine acc 0.14859437751004015, correct fine 37/249 
fine class 7: fine acc 0.011235955056179775, correct fine 1/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5152

Val Set, val_loss: 1.4271, val_error: 0.4962, auc: 0.7850
class 0 clustering acc 0.9978047520661157: correct 23181/23232 
class 1 clustering acc 0.14630681818181818: correct 309/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1443

Training for fine level...
batch 100, loss: 1.7438, instance_loss: 0.2791, weighted_loss: 1.3044, label: 7, bag_size: 312
batch 200, loss: 4.6399, instance_loss: 0.4297, weighted_loss: 3.3768, label: 4, bag_size: 424
batch 300, loss: 1.1251, instance_loss: 0.2120, weighted_loss: 0.8511, label: 2, bag_size: 940
batch 400, loss: 2.0027, instance_loss: 0.2359, weighted_loss: 1.4727, label: 5, bag_size: 621
batch 500, loss: 2.0878, instance_loss: 0.2736, weighted_loss: 1.5435, label: 6, bag_size: 1019
batch 600, loss: 0.6828, instance_loss: 0.1121, weighted_loss: 0.5116, label: 2, bag_size: 418
batch 700, loss: 2.5259, instance_loss: 0.3163, weighted_loss: 1.8630, label: 3, bag_size: 160
batch 800, loss: 0.9076, instance_loss: 0.1212, weighted_loss: 0.6717, label: 2, bag_size: 784
batch 900, loss: 0.2996, instance_loss: 0.1000, weighted_loss: 0.2397, label: 5, bag_size: 1330
batch 1000, loss: 2.0744, instance_loss: 0.2898, weighted_loss: 1.5390, label: 7, bag_size: 590
batch 1100, loss: 0.1549, instance_loss: 0.0745, weighted_loss: 0.1308, label: 5, bag_size: 574
batch 1200, loss: 3.6361, instance_loss: 0.3683, weighted_loss: 2.6558, label: 8, bag_size: 527
batch 1300, loss: 1.1201, instance_loss: 0.2243, weighted_loss: 0.8514, label: 2, bag_size: 349
batch 1400, loss: 0.4784, instance_loss: 0.1455, weighted_loss: 0.3785, label: 2, bag_size: 2214
batch 1500, loss: 4.0494, instance_loss: 0.4204, weighted_loss: 2.9607, label: 10, bag_size: 751
batch 1600, loss: 0.1336, instance_loss: 0.0625, weighted_loss: 0.1123, label: 5, bag_size: 592
batch 1700, loss: 0.9066, instance_loss: 0.1870, weighted_loss: 0.6907, label: 5, bag_size: 229
batch 1800, loss: 0.3786, instance_loss: 0.1457, weighted_loss: 0.3088, label: 2, bag_size: 334
batch 1900, loss: 1.7271, instance_loss: 0.2848, weighted_loss: 1.2944, label: 3, bag_size: 602
batch 2000, loss: 0.1155, instance_loss: 0.0699, weighted_loss: 0.1018, label: 5, bag_size: 261
batch 2100, loss: 1.5042, instance_loss: 0.2409, weighted_loss: 1.1252, label: 2, bag_size: 774

Instance Classifier Stats
class 0 clustering acc 0.9973868873062421: correct 190461/190960
class 1 clustering acc 0.14193548387096774: correct 2464/17360

Epoch: 43, train_loss: 1.3682, train_clustering_loss: 0.2144, train_error: 0.4816
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.24347826086956523, correct fine 28/115 
fine class 5: fine acc 0.8937947494033412, correct fine 749/838 
fine class 6: fine acc 0.12449799196787148, correct fine 31/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5184

Val Set, val_loss: 1.4254, val_error: 0.4962, auc: 0.7855
class 0 clustering acc 0.9977617079889807: correct 23180/23232 
class 1 clustering acc 0.14678030303030304: correct 310/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1488

Training for fine level...
batch 100, loss: 0.6680, instance_loss: 0.1382, weighted_loss: 0.5091, label: 2, bag_size: 2037
batch 200, loss: 1.5843, instance_loss: 0.2981, weighted_loss: 1.1984, label: 3, bag_size: 1249
batch 300, loss: 0.1455, instance_loss: 0.0730, weighted_loss: 0.1238, label: 5, bag_size: 369
batch 400, loss: 0.1529, instance_loss: 0.0579, weighted_loss: 0.1244, label: 5, bag_size: 592
batch 500, loss: 1.7010, instance_loss: 0.3129, weighted_loss: 1.2846, label: 2, bag_size: 534
batch 600, loss: 0.9844, instance_loss: 0.2012, weighted_loss: 0.7494, label: 5, bag_size: 286
batch 700, loss: 0.1913, instance_loss: 0.0863, weighted_loss: 0.1598, label: 5, bag_size: 705
batch 800, loss: 2.0649, instance_loss: 0.3006, weighted_loss: 1.5356, label: 7, bag_size: 111
batch 900, loss: 0.6593, instance_loss: 0.1303, weighted_loss: 0.5006, label: 2, bag_size: 1311
batch 1000, loss: 1.5021, instance_loss: 0.2676, weighted_loss: 1.1318, label: 8, bag_size: 144
batch 1100, loss: 0.0957, instance_loss: 0.0482, weighted_loss: 0.0815, label: 5, bag_size: 969
batch 1200, loss: 2.0644, instance_loss: 0.2683, weighted_loss: 1.5256, label: 6, bag_size: 344
batch 1300, loss: 1.4090, instance_loss: 0.2162, weighted_loss: 1.0512, label: 2, bag_size: 646
batch 1400, loss: 0.1314, instance_loss: 0.0589, weighted_loss: 0.1097, label: 5, bag_size: 507
batch 1500, loss: 1.0642, instance_loss: 0.2633, weighted_loss: 0.8239, label: 6, bag_size: 526
batch 1600, loss: 0.4275, instance_loss: 0.0901, weighted_loss: 0.3262, label: 5, bag_size: 636
batch 1700, loss: 1.9925, instance_loss: 0.3216, weighted_loss: 1.4912, label: 7, bag_size: 189
batch 1800, loss: 0.7854, instance_loss: 0.1552, weighted_loss: 0.5963, label: 5, bag_size: 630
batch 1900, loss: 1.4103, instance_loss: 0.2543, weighted_loss: 1.0635, label: 2, bag_size: 347
batch 2000, loss: 1.6091, instance_loss: 0.2927, weighted_loss: 1.2142, label: 3, bag_size: 605
batch 2100, loss: 0.7146, instance_loss: 0.1462, weighted_loss: 0.5441, label: 5, bag_size: 534

Instance Classifier Stats
class 0 clustering acc 0.9972402597402598: correct 190433/190960
class 1 clustering acc 0.14147465437788018: correct 2456/17360

Epoch: 44, train_loss: 1.3653, train_clustering_loss: 0.2141, train_error: 0.4843
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5822050290135397, correct fine 301/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.25217391304347825, correct fine 29/115 
fine class 5: fine acc 0.8902147971360382, correct fine 746/838 
fine class 6: fine acc 0.14056224899598393, correct fine 35/249 
fine class 7: fine acc 0.011235955056179775, correct fine 1/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5157

Val Set, val_loss: 1.4248, val_error: 0.4924, auc: 0.7855
class 0 clustering acc 0.9977186639118457: correct 23179/23232 
class 1 clustering acc 0.14867424242424243: correct 314/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1498

Training for fine level...
batch 100, loss: 1.9351, instance_loss: 0.2387, weighted_loss: 1.4262, label: 5, bag_size: 621
batch 200, loss: 0.4401, instance_loss: 0.0976, weighted_loss: 0.3374, label: 5, bag_size: 636
batch 300, loss: 1.2112, instance_loss: 0.2547, weighted_loss: 0.9242, label: 8, bag_size: 120
batch 400, loss: 1.5344, instance_loss: 0.2886, weighted_loss: 1.1607, label: 8, bag_size: 383
batch 500, loss: 2.5532, instance_loss: 0.3262, weighted_loss: 1.8851, label: 1, bag_size: 101
batch 600, loss: 0.0858, instance_loss: 0.0522, weighted_loss: 0.0757, label: 5, bag_size: 202
batch 700, loss: 0.8430, instance_loss: 0.1507, weighted_loss: 0.6353, label: 2, bag_size: 659
batch 800, loss: 1.0570, instance_loss: 0.2190, weighted_loss: 0.8056, label: 5, bag_size: 271
batch 900, loss: 2.9637, instance_loss: 0.4030, weighted_loss: 2.1955, label: 8, bag_size: 838
batch 1000, loss: 2.2211, instance_loss: 0.2678, weighted_loss: 1.6351, label: 6, bag_size: 696
batch 1100, loss: 0.6362, instance_loss: 0.1399, weighted_loss: 0.4873, label: 2, bag_size: 2433
batch 1200, loss: 1.6000, instance_loss: 0.2733, weighted_loss: 1.2020, label: 3, bag_size: 567
batch 1300, loss: 2.9174, instance_loss: 0.2918, weighted_loss: 2.1297, label: 3, bag_size: 285
batch 1400, loss: 1.3760, instance_loss: 0.2230, weighted_loss: 1.0301, label: 5, bag_size: 220
batch 1500, loss: 0.2953, instance_loss: 0.0796, weighted_loss: 0.2306, label: 5, bag_size: 97
batch 1600, loss: 1.7743, instance_loss: 0.2511, weighted_loss: 1.3173, label: 2, bag_size: 224
batch 1700, loss: 1.6989, instance_loss: 0.3078, weighted_loss: 1.2815, label: 3, bag_size: 1118
batch 1800, loss: 3.6272, instance_loss: 0.3741, weighted_loss: 2.6513, label: 7, bag_size: 675
batch 1900, loss: 1.1712, instance_loss: 0.1338, weighted_loss: 0.8600, label: 5, bag_size: 734
batch 2000, loss: 1.5227, instance_loss: 0.2394, weighted_loss: 1.1377, label: 6, bag_size: 629
batch 2100, loss: 1.2871, instance_loss: 0.2288, weighted_loss: 0.9696, label: 2, bag_size: 473

Instance Classifier Stats
class 0 clustering acc 0.9972612065354001: correct 190437/190960
class 1 clustering acc 0.1452188940092166: correct 2521/17360

Epoch: 45, train_loss: 1.3652, train_clustering_loss: 0.2138, train_error: 0.4806
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5899419729206963, correct fine 305/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.14457831325301204, correct fine 36/249 
fine class 7: fine acc 0.02247191011235955, correct fine 2/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5194

Val Set, val_loss: 1.4238, val_error: 0.4924, auc: 0.7860
class 0 clustering acc 0.9978047520661157: correct 23181/23232 
class 1 clustering acc 0.15056818181818182: correct 318/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1498

Training for fine level...
batch 100, loss: 1.3451, instance_loss: 0.2118, weighted_loss: 1.0051, label: 5, bag_size: 458
batch 200, loss: 2.9994, instance_loss: 0.3492, weighted_loss: 2.2044, label: 3, bag_size: 454
batch 300, loss: 0.3446, instance_loss: 0.1195, weighted_loss: 0.2771, label: 2, bag_size: 1110
batch 400, loss: 2.6120, instance_loss: 0.3243, weighted_loss: 1.9257, label: 6, bag_size: 273
batch 500, loss: 0.7187, instance_loss: 0.1490, weighted_loss: 0.5478, label: 5, bag_size: 735
batch 600, loss: 3.6833, instance_loss: 0.3337, weighted_loss: 2.6784, label: 7, bag_size: 345
batch 700, loss: 2.6609, instance_loss: 0.2853, weighted_loss: 1.9483, label: 4, bag_size: 398
batch 800, loss: 0.4541, instance_loss: 0.1340, weighted_loss: 0.3581, label: 2, bag_size: 333
batch 900, loss: 1.7740, instance_loss: 0.2739, weighted_loss: 1.3240, label: 2, bag_size: 530
batch 1000, loss: 4.5873, instance_loss: 0.4271, weighted_loss: 3.3393, label: 10, bag_size: 174
batch 1100, loss: 1.7196, instance_loss: 0.3075, weighted_loss: 1.2959, label: 2, bag_size: 946
batch 1200, loss: 0.9663, instance_loss: 0.1227, weighted_loss: 0.7132, label: 5, bag_size: 466
batch 1300, loss: 0.0321, instance_loss: 0.0358, weighted_loss: 0.0332, label: 5, bag_size: 210
batch 1400, loss: 1.6761, instance_loss: 0.2479, weighted_loss: 1.2476, label: 5, bag_size: 325
batch 1500, loss: 0.6324, instance_loss: 0.2054, weighted_loss: 0.5043, label: 5, bag_size: 271
batch 1600, loss: 0.5006, instance_loss: 0.1021, weighted_loss: 0.3811, label: 5, bag_size: 653
batch 1700, loss: 1.1932, instance_loss: 0.2516, weighted_loss: 0.9107, label: 8, bag_size: 198
batch 1800, loss: 0.0946, instance_loss: 0.0545, weighted_loss: 0.0826, label: 5, bag_size: 724
batch 1900, loss: 0.0707, instance_loss: 0.0430, weighted_loss: 0.0624, label: 5, bag_size: 460
batch 2000, loss: 1.3828, instance_loss: 0.2432, weighted_loss: 1.0409, label: 2, bag_size: 592
batch 2100, loss: 0.4170, instance_loss: 0.1652, weighted_loss: 0.3415, label: 2, bag_size: 309

Instance Classifier Stats
class 0 clustering acc 0.997072685379137: correct 190401/190960
class 1 clustering acc 0.14890552995391704: correct 2585/17360

Epoch: 46, train_loss: 1.3598, train_clustering_loss: 0.2131, train_error: 0.4760
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.586073500967118, correct fine 303/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.25217391304347825, correct fine 29/115 
fine class 5: fine acc 0.9009546539379475, correct fine 755/838 
fine class 6: fine acc 0.1686746987951807, correct fine 42/249 
fine class 7: fine acc 0.02247191011235955, correct fine 2/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5240

Val Set, val_loss: 1.4237, val_error: 0.4848, auc: 0.7854
class 0 clustering acc 0.9979769283746557: correct 23185/23232 
class 1 clustering acc 0.14772727272727273: correct 312/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8653846153846154, correct fine 90/104 
fine class 6: fine acc 0.1, correct fine 3/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1556

Training for fine level...
batch 100, loss: 1.2052, instance_loss: 0.2374, weighted_loss: 0.9149, label: 6, bag_size: 239
batch 200, loss: 3.1309, instance_loss: 0.2863, weighted_loss: 2.2775, label: 3, bag_size: 167
batch 300, loss: 1.5436, instance_loss: 0.2428, weighted_loss: 1.1534, label: 5, bag_size: 1549
batch 400, loss: 1.0267, instance_loss: 0.2681, weighted_loss: 0.7992, label: 2, bag_size: 1691
batch 500, loss: 3.5818, instance_loss: 0.3318, weighted_loss: 2.6068, label: 4, bag_size: 1827
batch 600, loss: 2.3098, instance_loss: 0.2997, weighted_loss: 1.7068, label: 7, bag_size: 435
batch 700, loss: 1.6408, instance_loss: 0.3009, weighted_loss: 1.2389, label: 2, bag_size: 2112
batch 800, loss: 1.7638, instance_loss: 0.2767, weighted_loss: 1.3177, label: 4, bag_size: 786
batch 900, loss: 0.3031, instance_loss: 0.0868, weighted_loss: 0.2382, label: 5, bag_size: 459
batch 1000, loss: 0.1372, instance_loss: 0.0573, weighted_loss: 0.1132, label: 5, bag_size: 507
batch 1100, loss: 1.9757, instance_loss: 0.2446, weighted_loss: 1.4564, label: 5, bag_size: 109
batch 1200, loss: 0.6986, instance_loss: 0.1361, weighted_loss: 0.5299, label: 5, bag_size: 795
batch 1300, loss: 0.8652, instance_loss: 0.1549, weighted_loss: 0.6521, label: 5, bag_size: 644
batch 1400, loss: 0.6272, instance_loss: 0.1156, weighted_loss: 0.4737, label: 5, bag_size: 511
batch 1500, loss: 1.5828, instance_loss: 0.2701, weighted_loss: 1.1890, label: 2, bag_size: 534
batch 1600, loss: 4.5133, instance_loss: 0.4188, weighted_loss: 3.2850, label: 10, bag_size: 174
batch 1700, loss: 1.8255, instance_loss: 0.2879, weighted_loss: 1.3642, label: 2, bag_size: 127
batch 1800, loss: 2.1084, instance_loss: 0.2944, weighted_loss: 1.5642, label: 3, bag_size: 1678
batch 1900, loss: 2.1258, instance_loss: 0.2884, weighted_loss: 1.5746, label: 8, bag_size: 253
batch 2000, loss: 1.3031, instance_loss: 0.2434, weighted_loss: 0.9852, label: 5, bag_size: 233
batch 2100, loss: 2.0935, instance_loss: 0.2761, weighted_loss: 1.5482, label: 6, bag_size: 563

Instance Classifier Stats
class 0 clustering acc 0.9972036028487642: correct 190426/190960
class 1 clustering acc 0.14452764976958526: correct 2509/17360

Epoch: 47, train_loss: 1.3593, train_clustering_loss: 0.2135, train_error: 0.4783
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6054158607350096, correct fine 313/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.24347826086956523, correct fine 28/115 
fine class 5: fine acc 0.8854415274463007, correct fine 742/838 
fine class 6: fine acc 0.1646586345381526, correct fine 41/249 
fine class 7: fine acc 0.011235955056179775, correct fine 1/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5217

Val Set, val_loss: 1.4209, val_error: 0.4886, auc: 0.7855
class 0 clustering acc 0.9978047520661157: correct 23181/23232 
class 1 clustering acc 0.15293560606060605: correct 323/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1507

Training for fine level...
batch 100, loss: 0.1965, instance_loss: 0.0898, weighted_loss: 0.1645, label: 5, bag_size: 461
batch 200, loss: 2.4655, instance_loss: 0.3192, weighted_loss: 1.8216, label: 6, bag_size: 589
batch 300, loss: 1.3247, instance_loss: 0.2262, weighted_loss: 0.9951, label: 2, bag_size: 551
batch 400, loss: 4.1075, instance_loss: 0.4056, weighted_loss: 2.9969, label: 1, bag_size: 505
batch 500, loss: 1.9676, instance_loss: 0.2962, weighted_loss: 1.4662, label: 7, bag_size: 431
batch 600, loss: 0.3034, instance_loss: 0.1066, weighted_loss: 0.2444, label: 5, bag_size: 688
batch 700, loss: 0.2157, instance_loss: 0.0712, weighted_loss: 0.1724, label: 5, bag_size: 796
batch 800, loss: 4.0035, instance_loss: 0.4624, weighted_loss: 2.9411, label: 1, bag_size: 807
batch 900, loss: 2.3711, instance_loss: 0.2908, weighted_loss: 1.7470, label: 3, bag_size: 106
batch 1000, loss: 2.3058, instance_loss: 0.2646, weighted_loss: 1.6935, label: 8, bag_size: 110
batch 1100, loss: 0.8857, instance_loss: 0.1461, weighted_loss: 0.6638, label: 2, bag_size: 418
batch 1200, loss: 1.2911, instance_loss: 0.2384, weighted_loss: 0.9753, label: 2, bag_size: 501
batch 1300, loss: 0.6873, instance_loss: 0.1155, weighted_loss: 0.5157, label: 5, bag_size: 841
batch 1400, loss: 3.6145, instance_loss: 0.3401, weighted_loss: 2.6322, label: 8, bag_size: 328
batch 1500, loss: 1.1947, instance_loss: 0.2407, weighted_loss: 0.9085, label: 5, bag_size: 741
batch 1600, loss: 1.6170, instance_loss: 0.2970, weighted_loss: 1.2210, label: 3, bag_size: 3011
batch 1700, loss: 1.9981, instance_loss: 0.2930, weighted_loss: 1.4866, label: 6, bag_size: 299
batch 1800, loss: 1.0809, instance_loss: 0.1209, weighted_loss: 0.7929, label: 5, bag_size: 1555
batch 1900, loss: 0.4607, instance_loss: 0.2310, weighted_loss: 0.3918, label: 4, bag_size: 758
batch 2000, loss: 0.2456, instance_loss: 0.0672, weighted_loss: 0.1921, label: 5, bag_size: 714
batch 2100, loss: 0.3867, instance_loss: 0.0788, weighted_loss: 0.2943, label: 5, bag_size: 482

Instance Classifier Stats
class 0 clustering acc 0.9971250523669879: correct 190411/190960
class 1 clustering acc 0.1490783410138249: correct 2588/17360

Epoch: 48, train_loss: 1.3573, train_clustering_loss: 0.2133, train_error: 0.4760
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5802707930367504, correct fine 300/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2608695652173913, correct fine 30/115 
fine class 5: fine acc 0.9009546539379475, correct fine 755/838 
fine class 6: fine acc 0.17269076305220885, correct fine 43/249 
fine class 7: fine acc 0.02247191011235955, correct fine 2/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5240

Val Set, val_loss: 1.4203, val_error: 0.4886, auc: 0.7863
class 0 clustering acc 0.9978047520661157: correct 23181/23232 
class 1 clustering acc 0.15246212121212122: correct 322/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1505

Training for fine level...
batch 100, loss: 0.7067, instance_loss: 0.1535, weighted_loss: 0.5408, label: 2, bag_size: 936
batch 200, loss: 1.1136, instance_loss: 0.2588, weighted_loss: 0.8572, label: 6, bag_size: 481
batch 300, loss: 0.4938, instance_loss: 0.1364, weighted_loss: 0.3866, label: 2, bag_size: 357
batch 400, loss: 2.8508, instance_loss: 0.3313, weighted_loss: 2.0949, label: 8, bag_size: 542
batch 500, loss: 0.5168, instance_loss: 0.1446, weighted_loss: 0.4052, label: 2, bag_size: 207
batch 600, loss: 3.3294, instance_loss: 0.3605, weighted_loss: 2.4387, label: 7, bag_size: 704
batch 700, loss: 1.6043, instance_loss: 0.1961, weighted_loss: 1.1818, label: 5, bag_size: 548
batch 800, loss: 0.0758, instance_loss: 0.0397, weighted_loss: 0.0649, label: 5, bag_size: 705
batch 900, loss: 0.7573, instance_loss: 0.1815, weighted_loss: 0.5846, label: 2, bag_size: 1522
batch 1000, loss: 1.1556, instance_loss: 0.2693, weighted_loss: 0.8897, label: 6, bag_size: 843
batch 1100, loss: 0.6156, instance_loss: 0.1256, weighted_loss: 0.4686, label: 2, bag_size: 601
batch 1200, loss: 1.2797, instance_loss: 0.2750, weighted_loss: 0.9783, label: 4, bag_size: 217
batch 1300, loss: 2.7261, instance_loss: 0.3707, weighted_loss: 2.0195, label: 0, bag_size: 1736
batch 1400, loss: 0.6221, instance_loss: 0.1004, weighted_loss: 0.4656, label: 5, bag_size: 1020
batch 1500, loss: 1.6125, instance_loss: 0.2468, weighted_loss: 1.2028, label: 2, bag_size: 383
batch 1600, loss: 1.5854, instance_loss: 0.2648, weighted_loss: 1.1892, label: 8, bag_size: 151
batch 1700, loss: 2.7652, instance_loss: 0.2809, weighted_loss: 2.0199, label: 8, bag_size: 79
batch 1800, loss: 0.2380, instance_loss: 0.0707, weighted_loss: 0.1878, label: 5, bag_size: 252
batch 1900, loss: 1.7667, instance_loss: 0.2693, weighted_loss: 1.3175, label: 6, bag_size: 129
batch 2000, loss: 4.6798, instance_loss: 0.4545, weighted_loss: 3.4122, label: 10, bag_size: 372
batch 2100, loss: 1.8731, instance_loss: 0.3368, weighted_loss: 1.4122, label: 6, bag_size: 468

Instance Classifier Stats
class 0 clustering acc 0.9970465018852116: correct 190396/190960
class 1 clustering acc 0.14706221198156683: correct 2553/17360

Epoch: 49, train_loss: 1.3544, train_clustering_loss: 0.2132, train_error: 0.4770
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5899419729206963, correct fine 305/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.1606425702811245, correct fine 40/249 
fine class 7: fine acc 0.011235955056179775, correct fine 1/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5230

Val Set, val_loss: 1.4189, val_error: 0.4848, auc: 0.7868
class 0 clustering acc 0.9978047520661157: correct 23181/23232 
class 1 clustering acc 0.15293560606060605: correct 323/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1514

Training for fine level...
batch 100, loss: 0.1877, instance_loss: 0.0733, weighted_loss: 0.1533, label: 5, bag_size: 429
batch 200, loss: 0.3325, instance_loss: 0.0734, weighted_loss: 0.2548, label: 5, bag_size: 618
batch 300, loss: 0.6559, instance_loss: 0.1323, weighted_loss: 0.4988, label: 5, bag_size: 867
batch 400, loss: 0.1201, instance_loss: 0.0550, weighted_loss: 0.1006, label: 5, bag_size: 288
batch 500, loss: 1.1971, instance_loss: 0.2067, weighted_loss: 0.8999, label: 2, bag_size: 1124
batch 600, loss: 1.8787, instance_loss: 0.2710, weighted_loss: 1.3964, label: 6, bag_size: 1836
batch 700, loss: 1.5695, instance_loss: 0.2828, weighted_loss: 1.1835, label: 3, bag_size: 459
batch 800, loss: 0.4032, instance_loss: 0.1451, weighted_loss: 0.3258, label: 2, bag_size: 547
batch 900, loss: 0.7208, instance_loss: 0.1858, weighted_loss: 0.5603, label: 2, bag_size: 385
batch 1000, loss: 1.6529, instance_loss: 0.2846, weighted_loss: 1.2424, label: 3, bag_size: 1987
batch 1100, loss: 1.9543, instance_loss: 0.2828, weighted_loss: 1.4529, label: 6, bag_size: 299
batch 1200, loss: 1.6836, instance_loss: 0.2679, weighted_loss: 1.2589, label: 5, bag_size: 469
batch 1300, loss: 2.1923, instance_loss: 0.2971, weighted_loss: 1.6238, label: 6, bag_size: 200
batch 1400, loss: 0.4780, instance_loss: 0.1312, weighted_loss: 0.3740, label: 5, bag_size: 1222
batch 1500, loss: 1.5829, instance_loss: 0.3172, weighted_loss: 1.2032, label: 3, bag_size: 631
batch 1600, loss: 0.7866, instance_loss: 0.1625, weighted_loss: 0.5994, label: 5, bag_size: 363
batch 1700, loss: 0.7730, instance_loss: 0.1587, weighted_loss: 0.5887, label: 2, bag_size: 989
batch 1800, loss: 0.0565, instance_loss: 0.0418, weighted_loss: 0.0521, label: 5, bag_size: 554
batch 1900, loss: 0.2822, instance_loss: 0.0634, weighted_loss: 0.2166, label: 5, bag_size: 892
batch 2000, loss: 0.9513, instance_loss: 0.1923, weighted_loss: 0.7236, label: 5, bag_size: 344
batch 2100, loss: 1.5047, instance_loss: 0.1829, weighted_loss: 1.1082, label: 2, bag_size: 435

Instance Classifier Stats
class 0 clustering acc 0.9971145789694177: correct 190409/190960
class 1 clustering acc 0.1483294930875576: correct 2575/17360

Epoch: 50, train_loss: 1.3517, train_clustering_loss: 0.2129, train_error: 0.4770
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5841392649903289, correct fine 302/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.24347826086956523, correct fine 28/115 
fine class 5: fine acc 0.89618138424821, correct fine 751/838 
fine class 6: fine acc 0.18473895582329317, correct fine 46/249 
fine class 7: fine acc 0.02247191011235955, correct fine 2/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5230

Val Set, val_loss: 1.4185, val_error: 0.4848, auc: 0.7865
class 0 clustering acc 0.9977617079889807: correct 23180/23232 
class 1 clustering acc 0.15482954545454544: correct 327/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1513

Training for fine level...
batch 100, loss: 1.7971, instance_loss: 0.2989, weighted_loss: 1.3476, label: 3, bag_size: 837
batch 200, loss: 0.3645, instance_loss: 0.0912, weighted_loss: 0.2825, label: 5, bag_size: 604
batch 300, loss: 1.1257, instance_loss: 0.1464, weighted_loss: 0.8319, label: 5, bag_size: 1347
batch 400, loss: 0.9719, instance_loss: 0.1727, weighted_loss: 0.7321, label: 2, bag_size: 2612
batch 500, loss: 2.1455, instance_loss: 0.2509, weighted_loss: 1.5771, label: 6, bag_size: 337
batch 600, loss: 0.1610, instance_loss: 0.0683, weighted_loss: 0.1332, label: 5, bag_size: 599
batch 700, loss: 0.4415, instance_loss: 0.1132, weighted_loss: 0.3430, label: 2, bag_size: 2239
batch 800, loss: 1.6557, instance_loss: 0.2921, weighted_loss: 1.2466, label: 7, bag_size: 312
batch 900, loss: 0.3398, instance_loss: 0.0824, weighted_loss: 0.2626, label: 5, bag_size: 310
batch 1000, loss: 1.6837, instance_loss: 0.2942, weighted_loss: 1.2668, label: 6, bag_size: 206
batch 1100, loss: 1.1361, instance_loss: 0.2446, weighted_loss: 0.8686, label: 2, bag_size: 237
batch 1200, loss: 0.9155, instance_loss: 0.1855, weighted_loss: 0.6965, label: 2, bag_size: 252
batch 1300, loss: 2.5655, instance_loss: 0.3084, weighted_loss: 1.8884, label: 6, bag_size: 291
batch 1400, loss: 1.4386, instance_loss: 0.2341, weighted_loss: 1.0773, label: 2, bag_size: 611
batch 1500, loss: 1.3989, instance_loss: 0.1989, weighted_loss: 1.0389, label: 5, bag_size: 1863
batch 1600, loss: 0.1636, instance_loss: 0.0938, weighted_loss: 0.1426, label: 5, bag_size: 1246
batch 1700, loss: 0.8279, instance_loss: 0.1881, weighted_loss: 0.6360, label: 2, bag_size: 1269
batch 1800, loss: 0.2493, instance_loss: 0.1202, weighted_loss: 0.2106, label: 2, bag_size: 873
batch 1900, loss: 4.1992, instance_loss: 0.4134, weighted_loss: 3.0635, label: 1, bag_size: 1452
batch 2000, loss: 1.1262, instance_loss: 0.2971, weighted_loss: 0.8775, label: 2, bag_size: 1516
batch 2100, loss: 1.9608, instance_loss: 0.2709, weighted_loss: 1.4538, label: 5, bag_size: 294

Instance Classifier Stats
class 0 clustering acc 0.9969993715961458: correct 190387/190960
class 1 clustering acc 0.14930875576036867: correct 2592/17360

Epoch: 51, train_loss: 1.3482, train_clustering_loss: 0.2126, train_error: 0.4724
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6150870406189555, correct fine 318/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.25217391304347825, correct fine 29/115 
fine class 5: fine acc 0.8937947494033412, correct fine 749/838 
fine class 6: fine acc 0.1646586345381526, correct fine 41/249 
fine class 7: fine acc 0.02247191011235955, correct fine 2/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5276

Val Set, val_loss: 1.4166, val_error: 0.4811, auc: 0.7869
class 0 clustering acc 0.9976325757575758: correct 23177/23232 
class 1 clustering acc 0.15577651515151514: correct 329/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5189
Overall F1 Score: 0.1516

Training for fine level...
batch 100, loss: 3.2585, instance_loss: 0.3336, weighted_loss: 2.3811, label: 0, bag_size: 324
batch 200, loss: 0.3938, instance_loss: 0.1004, weighted_loss: 0.3058, label: 5, bag_size: 310
batch 300, loss: 0.9218, instance_loss: 0.1637, weighted_loss: 0.6944, label: 5, bag_size: 522
batch 400, loss: 1.0989, instance_loss: 0.2656, weighted_loss: 0.8489, label: 6, bag_size: 1122
batch 500, loss: 1.4836, instance_loss: 0.2134, weighted_loss: 1.1026, label: 5, bag_size: 338
batch 600, loss: 1.7349, instance_loss: 0.2981, weighted_loss: 1.3038, label: 6, bag_size: 686
batch 700, loss: 0.1193, instance_loss: 0.0565, weighted_loss: 0.1005, label: 5, bag_size: 437
batch 800, loss: 0.2140, instance_loss: 0.0661, weighted_loss: 0.1696, label: 5, bag_size: 1304
batch 900, loss: 0.5935, instance_loss: 0.2129, weighted_loss: 0.4793, label: 2, bag_size: 820
batch 1000, loss: 3.0119, instance_loss: 0.3351, weighted_loss: 2.2089, label: 3, bag_size: 175
batch 1100, loss: 0.4864, instance_loss: 0.1355, weighted_loss: 0.3811, label: 2, bag_size: 1803
batch 1200, loss: 1.6745, instance_loss: 0.2776, weighted_loss: 1.2554, label: 8, bag_size: 228
batch 1300, loss: 1.2628, instance_loss: 0.2467, weighted_loss: 0.9579, label: 2, bag_size: 365
batch 1400, loss: 0.3232, instance_loss: 0.1170, weighted_loss: 0.2614, label: 2, bag_size: 1359
batch 1500, loss: 1.7616, instance_loss: 0.2652, weighted_loss: 1.3127, label: 8, bag_size: 185
batch 1600, loss: 1.3559, instance_loss: 0.2626, weighted_loss: 1.0279, label: 2, bag_size: 976
batch 1700, loss: 0.3723, instance_loss: 0.1241, weighted_loss: 0.2978, label: 5, bag_size: 655
batch 1800, loss: 0.8628, instance_loss: 0.1687, weighted_loss: 0.6546, label: 2, bag_size: 365
batch 1900, loss: 1.8464, instance_loss: 0.2874, weighted_loss: 1.3787, label: 3, bag_size: 831
batch 2000, loss: 3.5315, instance_loss: 0.3183, weighted_loss: 2.5675, label: 3, bag_size: 709
batch 2100, loss: 0.1582, instance_loss: 0.0605, weighted_loss: 0.1289, label: 5, bag_size: 651

Instance Classifier Stats
class 0 clustering acc 0.997130289065773: correct 190412/190960
class 1 clustering acc 0.15115207373271888: correct 2624/17360

Epoch: 52, train_loss: 1.3477, train_clustering_loss: 0.2129, train_error: 0.4696
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.586073500967118, correct fine 303/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.9033412887828163, correct fine 757/838 
fine class 6: fine acc 0.20481927710843373, correct fine 51/249 
fine class 7: fine acc 0.02247191011235955, correct fine 2/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5304

Val Set, val_loss: 1.4160, val_error: 0.4848, auc: 0.7866
class 0 clustering acc 0.9977186639118457: correct 23179/23232 
class 1 clustering acc 0.1553030303030303: correct 328/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1514

Training for fine level...
batch 100, loss: 0.2683, instance_loss: 0.1023, weighted_loss: 0.2185, label: 5, bag_size: 309
batch 200, loss: 1.3167, instance_loss: 0.2180, weighted_loss: 0.9871, label: 2, bag_size: 102
batch 300, loss: 1.7629, instance_loss: 0.2232, weighted_loss: 1.3010, label: 2, bag_size: 364
batch 400, loss: 2.8524, instance_loss: 0.4118, weighted_loss: 2.1202, label: 2, bag_size: 360
batch 500, loss: 0.8271, instance_loss: 0.1436, weighted_loss: 0.6220, label: 5, bag_size: 223
batch 600, loss: 1.7498, instance_loss: 0.2445, weighted_loss: 1.2982, label: 2, bag_size: 517
batch 700, loss: 1.9944, instance_loss: 0.2698, weighted_loss: 1.4770, label: 2, bag_size: 1667
batch 800, loss: 0.4837, instance_loss: 0.1102, weighted_loss: 0.3716, label: 5, bag_size: 307
batch 900, loss: 1.9695, instance_loss: 0.2500, weighted_loss: 1.4536, label: 6, bag_size: 764
batch 1000, loss: 2.3228, instance_loss: 0.2692, weighted_loss: 1.7067, label: 6, bag_size: 290
batch 1100, loss: 1.3712, instance_loss: 0.2720, weighted_loss: 1.0415, label: 3, bag_size: 304
batch 1200, loss: 0.1044, instance_loss: 0.0559, weighted_loss: 0.0899, label: 5, bag_size: 1190
batch 1300, loss: 1.4022, instance_loss: 0.2397, weighted_loss: 1.0534, label: 2, bag_size: 551
batch 1400, loss: 0.4780, instance_loss: 0.1220, weighted_loss: 0.3712, label: 2, bag_size: 1875
batch 1500, loss: 0.9067, instance_loss: 0.1895, weighted_loss: 0.6915, label: 5, bag_size: 370
batch 1600, loss: 1.7922, instance_loss: 0.3070, weighted_loss: 1.3466, label: 2, bag_size: 823
batch 1700, loss: 2.5170, instance_loss: 0.3048, weighted_loss: 1.8533, label: 6, bag_size: 281
batch 1800, loss: 1.3166, instance_loss: 0.2539, weighted_loss: 0.9978, label: 6, bag_size: 367
batch 1900, loss: 0.1351, instance_loss: 0.0625, weighted_loss: 0.1133, label: 5, bag_size: 238
batch 2000, loss: 0.7737, instance_loss: 0.1441, weighted_loss: 0.5848, label: 5, bag_size: 635
batch 2100, loss: 3.1573, instance_loss: 0.3077, weighted_loss: 2.3024, label: 1, bag_size: 153

Instance Classifier Stats
class 0 clustering acc 0.9970465018852116: correct 190396/190960
class 1 clustering acc 0.15460829493087558: correct 2684/17360

Epoch: 53, train_loss: 1.3463, train_clustering_loss: 0.2120, train_error: 0.4747
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5764023210831721, correct fine 298/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.9033412887828163, correct fine 757/838 
fine class 6: fine acc 0.18072289156626506, correct fine 45/249 
fine class 7: fine acc 0.02247191011235955, correct fine 2/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5253

Val Set, val_loss: 1.4158, val_error: 0.4848, auc: 0.7876
class 0 clustering acc 0.9977186639118457: correct 23179/23232 
class 1 clustering acc 0.15482954545454544: correct 327/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1511

Training for fine level...
batch 100, loss: 1.1598, instance_loss: 0.1636, weighted_loss: 0.8610, label: 5, bag_size: 317
batch 200, loss: 2.3074, instance_loss: 0.2787, weighted_loss: 1.6988, label: 6, bag_size: 276
batch 300, loss: 0.0522, instance_loss: 0.0325, weighted_loss: 0.0463, label: 5, bag_size: 732
batch 400, loss: 1.6604, instance_loss: 0.2853, weighted_loss: 1.2479, label: 2, bag_size: 634
batch 500, loss: 1.3709, instance_loss: 0.2512, weighted_loss: 1.0349, label: 6, bag_size: 2046
batch 600, loss: 2.1568, instance_loss: 0.3694, weighted_loss: 1.6205, label: 2, bag_size: 764
batch 700, loss: 2.0467, instance_loss: 0.2584, weighted_loss: 1.5102, label: 7, bag_size: 209
batch 800, loss: 1.8099, instance_loss: 0.2603, weighted_loss: 1.3450, label: 8, bag_size: 210
batch 900, loss: 0.1249, instance_loss: 0.0415, weighted_loss: 0.0999, label: 5, bag_size: 821
batch 1000, loss: 2.2252, instance_loss: 0.2544, weighted_loss: 1.6339, label: 6, bag_size: 337
batch 1100, loss: 1.9053, instance_loss: 0.2681, weighted_loss: 1.4142, label: 6, bag_size: 276
batch 1200, loss: 1.2087, instance_loss: 0.2010, weighted_loss: 0.9064, label: 5, bag_size: 466
batch 1300, loss: 1.6334, instance_loss: 0.2737, weighted_loss: 1.2255, label: 8, bag_size: 619
batch 1400, loss: 0.4798, instance_loss: 0.1505, weighted_loss: 0.3810, label: 2, bag_size: 177
batch 1500, loss: 1.6736, instance_loss: 0.3032, weighted_loss: 1.2625, label: 3, bag_size: 831
batch 1600, loss: 0.9417, instance_loss: 0.2475, weighted_loss: 0.7335, label: 6, bag_size: 509
batch 1700, loss: 0.7484, instance_loss: 0.1827, weighted_loss: 0.5787, label: 2, bag_size: 265
batch 1800, loss: 1.8853, instance_loss: 0.2363, weighted_loss: 1.3906, label: 2, bag_size: 119
batch 1900, loss: 1.2502, instance_loss: 0.3076, weighted_loss: 0.9674, label: 6, bag_size: 244
batch 2000, loss: 1.2261, instance_loss: 0.2360, weighted_loss: 0.9290, label: 2, bag_size: 473
batch 2100, loss: 1.5989, instance_loss: 0.3126, weighted_loss: 1.2130, label: 6, bag_size: 739

Instance Classifier Stats
class 0 clustering acc 0.9969836614997906: correct 190384/190960
class 1 clustering acc 0.1538594470046083: correct 2671/17360

Epoch: 54, train_loss: 1.3432, train_clustering_loss: 0.2122, train_error: 0.4682
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.9009546539379475, correct fine 755/838 
fine class 6: fine acc 0.1927710843373494, correct fine 48/249 
fine class 7: fine acc 0.02247191011235955, correct fine 2/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5318

Val Set, val_loss: 1.4144, val_error: 0.4848, auc: 0.7877
class 0 clustering acc 0.9976756198347108: correct 23178/23232 
class 1 clustering acc 0.1553030303030303: correct 328/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1512

Training for fine level...
batch 100, loss: 2.0919, instance_loss: 0.3378, weighted_loss: 1.5657, label: 8, bag_size: 720
batch 200, loss: 1.1466, instance_loss: 0.2248, weighted_loss: 0.8701, label: 5, bag_size: 182
batch 300, loss: 0.6421, instance_loss: 0.1393, weighted_loss: 0.4912, label: 2, bag_size: 2037
batch 400, loss: 0.0944, instance_loss: 0.0443, weighted_loss: 0.0793, label: 5, bag_size: 632
batch 500, loss: 0.6642, instance_loss: 0.1778, weighted_loss: 0.5183, label: 5, bag_size: 296
batch 600, loss: 1.1561, instance_loss: 0.2628, weighted_loss: 0.8881, label: 6, bag_size: 117
batch 700, loss: 1.4468, instance_loss: 0.2339, weighted_loss: 1.0829, label: 5, bag_size: 220
batch 800, loss: 2.2622, instance_loss: 0.3182, weighted_loss: 1.6790, label: 7, bag_size: 748
batch 900, loss: 2.0384, instance_loss: 0.2504, weighted_loss: 1.5020, label: 6, bag_size: 219
batch 1000, loss: 1.3558, instance_loss: 0.2570, weighted_loss: 1.0262, label: 6, bag_size: 404
batch 1100, loss: 2.0442, instance_loss: 0.2908, weighted_loss: 1.5182, label: 6, bag_size: 344
batch 1200, loss: 0.9507, instance_loss: 0.2274, weighted_loss: 0.7337, label: 6, bag_size: 526
batch 1300, loss: 0.3241, instance_loss: 0.1277, weighted_loss: 0.2652, label: 5, bag_size: 815
batch 1400, loss: 1.1903, instance_loss: 0.1949, weighted_loss: 0.8917, label: 2, bag_size: 430
batch 1500, loss: 1.5085, instance_loss: 0.2201, weighted_loss: 1.1220, label: 5, bag_size: 190
batch 1600, loss: 0.3253, instance_loss: 0.1264, weighted_loss: 0.2656, label: 2, bag_size: 1353
batch 1700, loss: 0.0617, instance_loss: 0.0375, weighted_loss: 0.0544, label: 5, bag_size: 1301
batch 1800, loss: 3.2738, instance_loss: 0.3477, weighted_loss: 2.3960, label: 7, bag_size: 945
batch 1900, loss: 3.2580, instance_loss: 0.3842, weighted_loss: 2.3959, label: 4, bag_size: 1061
batch 2000, loss: 1.7755, instance_loss: 0.2943, weighted_loss: 1.3311, label: 2, bag_size: 823
batch 2100, loss: 1.2304, instance_loss: 0.2677, weighted_loss: 0.9416, label: 6, bag_size: 488

Instance Classifier Stats
class 0 clustering acc 0.9970255550900712: correct 190392/190960
class 1 clustering acc 0.15455069124423962: correct 2683/17360

Epoch: 55, train_loss: 1.3412, train_clustering_loss: 0.2114, train_error: 0.4714
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5899419729206963, correct fine 305/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.18875502008032127, correct fine 47/249 
fine class 7: fine acc 0.033707865168539325, correct fine 3/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5286

Val Set, val_loss: 1.4141, val_error: 0.4848, auc: 0.7880
class 0 clustering acc 0.9976756198347108: correct 23178/23232 
class 1 clustering acc 0.15482954545454544: correct 327/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1512

Training for fine level...
batch 100, loss: 1.6518, instance_loss: 0.2269, weighted_loss: 1.2243, label: 2, bag_size: 389
batch 200, loss: 0.6423, instance_loss: 0.1341, weighted_loss: 0.4899, label: 5, bag_size: 534
batch 300, loss: 1.5602, instance_loss: 0.3239, weighted_loss: 1.1893, label: 3, bag_size: 631
batch 400, loss: 0.7020, instance_loss: 0.1463, weighted_loss: 0.5353, label: 2, bag_size: 392
batch 500, loss: 1.8421, instance_loss: 0.2971, weighted_loss: 1.3786, label: 6, bag_size: 669
batch 600, loss: 0.5210, instance_loss: 0.1365, weighted_loss: 0.4056, label: 2, bag_size: 981
batch 700, loss: 1.0326, instance_loss: 0.1309, weighted_loss: 0.7621, label: 5, bag_size: 658
batch 800, loss: 0.7017, instance_loss: 0.1572, weighted_loss: 0.5384, label: 5, bag_size: 847
batch 900, loss: 2.0430, instance_loss: 0.2826, weighted_loss: 1.5149, label: 8, bag_size: 212
batch 1000, loss: 2.2427, instance_loss: 0.3089, weighted_loss: 1.6625, label: 6, bag_size: 313
batch 1100, loss: 2.1973, instance_loss: 0.2704, weighted_loss: 1.6192, label: 6, bag_size: 744
batch 1200, loss: 0.8881, instance_loss: 0.1273, weighted_loss: 0.6599, label: 5, bag_size: 714
batch 1300, loss: 0.3054, instance_loss: 0.1052, weighted_loss: 0.2454, label: 5, bag_size: 390
batch 1400, loss: 1.0720, instance_loss: 0.2303, weighted_loss: 0.8195, label: 2, bag_size: 1616
batch 1500, loss: 0.1129, instance_loss: 0.0553, weighted_loss: 0.0957, label: 5, bag_size: 456
batch 1600, loss: 0.4183, instance_loss: 0.1269, weighted_loss: 0.3308, label: 2, bag_size: 1099
batch 1700, loss: 0.7517, instance_loss: 0.1723, weighted_loss: 0.5779, label: 5, bag_size: 245
batch 1800, loss: 0.6943, instance_loss: 0.1218, weighted_loss: 0.5225, label: 2, bag_size: 989
batch 1900, loss: 1.2915, instance_loss: 0.2058, weighted_loss: 0.9658, label: 5, bag_size: 214
batch 2000, loss: 1.0393, instance_loss: 0.1938, weighted_loss: 0.7856, label: 5, bag_size: 1246
batch 2100, loss: 2.8739, instance_loss: 0.3555, weighted_loss: 2.1184, label: 1, bag_size: 461

Instance Classifier Stats
class 0 clustering acc 0.9968003770423125: correct 190349/190960
class 1 clustering acc 0.15305299539170508: correct 2657/17360

Epoch: 56, train_loss: 1.3380, train_clustering_loss: 0.2113, train_error: 0.4700
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5880077369439072, correct fine 304/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.9045346062052506, correct fine 758/838 
fine class 6: fine acc 0.1927710843373494, correct fine 48/249 
fine class 7: fine acc 0.033707865168539325, correct fine 3/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5300

Val Set, val_loss: 1.4132, val_error: 0.4848, auc: 0.7882
class 0 clustering acc 0.9976325757575758: correct 23177/23232 
class 1 clustering acc 0.15577651515151514: correct 329/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1512

Training for fine level...
batch 100, loss: 1.0458, instance_loss: 0.3185, weighted_loss: 0.8277, label: 6, bag_size: 402
batch 200, loss: 0.0547, instance_loss: 0.0354, weighted_loss: 0.0489, label: 5, bag_size: 300
batch 300, loss: 2.0967, instance_loss: 0.3307, weighted_loss: 1.5669, label: 2, bag_size: 302
batch 400, loss: 0.9201, instance_loss: 0.2034, weighted_loss: 0.7051, label: 2, bag_size: 356
batch 500, loss: 1.9994, instance_loss: 0.2660, weighted_loss: 1.4794, label: 8, bag_size: 259
batch 600, loss: 1.6126, instance_loss: 0.2870, weighted_loss: 1.2149, label: 6, bag_size: 689
batch 700, loss: 0.7835, instance_loss: 0.1970, weighted_loss: 0.6076, label: 5, bag_size: 12
batch 800, loss: 0.1537, instance_loss: 0.0470, weighted_loss: 0.1217, label: 5, bag_size: 622
batch 900, loss: 1.6717, instance_loss: 0.2536, weighted_loss: 1.2463, label: 2, bag_size: 228
batch 1000, loss: 0.5731, instance_loss: 0.1380, weighted_loss: 0.4426, label: 2, bag_size: 1981
batch 1100, loss: 1.2176, instance_loss: 0.2228, weighted_loss: 0.9191, label: 5, bag_size: 968
batch 1200, loss: 0.1238, instance_loss: 0.0508, weighted_loss: 0.1019, label: 5, bag_size: 707
batch 1300, loss: 0.1209, instance_loss: 0.0442, weighted_loss: 0.0979, label: 5, bag_size: 1301
batch 1400, loss: 0.1841, instance_loss: 0.0689, weighted_loss: 0.1495, label: 5, bag_size: 1547
batch 1500, loss: 0.5646, instance_loss: 0.1531, weighted_loss: 0.4411, label: 2, bag_size: 1211
batch 1600, loss: 2.6700, instance_loss: 0.3192, weighted_loss: 1.9647, label: 8, bag_size: 338
batch 1700, loss: 3.1703, instance_loss: 0.3330, weighted_loss: 2.3191, label: 1, bag_size: 474
batch 1800, loss: 2.8321, instance_loss: 0.2881, weighted_loss: 2.0689, label: 4, bag_size: 691
batch 1900, loss: 1.7830, instance_loss: 0.2832, weighted_loss: 1.3330, label: 7, bag_size: 628
batch 2000, loss: 2.3298, instance_loss: 0.3039, weighted_loss: 1.7221, label: 6, bag_size: 476
batch 2100, loss: 0.0509, instance_loss: 0.0465, weighted_loss: 0.0496, label: 5, bag_size: 629

Instance Classifier Stats
class 0 clustering acc 0.9969731881022204: correct 190382/190960
class 1 clustering acc 0.1565668202764977: correct 2718/17360

Epoch: 57, train_loss: 1.3361, train_clustering_loss: 0.2110, train_error: 0.4756
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.586073500967118, correct fine 303/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2608695652173913, correct fine 30/115 
fine class 5: fine acc 0.8937947494033412, correct fine 749/838 
fine class 6: fine acc 0.1927710843373494, correct fine 48/249 
fine class 7: fine acc 0.033707865168539325, correct fine 3/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5244

Val Set, val_loss: 1.4124, val_error: 0.4811, auc: 0.7886
class 0 clustering acc 0.9975895316804407: correct 23176/23232 
class 1 clustering acc 0.15861742424242425: correct 335/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5189
Overall F1 Score: 0.1519

Training for fine level...
batch 100, loss: 1.3846, instance_loss: 0.2539, weighted_loss: 1.0454, label: 5, bag_size: 132
batch 200, loss: 1.0692, instance_loss: 0.2564, weighted_loss: 0.8253, label: 4, bag_size: 2080
batch 300, loss: 0.0563, instance_loss: 0.0696, weighted_loss: 0.0603, label: 5, bag_size: 83
batch 400, loss: 1.5003, instance_loss: 0.2366, weighted_loss: 1.1212, label: 5, bag_size: 853
batch 500, loss: 1.6033, instance_loss: 0.2810, weighted_loss: 1.2066, label: 2, bag_size: 411
batch 600, loss: 0.0455, instance_loss: 0.0328, weighted_loss: 0.0417, label: 5, bag_size: 349
batch 700, loss: 0.5847, instance_loss: 0.1357, weighted_loss: 0.4500, label: 2, bag_size: 2818
batch 800, loss: 3.5640, instance_loss: 0.3165, weighted_loss: 2.5898, label: 3, bag_size: 233
batch 900, loss: 0.2267, instance_loss: 0.0990, weighted_loss: 0.1884, label: 5, bag_size: 309
batch 1000, loss: 1.6979, instance_loss: 0.2133, weighted_loss: 1.2525, label: 5, bag_size: 404
batch 1100, loss: 0.4240, instance_loss: 0.1511, weighted_loss: 0.3421, label: 2, bag_size: 1404
batch 1200, loss: 1.9402, instance_loss: 0.3305, weighted_loss: 1.4573, label: 6, bag_size: 656
batch 1300, loss: 1.9267, instance_loss: 0.2905, weighted_loss: 1.4358, label: 3, bag_size: 410
batch 1400, loss: 3.3253, instance_loss: 0.3378, weighted_loss: 2.4291, label: 4, bag_size: 287
batch 1500, loss: 1.1797, instance_loss: 0.2012, weighted_loss: 0.8861, label: 5, bag_size: 174
batch 1600, loss: 1.2501, instance_loss: 0.2787, weighted_loss: 0.9587, label: 6, bag_size: 488
batch 1700, loss: 0.0831, instance_loss: 0.0562, weighted_loss: 0.0750, label: 5, bag_size: 295
batch 1800, loss: 0.5865, instance_loss: 0.1575, weighted_loss: 0.4578, label: 2, bag_size: 1427
batch 1900, loss: 2.8764, instance_loss: 0.3322, weighted_loss: 2.1131, label: 8, bag_size: 542
batch 2000, loss: 0.5947, instance_loss: 0.1360, weighted_loss: 0.4571, label: 5, bag_size: 1020
batch 2100, loss: 2.3627, instance_loss: 0.2679, weighted_loss: 1.7343, label: 4, bag_size: 223

Instance Classifier Stats
class 0 clustering acc 0.9968684541265186: correct 190362/190960
class 1 clustering acc 0.15599078341013825: correct 2708/17360

Epoch: 58, train_loss: 1.3351, train_clustering_loss: 0.2113, train_error: 0.4728
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5880077369439072, correct fine 304/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.28695652173913044, correct fine 33/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.17670682730923695, correct fine 44/249 
fine class 7: fine acc 0.033707865168539325, correct fine 3/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5272

Val Set, val_loss: 1.4116, val_error: 0.4773, auc: 0.7888
class 0 clustering acc 0.9975895316804407: correct 23176/23232 
class 1 clustering acc 0.15767045454545456: correct 333/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.13333333333333333, correct fine 4/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1609

Training for fine level...
batch 100, loss: 1.2013, instance_loss: 0.2023, weighted_loss: 0.9016, label: 5, bag_size: 106
batch 200, loss: 1.7142, instance_loss: 0.2709, weighted_loss: 1.2813, label: 2, bag_size: 823
batch 300, loss: 0.0442, instance_loss: 0.0433, weighted_loss: 0.0440, label: 5, bag_size: 357
batch 400, loss: 0.6366, instance_loss: 0.1650, weighted_loss: 0.4951, label: 5, bag_size: 194
batch 500, loss: 2.3144, instance_loss: 0.2995, weighted_loss: 1.7099, label: 2, bag_size: 317
batch 600, loss: 1.7526, instance_loss: 0.3037, weighted_loss: 1.3179, label: 6, bag_size: 396
batch 700, loss: 4.0289, instance_loss: 0.3830, weighted_loss: 2.9351, label: 1, bag_size: 505
batch 800, loss: 1.5818, instance_loss: 0.2486, weighted_loss: 1.1819, label: 8, bag_size: 384
batch 900, loss: 2.9497, instance_loss: 0.3038, weighted_loss: 2.1559, label: 4, bag_size: 552
batch 1000, loss: 3.5134, instance_loss: 0.3717, weighted_loss: 2.5709, label: 10, bag_size: 472
batch 1100, loss: 0.4950, instance_loss: 0.0938, weighted_loss: 0.3746, label: 2, bag_size: 2239
batch 1200, loss: 0.2978, instance_loss: 0.0871, weighted_loss: 0.2346, label: 5, bag_size: 273
batch 1300, loss: 0.4116, instance_loss: 0.1427, weighted_loss: 0.3309, label: 2, bag_size: 334
batch 1400, loss: 1.8773, instance_loss: 0.3040, weighted_loss: 1.4053, label: 7, bag_size: 590
batch 1500, loss: 3.5875, instance_loss: 0.3997, weighted_loss: 2.6312, label: 7, bag_size: 549
batch 1600, loss: 0.7606, instance_loss: 0.1874, weighted_loss: 0.5886, label: 2, bag_size: 729
batch 1700, loss: 0.7980, instance_loss: 0.1917, weighted_loss: 0.6161, label: 5, bag_size: 129
batch 1800, loss: 0.0831, instance_loss: 0.0573, weighted_loss: 0.0753, label: 5, bag_size: 198
batch 1900, loss: 0.0589, instance_loss: 0.0582, weighted_loss: 0.0587, label: 5, bag_size: 724
batch 2000, loss: 2.4016, instance_loss: 0.2860, weighted_loss: 1.7670, label: 6, bag_size: 802
batch 2100, loss: 0.1908, instance_loss: 0.0692, weighted_loss: 0.1543, label: 5, bag_size: 511

Instance Classifier Stats
class 0 clustering acc 0.9968789275240888: correct 190364/190960
class 1 clustering acc 0.15754608294930875: correct 2735/17360

Epoch: 59, train_loss: 1.3331, train_clustering_loss: 0.2110, train_error: 0.4677
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5841392649903289, correct fine 302/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2956521739130435, correct fine 34/115 
fine class 5: fine acc 0.8997613365155132, correct fine 754/838 
fine class 6: fine acc 0.22088353413654618, correct fine 55/249 
fine class 7: fine acc 0.033707865168539325, correct fine 3/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5323

Val Set, val_loss: 1.4119, val_error: 0.4886, auc: 0.7881
class 0 clustering acc 0.9975895316804407: correct 23176/23232 
class 1 clustering acc 0.15625: correct 330/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1503

Training for fine level...
batch 100, loss: 0.8052, instance_loss: 0.1612, weighted_loss: 0.6120, label: 5, bag_size: 1564
batch 200, loss: 0.2717, instance_loss: 0.1172, weighted_loss: 0.2253, label: 2, bag_size: 994
batch 300, loss: 1.2239, instance_loss: 0.2758, weighted_loss: 0.9395, label: 4, bag_size: 1279
batch 400, loss: 0.8855, instance_loss: 0.1569, weighted_loss: 0.6669, label: 5, bag_size: 448
batch 500, loss: 0.1045, instance_loss: 0.0492, weighted_loss: 0.0879, label: 5, bag_size: 1005
batch 600, loss: 3.1583, instance_loss: 0.3085, weighted_loss: 2.3033, label: 3, bag_size: 167
batch 700, loss: 1.3455, instance_loss: 0.2499, weighted_loss: 1.0168, label: 5, bag_size: 1462
batch 800, loss: 2.9032, instance_loss: 0.3188, weighted_loss: 2.1279, label: 3, bag_size: 248
batch 900, loss: 0.8282, instance_loss: 0.1660, weighted_loss: 0.6295, label: 5, bag_size: 337
batch 1000, loss: 1.3800, instance_loss: 0.2868, weighted_loss: 1.0521, label: 3, bag_size: 1172
batch 1100, loss: 0.7122, instance_loss: 0.1607, weighted_loss: 0.5467, label: 2, bag_size: 1628
batch 1200, loss: 1.2289, instance_loss: 0.2169, weighted_loss: 0.9253, label: 5, bag_size: 214
batch 1300, loss: 2.8046, instance_loss: 0.3213, weighted_loss: 2.0596, label: 7, bag_size: 528
batch 1400, loss: 1.7775, instance_loss: 0.3048, weighted_loss: 1.3357, label: 3, bag_size: 570
batch 1500, loss: 1.4772, instance_loss: 0.2195, weighted_loss: 1.0999, label: 5, bag_size: 248
batch 1600, loss: 2.4669, instance_loss: 0.3691, weighted_loss: 1.8376, label: 8, bag_size: 751
batch 1700, loss: 0.1099, instance_loss: 0.0602, weighted_loss: 0.0950, label: 5, bag_size: 381
batch 1800, loss: 1.9002, instance_loss: 0.2675, weighted_loss: 1.4104, label: 3, bag_size: 1336
batch 1900, loss: 1.4404, instance_loss: 0.2801, weighted_loss: 1.0923, label: 3, bag_size: 2005
batch 2000, loss: 0.3133, instance_loss: 0.0973, weighted_loss: 0.2485, label: 5, bag_size: 265
batch 2100, loss: 2.4540, instance_loss: 0.3571, weighted_loss: 1.8250, label: 0, bag_size: 37

Instance Classifier Stats
class 0 clustering acc 0.996889400921659: correct 190366/190960
class 1 clustering acc 0.15846774193548388: correct 2751/17360

Epoch: 60, train_loss: 1.3310, train_clustering_loss: 0.2107, train_error: 0.4724
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5918762088974855, correct fine 306/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.8997613365155132, correct fine 754/838 
fine class 6: fine acc 0.17269076305220885, correct fine 43/249 
fine class 7: fine acc 0.0449438202247191, correct fine 4/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5276

Val Set, val_loss: 1.4106, val_error: 0.4735, auc: 0.7885
class 0 clustering acc 0.9976756198347108: correct 23178/23232 
class 1 clustering acc 0.1590909090909091: correct 336/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1650

Training for fine level...
batch 100, loss: 0.4731, instance_loss: 0.1154, weighted_loss: 0.3657, label: 5, bag_size: 576
batch 200, loss: 0.6543, instance_loss: 0.1598, weighted_loss: 0.5059, label: 2, bag_size: 600
batch 300, loss: 1.5035, instance_loss: 0.3035, weighted_loss: 1.1435, label: 3, bag_size: 807
batch 400, loss: 1.7745, instance_loss: 0.2294, weighted_loss: 1.3110, label: 5, bag_size: 348
batch 500, loss: 0.3426, instance_loss: 0.1141, weighted_loss: 0.2741, label: 5, bag_size: 444
batch 600, loss: 0.8293, instance_loss: 0.2075, weighted_loss: 0.6428, label: 2, bag_size: 356
batch 700, loss: 3.0135, instance_loss: 0.3019, weighted_loss: 2.2000, label: 3, bag_size: 401
batch 800, loss: 1.9318, instance_loss: 0.2313, weighted_loss: 1.4217, label: 5, bag_size: 984
batch 900, loss: 1.6244, instance_loss: 0.2817, weighted_loss: 1.2216, label: 6, bag_size: 434
batch 1000, loss: 1.3193, instance_loss: 0.2239, weighted_loss: 0.9907, label: 5, bag_size: 458
batch 1100, loss: 1.3641, instance_loss: 0.2422, weighted_loss: 1.0276, label: 6, bag_size: 527
batch 1200, loss: 1.8932, instance_loss: 0.2857, weighted_loss: 1.4110, label: 3, bag_size: 427
batch 1300, loss: 2.8513, instance_loss: 0.4060, weighted_loss: 2.1177, label: 7, bag_size: 388
batch 1400, loss: 0.2841, instance_loss: 0.0864, weighted_loss: 0.2248, label: 5, bag_size: 273
batch 1500, loss: 0.6606, instance_loss: 0.1204, weighted_loss: 0.4986, label: 2, bag_size: 2601
batch 1600, loss: 1.4484, instance_loss: 0.2124, weighted_loss: 1.0776, label: 2, bag_size: 1214
batch 1700, loss: 0.5122, instance_loss: 0.2153, weighted_loss: 0.4231, label: 4, bag_size: 650
batch 1800, loss: 0.4557, instance_loss: 0.1445, weighted_loss: 0.3624, label: 2, bag_size: 2186
batch 1900, loss: 0.8974, instance_loss: 0.2571, weighted_loss: 0.7053, label: 4, bag_size: 1424
batch 2000, loss: 0.8226, instance_loss: 0.1891, weighted_loss: 0.6325, label: 5, bag_size: 1678
batch 2100, loss: 0.8680, instance_loss: 0.2212, weighted_loss: 0.6740, label: 2, bag_size: 328

Instance Classifier Stats
class 0 clustering acc 0.9970517385839966: correct 190397/190960
class 1 clustering acc 0.15599078341013825: correct 2708/17360

Epoch: 61, train_loss: 1.3289, train_clustering_loss: 0.2105, train_error: 0.4710
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5822050290135397, correct fine 301/517 
fine class 3: fine acc 0.006666666666666667, correct fine 1/150 
fine class 4: fine acc 0.2608695652173913, correct fine 30/115 
fine class 5: fine acc 0.9021479713603818, correct fine 756/838 
fine class 6: fine acc 0.20080321285140562, correct fine 50/249 
fine class 7: fine acc 0.0449438202247191, correct fine 4/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5290

Val Set, val_loss: 1.4099, val_error: 0.4697, auc: 0.7886
class 0 clustering acc 0.9976756198347108: correct 23178/23232 
class 1 clustering acc 0.16051136363636365: correct 339/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5303
Overall F1 Score: 0.1661

Training for fine level...
batch 100, loss: 4.2291, instance_loss: 0.4206, weighted_loss: 3.0865, label: 7, bag_size: 2158
batch 200, loss: 0.2591, instance_loss: 0.0769, weighted_loss: 0.2044, label: 5, bag_size: 688
batch 300, loss: 2.6848, instance_loss: 0.3422, weighted_loss: 1.9820, label: 1, bag_size: 67
batch 400, loss: 0.9867, instance_loss: 0.3312, weighted_loss: 0.7901, label: 6, bag_size: 1072
batch 500, loss: 1.2273, instance_loss: 0.2114, weighted_loss: 0.9225, label: 2, bag_size: 488
batch 600, loss: 0.8642, instance_loss: 0.1702, weighted_loss: 0.6560, label: 5, bag_size: 280
batch 700, loss: 0.6085, instance_loss: 0.1134, weighted_loss: 0.4600, label: 5, bag_size: 291
batch 800, loss: 0.9692, instance_loss: 0.1705, weighted_loss: 0.7296, label: 2, bag_size: 343
batch 900, loss: 2.9480, instance_loss: 0.3529, weighted_loss: 2.1695, label: 1, bag_size: 220
batch 1000, loss: 1.3574, instance_loss: 0.2508, weighted_loss: 1.0254, label: 8, bag_size: 216
batch 1100, loss: 2.4483, instance_loss: 0.2793, weighted_loss: 1.7976, label: 8, bag_size: 356
batch 1200, loss: 0.1114, instance_loss: 0.0509, weighted_loss: 0.0932, label: 5, bag_size: 658
batch 1300, loss: 0.6039, instance_loss: 0.1392, weighted_loss: 0.4645, label: 2, bag_size: 1245
batch 1400, loss: 0.5702, instance_loss: 0.1258, weighted_loss: 0.4369, label: 2, bag_size: 1427
batch 1500, loss: 0.0824, instance_loss: 0.0543, weighted_loss: 0.0740, label: 5, bag_size: 295
batch 1600, loss: 1.5278, instance_loss: 0.2676, weighted_loss: 1.1497, label: 8, bag_size: 229
batch 1700, loss: 2.2205, instance_loss: 0.2713, weighted_loss: 1.6357, label: 6, bag_size: 1271
batch 1800, loss: 0.8653, instance_loss: 0.1549, weighted_loss: 0.6522, label: 5, bag_size: 649
batch 1900, loss: 2.1075, instance_loss: 0.2731, weighted_loss: 1.5571, label: 6, bag_size: 389
batch 2000, loss: 0.7893, instance_loss: 0.1790, weighted_loss: 0.6062, label: 5, bag_size: 360
batch 2100, loss: 2.3951, instance_loss: 0.2993, weighted_loss: 1.7663, label: 3, bag_size: 510

Instance Classifier Stats
class 0 clustering acc 0.9968422706325932: correct 190357/190960
class 1 clustering acc 0.15789170506912442: correct 2741/17360

Epoch: 62, train_loss: 1.3282, train_clustering_loss: 0.2106, train_error: 0.4659
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5918762088974855, correct fine 306/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.21686746987951808, correct fine 54/249 
fine class 7: fine acc 0.06741573033707865, correct fine 6/89 
fine class 8: fine acc 0.06818181818181818, correct fine 9/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5341

Val Set, val_loss: 1.4100, val_error: 0.4848, auc: 0.7883
class 0 clustering acc 0.9976756198347108: correct 23178/23232 
class 1 clustering acc 0.16335227272727273: correct 345/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1513

Training for fine level...
batch 100, loss: 0.1212, instance_loss: 0.0752, weighted_loss: 0.1074, label: 5, bag_size: 381
batch 200, loss: 0.4924, instance_loss: 0.1673, weighted_loss: 0.3948, label: 2, bag_size: 673
batch 300, loss: 0.0803, instance_loss: 0.0616, weighted_loss: 0.0747, label: 5, bag_size: 743
batch 400, loss: 0.1299, instance_loss: 0.0644, weighted_loss: 0.1102, label: 5, bag_size: 387
batch 500, loss: 1.5079, instance_loss: 0.2789, weighted_loss: 1.1392, label: 3, bag_size: 945
batch 600, loss: 2.6728, instance_loss: 0.3747, weighted_loss: 1.9834, label: 2, bag_size: 559
batch 700, loss: 0.4595, instance_loss: 0.1219, weighted_loss: 0.3582, label: 2, bag_size: 1973
batch 800, loss: 2.5869, instance_loss: 0.3133, weighted_loss: 1.9048, label: 4, bag_size: 304
batch 900, loss: 0.3734, instance_loss: 0.1135, weighted_loss: 0.2954, label: 5, bag_size: 1062
batch 1000, loss: 1.0308, instance_loss: 0.2758, weighted_loss: 0.8043, label: 2, bag_size: 1516
batch 1100, loss: 0.5933, instance_loss: 0.1381, weighted_loss: 0.4568, label: 2, bag_size: 848
batch 1200, loss: 1.6703, instance_loss: 0.2171, weighted_loss: 1.2344, label: 5, bag_size: 548
batch 1300, loss: 0.3688, instance_loss: 0.2650, weighted_loss: 0.3376, label: 4, bag_size: 160
batch 1400, loss: 0.1576, instance_loss: 0.0693, weighted_loss: 0.1311, label: 5, bag_size: 656
batch 1500, loss: 1.2521, instance_loss: 0.2370, weighted_loss: 0.9476, label: 5, bag_size: 552
batch 1600, loss: 0.5928, instance_loss: 0.1583, weighted_loss: 0.4624, label: 2, bag_size: 398
batch 1700, loss: 0.4159, instance_loss: 0.1014, weighted_loss: 0.3215, label: 5, bag_size: 328
batch 1800, loss: 1.2945, instance_loss: 0.2222, weighted_loss: 0.9728, label: 2, bag_size: 102
batch 1900, loss: 0.9808, instance_loss: 0.1942, weighted_loss: 0.7448, label: 5, bag_size: 368
batch 2000, loss: 1.3627, instance_loss: 0.2795, weighted_loss: 1.0377, label: 6, bag_size: 858
batch 2100, loss: 0.6039, instance_loss: 0.1112, weighted_loss: 0.4561, label: 5, bag_size: 358

Instance Classifier Stats
class 0 clustering acc 0.9969470046082949: correct 190377/190960
class 1 clustering acc 0.15898617511520738: correct 2760/17360

Epoch: 63, train_loss: 1.3255, train_clustering_loss: 0.2100, train_error: 0.4645
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5918762088974855, correct fine 306/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.28695652173913044, correct fine 33/115 
fine class 5: fine acc 0.905727923627685, correct fine 759/838 
fine class 6: fine acc 0.21285140562248997, correct fine 53/249 
fine class 7: fine acc 0.0449438202247191, correct fine 4/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5355

Val Set, val_loss: 1.4095, val_error: 0.4811, auc: 0.7882
class 0 clustering acc 0.9975895316804407: correct 23176/23232 
class 1 clustering acc 0.16477272727272727: correct 348/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5189
Overall F1 Score: 0.1521

Training for fine level...
batch 100, loss: 0.7913, instance_loss: 0.2619, weighted_loss: 0.6324, label: 6, bag_size: 225
batch 200, loss: 0.0732, instance_loss: 0.0415, weighted_loss: 0.0637, label: 5, bag_size: 705
batch 300, loss: 0.1714, instance_loss: 0.0471, weighted_loss: 0.1341, label: 5, bag_size: 665
batch 400, loss: 0.1414, instance_loss: 0.0679, weighted_loss: 0.1193, label: 5, bag_size: 475
batch 500, loss: 2.4320, instance_loss: 0.3703, weighted_loss: 1.8135, label: 0, bag_size: 388
batch 600, loss: 0.0576, instance_loss: 0.0411, weighted_loss: 0.0526, label: 5, bag_size: 1281
batch 700, loss: 1.0622, instance_loss: 0.2927, weighted_loss: 0.8314, label: 4, bag_size: 1673
batch 800, loss: 0.1112, instance_loss: 0.0334, weighted_loss: 0.0879, label: 5, bag_size: 1257
batch 900, loss: 0.9959, instance_loss: 0.1701, weighted_loss: 0.7482, label: 5, bag_size: 525
batch 1000, loss: 4.2199, instance_loss: 0.3722, weighted_loss: 3.0656, label: 9, bag_size: 237
batch 1100, loss: 0.8759, instance_loss: 0.1737, weighted_loss: 0.6652, label: 5, bag_size: 385
batch 1200, loss: 0.9616, instance_loss: 0.2868, weighted_loss: 0.7591, label: 6, bag_size: 461
batch 1300, loss: 2.7600, instance_loss: 0.3545, weighted_loss: 2.0384, label: 3, bag_size: 756
batch 1400, loss: 0.1530, instance_loss: 0.0527, weighted_loss: 0.1229, label: 5, bag_size: 597
batch 1500, loss: 1.4948, instance_loss: 0.2565, weighted_loss: 1.1233, label: 3, bag_size: 483
batch 1600, loss: 0.0371, instance_loss: 0.0373, weighted_loss: 0.0372, label: 5, bag_size: 455
batch 1700, loss: 1.3604, instance_loss: 0.2414, weighted_loss: 1.0247, label: 8, bag_size: 245
batch 1800, loss: 0.6457, instance_loss: 0.1495, weighted_loss: 0.4968, label: 5, bag_size: 795
batch 1900, loss: 0.5142, instance_loss: 0.0984, weighted_loss: 0.3895, label: 5, bag_size: 578
batch 2000, loss: 0.9448, instance_loss: 0.1448, weighted_loss: 0.7048, label: 5, bag_size: 223
batch 2100, loss: 1.6675, instance_loss: 0.2384, weighted_loss: 1.2387, label: 2, bag_size: 190

Instance Classifier Stats
class 0 clustering acc 0.9967532467532467: correct 190340/190960
class 1 clustering acc 0.16192396313364055: correct 2811/17360

Epoch: 64, train_loss: 1.3228, train_clustering_loss: 0.2098, train_error: 0.4677
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.586073500967118, correct fine 303/517 
fine class 3: fine acc 0.006666666666666667, correct fine 1/150 
fine class 4: fine acc 0.2956521739130435, correct fine 34/115 
fine class 5: fine acc 0.9069212410501193, correct fine 760/838 
fine class 6: fine acc 0.1927710843373494, correct fine 48/249 
fine class 7: fine acc 0.033707865168539325, correct fine 3/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5323

Val Set, val_loss: 1.4089, val_error: 0.4735, auc: 0.7882
class 0 clustering acc 0.9975464876033058: correct 23175/23232 
class 1 clustering acc 0.16714015151515152: correct 353/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1650

Training for fine level...
batch 100, loss: 0.3567, instance_loss: 0.1110, weighted_loss: 0.2830, label: 2, bag_size: 2119
batch 200, loss: 2.2494, instance_loss: 0.3168, weighted_loss: 1.6696, label: 3, bag_size: 942
batch 300, loss: 0.5214, instance_loss: 0.1418, weighted_loss: 0.4075, label: 5, bag_size: 393
batch 400, loss: 3.3792, instance_loss: 0.3784, weighted_loss: 2.4790, label: 7, bag_size: 704
batch 500, loss: 0.3613, instance_loss: 0.0862, weighted_loss: 0.2788, label: 5, bag_size: 239
batch 600, loss: 2.1155, instance_loss: 0.2969, weighted_loss: 1.5699, label: 3, bag_size: 1150
batch 700, loss: 0.2289, instance_loss: 0.0565, weighted_loss: 0.1772, label: 5, bag_size: 714
batch 800, loss: 4.2758, instance_loss: 0.4151, weighted_loss: 3.1176, label: 3, bag_size: 633
batch 900, loss: 1.5017, instance_loss: 0.2801, weighted_loss: 1.1353, label: 3, bag_size: 945
batch 1000, loss: 0.9259, instance_loss: 0.1779, weighted_loss: 0.7015, label: 2, bag_size: 515
batch 1100, loss: 2.4044, instance_loss: 0.2609, weighted_loss: 1.7614, label: 6, bag_size: 267
batch 1200, loss: 0.5365, instance_loss: 0.1240, weighted_loss: 0.4128, label: 2, bag_size: 592
batch 1300, loss: 0.4573, instance_loss: 0.1443, weighted_loss: 0.3634, label: 2, bag_size: 1234
batch 1400, loss: 0.2557, instance_loss: 0.1025, weighted_loss: 0.2098, label: 5, bag_size: 226
batch 1500, loss: 1.5979, instance_loss: 0.2581, weighted_loss: 1.1959, label: 5, bag_size: 1897
batch 1600, loss: 3.2044, instance_loss: 0.3255, weighted_loss: 2.3407, label: 7, bag_size: 682
batch 1700, loss: 0.1557, instance_loss: 0.0614, weighted_loss: 0.1274, label: 5, bag_size: 1014
batch 1800, loss: 0.1403, instance_loss: 0.0517, weighted_loss: 0.1137, label: 5, bag_size: 771
batch 1900, loss: 2.7718, instance_loss: 0.3217, weighted_loss: 2.0368, label: 3, bag_size: 756
batch 2000, loss: 0.1023, instance_loss: 0.0582, weighted_loss: 0.0891, label: 5, bag_size: 632
batch 2100, loss: 1.8563, instance_loss: 0.2674, weighted_loss: 1.3797, label: 8, bag_size: 536

Instance Classifier Stats
class 0 clustering acc 0.9967270632593214: correct 190335/190960
class 1 clustering acc 0.16105990783410137: correct 2796/17360

Epoch: 65, train_loss: 1.3216, train_clustering_loss: 0.2100, train_error: 0.4659
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5880077369439072, correct fine 304/517 
fine class 3: fine acc 0.013333333333333334, correct fine 2/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.9033412887828163, correct fine 757/838 
fine class 6: fine acc 0.21686746987951808, correct fine 54/249 
fine class 7: fine acc 0.06741573033707865, correct fine 6/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5341

Val Set, val_loss: 1.4086, val_error: 0.4735, auc: 0.7882
class 0 clustering acc 0.9975895316804407: correct 23176/23232 
class 1 clustering acc 0.16477272727272727: correct 348/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1649

Training for fine level...
batch 100, loss: 2.1564, instance_loss: 0.2759, weighted_loss: 1.5923, label: 5, bag_size: 537
batch 200, loss: 2.1789, instance_loss: 0.2849, weighted_loss: 1.6107, label: 8, bag_size: 571
batch 300, loss: 1.9253, instance_loss: 0.3084, weighted_loss: 1.4402, label: 3, bag_size: 427
batch 400, loss: 0.8936, instance_loss: 0.1370, weighted_loss: 0.6666, label: 2, bag_size: 826
batch 500, loss: 3.9849, instance_loss: 0.4030, weighted_loss: 2.9103, label: 10, bag_size: 309
batch 600, loss: 1.2134, instance_loss: 0.1900, weighted_loss: 0.9064, label: 5, bag_size: 331
batch 700, loss: 0.8031, instance_loss: 0.1464, weighted_loss: 0.6061, label: 5, bag_size: 422
batch 800, loss: 2.0241, instance_loss: 0.2820, weighted_loss: 1.5015, label: 5, bag_size: 1426
batch 900, loss: 2.4807, instance_loss: 0.2970, weighted_loss: 1.8256, label: 4, bag_size: 344
batch 1000, loss: 2.7007, instance_loss: 0.3247, weighted_loss: 1.9879, label: 5, bag_size: 1364
batch 1100, loss: 1.3784, instance_loss: 0.2482, weighted_loss: 1.0393, label: 5, bag_size: 132
batch 1200, loss: 1.2706, instance_loss: 0.2750, weighted_loss: 0.9720, label: 3, bag_size: 2842
batch 1300, loss: 1.7084, instance_loss: 0.2338, weighted_loss: 1.2660, label: 2, bag_size: 190
batch 1400, loss: 0.0410, instance_loss: 0.0242, weighted_loss: 0.0359, label: 5, bag_size: 635
batch 1500, loss: 2.8587, instance_loss: 0.3056, weighted_loss: 2.0928, label: 7, bag_size: 256
batch 1600, loss: 0.6083, instance_loss: 0.1433, weighted_loss: 0.4688, label: 5, bag_size: 888
batch 1700, loss: 1.8561, instance_loss: 0.3040, weighted_loss: 1.3905, label: 7, bag_size: 590
batch 1800, loss: 1.5176, instance_loss: 0.2491, weighted_loss: 1.1370, label: 2, bag_size: 169
batch 1900, loss: 1.4483, instance_loss: 0.2993, weighted_loss: 1.1036, label: 3, bag_size: 1172
batch 2000, loss: 1.2655, instance_loss: 0.2486, weighted_loss: 0.9604, label: 2, bag_size: 177
batch 2100, loss: 1.1867, instance_loss: 0.2373, weighted_loss: 0.9019, label: 2, bag_size: 738

Instance Classifier Stats
class 0 clustering acc 0.9967480100544617: correct 190339/190960
class 1 clustering acc 0.16065668202764977: correct 2789/17360

Epoch: 66, train_loss: 1.3214, train_clustering_loss: 0.2101, train_error: 0.4636
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6015473887814313, correct fine 311/517 
fine class 3: fine acc 0.006666666666666667, correct fine 1/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.9021479713603818, correct fine 756/838 
fine class 6: fine acc 0.20883534136546184, correct fine 52/249 
fine class 7: fine acc 0.056179775280898875, correct fine 5/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5364

Val Set, val_loss: 1.4084, val_error: 0.4735, auc: 0.7881
class 0 clustering acc 0.9975895316804407: correct 23176/23232 
class 1 clustering acc 0.16477272727272727: correct 348/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1649

Training for fine level...
batch 100, loss: 3.0064, instance_loss: 0.3403, weighted_loss: 2.2065, label: 10, bag_size: 239
batch 200, loss: 1.9926, instance_loss: 0.3026, weighted_loss: 1.4856, label: 6, bag_size: 344
batch 300, loss: 0.2189, instance_loss: 0.0717, weighted_loss: 0.1747, label: 5, bag_size: 544
batch 400, loss: 3.5417, instance_loss: 0.3534, weighted_loss: 2.5852, label: 10, bag_size: 472
batch 500, loss: 1.8007, instance_loss: 0.2517, weighted_loss: 1.3360, label: 2, bag_size: 562
batch 600, loss: 0.0714, instance_loss: 0.0337, weighted_loss: 0.0601, label: 5, bag_size: 364
batch 700, loss: 0.3342, instance_loss: 0.0958, weighted_loss: 0.2627, label: 5, bag_size: 624
batch 800, loss: 0.1858, instance_loss: 0.0643, weighted_loss: 0.1493, label: 5, bag_size: 368
batch 900, loss: 2.6066, instance_loss: 0.3231, weighted_loss: 1.9215, label: 1, bag_size: 369
batch 1000, loss: 4.5179, instance_loss: 0.4011, weighted_loss: 3.2829, label: 9, bag_size: 830
batch 1100, loss: 0.8499, instance_loss: 0.0880, weighted_loss: 0.6213, label: 5, bag_size: 1000
batch 1200, loss: 0.2551, instance_loss: 0.0865, weighted_loss: 0.2045, label: 5, bag_size: 229
batch 1300, loss: 2.0775, instance_loss: 0.2584, weighted_loss: 1.5318, label: 6, bag_size: 379
batch 1400, loss: 3.4362, instance_loss: 0.3406, weighted_loss: 2.5075, label: 1, bag_size: 451
batch 1500, loss: 0.9550, instance_loss: 0.1544, weighted_loss: 0.7149, label: 5, bag_size: 525
batch 1600, loss: 0.4112, instance_loss: 0.1314, weighted_loss: 0.3272, label: 5, bag_size: 1222
batch 1700, loss: 0.1792, instance_loss: 0.0676, weighted_loss: 0.1457, label: 5, bag_size: 637
batch 1800, loss: 0.3740, instance_loss: 0.0895, weighted_loss: 0.2886, label: 5, bag_size: 861
batch 1900, loss: 0.4069, instance_loss: 0.1448, weighted_loss: 0.3283, label: 2, bag_size: 298
batch 2000, loss: 0.2534, instance_loss: 0.0612, weighted_loss: 0.1958, label: 5, bag_size: 859
batch 2100, loss: 1.4694, instance_loss: 0.2393, weighted_loss: 1.1004, label: 2, bag_size: 65

Instance Classifier Stats
class 0 clustering acc 0.9970465018852116: correct 190396/190960
class 1 clustering acc 0.1601958525345622: correct 2781/17360

Epoch: 67, train_loss: 1.3179, train_clustering_loss: 0.2096, train_error: 0.4650
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5938104448742747, correct fine 307/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.28695652173913044, correct fine 33/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.22088353413654618, correct fine 55/249 
fine class 7: fine acc 0.06741573033707865, correct fine 6/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5350

Val Set, val_loss: 1.4077, val_error: 0.4735, auc: 0.7881
class 0 clustering acc 0.9975034435261708: correct 23174/23232 
class 1 clustering acc 0.16761363636363635: correct 354/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.13333333333333333, correct fine 4/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1615

Training for fine level...
batch 100, loss: 0.5112, instance_loss: 0.2526, weighted_loss: 0.4336, label: 4, bag_size: 1333
batch 200, loss: 0.3083, instance_loss: 0.0696, weighted_loss: 0.2367, label: 5, bag_size: 341
batch 300, loss: 1.6745, instance_loss: 0.2534, weighted_loss: 1.2482, label: 2, bag_size: 169
batch 400, loss: 1.2248, instance_loss: 0.2116, weighted_loss: 0.9208, label: 5, bag_size: 202
batch 500, loss: 2.2337, instance_loss: 0.3203, weighted_loss: 1.6597, label: 3, bag_size: 378
batch 600, loss: 0.9846, instance_loss: 0.1588, weighted_loss: 0.7369, label: 5, bag_size: 216
batch 700, loss: 3.9796, instance_loss: 0.4099, weighted_loss: 2.9087, label: 10, bag_size: 751
batch 800, loss: 0.8969, instance_loss: 0.2285, weighted_loss: 0.6964, label: 6, bag_size: 453
batch 900, loss: 1.0649, instance_loss: 0.2103, weighted_loss: 0.8085, label: 2, bag_size: 225
batch 1000, loss: 0.1315, instance_loss: 0.0508, weighted_loss: 0.1073, label: 5, bag_size: 592
batch 1100, loss: 3.8080, instance_loss: 0.3730, weighted_loss: 2.7775, label: 8, bag_size: 527
batch 1200, loss: 0.0354, instance_loss: 0.0290, weighted_loss: 0.0335, label: 5, bag_size: 249
batch 1300, loss: 1.2527, instance_loss: 0.2739, weighted_loss: 0.9590, label: 4, bag_size: 919
batch 1400, loss: 1.8321, instance_loss: 0.2670, weighted_loss: 1.3626, label: 8, bag_size: 536
batch 1500, loss: 0.4043, instance_loss: 0.1226, weighted_loss: 0.3198, label: 2, bag_size: 2627
batch 1600, loss: 0.3159, instance_loss: 0.1594, weighted_loss: 0.2689, label: 2, bag_size: 177
batch 1700, loss: 1.8005, instance_loss: 0.2747, weighted_loss: 1.3427, label: 7, bag_size: 628
batch 1800, loss: 0.6445, instance_loss: 0.1272, weighted_loss: 0.4893, label: 2, bag_size: 1245
batch 1900, loss: 0.2908, instance_loss: 0.0497, weighted_loss: 0.2185, label: 5, bag_size: 1600
batch 2000, loss: 1.0232, instance_loss: 0.1676, weighted_loss: 0.7665, label: 5, bag_size: 91
batch 2100, loss: 2.4327, instance_loss: 0.3486, weighted_loss: 1.8075, label: 2, bag_size: 306

Instance Classifier Stats
class 0 clustering acc 0.9968422706325932: correct 190357/190960
class 1 clustering acc 0.1619815668202765: correct 2812/17360

Epoch: 68, train_loss: 1.3139, train_clustering_loss: 0.2092, train_error: 0.4650
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.586073500967118, correct fine 303/517 
fine class 3: fine acc 0.013333333333333334, correct fine 2/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.9033412887828163, correct fine 757/838 
fine class 6: fine acc 0.22088353413654618, correct fine 55/249 
fine class 7: fine acc 0.06741573033707865, correct fine 6/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5350

Val Set, val_loss: 1.4075, val_error: 0.4811, auc: 0.7871
class 0 clustering acc 0.9975034435261708: correct 23174/23232 
class 1 clustering acc 0.16761363636363635: correct 354/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.13333333333333333, correct fine 4/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5189
Overall F1 Score: 0.1687

Training for fine level...
batch 100, loss: 2.5182, instance_loss: 0.3077, weighted_loss: 1.8550, label: 6, bag_size: 641
batch 200, loss: 1.0743, instance_loss: 0.2188, weighted_loss: 0.8177, label: 5, bag_size: 708
batch 300, loss: 0.1015, instance_loss: 0.0463, weighted_loss: 0.0850, label: 5, bag_size: 330
batch 400, loss: 0.2107, instance_loss: 0.2002, weighted_loss: 0.2075, label: 4, bag_size: 500
batch 500, loss: 2.8948, instance_loss: 0.3351, weighted_loss: 2.1269, label: 3, bag_size: 371
batch 600, loss: 1.6583, instance_loss: 0.2905, weighted_loss: 1.2480, label: 4, bag_size: 1841
batch 700, loss: 2.4434, instance_loss: 0.3071, weighted_loss: 1.8025, label: 6, bag_size: 565
batch 800, loss: 1.5643, instance_loss: 0.2356, weighted_loss: 1.1657, label: 2, bag_size: 49
batch 900, loss: 2.6552, instance_loss: 0.3095, weighted_loss: 1.9515, label: 8, bag_size: 542
batch 1000, loss: 2.2975, instance_loss: 0.2097, weighted_loss: 1.6712, label: 5, bag_size: 113
batch 1100, loss: 1.1137, instance_loss: 0.1955, weighted_loss: 0.8382, label: 2, bag_size: 940
batch 1200, loss: 0.5084, instance_loss: 0.1183, weighted_loss: 0.3914, label: 2, bag_size: 409
batch 1300, loss: 0.0652, instance_loss: 0.0334, weighted_loss: 0.0557, label: 5, bag_size: 228
batch 1400, loss: 0.7350, instance_loss: 0.1564, weighted_loss: 0.5614, label: 2, bag_size: 936
batch 1500, loss: 2.1084, instance_loss: 0.3040, weighted_loss: 1.5671, label: 8, bag_size: 486
batch 1600, loss: 0.9229, instance_loss: 0.1632, weighted_loss: 0.6950, label: 5, bag_size: 389
batch 1700, loss: 1.9791, instance_loss: 0.3101, weighted_loss: 1.4784, label: 7, bag_size: 227
batch 1800, loss: 1.0439, instance_loss: 0.1485, weighted_loss: 0.7753, label: 5, bag_size: 1422
batch 1900, loss: 2.0154, instance_loss: 0.3179, weighted_loss: 1.5061, label: 7, bag_size: 490
batch 2000, loss: 0.5934, instance_loss: 0.2628, weighted_loss: 0.4942, label: 6, bag_size: 732
batch 2100, loss: 0.5928, instance_loss: 0.1139, weighted_loss: 0.4491, label: 2, bag_size: 248

Instance Classifier Stats
class 0 clustering acc 0.9968213238374529: correct 190353/190960
class 1 clustering acc 0.1640552995391705: correct 2848/17360

Epoch: 69, train_loss: 1.3165, train_clustering_loss: 0.2095, train_error: 0.4650
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5802707930367504, correct fine 300/517 
fine class 3: fine acc 0.006666666666666667, correct fine 1/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.9021479713603818, correct fine 756/838 
fine class 6: fine acc 0.24096385542168675, correct fine 60/249 
fine class 7: fine acc 0.0449438202247191, correct fine 4/89 
fine class 8: fine acc 0.06060606060606061, correct fine 8/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5350

Val Set, val_loss: 1.4078, val_error: 0.4848, auc: 0.7869
class 0 clustering acc 0.9975464876033058: correct 23175/23232 
class 1 clustering acc 0.16666666666666666: correct 352/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.13333333333333333, correct fine 4/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1594

Training for fine level...
batch 100, loss: 2.0409, instance_loss: 0.2951, weighted_loss: 1.5171, label: 7, bag_size: 263
batch 200, loss: 0.7801, instance_loss: 0.1655, weighted_loss: 0.5957, label: 2, bag_size: 192
batch 300, loss: 0.8973, instance_loss: 0.1730, weighted_loss: 0.6800, label: 5, bag_size: 385
batch 400, loss: 2.2364, instance_loss: 0.2972, weighted_loss: 1.6547, label: 6, bag_size: 274
batch 500, loss: 1.0361, instance_loss: 0.2712, weighted_loss: 0.8066, label: 6, bag_size: 244
batch 600, loss: 2.0942, instance_loss: 0.2284, weighted_loss: 1.5345, label: 2, bag_size: 254
batch 700, loss: 2.2257, instance_loss: 0.2546, weighted_loss: 1.6344, label: 5, bag_size: 3051
batch 800, loss: 1.1024, instance_loss: 0.1913, weighted_loss: 0.8291, label: 5, bag_size: 562
batch 900, loss: 2.5081, instance_loss: 0.2851, weighted_loss: 1.8412, label: 5, bag_size: 506
batch 1000, loss: 0.0752, instance_loss: 0.0335, weighted_loss: 0.0627, label: 5, bag_size: 956
batch 1100, loss: 1.0617, instance_loss: 0.2071, weighted_loss: 0.8053, label: 8, bag_size: 120
batch 1200, loss: 0.1029, instance_loss: 0.0547, weighted_loss: 0.0884, label: 5, bag_size: 515
batch 1300, loss: 0.0393, instance_loss: 0.0303, weighted_loss: 0.0366, label: 5, bag_size: 307
batch 1400, loss: 4.6748, instance_loss: 0.4622, weighted_loss: 3.4111, label: 10, bag_size: 372
batch 1500, loss: 0.0575, instance_loss: 0.0370, weighted_loss: 0.0513, label: 5, bag_size: 619
batch 1600, loss: 2.0367, instance_loss: 0.2416, weighted_loss: 1.4981, label: 2, bag_size: 393
batch 1700, loss: 2.0567, instance_loss: 0.2957, weighted_loss: 1.5284, label: 2, bag_size: 377
batch 1800, loss: 0.2064, instance_loss: 0.0915, weighted_loss: 0.1720, label: 5, bag_size: 643
batch 1900, loss: 0.5320, instance_loss: 0.1247, weighted_loss: 0.4098, label: 2, bag_size: 3773
batch 2000, loss: 2.1800, instance_loss: 0.2690, weighted_loss: 1.6067, label: 5, bag_size: 304
batch 2100, loss: 1.2010, instance_loss: 0.2110, weighted_loss: 0.9040, label: 5, bag_size: 2114

Instance Classifier Stats
class 0 clustering acc 0.9967899036447424: correct 190347/190960
class 1 clustering acc 0.1622119815668203: correct 2816/17360

Epoch: 70, train_loss: 1.3106, train_clustering_loss: 0.2095, train_error: 0.4613
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.0, correct fine 0/150 
fine class 4: fine acc 0.28695652173913044, correct fine 33/115 
fine class 5: fine acc 0.9021479713603818, correct fine 756/838 
fine class 6: fine acc 0.21686746987951808, correct fine 54/249 
fine class 7: fine acc 0.07865168539325842, correct fine 7/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5387

Val Set, val_loss: 1.4070, val_error: 0.4773, auc: 0.7870
class 0 clustering acc 0.9975034435261708: correct 23174/23232 
class 1 clustering acc 0.16856060606060605: correct 356/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1725

Training for fine level...
batch 100, loss: 0.2640, instance_loss: 0.0528, weighted_loss: 0.2006, label: 5, bag_size: 812
batch 200, loss: 1.6205, instance_loss: 0.2393, weighted_loss: 1.2061, label: 5, bag_size: 1897
batch 300, loss: 1.1853, instance_loss: 0.2235, weighted_loss: 0.8967, label: 5, bag_size: 463
batch 400, loss: 0.0781, instance_loss: 0.0429, weighted_loss: 0.0676, label: 5, bag_size: 280
batch 500, loss: 2.7239, instance_loss: 0.2594, weighted_loss: 1.9845, label: 5, bag_size: 576
batch 600, loss: 0.5327, instance_loss: 0.2137, weighted_loss: 0.4370, label: 4, bag_size: 507
batch 700, loss: 0.3228, instance_loss: 0.1319, weighted_loss: 0.2656, label: 5, bag_size: 444
batch 800, loss: 1.8436, instance_loss: 0.2427, weighted_loss: 1.3633, label: 6, bag_size: 1836
batch 900, loss: 1.2825, instance_loss: 0.4091, weighted_loss: 1.0205, label: 6, bag_size: 361
batch 1000, loss: 0.8346, instance_loss: 0.1851, weighted_loss: 0.6397, label: 5, bag_size: 929
batch 1100, loss: 0.4602, instance_loss: 0.1212, weighted_loss: 0.3585, label: 2, bag_size: 214
batch 1200, loss: 2.7288, instance_loss: 0.3236, weighted_loss: 2.0072, label: 4, bag_size: 169
batch 1300, loss: 3.0558, instance_loss: 0.3169, weighted_loss: 2.2341, label: 4, bag_size: 264
batch 1400, loss: 0.9375, instance_loss: 0.1903, weighted_loss: 0.7133, label: 2, bag_size: 766
batch 1500, loss: 1.9973, instance_loss: 0.3024, weighted_loss: 1.4888, label: 6, bag_size: 396
batch 1600, loss: 0.1308, instance_loss: 0.0505, weighted_loss: 0.1067, label: 5, bag_size: 540
batch 1700, loss: 0.0805, instance_loss: 0.0395, weighted_loss: 0.0682, label: 5, bag_size: 296
batch 1800, loss: 1.8124, instance_loss: 0.2403, weighted_loss: 1.3408, label: 2, bag_size: 334
batch 1900, loss: 3.9051, instance_loss: 0.3635, weighted_loss: 2.8426, label: 1, bag_size: 142
batch 2000, loss: 1.2174, instance_loss: 0.2465, weighted_loss: 0.9262, label: 5, bag_size: 595
batch 2100, loss: 1.5618, instance_loss: 0.3134, weighted_loss: 1.1873, label: 2, bag_size: 910

Instance Classifier Stats
class 0 clustering acc 0.9966380393799749: correct 190318/190960
class 1 clustering acc 0.16658986175115206: correct 2892/17360

Epoch: 71, train_loss: 1.3099, train_clustering_loss: 0.2089, train_error: 0.4636
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6015473887814313, correct fine 311/517 
fine class 3: fine acc 0.013333333333333334, correct fine 2/150 
fine class 4: fine acc 0.28695652173913044, correct fine 33/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.22088353413654618, correct fine 55/249 
fine class 7: fine acc 0.0449438202247191, correct fine 4/89 
fine class 8: fine acc 0.045454545454545456, correct fine 6/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5364

Val Set, val_loss: 1.4066, val_error: 0.4773, auc: 0.7875
class 0 clustering acc 0.9975034435261708: correct 23174/23232 
class 1 clustering acc 0.16856060606060605: correct 356/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1640

Training for fine level...
batch 100, loss: 1.3177, instance_loss: 0.2344, weighted_loss: 0.9927, label: 5, bag_size: 765
batch 200, loss: 2.9102, instance_loss: 0.3558, weighted_loss: 2.1439, label: 3, bag_size: 276
batch 300, loss: 0.0494, instance_loss: 0.0339, weighted_loss: 0.0447, label: 5, bag_size: 1157
batch 400, loss: 0.1404, instance_loss: 0.0605, weighted_loss: 0.1165, label: 5, bag_size: 457
batch 500, loss: 0.0406, instance_loss: 0.0372, weighted_loss: 0.0396, label: 5, bag_size: 255
batch 600, loss: 3.7521, instance_loss: 0.3511, weighted_loss: 2.7318, label: 5, bag_size: 2344
batch 700, loss: 1.6979, instance_loss: 0.2294, weighted_loss: 1.2573, label: 2, bag_size: 179
batch 800, loss: 4.3255, instance_loss: 0.3932, weighted_loss: 3.1458, label: 10, bag_size: 625
batch 900, loss: 1.5531, instance_loss: 0.2540, weighted_loss: 1.1633, label: 8, bag_size: 79
batch 1000, loss: 1.6209, instance_loss: 0.2704, weighted_loss: 1.2157, label: 3, bag_size: 459
batch 1100, loss: 2.7791, instance_loss: 0.2895, weighted_loss: 2.0322, label: 7, bag_size: 528
batch 1200, loss: 0.8520, instance_loss: 0.1522, weighted_loss: 0.6421, label: 5, bag_size: 1048
batch 1300, loss: 0.3771, instance_loss: 0.1303, weighted_loss: 0.3030, label: 2, bag_size: 1404
batch 1400, loss: 0.4338, instance_loss: 0.1093, weighted_loss: 0.3365, label: 5, bag_size: 358
batch 1500, loss: 0.3344, instance_loss: 0.1204, weighted_loss: 0.2702, label: 2, bag_size: 2220
batch 1600, loss: 0.6541, instance_loss: 0.1414, weighted_loss: 0.5003, label: 5, bag_size: 510
batch 1700, loss: 1.0559, instance_loss: 0.1510, weighted_loss: 0.7844, label: 2, bag_size: 975
batch 1800, loss: 1.5230, instance_loss: 0.2591, weighted_loss: 1.1438, label: 6, bag_size: 689
batch 1900, loss: 1.0967, instance_loss: 0.3594, weighted_loss: 0.8755, label: 6, bag_size: 361
batch 2000, loss: 0.1301, instance_loss: 0.0546, weighted_loss: 0.1074, label: 5, bag_size: 651
batch 2100, loss: 1.5173, instance_loss: 0.2084, weighted_loss: 1.1247, label: 5, bag_size: 95

Instance Classifier Stats
class 0 clustering acc 0.9968527440301634: correct 190359/190960
class 1 clustering acc 0.16503456221198157: correct 2865/17360

Epoch: 72, train_loss: 1.3076, train_clustering_loss: 0.2088, train_error: 0.4548
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6150870406189555, correct fine 318/517 
fine class 3: fine acc 0.02, correct fine 3/150 
fine class 4: fine acc 0.2956521739130435, correct fine 34/115 
fine class 5: fine acc 0.8973747016706444, correct fine 752/838 
fine class 6: fine acc 0.24899598393574296, correct fine 62/249 
fine class 7: fine acc 0.07865168539325842, correct fine 7/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5452

Val Set, val_loss: 1.4064, val_error: 0.4773, auc: 0.7883
class 0 clustering acc 0.9974173553719008: correct 23172/23232 
class 1 clustering acc 0.1709280303030303: correct 361/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.13333333333333333, correct fine 4/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1608

Training for fine level...
batch 100, loss: 0.8490, instance_loss: 0.2237, weighted_loss: 0.6614, label: 6, bag_size: 92
batch 200, loss: 1.3399, instance_loss: 0.2801, weighted_loss: 1.0220, label: 2, bag_size: 505
batch 300, loss: 1.7068, instance_loss: 0.3120, weighted_loss: 1.2883, label: 3, bag_size: 837
batch 400, loss: 2.2539, instance_loss: 0.3078, weighted_loss: 1.6701, label: 6, bag_size: 361
batch 500, loss: 3.4848, instance_loss: 0.3705, weighted_loss: 2.5505, label: 7, bag_size: 704
batch 600, loss: 0.1610, instance_loss: 0.0634, weighted_loss: 0.1318, label: 5, bag_size: 656
batch 700, loss: 0.9691, instance_loss: 0.2014, weighted_loss: 0.7388, label: 5, bag_size: 151
batch 800, loss: 0.5540, instance_loss: 0.1094, weighted_loss: 0.4206, label: 2, bag_size: 660
batch 900, loss: 0.2776, instance_loss: 0.0747, weighted_loss: 0.2167, label: 5, bag_size: 357
batch 1000, loss: 0.9834, instance_loss: 0.2844, weighted_loss: 0.7737, label: 6, bag_size: 117
batch 1100, loss: 0.0315, instance_loss: 0.0357, weighted_loss: 0.0328, label: 5, bag_size: 699
batch 1200, loss: 1.0571, instance_loss: 0.1988, weighted_loss: 0.7996, label: 5, bag_size: 604
batch 1300, loss: 0.4666, instance_loss: 0.0835, weighted_loss: 0.3517, label: 5, bag_size: 721
batch 1400, loss: 1.6691, instance_loss: 0.2566, weighted_loss: 1.2454, label: 2, bag_size: 250
batch 1500, loss: 2.8015, instance_loss: 0.2960, weighted_loss: 2.0499, label: 3, bag_size: 526
batch 1600, loss: 2.4652, instance_loss: 0.2600, weighted_loss: 1.8036, label: 6, bag_size: 259
batch 1700, loss: 6.4308, instance_loss: 0.6113, weighted_loss: 4.6849, label: 3, bag_size: 477
batch 1800, loss: 2.0920, instance_loss: 0.2991, weighted_loss: 1.5541, label: 6, bag_size: 523
batch 1900, loss: 1.7604, instance_loss: 0.2733, weighted_loss: 1.3142, label: 2, bag_size: 57
batch 2000, loss: 3.8674, instance_loss: 0.3550, weighted_loss: 2.8137, label: 8, bag_size: 527
batch 2100, loss: 2.6087, instance_loss: 0.2851, weighted_loss: 1.9116, label: 2, bag_size: 775

Instance Classifier Stats
class 0 clustering acc 0.9969051110180143: correct 190369/190960
class 1 clustering acc 0.16514976958525346: correct 2867/17360

Epoch: 73, train_loss: 1.3061, train_clustering_loss: 0.2085, train_error: 0.4604
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5880077369439072, correct fine 304/517 
fine class 3: fine acc 0.013333333333333334, correct fine 2/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.9081145584725537, correct fine 761/838 
fine class 6: fine acc 0.2289156626506024, correct fine 57/249 
fine class 7: fine acc 0.06741573033707865, correct fine 6/89 
fine class 8: fine acc 0.07575757575757576, correct fine 10/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5396

Val Set, val_loss: 1.4064, val_error: 0.4773, auc: 0.7876
class 0 clustering acc 0.9974173553719008: correct 23172/23232 
class 1 clustering acc 0.1699810606060606: correct 359/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.13333333333333333, correct fine 4/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1609

Training for fine level...
batch 100, loss: 0.5047, instance_loss: 0.2043, weighted_loss: 0.4146, label: 4, bag_size: 909
batch 200, loss: 1.0526, instance_loss: 0.1761, weighted_loss: 0.7897, label: 5, bag_size: 309
batch 300, loss: 5.0528, instance_loss: 0.5292, weighted_loss: 3.6957, label: 7, bag_size: 561
batch 400, loss: 5.0585, instance_loss: 0.5383, weighted_loss: 3.7024, label: 7, bag_size: 868
batch 500, loss: 1.2321, instance_loss: 0.2273, weighted_loss: 0.9307, label: 5, bag_size: 968
batch 600, loss: 3.6418, instance_loss: 0.3131, weighted_loss: 2.6432, label: 7, bag_size: 675
batch 700, loss: 2.4176, instance_loss: 0.3789, weighted_loss: 1.8060, label: 6, bag_size: 414
batch 800, loss: 0.3500, instance_loss: 0.0883, weighted_loss: 0.2715, label: 5, bag_size: 601
batch 900, loss: 1.0519, instance_loss: 0.2469, weighted_loss: 0.8104, label: 6, bag_size: 316
batch 1000, loss: 6.4015, instance_loss: 0.5520, weighted_loss: 4.6467, label: 3, bag_size: 477
batch 1100, loss: 0.4644, instance_loss: 0.1254, weighted_loss: 0.3627, label: 2, bag_size: 214
batch 1200, loss: 0.2378, instance_loss: 0.1907, weighted_loss: 0.2237, label: 4, bag_size: 847
batch 1300, loss: 1.5779, instance_loss: 0.2813, weighted_loss: 1.1889, label: 4, bag_size: 786
batch 1400, loss: 0.5841, instance_loss: 0.2333, weighted_loss: 0.4789, label: 6, bag_size: 732
batch 1500, loss: 1.6769, instance_loss: 0.2945, weighted_loss: 1.2622, label: 2, bag_size: 167
batch 1600, loss: 1.6483, instance_loss: 0.2546, weighted_loss: 1.2302, label: 2, bag_size: 381
batch 1700, loss: 0.3566, instance_loss: 0.1172, weighted_loss: 0.2848, label: 2, bag_size: 2121
batch 1800, loss: 0.3369, instance_loss: 0.0784, weighted_loss: 0.2594, label: 5, bag_size: 537
batch 1900, loss: 1.1757, instance_loss: 0.1652, weighted_loss: 0.8726, label: 5, bag_size: 658
batch 2000, loss: 1.0187, instance_loss: 0.2726, weighted_loss: 0.7949, label: 3, bag_size: 1781
batch 2100, loss: 1.5140, instance_loss: 0.2369, weighted_loss: 1.1309, label: 8, bag_size: 384

Instance Classifier Stats
class 0 clustering acc 0.9966066191872643: correct 190312/190960
class 1 clustering acc 0.16561059907834103: correct 2875/17360

Epoch: 74, train_loss: 1.3036, train_clustering_loss: 0.2083, train_error: 0.4604
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5996131528046421, correct fine 310/517 
fine class 3: fine acc 0.02, correct fine 3/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.9009546539379475, correct fine 755/838 
fine class 6: fine acc 0.2289156626506024, correct fine 57/249 
fine class 7: fine acc 0.07865168539325842, correct fine 7/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5396

Val Set, val_loss: 1.4066, val_error: 0.4848, auc: 0.7876
class 0 clustering acc 0.9973743112947658: correct 23171/23232 
class 1 clustering acc 0.1709280303030303: correct 361/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.13333333333333333, correct fine 4/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1593

Training for fine level...
batch 100, loss: 0.0408, instance_loss: 0.0332, weighted_loss: 0.0385, label: 5, bag_size: 455
batch 200, loss: 5.0225, instance_loss: 0.5441, weighted_loss: 3.6790, label: 7, bag_size: 868
batch 300, loss: 0.3222, instance_loss: 0.1037, weighted_loss: 0.2567, label: 5, bag_size: 393
batch 400, loss: 1.8457, instance_loss: 0.3012, weighted_loss: 1.3824, label: 2, bag_size: 1654
batch 500, loss: 0.1012, instance_loss: 0.0623, weighted_loss: 0.0895, label: 5, bag_size: 292
batch 600, loss: 0.4279, instance_loss: 0.1063, weighted_loss: 0.3314, label: 5, bag_size: 1262
batch 700, loss: 2.8581, instance_loss: 0.3720, weighted_loss: 2.1123, label: 3, bag_size: 1168
batch 800, loss: 1.4205, instance_loss: 0.2036, weighted_loss: 1.0554, label: 5, bag_size: 248
batch 900, loss: 1.4785, instance_loss: 0.2693, weighted_loss: 1.1158, label: 4, bag_size: 786
batch 1000, loss: 0.7611, instance_loss: 0.1161, weighted_loss: 0.5676, label: 5, bag_size: 1214
batch 1100, loss: 0.8645, instance_loss: 0.1436, weighted_loss: 0.6483, label: 5, bag_size: 460
batch 1200, loss: 0.1555, instance_loss: 0.0693, weighted_loss: 0.1296, label: 5, bag_size: 596
batch 1300, loss: 0.4936, instance_loss: 0.1187, weighted_loss: 0.3811, label: 2, bag_size: 1216
batch 1400, loss: 2.5957, instance_loss: 0.4519, weighted_loss: 1.9526, label: 6, bag_size: 1064
batch 1500, loss: 1.9439, instance_loss: 0.2887, weighted_loss: 1.4473, label: 8, bag_size: 563
batch 1600, loss: 0.1042, instance_loss: 0.0562, weighted_loss: 0.0898, label: 5, bag_size: 902
batch 1700, loss: 2.1804, instance_loss: 0.2603, weighted_loss: 1.6043, label: 2, bag_size: 393
batch 1800, loss: 0.3068, instance_loss: 0.0838, weighted_loss: 0.2399, label: 5, bag_size: 1045
batch 1900, loss: 1.2311, instance_loss: 0.2518, weighted_loss: 0.9373, label: 2, bag_size: 421
batch 2000, loss: 2.1096, instance_loss: 0.2758, weighted_loss: 1.5594, label: 8, bag_size: 368
batch 2100, loss: 1.9418, instance_loss: 0.3414, weighted_loss: 1.4617, label: 2, bag_size: 746

Instance Classifier Stats
class 0 clustering acc 0.9967270632593214: correct 190335/190960
class 1 clustering acc 0.16532258064516128: correct 2870/17360

Epoch: 75, train_loss: 1.3043, train_clustering_loss: 0.2087, train_error: 0.4608
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5918762088974855, correct fine 306/517 
fine class 3: fine acc 0.02666666666666667, correct fine 4/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.9033412887828163, correct fine 757/838 
fine class 6: fine acc 0.23293172690763053, correct fine 58/249 
fine class 7: fine acc 0.06741573033707865, correct fine 6/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5392

Val Set, val_loss: 1.4071, val_error: 0.4848, auc: 0.7877
class 0 clustering acc 0.9973743112947658: correct 23171/23232 
class 1 clustering acc 0.17045454545454544: correct 360/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.1, correct fine 3/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1555

Training for fine level...
batch 100, loss: 1.6314, instance_loss: 0.2849, weighted_loss: 1.2274, label: 3, bag_size: 1632
batch 200, loss: 0.2092, instance_loss: 0.0424, weighted_loss: 0.1591, label: 5, bag_size: 637
batch 300, loss: 3.1038, instance_loss: 0.3460, weighted_loss: 2.2765, label: 4, bag_size: 471
batch 400, loss: 1.6707, instance_loss: 0.2543, weighted_loss: 1.2458, label: 2, bag_size: 187
batch 500, loss: 0.3678, instance_loss: 0.1400, weighted_loss: 0.2994, label: 2, bag_size: 2536
batch 600, loss: 1.6709, instance_loss: 0.2730, weighted_loss: 1.2515, label: 7, bag_size: 590
batch 700, loss: 2.5108, instance_loss: 0.2663, weighted_loss: 1.8374, label: 6, bag_size: 259
batch 800, loss: 1.0075, instance_loss: 0.2896, weighted_loss: 0.7921, label: 3, bag_size: 2045
batch 900, loss: 0.5429, instance_loss: 0.1681, weighted_loss: 0.4304, label: 2, bag_size: 1101
batch 1000, loss: 1.5027, instance_loss: 0.2279, weighted_loss: 1.1203, label: 2, bag_size: 681
batch 1100, loss: 2.3786, instance_loss: 0.2928, weighted_loss: 1.7529, label: 8, bag_size: 195
batch 1200, loss: 3.1656, instance_loss: 0.3149, weighted_loss: 2.3104, label: 4, bag_size: 308
batch 1300, loss: 0.4763, instance_loss: 0.1219, weighted_loss: 0.3700, label: 2, bag_size: 3773
batch 1400, loss: 0.2879, instance_loss: 0.0661, weighted_loss: 0.2213, label: 5, bag_size: 812
batch 1500, loss: 2.3972, instance_loss: 0.3055, weighted_loss: 1.7697, label: 3, bag_size: 174
batch 1600, loss: 0.0657, instance_loss: 0.0354, weighted_loss: 0.0566, label: 5, bag_size: 1049
batch 1700, loss: 1.0722, instance_loss: 0.2263, weighted_loss: 0.8184, label: 5, bag_size: 182
batch 1800, loss: 3.8845, instance_loss: 0.4177, weighted_loss: 2.8445, label: 3, bag_size: 1134
batch 1900, loss: 0.6790, instance_loss: 0.1304, weighted_loss: 0.5144, label: 5, bag_size: 247
batch 2000, loss: 0.9598, instance_loss: 0.1342, weighted_loss: 0.7121, label: 5, bag_size: 253
batch 2100, loss: 1.1326, instance_loss: 0.2646, weighted_loss: 0.8722, label: 6, bag_size: 368

Instance Classifier Stats
class 0 clustering acc 0.9968475073313783: correct 190358/190960
class 1 clustering acc 0.16411290322580646: correct 2849/17360

Epoch: 76, train_loss: 1.3006, train_clustering_loss: 0.2083, train_error: 0.4571
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc 0.6189555125725339, correct fine 320/517 
fine class 3: fine acc 0.02, correct fine 3/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.8973747016706444, correct fine 752/838 
fine class 6: fine acc 0.22088353413654618, correct fine 55/249 
fine class 7: fine acc 0.0898876404494382, correct fine 8/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5429

Val Set, val_loss: 1.4059, val_error: 0.4735, auc: 0.7882
class 0 clustering acc 0.9973312672176309: correct 23170/23232 
class 1 clustering acc 0.17234848484848486: correct 364/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.9134615384615384, correct fine 95/104 
fine class 6: fine acc 0.13333333333333333, correct fine 4/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1618

Training for fine level...
batch 100, loss: 0.4931, instance_loss: 0.1466, weighted_loss: 0.3891, label: 2, bag_size: 1762
batch 200, loss: 0.9551, instance_loss: 0.1856, weighted_loss: 0.7242, label: 2, bag_size: 343
batch 300, loss: 1.1813, instance_loss: 0.2296, weighted_loss: 0.8958, label: 5, bag_size: 154
batch 400, loss: 3.5889, instance_loss: 0.3412, weighted_loss: 2.6146, label: 4, bag_size: 376
batch 500, loss: 3.1917, instance_loss: 0.2712, weighted_loss: 2.3155, label: 3, bag_size: 188
batch 600, loss: 1.0115, instance_loss: 0.1665, weighted_loss: 0.7580, label: 2, bag_size: 1049
batch 700, loss: 0.9857, instance_loss: 0.1351, weighted_loss: 0.7305, label: 5, bag_size: 240
batch 800, loss: 2.5415, instance_loss: 0.4310, weighted_loss: 1.9084, label: 0, bag_size: 901
batch 900, loss: 0.0332, instance_loss: 0.0336, weighted_loss: 0.0333, label: 5, bag_size: 699
batch 1000, loss: 2.6191, instance_loss: 0.3218, weighted_loss: 1.9299, label: 1, bag_size: 149
batch 1100, loss: 0.7216, instance_loss: 0.1856, weighted_loss: 0.5608, label: 5, bag_size: 396
batch 1200, loss: 0.1372, instance_loss: 0.0452, weighted_loss: 0.1096, label: 5, bag_size: 597
batch 1300, loss: 0.0786, instance_loss: 0.0593, weighted_loss: 0.0728, label: 5, bag_size: 278
batch 1400, loss: 1.0327, instance_loss: 0.1830, weighted_loss: 0.7778, label: 5, bag_size: 604
batch 1500, loss: 0.8948, instance_loss: 0.1808, weighted_loss: 0.6806, label: 5, bag_size: 344
batch 1600, loss: 1.5567, instance_loss: 0.2355, weighted_loss: 1.1603, label: 5, bag_size: 853
batch 1700, loss: 0.0240, instance_loss: 0.0281, weighted_loss: 0.0253, label: 5, bag_size: 329
batch 1800, loss: 0.1927, instance_loss: 0.0557, weighted_loss: 0.1516, label: 5, bag_size: 714
batch 1900, loss: 0.5903, instance_loss: 0.2427, weighted_loss: 0.4860, label: 6, bag_size: 732
batch 2000, loss: 0.0762, instance_loss: 0.0389, weighted_loss: 0.0650, label: 5, bag_size: 280
batch 2100, loss: 3.8346, instance_loss: 0.4647, weighted_loss: 2.8236, label: 8, bag_size: 380

Instance Classifier Stats
class 0 clustering acc 0.9966170925848346: correct 190314/190960
class 1 clustering acc 0.1675115207373272: correct 2908/17360

Epoch: 77, train_loss: 1.3002, train_clustering_loss: 0.2083, train_error: 0.4562
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.02666666666666667, correct fine 4/150 
fine class 4: fine acc 0.28695652173913044, correct fine 33/115 
fine class 5: fine acc 0.9045346062052506, correct fine 758/838 
fine class 6: fine acc 0.2289156626506024, correct fine 57/249 
fine class 7: fine acc 0.06741573033707865, correct fine 6/89 
fine class 8: fine acc 0.06818181818181818, correct fine 9/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5438

Val Set, val_loss: 1.4052, val_error: 0.4735, auc: 0.7877
class 0 clustering acc 0.9974173553719008: correct 23172/23232 
class 1 clustering acc 0.171875: correct 363/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1731

Training for fine level...
batch 100, loss: 0.0836, instance_loss: 0.0516, weighted_loss: 0.0740, label: 5, bag_size: 458
batch 200, loss: 1.6481, instance_loss: 0.2435, weighted_loss: 1.2268, label: 8, bag_size: 65
batch 300, loss: 2.8756, instance_loss: 0.2948, weighted_loss: 2.1013, label: 8, bag_size: 243
batch 400, loss: 1.0320, instance_loss: 0.2641, weighted_loss: 0.8016, label: 6, bag_size: 222
batch 500, loss: 0.8864, instance_loss: 0.1956, weighted_loss: 0.6792, label: 2, bag_size: 430
batch 600, loss: 1.3432, instance_loss: 0.2719, weighted_loss: 1.0218, label: 3, bag_size: 605
batch 700, loss: 1.2880, instance_loss: 0.2501, weighted_loss: 0.9766, label: 5, bag_size: 237
batch 800, loss: 1.7045, instance_loss: 0.2662, weighted_loss: 1.2730, label: 6, bag_size: 1865
batch 900, loss: 0.6721, instance_loss: 0.1330, weighted_loss: 0.5103, label: 2, bag_size: 757
batch 1000, loss: 0.5137, instance_loss: 0.1784, weighted_loss: 0.4131, label: 2, bag_size: 385
batch 1100, loss: 1.3752, instance_loss: 0.2409, weighted_loss: 1.0349, label: 6, bag_size: 316
batch 1200, loss: 1.1487, instance_loss: 0.2018, weighted_loss: 0.8646, label: 5, bag_size: 225
batch 1300, loss: 2.9392, instance_loss: 0.2998, weighted_loss: 2.1473, label: 3, bag_size: 972
batch 1400, loss: 0.4497, instance_loss: 0.1272, weighted_loss: 0.3530, label: 2, bag_size: 305
batch 1500, loss: 0.9240, instance_loss: 0.2356, weighted_loss: 0.7175, label: 6, bag_size: 351
batch 1600, loss: 0.9479, instance_loss: 0.1738, weighted_loss: 0.7157, label: 5, bag_size: 742
batch 1700, loss: 0.7661, instance_loss: 0.1953, weighted_loss: 0.5949, label: 2, bag_size: 729
batch 1800, loss: 4.6197, instance_loss: 0.4080, weighted_loss: 3.3562, label: 9, bag_size: 205
batch 1900, loss: 0.1830, instance_loss: 0.0760, weighted_loss: 0.1509, label: 5, bag_size: 643
batch 2000, loss: 0.2671, instance_loss: 0.0804, weighted_loss: 0.2111, label: 5, bag_size: 859
batch 2100, loss: 1.4917, instance_loss: 0.2566, weighted_loss: 1.1211, label: 6, bag_size: 689

Instance Classifier Stats
class 0 clustering acc 0.9967846669459572: correct 190346/190960
class 1 clustering acc 0.1690668202764977: correct 2935/17360

Epoch: 78, train_loss: 1.2976, train_clustering_loss: 0.2082, train_error: 0.4599
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc 0.5802707930367504, correct fine 300/517 
fine class 3: fine acc 0.02666666666666667, correct fine 4/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.9105011933174224, correct fine 763/838 
fine class 6: fine acc 0.23293172690763053, correct fine 58/249 
fine class 7: fine acc 0.07865168539325842, correct fine 7/89 
fine class 8: fine acc 0.06060606060606061, correct fine 8/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5401

Val Set, val_loss: 1.4060, val_error: 0.4848, auc: 0.7882
class 0 clustering acc 0.9976325757575758: correct 23177/23232 
class 1 clustering acc 0.1690340909090909: correct 357/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1622

Training for fine level...
batch 100, loss: 0.2443, instance_loss: 0.1061, weighted_loss: 0.2029, label: 5, bag_size: 324
batch 200, loss: 0.8017, instance_loss: 0.1338, weighted_loss: 0.6013, label: 5, bag_size: 833
batch 300, loss: 0.3725, instance_loss: 0.1223, weighted_loss: 0.2975, label: 2, bag_size: 1973
batch 400, loss: 0.2295, instance_loss: 0.0853, weighted_loss: 0.1862, label: 5, bag_size: 234
batch 500, loss: 1.2375, instance_loss: 0.2173, weighted_loss: 0.9314, label: 5, bag_size: 214
batch 600, loss: 0.4065, instance_loss: 0.1242, weighted_loss: 0.3218, label: 2, bag_size: 2186
batch 700, loss: 0.6664, instance_loss: 0.1519, weighted_loss: 0.5121, label: 2, bag_size: 112
batch 800, loss: 0.8469, instance_loss: 0.1279, weighted_loss: 0.6312, label: 5, bag_size: 1716
batch 900, loss: 1.5359, instance_loss: 0.2793, weighted_loss: 1.1589, label: 2, bag_size: 946
batch 1000, loss: 1.4224, instance_loss: 0.1758, weighted_loss: 1.0484, label: 5, bag_size: 734
batch 1100, loss: 1.7306, instance_loss: 0.3084, weighted_loss: 1.3039, label: 8, bag_size: 327
batch 1200, loss: 1.1146, instance_loss: 0.2279, weighted_loss: 0.8486, label: 5, bag_size: 334
batch 1300, loss: 0.8758, instance_loss: 0.1788, weighted_loss: 0.6667, label: 5, bag_size: 485
batch 1400, loss: 0.0987, instance_loss: 0.0424, weighted_loss: 0.0818, label: 5, bag_size: 444
batch 1500, loss: 0.0865, instance_loss: 0.0410, weighted_loss: 0.0728, label: 5, bag_size: 304
batch 1600, loss: 1.2830, instance_loss: 0.2059, weighted_loss: 0.9599, label: 2, bag_size: 347
batch 1700, loss: 3.1555, instance_loss: 0.2947, weighted_loss: 2.2973, label: 3, bag_size: 285
batch 1800, loss: 1.1829, instance_loss: 0.1546, weighted_loss: 0.8744, label: 2, bag_size: 1084
batch 1900, loss: 3.1926, instance_loss: 0.3875, weighted_loss: 2.3510, label: 7, bag_size: 462
batch 2000, loss: 0.1108, instance_loss: 0.0412, weighted_loss: 0.0900, label: 5, bag_size: 866
batch 2100, loss: 0.0933, instance_loss: 0.0495, weighted_loss: 0.0801, label: 5, bag_size: 819

Instance Classifier Stats
class 0 clustering acc 0.9968213238374529: correct 190353/190960
class 1 clustering acc 0.16624423963133642: correct 2886/17360

Epoch: 79, train_loss: 1.2950, train_clustering_loss: 0.2081, train_error: 0.4567
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.03333333333333333, correct fine 5/150 
fine class 4: fine acc 0.2956521739130435, correct fine 34/115 
fine class 5: fine acc 0.8914081145584726, correct fine 747/838 
fine class 6: fine acc 0.26506024096385544, correct fine 66/249 
fine class 7: fine acc 0.06741573033707865, correct fine 6/89 
fine class 8: fine acc 0.06060606060606061, correct fine 8/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5433

Val Set, val_loss: 1.4056, val_error: 0.4848, auc: 0.7881
class 0 clustering acc 0.9975034435261708: correct 23174/23232 
class 1 clustering acc 0.171875: correct 363/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.1, correct fine 3/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1553

Training for fine level...
batch 100, loss: 0.0792, instance_loss: 0.0375, weighted_loss: 0.0667, label: 5, bag_size: 495
batch 200, loss: 5.1373, instance_loss: 0.4746, weighted_loss: 3.7385, label: 4, bag_size: 510
batch 300, loss: 0.4566, instance_loss: 0.0913, weighted_loss: 0.3470, label: 5, bag_size: 814
batch 400, loss: 2.6613, instance_loss: 0.3189, weighted_loss: 1.9586, label: 8, bag_size: 388
batch 500, loss: 1.6604, instance_loss: 0.2521, weighted_loss: 1.2379, label: 8, bag_size: 285
batch 600, loss: 2.1871, instance_loss: 0.2921, weighted_loss: 1.6186, label: 8, bag_size: 571
batch 700, loss: 1.7195, instance_loss: 0.2685, weighted_loss: 1.2842, label: 6, bag_size: 559
batch 800, loss: 1.0496, instance_loss: 0.2414, weighted_loss: 0.8071, label: 4, bag_size: 542
batch 900, loss: 0.6063, instance_loss: 0.1204, weighted_loss: 0.4605, label: 2, bag_size: 2601
batch 1000, loss: 1.5199, instance_loss: 0.2229, weighted_loss: 1.1308, label: 6, bag_size: 2023
batch 1100, loss: 1.2250, instance_loss: 0.2291, weighted_loss: 0.9262, label: 5, bag_size: 518
batch 1200, loss: 1.1540, instance_loss: 0.1931, weighted_loss: 0.8657, label: 5, bag_size: 677
batch 1300, loss: 4.3875, instance_loss: 0.4303, weighted_loss: 3.2004, label: 8, bag_size: 589
batch 1400, loss: 0.1926, instance_loss: 0.0709, weighted_loss: 0.1561, label: 5, bag_size: 645
batch 1500, loss: 0.6229, instance_loss: 0.1444, weighted_loss: 0.4794, label: 2, bag_size: 623
batch 1600, loss: 0.5453, instance_loss: 0.2093, weighted_loss: 0.4445, label: 4, bag_size: 483
batch 1700, loss: 1.4232, instance_loss: 0.2144, weighted_loss: 1.0606, label: 5, bag_size: 311
batch 1800, loss: 3.6313, instance_loss: 0.2676, weighted_loss: 2.6222, label: 5, bag_size: 1206
batch 1900, loss: 0.0475, instance_loss: 0.0261, weighted_loss: 0.0411, label: 5, bag_size: 300
batch 2000, loss: 1.2328, instance_loss: 0.2829, weighted_loss: 0.9479, label: 6, bag_size: 138
batch 2100, loss: 1.2883, instance_loss: 0.2062, weighted_loss: 0.9636, label: 5, bag_size: 667

Instance Classifier Stats
class 0 clustering acc 0.996706116464181: correct 190331/190960
class 1 clustering acc 0.16549539170506913: correct 2873/17360

Epoch: 80, train_loss: 1.2961, train_clustering_loss: 0.2079, train_error: 0.4576
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc 0.6112185686653772, correct fine 316/517 
fine class 3: fine acc 0.02, correct fine 3/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.8985680190930787, correct fine 753/838 
fine class 6: fine acc 0.2248995983935743, correct fine 56/249 
fine class 7: fine acc 0.0898876404494382, correct fine 8/89 
fine class 8: fine acc 0.06060606060606061, correct fine 8/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5424

Val Set, val_loss: 1.4048, val_error: 0.4697, auc: 0.7883
class 0 clustering acc 0.9975464876033058: correct 23175/23232 
class 1 clustering acc 0.17140151515151514: correct 362/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.9038461538461539, correct fine 94/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5303
Overall F1 Score: 0.1740

Training for fine level...
batch 100, loss: 1.1804, instance_loss: 0.2618, weighted_loss: 0.9049, label: 4, bag_size: 467
batch 200, loss: 0.1632, instance_loss: 0.0544, weighted_loss: 0.1305, label: 5, bag_size: 827
batch 300, loss: 0.2985, instance_loss: 0.0782, weighted_loss: 0.2324, label: 5, bag_size: 661
batch 400, loss: 1.6560, instance_loss: 0.2156, weighted_loss: 1.2238, label: 2, bag_size: 435
batch 500, loss: 1.4982, instance_loss: 0.2533, weighted_loss: 1.1248, label: 2, bag_size: 618
batch 600, loss: 1.4245, instance_loss: 0.2417, weighted_loss: 1.0697, label: 2, bag_size: 304
batch 700, loss: 1.0556, instance_loss: 0.1524, weighted_loss: 0.7846, label: 5, bag_size: 465
batch 800, loss: 2.8845, instance_loss: 0.3065, weighted_loss: 2.1111, label: 7, bag_size: 521
batch 900, loss: 0.5541, instance_loss: 0.1298, weighted_loss: 0.4268, label: 5, bag_size: 620
batch 1000, loss: 3.1684, instance_loss: 0.3701, weighted_loss: 2.3289, label: 4, bag_size: 471
batch 1100, loss: 0.8020, instance_loss: 0.2602, weighted_loss: 0.6395, label: 3, bag_size: 554
batch 1200, loss: 3.5406, instance_loss: 0.3563, weighted_loss: 2.5853, label: 4, bag_size: 1030
batch 1300, loss: 1.3322, instance_loss: 0.2024, weighted_loss: 0.9933, label: 2, bag_size: 65
batch 1400, loss: 0.9365, instance_loss: 0.2450, weighted_loss: 0.7290, label: 6, bag_size: 171
batch 1500, loss: 1.1682, instance_loss: 0.2043, weighted_loss: 0.8790, label: 5, bag_size: 110
batch 1600, loss: 1.3578, instance_loss: 0.1702, weighted_loss: 1.0015, label: 5, bag_size: 347
batch 1700, loss: 1.7578, instance_loss: 0.2743, weighted_loss: 1.3127, label: 6, bag_size: 299
batch 1800, loss: 2.8396, instance_loss: 0.3016, weighted_loss: 2.0782, label: 6, bag_size: 246
batch 1900, loss: 0.1147, instance_loss: 0.0478, weighted_loss: 0.0946, label: 5, bag_size: 540
batch 2000, loss: 1.3071, instance_loss: 0.2233, weighted_loss: 0.9820, label: 2, bag_size: 472
batch 2100, loss: 0.4424, instance_loss: 0.1355, weighted_loss: 0.3503, label: 2, bag_size: 263

Instance Classifier Stats
class 0 clustering acc 0.9967584834520319: correct 190341/190960
class 1 clustering acc 0.16826036866359448: correct 2921/17360

Epoch: 81, train_loss: 1.2934, train_clustering_loss: 0.2078, train_error: 0.4548
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc 0.5996131528046421, correct fine 310/517 
fine class 3: fine acc 0.03333333333333333, correct fine 5/150 
fine class 4: fine acc 0.28695652173913044, correct fine 33/115 
fine class 5: fine acc 0.905727923627685, correct fine 759/838 
fine class 6: fine acc 0.24096385542168675, correct fine 60/249 
fine class 7: fine acc 0.07865168539325842, correct fine 7/89 
fine class 8: fine acc 0.06060606060606061, correct fine 8/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5452

Val Set, val_loss: 1.4049, val_error: 0.4773, auc: 0.7884
class 0 clustering acc 0.9975464876033058: correct 23175/23232 
class 1 clustering acc 0.17140151515151514: correct 362/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.8942307692307693, correct fine 93/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1640

Training for fine level...
batch 100, loss: 0.1797, instance_loss: 0.0629, weighted_loss: 0.1447, label: 5, bag_size: 643
batch 200, loss: 5.1430, instance_loss: 0.3998, weighted_loss: 3.7201, label: 7, bag_size: 981
batch 300, loss: 3.7193, instance_loss: 0.4207, weighted_loss: 2.7297, label: 10, bag_size: 309
batch 400, loss: 2.5282, instance_loss: 0.3821, weighted_loss: 1.8843, label: 6, bag_size: 414
batch 500, loss: 0.9807, instance_loss: 0.1941, weighted_loss: 0.7447, label: 5, bag_size: 125
batch 600, loss: 0.0637, instance_loss: 0.0406, weighted_loss: 0.0568, label: 5, bag_size: 682
batch 700, loss: 1.1652, instance_loss: 0.2052, weighted_loss: 0.8772, label: 5, bag_size: 110
batch 800, loss: 1.4595, instance_loss: 0.2472, weighted_loss: 1.0958, label: 8, bag_size: 415
batch 900, loss: 0.0762, instance_loss: 0.0397, weighted_loss: 0.0652, label: 5, bag_size: 724
batch 1000, loss: 1.2268, instance_loss: 0.2903, weighted_loss: 0.9458, label: 6, bag_size: 541
batch 1100, loss: 0.0417, instance_loss: 0.0270, weighted_loss: 0.0373, label: 5, bag_size: 448
batch 1200, loss: 0.1776, instance_loss: 0.0791, weighted_loss: 0.1480, label: 5, bag_size: 1221
batch 1300, loss: 0.5850, instance_loss: 0.1284, weighted_loss: 0.4480, label: 2, bag_size: 490
batch 1400, loss: 2.2412, instance_loss: 0.2409, weighted_loss: 1.6411, label: 5, bag_size: 116
batch 1500, loss: 2.9925, instance_loss: 0.2935, weighted_loss: 2.1828, label: 3, bag_size: 972
batch 1600, loss: 1.1357, instance_loss: 0.1686, weighted_loss: 0.8456, label: 5, bag_size: 373
batch 1700, loss: 0.2378, instance_loss: 0.1037, weighted_loss: 0.1976, label: 2, bag_size: 873
batch 1800, loss: 0.4368, instance_loss: 0.1111, weighted_loss: 0.3391, label: 2, bag_size: 214
batch 1900, loss: 1.8529, instance_loss: 0.2272, weighted_loss: 1.3652, label: 2, bag_size: 334
batch 2000, loss: 1.4910, instance_loss: 0.3228, weighted_loss: 1.1406, label: 2, bag_size: 1650
batch 2100, loss: 1.5203, instance_loss: 0.2927, weighted_loss: 1.1520, label: 2, bag_size: 946

Instance Classifier Stats
class 0 clustering acc 0.9967794302471722: correct 190345/190960
class 1 clustering acc 0.1672811059907834: correct 2904/17360

Epoch: 82, train_loss: 1.2905, train_clustering_loss: 0.2075, train_error: 0.4530
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.6034816247582205, correct fine 312/517 
fine class 3: fine acc 0.02666666666666667, correct fine 4/150 
fine class 4: fine acc 0.26956521739130435, correct fine 31/115 
fine class 5: fine acc 0.9081145584725537, correct fine 761/838 
fine class 6: fine acc 0.24497991967871485, correct fine 61/249 
fine class 7: fine acc 0.0898876404494382, correct fine 8/89 
fine class 8: fine acc 0.07575757575757576, correct fine 10/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5470

Val Set, val_loss: 1.4061, val_error: 0.4924, auc: 0.7883
class 0 clustering acc 0.9975464876033058: correct 23175/23232 
class 1 clustering acc 0.171875: correct 363/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.1, correct fine 3/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1536

Val error: 0.4697, ROC AUC: 0.7886
