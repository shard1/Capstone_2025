Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for fine level...
batch 100, loss: 8.1959, instance_loss: 0.7839, weighted_loss: 5.9723, label: 10, bag_size: 2314
batch 200, loss: 2.7387, instance_loss: 0.4743, weighted_loss: 2.0594, label: 8, bag_size: 378
batch 300, loss: 0.8148, instance_loss: 0.1644, weighted_loss: 0.6197, label: 5, bag_size: 742
batch 400, loss: 0.5570, instance_loss: 0.1583, weighted_loss: 0.4374, label: 5, bag_size: 673
batch 500, loss: 2.8018, instance_loss: 0.4248, weighted_loss: 2.0887, label: 3, bag_size: 1692
batch 600, loss: 2.9278, instance_loss: 0.3996, weighted_loss: 2.1694, label: 10, bag_size: 335
batch 700, loss: 1.1119, instance_loss: 0.2243, weighted_loss: 0.8456, label: 5, bag_size: 180
batch 800, loss: 0.3970, instance_loss: 0.0648, weighted_loss: 0.2973, label: 5, bag_size: 702
batch 900, loss: 1.7014, instance_loss: 0.3113, weighted_loss: 1.2843, label: 3, bag_size: 2005
batch 1000, loss: 0.1960, instance_loss: 0.0648, weighted_loss: 0.1566, label: 5, bag_size: 902
batch 1100, loss: 3.8569, instance_loss: 0.3970, weighted_loss: 2.8190, label: 7, bag_size: 618
batch 1200, loss: 1.5611, instance_loss: 0.3165, weighted_loss: 1.1877, label: 6, bag_size: 504
batch 1300, loss: 0.7285, instance_loss: 0.1869, weighted_loss: 0.5660, label: 2, bag_size: 193
batch 1400, loss: 2.5807, instance_loss: 0.3797, weighted_loss: 1.9204, label: 7, bag_size: 149
batch 1500, loss: 1.0642, instance_loss: 0.1489, weighted_loss: 0.7896, label: 2, bag_size: 592
batch 1600, loss: 2.3712, instance_loss: 0.3492, weighted_loss: 1.7646, label: 6, bag_size: 735
batch 1700, loss: 0.9202, instance_loss: 0.1559, weighted_loss: 0.6909, label: 2, bag_size: 1435
batch 1800, loss: 0.7685, instance_loss: 0.1276, weighted_loss: 0.5763, label: 2, bag_size: 2220
batch 1900, loss: 1.0320, instance_loss: 0.1870, weighted_loss: 0.7785, label: 5, bag_size: 269
batch 2000, loss: 1.2160, instance_loss: 0.2004, weighted_loss: 0.9113, label: 5, bag_size: 463
batch 2100, loss: 3.8005, instance_loss: 0.4731, weighted_loss: 2.8023, label: 10, bag_size: 574

Instance Classifier Stats
class 0 clustering acc 0.9958787180561374: correct 190173/190960
class 1 clustering acc 0.10783410138248847: correct 1872/17360

Epoch: 1, train_loss: 1.6232, train_clustering_loss: 0.2530, train_error: 0.5378
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc 0.504835589941973, correct fine 261/517 
fine class 3: fine acc 0.02666666666666667, correct fine 4/150 
fine class 4: fine acc 0.10434782608695652, correct fine 12/115 
fine class 5: fine acc 0.847255369928401, correct fine 710/838 
fine class 6: fine acc 0.05622489959839357, correct fine 14/249 
fine class 7: fine acc 0.0, correct fine 0/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4622

Val Set, val_loss: 1.5937, val_error: 0.5303, auc: 0.7829
class 0 clustering acc 0.9953512396694215: correct 23124/23232 
class 1 clustering acc 0.12263257575757576: correct 259/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.359375, correct fine 23/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.9326923076923077, correct fine 97/104 
fine class 6: fine acc 0.03333333333333333, correct fine 1/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4697
Overall F1 Score: 0.1185

Training for fine level...
batch 100, loss: 1.7423, instance_loss: 0.2376, weighted_loss: 1.2909, label: 2, bag_size: 235
batch 200, loss: 0.1249, instance_loss: 0.1091, weighted_loss: 0.1202, label: 2, bag_size: 206
batch 300, loss: 4.0415, instance_loss: 0.4842, weighted_loss: 2.9743, label: 1, bag_size: 67
batch 400, loss: 2.1814, instance_loss: 0.3767, weighted_loss: 1.6400, label: 7, bag_size: 438
batch 500, loss: 1.0810, instance_loss: 0.1946, weighted_loss: 0.8150, label: 5, bag_size: 408
batch 600, loss: 3.7928, instance_loss: 0.4434, weighted_loss: 2.7880, label: 1, bag_size: 369
batch 700, loss: 0.0007, instance_loss: 0.0032, weighted_loss: 0.0015, label: 5, bag_size: 651
batch 800, loss: 0.0243, instance_loss: 0.0195, weighted_loss: 0.0228, label: 5, bag_size: 620
batch 900, loss: 2.3276, instance_loss: 0.3311, weighted_loss: 1.7286, label: 3, bag_size: 1642
batch 1000, loss: 2.0922, instance_loss: 0.3011, weighted_loss: 1.5549, label: 2, bag_size: 374
batch 1100, loss: 1.5314, instance_loss: 0.2746, weighted_loss: 1.1544, label: 7, bag_size: 354
batch 1200, loss: 2.0029, instance_loss: 0.3710, weighted_loss: 1.5133, label: 4, bag_size: 1841
batch 1300, loss: 1.6645, instance_loss: 0.2743, weighted_loss: 1.2474, label: 6, bag_size: 2023
batch 1400, loss: 1.1079, instance_loss: 0.1765, weighted_loss: 0.8284, label: 2, bag_size: 691
batch 1500, loss: 0.9977, instance_loss: 0.2791, weighted_loss: 0.7821, label: 4, bag_size: 1079
batch 1600, loss: 1.4836, instance_loss: 0.2588, weighted_loss: 1.1162, label: 2, bag_size: 315
batch 1700, loss: 0.1199, instance_loss: 0.0413, weighted_loss: 0.0963, label: 5, bag_size: 289
batch 1800, loss: 1.8316, instance_loss: 0.2881, weighted_loss: 1.3686, label: 6, bag_size: 979
batch 1900, loss: 0.7683, instance_loss: 0.1181, weighted_loss: 0.5732, label: 5, bag_size: 854
batch 2000, loss: 1.4464, instance_loss: 0.2548, weighted_loss: 1.0889, label: 4, bag_size: 904
batch 2100, loss: 1.5910, instance_loss: 0.2744, weighted_loss: 1.1960, label: 2, bag_size: 629

Instance Classifier Stats
class 0 clustering acc 0.9955069124423963: correct 190102/190960
class 1 clustering acc 0.13047235023041476: correct 2265/17360

Epoch: 2, train_loss: 1.5333, train_clustering_loss: 0.2354, train_error: 0.5221
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5009671179883946, correct fine 259/517 
fine class 3: fine acc 0.02666666666666667, correct fine 4/150 
fine class 4: fine acc 0.21739130434782608, correct fine 25/115 
fine class 5: fine acc 0.8579952267303103, correct fine 719/838 
fine class 6: fine acc 0.10441767068273092, correct fine 26/249 
fine class 7: fine acc 0.011235955056179775, correct fine 1/89 
fine class 8: fine acc 0.022727272727272728, correct fine 3/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4779

Val Set, val_loss: 1.8655, val_error: 0.5114, auc: 0.7531
class 0 clustering acc 0.9990530303030303: correct 23210/23232 
class 1 clustering acc 0.01231060606060606: correct 26/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.4375, correct fine 28/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.9230769230769231, correct fine 96/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4886
Overall F1 Score: 0.1320

Training for fine level...
batch 100, loss: 3.7979, instance_loss: 0.4040, weighted_loss: 2.7797, label: 8, bag_size: 333
batch 200, loss: 1.6433, instance_loss: 0.3446, weighted_loss: 1.2537, label: 6, bag_size: 506
batch 300, loss: 0.8230, instance_loss: 0.2425, weighted_loss: 0.6489, label: 5, bag_size: 544
batch 400, loss: 0.2052, instance_loss: 0.0576, weighted_loss: 0.1609, label: 5, bag_size: 1217
batch 500, loss: 4.3353, instance_loss: 0.4661, weighted_loss: 3.1745, label: 4, bag_size: 1030
batch 600, loss: 2.4202, instance_loss: 0.3404, weighted_loss: 1.7962, label: 4, bag_size: 616
batch 700, loss: 2.6481, instance_loss: 0.4093, weighted_loss: 1.9764, label: 4, bag_size: 1460
batch 800, loss: 2.0585, instance_loss: 0.3060, weighted_loss: 1.5328, label: 7, bag_size: 528
batch 900, loss: 0.1864, instance_loss: 0.0730, weighted_loss: 0.1524, label: 5, bag_size: 752
batch 1000, loss: 5.6547, instance_loss: 0.6396, weighted_loss: 4.1502, label: 8, bag_size: 2813
batch 1100, loss: 0.0035, instance_loss: 0.0102, weighted_loss: 0.0055, label: 5, bag_size: 700
batch 1200, loss: 1.1001, instance_loss: 0.2317, weighted_loss: 0.8396, label: 6, bag_size: 247
batch 1300, loss: 0.0006, instance_loss: 0.0293, weighted_loss: 0.0092, label: 5, bag_size: 705
batch 1400, loss: 1.6109, instance_loss: 0.2461, weighted_loss: 1.2014, label: 2, bag_size: 298
batch 1500, loss: 1.9207, instance_loss: 0.3750, weighted_loss: 1.4570, label: 6, bag_size: 1235
batch 1600, loss: 1.4269, instance_loss: 0.2796, weighted_loss: 1.0827, label: 6, bag_size: 276
batch 1700, loss: 0.4844, instance_loss: 0.2619, weighted_loss: 0.4176, label: 4, bag_size: 714
batch 1800, loss: 1.4518, instance_loss: 0.2889, weighted_loss: 1.1029, label: 2, bag_size: 456
batch 1900, loss: 1.7843, instance_loss: 0.2865, weighted_loss: 1.3349, label: 6, bag_size: 346
batch 2000, loss: 0.7847, instance_loss: 0.1481, weighted_loss: 0.5937, label: 5, bag_size: 370
batch 2100, loss: 1.4102, instance_loss: 0.2714, weighted_loss: 1.0686, label: 3, bag_size: 292

Instance Classifier Stats
class 0 clustering acc 0.9962557603686636: correct 190245/190960
class 1 clustering acc 0.13266129032258064: correct 2303/17360

Epoch: 3, train_loss: 1.4776, train_clustering_loss: 0.2279, train_error: 0.5069
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5009671179883946, correct fine 259/517 
fine class 3: fine acc 0.06666666666666667, correct fine 10/150 
fine class 4: fine acc 0.16521739130434782, correct fine 19/115 
fine class 5: fine acc 0.883054892601432, correct fine 740/838 
fine class 6: fine acc 0.1606425702811245, correct fine 40/249 
fine class 7: fine acc 0.011235955056179775, correct fine 1/89 
fine class 8: fine acc 0.007575757575757576, correct fine 1/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4931

Val Set, val_loss: 1.7851, val_error: 0.5076, auc: 0.7467
class 0 clustering acc 0.999956955922865: correct 23231/23232 
class 1 clustering acc 0.015625: correct 33/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.05555555555555555, correct fine 1/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.7980769230769231, correct fine 83/104 
fine class 6: fine acc 0.23333333333333334, correct fine 7/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1560

Training for fine level...
batch 100, loss: 3.0486, instance_loss: 0.3283, weighted_loss: 2.2325, label: 4, bag_size: 155
batch 200, loss: 1.5349, instance_loss: 0.2821, weighted_loss: 1.1591, label: 2, bag_size: 456
batch 300, loss: 3.9897, instance_loss: 0.4396, weighted_loss: 2.9246, label: 10, bag_size: 162
batch 400, loss: 2.4865, instance_loss: 0.3075, weighted_loss: 1.8328, label: 7, bag_size: 478
batch 500, loss: 0.0340, instance_loss: 0.0461, weighted_loss: 0.0377, label: 5, bag_size: 555
batch 600, loss: 1.0540, instance_loss: 0.3897, weighted_loss: 0.8547, label: 7, bag_size: 1196
batch 700, loss: 0.7034, instance_loss: 0.1647, weighted_loss: 0.5418, label: 5, bag_size: 714
batch 800, loss: 1.1420, instance_loss: 0.1814, weighted_loss: 0.8538, label: 5, bag_size: 253
batch 900, loss: 1.3615, instance_loss: 0.3087, weighted_loss: 1.0457, label: 6, bag_size: 764
batch 1000, loss: 0.0005, instance_loss: 0.0368, weighted_loss: 0.0114, label: 5, bag_size: 442
batch 1100, loss: 1.0410, instance_loss: 0.2167, weighted_loss: 0.7937, label: 2, bag_size: 900
batch 1200, loss: 0.4082, instance_loss: 0.1779, weighted_loss: 0.3391, label: 5, bag_size: 1347
batch 1300, loss: 0.3156, instance_loss: 0.1323, weighted_loss: 0.2606, label: 2, bag_size: 265
batch 1400, loss: 1.4708, instance_loss: 0.2617, weighted_loss: 1.1081, label: 3, bag_size: 926
batch 1500, loss: 0.9155, instance_loss: 0.1420, weighted_loss: 0.6835, label: 5, bag_size: 377
batch 1600, loss: 2.0977, instance_loss: 0.2882, weighted_loss: 1.5548, label: 2, bag_size: 894
batch 1700, loss: 0.8111, instance_loss: 0.1704, weighted_loss: 0.6188, label: 5, bag_size: 753
batch 1800, loss: 3.6476, instance_loss: 0.4343, weighted_loss: 2.6836, label: 10, bag_size: 270
batch 1900, loss: 1.1610, instance_loss: 0.1947, weighted_loss: 0.8711, label: 5, bag_size: 229
batch 2000, loss: 0.8717, instance_loss: 0.1697, weighted_loss: 0.6611, label: 5, bag_size: 463
batch 2100, loss: 2.8253, instance_loss: 0.3045, weighted_loss: 2.0690, label: 6, bag_size: 563

Instance Classifier Stats
class 0 clustering acc 0.9964390448261417: correct 190280/190960
class 1 clustering acc 0.13807603686635944: correct 2397/17360

Epoch: 4, train_loss: 1.4307, train_clustering_loss: 0.2236, train_error: 0.4894
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5145067698259188, correct fine 266/517 
fine class 3: fine acc 0.04, correct fine 6/150 
fine class 4: fine acc 0.30434782608695654, correct fine 35/115 
fine class 5: fine acc 0.8842482100238663, correct fine 741/838 
fine class 6: fine acc 0.20481927710843373, correct fine 51/249 
fine class 7: fine acc 0.0449438202247191, correct fine 4/89 
fine class 8: fine acc 0.03787878787878788, correct fine 5/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5106

Val Set, val_loss: 2.0886, val_error: 0.5833, auc: 0.6137
class 0 clustering acc 0.9986225895316805: correct 23200/23232 
class 1 clustering acc 0.024147727272727272: correct 51/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.6875, correct fine 44/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.6057692307692307, correct fine 63/104 
fine class 6: fine acc 0.06666666666666667, correct fine 2/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4167
Overall F1 Score: 0.1124

Training for fine level...
batch 100, loss: 1.4537, instance_loss: 0.2309, weighted_loss: 1.0869, label: 2, bag_size: 566
batch 200, loss: 0.4519, instance_loss: 0.1187, weighted_loss: 0.3519, label: 5, bag_size: 368
batch 300, loss: 0.0376, instance_loss: 0.0513, weighted_loss: 0.0417, label: 5, bag_size: 332
batch 400, loss: 0.1951, instance_loss: 0.0707, weighted_loss: 0.1578, label: 5, bag_size: 256
batch 500, loss: 0.9708, instance_loss: 0.1815, weighted_loss: 0.7341, label: 5, bag_size: 729
batch 600, loss: 2.2000, instance_loss: 0.2134, weighted_loss: 1.6040, label: 5, bag_size: 1145
batch 700, loss: 0.0230, instance_loss: 0.0520, weighted_loss: 0.0317, label: 5, bag_size: 525
batch 800, loss: 3.3849, instance_loss: 0.3941, weighted_loss: 2.4876, label: 4, bag_size: 425
batch 900, loss: 1.5201, instance_loss: 0.2488, weighted_loss: 1.1387, label: 6, bag_size: 566
batch 1000, loss: 0.1717, instance_loss: 0.1648, weighted_loss: 0.1696, label: 2, bag_size: 1628
batch 1100, loss: 2.8120, instance_loss: 0.3204, weighted_loss: 2.0645, label: 8, bag_size: 435
batch 1200, loss: 1.1860, instance_loss: 0.1834, weighted_loss: 0.8852, label: 2, bag_size: 748
batch 1300, loss: 2.7585, instance_loss: 0.3476, weighted_loss: 2.0352, label: 3, bag_size: 837
batch 1400, loss: 0.0314, instance_loss: 0.0672, weighted_loss: 0.0421, label: 5, bag_size: 185
batch 1500, loss: 0.8393, instance_loss: 0.2687, weighted_loss: 0.6681, label: 7, bag_size: 172
batch 1600, loss: 1.5198, instance_loss: 0.2844, weighted_loss: 1.1492, label: 4, bag_size: 244
batch 1700, loss: 0.3044, instance_loss: 0.1389, weighted_loss: 0.2548, label: 5, bag_size: 753
batch 1800, loss: 1.8693, instance_loss: 0.2605, weighted_loss: 1.3866, label: 2, bag_size: 217
batch 1900, loss: 1.9200, instance_loss: 0.2917, weighted_loss: 1.4315, label: 3, bag_size: 775
batch 2000, loss: 2.1958, instance_loss: 0.2697, weighted_loss: 1.6180, label: 6, bag_size: 523
batch 2100, loss: 0.0046, instance_loss: 0.1624, weighted_loss: 0.0519, label: 5, bag_size: 473

Instance Classifier Stats
class 0 clustering acc 0.9960777126099707: correct 190211/190960
class 1 clustering acc 0.13652073732718895: correct 2370/17360

Epoch: 5, train_loss: 1.3788, train_clustering_loss: 0.2232, train_error: 0.4935
fine class 0: fine acc 0.08333333333333333, correct fine 1/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc 0.5241779497098646, correct fine 271/517 
fine class 3: fine acc 0.06, correct fine 9/150 
fine class 4: fine acc 0.24347826086956523, correct fine 28/115 
fine class 5: fine acc 0.8687350835322196, correct fine 728/838 
fine class 6: fine acc 0.18875502008032127, correct fine 47/249 
fine class 7: fine acc 0.12359550561797752, correct fine 11/89 
fine class 8: fine acc 0.030303030303030304, correct fine 4/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5065

Val Set, val_loss: 1.5540, val_error: 0.5265, auc: 0.7049
class 0 clustering acc 0.9982351928374655: correct 23191/23232 
class 1 clustering acc 0.05823863636363636: correct 123/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.40625, correct fine 26/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.7115384615384616, correct fine 74/104 
fine class 6: fine acc 0.5, correct fine 15/30 
fine class 7: fine acc 0.3, correct fine 3/10 
fine class 8: fine acc 0.25, correct fine 4/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4735
Overall F1 Score: 0.2017

Training for fine level...
batch 100, loss: 3.6988, instance_loss: 0.3501, weighted_loss: 2.6942, label: 6, bag_size: 252
batch 200, loss: 0.0306, instance_loss: 0.0703, weighted_loss: 0.0425, label: 5, bag_size: 97
batch 300, loss: 0.0687, instance_loss: 0.0528, weighted_loss: 0.0639, label: 5, bag_size: 2141
batch 400, loss: 1.0497, instance_loss: 0.1894, weighted_loss: 0.7916, label: 5, bag_size: 115
batch 500, loss: 0.0675, instance_loss: 0.0678, weighted_loss: 0.0676, label: 5, bag_size: 405
batch 600, loss: 0.7814, instance_loss: 0.1223, weighted_loss: 0.5837, label: 5, bag_size: 576
batch 700, loss: 2.4421, instance_loss: 0.3413, weighted_loss: 1.8119, label: 3, bag_size: 197
batch 800, loss: 0.4053, instance_loss: 0.1407, weighted_loss: 0.3259, label: 5, bag_size: 482
batch 900, loss: 0.7656, instance_loss: 0.1566, weighted_loss: 0.5829, label: 5, bag_size: 667
batch 1000, loss: 0.8013, instance_loss: 0.2027, weighted_loss: 0.6217, label: 6, bag_size: 411
batch 1100, loss: 1.3105, instance_loss: 0.2831, weighted_loss: 1.0023, label: 4, bag_size: 2219
batch 1200, loss: 2.6074, instance_loss: 0.3170, weighted_loss: 1.9202, label: 6, bag_size: 492
batch 1300, loss: 0.8490, instance_loss: 0.1985, weighted_loss: 0.6539, label: 6, bag_size: 206
batch 1400, loss: 0.7399, instance_loss: 0.1981, weighted_loss: 0.5774, label: 6, bag_size: 344
batch 1500, loss: 1.2647, instance_loss: 0.2937, weighted_loss: 0.9734, label: 4, bag_size: 1867
batch 1600, loss: 0.0177, instance_loss: 0.0490, weighted_loss: 0.0271, label: 5, bag_size: 437
batch 1700, loss: 0.7899, instance_loss: 0.1408, weighted_loss: 0.5952, label: 5, bag_size: 332
batch 1800, loss: 0.8132, instance_loss: 0.1956, weighted_loss: 0.6280, label: 5, bag_size: 308
batch 1900, loss: 0.5198, instance_loss: 0.2017, weighted_loss: 0.4243, label: 5, bag_size: 393
batch 2000, loss: 1.6662, instance_loss: 0.2003, weighted_loss: 1.2264, label: 5, bag_size: 248
batch 2100, loss: 0.3516, instance_loss: 0.0901, weighted_loss: 0.2731, label: 5, bag_size: 819

Instance Classifier Stats
class 0 clustering acc 0.9961719731881022: correct 190229/190960
class 1 clustering acc 0.12908986175115209: correct 2241/17360

Epoch: 6, train_loss: 1.3420, train_clustering_loss: 0.2250, train_error: 0.4668
fine class 0: fine acc 0.25, correct fine 3/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc 0.574468085106383, correct fine 297/517 
fine class 3: fine acc 0.10666666666666667, correct fine 16/150 
fine class 4: fine acc 0.2782608695652174, correct fine 32/115 
fine class 5: fine acc 0.8424821002386634, correct fine 706/838 
fine class 6: fine acc 0.2971887550200803, correct fine 74/249 
fine class 7: fine acc 0.19101123595505617, correct fine 17/89 
fine class 8: fine acc 0.05303030303030303, correct fine 7/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5332

Val Set, val_loss: 1.5078, val_error: 0.4697, auc: 0.6969
class 0 clustering acc 0.9916924931129476: correct 23039/23232 
class 1 clustering acc 0.19507575757575757: correct 412/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.875, correct fine 91/104 
fine class 6: fine acc 0.3, correct fine 9/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5303
Overall F1 Score: 0.1556

Training for fine level...
batch 100, loss: 0.6439, instance_loss: 0.1850, weighted_loss: 0.5062, label: 5, bag_size: 743
batch 200, loss: 0.0194, instance_loss: 0.2026, weighted_loss: 0.0743, label: 5, bag_size: 271
batch 300, loss: 0.0304, instance_loss: 0.0649, weighted_loss: 0.0407, label: 5, bag_size: 542
batch 400, loss: 1.9764, instance_loss: 0.2866, weighted_loss: 1.4694, label: 6, bag_size: 320
batch 500, loss: 3.7624, instance_loss: 0.3212, weighted_loss: 2.7300, label: 3, bag_size: 522
batch 600, loss: 1.8088, instance_loss: 0.2394, weighted_loss: 1.3380, label: 2, bag_size: 123
batch 700, loss: 0.3583, instance_loss: 0.1176, weighted_loss: 0.2861, label: 2, bag_size: 1359
batch 800, loss: 0.7674, instance_loss: 0.2170, weighted_loss: 0.6023, label: 5, bag_size: 276
batch 900, loss: 3.0072, instance_loss: 0.2654, weighted_loss: 2.1847, label: 6, bag_size: 281
batch 1000, loss: 0.0122, instance_loss: 0.0232, weighted_loss: 0.0155, label: 5, bag_size: 458
batch 1100, loss: 0.1742, instance_loss: 0.1048, weighted_loss: 0.1534, label: 5, bag_size: 1023
batch 1200, loss: 1.0530, instance_loss: 0.3165, weighted_loss: 0.8320, label: 8, bag_size: 1342
batch 1300, loss: 1.1883, instance_loss: 0.2494, weighted_loss: 0.9067, label: 8, bag_size: 198
batch 1400, loss: 2.0656, instance_loss: 0.3029, weighted_loss: 1.5368, label: 6, bag_size: 361
batch 1500, loss: 1.3883, instance_loss: 0.1965, weighted_loss: 1.0307, label: 2, bag_size: 927
batch 1600, loss: 0.8677, instance_loss: 0.1850, weighted_loss: 0.6629, label: 5, bag_size: 1246
batch 1700, loss: 3.3718, instance_loss: 0.3298, weighted_loss: 2.4592, label: 3, bag_size: 175
batch 1800, loss: 0.0397, instance_loss: 0.3111, weighted_loss: 0.1211, label: 4, bag_size: 278
batch 1900, loss: 1.0227, instance_loss: 0.2113, weighted_loss: 0.7793, label: 5, bag_size: 499
batch 2000, loss: 1.6273, instance_loss: 0.2809, weighted_loss: 1.2234, label: 2, bag_size: 328
batch 2100, loss: 1.2789, instance_loss: 0.2998, weighted_loss: 0.9852, label: 3, bag_size: 901

Instance Classifier Stats
class 0 clustering acc 0.9957425638877252: correct 190147/190960
class 1 clustering acc 0.1390552995391705: correct 2414/17360

Epoch: 7, train_loss: 1.2734, train_clustering_loss: 0.2243, train_error: 0.4512
fine class 0: fine acc 0.25, correct fine 3/12 
fine class 1: fine acc 0.09375, correct fine 3/32 
fine class 2: fine acc 0.5841392649903289, correct fine 302/517 
fine class 3: fine acc 0.12666666666666668, correct fine 19/150 
fine class 4: fine acc 0.33043478260869563, correct fine 38/115 
fine class 5: fine acc 0.8568019093078759, correct fine 718/838 
fine class 6: fine acc 0.3092369477911647, correct fine 77/249 
fine class 7: fine acc 0.2247191011235955, correct fine 20/89 
fine class 8: fine acc 0.06818181818181818, correct fine 9/132 
fine class 9: fine acc 0.1, correct fine 1/10 
fine class 10: fine acc 0.038461538461538464, correct fine 1/26 
Overall Accuracy: 0.5488

Val Set, val_loss: 1.5467, val_error: 0.4735, auc: 0.6883
class 0 clustering acc 0.9942751377410468: correct 23099/23232 
class 1 clustering acc 0.140625: correct 297/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8846153846153846, correct fine 92/104 
fine class 6: fine acc 0.23333333333333334, correct fine 7/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1524

Training for fine level...
batch 100, loss: 0.5462, instance_loss: 0.1297, weighted_loss: 0.4212, label: 5, bag_size: 431
batch 200, loss: 0.6112, instance_loss: 0.1199, weighted_loss: 0.4638, label: 2, bag_size: 1531
batch 300, loss: 2.3311, instance_loss: 0.3629, weighted_loss: 1.7407, label: 7, bag_size: 139
batch 400, loss: 1.0134, instance_loss: 0.1960, weighted_loss: 0.7682, label: 2, bag_size: 671
batch 500, loss: 0.8660, instance_loss: 0.2278, weighted_loss: 0.6745, label: 3, bag_size: 2302
batch 600, loss: 0.1781, instance_loss: 0.1498, weighted_loss: 0.1696, label: 2, bag_size: 1447
batch 700, loss: 0.8535, instance_loss: 0.2662, weighted_loss: 0.6773, label: 6, bag_size: 334
batch 800, loss: 0.0163, instance_loss: 0.0289, weighted_loss: 0.0201, label: 5, bag_size: 658
batch 900, loss: 0.7641, instance_loss: 0.1291, weighted_loss: 0.5736, label: 5, bag_size: 462
batch 1000, loss: 1.0739, instance_loss: 0.2289, weighted_loss: 0.8204, label: 2, bag_size: 1257
batch 1100, loss: 0.1192, instance_loss: 0.1238, weighted_loss: 0.1205, label: 2, bag_size: 706
batch 1200, loss: 1.4760, instance_loss: 0.3751, weighted_loss: 1.1458, label: 6, bag_size: 2023
batch 1300, loss: 1.3489, instance_loss: 0.2091, weighted_loss: 1.0069, label: 5, bag_size: 180
batch 1400, loss: 0.0132, instance_loss: 0.0572, weighted_loss: 0.0264, label: 5, bag_size: 439
batch 1500, loss: 0.7685, instance_loss: 0.2004, weighted_loss: 0.5981, label: 2, bag_size: 1269
batch 1600, loss: 3.4492, instance_loss: 0.3731, weighted_loss: 2.5264, label: 4, bag_size: 525
batch 1700, loss: 0.9926, instance_loss: 0.1757, weighted_loss: 0.7475, label: 5, bag_size: 328
batch 1800, loss: 3.2209, instance_loss: 0.3225, weighted_loss: 2.3514, label: 8, bag_size: 457
batch 1900, loss: 0.0006, instance_loss: 0.0218, weighted_loss: 0.0070, label: 5, bag_size: 495
batch 2000, loss: 1.1388, instance_loss: 0.1735, weighted_loss: 0.8493, label: 5, bag_size: 297
batch 2100, loss: 0.0400, instance_loss: 0.0651, weighted_loss: 0.0475, label: 5, bag_size: 290

Instance Classifier Stats
class 0 clustering acc 0.9955540427314621: correct 190111/190960
class 1 clustering acc 0.15069124423963134: correct 2616/17360

Epoch: 8, train_loss: 1.2039, train_clustering_loss: 0.2203, train_error: 0.4226
fine class 0: fine acc 0.5, correct fine 6/12 
fine class 1: fine acc 0.1875, correct fine 6/32 
fine class 2: fine acc 0.5938104448742747, correct fine 307/517 
fine class 3: fine acc 0.2, correct fine 30/150 
fine class 4: fine acc 0.43478260869565216, correct fine 50/115 
fine class 5: fine acc 0.837708830548926, correct fine 702/838 
fine class 6: fine acc 0.3895582329317269, correct fine 97/249 
fine class 7: fine acc 0.33707865168539325, correct fine 30/89 
fine class 8: fine acc 0.1590909090909091, correct fine 21/132 
fine class 9: fine acc 0.0, correct fine 0/10 
fine class 10: fine acc 0.15384615384615385, correct fine 4/26 
Overall Accuracy: 0.5774

Val Set, val_loss: 1.6177, val_error: 0.4659, auc: 0.6756
class 0 clustering acc 0.9939307851239669: correct 23091/23232 
class 1 clustering acc 0.1534090909090909: correct 324/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.65625, correct fine 42/64 
fine class 3: fine acc 0.1111111111111111, correct fine 2/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.7884615384615384, correct fine 82/104 
fine class 6: fine acc 0.26666666666666666, correct fine 8/30 
fine class 7: fine acc 0.3, correct fine 3/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5341
Overall F1 Score: 0.2254

Training for fine level...
batch 100, loss: 0.7255, instance_loss: 0.1854, weighted_loss: 0.5635, label: 5, bag_size: 1600
batch 200, loss: 2.1070, instance_loss: 0.2742, weighted_loss: 1.5571, label: 2, bag_size: 544
batch 300, loss: 0.7206, instance_loss: 0.1420, weighted_loss: 0.5470, label: 5, bag_size: 333
batch 400, loss: 1.9838, instance_loss: 0.3147, weighted_loss: 1.4831, label: 3, bag_size: 401
batch 500, loss: 0.0007, instance_loss: 0.0489, weighted_loss: 0.0152, label: 2, bag_size: 235
batch 600, loss: 0.1375, instance_loss: 0.1967, weighted_loss: 0.1552, label: 6, bag_size: 156
batch 700, loss: 0.0143, instance_loss: 0.1114, weighted_loss: 0.0434, label: 5, bag_size: 905
batch 800, loss: 0.4717, instance_loss: 0.1138, weighted_loss: 0.3644, label: 5, bag_size: 342
batch 900, loss: 0.0000, instance_loss: 0.0069, weighted_loss: 0.0021, label: 5, bag_size: 539
batch 1000, loss: 0.3446, instance_loss: 0.1559, weighted_loss: 0.2880, label: 2, bag_size: 833
batch 1100, loss: 0.5028, instance_loss: 0.2237, weighted_loss: 0.4190, label: 6, bag_size: 326
batch 1200, loss: 0.0161, instance_loss: 0.0776, weighted_loss: 0.0345, label: 5, bag_size: 331
batch 1300, loss: 6.0995, instance_loss: 0.3723, weighted_loss: 4.3813, label: 4, bag_size: 665
batch 1400, loss: 1.6581, instance_loss: 0.3580, weighted_loss: 1.2681, label: 7, bag_size: 210
batch 1500, loss: 0.0081, instance_loss: 0.0469, weighted_loss: 0.0197, label: 5, bag_size: 764
batch 1600, loss: 0.5192, instance_loss: 0.2960, weighted_loss: 0.4522, label: 6, bag_size: 346
batch 1700, loss: 1.1698, instance_loss: 0.3410, weighted_loss: 0.9212, label: 8, bag_size: 130
batch 1800, loss: 0.0004, instance_loss: 0.0493, weighted_loss: 0.0150, label: 5, bag_size: 887
batch 1900, loss: 1.3100, instance_loss: 0.2507, weighted_loss: 0.9922, label: 6, bag_size: 129
batch 2000, loss: 0.4594, instance_loss: 0.2573, weighted_loss: 0.3987, label: 3, bag_size: 1781
batch 2100, loss: 0.5596, instance_loss: 0.1175, weighted_loss: 0.4270, label: 5, bag_size: 433

Instance Classifier Stats
class 0 clustering acc 0.995548806032677: correct 190110/190960
class 1 clustering acc 0.15236175115207373: correct 2645/17360

Epoch: 9, train_loss: 1.1299, train_clustering_loss: 0.2203, train_error: 0.3982
fine class 0: fine acc 0.5833333333333334, correct fine 7/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc 0.6247582205029013, correct fine 323/517 
fine class 3: fine acc 0.3, correct fine 45/150 
fine class 4: fine acc 0.4608695652173913, correct fine 53/115 
fine class 5: fine acc 0.8579952267303103, correct fine 719/838 
fine class 6: fine acc 0.3815261044176707, correct fine 95/249 
fine class 7: fine acc 0.30337078651685395, correct fine 27/89 
fine class 8: fine acc 0.1590909090909091, correct fine 21/132 
fine class 9: fine acc 0.3, correct fine 3/10 
fine class 10: fine acc 0.19230769230769232, correct fine 5/26 
Overall Accuracy: 0.6018

Val Set, val_loss: 1.6600, val_error: 0.4811, auc: 0.6905
class 0 clustering acc 0.9945764462809917: correct 23106/23232 
class 1 clustering acc 0.13825757575757575: correct 292/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.8365384615384616, correct fine 87/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.4, correct fine 4/10 
fine class 8: fine acc 0.125, correct fine 2/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5189
Overall F1 Score: 0.2161

Training for fine level...
batch 100, loss: 0.1193, instance_loss: 0.1430, weighted_loss: 0.1264, label: 5, bag_size: 721
batch 200, loss: 0.0359, instance_loss: 0.1131, weighted_loss: 0.0590, label: 5, bag_size: 1217
batch 300, loss: 1.2775, instance_loss: 0.3410, weighted_loss: 0.9965, label: 3, bag_size: 2045
batch 400, loss: 0.0611, instance_loss: 0.1716, weighted_loss: 0.0942, label: 5, bag_size: 667
batch 500, loss: 0.2114, instance_loss: 0.0883, weighted_loss: 0.1745, label: 5, bag_size: 249
batch 600, loss: 2.1863, instance_loss: 0.1696, weighted_loss: 1.5813, label: 5, bag_size: 244
batch 700, loss: 0.6510, instance_loss: 0.1947, weighted_loss: 0.5141, label: 3, bag_size: 901
batch 800, loss: 2.4253, instance_loss: 0.2703, weighted_loss: 1.7788, label: 2, bag_size: 356
batch 900, loss: 0.7269, instance_loss: 0.1120, weighted_loss: 0.5424, label: 5, bag_size: 331
batch 1000, loss: 0.0000, instance_loss: 0.1479, weighted_loss: 0.0444, label: 5, bag_size: 473
batch 1100, loss: 0.0559, instance_loss: 0.0488, weighted_loss: 0.0537, label: 5, bag_size: 462
batch 1200, loss: 2.2651, instance_loss: 0.3231, weighted_loss: 1.6825, label: 3, bag_size: 234
batch 1300, loss: 0.1010, instance_loss: 0.1906, weighted_loss: 0.1279, label: 5, bag_size: 2032
batch 1400, loss: 0.4969, instance_loss: 0.1387, weighted_loss: 0.3895, label: 5, bag_size: 1214
batch 1500, loss: 0.2236, instance_loss: 0.2051, weighted_loss: 0.2181, label: 5, bag_size: 841
batch 1600, loss: 1.5661, instance_loss: 0.2168, weighted_loss: 1.1613, label: 5, bag_size: 174
batch 1700, loss: 0.9961, instance_loss: 0.2424, weighted_loss: 0.7700, label: 6, bag_size: 979
batch 1800, loss: 0.0253, instance_loss: 0.3454, weighted_loss: 0.1214, label: 0, bag_size: 37
batch 1900, loss: 0.0235, instance_loss: 0.2704, weighted_loss: 0.0976, label: 4, bag_size: 1204
batch 2000, loss: 1.3010, instance_loss: 0.2400, weighted_loss: 0.9827, label: 6, bag_size: 689
batch 2100, loss: 2.7850, instance_loss: 0.3398, weighted_loss: 2.0514, label: 3, bag_size: 522

Instance Classifier Stats
class 0 clustering acc 0.9948313782991203: correct 189973/190960
class 1 clustering acc 0.16134792626728112: correct 2801/17360

Epoch: 10, train_loss: 1.0434, train_clustering_loss: 0.2190, train_error: 0.3677
fine class 0: fine acc 0.5, correct fine 6/12 
fine class 1: fine acc 0.375, correct fine 12/32 
fine class 2: fine acc 0.6402321083172147, correct fine 331/517 
fine class 3: fine acc 0.36, correct fine 54/150 
fine class 4: fine acc 0.5652173913043478, correct fine 65/115 
fine class 5: fine acc 0.8460620525059666, correct fine 709/838 
fine class 6: fine acc 0.46987951807228917, correct fine 117/249 
fine class 7: fine acc 0.3595505617977528, correct fine 32/89 
fine class 8: fine acc 0.24242424242424243, correct fine 32/132 
fine class 9: fine acc 0.3, correct fine 3/10 
fine class 10: fine acc 0.4230769230769231, correct fine 11/26 
Overall Accuracy: 0.6323

Val Set, val_loss: 2.0575, val_error: 0.5417, auc: 0.6455
class 0 clustering acc 0.9922951101928374: correct 23053/23232 
class 1 clustering acc 0.15009469696969696: correct 317/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.375, correct fine 24/64 
fine class 3: fine acc 0.1111111111111111, correct fine 2/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8173076923076923, correct fine 85/104 
fine class 6: fine acc 0.13333333333333333, correct fine 4/30 
fine class 7: fine acc 0.1, correct fine 1/10 
fine class 8: fine acc 0.25, correct fine 4/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4583
Overall F1 Score: 0.1691

Training for fine level...
batch 100, loss: 2.1053, instance_loss: 0.2816, weighted_loss: 1.5582, label: 6, bag_size: 581
batch 200, loss: 1.2852, instance_loss: 0.1770, weighted_loss: 0.9527, label: 5, bag_size: 332
batch 300, loss: 4.0993, instance_loss: 0.4878, weighted_loss: 3.0159, label: 10, bag_size: 574
batch 400, loss: 1.3328, instance_loss: 0.2414, weighted_loss: 1.0053, label: 5, bag_size: 968
batch 500, loss: 3.1307, instance_loss: 0.2044, weighted_loss: 2.2528, label: 5, bag_size: 513
batch 600, loss: 2.8171, instance_loss: 0.2940, weighted_loss: 2.0602, label: 6, bag_size: 304
batch 700, loss: 0.0023, instance_loss: 0.2571, weighted_loss: 0.0787, label: 6, bag_size: 787
batch 800, loss: 0.8879, instance_loss: 0.2071, weighted_loss: 0.6837, label: 5, bag_size: 929
batch 900, loss: 0.3929, instance_loss: 0.1439, weighted_loss: 0.3182, label: 2, bag_size: 252
batch 1000, loss: 1.0299, instance_loss: 0.2429, weighted_loss: 0.7938, label: 2, bag_size: 193
batch 1100, loss: 0.6138, instance_loss: 0.2471, weighted_loss: 0.5038, label: 6, bag_size: 896
batch 1200, loss: 0.0191, instance_loss: 0.0647, weighted_loss: 0.0328, label: 5, bag_size: 458
batch 1300, loss: 0.4158, instance_loss: 0.1794, weighted_loss: 0.3449, label: 5, bag_size: 178
batch 1400, loss: 0.1261, instance_loss: 0.1883, weighted_loss: 0.1448, label: 8, bag_size: 120
batch 1500, loss: 1.5776, instance_loss: 0.3064, weighted_loss: 1.1962, label: 8, bag_size: 558
batch 1600, loss: 1.2701, instance_loss: 0.2700, weighted_loss: 0.9700, label: 6, bag_size: 396
batch 1700, loss: 1.7467, instance_loss: 0.3045, weighted_loss: 1.3140, label: 6, bag_size: 2046
batch 1800, loss: 1.4925, instance_loss: 0.2644, weighted_loss: 1.1240, label: 6, bag_size: 764
batch 1900, loss: 0.0000, instance_loss: 0.1127, weighted_loss: 0.0338, label: 5, bag_size: 129
batch 2000, loss: 1.4440, instance_loss: 0.2774, weighted_loss: 1.0940, label: 2, bag_size: 823
batch 2100, loss: 0.9152, instance_loss: 0.2158, weighted_loss: 0.7054, label: 2, bag_size: 1767

Instance Classifier Stats
class 0 clustering acc 0.9951560536237956: correct 190035/190960
class 1 clustering acc 0.17649769585253455: correct 3064/17360

Epoch: 11, train_loss: 0.9727, train_clustering_loss: 0.2164, train_error: 0.3429
fine class 0: fine acc 0.75, correct fine 9/12 
fine class 1: fine acc 0.375, correct fine 12/32 
fine class 2: fine acc 0.6615087040618955, correct fine 342/517 
fine class 3: fine acc 0.43333333333333335, correct fine 65/150 
fine class 4: fine acc 0.5739130434782609, correct fine 66/115 
fine class 5: fine acc 0.8627684964200477, correct fine 723/838 
fine class 6: fine acc 0.46586345381526106, correct fine 116/249 
fine class 7: fine acc 0.42696629213483145, correct fine 38/89 
fine class 8: fine acc 0.3181818181818182, correct fine 42/132 
fine class 9: fine acc 0.2, correct fine 2/10 
fine class 10: fine acc 0.4230769230769231, correct fine 11/26 
Overall Accuracy: 0.6571

Val Set, val_loss: 1.9497, val_error: 0.5492, auc: 0.6680
class 0 clustering acc 0.9957386363636364: correct 23133/23232 
class 1 clustering acc 0.11931818181818182: correct 252/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.6153846153846154, correct fine 64/104 
fine class 6: fine acc 0.4, correct fine 12/30 
fine class 7: fine acc 0.2, correct fine 2/10 
fine class 8: fine acc 0.125, correct fine 2/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4508
Overall F1 Score: 0.1778

Training for fine level...
batch 100, loss: 0.2647, instance_loss: 0.3850, weighted_loss: 0.3008, label: 4, bag_size: 889
batch 200, loss: 0.2273, instance_loss: 0.1850, weighted_loss: 0.2146, label: 2, bag_size: 631
batch 300, loss: 1.1623, instance_loss: 0.1684, weighted_loss: 0.8642, label: 5, bag_size: 297
batch 400, loss: 1.0971, instance_loss: 0.2013, weighted_loss: 0.8284, label: 5, bag_size: 1798
batch 500, loss: 2.2079, instance_loss: 0.2955, weighted_loss: 1.6342, label: 8, bag_size: 299
batch 600, loss: 0.6706, instance_loss: 0.2557, weighted_loss: 0.5462, label: 6, bag_size: 276
batch 700, loss: 2.5295, instance_loss: 0.2331, weighted_loss: 1.8406, label: 5, bag_size: 1364
batch 800, loss: 0.0000, instance_loss: 0.0180, weighted_loss: 0.0054, label: 5, bag_size: 381
batch 900, loss: 0.0516, instance_loss: 0.2908, weighted_loss: 0.1233, label: 5, bag_size: 1426
batch 1000, loss: 0.1804, instance_loss: 0.1305, weighted_loss: 0.1655, label: 5, bag_size: 333
batch 1100, loss: 2.1893, instance_loss: 0.2506, weighted_loss: 1.6077, label: 8, bag_size: 415
batch 1200, loss: 0.0015, instance_loss: 0.3137, weighted_loss: 0.0951, label: 4, bag_size: 287
batch 1300, loss: 0.1050, instance_loss: 0.2433, weighted_loss: 0.1465, label: 6, bag_size: 669
batch 1400, loss: 0.5313, instance_loss: 0.1590, weighted_loss: 0.4196, label: 2, bag_size: 826
batch 1500, loss: 0.0004, instance_loss: 0.3309, weighted_loss: 0.0996, label: 3, bag_size: 188
batch 1600, loss: 2.0411, instance_loss: 0.2160, weighted_loss: 1.4935, label: 5, bag_size: 69
batch 1700, loss: 0.2844, instance_loss: 0.1161, weighted_loss: 0.2339, label: 5, bag_size: 568
batch 1800, loss: 4.8757, instance_loss: 0.4034, weighted_loss: 3.5340, label: 1, bag_size: 67
batch 1900, loss: 0.4833, instance_loss: 0.1712, weighted_loss: 0.3896, label: 2, bag_size: 1293
batch 2000, loss: 0.0002, instance_loss: 0.1083, weighted_loss: 0.0326, label: 2, bag_size: 2536
batch 2100, loss: 0.4368, instance_loss: 0.1206, weighted_loss: 0.3419, label: 5, bag_size: 393

Instance Classifier Stats
class 0 clustering acc 0.9948942186845413: correct 189985/190960
class 1 clustering acc 0.1972926267281106: correct 3425/17360

Epoch: 12, train_loss: 0.8789, train_clustering_loss: 0.2115, train_error: 0.3207
fine class 0: fine acc 0.5833333333333334, correct fine 7/12 
fine class 1: fine acc 0.375, correct fine 12/32 
fine class 2: fine acc 0.7117988394584139, correct fine 368/517 
fine class 3: fine acc 0.43333333333333335, correct fine 65/150 
fine class 4: fine acc 0.6086956521739131, correct fine 70/115 
fine class 5: fine acc 0.8484486873508353, correct fine 711/838 
fine class 6: fine acc 0.5742971887550201, correct fine 143/249 
fine class 7: fine acc 0.4157303370786517, correct fine 37/89 
fine class 8: fine acc 0.3484848484848485, correct fine 46/132 
fine class 9: fine acc 0.4, correct fine 4/10 
fine class 10: fine acc 0.4230769230769231, correct fine 11/26 
Overall Accuracy: 0.6793

Val Set, val_loss: 1.9662, val_error: 0.4924, auc: 0.6800
class 0 clustering acc 0.9949207988980716: correct 23114/23232 
class 1 clustering acc 0.19223484848484848: correct 406/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5, correct fine 32/64 
fine class 3: fine acc 0.2222222222222222, correct fine 4/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.8173076923076923, correct fine 85/104 
fine class 6: fine acc 0.26666666666666666, correct fine 8/30 
fine class 7: fine acc 0.2, correct fine 2/10 
fine class 8: fine acc 0.125, correct fine 2/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.2062

Training for fine level...
batch 100, loss: 0.6037, instance_loss: 0.1131, weighted_loss: 0.4565, label: 5, bag_size: 363
batch 200, loss: 0.0030, instance_loss: 0.0325, weighted_loss: 0.0118, label: 5, bag_size: 334
batch 300, loss: 0.0049, instance_loss: 0.2456, weighted_loss: 0.0771, label: 3, bag_size: 433
batch 400, loss: 1.5227, instance_loss: 0.3046, weighted_loss: 1.1573, label: 5, bag_size: 3051
batch 500, loss: 1.5997, instance_loss: 0.3909, weighted_loss: 1.2371, label: 6, bag_size: 2272
batch 600, loss: 0.4152, instance_loss: 0.5397, weighted_loss: 0.4526, label: 9, bag_size: 936
batch 700, loss: 0.2156, instance_loss: 0.1913, weighted_loss: 0.2083, label: 2, bag_size: 366
batch 800, loss: 0.0101, instance_loss: 0.0383, weighted_loss: 0.0186, label: 5, bag_size: 252
batch 900, loss: 1.2297, instance_loss: 0.2653, weighted_loss: 0.9404, label: 8, bag_size: 241
batch 1000, loss: 0.5984, instance_loss: 0.2162, weighted_loss: 0.4838, label: 5, bag_size: 352
batch 1100, loss: 0.0674, instance_loss: 0.0197, weighted_loss: 0.0531, label: 5, bag_size: 329
batch 1200, loss: 0.1563, instance_loss: 0.3912, weighted_loss: 0.2268, label: 6, bag_size: 527
batch 1300, loss: 0.6696, instance_loss: 0.1969, weighted_loss: 0.5278, label: 2, bag_size: 1293
batch 1400, loss: 0.0000, instance_loss: 0.2406, weighted_loss: 0.0722, label: 10, bag_size: 270
batch 1500, loss: 0.0074, instance_loss: 0.0501, weighted_loss: 0.0202, label: 2, bag_size: 2220
batch 1600, loss: 0.0282, instance_loss: 0.1549, weighted_loss: 0.0662, label: 5, bag_size: 605
batch 1700, loss: 0.0390, instance_loss: 0.1445, weighted_loss: 0.0706, label: 2, bag_size: 1632
batch 1800, loss: 0.3027, instance_loss: 0.1181, weighted_loss: 0.2473, label: 5, bag_size: 324
batch 1900, loss: 0.0145, instance_loss: 0.0190, weighted_loss: 0.0158, label: 5, bag_size: 965
batch 2000, loss: 2.4402, instance_loss: 0.5014, weighted_loss: 1.8586, label: 9, bag_size: 237
batch 2100, loss: 0.0041, instance_loss: 0.0442, weighted_loss: 0.0162, label: 5, bag_size: 563

Instance Classifier Stats
class 0 clustering acc 0.994145370758274: correct 189842/190960
class 1 clustering acc 0.20915898617511522: correct 3631/17360

Epoch: 13, train_loss: 0.7828, train_clustering_loss: 0.2103, train_error: 0.2742
fine class 0: fine acc 0.6666666666666666, correct fine 8/12 
fine class 1: fine acc 0.5625, correct fine 18/32 
fine class 2: fine acc 0.7408123791102514, correct fine 383/517 
fine class 3: fine acc 0.56, correct fine 84/150 
fine class 4: fine acc 0.6956521739130435, correct fine 80/115 
fine class 5: fine acc 0.8747016706443914, correct fine 733/838 
fine class 6: fine acc 0.6184738955823293, correct fine 154/249 
fine class 7: fine acc 0.4606741573033708, correct fine 41/89 
fine class 8: fine acc 0.4393939393939394, correct fine 58/132 
fine class 9: fine acc 0.3, correct fine 3/10 
fine class 10: fine acc 0.5, correct fine 13/26 
Overall Accuracy: 0.7258

Val Set, val_loss: 2.1932, val_error: 0.5417, auc: 0.6766
class 0 clustering acc 0.9930268595041323: correct 23070/23232 
class 1 clustering acc 0.18797348484848486: correct 397/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.59375, correct fine 38/64 
fine class 3: fine acc 0.1111111111111111, correct fine 2/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.6346153846153846, correct fine 66/104 
fine class 6: fine acc 0.26666666666666666, correct fine 8/30 
fine class 7: fine acc 0.1, correct fine 1/10 
fine class 8: fine acc 0.25, correct fine 4/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4583
Overall F1 Score: 0.1940

Training for fine level...
batch 100, loss: 0.0030, instance_loss: 0.0872, weighted_loss: 0.0283, label: 5, bag_size: 676
batch 200, loss: 0.4028, instance_loss: 0.3131, weighted_loss: 0.3759, label: 3, bag_size: 1678
batch 300, loss: 0.0089, instance_loss: 0.1243, weighted_loss: 0.0435, label: 5, bag_size: 221
batch 400, loss: 0.1828, instance_loss: 0.1562, weighted_loss: 0.1748, label: 5, bag_size: 929
batch 500, loss: 0.0404, instance_loss: 0.1134, weighted_loss: 0.0623, label: 5, bag_size: 280
batch 600, loss: 0.0674, instance_loss: 0.3221, weighted_loss: 0.1438, label: 6, bag_size: 394
batch 700, loss: 0.0517, instance_loss: 0.1740, weighted_loss: 0.0884, label: 5, bag_size: 237
batch 800, loss: 0.4882, instance_loss: 0.1526, weighted_loss: 0.3875, label: 5, bag_size: 472
batch 900, loss: 0.0346, instance_loss: 0.1087, weighted_loss: 0.0568, label: 5, bag_size: 699
batch 1000, loss: 0.0005, instance_loss: 0.1622, weighted_loss: 0.0490, label: 5, bag_size: 131
batch 1100, loss: 3.2629, instance_loss: 0.1897, weighted_loss: 2.3409, label: 5, bag_size: 331
batch 1200, loss: 0.0013, instance_loss: 0.0843, weighted_loss: 0.0262, label: 5, bag_size: 554
batch 1300, loss: 1.5063, instance_loss: 0.3560, weighted_loss: 1.1612, label: 8, bag_size: 233
batch 1400, loss: 0.8207, instance_loss: 0.2760, weighted_loss: 0.6573, label: 2, bag_size: 568
batch 1500, loss: 0.2696, instance_loss: 0.2753, weighted_loss: 0.2713, label: 4, bag_size: 1387
batch 1600, loss: 0.0694, instance_loss: 0.0791, weighted_loss: 0.0723, label: 5, bag_size: 361
batch 1700, loss: 0.2126, instance_loss: 0.1631, weighted_loss: 0.1977, label: 5, bag_size: 482
batch 1800, loss: 0.0790, instance_loss: 0.1103, weighted_loss: 0.0884, label: 5, bag_size: 866
batch 1900, loss: 0.2102, instance_loss: 0.2709, weighted_loss: 0.2284, label: 4, bag_size: 607
batch 2000, loss: 0.0122, instance_loss: 0.0361, weighted_loss: 0.0194, label: 5, bag_size: 779
batch 2100, loss: 2.7671, instance_loss: 0.3083, weighted_loss: 2.0295, label: 2, bag_size: 696

Instance Classifier Stats
class 0 clustering acc 0.9939777963971512: correct 189810/190960
class 1 clustering acc 0.2074884792626728: correct 3602/17360

Epoch: 14, train_loss: 0.7237, train_clustering_loss: 0.2117, train_error: 0.2461
fine class 0: fine acc 0.5833333333333334, correct fine 7/12 
fine class 1: fine acc 0.65625, correct fine 21/32 
fine class 2: fine acc 0.7736943907156673, correct fine 400/517 
fine class 3: fine acc 0.5666666666666667, correct fine 85/150 
fine class 4: fine acc 0.6869565217391305, correct fine 79/115 
fine class 5: fine acc 0.8770883054892601, correct fine 735/838 
fine class 6: fine acc 0.6746987951807228, correct fine 168/249 
fine class 7: fine acc 0.5842696629213483, correct fine 52/89 
fine class 8: fine acc 0.5303030303030303, correct fine 70/132 
fine class 9: fine acc 0.5, correct fine 5/10 
fine class 10: fine acc 0.5384615384615384, correct fine 14/26 
Overall Accuracy: 0.7539

Val Set, val_loss: 2.2063, val_error: 0.5303, auc: 0.6541
class 0 clustering acc 0.9962551652892562: correct 23145/23232 
class 1 clustering acc 0.09375: correct 198/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.53125, correct fine 34/64 
fine class 3: fine acc 0.05555555555555555, correct fine 1/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.7019230769230769, correct fine 73/104 
fine class 6: fine acc 0.26666666666666666, correct fine 8/30 
fine class 7: fine acc 0.2, correct fine 2/10 
fine class 8: fine acc 0.1875, correct fine 3/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4697
Overall F1 Score: 0.1991

Training for fine level...
batch 100, loss: 0.0050, instance_loss: 0.0599, weighted_loss: 0.0214, label: 2, bag_size: 2159
batch 200, loss: 0.0260, instance_loss: 0.1264, weighted_loss: 0.0561, label: 2, bag_size: 1490
batch 300, loss: 0.0323, instance_loss: 0.0951, weighted_loss: 0.0511, label: 2, bag_size: 835
batch 400, loss: 0.0004, instance_loss: 0.1735, weighted_loss: 0.0523, label: 5, bag_size: 280
batch 500, loss: 1.5889, instance_loss: 0.3078, weighted_loss: 1.2045, label: 3, bag_size: 303
batch 600, loss: 0.0005, instance_loss: 0.0570, weighted_loss: 0.0175, label: 5, bag_size: 602
batch 700, loss: 0.0144, instance_loss: 0.0441, weighted_loss: 0.0233, label: 5, bag_size: 711
batch 800, loss: 0.0307, instance_loss: 0.2453, weighted_loss: 0.0951, label: 3, bag_size: 554
batch 900, loss: 0.0233, instance_loss: 0.2045, weighted_loss: 0.0777, label: 6, bag_size: 92
batch 1000, loss: 1.9864, instance_loss: 0.2638, weighted_loss: 1.4697, label: 2, bag_size: 861
batch 1100, loss: 2.0164, instance_loss: 0.3784, weighted_loss: 1.5250, label: 8, bag_size: 278
batch 1200, loss: 0.1461, instance_loss: 0.1123, weighted_loss: 0.1359, label: 5, bag_size: 726
batch 1300, loss: 0.0029, instance_loss: 0.2020, weighted_loss: 0.0626, label: 2, bag_size: 1700
batch 1400, loss: 0.0009, instance_loss: 0.1969, weighted_loss: 0.0597, label: 4, bag_size: 374
batch 1500, loss: 0.1519, instance_loss: 0.1575, weighted_loss: 0.1536, label: 2, bag_size: 1527
batch 1600, loss: 0.0845, instance_loss: 0.1888, weighted_loss: 0.1158, label: 3, bag_size: 945
batch 1700, loss: 0.0094, instance_loss: 0.0415, weighted_loss: 0.0190, label: 5, bag_size: 506
batch 1800, loss: 1.7886, instance_loss: 0.3915, weighted_loss: 1.3694, label: 8, bag_size: 565
batch 1900, loss: 0.4500, instance_loss: 0.2227, weighted_loss: 0.3818, label: 5, bag_size: 857
batch 2000, loss: 0.0836, instance_loss: 0.0894, weighted_loss: 0.0853, label: 2, bag_size: 425
batch 2100, loss: 0.0937, instance_loss: 0.1815, weighted_loss: 0.1201, label: 2, bag_size: 633

Instance Classifier Stats
class 0 clustering acc 0.993721198156682: correct 189761/190960
class 1 clustering acc 0.2294930875576037: correct 3984/17360

Epoch: 15, train_loss: 0.6327, train_clustering_loss: 0.2088, train_error: 0.2267
fine class 0: fine acc 0.75, correct fine 9/12 
fine class 1: fine acc 0.5625, correct fine 18/32 
fine class 2: fine acc 0.804642166344294, correct fine 416/517 
fine class 3: fine acc 0.6133333333333333, correct fine 92/150 
fine class 4: fine acc 0.7391304347826086, correct fine 85/115 
fine class 5: fine acc 0.8854415274463007, correct fine 742/838 
fine class 6: fine acc 0.6867469879518072, correct fine 171/249 
fine class 7: fine acc 0.5617977528089888, correct fine 50/89 
fine class 8: fine acc 0.5606060606060606, correct fine 74/132 
fine class 9: fine acc 0.6, correct fine 6/10 
fine class 10: fine acc 0.5769230769230769, correct fine 15/26 
Overall Accuracy: 0.7733

Val Set, val_loss: 2.4927, val_error: 0.5795, auc: 0.6434
class 0 clustering acc 0.9951790633608816: correct 23120/23232 
class 1 clustering acc 0.14535984848484848: correct 307/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.484375, correct fine 31/64 
fine class 3: fine acc 0.1111111111111111, correct fine 2/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.5865384615384616, correct fine 61/104 
fine class 6: fine acc 0.3333333333333333, correct fine 10/30 
fine class 7: fine acc 0.2, correct fine 2/10 
fine class 8: fine acc 0.25, correct fine 4/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4205
Overall F1 Score: 0.1841

Training for fine level...
batch 100, loss: 0.0208, instance_loss: 0.1229, weighted_loss: 0.0514, label: 2, bag_size: 248
batch 200, loss: 0.5373, instance_loss: 0.1315, weighted_loss: 0.4156, label: 5, bag_size: 696
batch 300, loss: 0.1568, instance_loss: 0.1236, weighted_loss: 0.1468, label: 5, bag_size: 301
batch 400, loss: 0.0002, instance_loss: 0.0284, weighted_loss: 0.0087, label: 5, bag_size: 261
batch 500, loss: 0.4212, instance_loss: 0.3586, weighted_loss: 0.4024, label: 3, bag_size: 428
batch 600, loss: 0.0288, instance_loss: 0.1345, weighted_loss: 0.0605, label: 2, bag_size: 497
batch 700, loss: 0.0158, instance_loss: 0.1699, weighted_loss: 0.0621, label: 2, bag_size: 267
batch 800, loss: 0.0000, instance_loss: 0.0042, weighted_loss: 0.0013, label: 5, bag_size: 369
batch 900, loss: 0.0097, instance_loss: 0.4463, weighted_loss: 0.1407, label: 1, bag_size: 1452
batch 1000, loss: 2.8440, instance_loss: 0.2586, weighted_loss: 2.0684, label: 5, bag_size: 735
batch 1100, loss: 0.0011, instance_loss: 0.3049, weighted_loss: 0.0922, label: 6, bag_size: 614
batch 1200, loss: 1.5115, instance_loss: 0.2628, weighted_loss: 1.1369, label: 2, bag_size: 334
batch 1300, loss: 0.0222, instance_loss: 0.1653, weighted_loss: 0.0651, label: 3, bag_size: 837
batch 1400, loss: 0.0260, instance_loss: 0.2493, weighted_loss: 0.0930, label: 8, bag_size: 307
batch 1500, loss: 0.1037, instance_loss: 0.2223, weighted_loss: 0.1393, label: 2, bag_size: 378
batch 1600, loss: 0.1653, instance_loss: 0.3516, weighted_loss: 0.2212, label: 3, bag_size: 774
batch 1700, loss: 2.3958, instance_loss: 0.3379, weighted_loss: 1.7784, label: 8, bag_size: 386
batch 1800, loss: 1.1584, instance_loss: 0.2531, weighted_loss: 0.8868, label: 8, bag_size: 216
batch 1900, loss: 0.1862, instance_loss: 0.2418, weighted_loss: 0.2029, label: 6, bag_size: 555
batch 2000, loss: 0.0670, instance_loss: 0.2128, weighted_loss: 0.1107, label: 5, bag_size: 543
batch 2100, loss: 0.0000, instance_loss: 0.1563, weighted_loss: 0.0469, label: 3, bag_size: 304

Instance Classifier Stats
class 0 clustering acc 0.9938102220360285: correct 189778/190960
class 1 clustering acc 0.2277073732718894: correct 3953/17360

Epoch: 16, train_loss: 0.5771, train_clustering_loss: 0.2079, train_error: 0.2046
fine class 0: fine acc 0.75, correct fine 9/12 
fine class 1: fine acc 0.71875, correct fine 23/32 
fine class 2: fine acc 0.8104448742746615, correct fine 419/517 
fine class 3: fine acc 0.6933333333333334, correct fine 104/150 
fine class 4: fine acc 0.7304347826086957, correct fine 84/115 
fine class 5: fine acc 0.8914081145584726, correct fine 747/838 
fine class 6: fine acc 0.7028112449799196, correct fine 175/249 
fine class 7: fine acc 0.6629213483146067, correct fine 59/89 
fine class 8: fine acc 0.6590909090909091, correct fine 87/132 
fine class 9: fine acc 0.4, correct fine 4/10 
fine class 10: fine acc 0.5769230769230769, correct fine 15/26 
Overall Accuracy: 0.7954

Val Set, val_loss: 2.7227, val_error: 0.5568, auc: 0.6583
class 0 clustering acc 0.9916494490358126: correct 23038/23232 
class 1 clustering acc 0.18087121212121213: correct 382/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.625, correct fine 40/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.6634615384615384, correct fine 69/104 
fine class 6: fine acc 0.1, correct fine 3/30 
fine class 7: fine acc 0.2, correct fine 2/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4432
Overall F1 Score: 0.1555

Training for fine level...
batch 100, loss: 0.0015, instance_loss: 0.0657, weighted_loss: 0.0207, label: 5, bag_size: 334
batch 200, loss: 1.0194, instance_loss: 0.2594, weighted_loss: 0.7914, label: 2, bag_size: 533
batch 300, loss: 2.4287, instance_loss: 0.3043, weighted_loss: 1.7914, label: 3, bag_size: 406
batch 400, loss: 0.0105, instance_loss: 0.1802, weighted_loss: 0.0614, label: 6, bag_size: 334
batch 500, loss: 0.8501, instance_loss: 0.2035, weighted_loss: 0.6561, label: 5, bag_size: 112
batch 600, loss: 0.0627, instance_loss: 0.2582, weighted_loss: 0.1213, label: 8, bag_size: 615
batch 700, loss: 0.3715, instance_loss: 0.2047, weighted_loss: 0.3215, label: 5, bag_size: 515
batch 800, loss: 0.8416, instance_loss: 0.2805, weighted_loss: 0.6733, label: 8, bag_size: 383
batch 900, loss: 2.5812, instance_loss: 0.2933, weighted_loss: 1.8948, label: 3, bag_size: 428
batch 1000, loss: 0.0287, instance_loss: 0.2986, weighted_loss: 0.1097, label: 7, bag_size: 778
batch 1100, loss: 0.0614, instance_loss: 0.3836, weighted_loss: 0.1581, label: 6, bag_size: 424
batch 1200, loss: 0.6562, instance_loss: 0.3434, weighted_loss: 0.5623, label: 6, bag_size: 649
batch 1300, loss: 0.3576, instance_loss: 0.2392, weighted_loss: 0.3221, label: 2, bag_size: 193
batch 1400, loss: 0.0180, instance_loss: 0.0980, weighted_loss: 0.0420, label: 5, bag_size: 517
batch 1500, loss: 4.1148, instance_loss: 0.3550, weighted_loss: 2.9869, label: 2, bag_size: 641
batch 1600, loss: 0.0014, instance_loss: 0.1341, weighted_loss: 0.0412, label: 5, bag_size: 193
batch 1700, loss: 1.9238, instance_loss: 0.3485, weighted_loss: 1.4512, label: 7, bag_size: 435
batch 1800, loss: 0.0111, instance_loss: 0.1739, weighted_loss: 0.0599, label: 2, bag_size: 290
batch 1900, loss: 0.0076, instance_loss: 0.1753, weighted_loss: 0.0579, label: 6, bag_size: 239
batch 2000, loss: 0.1952, instance_loss: 0.3263, weighted_loss: 0.2346, label: 6, bag_size: 278
batch 2100, loss: 0.0730, instance_loss: 0.2142, weighted_loss: 0.1153, label: 3, bag_size: 3892

Instance Classifier Stats
class 0 clustering acc 0.9933232090490155: correct 189685/190960
class 1 clustering acc 0.2315668202764977: correct 4020/17360

Epoch: 17, train_loss: 0.5190, train_clustering_loss: 0.2088, train_error: 0.1797
fine class 0: fine acc 0.9166666666666666, correct fine 11/12 
fine class 1: fine acc 0.71875, correct fine 23/32 
fine class 2: fine acc 0.8336557059961315, correct fine 431/517 
fine class 3: fine acc 0.6733333333333333, correct fine 101/150 
fine class 4: fine acc 0.7739130434782608, correct fine 89/115 
fine class 5: fine acc 0.9105011933174224, correct fine 763/838 
fine class 6: fine acc 0.7469879518072289, correct fine 186/249 
fine class 7: fine acc 0.7191011235955056, correct fine 64/89 
fine class 8: fine acc 0.6818181818181818, correct fine 90/132 
fine class 9: fine acc 0.5, correct fine 5/10 
fine class 10: fine acc 0.6538461538461539, correct fine 17/26 
Overall Accuracy: 0.8203

Val Set, val_loss: 2.7192, val_error: 0.5833, auc: 0.6590
class 0 clustering acc 0.9916494490358126: correct 23038/23232 
class 1 clustering acc 0.1728219696969697: correct 365/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.515625, correct fine 33/64 
fine class 3: fine acc 0.05555555555555555, correct fine 1/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.5576923076923077, correct fine 58/104 
fine class 6: fine acc 0.4, correct fine 12/30 
fine class 7: fine acc 0.1, correct fine 1/10 
fine class 8: fine acc 0.25, correct fine 4/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4167
Overall F1 Score: 0.1710

Training for fine level...
batch 100, loss: 0.1078, instance_loss: 0.0817, weighted_loss: 0.1000, label: 2, bag_size: 2692
batch 200, loss: 0.2329, instance_loss: 0.2037, weighted_loss: 0.2241, label: 2, bag_size: 1817
batch 300, loss: 0.7255, instance_loss: 0.1835, weighted_loss: 0.5629, label: 2, bag_size: 526
batch 400, loss: 0.1267, instance_loss: 0.2522, weighted_loss: 0.1643, label: 6, bag_size: 259
batch 500, loss: 7.7018, instance_loss: 0.4374, weighted_loss: 5.5225, label: 1, bag_size: 505
batch 600, loss: 1.5933, instance_loss: 0.2715, weighted_loss: 1.1968, label: 5, bag_size: 309
batch 700, loss: 0.0000, instance_loss: 0.2174, weighted_loss: 0.0652, label: 2, bag_size: 315
batch 800, loss: 0.2108, instance_loss: 0.1225, weighted_loss: 0.1843, label: 2, bag_size: 714
batch 900, loss: 0.5129, instance_loss: 0.1815, weighted_loss: 0.4135, label: 5, bag_size: 290
batch 1000, loss: 0.2271, instance_loss: 0.2756, weighted_loss: 0.2416, label: 5, bag_size: 1897
batch 1100, loss: 0.0001, instance_loss: 0.0096, weighted_loss: 0.0030, label: 5, bag_size: 505
batch 1200, loss: 0.9680, instance_loss: 0.3170, weighted_loss: 0.7727, label: 4, bag_size: 556
batch 1300, loss: 0.0077, instance_loss: 0.1275, weighted_loss: 0.0437, label: 2, bag_size: 1090
batch 1400, loss: 0.4604, instance_loss: 0.2509, weighted_loss: 0.3975, label: 6, bag_size: 2046
batch 1500, loss: 1.0625, instance_loss: 0.4019, weighted_loss: 0.8643, label: 6, bag_size: 739
batch 1600, loss: 0.0134, instance_loss: 0.1527, weighted_loss: 0.0552, label: 5, bag_size: 2141
batch 1700, loss: 0.0000, instance_loss: 0.0752, weighted_loss: 0.0226, label: 5, bag_size: 332
batch 1800, loss: 1.3402, instance_loss: 0.3289, weighted_loss: 1.0368, label: 7, bag_size: 321
batch 1900, loss: 0.5856, instance_loss: 0.4801, weighted_loss: 0.5540, label: 7, bag_size: 568
batch 2000, loss: 0.0000, instance_loss: 0.0080, weighted_loss: 0.0024, label: 5, bag_size: 717
batch 2100, loss: 0.0002, instance_loss: 0.0578, weighted_loss: 0.0175, label: 2, bag_size: 2119

Instance Classifier Stats
class 0 clustering acc 0.9933808127356515: correct 189696/190960
class 1 clustering acc 0.23577188940092167: correct 4093/17360

Epoch: 18, train_loss: 0.4619, train_clustering_loss: 0.2092, train_error: 0.1558
fine class 0: fine acc 0.5833333333333334, correct fine 7/12 
fine class 1: fine acc 0.71875, correct fine 23/32 
fine class 2: fine acc 0.874274661508704, correct fine 452/517 
fine class 3: fine acc 0.7466666666666667, correct fine 112/150 
fine class 4: fine acc 0.8, correct fine 92/115 
fine class 5: fine acc 0.9105011933174224, correct fine 763/838 
fine class 6: fine acc 0.7991967871485943, correct fine 199/249 
fine class 7: fine acc 0.7415730337078652, correct fine 66/89 
fine class 8: fine acc 0.7348484848484849, correct fine 97/132 
fine class 9: fine acc 0.6, correct fine 6/10 
fine class 10: fine acc 0.5769230769230769, correct fine 15/26 
Overall Accuracy: 0.8442

Val Set, val_loss: 2.5040, val_error: 0.5417, auc: 0.6629
class 0 clustering acc 0.993586432506887: correct 23083/23232 
class 1 clustering acc 0.17708333333333334: correct 374/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.578125, correct fine 37/64 
fine class 3: fine acc 0.2777777777777778, correct fine 5/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.6826923076923077, correct fine 71/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.2, correct fine 2/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4583
Overall F1 Score: 0.1773

Training for fine level...
batch 100, loss: 1.2927, instance_loss: 0.2464, weighted_loss: 0.9788, label: 2, bag_size: 165
batch 200, loss: 0.0836, instance_loss: 0.0837, weighted_loss: 0.0836, label: 2, bag_size: 983
batch 300, loss: 0.0003, instance_loss: 0.0912, weighted_loss: 0.0276, label: 2, bag_size: 1860
batch 400, loss: 0.0001, instance_loss: 0.0715, weighted_loss: 0.0216, label: 5, bag_size: 608
batch 500, loss: 0.3726, instance_loss: 0.3311, weighted_loss: 0.3601, label: 4, bag_size: 621
batch 600, loss: 0.0082, instance_loss: 0.1283, weighted_loss: 0.0443, label: 5, bag_size: 703
batch 700, loss: 0.1030, instance_loss: 0.2692, weighted_loss: 0.1529, label: 5, bag_size: 532
batch 800, loss: 0.0006, instance_loss: 0.0447, weighted_loss: 0.0138, label: 2, bag_size: 3530
batch 900, loss: 0.0000, instance_loss: 0.1865, weighted_loss: 0.0559, label: 5, bag_size: 883
batch 1000, loss: 0.0000, instance_loss: 0.1291, weighted_loss: 0.0388, label: 5, bag_size: 682
batch 1100, loss: 0.0154, instance_loss: 0.4343, weighted_loss: 0.1411, label: 0, bag_size: 419
batch 1200, loss: 0.0034, instance_loss: 0.1838, weighted_loss: 0.0575, label: 5, bag_size: 337
batch 1300, loss: 0.1651, instance_loss: 0.2313, weighted_loss: 0.1850, label: 5, bag_size: 382
batch 1400, loss: 1.1015, instance_loss: 0.1584, weighted_loss: 0.8186, label: 5, bag_size: 332
batch 1500, loss: 0.0012, instance_loss: 0.1821, weighted_loss: 0.0555, label: 5, bag_size: 376
batch 1600, loss: 1.3579, instance_loss: 0.3701, weighted_loss: 1.0616, label: 3, bag_size: 510
batch 1700, loss: 0.2037, instance_loss: 0.2476, weighted_loss: 0.2169, label: 5, bag_size: 286
batch 1800, loss: 2.1696, instance_loss: 0.0560, weighted_loss: 1.5355, label: 5, bag_size: 686
batch 1900, loss: 0.9953, instance_loss: 0.2031, weighted_loss: 0.7576, label: 8, bag_size: 175
batch 2000, loss: 0.0241, instance_loss: 0.2540, weighted_loss: 0.0931, label: 5, bag_size: 422
batch 2100, loss: 1.3990, instance_loss: 0.3105, weighted_loss: 1.0725, label: 4, bag_size: 2131

Instance Classifier Stats
class 0 clustering acc 0.9928100125680771: correct 189587/190960
class 1 clustering acc 0.24337557603686635: correct 4225/17360

Epoch: 19, train_loss: 0.4419, train_clustering_loss: 0.2085, train_error: 0.1475
fine class 0: fine acc 1.0, correct fine 12/12 
fine class 1: fine acc 0.78125, correct fine 25/32 
fine class 2: fine acc 0.8549323017408124, correct fine 442/517 
fine class 3: fine acc 0.74, correct fine 111/150 
fine class 4: fine acc 0.8434782608695652, correct fine 97/115 
fine class 5: fine acc 0.9164677804295943, correct fine 768/838 
fine class 6: fine acc 0.7871485943775101, correct fine 196/249 
fine class 7: fine acc 0.8089887640449438, correct fine 72/89 
fine class 8: fine acc 0.7575757575757576, correct fine 100/132 
fine class 9: fine acc 0.7, correct fine 7/10 
fine class 10: fine acc 0.7692307692307693, correct fine 20/26 
Overall Accuracy: 0.8525

Val Set, val_loss: 2.8840, val_error: 0.5644, auc: 0.6386
class 0 clustering acc 0.9921229338842975: correct 23049/23232 
class 1 clustering acc 0.19270833333333334: correct 407/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.609375, correct fine 39/64 
fine class 3: fine acc 0.0, correct fine 0/18 
fine class 4: fine acc 0.21428571428571427, correct fine 3/14 
fine class 5: fine acc 0.625, correct fine 65/104 
fine class 6: fine acc 0.23333333333333334, correct fine 7/30 
fine class 7: fine acc 0.1, correct fine 1/10 
fine class 8: fine acc 0.0, correct fine 0/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4356
Overall F1 Score: 0.1555

Training for fine level...
batch 100, loss: 0.0047, instance_loss: 0.3690, weighted_loss: 0.1140, label: 2, bag_size: 501
batch 200, loss: 0.1939, instance_loss: 0.1131, weighted_loss: 0.1697, label: 5, bag_size: 860
batch 300, loss: 1.1936, instance_loss: 0.1471, weighted_loss: 0.8797, label: 6, bag_size: 481
batch 400, loss: 0.0024, instance_loss: 0.2411, weighted_loss: 0.0740, label: 6, bag_size: 614
batch 500, loss: 0.0010, instance_loss: 0.1971, weighted_loss: 0.0598, label: 5, bag_size: 546
batch 600, loss: 1.0438, instance_loss: 0.2727, weighted_loss: 0.8125, label: 6, bag_size: 541
batch 700, loss: 0.0118, instance_loss: 0.2410, weighted_loss: 0.0805, label: 2, bag_size: 530
batch 800, loss: 0.0022, instance_loss: 0.1125, weighted_loss: 0.0353, label: 2, bag_size: 1744
batch 900, loss: 0.2688, instance_loss: 0.0573, weighted_loss: 0.2054, label: 2, bag_size: 795
batch 1000, loss: 0.0234, instance_loss: 0.0477, weighted_loss: 0.0307, label: 5, bag_size: 448
batch 1100, loss: 2.5617, instance_loss: 0.2127, weighted_loss: 1.8570, label: 2, bag_size: 353
batch 1200, loss: 0.0007, instance_loss: 0.0684, weighted_loss: 0.0210, label: 5, bag_size: 909
batch 1300, loss: 0.0153, instance_loss: 0.2517, weighted_loss: 0.0863, label: 2, bag_size: 2627
batch 1400, loss: 0.4075, instance_loss: 0.2879, weighted_loss: 0.3717, label: 2, bag_size: 472
batch 1500, loss: 0.0719, instance_loss: 0.2620, weighted_loss: 0.1289, label: 6, bag_size: 2033
batch 1600, loss: 0.0196, instance_loss: 0.1217, weighted_loss: 0.0503, label: 5, bag_size: 368
batch 1700, loss: 0.0000, instance_loss: 0.3463, weighted_loss: 0.1039, label: 4, bag_size: 471
batch 1800, loss: 0.4458, instance_loss: 0.1321, weighted_loss: 0.3517, label: 5, bag_size: 239
batch 1900, loss: 0.3776, instance_loss: 0.2203, weighted_loss: 0.3304, label: 2, bag_size: 374
batch 2000, loss: 0.0098, instance_loss: 0.1304, weighted_loss: 0.0460, label: 5, bag_size: 459
batch 2100, loss: 0.0103, instance_loss: 0.1213, weighted_loss: 0.0436, label: 2, bag_size: 633

Instance Classifier Stats
class 0 clustering acc 0.9927471721826561: correct 189575/190960
class 1 clustering acc 0.2436635944700461: correct 4230/17360

Epoch: 20, train_loss: 0.3676, train_clustering_loss: 0.2092, train_error: 0.1240
fine class 0: fine acc 1.0, correct fine 12/12 
fine class 1: fine acc 0.875, correct fine 28/32 
fine class 2: fine acc 0.8955512572533849, correct fine 463/517 
fine class 3: fine acc 0.7533333333333333, correct fine 113/150 
fine class 4: fine acc 0.8521739130434782, correct fine 98/115 
fine class 5: fine acc 0.9391408114558473, correct fine 787/838 
fine class 6: fine acc 0.8232931726907631, correct fine 205/249 
fine class 7: fine acc 0.7865168539325843, correct fine 70/89 
fine class 8: fine acc 0.7348484848484849, correct fine 97/132 
fine class 9: fine acc 0.7, correct fine 7/10 
fine class 10: fine acc 0.8076923076923077, correct fine 21/26 
Overall Accuracy: 0.8760

Val Set, val_loss: 3.9059, val_error: 0.6250, auc: 0.6177
class 0 clustering acc 0.9928546831955923: correct 23066/23232 
class 1 clustering acc 0.12926136363636365: correct 273/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.390625, correct fine 25/64 
fine class 3: fine acc 0.3888888888888889, correct fine 7/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.4519230769230769, correct fine 47/104 
fine class 6: fine acc 0.36666666666666664, correct fine 11/30 
fine class 7: fine acc 0.4, correct fine 4/10 
fine class 8: fine acc 0.1875, correct fine 3/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.3750
Overall F1 Score: 0.1897

Training for fine level...
batch 100, loss: 0.0001, instance_loss: 0.0256, weighted_loss: 0.0077, label: 2, bag_size: 691
batch 200, loss: 0.0010, instance_loss: 0.1848, weighted_loss: 0.0562, label: 7, bag_size: 1196
batch 300, loss: 0.0031, instance_loss: 0.2006, weighted_loss: 0.0623, label: 2, bag_size: 697
batch 400, loss: 0.0000, instance_loss: 0.1445, weighted_loss: 0.0434, label: 2, bag_size: 556
batch 500, loss: 0.4156, instance_loss: 0.0986, weighted_loss: 0.3205, label: 5, bag_size: 187
batch 600, loss: 1.2758, instance_loss: 0.1409, weighted_loss: 0.9353, label: 2, bag_size: 792
batch 700, loss: 0.0077, instance_loss: 0.2358, weighted_loss: 0.0761, label: 5, bag_size: 368
batch 800, loss: 0.0761, instance_loss: 0.1980, weighted_loss: 0.1127, label: 2, bag_size: 3615
batch 900, loss: 0.0050, instance_loss: 0.3008, weighted_loss: 0.0938, label: 4, bag_size: 454
batch 1000, loss: 3.2616, instance_loss: 0.3386, weighted_loss: 2.3847, label: 8, bag_size: 571
batch 1100, loss: 0.0002, instance_loss: 0.1047, weighted_loss: 0.0316, label: 5, bag_size: 795
batch 1200, loss: 0.0041, instance_loss: 0.1173, weighted_loss: 0.0380, label: 6, bag_size: 451
batch 1300, loss: 0.0091, instance_loss: 0.1305, weighted_loss: 0.0455, label: 5, bag_size: 909
batch 1400, loss: 0.0047, instance_loss: 0.2386, weighted_loss: 0.0749, label: 4, bag_size: 1181
batch 1500, loss: 0.0003, instance_loss: 0.0319, weighted_loss: 0.0098, label: 5, bag_size: 1137
batch 1600, loss: 0.2202, instance_loss: 0.1570, weighted_loss: 0.2013, label: 5, bag_size: 371
batch 1700, loss: 0.7061, instance_loss: 0.4609, weighted_loss: 0.6325, label: 2, bag_size: 641
batch 1800, loss: 1.9034, instance_loss: 0.2499, weighted_loss: 1.4074, label: 8, bag_size: 245
batch 1900, loss: 0.0830, instance_loss: 0.0819, weighted_loss: 0.0827, label: 5, bag_size: 475
batch 2000, loss: 0.0008, instance_loss: 0.1313, weighted_loss: 0.0400, label: 5, bag_size: 348
batch 2100, loss: 0.0144, instance_loss: 0.0868, weighted_loss: 0.0361, label: 5, bag_size: 324

Instance Classifier Stats
class 0 clustering acc 0.9922077922077922: correct 189472/190960
class 1 clustering acc 0.2451036866359447: correct 4255/17360

Epoch: 21, train_loss: 0.3525, train_clustering_loss: 0.2102, train_error: 0.1161
fine class 0: fine acc 0.8333333333333334, correct fine 10/12 
fine class 1: fine acc 0.84375, correct fine 27/32 
fine class 2: fine acc 0.9052224371373307, correct fine 468/517 
fine class 3: fine acc 0.8133333333333334, correct fine 122/150 
fine class 4: fine acc 0.8608695652173913, correct fine 99/115 
fine class 5: fine acc 0.9343675417661098, correct fine 783/838 
fine class 6: fine acc 0.8473895582329317, correct fine 211/249 
fine class 7: fine acc 0.7528089887640449, correct fine 67/89 
fine class 8: fine acc 0.7954545454545454, correct fine 105/132 
fine class 9: fine acc 0.7, correct fine 7/10 
fine class 10: fine acc 0.7307692307692307, correct fine 19/26 
Overall Accuracy: 0.8839

Val Set, val_loss: 3.1461, val_error: 0.5644, auc: 0.6414
class 0 clustering acc 0.9915633608815427: correct 23036/23232 
class 1 clustering acc 0.16666666666666666: correct 352/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.375, correct fine 24/64 
fine class 3: fine acc 0.2222222222222222, correct fine 4/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.6730769230769231, correct fine 70/104 
fine class 6: fine acc 0.4, correct fine 12/30 
fine class 7: fine acc 0.1, correct fine 1/10 
fine class 8: fine acc 0.125, correct fine 2/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4356
Overall F1 Score: 0.1864

Training for fine level...
batch 100, loss: 0.0000, instance_loss: 0.0530, weighted_loss: 0.0159, label: 5, bag_size: 518
batch 200, loss: 1.8438, instance_loss: 0.1804, weighted_loss: 1.3448, label: 5, bag_size: 317
batch 300, loss: 0.0016, instance_loss: 0.3789, weighted_loss: 0.1148, label: 8, bag_size: 427
batch 400, loss: 0.0001, instance_loss: 0.0368, weighted_loss: 0.0111, label: 5, bag_size: 756
batch 500, loss: 0.0595, instance_loss: 0.1633, weighted_loss: 0.0907, label: 5, bag_size: 108
batch 600, loss: 0.0003, instance_loss: 0.1852, weighted_loss: 0.0558, label: 5, bag_size: 462
batch 700, loss: 10.7622, instance_loss: 0.3003, weighted_loss: 7.6236, label: 6, bag_size: 320
batch 800, loss: 0.2379, instance_loss: 0.3852, weighted_loss: 0.2821, label: 5, bag_size: 1830
batch 900, loss: 1.0134, instance_loss: 0.2576, weighted_loss: 0.7867, label: 3, bag_size: 657
batch 1000, loss: 0.0063, instance_loss: 0.1397, weighted_loss: 0.0463, label: 5, bag_size: 741
batch 1100, loss: 1.0118, instance_loss: 0.1990, weighted_loss: 0.7680, label: 5, bag_size: 275
batch 1200, loss: 0.0007, instance_loss: 0.1889, weighted_loss: 0.0572, label: 2, bag_size: 541
batch 1300, loss: 0.0218, instance_loss: 0.4763, weighted_loss: 0.1581, label: 7, bag_size: 1196
batch 1400, loss: 0.0062, instance_loss: 0.1495, weighted_loss: 0.0492, label: 6, bag_size: 1235
batch 1500, loss: 0.0005, instance_loss: 0.2839, weighted_loss: 0.0855, label: 5, bag_size: 2209
batch 1600, loss: 1.0567, instance_loss: 0.8535, weighted_loss: 0.9957, label: 7, bag_size: 868
batch 1700, loss: 0.2402, instance_loss: 0.1201, weighted_loss: 0.2042, label: 5, bag_size: 421
batch 1800, loss: 0.0046, instance_loss: 0.3274, weighted_loss: 0.1015, label: 3, bag_size: 952
batch 1900, loss: 1.4987, instance_loss: 0.2759, weighted_loss: 1.1318, label: 7, bag_size: 321
batch 2000, loss: 0.1158, instance_loss: 0.1281, weighted_loss: 0.1195, label: 2, bag_size: 2627
batch 2100, loss: 0.0000, instance_loss: 0.0183, weighted_loss: 0.0055, label: 5, bag_size: 250

Instance Classifier Stats
class 0 clustering acc 0.9926372015081693: correct 189554/190960
class 1 clustering acc 0.2537442396313364: correct 4405/17360

Epoch: 22, train_loss: 0.3289, train_clustering_loss: 0.2083, train_error: 0.1120
fine class 0: fine acc 1.0, correct fine 12/12 
fine class 1: fine acc 0.8125, correct fine 26/32 
fine class 2: fine acc 0.8897485493230174, correct fine 460/517 
fine class 3: fine acc 0.84, correct fine 126/150 
fine class 4: fine acc 0.8956521739130435, correct fine 103/115 
fine class 5: fine acc 0.931980906921241, correct fine 781/838 
fine class 6: fine acc 0.8313253012048193, correct fine 207/249 
fine class 7: fine acc 0.8876404494382022, correct fine 79/89 
fine class 8: fine acc 0.7954545454545454, correct fine 105/132 
fine class 9: fine acc 0.9, correct fine 9/10 
fine class 10: fine acc 0.7307692307692307, correct fine 19/26 
Overall Accuracy: 0.8880

Val Set, val_loss: 3.5652, val_error: 0.5947, auc: 0.6593
class 0 clustering acc 0.990573347107438: correct 23013/23232 
class 1 clustering acc 0.19223484848484848: correct 406/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.53125, correct fine 34/64 
fine class 3: fine acc 0.05555555555555555, correct fine 1/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.5769230769230769, correct fine 60/104 
fine class 6: fine acc 0.3333333333333333, correct fine 10/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4053
Overall F1 Score: 0.1432

Training for fine level...
batch 100, loss: 0.0003, instance_loss: 0.1676, weighted_loss: 0.0505, label: 2, bag_size: 3773
batch 200, loss: 0.0100, instance_loss: 0.2453, weighted_loss: 0.0806, label: 6, bag_size: 732
batch 300, loss: 0.2569, instance_loss: 0.2007, weighted_loss: 0.2401, label: 8, bag_size: 79
batch 400, loss: 0.0000, instance_loss: 0.2843, weighted_loss: 0.0853, label: 2, bag_size: 161
batch 500, loss: 0.2717, instance_loss: 0.1422, weighted_loss: 0.2328, label: 5, bag_size: 237
batch 600, loss: 0.2323, instance_loss: 0.2879, weighted_loss: 0.2489, label: 3, bag_size: 1692
batch 700, loss: 0.2855, instance_loss: 0.1698, weighted_loss: 0.2508, label: 5, bag_size: 921
batch 800, loss: 0.0188, instance_loss: 0.4384, weighted_loss: 0.1447, label: 0, bag_size: 343
batch 900, loss: 0.0127, instance_loss: 0.1521, weighted_loss: 0.0545, label: 5, bag_size: 355
batch 1000, loss: 0.0241, instance_loss: 0.2641, weighted_loss: 0.0961, label: 2, bag_size: 215
batch 1100, loss: 0.0000, instance_loss: 0.1489, weighted_loss: 0.0447, label: 3, bag_size: 202
batch 1200, loss: 0.0037, instance_loss: 0.1417, weighted_loss: 0.0451, label: 5, bag_size: 237
batch 1300, loss: 0.5258, instance_loss: 0.1720, weighted_loss: 0.4197, label: 5, bag_size: 277
batch 1400, loss: 0.0046, instance_loss: 0.2026, weighted_loss: 0.0640, label: 6, bag_size: 1122
batch 1500, loss: 0.0053, instance_loss: 0.1165, weighted_loss: 0.0386, label: 5, bag_size: 629
batch 1600, loss: 0.1030, instance_loss: 0.1285, weighted_loss: 0.1106, label: 5, bag_size: 328
batch 1700, loss: 3.6398, instance_loss: 0.4386, weighted_loss: 2.6794, label: 6, bag_size: 379
batch 1800, loss: 0.0004, instance_loss: 0.0154, weighted_loss: 0.0049, label: 5, bag_size: 1005
batch 1900, loss: 3.0905, instance_loss: 0.3080, weighted_loss: 2.2558, label: 2, bag_size: 1232
batch 2000, loss: 0.0034, instance_loss: 0.0685, weighted_loss: 0.0229, label: 5, bag_size: 893
batch 2100, loss: 0.0014, instance_loss: 0.1103, weighted_loss: 0.0341, label: 5, bag_size: 890

Instance Classifier Stats
class 0 clustering acc 0.9921606619187264: correct 189463/190960
class 1 clustering acc 0.25921658986175117: correct 4500/17360

Epoch: 23, train_loss: 0.3018, train_clustering_loss: 0.2075, train_error: 0.1023
fine class 0: fine acc 0.6666666666666666, correct fine 8/12 
fine class 1: fine acc 0.875, correct fine 28/32 
fine class 2: fine acc 0.8916827852998066, correct fine 461/517 
fine class 3: fine acc 0.8466666666666667, correct fine 127/150 
fine class 4: fine acc 0.9043478260869565, correct fine 104/115 
fine class 5: fine acc 0.9439140811455847, correct fine 791/838 
fine class 6: fine acc 0.8353413654618473, correct fine 208/249 
fine class 7: fine acc 0.8651685393258427, correct fine 77/89 
fine class 8: fine acc 0.8560606060606061, correct fine 113/132 
fine class 9: fine acc 0.9, correct fine 9/10 
fine class 10: fine acc 0.8461538461538461, correct fine 22/26 
Overall Accuracy: 0.8977

Val Set, val_loss: 3.2482, val_error: 0.5833, auc: 0.6600
class 0 clustering acc 0.9929838154269972: correct 23069/23232 
class 1 clustering acc 0.1543560606060606: correct 326/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.484375, correct fine 31/64 
fine class 3: fine acc 0.1111111111111111, correct fine 2/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.5384615384615384, correct fine 56/104 
fine class 6: fine acc 0.43333333333333335, correct fine 13/30 
fine class 7: fine acc 0.3, correct fine 3/10 
fine class 8: fine acc 0.25, correct fine 4/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4167
Overall F1 Score: 0.1887

Training for fine level...
batch 100, loss: 0.0002, instance_loss: 0.1068, weighted_loss: 0.0322, label: 5, bag_size: 463
batch 200, loss: 0.0106, instance_loss: 0.2573, weighted_loss: 0.0846, label: 7, bag_size: 172
batch 300, loss: 0.0016, instance_loss: 0.3195, weighted_loss: 0.0970, label: 2, bag_size: 2352
batch 400, loss: 0.0016, instance_loss: 0.0980, weighted_loss: 0.0305, label: 5, bag_size: 439
batch 500, loss: 1.4271, instance_loss: 0.1534, weighted_loss: 1.0450, label: 5, bag_size: 1262
batch 600, loss: 0.0004, instance_loss: 0.2515, weighted_loss: 0.0758, label: 5, bag_size: 565
batch 700, loss: 0.0000, instance_loss: 0.0848, weighted_loss: 0.0254, label: 5, bag_size: 544
batch 800, loss: 0.0002, instance_loss: 0.2087, weighted_loss: 0.0627, label: 5, bag_size: 485
batch 900, loss: 0.0861, instance_loss: 0.2595, weighted_loss: 0.1381, label: 2, bag_size: 290
batch 1000, loss: 0.0013, instance_loss: 0.1863, weighted_loss: 0.0568, label: 8, bag_size: 619
batch 1100, loss: 0.0000, instance_loss: 0.0614, weighted_loss: 0.0184, label: 5, bag_size: 221
batch 1200, loss: 0.5389, instance_loss: 0.2752, weighted_loss: 0.4598, label: 6, bag_size: 2046
batch 1300, loss: 0.9789, instance_loss: 0.4402, weighted_loss: 0.8173, label: 3, bag_size: 774
batch 1400, loss: 0.0105, instance_loss: 0.0745, weighted_loss: 0.0297, label: 5, bag_size: 344
batch 1500, loss: 0.0929, instance_loss: 0.3324, weighted_loss: 0.1647, label: 6, bag_size: 1043
batch 1600, loss: 0.0012, instance_loss: 0.2525, weighted_loss: 0.0766, label: 6, bag_size: 521
batch 1700, loss: 0.0004, instance_loss: 0.0956, weighted_loss: 0.0290, label: 5, bag_size: 524
batch 1800, loss: 0.0792, instance_loss: 0.1677, weighted_loss: 0.1058, label: 5, bag_size: 704
batch 1900, loss: 0.0000, instance_loss: 0.0261, weighted_loss: 0.0078, label: 5, bag_size: 228
batch 2000, loss: 0.0000, instance_loss: 0.0080, weighted_loss: 0.0024, label: 5, bag_size: 505
batch 2100, loss: 0.0054, instance_loss: 0.0952, weighted_loss: 0.0324, label: 5, bag_size: 724

Instance Classifier Stats
class 0 clustering acc 0.9922444490992878: correct 189479/190960
class 1 clustering acc 0.2611751152073733: correct 4534/17360

Epoch: 24, train_loss: 0.2971, train_clustering_loss: 0.2090, train_error: 0.1023
fine class 0: fine acc 0.9166666666666666, correct fine 11/12 
fine class 1: fine acc 0.84375, correct fine 27/32 
fine class 2: fine acc 0.9187620889748549, correct fine 475/517 
fine class 3: fine acc 0.8, correct fine 120/150 
fine class 4: fine acc 0.8956521739130435, correct fine 103/115 
fine class 5: fine acc 0.9367541766109785, correct fine 785/838 
fine class 6: fine acc 0.8473895582329317, correct fine 211/249 
fine class 7: fine acc 0.8651685393258427, correct fine 77/89 
fine class 8: fine acc 0.8257575757575758, correct fine 109/132 
fine class 9: fine acc 0.9, correct fine 9/10 
fine class 10: fine acc 0.8076923076923077, correct fine 21/26 
Overall Accuracy: 0.8977

Val Set, val_loss: 3.2548, val_error: 0.5265, auc: 0.6619
class 0 clustering acc 0.9910037878787878: correct 23023/23232 
class 1 clustering acc 0.17045454545454544: correct 360/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.2777777777777778, correct fine 5/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.7019230769230769, correct fine 73/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.3, correct fine 3/10 
fine class 8: fine acc 0.125, correct fine 2/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4735
Overall F1 Score: 0.2055

Training for fine level...
batch 100, loss: 0.0024, instance_loss: 0.1819, weighted_loss: 0.0563, label: 6, bag_size: 563
batch 200, loss: 0.0016, instance_loss: 0.2977, weighted_loss: 0.0904, label: 4, bag_size: 118
batch 300, loss: 1.7799, instance_loss: 0.3602, weighted_loss: 1.3540, label: 3, bag_size: 1706
batch 400, loss: 0.3208, instance_loss: 0.1988, weighted_loss: 0.2842, label: 2, bag_size: 374
batch 500, loss: 0.1125, instance_loss: 0.2486, weighted_loss: 0.1534, label: 8, bag_size: 185
batch 600, loss: 0.0000, instance_loss: 0.0482, weighted_loss: 0.0145, label: 5, bag_size: 620
batch 700, loss: 0.0003, instance_loss: 0.1063, weighted_loss: 0.0321, label: 2, bag_size: 692
batch 800, loss: 0.0726, instance_loss: 0.2660, weighted_loss: 0.1306, label: 7, bag_size: 263
batch 900, loss: 0.0017, instance_loss: 0.1925, weighted_loss: 0.0590, label: 3, bag_size: 605
batch 1000, loss: 0.0037, instance_loss: 0.0756, weighted_loss: 0.0253, label: 5, bag_size: 473
batch 1100, loss: 0.0162, instance_loss: 0.2011, weighted_loss: 0.0716, label: 8, bag_size: 361
batch 1200, loss: 0.7366, instance_loss: 0.4090, weighted_loss: 0.6383, label: 9, bag_size: 84
batch 1300, loss: 1.8721, instance_loss: 0.3723, weighted_loss: 1.4222, label: 8, bag_size: 435
batch 1400, loss: 0.0072, instance_loss: 0.0730, weighted_loss: 0.0269, label: 5, bag_size: 629
batch 1500, loss: 0.0029, instance_loss: 0.2976, weighted_loss: 0.0913, label: 4, bag_size: 606
batch 1600, loss: 0.0000, instance_loss: 0.0299, weighted_loss: 0.0090, label: 2, bag_size: 1231
batch 1700, loss: 0.0084, instance_loss: 0.3203, weighted_loss: 0.1020, label: 3, bag_size: 366
batch 1800, loss: 0.0000, instance_loss: 0.3130, weighted_loss: 0.0939, label: 4, bag_size: 37
batch 1900, loss: 0.1696, instance_loss: 0.2992, weighted_loss: 0.2085, label: 2, bag_size: 169
batch 2000, loss: 1.6632, instance_loss: 0.3489, weighted_loss: 1.2689, label: 8, bag_size: 253
batch 2100, loss: 0.0462, instance_loss: 0.1615, weighted_loss: 0.0808, label: 6, bag_size: 387

Instance Classifier Stats
class 0 clustering acc 0.9921082949308756: correct 189453/190960
class 1 clustering acc 0.26578341013824885: correct 4614/17360

Epoch: 25, train_loss: 0.2843, train_clustering_loss: 0.2079, train_error: 0.0991
fine class 0: fine acc 0.9166666666666666, correct fine 11/12 
fine class 1: fine acc 0.90625, correct fine 29/32 
fine class 2: fine acc 0.9110251450676983, correct fine 471/517 
fine class 3: fine acc 0.7933333333333333, correct fine 119/150 
fine class 4: fine acc 0.8782608695652174, correct fine 101/115 
fine class 5: fine acc 0.9463007159904535, correct fine 793/838 
fine class 6: fine acc 0.8674698795180723, correct fine 216/249 
fine class 7: fine acc 0.8314606741573034, correct fine 74/89 
fine class 8: fine acc 0.8333333333333334, correct fine 110/132 
fine class 9: fine acc 0.8, correct fine 8/10 
fine class 10: fine acc 0.8846153846153846, correct fine 23/26 
Overall Accuracy: 0.9009

Val Set, val_loss: 3.3221, val_error: 0.5341, auc: 0.6501
class 0 clustering acc 0.9922951101928374: correct 23053/23232 
class 1 clustering acc 0.15577651515151514: correct 329/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.5625, correct fine 36/64 
fine class 3: fine acc 0.2222222222222222, correct fine 4/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.6346153846153846, correct fine 66/104 
fine class 6: fine acc 0.3333333333333333, correct fine 10/30 
fine class 7: fine acc 0.3, correct fine 3/10 
fine class 8: fine acc 0.125, correct fine 2/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4659
Overall F1 Score: 0.2179

Training for fine level...
batch 100, loss: 0.0141, instance_loss: 0.1448, weighted_loss: 0.0533, label: 5, bag_size: 373
batch 200, loss: 0.0000, instance_loss: 0.1194, weighted_loss: 0.0358, label: 2, bag_size: 206
batch 300, loss: 0.0000, instance_loss: 0.0691, weighted_loss: 0.0207, label: 5, bag_size: 867
batch 400, loss: 0.0814, instance_loss: 0.1982, weighted_loss: 0.1164, label: 5, bag_size: 1165
batch 500, loss: 0.1537, instance_loss: 0.0705, weighted_loss: 0.1287, label: 5, bag_size: 713
batch 600, loss: 0.0010, instance_loss: 0.1505, weighted_loss: 0.0459, label: 2, bag_size: 666
batch 700, loss: 0.0097, instance_loss: 0.2336, weighted_loss: 0.0769, label: 3, bag_size: 806
batch 800, loss: 0.0016, instance_loss: 0.3736, weighted_loss: 0.1132, label: 10, bag_size: 724
batch 900, loss: 0.0032, instance_loss: 0.1071, weighted_loss: 0.0344, label: 5, bag_size: 239
batch 1000, loss: 0.0024, instance_loss: 0.2315, weighted_loss: 0.0712, label: 6, bag_size: 566
batch 1100, loss: 0.1537, instance_loss: 0.1011, weighted_loss: 0.1379, label: 5, bag_size: 304
batch 1200, loss: 0.0038, instance_loss: 0.3696, weighted_loss: 0.1136, label: 1, bag_size: 68
batch 1300, loss: 0.6679, instance_loss: 0.1940, weighted_loss: 0.5257, label: 2, bag_size: 123
batch 1400, loss: 0.0003, instance_loss: 0.0560, weighted_loss: 0.0170, label: 5, bag_size: 992
batch 1500, loss: 0.0748, instance_loss: 0.3294, weighted_loss: 0.1512, label: 6, bag_size: 304
batch 1600, loss: 0.0003, instance_loss: 0.2410, weighted_loss: 0.0725, label: 7, bag_size: 489
batch 1700, loss: 0.1166, instance_loss: 0.1309, weighted_loss: 0.1209, label: 5, bag_size: 644
batch 1800, loss: 0.0427, instance_loss: 0.2647, weighted_loss: 0.1093, label: 2, bag_size: 1744
batch 1900, loss: 0.0000, instance_loss: 0.1104, weighted_loss: 0.0332, label: 6, bag_size: 521
batch 2000, loss: 0.0000, instance_loss: 0.0973, weighted_loss: 0.0292, label: 2, bag_size: 623
batch 2100, loss: 0.0591, instance_loss: 0.2526, weighted_loss: 0.1171, label: 8, bag_size: 338

Instance Classifier Stats
class 0 clustering acc 0.9916527021365731: correct 189366/190960
class 1 clustering acc 0.2565668202764977: correct 4454/17360

Epoch: 26, train_loss: 0.2846, train_clustering_loss: 0.2114, train_error: 0.0797
fine class 0: fine acc 0.9166666666666666, correct fine 11/12 
fine class 1: fine acc 0.90625, correct fine 29/32 
fine class 2: fine acc 0.9245647969052224, correct fine 478/517 
fine class 3: fine acc 0.9133333333333333, correct fine 137/150 
fine class 4: fine acc 0.9217391304347826, correct fine 106/115 
fine class 5: fine acc 0.9534606205250596, correct fine 799/838 
fine class 6: fine acc 0.8554216867469879, correct fine 213/249 
fine class 7: fine acc 0.9101123595505618, correct fine 81/89 
fine class 8: fine acc 0.8560606060606061, correct fine 113/132 
fine class 9: fine acc 0.8, correct fine 8/10 
fine class 10: fine acc 0.8461538461538461, correct fine 22/26 
Overall Accuracy: 0.9203

Val Set, val_loss: 3.6042, val_error: 0.6098, auc: 0.6560
class 0 clustering acc 0.9920798898071626: correct 23048/23232 
class 1 clustering acc 0.15246212121212122: correct 322/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.34375, correct fine 22/64 
fine class 3: fine acc 0.16666666666666666, correct fine 3/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.625, correct fine 65/104 
fine class 6: fine acc 0.3, correct fine 9/30 
fine class 7: fine acc 0.2, correct fine 2/10 
fine class 8: fine acc 0.0625, correct fine 1/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.3902
Overall F1 Score: 0.1627

Training for fine level...
batch 100, loss: 1.6531, instance_loss: 0.3045, weighted_loss: 1.2485, label: 5, bag_size: 1678
batch 200, loss: 0.0001, instance_loss: 0.0419, weighted_loss: 0.0126, label: 5, bag_size: 296
batch 300, loss: 0.0000, instance_loss: 0.3944, weighted_loss: 0.1183, label: 4, bag_size: 424
batch 400, loss: 0.0220, instance_loss: 0.2527, weighted_loss: 0.0912, label: 2, bag_size: 341
batch 500, loss: 0.2120, instance_loss: 0.2387, weighted_loss: 0.2200, label: 5, bag_size: 112
batch 600, loss: 0.0004, instance_loss: 0.1448, weighted_loss: 0.0438, label: 2, bag_size: 1897
batch 700, loss: 0.0042, instance_loss: 0.1968, weighted_loss: 0.0620, label: 2, bag_size: 873
batch 800, loss: 0.0065, instance_loss: 0.1801, weighted_loss: 0.0586, label: 2, bag_size: 1700
batch 900, loss: 0.0000, instance_loss: 0.2328, weighted_loss: 0.0699, label: 6, bag_size: 563
batch 1000, loss: 0.0006, instance_loss: 0.3401, weighted_loss: 0.1024, label: 2, bag_size: 659
batch 1100, loss: 1.9374, instance_loss: 0.2679, weighted_loss: 1.4366, label: 2, bag_size: 78
batch 1200, loss: 0.0024, instance_loss: 0.2189, weighted_loss: 0.0674, label: 7, bag_size: 479
batch 1300, loss: 0.1557, instance_loss: 0.3586, weighted_loss: 0.2166, label: 3, bag_size: 522
batch 1400, loss: 0.0235, instance_loss: 0.1589, weighted_loss: 0.0642, label: 2, bag_size: 270
batch 1500, loss: 0.1849, instance_loss: 0.0290, weighted_loss: 0.1381, label: 5, bag_size: 331
batch 1600, loss: 0.0008, instance_loss: 0.0468, weighted_loss: 0.0146, label: 5, bag_size: 190
batch 1700, loss: 0.0000, instance_loss: 0.0361, weighted_loss: 0.0109, label: 2, bag_size: 2601
batch 1800, loss: 0.0001, instance_loss: 0.2965, weighted_loss: 0.0890, label: 6, bag_size: 273
batch 1900, loss: 0.0000, instance_loss: 0.0160, weighted_loss: 0.0048, label: 5, bag_size: 365
batch 2000, loss: 0.0004, instance_loss: 0.2159, weighted_loss: 0.0651, label: 2, bag_size: 1817
batch 2100, loss: 0.0272, instance_loss: 0.3057, weighted_loss: 0.1107, label: 6, bag_size: 156

Instance Classifier Stats
class 0 clustering acc 0.9919250104733975: correct 189418/190960
class 1 clustering acc 0.2547811059907834: correct 4423/17360

Epoch: 27, train_loss: 0.2109, train_clustering_loss: 0.2079, train_error: 0.0650
fine class 0: fine acc 0.9166666666666666, correct fine 11/12 
fine class 1: fine acc 0.9375, correct fine 30/32 
fine class 2: fine acc 0.9323017408123792, correct fine 482/517 
fine class 3: fine acc 0.9133333333333333, correct fine 137/150 
fine class 4: fine acc 0.9304347826086956, correct fine 107/115 
fine class 5: fine acc 0.9630071599045346, correct fine 807/838 
fine class 6: fine acc 0.9156626506024096, correct fine 228/249 
fine class 7: fine acc 0.898876404494382, correct fine 80/89 
fine class 8: fine acc 0.8636363636363636, correct fine 114/132 
fine class 9: fine acc 0.9, correct fine 9/10 
fine class 10: fine acc 0.9230769230769231, correct fine 24/26 
Overall Accuracy: 0.9350

Val Set, val_loss: 3.9224, val_error: 0.5379, auc: 0.6599
class 0 clustering acc 0.990788567493113: correct 23018/23232 
class 1 clustering acc 0.17140151515151514: correct 362/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.515625, correct fine 33/64 
fine class 3: fine acc 0.2777777777777778, correct fine 5/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.6923076923076923, correct fine 72/104 
fine class 6: fine acc 0.23333333333333334, correct fine 7/30 
fine class 7: fine acc 0.2, correct fine 2/10 
fine class 8: fine acc 0.125, correct fine 2/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4621
Overall F1 Score: 0.1954

Training for fine level...
batch 100, loss: 0.0006, instance_loss: 0.2481, weighted_loss: 0.0749, label: 2, bag_size: 2085
batch 200, loss: 0.0021, instance_loss: 0.1075, weighted_loss: 0.0337, label: 5, bag_size: 629
batch 300, loss: 0.6037, instance_loss: 0.3487, weighted_loss: 0.5272, label: 2, bag_size: 1009
batch 400, loss: 0.0002, instance_loss: 0.0247, weighted_loss: 0.0075, label: 5, bag_size: 305
batch 500, loss: 0.1312, instance_loss: 0.2361, weighted_loss: 0.1627, label: 2, bag_size: 454
batch 600, loss: 0.0000, instance_loss: 0.1642, weighted_loss: 0.0493, label: 2, bag_size: 385
batch 700, loss: 0.0000, instance_loss: 0.1261, weighted_loss: 0.0378, label: 5, bag_size: 131
batch 800, loss: 0.0000, instance_loss: 0.4026, weighted_loss: 0.1208, label: 4, bag_size: 1147
batch 900, loss: 0.4187, instance_loss: 0.3710, weighted_loss: 0.4044, label: 8, bag_size: 268
batch 1000, loss: 0.0003, instance_loss: 0.1135, weighted_loss: 0.0343, label: 5, bag_size: 310
batch 1100, loss: 0.0546, instance_loss: 0.3054, weighted_loss: 0.1298, label: 3, bag_size: 605
batch 1200, loss: 0.0069, instance_loss: 0.1541, weighted_loss: 0.0511, label: 5, bag_size: 187
batch 1300, loss: 0.0000, instance_loss: 0.1913, weighted_loss: 0.0574, label: 5, bag_size: 258
batch 1400, loss: 0.0001, instance_loss: 0.1709, weighted_loss: 0.0514, label: 5, bag_size: 368
batch 1500, loss: 2.0399, instance_loss: 0.2299, weighted_loss: 1.4969, label: 6, bag_size: 276
batch 1600, loss: 0.0000, instance_loss: 0.1518, weighted_loss: 0.0455, label: 5, bag_size: 237
batch 1700, loss: 0.0000, instance_loss: 0.0430, weighted_loss: 0.0129, label: 2, bag_size: 1447
batch 1800, loss: 0.0001, instance_loss: 0.0885, weighted_loss: 0.0266, label: 2, bag_size: 1632
batch 1900, loss: 0.0497, instance_loss: 0.1256, weighted_loss: 0.0725, label: 2, bag_size: 313
batch 2000, loss: 0.0004, instance_loss: 0.1790, weighted_loss: 0.0540, label: 2, bag_size: 1234
batch 2100, loss: 0.0294, instance_loss: 0.1666, weighted_loss: 0.0706, label: 2, bag_size: 848

Instance Classifier Stats
class 0 clustering acc 0.9922339757017177: correct 189477/190960
class 1 clustering acc 0.2529377880184332: correct 4391/17360

Epoch: 28, train_loss: 0.2398, train_clustering_loss: 0.2100, train_error: 0.0797
fine class 0: fine acc 0.8333333333333334, correct fine 10/12 
fine class 1: fine acc 0.8125, correct fine 26/32 
fine class 2: fine acc 0.9323017408123792, correct fine 482/517 
fine class 3: fine acc 0.8733333333333333, correct fine 131/150 
fine class 4: fine acc 0.9217391304347826, correct fine 106/115 
fine class 5: fine acc 0.954653937947494, correct fine 800/838 
fine class 6: fine acc 0.8634538152610441, correct fine 215/249 
fine class 7: fine acc 0.9325842696629213, correct fine 83/89 
fine class 8: fine acc 0.8409090909090909, correct fine 111/132 
fine class 9: fine acc 0.9, correct fine 9/10 
fine class 10: fine acc 0.9230769230769231, correct fine 24/26 
Overall Accuracy: 0.9203

Val Set, val_loss: 4.2235, val_error: 0.5985, auc: 0.6347
class 0 clustering acc 0.9902720385674931: correct 23006/23232 
class 1 clustering acc 0.1553030303030303: correct 328/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.390625, correct fine 25/64 
fine class 3: fine acc 0.2777777777777778, correct fine 5/18 
fine class 4: fine acc 0.07142857142857142, correct fine 1/14 
fine class 5: fine acc 0.5961538461538461, correct fine 62/104 
fine class 6: fine acc 0.26666666666666666, correct fine 8/30 
fine class 7: fine acc 0.2, correct fine 2/10 
fine class 8: fine acc 0.1875, correct fine 3/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4015
Overall F1 Score: 0.1812

Training for fine level...
batch 100, loss: 0.0819, instance_loss: 0.4454, weighted_loss: 0.1909, label: 6, bag_size: 641
batch 200, loss: 0.6120, instance_loss: 0.2398, weighted_loss: 0.5003, label: 2, bag_size: 1516
batch 300, loss: 0.0029, instance_loss: 0.1311, weighted_loss: 0.0414, label: 5, bag_size: 298
batch 400, loss: 0.5222, instance_loss: 0.2931, weighted_loss: 0.4534, label: 5, bag_size: 1897
batch 500, loss: 0.0474, instance_loss: 0.1731, weighted_loss: 0.0851, label: 5, bag_size: 342
batch 600, loss: 0.1229, instance_loss: 0.2021, weighted_loss: 0.1466, label: 5, bag_size: 746
batch 700, loss: 0.0000, instance_loss: 0.2254, weighted_loss: 0.0676, label: 5, bag_size: 621
batch 800, loss: 0.0030, instance_loss: 0.1289, weighted_loss: 0.0408, label: 5, bag_size: 525
batch 900, loss: 0.0000, instance_loss: 0.0105, weighted_loss: 0.0032, label: 5, bag_size: 198
batch 1000, loss: 0.0104, instance_loss: 0.1821, weighted_loss: 0.0619, label: 5, bag_size: 353
batch 1100, loss: 0.0000, instance_loss: 0.0875, weighted_loss: 0.0262, label: 5, bag_size: 838
batch 1200, loss: 0.0003, instance_loss: 0.1179, weighted_loss: 0.0356, label: 2, bag_size: 1189
batch 1300, loss: 0.0000, instance_loss: 0.0701, weighted_loss: 0.0210, label: 2, bag_size: 1229
batch 1400, loss: 0.0000, instance_loss: 0.1133, weighted_loss: 0.0340, label: 5, bag_size: 1281
batch 1500, loss: 0.0000, instance_loss: 0.0306, weighted_loss: 0.0092, label: 5, bag_size: 875
batch 1600, loss: 0.0005, instance_loss: 0.2864, weighted_loss: 0.0863, label: 2, bag_size: 442
batch 1700, loss: 0.0030, instance_loss: 0.0875, weighted_loss: 0.0283, label: 5, bag_size: 457
batch 1800, loss: 0.0000, instance_loss: 0.3174, weighted_loss: 0.0952, label: 6, bag_size: 344
batch 1900, loss: 0.0300, instance_loss: 0.1147, weighted_loss: 0.0554, label: 5, bag_size: 679
batch 2000, loss: 0.0037, instance_loss: 0.2090, weighted_loss: 0.0653, label: 2, bag_size: 654
batch 2100, loss: 0.0000, instance_loss: 0.1141, weighted_loss: 0.0342, label: 2, bag_size: 1691

Instance Classifier Stats
class 0 clustering acc 0.9923491830749895: correct 189499/190960
class 1 clustering acc 0.26630184331797235: correct 4623/17360

Epoch: 29, train_loss: 0.1962, train_clustering_loss: 0.2053, train_error: 0.0645
fine class 0: fine acc 1.0, correct fine 12/12 
fine class 1: fine acc 0.84375, correct fine 27/32 
fine class 2: fine acc 0.9439071566731141, correct fine 488/517 
fine class 3: fine acc 0.9133333333333333, correct fine 137/150 
fine class 4: fine acc 0.9478260869565217, correct fine 109/115 
fine class 5: fine acc 0.9665871121718377, correct fine 810/838 
fine class 6: fine acc 0.891566265060241, correct fine 222/249 
fine class 7: fine acc 0.898876404494382, correct fine 80/89 
fine class 8: fine acc 0.8636363636363636, correct fine 114/132 
fine class 9: fine acc 0.8, correct fine 8/10 
fine class 10: fine acc 0.8846153846153846, correct fine 23/26 
Overall Accuracy: 0.9355

Val Set, val_loss: 4.4853, val_error: 0.5341, auc: 0.6606
class 0 clustering acc 0.9920798898071626: correct 23048/23232 
class 1 clustering acc 0.1709280303030303: correct 361/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc 0.515625, correct fine 33/64 
fine class 3: fine acc 0.16666666666666666, correct fine 3/18 
fine class 4: fine acc 0.14285714285714285, correct fine 2/14 
fine class 5: fine acc 0.7403846153846154, correct fine 77/104 
fine class 6: fine acc 0.16666666666666666, correct fine 5/30 
fine class 7: fine acc 0.0, correct fine 0/10 
fine class 8: fine acc 0.125, correct fine 2/16 
fine class 9: fine acc 0.0, correct fine 0/1 
fine class 10: fine acc 0.3333333333333333, correct fine 1/3 
Overall Accuracy: 0.4659
Overall F1 Score: 0.2018

Val error: 0.4659, ROC AUC: 0.6756
