Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for fine level...
batch 100, loss: 2.9768, instance_loss: 1.2054, weighted_loss: 2.4454, label: 4, bag_size: 512
batch 200, loss: 2.6894, instance_loss: 0.9597, weighted_loss: 2.1705, label: 8, bag_size: 204
batch 300, loss: 1.9519, instance_loss: 0.7659, weighted_loss: 1.5961, label: 3, bag_size: 631
batch 400, loss: 1.7545, instance_loss: 0.5413, weighted_loss: 1.3905, label: 3, bag_size: 989
batch 500, loss: 0.9464, instance_loss: 0.4130, weighted_loss: 0.7864, label: 6, bag_size: 1830
batch 600, loss: 2.7973, instance_loss: 0.3495, weighted_loss: 2.0630, label: 10, bag_size: 249
batch 700, loss: 2.4599, instance_loss: 0.2761, weighted_loss: 1.8047, label: 7, bag_size: 581
batch 800, loss: 1.2614, instance_loss: 0.3354, weighted_loss: 0.9836, label: 3, bag_size: 1883
batch 900, loss: 1.8122, instance_loss: 0.2522, weighted_loss: 1.3442, label: 3, bag_size: 738
batch 1000, loss: 2.9875, instance_loss: 0.2813, weighted_loss: 2.1756, label: 5, bag_size: 1079
batch 1100, loss: 2.8624, instance_loss: 0.2937, weighted_loss: 2.0918, label: 5, bag_size: 308
batch 1200, loss: 0.9950, instance_loss: 0.1761, weighted_loss: 0.7493, label: 6, bag_size: 742
batch 1300, loss: 1.9644, instance_loss: 0.2376, weighted_loss: 1.4464, label: 7, bag_size: 284
batch 1400, loss: 2.4847, instance_loss: 0.2528, weighted_loss: 1.8151, label: 10, bag_size: 278
batch 1500, loss: 0.6608, instance_loss: 0.1598, weighted_loss: 0.5105, label: 6, bag_size: 365
batch 1600, loss: 0.9374, instance_loss: 0.1593, weighted_loss: 0.7040, label: 6, bag_size: 1600
batch 1700, loss: 2.2312, instance_loss: 0.2406, weighted_loss: 1.6340, label: 7, bag_size: 235
batch 1800, loss: 0.4297, instance_loss: 0.1522, weighted_loss: 0.3465, label: 6, bag_size: 1140
batch 1900, loss: 1.9777, instance_loss: 0.2413, weighted_loss: 1.4567, label: 7, bag_size: 239
batch 2000, loss: 0.4675, instance_loss: 0.1537, weighted_loss: 0.3734, label: 6, bag_size: 360
batch 2100, loss: 1.9480, instance_loss: 0.2317, weighted_loss: 1.4331, label: 7, bag_size: 373

Instance Classifier Stats
class 0 clustering acc 0.965367840684661: correct 234623/243040
class 1 clustering acc 0.02661290322580645: correct 462/17360

Epoch: 1, train_loss: 1.7627, train_clustering_loss:  0.3885, train_error: 0.5719
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.33268858800773693, correct fine 172/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.0, correct fine 0/115 
fine class 6: fine acc 0.9033412887828163, correct fine 757/838 
fine class 7: fine acc 0.0, correct fine 0/249 
fine class 8: fine acc 0.0, correct fine 0/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4281

Val Set, val_loss: 1.5734, val_error: 0.5227, auc: 0.7075
class 0 clustering acc 1.0: correct 29568/29568 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.640625, correct fine 41/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.0, correct fine 0/14 
fine class 6: fine acc 0.8173076923076923, correct fine 85/104 
fine class 7: fine acc 0.0, correct fine 0/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4773
Overall F1 Score: 0.1027

Training for fine level...
batch 100, loss: 1.9544, instance_loss: 0.2289, weighted_loss: 1.4368, label: 7, bag_size: 1655
batch 200, loss: 4.1351, instance_loss: 0.2740, weighted_loss: 2.9768, label: 13, bag_size: 472
batch 300, loss: 2.5746, instance_loss: 0.2463, weighted_loss: 1.8761, label: 10, bag_size: 195
batch 400, loss: 1.9982, instance_loss: 0.2062, weighted_loss: 1.4606, label: 3, bag_size: 559
batch 500, loss: 1.6352, instance_loss: 0.2226, weighted_loss: 1.2114, label: 3, bag_size: 393
batch 600, loss: 3.1391, instance_loss: 0.2411, weighted_loss: 2.2697, label: 10, bag_size: 233
batch 700, loss: 0.1961, instance_loss: 0.1224, weighted_loss: 0.1740, label: 6, bag_size: 460
batch 800, loss: 0.2338, instance_loss: 0.1124, weighted_loss: 0.1974, label: 6, bag_size: 844
batch 900, loss: 0.4966, instance_loss: 0.1385, weighted_loss: 0.3892, label: 6, bag_size: 458
batch 1000, loss: 4.2574, instance_loss: 0.3187, weighted_loss: 3.0758, label: 13, bag_size: 751
batch 1100, loss: 1.8640, instance_loss: 0.2394, weighted_loss: 1.3766, label: 10, bag_size: 216
batch 1200, loss: 2.2327, instance_loss: 0.2524, weighted_loss: 1.6386, label: 10, bag_size: 461
batch 1300, loss: 2.1200, instance_loss: 0.2022, weighted_loss: 1.5447, label: 7, bag_size: 194
batch 1400, loss: 1.0542, instance_loss: 0.1844, weighted_loss: 0.7933, label: 3, bag_size: 696
batch 1500, loss: 2.4731, instance_loss: 0.2572, weighted_loss: 1.8083, label: 8, bag_size: 152
batch 1600, loss: 1.4375, instance_loss: 0.1615, weighted_loss: 1.0547, label: 6, bag_size: 639
batch 1700, loss: 0.7948, instance_loss: 0.1372, weighted_loss: 0.5975, label: 6, bag_size: 237
batch 1800, loss: 1.4378, instance_loss: 0.1915, weighted_loss: 1.0639, label: 3, bag_size: 1214
batch 1900, loss: 0.0636, instance_loss: 0.0731, weighted_loss: 0.0664, label: 6, bag_size: 451
batch 2000, loss: 2.6117, instance_loss: 0.2900, weighted_loss: 1.9151, label: 8, bag_size: 263
batch 2100, loss: 0.3568, instance_loss: 0.0869, weighted_loss: 0.2758, label: 6, bag_size: 1081

Instance Classifier Stats
class 0 clustering acc 0.999806616194865: correct 242993/243040
class 1 clustering acc 0.012788018433179723: correct 222/17360

Epoch: 2, train_loss: 1.5325, train_clustering_loss:  0.1875, train_error: 0.5230
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.620889748549323, correct fine 321/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.0, correct fine 0/115 
fine class 6: fine acc 0.850835322195704, correct fine 713/838 
fine class 7: fine acc 0.004016064257028112, correct fine 1/249 
fine class 8: fine acc 0.0, correct fine 0/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4770

Val Set, val_loss: 1.4820, val_error: 0.4924, auc: 0.7565
class 0 clustering acc 0.9994588744588745: correct 29552/29568 
class 1 clustering acc 0.04640151515151515: correct 98/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.625, correct fine 40/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.0, correct fine 0/14 
fine class 6: fine acc 0.9038461538461539, correct fine 94/104 
fine class 7: fine acc 0.0, correct fine 0/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1085

Training for fine level...
batch 100, loss: 0.4841, instance_loss: 0.1127, weighted_loss: 0.3727, label: 3, bag_size: 1490
batch 200, loss: 1.8614, instance_loss: 0.2630, weighted_loss: 1.3819, label: 4, bag_size: 1404
batch 300, loss: 2.3567, instance_loss: 0.2517, weighted_loss: 1.7252, label: 8, bag_size: 179
batch 400, loss: 1.5646, instance_loss: 0.2176, weighted_loss: 1.1605, label: 3, bag_size: 823
batch 500, loss: 0.9088, instance_loss: 0.1600, weighted_loss: 0.6842, label: 3, bag_size: 440
batch 600, loss: 0.6984, instance_loss: 0.0917, weighted_loss: 0.5164, label: 6, bag_size: 291
batch 700, loss: 0.4401, instance_loss: 0.0913, weighted_loss: 0.3355, label: 6, bag_size: 743
batch 800, loss: 0.2352, instance_loss: 0.0653, weighted_loss: 0.1842, label: 6, bag_size: 1137
batch 900, loss: 2.0830, instance_loss: 0.2367, weighted_loss: 1.5291, label: 5, bag_size: 483
batch 1000, loss: 2.3983, instance_loss: 0.2361, weighted_loss: 1.7496, label: 5, bag_size: 374
batch 1100, loss: 0.1191, instance_loss: 0.0509, weighted_loss: 0.0986, label: 6, bag_size: 596
batch 1200, loss: 0.9975, instance_loss: 0.1428, weighted_loss: 0.7411, label: 3, bag_size: 663
batch 1300, loss: 1.4724, instance_loss: 0.2350, weighted_loss: 1.1012, label: 5, bag_size: 889
batch 1400, loss: 1.6507, instance_loss: 0.2296, weighted_loss: 1.2244, label: 7, bag_size: 589
batch 1500, loss: 0.8682, instance_loss: 0.1395, weighted_loss: 0.6496, label: 3, bag_size: 1628
batch 1600, loss: 0.5493, instance_loss: 0.1176, weighted_loss: 0.4198, label: 3, bag_size: 780
batch 1700, loss: 2.0025, instance_loss: 0.2338, weighted_loss: 1.4719, label: 7, bag_size: 1550
batch 1800, loss: 0.8977, instance_loss: 0.2157, weighted_loss: 0.6931, label: 7, bag_size: 92
batch 1900, loss: 0.8707, instance_loss: 0.1241, weighted_loss: 0.6467, label: 3, bag_size: 1323
batch 2000, loss: 1.5601, instance_loss: 0.1716, weighted_loss: 1.1436, label: 3, bag_size: 405
batch 2100, loss: 0.5741, instance_loss: 0.0722, weighted_loss: 0.4235, label: 6, bag_size: 575

Instance Classifier Stats
class 0 clustering acc 0.9989178736010533: correct 242777/243040
class 1 clustering acc 0.07194700460829494: correct 1249/17360

Epoch: 3, train_loss: 1.4504, train_clustering_loss:  0.1773, train_error: 0.5023
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6131528046421664, correct fine 317/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.0782608695652174, correct fine 9/115 
fine class 6: fine acc 0.8747016706443914, correct fine 733/838 
fine class 7: fine acc 0.08032128514056225, correct fine 20/249 
fine class 8: fine acc 0.0, correct fine 0/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.007575757575757576, correct fine 1/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4977

Val Set, val_loss: 1.4384, val_error: 0.4848, auc: 0.7786
class 0 clustering acc 0.9986471861471862: correct 29528/29568 
class 1 clustering acc 0.09943181818181818: correct 210/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.0, correct fine 0/14 
fine class 6: fine acc 0.9230769230769231, correct fine 96/104 
fine class 7: fine acc 0.06666666666666667, correct fine 2/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1203

Training for fine level...
batch 100, loss: 1.9466, instance_loss: 0.2011, weighted_loss: 1.4230, label: 6, bag_size: 621
batch 200, loss: 0.5570, instance_loss: 0.1220, weighted_loss: 0.4265, label: 3, bag_size: 2119
batch 300, loss: 0.8535, instance_loss: 0.1488, weighted_loss: 0.6421, label: 3, bag_size: 1700
batch 400, loss: 2.0775, instance_loss: 0.2001, weighted_loss: 1.5143, label: 3, bag_size: 493
batch 500, loss: 0.2803, instance_loss: 0.0959, weighted_loss: 0.2250, label: 3, bag_size: 1189
batch 600, loss: 0.5351, instance_loss: 0.1212, weighted_loss: 0.4110, label: 6, bag_size: 655
batch 700, loss: 0.7214, instance_loss: 0.1230, weighted_loss: 0.5418, label: 3, bag_size: 198
batch 800, loss: 1.7728, instance_loss: 0.1779, weighted_loss: 1.2943, label: 6, bag_size: 608
batch 900, loss: 0.2043, instance_loss: 0.0625, weighted_loss: 0.1617, label: 6, bag_size: 217
batch 1000, loss: 2.7985, instance_loss: 0.2673, weighted_loss: 2.0391, label: 10, bag_size: 338
batch 1100, loss: 3.4408, instance_loss: 0.2486, weighted_loss: 2.4831, label: 7, bag_size: 585
batch 1200, loss: 0.0462, instance_loss: 0.0459, weighted_loss: 0.0461, label: 6, bag_size: 1015
batch 1300, loss: 1.4956, instance_loss: 0.1921, weighted_loss: 1.1046, label: 6, bag_size: 237
batch 1400, loss: 1.3296, instance_loss: 0.1462, weighted_loss: 0.9746, label: 6, bag_size: 337
batch 1500, loss: 2.9452, instance_loss: 0.2543, weighted_loss: 2.1379, label: 4, bag_size: 175
batch 1600, loss: 1.2024, instance_loss: 0.1698, weighted_loss: 0.8926, label: 6, bag_size: 518
batch 1700, loss: 1.5627, instance_loss: 0.2326, weighted_loss: 1.1637, label: 4, bag_size: 831
batch 1800, loss: 0.5988, instance_loss: 0.1160, weighted_loss: 0.4540, label: 3, bag_size: 623
batch 1900, loss: 0.4482, instance_loss: 0.1043, weighted_loss: 0.3451, label: 3, bag_size: 1394
batch 2000, loss: 1.1653, instance_loss: 0.1695, weighted_loss: 0.8666, label: 6, bag_size: 214
batch 2100, loss: 0.4903, instance_loss: 0.1098, weighted_loss: 0.3762, label: 3, bag_size: 547

Instance Classifier Stats
class 0 clustering acc 0.998197827518104: correct 242602/243040
class 1 clustering acc 0.12016129032258065: correct 2086/17360

Epoch: 4, train_loss: 1.4071, train_clustering_loss:  0.1724, train_error: 0.4922
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5764023210831721, correct fine 298/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.1826086956521739, correct fine 21/115 
fine class 6: fine acc 0.8890214797136038, correct fine 745/838 
fine class 7: fine acc 0.13253012048192772, correct fine 33/249 
fine class 8: fine acc 0.0, correct fine 0/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.03787878787878788, correct fine 5/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5078

Val Set, val_loss: 1.4284, val_error: 0.4773, auc: 0.7901
class 0 clustering acc 0.9985457251082251: correct 29525/29568 
class 1 clustering acc 0.13352272727272727: correct 282/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.875, correct fine 91/104 
fine class 7: fine acc 0.3, correct fine 9/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1697

Training for fine level...
batch 100, loss: 0.8417, instance_loss: 0.1127, weighted_loss: 0.6230, label: 3, bag_size: 313
batch 200, loss: 1.6830, instance_loss: 0.2003, weighted_loss: 1.2382, label: 3, bag_size: 343
batch 300, loss: 1.8900, instance_loss: 0.2091, weighted_loss: 1.3858, label: 6, bag_size: 621
batch 400, loss: 0.6969, instance_loss: 0.1281, weighted_loss: 0.5263, label: 3, bag_size: 700
batch 500, loss: 2.2553, instance_loss: 0.1998, weighted_loss: 1.6386, label: 7, bag_size: 147
batch 600, loss: 0.0889, instance_loss: 0.0498, weighted_loss: 0.0772, label: 6, bag_size: 835
batch 700, loss: 1.8061, instance_loss: 0.1946, weighted_loss: 1.3227, label: 3, bag_size: 169
batch 800, loss: 0.9778, instance_loss: 0.1363, weighted_loss: 0.7253, label: 6, bag_size: 890
batch 900, loss: 2.3415, instance_loss: 0.2466, weighted_loss: 1.7131, label: 3, bag_size: 237
batch 1000, loss: 1.8009, instance_loss: 0.2021, weighted_loss: 1.3213, label: 7, bag_size: 75
batch 1100, loss: 1.5681, instance_loss: 0.2594, weighted_loss: 1.1755, label: 4, bag_size: 1120
batch 1200, loss: 1.5306, instance_loss: 0.2063, weighted_loss: 1.1333, label: 5, bag_size: 1279
batch 1300, loss: 3.8258, instance_loss: 0.2787, weighted_loss: 2.7617, label: 10, bag_size: 527
batch 1400, loss: 0.9597, instance_loss: 0.1547, weighted_loss: 0.7182, label: 6, bag_size: 422
batch 1500, loss: 0.0283, instance_loss: 0.0266, weighted_loss: 0.0278, label: 6, bag_size: 1015
batch 1600, loss: 1.0710, instance_loss: 0.1957, weighted_loss: 0.8084, label: 7, bag_size: 373
batch 1700, loss: 1.7638, instance_loss: 0.2023, weighted_loss: 1.2954, label: 7, bag_size: 276
batch 1800, loss: 3.1431, instance_loss: 0.2662, weighted_loss: 2.2800, label: 13, bag_size: 239
batch 1900, loss: 3.8039, instance_loss: 0.2703, weighted_loss: 2.7438, label: 5, bag_size: 402
batch 2000, loss: 1.9859, instance_loss: 0.2407, weighted_loss: 1.4623, label: 10, bag_size: 2076
batch 2100, loss: 0.0545, instance_loss: 0.0338, weighted_loss: 0.0483, label: 6, bag_size: 732

Instance Classifier Stats
class 0 clustering acc 0.9979509545753785: correct 242542/243040
class 1 clustering acc 0.1338709677419355: correct 2324/17360

Epoch: 5, train_loss: 1.3836, train_clustering_loss:  0.1703, train_error: 0.4788
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5589941972920697, correct fine 289/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.20869565217391303, correct fine 24/115 
fine class 6: fine acc 0.9093078758949881, correct fine 762/838 
fine class 7: fine acc 0.18473895582329317, correct fine 46/249 
fine class 8: fine acc 0.02247191011235955, correct fine 2/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.06060606060606061, correct fine 8/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5212

Val Set, val_loss: 1.4145, val_error: 0.4924, auc: 0.7875
class 0 clustering acc 0.9982075216450217: correct 29515/29568 
class 1 clustering acc 0.14441287878787878: correct 305/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.8653846153846154, correct fine 90/104 
fine class 7: fine acc 0.13333333333333333, correct fine 4/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1462

Training for fine level...
batch 100, loss: 1.7551, instance_loss: 0.2225, weighted_loss: 1.2953, label: 7, bag_size: 2046
batch 200, loss: 2.6314, instance_loss: 0.2492, weighted_loss: 1.9167, label: 8, bag_size: 426
batch 300, loss: 2.2849, instance_loss: 0.2551, weighted_loss: 1.6759, label: 4, bag_size: 410
batch 400, loss: 0.1868, instance_loss: 0.0630, weighted_loss: 0.1497, label: 6, bag_size: 97
batch 500, loss: 2.1902, instance_loss: 0.2167, weighted_loss: 1.5981, label: 3, bag_size: 165
batch 600, loss: 2.4344, instance_loss: 0.2282, weighted_loss: 1.7726, label: 10, bag_size: 96
batch 700, loss: 1.7180, instance_loss: 0.2220, weighted_loss: 1.2692, label: 3, bag_size: 726
batch 800, loss: 2.6019, instance_loss: 0.2359, weighted_loss: 1.8921, label: 7, bag_size: 2033
batch 900, loss: 0.1851, instance_loss: 0.0450, weighted_loss: 0.1431, label: 6, bag_size: 333
batch 1000, loss: 1.4308, instance_loss: 0.2177, weighted_loss: 1.0668, label: 5, bag_size: 1279
batch 1100, loss: 0.5023, instance_loss: 0.1918, weighted_loss: 0.4092, label: 7, bag_size: 343
batch 1200, loss: 1.6056, instance_loss: 0.1841, weighted_loss: 1.1791, label: 6, bag_size: 228
batch 1300, loss: 1.0113, instance_loss: 0.1589, weighted_loss: 0.7556, label: 6, bag_size: 335
batch 1400, loss: 1.6826, instance_loss: 0.2129, weighted_loss: 1.2417, label: 3, bag_size: 564
batch 1500, loss: 0.0753, instance_loss: 0.0386, weighted_loss: 0.0643, label: 6, bag_size: 364
batch 1600, loss: 1.3286, instance_loss: 0.1624, weighted_loss: 0.9788, label: 6, bag_size: 458
batch 1700, loss: 2.5507, instance_loss: 0.1980, weighted_loss: 1.8449, label: 6, bag_size: 100
batch 1800, loss: 1.7753, instance_loss: 0.2177, weighted_loss: 1.3080, label: 10, bag_size: 536
batch 1900, loss: 0.6242, instance_loss: 0.0750, weighted_loss: 0.4594, label: 6, bag_size: 773
batch 2000, loss: 1.7176, instance_loss: 0.1951, weighted_loss: 1.2608, label: 3, bag_size: 389
batch 2100, loss: 0.0589, instance_loss: 0.0523, weighted_loss: 0.0569, label: 6, bag_size: 83

Instance Classifier Stats
class 0 clustering acc 0.9978645490454247: correct 242521/243040
class 1 clustering acc 0.1472926267281106: correct 2557/17360

Epoch: 6, train_loss: 1.3618, train_clustering_loss:  0.1679, train_error: 0.4797
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5667311411992263, correct fine 293/517 
fine class 4: fine acc 0.006666666666666667, correct fine 1/150 
fine class 5: fine acc 0.24347826086956523, correct fine 28/115 
fine class 6: fine acc 0.8878281622911695, correct fine 744/838 
fine class 7: fine acc 0.21686746987951808, correct fine 54/249 
fine class 8: fine acc 0.033707865168539325, correct fine 3/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.045454545454545456, correct fine 6/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5203

Val Set, val_loss: 1.4104, val_error: 0.4773, auc: 0.7903
class 0 clustering acc 0.997362012987013: correct 29490/29568 
class 1 clustering acc 0.16571969696969696: correct 350/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9038461538461539, correct fine 94/104 
fine class 7: fine acc 0.06666666666666667, correct fine 2/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1497

Training for fine level...
batch 100, loss: 0.1385, instance_loss: 0.0443, weighted_loss: 0.1103, label: 6, bag_size: 755
batch 200, loss: 0.8169, instance_loss: 0.1433, weighted_loss: 0.6148, label: 3, bag_size: 1293
batch 300, loss: 0.8458, instance_loss: 0.1351, weighted_loss: 0.6326, label: 6, bag_size: 290
batch 400, loss: 0.5218, instance_loss: 0.1175, weighted_loss: 0.4005, label: 3, bag_size: 270
batch 500, loss: 0.3092, instance_loss: 0.0860, weighted_loss: 0.2423, label: 3, bag_size: 224
batch 600, loss: 2.9777, instance_loss: 0.2238, weighted_loss: 2.1516, label: 4, bag_size: 972
batch 700, loss: 0.0253, instance_loss: 0.0250, weighted_loss: 0.0252, label: 6, bag_size: 424
batch 800, loss: 2.0097, instance_loss: 0.1894, weighted_loss: 1.4636, label: 3, bag_size: 119
batch 900, loss: 1.1776, instance_loss: 0.2521, weighted_loss: 0.9000, label: 4, bag_size: 1781
batch 1000, loss: 1.2310, instance_loss: 0.1716, weighted_loss: 0.9132, label: 6, bag_size: 331
batch 1100, loss: 2.6631, instance_loss: 0.2288, weighted_loss: 1.9328, label: 5, bag_size: 425
batch 1200, loss: 1.0749, instance_loss: 0.1461, weighted_loss: 0.7963, label: 6, bag_size: 193
batch 1300, loss: 1.0617, instance_loss: 0.1406, weighted_loss: 0.7854, label: 6, bag_size: 337
batch 1400, loss: 0.7397, instance_loss: 0.1354, weighted_loss: 0.5585, label: 6, bag_size: 235
batch 1500, loss: 0.9418, instance_loss: 0.1669, weighted_loss: 0.7093, label: 6, bag_size: 286
batch 1600, loss: 0.2465, instance_loss: 0.0476, weighted_loss: 0.1869, label: 6, bag_size: 1304
batch 1700, loss: 1.5758, instance_loss: 0.1888, weighted_loss: 1.1597, label: 3, bag_size: 442
batch 1800, loss: 0.1797, instance_loss: 0.0591, weighted_loss: 0.1435, label: 6, bag_size: 365
batch 1900, loss: 0.6063, instance_loss: 0.1073, weighted_loss: 0.4566, label: 3, bag_size: 1233
batch 2000, loss: 1.4574, instance_loss: 0.1789, weighted_loss: 1.0739, label: 3, bag_size: 1124
batch 2100, loss: 3.1087, instance_loss: 0.2583, weighted_loss: 2.2536, label: 5, bag_size: 607

Instance Classifier Stats
class 0 clustering acc 0.9974695523370638: correct 242425/243040
class 1 clustering acc 0.15691244239631336: correct 2724/17360

Epoch: 7, train_loss: 1.3431, train_clustering_loss:  0.1664, train_error: 0.4700
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5725338491295938, correct fine 296/517 
fine class 4: fine acc 0.006666666666666667, correct fine 1/150 
fine class 5: fine acc 0.24347826086956523, correct fine 28/115 
fine class 6: fine acc 0.9021479713603818, correct fine 756/838 
fine class 7: fine acc 0.22088353413654618, correct fine 55/249 
fine class 8: fine acc 0.06741573033707865, correct fine 6/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.06060606060606061, correct fine 8/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5300

Val Set, val_loss: 1.4014, val_error: 0.4621, auc: 0.7912
class 0 clustering acc 0.9980722402597403: correct 29511/29568 
class 1 clustering acc 0.16714015151515152: correct 353/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8942307692307693, correct fine 93/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5379
Overall F1 Score: 0.1797

Training for fine level...
batch 100, loss: 0.7745, instance_loss: 0.1320, weighted_loss: 0.5817, label: 3, bag_size: 1470
batch 200, loss: 3.1716, instance_loss: 0.2554, weighted_loss: 2.2967, label: 4, bag_size: 233
batch 300, loss: 1.6955, instance_loss: 0.2170, weighted_loss: 1.2519, label: 10, bag_size: 130
batch 400, loss: 1.4221, instance_loss: 0.1890, weighted_loss: 1.0522, label: 3, bag_size: 551
batch 500, loss: 0.9040, instance_loss: 0.1321, weighted_loss: 0.6724, label: 6, bag_size: 1068
batch 600, loss: 0.0935, instance_loss: 0.0396, weighted_loss: 0.0773, label: 6, bag_size: 330
batch 700, loss: 0.8150, instance_loss: 0.1598, weighted_loss: 0.6185, label: 3, bag_size: 238
batch 800, loss: 1.8981, instance_loss: 0.2259, weighted_loss: 1.3964, label: 7, bag_size: 625
batch 900, loss: 1.0453, instance_loss: 0.1545, weighted_loss: 0.7781, label: 6, bag_size: 286
batch 1000, loss: 1.6827, instance_loss: 0.1996, weighted_loss: 1.2378, label: 5, bag_size: 225
batch 1100, loss: 2.0081, instance_loss: 0.2229, weighted_loss: 1.4725, label: 4, bag_size: 570
batch 1200, loss: 1.2433, instance_loss: 0.1964, weighted_loss: 0.9293, label: 3, bag_size: 910
batch 1300, loss: 0.9430, instance_loss: 0.2320, weighted_loss: 0.7297, label: 7, bag_size: 555
batch 1400, loss: 2.9280, instance_loss: 0.2436, weighted_loss: 2.1226, label: 4, bag_size: 202
batch 1500, loss: 3.6734, instance_loss: 0.3289, weighted_loss: 2.6701, label: 13, bag_size: 829
batch 1600, loss: 0.4041, instance_loss: 0.1061, weighted_loss: 0.3147, label: 3, bag_size: 1534
batch 1700, loss: 2.5636, instance_loss: 0.2400, weighted_loss: 1.8665, label: 6, bag_size: 477
batch 1800, loss: 0.9976, instance_loss: 0.1600, weighted_loss: 0.7463, label: 6, bag_size: 548
batch 1900, loss: 2.5036, instance_loss: 0.2294, weighted_loss: 1.8213, label: 8, bag_size: 1196
batch 2000, loss: 0.8611, instance_loss: 0.2633, weighted_loss: 0.6818, label: 7, bag_size: 1072
batch 2100, loss: 0.7766, instance_loss: 0.0936, weighted_loss: 0.5717, label: 6, bag_size: 192

Instance Classifier Stats
class 0 clustering acc 0.9974818959842001: correct 242428/243040
class 1 clustering acc 0.16140552995391705: correct 2802/17360

Epoch: 8, train_loss: 1.3266, train_clustering_loss:  0.1646, train_error: 0.4682
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5957446808510638, correct fine 308/517 
fine class 4: fine acc 0.02, correct fine 3/150 
fine class 5: fine acc 0.2782608695652174, correct fine 32/115 
fine class 6: fine acc 0.8782816229116945, correct fine 736/838 
fine class 7: fine acc 0.24899598393574296, correct fine 62/249 
fine class 8: fine acc 0.07865168539325842, correct fine 7/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.045454545454545456, correct fine 6/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5318

Val Set, val_loss: 1.3990, val_error: 0.4621, auc: 0.7926
class 0 clustering acc 0.9981060606060606: correct 29512/29568 
class 1 clustering acc 0.16571969696969696: correct 350/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.9230769230769231, correct fine 96/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5379
Overall F1 Score: 0.1669

Training for fine level...
batch 100, loss: 0.0518, instance_loss: 0.0275, weighted_loss: 0.0445, label: 6, bag_size: 201
batch 200, loss: 1.4743, instance_loss: 0.1865, weighted_loss: 1.0880, label: 6, bag_size: 1897
batch 300, loss: 2.1756, instance_loss: 0.2194, weighted_loss: 1.5887, label: 10, bag_size: 268
batch 400, loss: 1.4607, instance_loss: 0.2018, weighted_loss: 1.0830, label: 10, bag_size: 756
batch 500, loss: 0.0751, instance_loss: 0.0372, weighted_loss: 0.0637, label: 6, bag_size: 587
batch 600, loss: 0.4430, instance_loss: 0.0784, weighted_loss: 0.3337, label: 3, bag_size: 884
batch 700, loss: 0.5542, instance_loss: 0.1071, weighted_loss: 0.4201, label: 3, bag_size: 1875
batch 800, loss: 1.2538, instance_loss: 0.2154, weighted_loss: 0.9422, label: 7, bag_size: 346
batch 900, loss: 0.2871, instance_loss: 0.0989, weighted_loss: 0.2306, label: 3, bag_size: 1110
batch 1000, loss: 1.2346, instance_loss: 0.1713, weighted_loss: 0.9156, label: 3, bag_size: 241
batch 1100, loss: 0.9969, instance_loss: 0.1131, weighted_loss: 0.7318, label: 3, bag_size: 939
batch 1200, loss: 0.9179, instance_loss: 0.1415, weighted_loss: 0.6850, label: 6, bag_size: 138
batch 1300, loss: 0.6142, instance_loss: 0.1131, weighted_loss: 0.4639, label: 3, bag_size: 663
batch 1400, loss: 0.3339, instance_loss: 0.0561, weighted_loss: 0.2506, label: 6, bag_size: 637
batch 1500, loss: 0.2230, instance_loss: 0.0714, weighted_loss: 0.1775, label: 6, bag_size: 860
batch 1600, loss: 0.0700, instance_loss: 0.0431, weighted_loss: 0.0620, label: 6, bag_size: 866
batch 1700, loss: 0.3672, instance_loss: 0.0578, weighted_loss: 0.2744, label: 3, bag_size: 2121
batch 1800, loss: 1.7986, instance_loss: 0.1856, weighted_loss: 1.3147, label: 3, bag_size: 298
batch 1900, loss: 1.0042, instance_loss: 0.1553, weighted_loss: 0.7495, label: 6, bag_size: 299
batch 2000, loss: 0.4568, instance_loss: 0.1256, weighted_loss: 0.3574, label: 6, bag_size: 665
batch 2100, loss: 0.0954, instance_loss: 0.0320, weighted_loss: 0.0764, label: 6, bag_size: 969

Instance Classifier Stats
class 0 clustering acc 0.9975765306122449: correct 242451/243040
class 1 clustering acc 0.16463133640552996: correct 2858/17360

Epoch: 9, train_loss: 1.3067, train_clustering_loss:  0.1636, train_error: 0.4627
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5880077369439072, correct fine 304/517 
fine class 4: fine acc 0.02666666666666667, correct fine 4/150 
fine class 5: fine acc 0.2782608695652174, correct fine 32/115 
fine class 6: fine acc 0.8937947494033412, correct fine 749/838 
fine class 7: fine acc 0.2289156626506024, correct fine 57/249 
fine class 8: fine acc 0.12359550561797752, correct fine 11/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.06818181818181818, correct fine 9/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5373

Val Set, val_loss: 1.4033, val_error: 0.4659, auc: 0.7933
class 0 clustering acc 0.997564935064935: correct 29496/29568 
class 1 clustering acc 0.17708333333333334: correct 374/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.9038461538461539, correct fine 94/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5341
Overall F1 Score: 0.1648

Training for fine level...
batch 100, loss: 1.9649, instance_loss: 0.2148, weighted_loss: 1.4398, label: 4, bag_size: 1150
batch 200, loss: 3.6398, instance_loss: 0.2769, weighted_loss: 2.6309, label: 8, bag_size: 704
batch 300, loss: 1.6797, instance_loss: 0.2017, weighted_loss: 1.2363, label: 7, bag_size: 276
batch 400, loss: 4.2852, instance_loss: 0.3305, weighted_loss: 3.0988, label: 10, bag_size: 1009
batch 500, loss: 4.1929, instance_loss: 0.3001, weighted_loss: 3.0251, label: 8, bag_size: 393
batch 600, loss: 0.6568, instance_loss: 0.1867, weighted_loss: 0.5157, label: 7, bag_size: 461
batch 700, loss: 0.1294, instance_loss: 0.0306, weighted_loss: 0.0998, label: 6, bag_size: 515
batch 800, loss: 2.5569, instance_loss: 0.2258, weighted_loss: 1.8576, label: 7, bag_size: 389
batch 900, loss: 1.6694, instance_loss: 0.1670, weighted_loss: 1.2187, label: 6, bag_size: 153
batch 1000, loss: 1.7153, instance_loss: 0.2038, weighted_loss: 1.2618, label: 10, bag_size: 201
batch 1100, loss: 1.6912, instance_loss: 0.2295, weighted_loss: 1.2527, label: 3, bag_size: 559
batch 1200, loss: 0.6163, instance_loss: 0.1149, weighted_loss: 0.4659, label: 6, bag_size: 545
batch 1300, loss: 3.6839, instance_loss: 0.3107, weighted_loss: 2.6720, label: 13, bag_size: 752
batch 1400, loss: 0.1125, instance_loss: 0.0452, weighted_loss: 0.0923, label: 6, bag_size: 796
batch 1500, loss: 0.7919, instance_loss: 0.1851, weighted_loss: 0.6099, label: 7, bag_size: 444
batch 1600, loss: 0.0244, instance_loss: 0.0179, weighted_loss: 0.0225, label: 6, bag_size: 1040
batch 1700, loss: 1.2380, instance_loss: 0.1754, weighted_loss: 0.9192, label: 6, bag_size: 204
batch 1800, loss: 0.6652, instance_loss: 0.0842, weighted_loss: 0.4909, label: 3, bag_size: 1360
batch 1900, loss: 1.8349, instance_loss: 0.2402, weighted_loss: 1.3565, label: 7, bag_size: 669
batch 2000, loss: 1.1908, instance_loss: 0.1695, weighted_loss: 0.8844, label: 3, bag_size: 183
batch 2100, loss: 2.3577, instance_loss: 0.2134, weighted_loss: 1.7144, label: 10, bag_size: 378

Instance Classifier Stats
class 0 clustering acc 0.9976012179065175: correct 242457/243040
class 1 clustering acc 0.16370967741935483: correct 2842/17360

Epoch: 10, train_loss: 1.2944, train_clustering_loss:  0.1626, train_error: 0.4631
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5957446808510638, correct fine 308/517 
fine class 4: fine acc 0.04666666666666667, correct fine 7/150 
fine class 5: fine acc 0.26956521739130435, correct fine 31/115 
fine class 6: fine acc 0.8663484486873508, correct fine 726/838 
fine class 7: fine acc 0.2931726907630522, correct fine 73/249 
fine class 8: fine acc 0.12359550561797752, correct fine 11/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.06060606060606061, correct fine 8/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5369

Val Set, val_loss: 1.4027, val_error: 0.4697, auc: 0.7930
class 0 clustering acc 0.9971252705627706: correct 29483/29568 
class 1 clustering acc 0.18607954545454544: correct 393/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9326923076923077, correct fine 97/104 
fine class 7: fine acc 0.06666666666666667, correct fine 2/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5303
Overall F1 Score: 0.1666

Training for fine level...
batch 100, loss: 2.4237, instance_loss: 0.2296, weighted_loss: 1.7655, label: 5, bag_size: 235
batch 200, loss: 1.4817, instance_loss: 0.1865, weighted_loss: 1.0932, label: 10, bag_size: 216
batch 300, loss: 0.0634, instance_loss: 0.0259, weighted_loss: 0.0521, label: 6, bag_size: 658
batch 400, loss: 1.2958, instance_loss: 0.1155, weighted_loss: 0.9417, label: 6, bag_size: 595
batch 500, loss: 0.0092, instance_loss: 0.0146, weighted_loss: 0.0108, label: 6, bag_size: 241
batch 600, loss: 4.1093, instance_loss: 0.2772, weighted_loss: 2.9597, label: 6, bag_size: 362
batch 700, loss: 2.9311, instance_loss: 0.2904, weighted_loss: 2.1389, label: 10, bag_size: 838
batch 800, loss: 2.8525, instance_loss: 0.2618, weighted_loss: 2.0753, label: 5, bag_size: 264
batch 900, loss: 1.0309, instance_loss: 0.1345, weighted_loss: 0.7620, label: 3, bag_size: 1205
batch 1000, loss: 1.3238, instance_loss: 0.1885, weighted_loss: 0.9832, label: 6, bag_size: 275
batch 1100, loss: 2.6884, instance_loss: 0.2600, weighted_loss: 1.9599, label: 4, bag_size: 188
batch 1200, loss: 3.0741, instance_loss: 0.2349, weighted_loss: 2.2223, label: 8, bag_size: 274
batch 1300, loss: 0.4147, instance_loss: 0.0915, weighted_loss: 0.3177, label: 3, bag_size: 1099
batch 1400, loss: 1.2384, instance_loss: 0.1903, weighted_loss: 0.9240, label: 7, bag_size: 222
batch 1500, loss: 0.6271, instance_loss: 0.1115, weighted_loss: 0.4724, label: 6, bag_size: 317
batch 1600, loss: 1.8608, instance_loss: 0.2139, weighted_loss: 1.3667, label: 10, bag_size: 259
batch 1700, loss: 0.0282, instance_loss: 0.0228, weighted_loss: 0.0265, label: 6, bag_size: 296
batch 1800, loss: 0.1242, instance_loss: 0.0429, weighted_loss: 0.0998, label: 6, bag_size: 921
batch 1900, loss: 1.1424, instance_loss: 0.1918, weighted_loss: 0.8572, label: 7, bag_size: 701
batch 2000, loss: 4.5934, instance_loss: 0.4099, weighted_loss: 3.3384, label: 8, bag_size: 561
batch 2100, loss: 1.4553, instance_loss: 0.2146, weighted_loss: 1.0831, label: 3, bag_size: 369

Instance Classifier Stats
class 0 clustering acc 0.9975271560236998: correct 242439/243040
class 1 clustering acc 0.17004608294930876: correct 2952/17360

Epoch: 11, train_loss: 1.2760, train_clustering_loss:  0.1620, train_error: 0.4507
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.125, correct fine 4/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6150870406189555, correct fine 318/517 
fine class 4: fine acc 0.06, correct fine 9/150 
fine class 5: fine acc 0.26956521739130435, correct fine 31/115 
fine class 6: fine acc 0.8806682577565632, correct fine 738/838 
fine class 7: fine acc 0.27309236947791166, correct fine 68/249 
fine class 8: fine acc 0.16853932584269662, correct fine 15/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.06818181818181818, correct fine 9/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5493

Val Set, val_loss: 1.4097, val_error: 0.4697, auc: 0.7900
class 0 clustering acc 0.997260551948052: correct 29487/29568 
class 1 clustering acc 0.18892045454545456: correct 399/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9423076923076923, correct fine 98/104 
fine class 7: fine acc 0.06666666666666667, correct fine 2/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5303
Overall F1 Score: 0.1651

Training for fine level...
batch 100, loss: 3.3648, instance_loss: 0.3496, weighted_loss: 2.4602, label: 10, bag_size: 380
batch 200, loss: 2.2813, instance_loss: 0.2083, weighted_loss: 1.6594, label: 7, bag_size: 224
batch 300, loss: 0.6852, instance_loss: 0.1588, weighted_loss: 0.5273, label: 6, bag_size: 322
batch 400, loss: 0.9201, instance_loss: 0.1344, weighted_loss: 0.6844, label: 6, bag_size: 335
batch 500, loss: 0.4698, instance_loss: 0.0981, weighted_loss: 0.3583, label: 3, bag_size: 1253
batch 600, loss: 1.9364, instance_loss: 0.2415, weighted_loss: 1.4279, label: 6, bag_size: 2209
batch 700, loss: 0.3661, instance_loss: 0.0972, weighted_loss: 0.2854, label: 3, bag_size: 2220
batch 800, loss: 1.8140, instance_loss: 0.2177, weighted_loss: 1.3351, label: 4, bag_size: 428
batch 900, loss: 0.7776, instance_loss: 0.1581, weighted_loss: 0.5917, label: 3, bag_size: 223
batch 1000, loss: 1.8832, instance_loss: 0.2388, weighted_loss: 1.3899, label: 3, bag_size: 983
batch 1100, loss: 2.5081, instance_loss: 0.2446, weighted_loss: 1.8291, label: 4, bag_size: 1168
batch 1200, loss: 1.3562, instance_loss: 0.2039, weighted_loss: 1.0105, label: 4, bag_size: 1632
batch 1300, loss: 1.0029, instance_loss: 0.1590, weighted_loss: 0.7497, label: 6, bag_size: 214
batch 1400, loss: 1.8839, instance_loss: 0.2168, weighted_loss: 1.3838, label: 7, bag_size: 274
batch 1500, loss: 1.4355, instance_loss: 0.1933, weighted_loss: 1.0629, label: 3, bag_size: 341
batch 1600, loss: 0.1696, instance_loss: 0.0724, weighted_loss: 0.1404, label: 3, bag_size: 534
batch 1700, loss: 2.4534, instance_loss: 0.2682, weighted_loss: 1.7979, label: 8, bag_size: 269
batch 1800, loss: 0.2281, instance_loss: 0.0846, weighted_loss: 0.1850, label: 6, bag_size: 681
batch 1900, loss: 3.8339, instance_loss: 0.3077, weighted_loss: 2.7761, label: 5, bag_size: 1030
batch 2000, loss: 0.5657, instance_loss: 0.1026, weighted_loss: 0.4268, label: 3, bag_size: 2104
batch 2100, loss: 0.8527, instance_loss: 0.1132, weighted_loss: 0.6308, label: 6, bag_size: 480

Instance Classifier Stats
class 0 clustering acc 0.9974654377880184: correct 242424/243040
class 1 clustering acc 0.175: correct 3038/17360

Epoch: 12, train_loss: 1.2622, train_clustering_loss:  0.1610, train_error: 0.4419
fine class 0: fine acc 0.16666666666666666, correct fine 2/12 
fine class 1: fine acc 0.09375, correct fine 3/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6092843326885881, correct fine 315/517 
fine class 4: fine acc 0.06666666666666667, correct fine 10/150 
fine class 5: fine acc 0.2782608695652174, correct fine 32/115 
fine class 6: fine acc 0.89618138424821, correct fine 751/838 
fine class 7: fine acc 0.2931726907630522, correct fine 73/249 
fine class 8: fine acc 0.16853932584269662, correct fine 15/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.07575757575757576, correct fine 10/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5581

Val Set, val_loss: 1.4112, val_error: 0.4697, auc: 0.7886
class 0 clustering acc 0.9980722402597403: correct 29511/29568 
class 1 clustering acc 0.1690340909090909: correct 357/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8461538461538461, correct fine 88/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5303
Overall F1 Score: 0.2061

Training for fine level...
batch 100, loss: 0.3730, instance_loss: 0.0571, weighted_loss: 0.2782, label: 6, bag_size: 225
batch 200, loss: 1.5446, instance_loss: 0.1658, weighted_loss: 1.1310, label: 3, bag_size: 389
batch 300, loss: 2.5032, instance_loss: 0.3056, weighted_loss: 1.8439, label: 3, bag_size: 559
batch 400, loss: 1.5050, instance_loss: 0.1333, weighted_loss: 1.0935, label: 6, bag_size: 555
batch 500, loss: 0.9368, instance_loss: 0.1356, weighted_loss: 0.6965, label: 3, bag_size: 975
batch 600, loss: 1.0796, instance_loss: 0.1795, weighted_loss: 0.8096, label: 3, bag_size: 265
batch 700, loss: 0.6097, instance_loss: 0.1646, weighted_loss: 0.4762, label: 8, bag_size: 163
batch 800, loss: 3.6067, instance_loss: 0.2501, weighted_loss: 2.5997, label: 7, bag_size: 2193
batch 900, loss: 0.0295, instance_loss: 0.0208, weighted_loss: 0.0269, label: 6, bag_size: 724
batch 1000, loss: 1.9911, instance_loss: 0.2252, weighted_loss: 1.4613, label: 7, bag_size: 506
batch 1100, loss: 3.8853, instance_loss: 0.3177, weighted_loss: 2.8150, label: 8, bag_size: 393
batch 1200, loss: 4.2870, instance_loss: 0.3249, weighted_loss: 3.0983, label: 13, bag_size: 289
batch 1300, loss: 0.4167, instance_loss: 0.1014, weighted_loss: 0.3221, label: 3, bag_size: 1771
batch 1400, loss: 0.2232, instance_loss: 0.0864, weighted_loss: 0.1822, label: 6, bag_size: 289
batch 1500, loss: 1.3780, instance_loss: 0.2062, weighted_loss: 1.0265, label: 4, bag_size: 483
batch 1600, loss: 2.1863, instance_loss: 0.2346, weighted_loss: 1.6008, label: 4, bag_size: 398
batch 1700, loss: 2.3383, instance_loss: 0.2536, weighted_loss: 1.7129, label: 1, bag_size: 369
batch 1800, loss: 0.0265, instance_loss: 0.0202, weighted_loss: 0.0246, label: 6, bag_size: 444
batch 1900, loss: 0.8852, instance_loss: 0.1038, weighted_loss: 0.6508, label: 3, bag_size: 1360
batch 2000, loss: 4.1123, instance_loss: 0.3300, weighted_loss: 2.9776, label: 13, bag_size: 751
batch 2100, loss: 1.8517, instance_loss: 0.2033, weighted_loss: 1.3572, label: 3, bag_size: 298

Instance Classifier Stats
class 0 clustering acc 0.9972885121790652: correct 242381/243040
class 1 clustering acc 0.1775921658986175: correct 3083/17360

Epoch: 13, train_loss: 1.2456, train_clustering_loss:  0.1604, train_error: 0.4387
fine class 0: fine acc 0.16666666666666666, correct fine 2/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6034816247582205, correct fine 312/517 
fine class 4: fine acc 0.10666666666666667, correct fine 16/150 
fine class 5: fine acc 0.3217391304347826, correct fine 37/115 
fine class 6: fine acc 0.8842482100238663, correct fine 741/838 
fine class 7: fine acc 0.30120481927710846, correct fine 75/249 
fine class 8: fine acc 0.2247191011235955, correct fine 20/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.07575757575757576, correct fine 10/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5613

Val Set, val_loss: 1.4135, val_error: 0.4659, auc: 0.7881
class 0 clustering acc 0.9982075216450217: correct 29515/29568 
class 1 clustering acc 0.1690340909090909: correct 357/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8269230769230769, correct fine 86/104 
fine class 7: fine acc 0.36666666666666664, correct fine 11/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5341
Overall F1 Score: 0.2010

Training for fine level...
batch 100, loss: 0.0324, instance_loss: 0.0162, weighted_loss: 0.0275, label: 6, bag_size: 312
batch 200, loss: 0.6230, instance_loss: 0.1763, weighted_loss: 0.4890, label: 7, bag_size: 171
batch 300, loss: 1.1876, instance_loss: 0.1848, weighted_loss: 0.8867, label: 3, bag_size: 356
batch 400, loss: 1.5533, instance_loss: 0.1823, weighted_loss: 1.1420, label: 3, bag_size: 271
batch 500, loss: 0.4237, instance_loss: 0.1075, weighted_loss: 0.3289, label: 3, bag_size: 821
batch 600, loss: 0.5119, instance_loss: 0.1655, weighted_loss: 0.4080, label: 5, bag_size: 488
batch 700, loss: 1.9690, instance_loss: 0.2174, weighted_loss: 1.4435, label: 3, bag_size: 186
batch 800, loss: 1.9851, instance_loss: 0.2353, weighted_loss: 1.4602, label: 4, bag_size: 459
batch 900, loss: 1.9895, instance_loss: 0.2460, weighted_loss: 1.4664, label: 3, bag_size: 983
batch 1000, loss: 1.7103, instance_loss: 0.2090, weighted_loss: 1.2599, label: 10, bag_size: 260
batch 1100, loss: 1.2698, instance_loss: 0.1650, weighted_loss: 0.9384, label: 6, bag_size: 275
batch 1200, loss: 0.6925, instance_loss: 0.1800, weighted_loss: 0.5388, label: 7, bag_size: 333
batch 1300, loss: 0.1519, instance_loss: 0.0542, weighted_loss: 0.1226, label: 6, bag_size: 346
batch 1400, loss: 0.5885, instance_loss: 0.1246, weighted_loss: 0.4493, label: 3, bag_size: 955
batch 1500, loss: 2.1148, instance_loss: 0.2321, weighted_loss: 1.5500, label: 10, bag_size: 367
batch 1600, loss: 1.0751, instance_loss: 0.1617, weighted_loss: 0.8011, label: 6, bag_size: 522
batch 1700, loss: 1.1569, instance_loss: 0.1339, weighted_loss: 0.8500, label: 6, bag_size: 464
batch 1800, loss: 1.1221, instance_loss: 0.1729, weighted_loss: 0.8373, label: 6, bag_size: 233
batch 1900, loss: 0.0288, instance_loss: 0.0248, weighted_loss: 0.0276, label: 6, bag_size: 444
batch 2000, loss: 0.8653, instance_loss: 0.1194, weighted_loss: 0.6416, label: 6, bag_size: 331
batch 2100, loss: 0.7778, instance_loss: 0.0664, weighted_loss: 0.5644, label: 6, bag_size: 291

Instance Classifier Stats
class 0 clustering acc 0.9975518433179723: correct 242445/243040
class 1 clustering acc 0.17476958525345623: correct 3034/17360

Epoch: 14, train_loss: 1.2284, train_clustering_loss:  0.1598, train_error: 0.4258
fine class 0: fine acc 0.16666666666666666, correct fine 2/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6441005802707931, correct fine 333/517 
fine class 4: fine acc 0.09333333333333334, correct fine 14/150 
fine class 5: fine acc 0.3565217391304348, correct fine 41/115 
fine class 6: fine acc 0.8818615751789977, correct fine 739/838 
fine class 7: fine acc 0.3293172690763052, correct fine 82/249 
fine class 8: fine acc 0.1797752808988764, correct fine 16/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.10606060606060606, correct fine 14/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5742

Val Set, val_loss: 1.4124, val_error: 0.4773, auc: 0.7912
class 0 clustering acc 0.9974972943722944: correct 29494/29568 
class 1 clustering acc 0.18087121212121213: correct 382/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.9038461538461539, correct fine 94/104 
fine class 7: fine acc 0.1, correct fine 3/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1816

Training for fine level...
batch 100, loss: 1.2330, instance_loss: 0.1815, weighted_loss: 0.9176, label: 3, bag_size: 298
batch 200, loss: 1.7993, instance_loss: 0.2047, weighted_loss: 1.3209, label: 10, bag_size: 209
batch 300, loss: 0.3472, instance_loss: 0.1051, weighted_loss: 0.2746, label: 3, bag_size: 1512
batch 400, loss: 1.6362, instance_loss: 0.1810, weighted_loss: 1.1996, label: 3, bag_size: 267
batch 500, loss: 0.1713, instance_loss: 0.0561, weighted_loss: 0.1368, label: 6, bag_size: 359
batch 600, loss: 1.6055, instance_loss: 0.2391, weighted_loss: 1.1956, label: 4, bag_size: 1138
batch 700, loss: 1.2168, instance_loss: 0.1590, weighted_loss: 0.8995, label: 6, bag_size: 347
batch 800, loss: 1.0869, instance_loss: 0.1539, weighted_loss: 0.8070, label: 6, bag_size: 369
batch 900, loss: 1.7122, instance_loss: 0.1721, weighted_loss: 1.2502, label: 6, bag_size: 332
batch 1000, loss: 0.0575, instance_loss: 0.0224, weighted_loss: 0.0470, label: 6, bag_size: 676
batch 1100, loss: 0.6649, instance_loss: 0.1674, weighted_loss: 0.5156, label: 8, bag_size: 120
batch 1200, loss: 0.4176, instance_loss: 0.0791, weighted_loss: 0.3161, label: 6, bag_size: 814
batch 1300, loss: 0.7040, instance_loss: 0.0984, weighted_loss: 0.5223, label: 6, bag_size: 311
batch 1400, loss: 0.0178, instance_loss: 0.0224, weighted_loss: 0.0192, label: 6, bag_size: 635
batch 1500, loss: 1.7816, instance_loss: 0.1459, weighted_loss: 1.2909, label: 6, bag_size: 746
batch 1600, loss: 0.3550, instance_loss: 0.0845, weighted_loss: 0.2738, label: 3, bag_size: 1226
batch 1700, loss: 1.4994, instance_loss: 0.1969, weighted_loss: 1.1086, label: 10, bag_size: 299
batch 1800, loss: 1.5464, instance_loss: 0.1327, weighted_loss: 1.1223, label: 6, bag_size: 462
batch 1900, loss: 0.4817, instance_loss: 0.2561, weighted_loss: 0.4140, label: 7, bag_size: 541
batch 2000, loss: 3.5307, instance_loss: 0.3011, weighted_loss: 2.5618, label: 8, bag_size: 549
batch 2100, loss: 1.5453, instance_loss: 0.2197, weighted_loss: 1.1476, label: 10, bag_size: 228

Instance Classifier Stats
class 0 clustering acc 0.9974037195523371: correct 242409/243040
class 1 clustering acc 0.1771889400921659: correct 3076/17360

Epoch: 15, train_loss: 1.2187, train_clustering_loss:  0.1592, train_error: 0.4272
fine class 0: fine acc 0.16666666666666666, correct fine 2/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.620889748549323, correct fine 321/517 
fine class 4: fine acc 0.10666666666666667, correct fine 16/150 
fine class 5: fine acc 0.33043478260869563, correct fine 38/115 
fine class 6: fine acc 0.8854415274463007, correct fine 742/838 
fine class 7: fine acc 0.3453815261044177, correct fine 86/249 
fine class 8: fine acc 0.21348314606741572, correct fine 19/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.10606060606060606, correct fine 14/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5728

Val Set, val_loss: 1.4233, val_error: 0.4697, auc: 0.7846
class 0 clustering acc 0.9973958333333334: correct 29491/29568 
class 1 clustering acc 0.1856060606060606: correct 392/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.671875, correct fine 43/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8365384615384616, correct fine 87/104 
fine class 7: fine acc 0.13333333333333333, correct fine 4/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5303
Overall F1 Score: 0.1962

Training for fine level...
batch 100, loss: 0.0938, instance_loss: 0.0360, weighted_loss: 0.0765, label: 6, bag_size: 752
batch 200, loss: 0.0500, instance_loss: 0.0320, weighted_loss: 0.0446, label: 6, bag_size: 1281
batch 300, loss: 0.5209, instance_loss: 0.0855, weighted_loss: 0.3903, label: 3, bag_size: 1536
batch 400, loss: 1.1584, instance_loss: 0.1174, weighted_loss: 0.8461, label: 6, bag_size: 595
batch 500, loss: 0.6520, instance_loss: 0.1873, weighted_loss: 0.5126, label: 7, bag_size: 394
batch 600, loss: 1.7065, instance_loss: 0.2367, weighted_loss: 1.2656, label: 8, bag_size: 311
batch 700, loss: 0.1565, instance_loss: 0.0669, weighted_loss: 0.1296, label: 6, bag_size: 629
batch 800, loss: 0.0260, instance_loss: 0.0199, weighted_loss: 0.0242, label: 6, bag_size: 393
batch 900, loss: 0.0697, instance_loss: 0.0367, weighted_loss: 0.0598, label: 6, bag_size: 475
batch 1000, loss: 2.9697, instance_loss: 0.3421, weighted_loss: 2.1814, label: 3, bag_size: 2625
batch 1100, loss: 1.1183, instance_loss: 0.2263, weighted_loss: 0.8507, label: 8, bag_size: 850
batch 1200, loss: 2.7285, instance_loss: 0.2387, weighted_loss: 1.9815, label: 7, bag_size: 290
batch 1300, loss: 1.9961, instance_loss: 0.1938, weighted_loss: 1.4554, label: 3, bag_size: 298
batch 1400, loss: 4.5445, instance_loss: 0.4100, weighted_loss: 3.3041, label: 8, bag_size: 868
batch 1500, loss: 0.0176, instance_loss: 0.0193, weighted_loss: 0.0181, label: 6, bag_size: 699
batch 1600, loss: 0.6235, instance_loss: 0.1843, weighted_loss: 0.4917, label: 7, bag_size: 1122
batch 1700, loss: 3.5879, instance_loss: 0.2855, weighted_loss: 2.5972, label: 13, bag_size: 264
batch 1800, loss: 0.1702, instance_loss: 0.0481, weighted_loss: 0.1336, label: 6, bag_size: 771
batch 1900, loss: 1.7207, instance_loss: 0.2307, weighted_loss: 1.2737, label: 4, bag_size: 635
batch 2000, loss: 0.4205, instance_loss: 0.0863, weighted_loss: 0.3203, label: 6, bag_size: 302
batch 2100, loss: 1.0569, instance_loss: 0.1838, weighted_loss: 0.7950, label: 3, bag_size: 205

Instance Classifier Stats
class 0 clustering acc 0.9972555957867018: correct 242373/243040
class 1 clustering acc 0.18243087557603688: correct 3167/17360

Epoch: 16, train_loss: 1.1990, train_clustering_loss:  0.1584, train_error: 0.4143
fine class 0: fine acc 0.16666666666666666, correct fine 2/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6518375241779497, correct fine 337/517 
fine class 4: fine acc 0.12666666666666668, correct fine 19/150 
fine class 5: fine acc 0.3391304347826087, correct fine 39/115 
fine class 6: fine acc 0.8782816229116945, correct fine 736/838 
fine class 7: fine acc 0.3895582329317269, correct fine 97/249 
fine class 8: fine acc 0.24719101123595505, correct fine 22/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.09090909090909091, correct fine 12/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5857

Val Set, val_loss: 1.4367, val_error: 0.4735, auc: 0.7849
class 0 clustering acc 0.9977678571428571: correct 29502/29568 
class 1 clustering acc 0.17803030303030304: correct 376/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.671875, correct fine 43/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8173076923076923, correct fine 85/104 
fine class 7: fine acc 0.16666666666666666, correct fine 5/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1974

Training for fine level...
batch 100, loss: 0.5916, instance_loss: 0.1851, weighted_loss: 0.4696, label: 3, bag_size: 389
batch 200, loss: 4.2759, instance_loss: 0.4620, weighted_loss: 3.1317, label: 8, bag_size: 868
batch 300, loss: 1.8629, instance_loss: 0.2059, weighted_loss: 1.3658, label: 7, bag_size: 276
batch 400, loss: 0.5079, instance_loss: 0.1641, weighted_loss: 0.4047, label: 8, bag_size: 120
batch 500, loss: 2.8880, instance_loss: 0.2975, weighted_loss: 2.1109, label: 6, bag_size: 3052
batch 600, loss: 1.1531, instance_loss: 0.2050, weighted_loss: 0.8687, label: 7, bag_size: 2443
batch 700, loss: 1.5486, instance_loss: 0.1877, weighted_loss: 1.1403, label: 3, bag_size: 179
batch 800, loss: 0.0518, instance_loss: 0.0260, weighted_loss: 0.0441, label: 6, bag_size: 274
batch 900, loss: 1.3002, instance_loss: 0.1659, weighted_loss: 0.9599, label: 3, bag_size: 374
batch 1000, loss: 1.3499, instance_loss: 0.2070, weighted_loss: 1.0070, label: 7, bag_size: 292
batch 1100, loss: 0.1644, instance_loss: 0.0644, weighted_loss: 0.1344, label: 6, bag_size: 365
batch 1200, loss: 2.4220, instance_loss: 0.2423, weighted_loss: 1.7681, label: 10, bag_size: 571
batch 1300, loss: 0.5297, instance_loss: 0.1127, weighted_loss: 0.4046, label: 6, bag_size: 258
batch 1400, loss: 1.9363, instance_loss: 0.2001, weighted_loss: 1.4154, label: 3, bag_size: 364
batch 1500, loss: 0.8649, instance_loss: 0.1676, weighted_loss: 0.6557, label: 6, bag_size: 322
batch 1600, loss: 1.9549, instance_loss: 0.2330, weighted_loss: 1.4383, label: 5, bag_size: 556
batch 1700, loss: 0.9149, instance_loss: 0.1317, weighted_loss: 0.6799, label: 6, bag_size: 333
batch 1800, loss: 0.2155, instance_loss: 0.0668, weighted_loss: 0.1709, label: 6, bag_size: 309
batch 1900, loss: 0.0573, instance_loss: 0.0314, weighted_loss: 0.0496, label: 6, bag_size: 728
batch 2000, loss: 0.0485, instance_loss: 0.0319, weighted_loss: 0.0435, label: 6, bag_size: 658
batch 2100, loss: 3.2864, instance_loss: 0.2679, weighted_loss: 2.3808, label: 5, bag_size: 449

Instance Classifier Stats
class 0 clustering acc 0.997160961158657: correct 242350/243040
class 1 clustering acc 0.18294930875576038: correct 3176/17360

Epoch: 17, train_loss: 1.1802, train_clustering_loss:  0.1577, train_error: 0.4124
fine class 0: fine acc 0.25, correct fine 3/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6653771760154739, correct fine 344/517 
fine class 4: fine acc 0.11333333333333333, correct fine 17/150 
fine class 5: fine acc 0.3739130434782609, correct fine 43/115 
fine class 6: fine acc 0.8711217183770883, correct fine 730/838 
fine class 7: fine acc 0.3815261044176707, correct fine 95/249 
fine class 8: fine acc 0.23595505617977527, correct fine 21/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.12121212121212122, correct fine 16/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.038461538461538464, correct fine 1/26 
Overall Accuracy: 0.5876

Val Set, val_loss: 1.4288, val_error: 0.4811, auc: 0.7888
class 0 clustering acc 0.9974296536796536: correct 29492/29568 
class 1 clustering acc 0.18087121212121213: correct 382/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.65625, correct fine 42/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.8461538461538461, correct fine 88/104 
fine class 7: fine acc 0.1, correct fine 3/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5189
Overall F1 Score: 0.1704

Training for fine level...
batch 100, loss: 2.4399, instance_loss: 0.2299, weighted_loss: 1.7769, label: 7, bag_size: 246
batch 200, loss: 0.2946, instance_loss: 0.0941, weighted_loss: 0.2345, label: 6, bag_size: 264
batch 300, loss: 0.0663, instance_loss: 0.0308, weighted_loss: 0.0556, label: 6, bag_size: 208
batch 400, loss: 1.0851, instance_loss: 0.1603, weighted_loss: 0.8077, label: 6, bag_size: 472
batch 500, loss: 0.6966, instance_loss: 0.1993, weighted_loss: 0.5474, label: 8, bag_size: 159
batch 600, loss: 3.7442, instance_loss: 0.3049, weighted_loss: 2.7124, label: 8, bag_size: 675
batch 700, loss: 1.5210, instance_loss: 0.2055, weighted_loss: 1.1264, label: 10, bag_size: 663
batch 800, loss: 0.6358, instance_loss: 0.2041, weighted_loss: 0.5063, label: 7, bag_size: 482
batch 900, loss: 1.6980, instance_loss: 0.1794, weighted_loss: 1.2425, label: 3, bag_size: 475
batch 1000, loss: 1.0866, instance_loss: 0.2870, weighted_loss: 0.8467, label: 7, bag_size: 1248
batch 1100, loss: 1.2776, instance_loss: 0.2178, weighted_loss: 0.9596, label: 7, bag_size: 858
batch 1200, loss: 0.0934, instance_loss: 0.0836, weighted_loss: 0.0905, label: 6, bag_size: 221
batch 1300, loss: 1.5757, instance_loss: 0.2139, weighted_loss: 1.1672, label: 3, bag_size: 205
batch 1400, loss: 0.1758, instance_loss: 0.1063, weighted_loss: 0.1550, label: 6, bag_size: 543
batch 1500, loss: 3.7942, instance_loss: 0.2815, weighted_loss: 2.7404, label: 5, bag_size: 574
batch 1600, loss: 2.2426, instance_loss: 0.2143, weighted_loss: 1.6341, label: 4, bag_size: 1477
batch 1700, loss: 1.3189, instance_loss: 0.1758, weighted_loss: 0.9760, label: 6, bag_size: 421
batch 1800, loss: 0.0242, instance_loss: 0.0481, weighted_loss: 0.0314, label: 6, bag_size: 656
batch 1900, loss: 3.6516, instance_loss: 0.3165, weighted_loss: 2.6511, label: 10, bag_size: 2813
batch 2000, loss: 0.2873, instance_loss: 0.0531, weighted_loss: 0.2171, label: 6, bag_size: 262
batch 2100, loss: 2.1578, instance_loss: 0.2716, weighted_loss: 1.5919, label: 7, bag_size: 414

Instance Classifier Stats
class 0 clustering acc 0.9973666886109283: correct 242400/243040
class 1 clustering acc 0.1817972350230415: correct 3156/17360

Epoch: 18, train_loss: 1.1665, train_clustering_loss:  0.1572, train_error: 0.4092
fine class 0: fine acc 0.25, correct fine 3/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6847195357833655, correct fine 354/517 
fine class 4: fine acc 0.13333333333333333, correct fine 20/150 
fine class 5: fine acc 0.3652173913043478, correct fine 42/115 
fine class 6: fine acc 0.8747016706443914, correct fine 733/838 
fine class 7: fine acc 0.3534136546184739, correct fine 88/249 
fine class 8: fine acc 0.25842696629213485, correct fine 23/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.09848484848484848, correct fine 13/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.038461538461538464, correct fine 1/26 
Overall Accuracy: 0.5908

Val Set, val_loss: 1.4434, val_error: 0.4848, auc: 0.7878
class 0 clustering acc 0.9975311147186147: correct 29495/29568 
class 1 clustering acc 0.17992424242424243: correct 380/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.671875, correct fine 43/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8076923076923077, correct fine 84/104 
fine class 7: fine acc 0.16666666666666666, correct fine 5/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1791

Training for fine level...
batch 100, loss: 0.1216, instance_loss: 0.0620, weighted_loss: 0.1037, label: 6, bag_size: 328
batch 200, loss: 0.3814, instance_loss: 0.0892, weighted_loss: 0.2937, label: 3, bag_size: 768
batch 300, loss: 0.6628, instance_loss: 0.1360, weighted_loss: 0.5048, label: 3, bag_size: 2085
batch 400, loss: 0.0408, instance_loss: 0.0326, weighted_loss: 0.0384, label: 6, bag_size: 179
batch 500, loss: 2.4275, instance_loss: 0.2615, weighted_loss: 1.7777, label: 7, bag_size: 523
batch 600, loss: 2.5820, instance_loss: 0.2674, weighted_loss: 1.8877, label: 13, bag_size: 357
batch 700, loss: 0.7562, instance_loss: 0.1137, weighted_loss: 0.5634, label: 3, bag_size: 480
batch 800, loss: 3.0686, instance_loss: 0.2496, weighted_loss: 2.2229, label: 3, bag_size: 493
batch 900, loss: 0.2838, instance_loss: 0.0722, weighted_loss: 0.2203, label: 6, bag_size: 859
batch 1000, loss: 0.4620, instance_loss: 0.1133, weighted_loss: 0.3574, label: 6, bag_size: 569
batch 1100, loss: 0.1375, instance_loss: 0.0389, weighted_loss: 0.1079, label: 6, bag_size: 265
batch 1200, loss: 2.3457, instance_loss: 0.2368, weighted_loss: 1.7130, label: 5, bag_size: 74
batch 1300, loss: 0.0540, instance_loss: 0.0611, weighted_loss: 0.0562, label: 6, bag_size: 433
batch 1400, loss: 0.0778, instance_loss: 0.0303, weighted_loss: 0.0635, label: 6, bag_size: 667
batch 1500, loss: 0.4384, instance_loss: 0.1672, weighted_loss: 0.3571, label: 3, bag_size: 304
batch 1600, loss: 1.1231, instance_loss: 0.1815, weighted_loss: 0.8406, label: 5, bag_size: 484
batch 1700, loss: 0.0277, instance_loss: 0.0264, weighted_loss: 0.0273, label: 6, bag_size: 676
batch 1800, loss: 0.6322, instance_loss: 0.0977, weighted_loss: 0.4719, label: 6, bag_size: 253
batch 1900, loss: 1.9729, instance_loss: 0.2378, weighted_loss: 1.4524, label: 6, bag_size: 663
batch 2000, loss: 0.8102, instance_loss: 0.1983, weighted_loss: 0.6267, label: 8, bag_size: 159
batch 2100, loss: 0.8105, instance_loss: 0.1588, weighted_loss: 0.6150, label: 3, bag_size: 225

Instance Classifier Stats
class 0 clustering acc 0.9973584595128374: correct 242398/243040
class 1 clustering acc 0.1865783410138249: correct 3239/17360

Epoch: 19, train_loss: 1.1439, train_clustering_loss:  0.1569, train_error: 0.3949
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6808510638297872, correct fine 352/517 
fine class 4: fine acc 0.1, correct fine 15/150 
fine class 5: fine acc 0.391304347826087, correct fine 45/115 
fine class 6: fine acc 0.8770883054892601, correct fine 735/838 
fine class 7: fine acc 0.43373493975903615, correct fine 108/249 
fine class 8: fine acc 0.2808988764044944, correct fine 25/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.15151515151515152, correct fine 20/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.07692307692307693, correct fine 2/26 
Overall Accuracy: 0.6051

Val Set, val_loss: 1.4403, val_error: 0.4773, auc: 0.7882
class 0 clustering acc 0.9974972943722944: correct 29494/29568 
class 1 clustering acc 0.18323863636363635: correct 387/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.8653846153846154, correct fine 90/104 
fine class 7: fine acc 0.13333333333333333, correct fine 4/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1916

Training for fine level...
batch 100, loss: 0.6028, instance_loss: 0.0945, weighted_loss: 0.4503, label: 3, bag_size: 601
batch 200, loss: 1.0870, instance_loss: 0.1508, weighted_loss: 0.8061, label: 6, bag_size: 91
batch 300, loss: 2.0948, instance_loss: 0.2674, weighted_loss: 1.5466, label: 4, bag_size: 427
batch 400, loss: 0.0676, instance_loss: 0.0294, weighted_loss: 0.0561, label: 6, bag_size: 468
batch 500, loss: 3.7164, instance_loss: 0.4281, weighted_loss: 2.7299, label: 3, bag_size: 608
batch 600, loss: 0.5788, instance_loss: 0.1634, weighted_loss: 0.4542, label: 5, bag_size: 507
batch 700, loss: 0.5160, instance_loss: 0.1400, weighted_loss: 0.4032, label: 3, bag_size: 129
batch 800, loss: 0.0194, instance_loss: 0.0229, weighted_loss: 0.0204, label: 6, bag_size: 393
batch 900, loss: 2.7576, instance_loss: 0.2987, weighted_loss: 2.0199, label: 8, bag_size: 1529
batch 1000, loss: 1.0878, instance_loss: 0.1728, weighted_loss: 0.8133, label: 3, bag_size: 2367
batch 1100, loss: 0.2482, instance_loss: 0.0768, weighted_loss: 0.1968, label: 6, bag_size: 264
batch 1200, loss: 2.5001, instance_loss: 0.2986, weighted_loss: 1.8396, label: 4, bag_size: 1666
batch 1300, loss: 1.9533, instance_loss: 0.2175, weighted_loss: 1.4326, label: 10, bag_size: 430
batch 1400, loss: 1.0572, instance_loss: 0.1928, weighted_loss: 0.7979, label: 7, bag_size: 689
batch 1500, loss: 3.6082, instance_loss: 0.2960, weighted_loss: 2.6145, label: 10, bag_size: 378
batch 1600, loss: 0.0649, instance_loss: 0.0382, weighted_loss: 0.0568, label: 6, bag_size: 437
batch 1700, loss: 2.6222, instance_loss: 0.2554, weighted_loss: 1.9122, label: 5, bag_size: 295
batch 1800, loss: 0.8300, instance_loss: 0.1616, weighted_loss: 0.6295, label: 3, bag_size: 165
batch 1900, loss: 0.4829, instance_loss: 0.1639, weighted_loss: 0.3872, label: 7, bag_size: 362
batch 2000, loss: 0.6288, instance_loss: 0.1222, weighted_loss: 0.4768, label: 3, bag_size: 936
batch 2100, loss: 1.2255, instance_loss: 0.2117, weighted_loss: 0.9214, label: 10, bag_size: 185

Instance Classifier Stats
class 0 clustering acc 0.9973708031599736: correct 242401/243040
class 1 clustering acc 0.1835253456221198: correct 3186/17360

Epoch: 20, train_loss: 1.1205, train_clustering_loss:  0.1560, train_error: 0.3926
fine class 0: fine acc 0.25, correct fine 3/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6769825918762089, correct fine 350/517 
fine class 4: fine acc 0.13333333333333333, correct fine 20/150 
fine class 5: fine acc 0.3826086956521739, correct fine 44/115 
fine class 6: fine acc 0.8854415274463007, correct fine 742/838 
fine class 7: fine acc 0.41767068273092367, correct fine 104/249 
fine class 8: fine acc 0.29213483146067415, correct fine 26/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.13636363636363635, correct fine 18/132 
fine class 11: fine acc 0.1, correct fine 1/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.07692307692307693, correct fine 2/26 
Overall Accuracy: 0.6074

Val Set, val_loss: 1.4608, val_error: 0.4773, auc: 0.7866
class 0 clustering acc 0.9971929112554112: correct 29485/29568 
class 1 clustering acc 0.18607954545454544: correct 393/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.671875, correct fine 43/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8269230769230769, correct fine 86/104 
fine class 7: fine acc 0.13333333333333333, correct fine 4/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1839

Training for fine level...
batch 100, loss: 0.0436, instance_loss: 0.0246, weighted_loss: 0.0379, label: 6, bag_size: 658
batch 200, loss: 1.4110, instance_loss: 0.2007, weighted_loss: 1.0479, label: 3, bag_size: 983
batch 300, loss: 0.0114, instance_loss: 0.0124, weighted_loss: 0.0117, label: 6, bag_size: 668
batch 400, loss: 0.9833, instance_loss: 0.1171, weighted_loss: 0.7235, label: 6, bag_size: 890
batch 500, loss: 0.9096, instance_loss: 0.1715, weighted_loss: 0.6882, label: 3, bag_size: 501
batch 600, loss: 0.7948, instance_loss: 0.1922, weighted_loss: 0.6140, label: 3, bag_size: 529
batch 700, loss: 0.5606, instance_loss: 0.1845, weighted_loss: 0.4478, label: 7, bag_size: 541
batch 800, loss: 2.9392, instance_loss: 0.2747, weighted_loss: 2.1398, label: 13, bag_size: 752
batch 900, loss: 0.8497, instance_loss: 0.1928, weighted_loss: 0.6526, label: 8, bag_size: 850
batch 1000, loss: 0.0288, instance_loss: 0.0141, weighted_loss: 0.0243, label: 6, bag_size: 634
batch 1100, loss: 0.8455, instance_loss: 0.1489, weighted_loss: 0.6365, label: 6, bag_size: 968
batch 1200, loss: 2.7157, instance_loss: 0.2373, weighted_loss: 1.9722, label: 4, bag_size: 522
batch 1300, loss: 0.7034, instance_loss: 0.1160, weighted_loss: 0.5272, label: 6, bag_size: 217
batch 1400, loss: 0.4875, instance_loss: 0.1012, weighted_loss: 0.3716, label: 3, bag_size: 3773
batch 1500, loss: 0.6004, instance_loss: 0.1517, weighted_loss: 0.4658, label: 7, bag_size: 1655
batch 1600, loss: 0.5294, instance_loss: 0.0994, weighted_loss: 0.4004, label: 3, bag_size: 768
batch 1700, loss: 1.8769, instance_loss: 0.2302, weighted_loss: 1.3829, label: 10, bag_size: 160
batch 1800, loss: 1.2461, instance_loss: 0.2148, weighted_loss: 0.9367, label: 10, bag_size: 130
batch 1900, loss: 0.5591, instance_loss: 0.1760, weighted_loss: 0.4442, label: 6, bag_size: 40
batch 2000, loss: 0.1851, instance_loss: 0.0505, weighted_loss: 0.1447, label: 6, bag_size: 596
batch 2100, loss: 0.0714, instance_loss: 0.0338, weighted_loss: 0.0601, label: 6, bag_size: 364

Instance Classifier Stats
class 0 clustering acc 0.997160961158657: correct 242350/243040
class 1 clustering acc 0.1853110599078341: correct 3217/17360

Epoch: 21, train_loss: 1.1099, train_clustering_loss:  0.1562, train_error: 0.3811
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7001934235976789, correct fine 362/517 
fine class 4: fine acc 0.15333333333333332, correct fine 23/150 
fine class 5: fine acc 0.34782608695652173, correct fine 40/115 
fine class 6: fine acc 0.8854415274463007, correct fine 742/838 
fine class 7: fine acc 0.4497991967871486, correct fine 112/249 
fine class 8: fine acc 0.33707865168539325, correct fine 30/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.14393939393939395, correct fine 19/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.07692307692307693, correct fine 2/26 
Overall Accuracy: 0.6189

Val Set, val_loss: 1.4685, val_error: 0.4659, auc: 0.7797
class 0 clustering acc 0.9979707792207793: correct 29508/29568 
class 1 clustering acc 0.1709280303030303: correct 361/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.65625, correct fine 42/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8173076923076923, correct fine 85/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5341
Overall F1 Score: 0.2120

Training for fine level...
batch 100, loss: 4.2595, instance_loss: 0.2901, weighted_loss: 3.0687, label: 10, bag_size: 527
batch 200, loss: 1.6011, instance_loss: 0.2610, weighted_loss: 1.1991, label: 7, bag_size: 387
batch 300, loss: 5.1278, instance_loss: 0.3009, weighted_loss: 3.6797, label: 13, bag_size: 625
batch 400, loss: 0.6607, instance_loss: 0.1201, weighted_loss: 0.4985, label: 3, bag_size: 1263
batch 500, loss: 0.8931, instance_loss: 0.2201, weighted_loss: 0.6912, label: 8, bag_size: 850
batch 600, loss: 0.7459, instance_loss: 0.1769, weighted_loss: 0.5752, label: 7, bag_size: 362
batch 700, loss: 0.5095, instance_loss: 0.1487, weighted_loss: 0.4012, label: 6, bag_size: 270
batch 800, loss: 2.4217, instance_loss: 0.2801, weighted_loss: 1.7792, label: 10, bag_size: 1105
batch 900, loss: 0.0927, instance_loss: 0.0443, weighted_loss: 0.0782, label: 6, bag_size: 252
batch 1000, loss: 0.7473, instance_loss: 0.1064, weighted_loss: 0.5550, label: 6, bag_size: 386
batch 1100, loss: 0.0061, instance_loss: 0.0138, weighted_loss: 0.0084, label: 6, bag_size: 421
batch 1200, loss: 0.4763, instance_loss: 0.1204, weighted_loss: 0.3695, label: 3, bag_size: 643
batch 1300, loss: 0.4734, instance_loss: 0.1016, weighted_loss: 0.3619, label: 3, bag_size: 768
batch 1400, loss: 2.1616, instance_loss: 0.2115, weighted_loss: 1.5766, label: 7, bag_size: 1339
batch 1500, loss: 0.1427, instance_loss: 0.0640, weighted_loss: 0.1191, label: 6, bag_size: 307
batch 1600, loss: 0.9397, instance_loss: 0.1268, weighted_loss: 0.6958, label: 3, bag_size: 927
batch 1700, loss: 0.6117, instance_loss: 0.1951, weighted_loss: 0.4867, label: 5, bag_size: 728
batch 1800, loss: 0.7752, instance_loss: 0.1033, weighted_loss: 0.5736, label: 3, bag_size: 558
batch 1900, loss: 1.8174, instance_loss: 0.1595, weighted_loss: 1.3201, label: 6, bag_size: 348
batch 2000, loss: 0.7517, instance_loss: 0.0973, weighted_loss: 0.5554, label: 6, bag_size: 240
batch 2100, loss: 1.6942, instance_loss: 0.1521, weighted_loss: 1.2316, label: 6, bag_size: 243

Instance Classifier Stats
class 0 clustering acc 0.9971979921000659: correct 242359/243040
class 1 clustering acc 0.1956221198156682: correct 3396/17360

Epoch: 22, train_loss: 1.0926, train_clustering_loss:  0.1547, train_error: 0.3673
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7021276595744681, correct fine 363/517 
fine class 4: fine acc 0.21333333333333335, correct fine 32/150 
fine class 5: fine acc 0.391304347826087, correct fine 45/115 
fine class 6: fine acc 0.883054892601432, correct fine 740/838 
fine class 7: fine acc 0.4738955823293173, correct fine 118/249 
fine class 8: fine acc 0.38202247191011235, correct fine 34/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.19696969696969696, correct fine 26/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.11538461538461539, correct fine 3/26 
Overall Accuracy: 0.6327

Val Set, val_loss: 1.4631, val_error: 0.4886, auc: 0.7829
class 0 clustering acc 0.9977340367965368: correct 29501/29568 
class 1 clustering acc 0.17660984848484848: correct 373/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.8653846153846154, correct fine 90/104 
fine class 7: fine acc 0.13333333333333333, correct fine 4/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1898

Training for fine level...
batch 100, loss: 2.4197, instance_loss: 0.2214, weighted_loss: 1.7602, label: 5, bag_size: 235
batch 200, loss: 0.7138, instance_loss: 0.1084, weighted_loss: 0.5322, label: 6, bag_size: 696
batch 300, loss: 1.2672, instance_loss: 0.2171, weighted_loss: 0.9522, label: 3, bag_size: 205
batch 400, loss: 0.1379, instance_loss: 0.0466, weighted_loss: 0.1105, label: 6, bag_size: 643
batch 500, loss: 2.0251, instance_loss: 0.2008, weighted_loss: 1.4778, label: 10, bag_size: 212
batch 600, loss: 0.8265, instance_loss: 0.1604, weighted_loss: 0.6266, label: 6, bag_size: 225
batch 700, loss: 0.8379, instance_loss: 0.1806, weighted_loss: 0.6407, label: 10, bag_size: 245
batch 800, loss: 1.7645, instance_loss: 0.2317, weighted_loss: 1.3046, label: 5, bag_size: 226
batch 900, loss: 0.0261, instance_loss: 0.0242, weighted_loss: 0.0255, label: 6, bag_size: 439
batch 1000, loss: 0.7648, instance_loss: 0.2059, weighted_loss: 0.5972, label: 7, bag_size: 256
batch 1100, loss: 1.7814, instance_loss: 0.2219, weighted_loss: 1.3135, label: 7, bag_size: 200
batch 1200, loss: 2.0895, instance_loss: 0.2263, weighted_loss: 1.5305, label: 10, bag_size: 1167
batch 1300, loss: 2.3155, instance_loss: 0.2410, weighted_loss: 1.6932, label: 5, bag_size: 37
batch 1400, loss: 1.8154, instance_loss: 0.1848, weighted_loss: 1.3262, label: 6, bag_size: 369
batch 1500, loss: 0.4511, instance_loss: 0.1099, weighted_loss: 0.3487, label: 6, bag_size: 386
batch 1600, loss: 0.3631, instance_loss: 0.0783, weighted_loss: 0.2776, label: 6, bag_size: 302
batch 1700, loss: 1.4540, instance_loss: 0.1919, weighted_loss: 1.0754, label: 10, bag_size: 128
batch 1800, loss: 0.0347, instance_loss: 0.0403, weighted_loss: 0.0364, label: 6, bag_size: 890
batch 1900, loss: 0.4990, instance_loss: 0.0762, weighted_loss: 0.3721, label: 3, bag_size: 409
batch 2000, loss: 0.0253, instance_loss: 0.0181, weighted_loss: 0.0231, label: 6, bag_size: 756
batch 2100, loss: 0.9115, instance_loss: 0.2166, weighted_loss: 0.7031, label: 8, bag_size: 159

Instance Classifier Stats
class 0 clustering acc 0.9972062211981567: correct 242361/243040
class 1 clustering acc 0.19049539170506913: correct 3307/17360

Epoch: 23, train_loss: 1.0745, train_clustering_loss:  0.1548, train_error: 0.3576
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7253384912959381, correct fine 375/517 
fine class 4: fine acc 0.16666666666666666, correct fine 25/150 
fine class 5: fine acc 0.391304347826087, correct fine 45/115 
fine class 6: fine acc 0.9009546539379475, correct fine 755/838 
fine class 7: fine acc 0.4779116465863454, correct fine 119/249 
fine class 8: fine acc 0.38202247191011235, correct fine 34/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.19696969696969696, correct fine 26/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.11538461538461539, correct fine 3/26 
Overall Accuracy: 0.6424

Val Set, val_loss: 1.4715, val_error: 0.4962, auc: 0.7830
class 0 clustering acc 0.9970576298701299: correct 29481/29568 
class 1 clustering acc 0.18892045454545456: correct 399/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.65625, correct fine 42/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8269230769230769, correct fine 86/104 
fine class 7: fine acc 0.06666666666666667, correct fine 2/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1550

Training for fine level...
batch 100, loss: 0.0821, instance_loss: 0.0295, weighted_loss: 0.0663, label: 6, bag_size: 223
batch 200, loss: 1.6815, instance_loss: 0.2048, weighted_loss: 1.2385, label: 4, bag_size: 1336
batch 300, loss: 3.9133, instance_loss: 0.2943, weighted_loss: 2.8276, label: 8, bag_size: 675
batch 400, loss: 0.2219, instance_loss: 0.0522, weighted_loss: 0.1710, label: 6, bag_size: 1308
batch 500, loss: 0.1752, instance_loss: 0.1839, weighted_loss: 0.1778, label: 7, bag_size: 307
batch 600, loss: 1.4963, instance_loss: 0.2057, weighted_loss: 1.1091, label: 10, bag_size: 344
batch 700, loss: 1.3393, instance_loss: 0.1817, weighted_loss: 0.9921, label: 3, bag_size: 214
batch 800, loss: 0.7590, instance_loss: 0.1360, weighted_loss: 0.5721, label: 3, bag_size: 1232
batch 900, loss: 4.7068, instance_loss: 0.3477, weighted_loss: 3.3991, label: 10, bag_size: 1875
batch 1000, loss: 0.9626, instance_loss: 0.2462, weighted_loss: 0.7477, label: 7, bag_size: 739
batch 1100, loss: 1.8185, instance_loss: 0.2291, weighted_loss: 1.3417, label: 4, bag_size: 837
batch 1200, loss: 0.1836, instance_loss: 0.0632, weighted_loss: 0.1474, label: 3, bag_size: 2220
batch 1300, loss: 0.2156, instance_loss: 0.1560, weighted_loss: 0.1977, label: 7, bag_size: 590
batch 1400, loss: 0.8975, instance_loss: 0.2576, weighted_loss: 0.7055, label: 7, bag_size: 1530
batch 1500, loss: 0.3888, instance_loss: 0.1588, weighted_loss: 0.3198, label: 5, bag_size: 650
batch 1600, loss: 2.5388, instance_loss: 0.2266, weighted_loss: 1.8452, label: 6, bag_size: 1853
batch 1700, loss: 1.2863, instance_loss: 0.2328, weighted_loss: 0.9702, label: 7, bag_size: 476
batch 1800, loss: 0.6679, instance_loss: 0.1249, weighted_loss: 0.5050, label: 6, bag_size: 397
batch 1900, loss: 0.2718, instance_loss: 0.0727, weighted_loss: 0.2120, label: 6, bag_size: 1250
batch 2000, loss: 0.0197, instance_loss: 0.0348, weighted_loss: 0.0242, label: 6, bag_size: 789
batch 2100, loss: 0.8692, instance_loss: 0.2055, weighted_loss: 0.6701, label: 7, bag_size: 896

Instance Classifier Stats
class 0 clustering acc 0.9972021066491112: correct 242360/243040
class 1 clustering acc 0.19210829493087558: correct 3335/17360

Epoch: 24, train_loss: 1.0487, train_clustering_loss:  0.1537, train_error: 0.3645
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7388781431334622, correct fine 382/517 
fine class 4: fine acc 0.13333333333333333, correct fine 20/150 
fine class 5: fine acc 0.40869565217391307, correct fine 47/115 
fine class 6: fine acc 0.8937947494033412, correct fine 749/838 
fine class 7: fine acc 0.44176706827309237, correct fine 110/249 
fine class 8: fine acc 0.30337078651685395, correct fine 27/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.2196969696969697, correct fine 29/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.11538461538461539, correct fine 3/26 
Overall Accuracy: 0.6355

Val Set, val_loss: 1.4823, val_error: 0.4924, auc: 0.7822
class 0 clustering acc 0.9973958333333334: correct 29491/29568 
class 1 clustering acc 0.1846590909090909: correct 390/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8269230769230769, correct fine 86/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1881

Training for fine level...
batch 100, loss: 0.9983, instance_loss: 0.2027, weighted_loss: 0.7596, label: 7, bag_size: 284
batch 200, loss: 0.1052, instance_loss: 0.1155, weighted_loss: 0.1083, label: 3, bag_size: 177
batch 300, loss: 0.2383, instance_loss: 0.0633, weighted_loss: 0.1858, label: 6, bag_size: 2663
batch 400, loss: 1.6260, instance_loss: 0.2141, weighted_loss: 1.2024, label: 7, bag_size: 200
batch 500, loss: 0.9330, instance_loss: 0.1805, weighted_loss: 0.7073, label: 7, bag_size: 861
batch 600, loss: 1.0988, instance_loss: 0.2800, weighted_loss: 0.8532, label: 0, bag_size: 343
batch 700, loss: 0.0171, instance_loss: 0.0163, weighted_loss: 0.0169, label: 6, bag_size: 987
batch 800, loss: 0.5655, instance_loss: 0.1343, weighted_loss: 0.4361, label: 3, bag_size: 623
batch 900, loss: 0.0216, instance_loss: 0.0304, weighted_loss: 0.0242, label: 6, bag_size: 365
batch 1000, loss: 0.0629, instance_loss: 0.0270, weighted_loss: 0.0521, label: 6, bag_size: 705
batch 1100, loss: 1.7600, instance_loss: 0.1706, weighted_loss: 1.2832, label: 6, bag_size: 112
batch 1200, loss: 1.4002, instance_loss: 0.2072, weighted_loss: 1.0423, label: 7, bag_size: 476
batch 1300, loss: 0.6432, instance_loss: 0.1428, weighted_loss: 0.4930, label: 6, bag_size: 232
batch 1400, loss: 0.3903, instance_loss: 0.0959, weighted_loss: 0.3020, label: 3, bag_size: 1470
batch 1500, loss: 0.2163, instance_loss: 0.0540, weighted_loss: 0.1676, label: 6, bag_size: 1308
batch 1600, loss: 0.3527, instance_loss: 0.2100, weighted_loss: 0.3099, label: 7, bag_size: 235
batch 1700, loss: 0.3878, instance_loss: 0.0784, weighted_loss: 0.2950, label: 3, bag_size: 981
batch 1800, loss: 0.4798, instance_loss: 0.1072, weighted_loss: 0.3681, label: 3, bag_size: 958
batch 1900, loss: 0.8720, instance_loss: 0.1366, weighted_loss: 0.6514, label: 6, bag_size: 431
batch 2000, loss: 0.6053, instance_loss: 0.1448, weighted_loss: 0.4671, label: 7, bag_size: 509
batch 2100, loss: 1.1968, instance_loss: 0.1262, weighted_loss: 0.8756, label: 6, bag_size: 1564

Instance Classifier Stats
class 0 clustering acc 0.9971362738643844: correct 242344/243040
class 1 clustering acc 0.19256912442396312: correct 3343/17360

Epoch: 25, train_loss: 1.0375, train_clustering_loss:  0.1540, train_error: 0.3581
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7427466150870407, correct fine 384/517 
fine class 4: fine acc 0.18666666666666668, correct fine 28/150 
fine class 5: fine acc 0.41739130434782606, correct fine 48/115 
fine class 6: fine acc 0.8914081145584726, correct fine 747/838 
fine class 7: fine acc 0.4538152610441767, correct fine 113/249 
fine class 8: fine acc 0.34831460674157305, correct fine 31/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.2196969696969697, correct fine 29/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.07692307692307693, correct fine 2/26 
Overall Accuracy: 0.6419

Val Set, val_loss: 1.4991, val_error: 0.4924, auc: 0.7790
class 0 clustering acc 0.9975987554112554: correct 29497/29568 
class 1 clustering acc 0.17945075757575757: correct 379/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.625, correct fine 40/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.75, correct fine 78/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.1875, correct fine 3/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.2076

Training for fine level...
batch 100, loss: 0.9743, instance_loss: 0.2319, weighted_loss: 0.7516, label: 4, bag_size: 926
batch 200, loss: 0.7765, instance_loss: 0.1325, weighted_loss: 0.5833, label: 6, bag_size: 431
batch 300, loss: 0.4273, instance_loss: 0.1451, weighted_loss: 0.3426, label: 7, bag_size: 326
batch 400, loss: 1.0095, instance_loss: 0.2072, weighted_loss: 0.7688, label: 10, bag_size: 536
batch 500, loss: 0.6096, instance_loss: 0.1105, weighted_loss: 0.4599, label: 6, bag_size: 336
batch 600, loss: 1.0933, instance_loss: 0.1791, weighted_loss: 0.8190, label: 3, bag_size: 393
batch 700, loss: 0.4578, instance_loss: 0.1390, weighted_loss: 0.3622, label: 3, bag_size: 392
batch 800, loss: 1.1771, instance_loss: 0.1916, weighted_loss: 0.8815, label: 3, bag_size: 446
batch 900, loss: 0.0871, instance_loss: 0.0310, weighted_loss: 0.0703, label: 6, bag_size: 544
batch 1000, loss: 2.4078, instance_loss: 0.2658, weighted_loss: 1.7652, label: 4, bag_size: 788
batch 1100, loss: 0.3414, instance_loss: 0.1786, weighted_loss: 0.2926, label: 7, bag_size: 182
batch 1200, loss: 0.2301, instance_loss: 0.1019, weighted_loss: 0.1917, label: 6, bag_size: 470
batch 1300, loss: 0.5673, instance_loss: 0.1363, weighted_loss: 0.4380, label: 3, bag_size: 328
batch 1400, loss: 0.2691, instance_loss: 0.0707, weighted_loss: 0.2096, label: 6, bag_size: 226
batch 1500, loss: 0.5674, instance_loss: 0.1433, weighted_loss: 0.4401, label: 6, bag_size: 518
batch 1600, loss: 1.1454, instance_loss: 0.2089, weighted_loss: 0.8644, label: 7, bag_size: 286
batch 1700, loss: 2.2058, instance_loss: 0.2164, weighted_loss: 1.6090, label: 3, bag_size: 646
batch 1800, loss: 0.1132, instance_loss: 0.1086, weighted_loss: 0.1119, label: 6, bag_size: 726
batch 1900, loss: 0.1343, instance_loss: 0.0865, weighted_loss: 0.1200, label: 6, bag_size: 532
batch 2000, loss: 2.9243, instance_loss: 0.2407, weighted_loss: 2.1192, label: 4, bag_size: 303
batch 2100, loss: 1.0898, instance_loss: 0.1221, weighted_loss: 0.7995, label: 3, bag_size: 313

Instance Classifier Stats
class 0 clustering acc 0.9971445029624754: correct 242346/243040
class 1 clustering acc 0.19752304147465438: correct 3429/17360

Epoch: 26, train_loss: 1.0109, train_clustering_loss:  0.1532, train_error: 0.3396
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.3125, correct fine 10/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7543520309477756, correct fine 390/517 
fine class 4: fine acc 0.16666666666666666, correct fine 25/150 
fine class 5: fine acc 0.43478260869565216, correct fine 50/115 
fine class 6: fine acc 0.9093078758949881, correct fine 762/838 
fine class 7: fine acc 0.5140562248995983, correct fine 128/249 
fine class 8: fine acc 0.34831460674157305, correct fine 31/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.2196969696969697, correct fine 29/132 
fine class 11: fine acc 0.1, correct fine 1/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.11538461538461539, correct fine 3/26 
Overall Accuracy: 0.6604

Val Set, val_loss: 1.5058, val_error: 0.4924, auc: 0.7828
class 0 clustering acc 0.9965503246753247: correct 29466/29568 
class 1 clustering acc 0.20170454545454544: correct 426/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.875, correct fine 91/104 
fine class 7: fine acc 0.1, correct fine 3/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1768

Training for fine level...
batch 100, loss: 0.3855, instance_loss: 0.1302, weighted_loss: 0.3089, label: 6, bag_size: 202
batch 200, loss: 2.3329, instance_loss: 0.3103, weighted_loss: 1.7261, label: 7, bag_size: 656
batch 300, loss: 0.9780, instance_loss: 0.1726, weighted_loss: 0.7364, label: 7, bag_size: 406
batch 400, loss: 0.2571, instance_loss: 0.1302, weighted_loss: 0.2190, label: 7, bag_size: 89
batch 500, loss: 0.0260, instance_loss: 0.0220, weighted_loss: 0.0248, label: 6, bag_size: 468
batch 600, loss: 0.3215, instance_loss: 0.0397, weighted_loss: 0.2370, label: 6, bag_size: 139
batch 700, loss: 0.0290, instance_loss: 0.0302, weighted_loss: 0.0294, label: 6, bag_size: 193
batch 800, loss: 2.1263, instance_loss: 0.2931, weighted_loss: 1.5764, label: 3, bag_size: 746
batch 900, loss: 2.8759, instance_loss: 0.2146, weighted_loss: 2.0775, label: 3, bag_size: 356
batch 1000, loss: 0.9301, instance_loss: 0.1919, weighted_loss: 0.7087, label: 4, bag_size: 786
batch 1100, loss: 0.4419, instance_loss: 0.0867, weighted_loss: 0.3353, label: 3, bag_size: 601
batch 1200, loss: 1.9362, instance_loss: 0.2300, weighted_loss: 1.4244, label: 4, bag_size: 401
batch 1300, loss: 1.1925, instance_loss: 0.2055, weighted_loss: 0.8964, label: 10, bag_size: 707
batch 1400, loss: 0.9667, instance_loss: 0.1756, weighted_loss: 0.7294, label: 6, bag_size: 220
batch 1500, loss: 0.6093, instance_loss: 0.1922, weighted_loss: 0.4842, label: 3, bag_size: 193
batch 1600, loss: 3.3365, instance_loss: 0.2679, weighted_loss: 2.4159, label: 4, bag_size: 326
batch 1700, loss: 1.7041, instance_loss: 0.2064, weighted_loss: 1.2548, label: 3, bag_size: 235
batch 1800, loss: 0.4019, instance_loss: 0.0712, weighted_loss: 0.3027, label: 3, bag_size: 2535
batch 1900, loss: 2.1776, instance_loss: 0.2279, weighted_loss: 1.5927, label: 5, bag_size: 308
batch 2000, loss: 0.2977, instance_loss: 0.1023, weighted_loss: 0.2391, label: 3, bag_size: 1561
batch 2100, loss: 3.4014, instance_loss: 0.2865, weighted_loss: 2.4669, label: 8, bag_size: 675

Instance Classifier Stats
class 0 clustering acc 0.9970910138248847: correct 242333/243040
class 1 clustering acc 0.19896313364055299: correct 3454/17360

Epoch: 27, train_loss: 0.9910, train_clustering_loss:  0.1529, train_error: 0.3369
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7485493230174082, correct fine 387/517 
fine class 4: fine acc 0.22666666666666666, correct fine 34/150 
fine class 5: fine acc 0.4260869565217391, correct fine 49/115 
fine class 6: fine acc 0.8973747016706444, correct fine 752/838 
fine class 7: fine acc 0.5220883534136547, correct fine 130/249 
fine class 8: fine acc 0.3707865168539326, correct fine 33/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.2727272727272727, correct fine 36/132 
fine class 11: fine acc 0.1, correct fine 1/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.15384615384615385, correct fine 4/26 
Overall Accuracy: 0.6631

Val Set, val_loss: 1.5026, val_error: 0.4962, auc: 0.7831
class 0 clustering acc 0.9970576298701299: correct 29481/29568 
class 1 clustering acc 0.19744318181818182: correct 417/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.640625, correct fine 41/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.75, correct fine 78/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1984

Training for fine level...
batch 100, loss: 2.1729, instance_loss: 0.2662, weighted_loss: 1.6009, label: 0, bag_size: 313
batch 200, loss: 0.8307, instance_loss: 0.2241, weighted_loss: 0.6487, label: 3, bag_size: 107
batch 300, loss: 0.8287, instance_loss: 0.1854, weighted_loss: 0.6357, label: 8, bag_size: 665
batch 400, loss: 0.0147, instance_loss: 0.0204, weighted_loss: 0.0164, label: 6, bag_size: 180
batch 500, loss: 0.1871, instance_loss: 0.1938, weighted_loss: 0.1891, label: 4, bag_size: 202
batch 600, loss: 2.1634, instance_loss: 0.2520, weighted_loss: 1.5900, label: 4, bag_size: 202
batch 700, loss: 0.1936, instance_loss: 0.0752, weighted_loss: 0.1581, label: 6, bag_size: 784
batch 800, loss: 0.0139, instance_loss: 0.0131, weighted_loss: 0.0137, label: 6, bag_size: 554
batch 900, loss: 0.9862, instance_loss: 0.2007, weighted_loss: 0.7506, label: 7, bag_size: 375
batch 1000, loss: 1.5526, instance_loss: 0.2160, weighted_loss: 1.1516, label: 5, bag_size: 779
batch 1100, loss: 0.9099, instance_loss: 0.0838, weighted_loss: 0.6621, label: 6, bag_size: 929
batch 1200, loss: 1.1895, instance_loss: 0.2335, weighted_loss: 0.9027, label: 4, bag_size: 304
batch 1300, loss: 1.3360, instance_loss: 0.1971, weighted_loss: 0.9943, label: 10, bag_size: 264
batch 1400, loss: 0.1080, instance_loss: 0.1860, weighted_loss: 0.1314, label: 7, bag_size: 488
batch 1500, loss: 0.7691, instance_loss: 0.1742, weighted_loss: 0.5906, label: 7, bag_size: 209
batch 1600, loss: 1.4229, instance_loss: 0.1420, weighted_loss: 1.0387, label: 6, bag_size: 555
batch 1700, loss: 0.0138, instance_loss: 0.0287, weighted_loss: 0.0182, label: 6, bag_size: 179
batch 1800, loss: 0.1617, instance_loss: 0.0734, weighted_loss: 0.1352, label: 6, bag_size: 209
batch 1900, loss: 2.1038, instance_loss: 0.2726, weighted_loss: 1.5544, label: 4, bag_size: 709
batch 2000, loss: 1.0191, instance_loss: 0.1836, weighted_loss: 0.7684, label: 3, bag_size: 282
batch 2100, loss: 0.5287, instance_loss: 0.0852, weighted_loss: 0.3957, label: 3, bag_size: 2154

Instance Classifier Stats
class 0 clustering acc 0.997053982883476: correct 242324/243040
class 1 clustering acc 0.20005760368663594: correct 3473/17360

Epoch: 28, train_loss: 0.9793, train_clustering_loss:  0.1526, train_error: 0.3327
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7446808510638298, correct fine 385/517 
fine class 4: fine acc 0.18666666666666668, correct fine 28/150 
fine class 5: fine acc 0.41739130434782606, correct fine 48/115 
fine class 6: fine acc 0.9033412887828163, correct fine 757/838 
fine class 7: fine acc 0.5461847389558233, correct fine 136/249 
fine class 8: fine acc 0.449438202247191, correct fine 40/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.26515151515151514, correct fine 35/132 
fine class 11: fine acc 0.1, correct fine 1/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.23076923076923078, correct fine 6/26 
Overall Accuracy: 0.6673

Val Set, val_loss: 1.5054, val_error: 0.5038, auc: 0.7825
class 0 clustering acc 0.9970914502164502: correct 29482/29568 
class 1 clustering acc 0.18702651515151514: correct 395/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7788461538461539, correct fine 81/104 
fine class 7: fine acc 0.16666666666666666, correct fine 5/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1861

Training for fine level...
batch 100, loss: 0.0234, instance_loss: 0.0389, weighted_loss: 0.0280, label: 6, bag_size: 817
batch 200, loss: 2.3435, instance_loss: 0.2439, weighted_loss: 1.7136, label: 10, bag_size: 589
batch 300, loss: 0.3541, instance_loss: 0.0678, weighted_loss: 0.2682, label: 3, bag_size: 872
batch 400, loss: 0.0740, instance_loss: 0.0200, weighted_loss: 0.0578, label: 6, bag_size: 331
batch 500, loss: 0.5582, instance_loss: 0.2026, weighted_loss: 0.4515, label: 0, bag_size: 388
batch 600, loss: 0.1879, instance_loss: 0.1186, weighted_loss: 0.1671, label: 7, bag_size: 343
batch 700, loss: 0.3297, instance_loss: 0.0572, weighted_loss: 0.2480, label: 3, bag_size: 534
batch 800, loss: 0.6035, instance_loss: 0.1020, weighted_loss: 0.4530, label: 3, bag_size: 1534
batch 900, loss: 2.6897, instance_loss: 0.2482, weighted_loss: 1.9572, label: 5, bag_size: 168
batch 1000, loss: 0.3099, instance_loss: 0.1379, weighted_loss: 0.2583, label: 7, bag_size: 444
batch 1100, loss: 2.6093, instance_loss: 0.2558, weighted_loss: 1.9033, label: 5, bag_size: 1061
batch 1200, loss: 2.0979, instance_loss: 0.2455, weighted_loss: 1.5422, label: 4, bag_size: 1168
batch 1300, loss: 0.4640, instance_loss: 0.1055, weighted_loss: 0.3564, label: 3, bag_size: 1632
batch 1400, loss: 0.8374, instance_loss: 0.1080, weighted_loss: 0.6186, label: 6, bag_size: 1068
batch 1500, loss: 3.0762, instance_loss: 0.2853, weighted_loss: 2.2389, label: 10, bag_size: 233
batch 1600, loss: 0.4839, instance_loss: 0.0574, weighted_loss: 0.3559, label: 6, bag_size: 713
batch 1700, loss: 2.5159, instance_loss: 0.2403, weighted_loss: 1.8332, label: 1, bag_size: 113
batch 1800, loss: 0.4196, instance_loss: 0.0901, weighted_loss: 0.3208, label: 6, bag_size: 494
batch 1900, loss: 0.8274, instance_loss: 0.1758, weighted_loss: 0.6319, label: 7, bag_size: 344
batch 2000, loss: 1.3477, instance_loss: 0.1704, weighted_loss: 0.9945, label: 6, bag_size: 116
batch 2100, loss: 0.3439, instance_loss: 0.0885, weighted_loss: 0.2673, label: 3, bag_size: 633

Instance Classifier Stats
class 0 clustering acc 0.9970745556287031: correct 242329/243040
class 1 clustering acc 0.2001152073732719: correct 3474/17360

Epoch: 29, train_loss: 0.9491, train_clustering_loss:  0.1522, train_error: 0.3244
fine class 0: fine acc 0.5, correct fine 6/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7543520309477756, correct fine 390/517 
fine class 4: fine acc 0.24, correct fine 36/150 
fine class 5: fine acc 0.46956521739130436, correct fine 54/115 
fine class 6: fine acc 0.905727923627685, correct fine 759/838 
fine class 7: fine acc 0.5381526104417671, correct fine 134/249 
fine class 8: fine acc 0.4044943820224719, correct fine 36/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.26515151515151514, correct fine 35/132 
fine class 11: fine acc 0.1, correct fine 1/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.23076923076923078, correct fine 6/26 
Overall Accuracy: 0.6756

Val Set, val_loss: 1.5294, val_error: 0.4962, auc: 0.7829
class 0 clustering acc 0.9967532467532467: correct 29472/29568 
class 1 clustering acc 0.2002840909090909: correct 423/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8269230769230769, correct fine 86/104 
fine class 7: fine acc 0.1, correct fine 3/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1735

Training for fine level...
batch 100, loss: 2.1558, instance_loss: 0.2926, weighted_loss: 1.5968, label: 7, bag_size: 600
batch 200, loss: 0.4904, instance_loss: 0.0817, weighted_loss: 0.3678, label: 3, bag_size: 334
batch 300, loss: 0.1788, instance_loss: 0.0367, weighted_loss: 0.1361, label: 6, bag_size: 599
batch 400, loss: 1.3225, instance_loss: 0.1942, weighted_loss: 0.9840, label: 6, bag_size: 1796
batch 500, loss: 0.0064, instance_loss: 0.0217, weighted_loss: 0.0110, label: 6, bag_size: 854
batch 600, loss: 0.2715, instance_loss: 0.1730, weighted_loss: 0.2420, label: 7, bag_size: 555
batch 700, loss: 0.7550, instance_loss: 0.1419, weighted_loss: 0.5711, label: 5, bag_size: 1380
batch 800, loss: 0.0334, instance_loss: 0.0354, weighted_loss: 0.0340, label: 6, bag_size: 467
batch 900, loss: 0.0243, instance_loss: 0.0166, weighted_loss: 0.0220, label: 6, bag_size: 632
batch 1000, loss: 0.4419, instance_loss: 0.1533, weighted_loss: 0.3553, label: 7, bag_size: 689
batch 1100, loss: 0.3503, instance_loss: 0.1834, weighted_loss: 0.3002, label: 7, bag_size: 346
batch 1200, loss: 0.0287, instance_loss: 0.0590, weighted_loss: 0.0378, label: 6, bag_size: 359
batch 1300, loss: 0.3313, instance_loss: 0.0823, weighted_loss: 0.2566, label: 3, bag_size: 1323
batch 1400, loss: 0.9045, instance_loss: 0.1479, weighted_loss: 0.6775, label: 6, bag_size: 431
batch 1500, loss: 0.0801, instance_loss: 0.0175, weighted_loss: 0.0613, label: 6, bag_size: 874
batch 1600, loss: 0.1126, instance_loss: 0.0543, weighted_loss: 0.0951, label: 6, bag_size: 333
batch 1700, loss: 0.7929, instance_loss: 0.1969, weighted_loss: 0.6141, label: 3, bag_size: 393
batch 1800, loss: 0.9563, instance_loss: 0.2000, weighted_loss: 0.7294, label: 3, bag_size: 655
batch 1900, loss: 3.6031, instance_loss: 0.2872, weighted_loss: 2.6083, label: 11, bag_size: 237
batch 2000, loss: 0.3997, instance_loss: 0.1716, weighted_loss: 0.3313, label: 7, bag_size: 1506
batch 2100, loss: 0.8171, instance_loss: 0.1962, weighted_loss: 0.6308, label: 3, bag_size: 435

Instance Classifier Stats
class 0 clustering acc 0.9970334101382489: correct 242319/243040
class 1 clustering acc 0.20639400921658987: correct 3583/17360

Epoch: 30, train_loss: 0.9338, train_clustering_loss:  0.1513, train_error: 0.3120
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7736943907156673, correct fine 400/517 
fine class 4: fine acc 0.25333333333333335, correct fine 38/150 
fine class 5: fine acc 0.4260869565217391, correct fine 49/115 
fine class 6: fine acc 0.9069212410501193, correct fine 760/838 
fine class 7: fine acc 0.5582329317269076, correct fine 139/249 
fine class 8: fine acc 0.4044943820224719, correct fine 36/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3787878787878788, correct fine 50/132 
fine class 11: fine acc 0.1, correct fine 1/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.23076923076923078, correct fine 6/26 
Overall Accuracy: 0.6880

Val Set, val_loss: 1.5350, val_error: 0.5076, auc: 0.7810
class 0 clustering acc 0.9967532467532467: correct 29472/29568 
class 1 clustering acc 0.20170454545454544: correct 426/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8173076923076923, correct fine 85/104 
fine class 7: fine acc 0.06666666666666667, correct fine 2/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1660

Training for fine level...
batch 100, loss: 1.2134, instance_loss: 0.2238, weighted_loss: 0.9165, label: 10, bag_size: 260
batch 200, loss: 0.8763, instance_loss: 0.2156, weighted_loss: 0.6781, label: 4, bag_size: 3892
batch 300, loss: 0.0656, instance_loss: 0.0670, weighted_loss: 0.0660, label: 6, bag_size: 933
batch 400, loss: 3.5667, instance_loss: 0.4443, weighted_loss: 2.6300, label: 8, bag_size: 868
batch 500, loss: 1.5971, instance_loss: 0.2218, weighted_loss: 1.1845, label: 3, bag_size: 2625
batch 600, loss: 0.0121, instance_loss: 0.0263, weighted_loss: 0.0164, label: 6, bag_size: 446
batch 700, loss: 0.0908, instance_loss: 0.0444, weighted_loss: 0.0769, label: 6, bag_size: 1032
batch 800, loss: 1.0705, instance_loss: 0.1780, weighted_loss: 0.8028, label: 3, bag_size: 248
batch 900, loss: 0.0226, instance_loss: 0.0299, weighted_loss: 0.0248, label: 6, bag_size: 817
batch 1000, loss: 0.5782, instance_loss: 0.1227, weighted_loss: 0.4416, label: 6, bag_size: 214
batch 1100, loss: 0.3071, instance_loss: 0.1257, weighted_loss: 0.2527, label: 5, bag_size: 758
batch 1200, loss: 0.5809, instance_loss: 0.1420, weighted_loss: 0.4492, label: 6, bag_size: 371
batch 1300, loss: 1.2924, instance_loss: 0.1904, weighted_loss: 0.9618, label: 3, bag_size: 613
batch 1400, loss: 0.2851, instance_loss: 0.1172, weighted_loss: 0.2347, label: 6, bag_size: 455
batch 1500, loss: 1.0631, instance_loss: 0.2036, weighted_loss: 0.8053, label: 4, bag_size: 1642
batch 1600, loss: 0.7062, instance_loss: 0.1437, weighted_loss: 0.5374, label: 7, bag_size: 732
batch 1700, loss: 0.3419, instance_loss: 0.1557, weighted_loss: 0.2861, label: 6, bag_size: 635
batch 1800, loss: 0.2196, instance_loss: 0.2148, weighted_loss: 0.2182, label: 7, bag_size: 488
batch 1900, loss: 0.3506, instance_loss: 0.1076, weighted_loss: 0.2777, label: 3, bag_size: 2612
batch 2000, loss: 0.9330, instance_loss: 0.1362, weighted_loss: 0.6939, label: 6, bag_size: 284
batch 2100, loss: 0.6082, instance_loss: 0.1555, weighted_loss: 0.4724, label: 6, bag_size: 188

Instance Classifier Stats
class 0 clustering acc 0.9970334101382489: correct 242319/243040
class 1 clustering acc 0.20414746543778803: correct 3544/17360

Epoch: 31, train_loss: 0.9125, train_clustering_loss:  0.1517, train_error: 0.3111
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7678916827852998, correct fine 397/517 
fine class 4: fine acc 0.3, correct fine 45/150 
fine class 5: fine acc 0.4782608695652174, correct fine 55/115 
fine class 6: fine acc 0.9093078758949881, correct fine 762/838 
fine class 7: fine acc 0.5582329317269076, correct fine 139/249 
fine class 8: fine acc 0.47191011235955055, correct fine 42/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.25757575757575757, correct fine 34/132 
fine class 11: fine acc 0.2, correct fine 2/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.19230769230769232, correct fine 5/26 
Overall Accuracy: 0.6889

Val Set, val_loss: 1.5429, val_error: 0.5038, auc: 0.7812
class 0 clustering acc 0.9967194264069265: correct 29471/29568 
class 1 clustering acc 0.19981060606060605: correct 422/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7884615384615384, correct fine 82/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1818

Training for fine level...
batch 100, loss: 0.0591, instance_loss: 0.0692, weighted_loss: 0.0621, label: 6, bag_size: 483
batch 200, loss: 0.9614, instance_loss: 0.1655, weighted_loss: 0.7226, label: 6, bag_size: 200
batch 300, loss: 0.0342, instance_loss: 0.0270, weighted_loss: 0.0320, label: 6, bag_size: 208
batch 400, loss: 1.3714, instance_loss: 0.2204, weighted_loss: 1.0261, label: 10, bag_size: 260
batch 500, loss: 0.0753, instance_loss: 0.0445, weighted_loss: 0.0661, label: 6, bag_size: 629
batch 600, loss: 0.6905, instance_loss: 0.1851, weighted_loss: 0.5389, label: 3, bag_size: 169
batch 700, loss: 2.1590, instance_loss: 0.2108, weighted_loss: 1.5745, label: 5, bag_size: 425
batch 800, loss: 5.5111, instance_loss: 0.3739, weighted_loss: 3.9700, label: 8, bag_size: 2158
batch 900, loss: 0.3255, instance_loss: 0.1082, weighted_loss: 0.2603, label: 3, bag_size: 1897
batch 1000, loss: 0.5464, instance_loss: 0.2101, weighted_loss: 0.4455, label: 7, bag_size: 435
batch 1100, loss: 1.1681, instance_loss: 0.1855, weighted_loss: 0.8733, label: 6, bag_size: 220
batch 1200, loss: 0.4989, instance_loss: 0.1585, weighted_loss: 0.3968, label: 8, bag_size: 354
batch 1300, loss: 3.0589, instance_loss: 0.2635, weighted_loss: 2.2203, label: 5, bag_size: 169
batch 1400, loss: 0.4173, instance_loss: 0.1334, weighted_loss: 0.3321, label: 6, bag_size: 290
batch 1500, loss: 0.1683, instance_loss: 0.0615, weighted_loss: 0.1362, label: 3, bag_size: 1067
batch 1600, loss: 0.4388, instance_loss: 0.0921, weighted_loss: 0.3348, label: 3, bag_size: 1384
batch 1700, loss: 1.4252, instance_loss: 0.2440, weighted_loss: 1.0709, label: 8, bag_size: 1800
batch 1800, loss: 0.4852, instance_loss: 0.1774, weighted_loss: 0.3928, label: 7, bag_size: 1072
batch 1900, loss: 0.3954, instance_loss: 0.1183, weighted_loss: 0.3123, label: 3, bag_size: 1860
batch 2000, loss: 1.1284, instance_loss: 0.2197, weighted_loss: 0.8558, label: 7, bag_size: 79
batch 2100, loss: 0.7945, instance_loss: 0.1968, weighted_loss: 0.6152, label: 8, bag_size: 274

Instance Classifier Stats
class 0 clustering acc 0.9971815339038841: correct 242355/243040
class 1 clustering acc 0.2029953917050691: correct 3524/17360

Epoch: 32, train_loss: 0.8863, train_clustering_loss:  0.1511, train_error: 0.2862
fine class 0: fine acc 0.5, correct fine 6/12 
fine class 1: fine acc 0.34375, correct fine 11/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.804642166344294, correct fine 416/517 
fine class 4: fine acc 0.32666666666666666, correct fine 49/150 
fine class 5: fine acc 0.46956521739130436, correct fine 54/115 
fine class 6: fine acc 0.9152744630071599, correct fine 767/838 
fine class 7: fine acc 0.5783132530120482, correct fine 144/249 
fine class 8: fine acc 0.4943820224719101, correct fine 44/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3560606060606061, correct fine 47/132 
fine class 11: fine acc 0.3, correct fine 3/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.3076923076923077, correct fine 8/26 
Overall Accuracy: 0.7138

Val Set, val_loss: 1.5584, val_error: 0.5000, auc: 0.7803
class 0 clustering acc 0.9962797619047619: correct 29458/29568 
class 1 clustering acc 0.20691287878787878: correct 437/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8076923076923077, correct fine 84/104 
fine class 7: fine acc 0.16666666666666666, correct fine 5/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5000
Overall F1 Score: 0.1776

Training for fine level...
batch 100, loss: 1.9308, instance_loss: 0.2292, weighted_loss: 1.4203, label: 8, bag_size: 388
batch 200, loss: 1.2035, instance_loss: 0.1258, weighted_loss: 0.8802, label: 3, bag_size: 939
batch 300, loss: 0.4609, instance_loss: 0.2553, weighted_loss: 0.3992, label: 7, bag_size: 581
batch 400, loss: 0.5601, instance_loss: 0.0788, weighted_loss: 0.4157, label: 3, bag_size: 357
batch 500, loss: 0.7683, instance_loss: 0.2554, weighted_loss: 0.6144, label: 7, bag_size: 534
batch 600, loss: 0.1021, instance_loss: 0.0373, weighted_loss: 0.0827, label: 6, bag_size: 643
batch 700, loss: 0.7636, instance_loss: 0.1287, weighted_loss: 0.5731, label: 6, bag_size: 525
batch 800, loss: 0.1188, instance_loss: 0.0251, weighted_loss: 0.0907, label: 6, bag_size: 460
batch 900, loss: 1.0458, instance_loss: 0.1873, weighted_loss: 0.7883, label: 10, bag_size: 130
batch 1000, loss: 0.0128, instance_loss: 0.0159, weighted_loss: 0.0137, label: 6, bag_size: 1015
batch 1100, loss: 0.4998, instance_loss: 0.1028, weighted_loss: 0.3807, label: 6, bag_size: 649
batch 1200, loss: 1.4659, instance_loss: 0.2246, weighted_loss: 1.0935, label: 4, bag_size: 454
batch 1300, loss: 3.5495, instance_loss: 0.2947, weighted_loss: 2.5731, label: 7, bag_size: 291
batch 1400, loss: 2.3097, instance_loss: 0.2159, weighted_loss: 1.6815, label: 6, bag_size: 1555
batch 1500, loss: 0.6181, instance_loss: 0.1245, weighted_loss: 0.4700, label: 6, bag_size: 216
batch 1600, loss: 0.5225, instance_loss: 0.1559, weighted_loss: 0.4125, label: 3, bag_size: 1144
batch 1700, loss: 1.5771, instance_loss: 0.2155, weighted_loss: 1.1686, label: 3, bag_size: 353
batch 1800, loss: 0.0047, instance_loss: 0.0075, weighted_loss: 0.0055, label: 6, bag_size: 338
batch 1900, loss: 0.2522, instance_loss: 0.0882, weighted_loss: 0.2030, label: 6, bag_size: 205
batch 2000, loss: 2.6994, instance_loss: 0.3288, weighted_loss: 1.9882, label: 8, bag_size: 378
batch 2100, loss: 2.1294, instance_loss: 0.2264, weighted_loss: 1.5585, label: 10, bag_size: 876

Instance Classifier Stats
class 0 clustering acc 0.9969716919025675: correct 242304/243040
class 1 clustering acc 0.20858294930875576: correct 3621/17360

Epoch: 33, train_loss: 0.8795, train_clustering_loss:  0.1504, train_error: 0.3046
fine class 0: fine acc 0.75, correct fine 9/12 
fine class 1: fine acc 0.3125, correct fine 10/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.769825918762089, correct fine 398/517 
fine class 4: fine acc 0.30666666666666664, correct fine 46/150 
fine class 5: fine acc 0.5217391304347826, correct fine 60/115 
fine class 6: fine acc 0.9033412887828163, correct fine 757/838 
fine class 7: fine acc 0.5662650602409639, correct fine 141/249 
fine class 8: fine acc 0.42696629213483145, correct fine 38/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3106060606060606, correct fine 41/132 
fine class 11: fine acc 0.2, correct fine 2/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.2692307692307692, correct fine 7/26 
Overall Accuracy: 0.6954

Val Set, val_loss: 1.5726, val_error: 0.5076, auc: 0.7761
class 0 clustering acc 0.9969899891774892: correct 29479/29568 
class 1 clustering acc 0.19507575757575757: correct 412/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7596153846153846, correct fine 79/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.125, correct fine 2/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1848

Training for fine level...
batch 100, loss: 1.4837, instance_loss: 0.2179, weighted_loss: 1.1040, label: 4, bag_size: 570
batch 200, loss: 0.5304, instance_loss: 0.1019, weighted_loss: 0.4019, label: 6, bag_size: 355
batch 300, loss: 0.5012, instance_loss: 0.2070, weighted_loss: 0.4130, label: 7, bag_size: 411
batch 400, loss: 1.6876, instance_loss: 0.1741, weighted_loss: 1.2335, label: 6, bag_size: 297
batch 500, loss: 0.2431, instance_loss: 0.1699, weighted_loss: 0.2211, label: 7, bag_size: 206
batch 600, loss: 0.3071, instance_loss: 0.0733, weighted_loss: 0.2369, label: 3, bag_size: 1216
batch 700, loss: 0.9663, instance_loss: 0.2227, weighted_loss: 0.7432, label: 8, bag_size: 492
batch 800, loss: 2.0958, instance_loss: 0.3010, weighted_loss: 1.5574, label: 7, bag_size: 280
batch 900, loss: 1.9887, instance_loss: 0.2579, weighted_loss: 1.4694, label: 4, bag_size: 437
batch 1000, loss: 0.2594, instance_loss: 0.0438, weighted_loss: 0.1947, label: 6, bag_size: 511
batch 1100, loss: 0.0369, instance_loss: 0.0845, weighted_loss: 0.0512, label: 6, bag_size: 674
batch 1200, loss: 1.1275, instance_loss: 0.1199, weighted_loss: 0.8253, label: 3, bag_size: 1875
batch 1300, loss: 1.3437, instance_loss: 0.2319, weighted_loss: 1.0101, label: 13, bag_size: 309
batch 1400, loss: 0.5113, instance_loss: 0.0714, weighted_loss: 0.3794, label: 6, bag_size: 847
batch 1500, loss: 1.4381, instance_loss: 0.1876, weighted_loss: 1.0630, label: 7, bag_size: 201
batch 1600, loss: 0.1514, instance_loss: 0.0802, weighted_loss: 0.1301, label: 6, bag_size: 859
batch 1700, loss: 1.1365, instance_loss: 0.1843, weighted_loss: 0.8508, label: 8, bag_size: 229
batch 1800, loss: 0.6286, instance_loss: 0.1774, weighted_loss: 0.4933, label: 7, bag_size: 285
batch 1900, loss: 0.6270, instance_loss: 0.2091, weighted_loss: 0.5016, label: 3, bag_size: 306
batch 2000, loss: 0.9039, instance_loss: 0.1726, weighted_loss: 0.6845, label: 3, bag_size: 260
batch 2100, loss: 1.5920, instance_loss: 0.2753, weighted_loss: 1.1970, label: 4, bag_size: 1324

Instance Classifier Stats
class 0 clustering acc 0.996967577353522: correct 242303/243040
class 1 clustering acc 0.2108294930875576: correct 3660/17360

Epoch: 34, train_loss: 0.8553, train_clustering_loss:  0.1501, train_error: 0.2751
fine class 0: fine acc 0.5833333333333334, correct fine 7/12 
fine class 1: fine acc 0.3125, correct fine 10/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8085106382978723, correct fine 418/517 
fine class 4: fine acc 0.32666666666666666, correct fine 49/150 
fine class 5: fine acc 0.5130434782608696, correct fine 59/115 
fine class 6: fine acc 0.9272076372315036, correct fine 777/838 
fine class 7: fine acc 0.6024096385542169, correct fine 150/249 
fine class 8: fine acc 0.5393258426966292, correct fine 48/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3333333333333333, correct fine 44/132 
fine class 11: fine acc 0.2, correct fine 2/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.34615384615384615, correct fine 9/26 
Overall Accuracy: 0.7249

Val Set, val_loss: 1.5975, val_error: 0.5114, auc: 0.7687
class 0 clustering acc 0.9971252705627706: correct 29483/29568 
class 1 clustering acc 0.19081439393939395: correct 403/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.640625, correct fine 41/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7115384615384616, correct fine 74/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4886
Overall F1 Score: 0.1902

Training for fine level...
batch 100, loss: 0.3515, instance_loss: 0.1511, weighted_loss: 0.2914, label: 6, bag_size: 518
batch 200, loss: 0.0198, instance_loss: 0.0371, weighted_loss: 0.0250, label: 6, bag_size: 883
batch 300, loss: 0.1209, instance_loss: 0.0679, weighted_loss: 0.1050, label: 6, bag_size: 271
batch 400, loss: 0.3246, instance_loss: 0.1454, weighted_loss: 0.2708, label: 7, bag_size: 526
batch 500, loss: 2.4069, instance_loss: 0.2318, weighted_loss: 1.7543, label: 4, bag_size: 831
batch 600, loss: 4.0204, instance_loss: 0.3597, weighted_loss: 2.9222, label: 6, bag_size: 3015
batch 700, loss: 0.6462, instance_loss: 0.2100, weighted_loss: 0.5154, label: 4, bag_size: 2170
batch 800, loss: 1.1727, instance_loss: 0.2155, weighted_loss: 0.8856, label: 7, bag_size: 434
batch 900, loss: 1.7059, instance_loss: 0.2235, weighted_loss: 1.2612, label: 5, bag_size: 304
batch 1000, loss: 0.7042, instance_loss: 0.0783, weighted_loss: 0.5164, label: 3, bag_size: 389
batch 1100, loss: 0.3640, instance_loss: 0.1745, weighted_loss: 0.3071, label: 5, bag_size: 1346
batch 1200, loss: 2.0913, instance_loss: 0.3407, weighted_loss: 1.5661, label: 4, bag_size: 1666
batch 1300, loss: 1.3163, instance_loss: 0.2633, weighted_loss: 1.0004, label: 10, bag_size: 253
batch 1400, loss: 2.4598, instance_loss: 0.2610, weighted_loss: 1.8001, label: 10, bag_size: 427
batch 1500, loss: 0.2107, instance_loss: 0.0617, weighted_loss: 0.1660, label: 3, bag_size: 1531
batch 1600, loss: 0.1445, instance_loss: 0.1494, weighted_loss: 0.1460, label: 7, bag_size: 518
batch 1700, loss: 0.0129, instance_loss: 0.0147, weighted_loss: 0.0135, label: 6, bag_size: 349
batch 1800, loss: 1.0691, instance_loss: 0.1957, weighted_loss: 0.8071, label: 6, bag_size: 298
batch 1900, loss: 0.2205, instance_loss: 0.0652, weighted_loss: 0.1739, label: 6, bag_size: 358
batch 2000, loss: 0.8227, instance_loss: 0.1655, weighted_loss: 0.6256, label: 3, bag_size: 551
batch 2100, loss: 0.0731, instance_loss: 0.0192, weighted_loss: 0.0569, label: 6, bag_size: 104

Instance Classifier Stats
class 0 clustering acc 0.99699637919684: correct 242310/243040
class 1 clustering acc 0.21319124423963134: correct 3701/17360

Epoch: 35, train_loss: 0.8329, train_clustering_loss:  0.1495, train_error: 0.2677
fine class 0: fine acc 0.5833333333333334, correct fine 7/12 
fine class 1: fine acc 0.375, correct fine 12/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8085106382978723, correct fine 418/517 
fine class 4: fine acc 0.35333333333333333, correct fine 53/150 
fine class 5: fine acc 0.4782608695652174, correct fine 55/115 
fine class 6: fine acc 0.9260143198090692, correct fine 776/838 
fine class 7: fine acc 0.6184738955823293, correct fine 154/249 
fine class 8: fine acc 0.5617977528089888, correct fine 50/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.4015151515151515, correct fine 53/132 
fine class 11: fine acc 0.2, correct fine 2/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.34615384615384615, correct fine 9/26 
Overall Accuracy: 0.7323

Val Set, val_loss: 1.5784, val_error: 0.5038, auc: 0.7829
class 0 clustering acc 0.9969223484848485: correct 29477/29568 
class 1 clustering acc 0.19981060606060605: correct 422/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5, correct fine 32/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.8173076923076923, correct fine 85/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1978

Training for fine level...
batch 100, loss: 0.1486, instance_loss: 0.0510, weighted_loss: 0.1193, label: 6, bag_size: 814
batch 200, loss: 0.3737, instance_loss: 0.0980, weighted_loss: 0.2910, label: 3, bag_size: 206
batch 300, loss: 0.2247, instance_loss: 0.0526, weighted_loss: 0.1731, label: 3, bag_size: 534
batch 400, loss: 0.8067, instance_loss: 0.1531, weighted_loss: 0.6106, label: 3, bag_size: 204
batch 500, loss: 0.9994, instance_loss: 0.2893, weighted_loss: 0.7864, label: 8, bag_size: 479
batch 600, loss: 0.7100, instance_loss: 0.2072, weighted_loss: 0.5592, label: 6, bag_size: 3051
batch 700, loss: 1.2291, instance_loss: 0.0836, weighted_loss: 0.8854, label: 3, bag_size: 940
batch 800, loss: 0.9455, instance_loss: 0.1910, weighted_loss: 0.7192, label: 10, bag_size: 661
batch 900, loss: 2.5656, instance_loss: 0.2708, weighted_loss: 1.8771, label: 4, bag_size: 495
batch 1000, loss: 0.1399, instance_loss: 0.0843, weighted_loss: 0.1232, label: 3, bag_size: 1628
batch 1100, loss: 0.3127, instance_loss: 0.0933, weighted_loss: 0.2469, label: 6, bag_size: 364
batch 1200, loss: 0.7063, instance_loss: 0.1541, weighted_loss: 0.5406, label: 6, bag_size: 473
batch 1300, loss: 0.0399, instance_loss: 0.0257, weighted_loss: 0.0356, label: 6, bag_size: 441
batch 1400, loss: 2.0820, instance_loss: 0.2440, weighted_loss: 1.5306, label: 4, bag_size: 437
batch 1500, loss: 0.0558, instance_loss: 0.0267, weighted_loss: 0.0471, label: 6, bag_size: 902
batch 1600, loss: 1.5059, instance_loss: 0.1769, weighted_loss: 1.1072, label: 3, bag_size: 641
batch 1700, loss: 0.0041, instance_loss: 0.0154, weighted_loss: 0.0075, label: 6, bag_size: 635
batch 1800, loss: 0.0034, instance_loss: 0.0237, weighted_loss: 0.0095, label: 6, bag_size: 424
batch 1900, loss: 1.3384, instance_loss: 0.2024, weighted_loss: 0.9976, label: 3, bag_size: 435
batch 2000, loss: 0.0153, instance_loss: 0.0515, weighted_loss: 0.0261, label: 6, bag_size: 396
batch 2100, loss: 1.0234, instance_loss: 0.1875, weighted_loss: 0.7726, label: 6, bag_size: 735

Instance Classifier Stats
class 0 clustering acc 0.9969305464121132: correct 242294/243040
class 1 clustering acc 0.21048387096774193: correct 3654/17360

Epoch: 36, train_loss: 0.8101, train_clustering_loss:  0.1499, train_error: 0.2654
fine class 0: fine acc 0.5833333333333334, correct fine 7/12 
fine class 1: fine acc 0.375, correct fine 12/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8123791102514507, correct fine 420/517 
fine class 4: fine acc 0.35333333333333333, correct fine 53/150 
fine class 5: fine acc 0.5391304347826087, correct fine 62/115 
fine class 6: fine acc 0.9224343675417661, correct fine 773/838 
fine class 7: fine acc 0.6265060240963856, correct fine 156/249 
fine class 8: fine acc 0.5056179775280899, correct fine 45/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.4090909090909091, correct fine 54/132 
fine class 11: fine acc 0.3, correct fine 3/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.34615384615384615, correct fine 9/26 
Overall Accuracy: 0.7346

Val Set, val_loss: 1.5954, val_error: 0.5000, auc: 0.7756
class 0 clustering acc 0.9965165043290043: correct 29465/29568 
class 1 clustering acc 0.20549242424242425: correct 434/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.7596153846153846, correct fine 79/104 
fine class 7: fine acc 0.3, correct fine 9/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5000
Overall F1 Score: 0.2029

Training for fine level...
batch 100, loss: 0.0094, instance_loss: 0.0187, weighted_loss: 0.0122, label: 6, bag_size: 280
batch 200, loss: 0.2747, instance_loss: 0.1251, weighted_loss: 0.2298, label: 6, bag_size: 305
batch 300, loss: 1.4095, instance_loss: 0.2279, weighted_loss: 1.0550, label: 8, bag_size: 118
batch 400, loss: 2.3673, instance_loss: 0.2418, weighted_loss: 1.7297, label: 4, bag_size: 167
batch 500, loss: 1.4794, instance_loss: 0.1955, weighted_loss: 1.0942, label: 10, bag_size: 22
batch 600, loss: 0.5420, instance_loss: 0.0928, weighted_loss: 0.4072, label: 3, bag_size: 1847
batch 700, loss: 3.3810, instance_loss: 0.2853, weighted_loss: 2.4523, label: 1, bag_size: 320
batch 800, loss: 0.0962, instance_loss: 0.1341, weighted_loss: 0.1075, label: 3, bag_size: 332
batch 900, loss: 1.4660, instance_loss: 0.2969, weighted_loss: 1.1153, label: 5, bag_size: 1030
batch 1000, loss: 0.0039, instance_loss: 0.0081, weighted_loss: 0.0051, label: 6, bag_size: 318
batch 1100, loss: 2.3894, instance_loss: 0.2335, weighted_loss: 1.7426, label: 3, bag_size: 746
batch 1200, loss: 0.0592, instance_loss: 0.0213, weighted_loss: 0.0479, label: 6, bag_size: 331
batch 1300, loss: 0.5856, instance_loss: 0.1513, weighted_loss: 0.4553, label: 3, bag_size: 296
batch 1400, loss: 0.9755, instance_loss: 0.1838, weighted_loss: 0.7380, label: 3, bag_size: 369
batch 1500, loss: 0.0131, instance_loss: 0.0139, weighted_loss: 0.0134, label: 6, bag_size: 676
batch 1600, loss: 0.5600, instance_loss: 0.1549, weighted_loss: 0.4385, label: 6, bag_size: 233
batch 1700, loss: 0.2584, instance_loss: 0.0752, weighted_loss: 0.2034, label: 3, bag_size: 1827
batch 1800, loss: 0.3537, instance_loss: 0.0525, weighted_loss: 0.2633, label: 6, bag_size: 713
batch 1900, loss: 0.3351, instance_loss: 0.1232, weighted_loss: 0.2715, label: 6, bag_size: 519
batch 2000, loss: 0.6981, instance_loss: 0.1005, weighted_loss: 0.5188, label: 6, bag_size: 1000
batch 2100, loss: 0.0764, instance_loss: 0.0762, weighted_loss: 0.0763, label: 3, bag_size: 206

Instance Classifier Stats
class 0 clustering acc 0.996889400921659: correct 242284/243040
class 1 clustering acc 0.21486175115207373: correct 3730/17360

Epoch: 37, train_loss: 0.8055, train_clustering_loss:  0.1487, train_error: 0.2567
fine class 0: fine acc 0.5, correct fine 6/12 
fine class 1: fine acc 0.3125, correct fine 10/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8239845261121856, correct fine 426/517 
fine class 4: fine acc 0.4, correct fine 60/150 
fine class 5: fine acc 0.5391304347826087, correct fine 62/115 
fine class 6: fine acc 0.918854415274463, correct fine 770/838 
fine class 7: fine acc 0.6385542168674698, correct fine 159/249 
fine class 8: fine acc 0.550561797752809, correct fine 49/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.45454545454545453, correct fine 60/132 
fine class 11: fine acc 0.2, correct fine 2/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.34615384615384615, correct fine 9/26 
Overall Accuracy: 0.7433

Val Set, val_loss: 1.6095, val_error: 0.5076, auc: 0.7695
class 0 clustering acc 0.9967532467532467: correct 29472/29568 
class 1 clustering acc 0.19602272727272727: correct 414/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.7403846153846154, correct fine 77/104 
fine class 7: fine acc 0.3, correct fine 9/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.2024

Training for fine level...
batch 100, loss: 0.5544, instance_loss: 0.1759, weighted_loss: 0.4409, label: 8, bag_size: 152
batch 200, loss: 1.4690, instance_loss: 0.1790, weighted_loss: 1.0820, label: 6, bag_size: 125
batch 300, loss: 0.0770, instance_loss: 0.0341, weighted_loss: 0.0641, label: 6, bag_size: 691
batch 400, loss: 2.5895, instance_loss: 0.2433, weighted_loss: 1.8856, label: 8, bag_size: 748
batch 500, loss: 0.6649, instance_loss: 0.0981, weighted_loss: 0.4949, label: 3, bag_size: 2047
batch 600, loss: 4.2225, instance_loss: 0.2970, weighted_loss: 3.0449, label: 10, bag_size: 568
batch 700, loss: 0.5429, instance_loss: 0.1686, weighted_loss: 0.4306, label: 6, bag_size: 331
batch 800, loss: 0.0837, instance_loss: 0.0462, weighted_loss: 0.0724, label: 6, bag_size: 178
batch 900, loss: 1.9806, instance_loss: 0.2167, weighted_loss: 1.4514, label: 6, bag_size: 1555
batch 1000, loss: 0.3277, instance_loss: 0.1161, weighted_loss: 0.2642, label: 3, bag_size: 497
batch 1100, loss: 0.7701, instance_loss: 0.1205, weighted_loss: 0.5753, label: 6, bag_size: 284
batch 1200, loss: 0.1005, instance_loss: 0.1868, weighted_loss: 0.1264, label: 7, bag_size: 861
batch 1300, loss: 0.0053, instance_loss: 0.0542, weighted_loss: 0.0200, label: 6, bag_size: 681
batch 1400, loss: 1.1787, instance_loss: 0.1555, weighted_loss: 0.8717, label: 6, bag_size: 463
batch 1500, loss: 0.5782, instance_loss: 0.1385, weighted_loss: 0.4463, label: 8, bag_size: 163
batch 1600, loss: 0.2913, instance_loss: 0.0814, weighted_loss: 0.2284, label: 6, bag_size: 1000
batch 1700, loss: 0.2761, instance_loss: 0.1433, weighted_loss: 0.2363, label: 7, bag_size: 239
batch 1800, loss: 0.4488, instance_loss: 0.1037, weighted_loss: 0.3453, label: 3, bag_size: 2523
batch 1900, loss: 0.3779, instance_loss: 0.1740, weighted_loss: 0.3167, label: 3, bag_size: 622
batch 2000, loss: 0.5857, instance_loss: 0.2717, weighted_loss: 0.4915, label: 3, bag_size: 315
batch 2100, loss: 0.6582, instance_loss: 0.1217, weighted_loss: 0.4972, label: 6, bag_size: 314

Instance Classifier Stats
class 0 clustering acc 0.9970210664911126: correct 242316/243040
class 1 clustering acc 0.21555299539170508: correct 3742/17360

Epoch: 38, train_loss: 0.7738, train_clustering_loss:  0.1485, train_error: 0.2507
fine class 0: fine acc 0.6666666666666666, correct fine 8/12 
fine class 1: fine acc 0.40625, correct fine 13/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8201160541586073, correct fine 424/517 
fine class 4: fine acc 0.4, correct fine 60/150 
fine class 5: fine acc 0.5652173913043478, correct fine 65/115 
fine class 6: fine acc 0.9248210023866349, correct fine 775/838 
fine class 7: fine acc 0.6546184738955824, correct fine 163/249 
fine class 8: fine acc 0.550561797752809, correct fine 49/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.42424242424242425, correct fine 56/132 
fine class 11: fine acc 0.4, correct fine 4/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.34615384615384615, correct fine 9/26 
Overall Accuracy: 0.7493

Val Set, val_loss: 1.6365, val_error: 0.5152, auc: 0.7709
class 0 clustering acc 0.9966179653679653: correct 29468/29568 
class 1 clustering acc 0.20928030303030304: correct 442/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.625, correct fine 40/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7307692307692307, correct fine 76/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4848
Overall F1 Score: 0.1858

Training for fine level...
batch 100, loss: 0.6834, instance_loss: 0.1209, weighted_loss: 0.5146, label: 6, bag_size: 350
batch 200, loss: 0.0497, instance_loss: 0.0261, weighted_loss: 0.0426, label: 6, bag_size: 261
batch 300, loss: 0.0044, instance_loss: 0.0114, weighted_loss: 0.0065, label: 6, bag_size: 629
batch 400, loss: 0.3300, instance_loss: 0.0921, weighted_loss: 0.2586, label: 3, bag_size: 697
batch 500, loss: 0.8453, instance_loss: 0.2080, weighted_loss: 0.6541, label: 10, bag_size: 386
batch 600, loss: 0.0449, instance_loss: 0.0250, weighted_loss: 0.0390, label: 6, bag_size: 359
batch 700, loss: 0.0539, instance_loss: 0.0428, weighted_loss: 0.0506, label: 6, bag_size: 273
batch 800, loss: 1.9735, instance_loss: 0.2335, weighted_loss: 1.4515, label: 10, bag_size: 368
batch 900, loss: 0.3637, instance_loss: 0.1243, weighted_loss: 0.2919, label: 6, bag_size: 347
batch 1000, loss: 1.0376, instance_loss: 0.1916, weighted_loss: 0.7838, label: 10, bag_size: 212
batch 1100, loss: 0.9268, instance_loss: 0.2795, weighted_loss: 0.7326, label: 4, bag_size: 1168
batch 1200, loss: 0.1849, instance_loss: 0.1845, weighted_loss: 0.1848, label: 7, bag_size: 247
batch 1300, loss: 0.2108, instance_loss: 0.0789, weighted_loss: 0.1713, label: 5, bag_size: 847
batch 1400, loss: 0.0117, instance_loss: 0.0122, weighted_loss: 0.0119, label: 6, bag_size: 250
batch 1500, loss: 1.2086, instance_loss: 0.2169, weighted_loss: 0.9111, label: 3, bag_size: 165
batch 1600, loss: 0.4730, instance_loss: 0.1488, weighted_loss: 0.3758, label: 6, bag_size: 187
batch 1700, loss: 0.1784, instance_loss: 0.0982, weighted_loss: 0.1544, label: 3, bag_size: 1632
batch 1800, loss: 1.0806, instance_loss: 0.3248, weighted_loss: 0.8538, label: 13, bag_size: 372
batch 1900, loss: 0.0540, instance_loss: 0.0864, weighted_loss: 0.0637, label: 3, bag_size: 177
batch 2000, loss: 0.0986, instance_loss: 0.0285, weighted_loss: 0.0776, label: 6, bag_size: 1301
batch 2100, loss: 0.9760, instance_loss: 0.1878, weighted_loss: 0.7395, label: 8, bag_size: 529

Instance Classifier Stats
class 0 clustering acc 0.9969922646477946: correct 242309/243040
class 1 clustering acc 0.21877880184331797: correct 3798/17360

Epoch: 39, train_loss: 0.7568, train_clustering_loss:  0.1487, train_error: 0.2433
fine class 0: fine acc 0.6666666666666666, correct fine 8/12 
fine class 1: fine acc 0.4375, correct fine 14/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8297872340425532, correct fine 429/517 
fine class 4: fine acc 0.4066666666666667, correct fine 61/150 
fine class 5: fine acc 0.5043478260869565, correct fine 58/115 
fine class 6: fine acc 0.9331742243436754, correct fine 782/838 
fine class 7: fine acc 0.6586345381526104, correct fine 164/249 
fine class 8: fine acc 0.550561797752809, correct fine 49/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.49242424242424243, correct fine 65/132 
fine class 11: fine acc 0.3, correct fine 3/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.34615384615384615, correct fine 9/26 
Overall Accuracy: 0.7567

Val Set, val_loss: 1.6349, val_error: 0.5152, auc: 0.7720
class 0 clustering acc 0.9963812229437229: correct 29461/29568 
class 1 clustering acc 0.20738636363636365: correct 438/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7403846153846154, correct fine 77/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4848
Overall F1 Score: 0.1868

Training for fine level...
batch 100, loss: 1.7617, instance_loss: 0.2723, weighted_loss: 1.3149, label: 13, bag_size: 416
batch 200, loss: 0.7998, instance_loss: 0.1411, weighted_loss: 0.6022, label: 6, bag_size: 290
batch 300, loss: 0.2402, instance_loss: 0.1165, weighted_loss: 0.2031, label: 3, bag_size: 1512
batch 400, loss: 3.3422, instance_loss: 0.3035, weighted_loss: 2.4306, label: 10, bag_size: 2813
batch 500, loss: 0.0370, instance_loss: 0.0260, weighted_loss: 0.0337, label: 6, bag_size: 853
batch 600, loss: 1.7864, instance_loss: 0.2799, weighted_loss: 1.3345, label: 7, bag_size: 600
batch 700, loss: 0.5922, instance_loss: 0.1379, weighted_loss: 0.4559, label: 6, bag_size: 2114
batch 800, loss: 1.6478, instance_loss: 0.2478, weighted_loss: 1.2278, label: 8, bag_size: 716
batch 900, loss: 0.1600, instance_loss: 0.2269, weighted_loss: 0.1801, label: 3, bag_size: 983
batch 1000, loss: 0.0074, instance_loss: 0.0135, weighted_loss: 0.0093, label: 6, bag_size: 365
batch 1100, loss: 1.4561, instance_loss: 0.1861, weighted_loss: 1.0751, label: 4, bag_size: 837
batch 1200, loss: 0.7576, instance_loss: 0.0406, weighted_loss: 0.5425, label: 6, bag_size: 1105
batch 1300, loss: 0.1928, instance_loss: 0.1501, weighted_loss: 0.1800, label: 7, bag_size: 328
batch 1400, loss: 0.1869, instance_loss: 0.2621, weighted_loss: 0.2094, label: 3, bag_size: 191
batch 1500, loss: 0.9106, instance_loss: 0.2404, weighted_loss: 0.7096, label: 7, bag_size: 739
batch 1600, loss: 0.4467, instance_loss: 0.1806, weighted_loss: 0.3668, label: 7, bag_size: 304
batch 1700, loss: 0.0257, instance_loss: 0.0369, weighted_loss: 0.0291, label: 6, bag_size: 288
batch 1800, loss: 0.0373, instance_loss: 0.0209, weighted_loss: 0.0323, label: 6, bag_size: 905
batch 1900, loss: 2.5390, instance_loss: 0.2247, weighted_loss: 1.8447, label: 3, bag_size: 377
batch 2000, loss: 0.9139, instance_loss: 0.1993, weighted_loss: 0.6996, label: 3, bag_size: 356
batch 2100, loss: 0.0786, instance_loss: 0.0308, weighted_loss: 0.0643, label: 6, bag_size: 827

Instance Classifier Stats
class 0 clustering acc 0.9968112244897959: correct 242265/243040
class 1 clustering acc 0.22148617511520738: correct 3845/17360

Epoch: 40, train_loss: 0.7389, train_clustering_loss:  0.1485, train_error: 0.2253
fine class 0: fine acc 0.6666666666666666, correct fine 8/12 
fine class 1: fine acc 0.375, correct fine 12/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8626692456479691, correct fine 446/517 
fine class 4: fine acc 0.42, correct fine 63/150 
fine class 5: fine acc 0.5478260869565217, correct fine 63/115 
fine class 6: fine acc 0.9379474940334129, correct fine 786/838 
fine class 7: fine acc 0.6947791164658634, correct fine 173/249 
fine class 8: fine acc 0.6292134831460674, correct fine 56/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.45454545454545453, correct fine 60/132 
fine class 11: fine acc 0.4, correct fine 4/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.38461538461538464, correct fine 10/26 
Overall Accuracy: 0.7747

Val Set, val_loss: 1.6641, val_error: 0.5076, auc: 0.7703
class 0 clustering acc 0.9963812229437229: correct 29461/29568 
class 1 clustering acc 0.21164772727272727: correct 447/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7403846153846154, correct fine 77/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1920

Training for fine level...
batch 100, loss: 0.6260, instance_loss: 0.1747, weighted_loss: 0.4906, label: 10, bag_size: 207
batch 200, loss: 0.5639, instance_loss: 0.1624, weighted_loss: 0.4435, label: 6, bag_size: 276
batch 300, loss: 0.0020, instance_loss: 0.0132, weighted_loss: 0.0053, label: 6, bag_size: 887
batch 400, loss: 0.0348, instance_loss: 0.0922, weighted_loss: 0.0520, label: 7, bag_size: 156
batch 500, loss: 0.6000, instance_loss: 0.1569, weighted_loss: 0.4671, label: 5, bag_size: 1279
batch 600, loss: 0.0170, instance_loss: 0.0835, weighted_loss: 0.0369, label: 6, bag_size: 236
batch 700, loss: 0.0116, instance_loss: 0.0095, weighted_loss: 0.0109, label: 6, bag_size: 987
batch 800, loss: 0.1337, instance_loss: 0.0976, weighted_loss: 0.1229, label: 6, bag_size: 654
batch 900, loss: 0.5190, instance_loss: 0.1805, weighted_loss: 0.4175, label: 7, bag_size: 764
batch 1000, loss: 1.7007, instance_loss: 0.1947, weighted_loss: 1.2489, label: 10, bag_size: 661
batch 1100, loss: 0.0039, instance_loss: 0.0093, weighted_loss: 0.0055, label: 6, bag_size: 329
batch 1200, loss: 2.6588, instance_loss: 0.3014, weighted_loss: 1.9516, label: 6, bag_size: 3052
batch 1300, loss: 1.3614, instance_loss: 0.1699, weighted_loss: 1.0040, label: 3, bag_size: 298
batch 1400, loss: 0.6143, instance_loss: 0.1636, weighted_loss: 0.4791, label: 6, bag_size: 469
batch 1500, loss: 0.9378, instance_loss: 0.3227, weighted_loss: 0.7532, label: 3, bag_size: 360
batch 1600, loss: 2.7688, instance_loss: 0.2768, weighted_loss: 2.0212, label: 3, bag_size: 170
batch 1700, loss: 0.5608, instance_loss: 0.1846, weighted_loss: 0.4479, label: 7, bag_size: 689
batch 1800, loss: 0.3840, instance_loss: 0.1318, weighted_loss: 0.3083, label: 6, bag_size: 2114
batch 1900, loss: 0.6429, instance_loss: 0.1956, weighted_loss: 0.5087, label: 4, bag_size: 428
batch 2000, loss: 0.5397, instance_loss: 0.1463, weighted_loss: 0.4216, label: 6, bag_size: 431
batch 2100, loss: 1.2973, instance_loss: 0.2015, weighted_loss: 0.9686, label: 10, bag_size: 175

Instance Classifier Stats
class 0 clustering acc 0.9968852863726135: correct 242283/243040
class 1 clustering acc 0.220852534562212: correct 3834/17360

Epoch: 41, train_loss: 0.7191, train_clustering_loss:  0.1477, train_error: 0.2249
fine class 0: fine acc 0.5, correct fine 6/12 
fine class 1: fine acc 0.40625, correct fine 13/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8529980657640233, correct fine 441/517 
fine class 4: fine acc 0.48, correct fine 72/150 
fine class 5: fine acc 0.5391304347826087, correct fine 62/115 
fine class 6: fine acc 0.9367541766109785, correct fine 785/838 
fine class 7: fine acc 0.6947791164658634, correct fine 173/249 
fine class 8: fine acc 0.651685393258427, correct fine 58/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.4393939393939394, correct fine 58/132 
fine class 11: fine acc 0.5, correct fine 5/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.34615384615384615, correct fine 9/26 
Overall Accuracy: 0.7751

Val Set, val_loss: 1.6750, val_error: 0.5227, auc: 0.7701
class 0 clustering acc 0.9967194264069265: correct 29471/29568 
class 1 clustering acc 0.20454545454545456: correct 432/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.7403846153846154, correct fine 77/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4773
Overall F1 Score: 0.1906

Training for fine level...
batch 100, loss: 0.0269, instance_loss: 0.0228, weighted_loss: 0.0257, label: 6, bag_size: 702
batch 200, loss: 1.9548, instance_loss: 0.3058, weighted_loss: 1.4601, label: 4, bag_size: 1666
batch 300, loss: 0.3770, instance_loss: 0.1257, weighted_loss: 0.3016, label: 6, bag_size: 293
batch 400, loss: 0.1752, instance_loss: 0.0654, weighted_loss: 0.1422, label: 3, bag_size: 872
batch 500, loss: 0.2665, instance_loss: 0.1614, weighted_loss: 0.2350, label: 7, bag_size: 1072
batch 600, loss: 0.0060, instance_loss: 0.0113, weighted_loss: 0.0076, label: 6, bag_size: 987
batch 700, loss: 0.3837, instance_loss: 0.1207, weighted_loss: 0.3048, label: 6, bag_size: 704
batch 800, loss: 0.1624, instance_loss: 0.0476, weighted_loss: 0.1280, label: 6, bag_size: 483
batch 900, loss: 0.0869, instance_loss: 0.1696, weighted_loss: 0.1117, label: 7, bag_size: 482
batch 1000, loss: 0.4959, instance_loss: 0.1736, weighted_loss: 0.3992, label: 1, bag_size: 129
batch 1100, loss: 1.7132, instance_loss: 0.2266, weighted_loss: 1.2672, label: 3, bag_size: 170
batch 1200, loss: 0.0752, instance_loss: 0.1035, weighted_loss: 0.0837, label: 6, bag_size: 305
batch 1300, loss: 1.8869, instance_loss: 0.2265, weighted_loss: 1.3888, label: 10, bag_size: 388
batch 1400, loss: 2.8092, instance_loss: 0.3063, weighted_loss: 2.0583, label: 7, bag_size: 1414
batch 1500, loss: 0.4051, instance_loss: 0.1258, weighted_loss: 0.3213, label: 6, bag_size: 394
batch 1600, loss: 0.9199, instance_loss: 0.1869, weighted_loss: 0.7000, label: 10, bag_size: 212
batch 1700, loss: 1.6737, instance_loss: 0.2129, weighted_loss: 1.2355, label: 4, bag_size: 459
batch 1800, loss: 0.0800, instance_loss: 0.0249, weighted_loss: 0.0634, label: 6, bag_size: 518
batch 1900, loss: 0.6228, instance_loss: 0.1204, weighted_loss: 0.4721, label: 6, bag_size: 1246
batch 2000, loss: 0.1169, instance_loss: 0.0964, weighted_loss: 0.1107, label: 6, bag_size: 655
batch 2100, loss: 0.6396, instance_loss: 0.2023, weighted_loss: 0.5084, label: 4, bag_size: 683

Instance Classifier Stats
class 0 clustering acc 0.9968811718235682: correct 242282/243040
class 1 clustering acc 0.22638248847926268: correct 3930/17360

Epoch: 42, train_loss: 0.7047, train_clustering_loss:  0.1474, train_error: 0.2249
fine class 0: fine acc 0.6666666666666666, correct fine 8/12 
fine class 1: fine acc 0.40625, correct fine 13/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8607350096711799, correct fine 445/517 
fine class 4: fine acc 0.4066666666666667, correct fine 61/150 
fine class 5: fine acc 0.5652173913043478, correct fine 65/115 
fine class 6: fine acc 0.9367541766109785, correct fine 785/838 
fine class 7: fine acc 0.6666666666666666, correct fine 166/249 
fine class 8: fine acc 0.5842696629213483, correct fine 52/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.5378787878787878, correct fine 71/132 
fine class 11: fine acc 0.5, correct fine 5/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.4230769230769231, correct fine 11/26 
Overall Accuracy: 0.7751

Val Set, val_loss: 1.6797, val_error: 0.5152, auc: 0.7663
class 0 clustering acc 0.9969223484848485: correct 29477/29568 
class 1 clustering acc 0.19412878787878787: correct 410/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7211538461538461, correct fine 75/104 
fine class 7: fine acc 0.3, correct fine 9/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4848
Overall F1 Score: 0.2033

Training for fine level...
batch 100, loss: 1.2672, instance_loss: 0.2391, weighted_loss: 0.9587, label: 10, bag_size: 356
batch 200, loss: 0.0215, instance_loss: 0.0162, weighted_loss: 0.0199, label: 6, bag_size: 764
batch 300, loss: 0.4922, instance_loss: 0.0932, weighted_loss: 0.3725, label: 3, bag_size: 671
batch 400, loss: 0.2373, instance_loss: 0.2075, weighted_loss: 0.2283, label: 3, bag_size: 472
batch 500, loss: 1.9393, instance_loss: 0.0871, weighted_loss: 1.3836, label: 3, bag_size: 940
batch 600, loss: 0.0372, instance_loss: 0.0740, weighted_loss: 0.0482, label: 3, bag_size: 214
batch 700, loss: 0.4285, instance_loss: 0.1279, weighted_loss: 0.3383, label: 5, bag_size: 1181
batch 800, loss: 0.7094, instance_loss: 0.2913, weighted_loss: 0.5840, label: 4, bag_size: 366
batch 900, loss: 1.1729, instance_loss: 0.1764, weighted_loss: 0.8740, label: 8, bag_size: 168
batch 1000, loss: 0.0033, instance_loss: 0.0136, weighted_loss: 0.0064, label: 6, bag_size: 732
batch 1100, loss: 0.5289, instance_loss: 0.1958, weighted_loss: 0.4290, label: 7, bag_size: 243
batch 1200, loss: 1.6278, instance_loss: 0.2085, weighted_loss: 1.2020, label: 10, bag_size: 1555
batch 1300, loss: 0.1087, instance_loss: 0.0990, weighted_loss: 0.1057, label: 6, bag_size: 808
batch 1400, loss: 2.8056, instance_loss: 0.3449, weighted_loss: 2.0674, label: 1, bag_size: 440
batch 1500, loss: 0.3994, instance_loss: 0.1919, weighted_loss: 0.3371, label: 3, bag_size: 267
batch 1600, loss: 0.0178, instance_loss: 0.0689, weighted_loss: 0.0331, label: 6, bag_size: 605
batch 1700, loss: 0.0190, instance_loss: 0.0841, weighted_loss: 0.0385, label: 3, bag_size: 333
batch 1800, loss: 1.0682, instance_loss: 0.1796, weighted_loss: 0.8016, label: 10, bag_size: 116
batch 1900, loss: 0.3169, instance_loss: 0.1602, weighted_loss: 0.2699, label: 6, bag_size: 421
batch 2000, loss: 0.3897, instance_loss: 0.1792, weighted_loss: 0.3266, label: 3, bag_size: 282
batch 2100, loss: 2.5678, instance_loss: 0.2567, weighted_loss: 1.8745, label: 4, bag_size: 806

Instance Classifier Stats
class 0 clustering acc 0.9969346609611587: correct 242295/243040
class 1 clustering acc 0.2203341013824885: correct 3825/17360

Epoch: 43, train_loss: 0.6881, train_clustering_loss:  0.1476, train_error: 0.2152
fine class 0: fine acc 0.75, correct fine 9/12 
fine class 1: fine acc 0.5, correct fine 16/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.839458413926499, correct fine 434/517 
fine class 4: fine acc 0.5533333333333333, correct fine 83/150 
fine class 5: fine acc 0.6, correct fine 69/115 
fine class 6: fine acc 0.931980906921241, correct fine 781/838 
fine class 7: fine acc 0.7028112449799196, correct fine 175/249 
fine class 8: fine acc 0.6292134831460674, correct fine 56/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.5, correct fine 66/132 
fine class 11: fine acc 0.4, correct fine 4/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.38461538461538464, correct fine 10/26 
Overall Accuracy: 0.7848

Val Set, val_loss: 1.6954, val_error: 0.5227, auc: 0.7664
class 0 clustering acc 0.9966179653679653: correct 29468/29568 
class 1 clustering acc 0.2021780303030303: correct 427/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7307692307692307, correct fine 76/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.125, correct fine 2/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4773
Overall F1 Score: 0.1889

Training for fine level...
batch 100, loss: 0.9222, instance_loss: 0.1859, weighted_loss: 0.7013, label: 10, bag_size: 565
batch 200, loss: 1.9534, instance_loss: 0.2627, weighted_loss: 1.4462, label: 6, bag_size: 3052
batch 300, loss: 0.8192, instance_loss: 0.2579, weighted_loss: 0.6508, label: 13, bag_size: 752
batch 400, loss: 0.0052, instance_loss: 0.0283, weighted_loss: 0.0121, label: 6, bag_size: 656
batch 500, loss: 0.1015, instance_loss: 0.0697, weighted_loss: 0.0920, label: 3, bag_size: 673
batch 600, loss: 1.4234, instance_loss: 0.2247, weighted_loss: 1.0638, label: 8, bag_size: 489
batch 700, loss: 0.0312, instance_loss: 0.0298, weighted_loss: 0.0308, label: 6, bag_size: 574
batch 800, loss: 1.2609, instance_loss: 0.1293, weighted_loss: 0.9214, label: 3, bag_size: 313
batch 900, loss: 0.3018, instance_loss: 0.2026, weighted_loss: 0.2721, label: 3, bag_size: 558
batch 1000, loss: 0.0570, instance_loss: 0.0396, weighted_loss: 0.0518, label: 6, bag_size: 1023
batch 1100, loss: 0.0283, instance_loss: 0.0512, weighted_loss: 0.0352, label: 6, bag_size: 637
batch 1200, loss: 0.3045, instance_loss: 0.1378, weighted_loss: 0.2545, label: 3, bag_size: 534
batch 1300, loss: 0.3399, instance_loss: 0.0786, weighted_loss: 0.2615, label: 3, bag_size: 940
batch 1400, loss: 1.2823, instance_loss: 0.2000, weighted_loss: 0.9576, label: 6, bag_size: 921
batch 1500, loss: 0.1326, instance_loss: 0.1899, weighted_loss: 0.1498, label: 7, bag_size: 307
batch 1600, loss: 0.4186, instance_loss: 0.0697, weighted_loss: 0.3139, label: 6, bag_size: 239
batch 1700, loss: 0.0019, instance_loss: 0.0207, weighted_loss: 0.0075, label: 6, bag_size: 444
batch 1800, loss: 0.1751, instance_loss: 0.1221, weighted_loss: 0.1592, label: 7, bag_size: 509
batch 1900, loss: 0.2541, instance_loss: 0.1464, weighted_loss: 0.2218, label: 6, bag_size: 378
batch 2000, loss: 0.1820, instance_loss: 0.1372, weighted_loss: 0.1686, label: 6, bag_size: 1716
batch 2100, loss: 0.8274, instance_loss: 0.2131, weighted_loss: 0.6431, label: 4, bag_size: 709

Instance Classifier Stats
class 0 clustering acc 0.9968441408821593: correct 242273/243040
class 1 clustering acc 0.22344470046082948: correct 3879/17360

Epoch: 44, train_loss: 0.6785, train_clustering_loss:  0.1475, train_error: 0.2074
fine class 0: fine acc 0.75, correct fine 9/12 
fine class 1: fine acc 0.4375, correct fine 14/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.851063829787234, correct fine 440/517 
fine class 4: fine acc 0.5066666666666667, correct fine 76/150 
fine class 5: fine acc 0.5826086956521739, correct fine 67/115 
fine class 6: fine acc 0.9391408114558473, correct fine 787/838 
fine class 7: fine acc 0.7108433734939759, correct fine 177/249 
fine class 8: fine acc 0.6741573033707865, correct fine 60/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.553030303030303, correct fine 73/132 
fine class 11: fine acc 0.4, correct fine 4/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.5, correct fine 13/26 
Overall Accuracy: 0.7926

Val Set, val_loss: 1.7251, val_error: 0.5341, auc: 0.7643
class 0 clustering acc 0.9967870670995671: correct 29473/29568 
class 1 clustering acc 0.19176136363636365: correct 405/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7019230769230769, correct fine 73/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.1875, correct fine 3/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4659
Overall F1 Score: 0.1893

Training for fine level...
batch 100, loss: 0.4539, instance_loss: 0.1776, weighted_loss: 0.3710, label: 10, bag_size: 208
batch 200, loss: 0.1018, instance_loss: 0.0821, weighted_loss: 0.0959, label: 3, bag_size: 2627
batch 300, loss: 0.9835, instance_loss: 0.2003, weighted_loss: 0.7486, label: 10, bag_size: 185
batch 400, loss: 0.2946, instance_loss: 0.1234, weighted_loss: 0.2432, label: 6, bag_size: 473
batch 500, loss: 0.1866, instance_loss: 0.1149, weighted_loss: 0.1651, label: 6, bag_size: 305
batch 600, loss: 0.0498, instance_loss: 0.0533, weighted_loss: 0.0508, label: 6, bag_size: 814
batch 700, loss: 0.1650, instance_loss: 0.1196, weighted_loss: 0.1514, label: 6, bag_size: 299
batch 800, loss: 0.0512, instance_loss: 0.0864, weighted_loss: 0.0617, label: 3, bag_size: 1833
batch 900, loss: 1.8788, instance_loss: 0.1938, weighted_loss: 1.3733, label: 3, bag_size: 217
batch 1000, loss: 1.3879, instance_loss: 0.2158, weighted_loss: 1.0363, label: 3, bag_size: 186
batch 1100, loss: 0.3680, instance_loss: 0.2066, weighted_loss: 0.3196, label: 7, bag_size: 541
batch 1200, loss: 0.0199, instance_loss: 0.1889, weighted_loss: 0.0706, label: 7, bag_size: 1096
batch 1300, loss: 1.7244, instance_loss: 0.2622, weighted_loss: 1.2857, label: 10, bag_size: 567
batch 1400, loss: 0.0970, instance_loss: 0.0893, weighted_loss: 0.0947, label: 6, bag_size: 290
batch 1500, loss: 0.2938, instance_loss: 0.0727, weighted_loss: 0.2274, label: 6, bag_size: 600
batch 1600, loss: 0.0178, instance_loss: 0.0222, weighted_loss: 0.0191, label: 6, bag_size: 717
batch 1700, loss: 2.1176, instance_loss: 0.2608, weighted_loss: 1.5606, label: 5, bag_size: 1061
batch 1800, loss: 3.1095, instance_loss: 0.3195, weighted_loss: 2.2725, label: 6, bag_size: 1364
batch 1900, loss: 0.1752, instance_loss: 0.1147, weighted_loss: 0.1570, label: 7, bag_size: 477
batch 2000, loss: 0.2709, instance_loss: 0.2643, weighted_loss: 0.2689, label: 0, bag_size: 343
batch 2100, loss: 2.8938, instance_loss: 0.4846, weighted_loss: 2.1710, label: 4, bag_size: 477

Instance Classifier Stats
class 0 clustering acc 0.9968976300197498: correct 242286/243040
class 1 clustering acc 0.22730414746543778: correct 3946/17360

Epoch: 45, train_loss: 0.6515, train_clustering_loss:  0.1466, train_error: 0.2005
fine class 0: fine acc 0.8333333333333334, correct fine 10/12 
fine class 1: fine acc 0.53125, correct fine 17/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8665377176015474, correct fine 448/517 
fine class 4: fine acc 0.4866666666666667, correct fine 73/150 
fine class 5: fine acc 0.5739130434782609, correct fine 66/115 
fine class 6: fine acc 0.9343675417661098, correct fine 783/838 
fine class 7: fine acc 0.7068273092369478, correct fine 176/249 
fine class 8: fine acc 0.6966292134831461, correct fine 62/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.5984848484848485, correct fine 79/132 
fine class 11: fine acc 0.7, correct fine 7/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.5384615384615384, correct fine 14/26 
Overall Accuracy: 0.7995

Val Set, val_loss: 1.7167, val_error: 0.5265, auc: 0.7608
class 0 clustering acc 0.9966517857142857: correct 29469/29568 
class 1 clustering acc 0.19412878787878787: correct 410/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7019230769230769, correct fine 73/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4735
Overall F1 Score: 0.1859

Training for fine level...
batch 100, loss: 0.0582, instance_loss: 0.0643, weighted_loss: 0.0600, label: 6, bag_size: 323
batch 200, loss: 0.0085, instance_loss: 0.0435, weighted_loss: 0.0190, label: 6, bag_size: 409
batch 300, loss: 1.4300, instance_loss: 0.2332, weighted_loss: 1.0710, label: 10, bag_size: 571
batch 400, loss: 0.0481, instance_loss: 0.0369, weighted_loss: 0.0447, label: 6, bag_size: 324
batch 500, loss: 0.1161, instance_loss: 0.1252, weighted_loss: 0.1188, label: 6, bag_size: 352
batch 600, loss: 0.6329, instance_loss: 0.1981, weighted_loss: 0.5024, label: 7, bag_size: 744
batch 700, loss: 1.9237, instance_loss: 0.3100, weighted_loss: 1.4396, label: 3, bag_size: 2625
batch 800, loss: 0.3400, instance_loss: 0.1753, weighted_loss: 0.2906, label: 7, bag_size: 1836
batch 900, loss: 0.5549, instance_loss: 0.1330, weighted_loss: 0.4283, label: 3, bag_size: 177
batch 1000, loss: 0.1415, instance_loss: 0.0480, weighted_loss: 0.1135, label: 6, bag_size: 1547
batch 1100, loss: 0.0018, instance_loss: 0.0186, weighted_loss: 0.0068, label: 6, bag_size: 162
batch 1200, loss: 0.0600, instance_loss: 0.0942, weighted_loss: 0.0703, label: 6, bag_size: 247
batch 1300, loss: 3.5450, instance_loss: 0.2261, weighted_loss: 2.5493, label: 6, bag_size: 150
batch 1400, loss: 0.4564, instance_loss: 0.1875, weighted_loss: 0.3757, label: 4, bag_size: 1967
batch 1500, loss: 1.3334, instance_loss: 0.1963, weighted_loss: 0.9923, label: 10, bag_size: 542
batch 1600, loss: 0.4512, instance_loss: 0.1697, weighted_loss: 0.3667, label: 7, bag_size: 201
batch 1700, loss: 2.9211, instance_loss: 0.3249, weighted_loss: 2.1422, label: 1, bag_size: 440
batch 1800, loss: 0.6079, instance_loss: 0.2061, weighted_loss: 0.4874, label: 4, bag_size: 2005
batch 1900, loss: 0.5744, instance_loss: 0.2033, weighted_loss: 0.4631, label: 10, bag_size: 151
batch 2000, loss: 1.4424, instance_loss: 0.2317, weighted_loss: 1.0792, label: 7, bag_size: 523
batch 2100, loss: 0.7943, instance_loss: 0.0821, weighted_loss: 0.5807, label: 3, bag_size: 490

Instance Classifier Stats
class 0 clustering acc 0.9968564845292955: correct 242276/243040
class 1 clustering acc 0.226036866359447: correct 3924/17360

Epoch: 46, train_loss: 0.6360, train_clustering_loss:  0.1466, train_error: 0.1935
fine class 0: fine acc 0.8333333333333334, correct fine 10/12 
fine class 1: fine acc 0.5625, correct fine 18/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8646034816247582, correct fine 447/517 
fine class 4: fine acc 0.5133333333333333, correct fine 77/150 
fine class 5: fine acc 0.591304347826087, correct fine 68/115 
fine class 6: fine acc 0.9439140811455847, correct fine 791/838 
fine class 7: fine acc 0.7469879518072289, correct fine 186/249 
fine class 8: fine acc 0.6853932584269663, correct fine 61/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.5606060606060606, correct fine 74/132 
fine class 11: fine acc 0.4, correct fine 4/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.5384615384615384, correct fine 14/26 
Overall Accuracy: 0.8065

Val Set, val_loss: 1.7477, val_error: 0.5189, auc: 0.7642
class 0 clustering acc 0.9961783008658008: correct 29455/29568 
class 1 clustering acc 0.20738636363636365: correct 438/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7403846153846154, correct fine 77/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.125, correct fine 2/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4811
Overall F1 Score: 0.1915

Training for fine level...
batch 100, loss: 2.6405, instance_loss: 0.2545, weighted_loss: 1.9247, label: 7, bag_size: 252
batch 200, loss: 0.6512, instance_loss: 0.2176, weighted_loss: 0.5211, label: 4, bag_size: 375
batch 300, loss: 0.2593, instance_loss: 0.2124, weighted_loss: 0.2452, label: 5, bag_size: 415
batch 400, loss: 0.8791, instance_loss: 0.1932, weighted_loss: 0.6733, label: 10, bag_size: 440
batch 500, loss: 0.0029, instance_loss: 0.0189, weighted_loss: 0.0077, label: 6, bag_size: 361
batch 600, loss: 0.4091, instance_loss: 0.1563, weighted_loss: 0.3333, label: 3, bag_size: 179
batch 700, loss: 0.0012, instance_loss: 0.0089, weighted_loss: 0.0035, label: 6, bag_size: 206
batch 800, loss: 0.6932, instance_loss: 0.1787, weighted_loss: 0.5388, label: 3, bag_size: 1663
batch 900, loss: 0.1581, instance_loss: 0.0782, weighted_loss: 0.1341, label: 6, bag_size: 205
batch 1000, loss: 0.0317, instance_loss: 0.0512, weighted_loss: 0.0376, label: 6, bag_size: 502
batch 1100, loss: 0.9761, instance_loss: 0.1044, weighted_loss: 0.7146, label: 6, bag_size: 1049
batch 1200, loss: 2.6096, instance_loss: 0.2679, weighted_loss: 1.9071, label: 4, bag_size: 1134
batch 1300, loss: 0.0633, instance_loss: 0.0490, weighted_loss: 0.0590, label: 6, bag_size: 387
batch 1400, loss: 0.4206, instance_loss: 0.1452, weighted_loss: 0.3380, label: 6, bag_size: 206
batch 1500, loss: 0.8227, instance_loss: 0.2459, weighted_loss: 0.6496, label: 4, bag_size: 709
batch 1600, loss: 0.7838, instance_loss: 0.1178, weighted_loss: 0.5840, label: 6, bag_size: 1347
batch 1700, loss: 0.1254, instance_loss: 0.0590, weighted_loss: 0.1055, label: 3, bag_size: 2121
batch 1800, loss: 0.2861, instance_loss: 0.1945, weighted_loss: 0.2587, label: 5, bag_size: 185
batch 1900, loss: 0.0121, instance_loss: 0.0627, weighted_loss: 0.0273, label: 6, bag_size: 604
batch 2000, loss: 0.2173, instance_loss: 0.4997, weighted_loss: 0.3020, label: 3, bag_size: 738
batch 2100, loss: 2.8412, instance_loss: 0.2294, weighted_loss: 2.0576, label: 7, bag_size: 562

Instance Classifier Stats
class 0 clustering acc 0.9969840355497037: correct 242307/243040
class 1 clustering acc 0.22690092165898618: correct 3939/17360

Epoch: 47, train_loss: 0.6297, train_clustering_loss:  0.1464, train_error: 0.1894
fine class 0: fine acc 0.75, correct fine 9/12 
fine class 1: fine acc 0.46875, correct fine 15/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8646034816247582, correct fine 447/517 
fine class 4: fine acc 0.5266666666666666, correct fine 79/150 
fine class 5: fine acc 0.5826086956521739, correct fine 67/115 
fine class 6: fine acc 0.9427207637231504, correct fine 790/838 
fine class 7: fine acc 0.7630522088353414, correct fine 190/249 
fine class 8: fine acc 0.6853932584269663, correct fine 61/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.5909090909090909, correct fine 78/132 
fine class 11: fine acc 0.7, correct fine 7/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.6153846153846154, correct fine 16/26 
Overall Accuracy: 0.8106

Val Set, val_loss: 1.7801, val_error: 0.5492, auc: 0.7624
class 0 clustering acc 0.9959415584415584: correct 29448/29568 
class 1 clustering acc 0.2206439393939394: correct 466/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.53125, correct fine 34/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7211538461538461, correct fine 75/104 
fine class 7: fine acc 0.13333333333333333, correct fine 4/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.125, correct fine 2/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4508
Overall F1 Score: 0.1670

Training for fine level...
batch 100, loss: 1.2988, instance_loss: 0.1787, weighted_loss: 0.9628, label: 5, bag_size: 88
batch 200, loss: 0.0119, instance_loss: 0.0250, weighted_loss: 0.0159, label: 6, bag_size: 180
batch 300, loss: 4.7039, instance_loss: 0.3585, weighted_loss: 3.4003, label: 6, bag_size: 3015
batch 400, loss: 1.0112, instance_loss: 0.2067, weighted_loss: 0.7699, label: 4, bag_size: 350
batch 500, loss: 0.1548, instance_loss: 0.1054, weighted_loss: 0.1399, label: 6, bag_size: 317
batch 600, loss: 2.0761, instance_loss: 0.2231, weighted_loss: 1.5202, label: 3, bag_size: 334
batch 700, loss: 0.9239, instance_loss: 0.2832, weighted_loss: 0.7317, label: 8, bag_size: 479
batch 800, loss: 0.2223, instance_loss: 0.0943, weighted_loss: 0.1839, label: 6, bag_size: 216
batch 900, loss: 2.4424, instance_loss: 0.3133, weighted_loss: 1.8037, label: 10, bag_size: 328
batch 1000, loss: 0.0811, instance_loss: 0.0564, weighted_loss: 0.0737, label: 6, bag_size: 400
batch 1100, loss: 1.2380, instance_loss: 0.1709, weighted_loss: 0.9179, label: 3, bag_size: 1084
batch 1200, loss: 0.4245, instance_loss: 0.0973, weighted_loss: 0.3264, label: 3, bag_size: 382
batch 1300, loss: 2.4047, instance_loss: 0.2081, weighted_loss: 1.7457, label: 10, bag_size: 430
batch 1400, loss: 0.6295, instance_loss: 0.2147, weighted_loss: 0.5050, label: 10, bag_size: 450
batch 1500, loss: 1.0869, instance_loss: 0.1897, weighted_loss: 0.8177, label: 10, bag_size: 212
batch 1600, loss: 0.0182, instance_loss: 0.0285, weighted_loss: 0.0213, label: 6, bag_size: 821
batch 1700, loss: 1.2179, instance_loss: 0.1413, weighted_loss: 0.8949, label: 3, bag_size: 537
batch 1800, loss: 4.3141, instance_loss: 0.2877, weighted_loss: 3.1062, label: 5, bag_size: 402
batch 1900, loss: 1.7592, instance_loss: 0.2203, weighted_loss: 1.2975, label: 5, bag_size: 665
batch 2000, loss: 1.4624, instance_loss: 0.2076, weighted_loss: 1.0860, label: 10, bag_size: 313
batch 2100, loss: 0.0771, instance_loss: 0.0545, weighted_loss: 0.0703, label: 3, bag_size: 1078

Instance Classifier Stats
class 0 clustering acc 0.9967042462146148: correct 242239/243040
class 1 clustering acc 0.22995391705069124: correct 3992/17360

Epoch: 48, train_loss: 0.6094, train_clustering_loss:  0.1458, train_error: 0.1797
fine class 0: fine acc 0.8333333333333334, correct fine 10/12 
fine class 1: fine acc 0.5625, correct fine 18/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8665377176015474, correct fine 448/517 
fine class 4: fine acc 0.5733333333333334, correct fine 86/150 
fine class 5: fine acc 0.6782608695652174, correct fine 78/115 
fine class 6: fine acc 0.9474940334128878, correct fine 794/838 
fine class 7: fine acc 0.751004016064257, correct fine 187/249 
fine class 8: fine acc 0.6629213483146067, correct fine 59/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.6287878787878788, correct fine 83/132 
fine class 11: fine acc 0.5, correct fine 5/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.46153846153846156, correct fine 12/26 
Overall Accuracy: 0.8203

Val Set, val_loss: 1.7837, val_error: 0.5303, auc: 0.7552
class 0 clustering acc 0.9960430194805194: correct 29451/29568 
class 1 clustering acc 0.20643939393939395: correct 436/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.6826923076923077, correct fine 71/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.125, correct fine 2/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4697
Overall F1 Score: 0.1894

Training for fine level...
batch 100, loss: 0.1905, instance_loss: 0.1403, weighted_loss: 0.1755, label: 6, bag_size: 301
batch 200, loss: 0.8713, instance_loss: 0.1519, weighted_loss: 0.6554, label: 6, bag_size: 344
batch 300, loss: 0.0359, instance_loss: 0.0329, weighted_loss: 0.0350, label: 6, bag_size: 827
batch 400, loss: 0.7303, instance_loss: 0.0920, weighted_loss: 0.5388, label: 3, bag_size: 757
batch 500, loss: 0.6044, instance_loss: 0.1173, weighted_loss: 0.4583, label: 6, bag_size: 1347
batch 600, loss: 0.0099, instance_loss: 0.0475, weighted_loss: 0.0212, label: 6, bag_size: 360
batch 700, loss: 0.0143, instance_loss: 0.1253, weighted_loss: 0.0476, label: 6, bag_size: 360
batch 800, loss: 1.2696, instance_loss: 0.2770, weighted_loss: 0.9718, label: 7, bag_size: 762
batch 900, loss: 0.1795, instance_loss: 0.1854, weighted_loss: 0.1813, label: 7, bag_size: 555
batch 1000, loss: 0.0163, instance_loss: 0.0287, weighted_loss: 0.0201, label: 6, bag_size: 743
batch 1100, loss: 0.3178, instance_loss: 0.1861, weighted_loss: 0.2783, label: 3, bag_size: 389
batch 1200, loss: 0.1001, instance_loss: 0.0383, weighted_loss: 0.0816, label: 6, bag_size: 364
batch 1300, loss: 0.0029, instance_loss: 0.0173, weighted_loss: 0.0072, label: 6, bag_size: 724
batch 1400, loss: 0.0974, instance_loss: 0.1322, weighted_loss: 0.1078, label: 6, bag_size: 609
batch 1500, loss: 0.1369, instance_loss: 0.0290, weighted_loss: 0.1045, label: 6, bag_size: 1301
batch 1600, loss: 0.0062, instance_loss: 0.0138, weighted_loss: 0.0085, label: 6, bag_size: 485
batch 1700, loss: 0.2282, instance_loss: 0.1306, weighted_loss: 0.1989, label: 6, bag_size: 368
batch 1800, loss: 2.1713, instance_loss: 0.2405, weighted_loss: 1.5921, label: 7, bag_size: 545
batch 1900, loss: 1.1631, instance_loss: 0.2001, weighted_loss: 0.8742, label: 3, bag_size: 910
batch 2000, loss: 4.4542, instance_loss: 0.3462, weighted_loss: 3.2218, label: 1, bag_size: 807
batch 2100, loss: 1.3462, instance_loss: 0.1982, weighted_loss: 1.0018, label: 4, bag_size: 610

Instance Classifier Stats
class 0 clustering acc 0.996667215273206: correct 242230/243040
class 1 clustering acc 0.2305299539170507: correct 4002/17360

Epoch: 49, train_loss: 0.5942, train_clustering_loss:  0.1463, train_error: 0.1820
fine class 0: fine acc 0.6666666666666666, correct fine 8/12 
fine class 1: fine acc 0.625, correct fine 20/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8781431334622823, correct fine 454/517 
fine class 4: fine acc 0.52, correct fine 78/150 
fine class 5: fine acc 0.6260869565217392, correct fine 72/115 
fine class 6: fine acc 0.9427207637231504, correct fine 790/838 
fine class 7: fine acc 0.7670682730923695, correct fine 191/249 
fine class 8: fine acc 0.7191011235955056, correct fine 64/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.5681818181818182, correct fine 75/132 
fine class 11: fine acc 0.7, correct fine 7/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.6153846153846154, correct fine 16/26 
Overall Accuracy: 0.8180

Val Set, val_loss: 1.7897, val_error: 0.5379, auc: 0.7575
class 0 clustering acc 0.9963474025974026: correct 29460/29568 
class 1 clustering acc 0.20170454545454544: correct 426/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.6923076923076923, correct fine 72/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4621
Overall F1 Score: 0.1795

Training for fine level...
batch 100, loss: 0.2657, instance_loss: 0.1746, weighted_loss: 0.2384, label: 7, bag_size: 316
batch 200, loss: 0.0789, instance_loss: 0.0621, weighted_loss: 0.0739, label: 6, bag_size: 461
batch 300, loss: 0.1433, instance_loss: 0.2974, weighted_loss: 0.1896, label: 3, bag_size: 541
batch 400, loss: 0.8912, instance_loss: 0.2266, weighted_loss: 0.6918, label: 7, bag_size: 113
batch 500, loss: 0.2592, instance_loss: 0.0588, weighted_loss: 0.1991, label: 6, bag_size: 254
batch 600, loss: 0.0340, instance_loss: 0.0390, weighted_loss: 0.0355, label: 6, bag_size: 252
batch 700, loss: 0.5353, instance_loss: 0.2471, weighted_loss: 0.4488, label: 3, bag_size: 2139
batch 800, loss: 0.2979, instance_loss: 0.1466, weighted_loss: 0.2525, label: 5, bag_size: 507
batch 900, loss: 1.2648, instance_loss: 0.2357, weighted_loss: 0.9561, label: 7, bag_size: 497
batch 1000, loss: 0.0289, instance_loss: 0.0464, weighted_loss: 0.0342, label: 3, bag_size: 666
batch 1100, loss: 0.0062, instance_loss: 0.0129, weighted_loss: 0.0082, label: 6, bag_size: 424
batch 1200, loss: 0.0009, instance_loss: 0.0204, weighted_loss: 0.0068, label: 6, bag_size: 397
batch 1300, loss: 0.1736, instance_loss: 0.1355, weighted_loss: 0.1622, label: 3, bag_size: 534
batch 1400, loss: 1.3958, instance_loss: 0.2157, weighted_loss: 1.0417, label: 1, bag_size: 149
batch 1500, loss: 0.0332, instance_loss: 0.0262, weighted_loss: 0.0311, label: 6, bag_size: 676
batch 1600, loss: 0.1088, instance_loss: 0.0692, weighted_loss: 0.0969, label: 6, bag_size: 459
batch 1700, loss: 0.0918, instance_loss: 0.0436, weighted_loss: 0.0773, label: 6, bag_size: 542
batch 1800, loss: 2.0612, instance_loss: 0.2871, weighted_loss: 1.5290, label: 5, bag_size: 691
batch 1900, loss: 0.3355, instance_loss: 0.0796, weighted_loss: 0.2587, label: 3, bag_size: 2213
batch 2000, loss: 1.6954, instance_loss: 0.2877, weighted_loss: 1.2731, label: 10, bag_size: 715
batch 2100, loss: 0.0250, instance_loss: 0.0468, weighted_loss: 0.0315, label: 6, bag_size: 498

Instance Classifier Stats
class 0 clustering acc 0.996860599078341: correct 242277/243040
class 1 clustering acc 0.2288594470046083: correct 3973/17360

Epoch: 50, train_loss: 0.5796, train_clustering_loss:  0.1457, train_error: 0.1696
fine class 0: fine acc 0.75, correct fine 9/12 
fine class 1: fine acc 0.625, correct fine 20/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8839458413926499, correct fine 457/517 
fine class 4: fine acc 0.5466666666666666, correct fine 82/150 
fine class 5: fine acc 0.6521739130434783, correct fine 75/115 
fine class 6: fine acc 0.9486873508353222, correct fine 795/838 
fine class 7: fine acc 0.7710843373493976, correct fine 192/249 
fine class 8: fine acc 0.7528089887640449, correct fine 67/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.6287878787878788, correct fine 83/132 
fine class 11: fine acc 0.8, correct fine 8/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.5384615384615384, correct fine 14/26 
Overall Accuracy: 0.8304

Val Set, val_loss: 1.8018, val_error: 0.5379, auc: 0.7610
class 0 clustering acc 0.9963135822510822: correct 29459/29568 
class 1 clustering acc 0.20928030303030304: correct 442/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.53125, correct fine 34/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7115384615384616, correct fine 74/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.1875, correct fine 3/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4621
Overall F1 Score: 0.1798

Training for fine level...
batch 100, loss: 1.4084, instance_loss: 0.2414, weighted_loss: 1.0583, label: 7, bag_size: 739
batch 200, loss: 1.4499, instance_loss: 0.2037, weighted_loss: 1.0761, label: 6, bag_size: 128
batch 300, loss: 0.1925, instance_loss: 0.1386, weighted_loss: 0.1764, label: 8, bag_size: 163
batch 400, loss: 0.1870, instance_loss: 0.1673, weighted_loss: 0.1811, label: 6, bag_size: 40
batch 500, loss: 0.1394, instance_loss: 0.0908, weighted_loss: 0.1249, label: 3, bag_size: 700
batch 600, loss: 0.0135, instance_loss: 0.0299, weighted_loss: 0.0185, label: 6, bag_size: 288
batch 700, loss: 0.0724, instance_loss: 0.2006, weighted_loss: 0.1109, label: 7, bag_size: 1248
batch 800, loss: 0.5582, instance_loss: 0.2530, weighted_loss: 0.4667, label: 3, bag_size: 317
batch 900, loss: 0.1173, instance_loss: 0.1207, weighted_loss: 0.1184, label: 6, bag_size: 290
batch 1000, loss: 0.1667, instance_loss: 0.0687, weighted_loss: 0.1373, label: 3, bag_size: 2119
batch 1100, loss: 0.1227, instance_loss: 0.0717, weighted_loss: 0.1074, label: 6, bag_size: 622
batch 1200, loss: 0.0227, instance_loss: 0.0236, weighted_loss: 0.0230, label: 6, bag_size: 83
batch 1300, loss: 1.8358, instance_loss: 0.2010, weighted_loss: 1.3454, label: 7, bag_size: 395
batch 1400, loss: 0.5355, instance_loss: 0.1001, weighted_loss: 0.4049, label: 3, bag_size: 1279
batch 1500, loss: 1.6231, instance_loss: 0.1378, weighted_loss: 1.1775, label: 3, bag_size: 1618
batch 1600, loss: 0.3815, instance_loss: 0.0857, weighted_loss: 0.2928, label: 3, bag_size: 1353
batch 1700, loss: 0.0190, instance_loss: 0.0516, weighted_loss: 0.0288, label: 6, bag_size: 280
batch 1800, loss: 0.1999, instance_loss: 0.1669, weighted_loss: 0.1900, label: 6, bag_size: 104
batch 1900, loss: 0.2465, instance_loss: 0.1296, weighted_loss: 0.2114, label: 1, bag_size: 235
batch 2000, loss: 0.9568, instance_loss: 0.2007, weighted_loss: 0.7300, label: 7, bag_size: 406
batch 2100, loss: 0.1988, instance_loss: 0.1102, weighted_loss: 0.1722, label: 6, bag_size: 338

Instance Classifier Stats
class 0 clustering acc 0.9967906517445688: correct 242260/243040
class 1 clustering acc 0.23369815668202765: correct 4057/17360

Epoch: 51, train_loss: 0.5554, train_clustering_loss:  0.1459, train_error: 0.1618
fine class 0: fine acc 0.8333333333333334, correct fine 10/12 
fine class 1: fine acc 0.59375, correct fine 19/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8955512572533849, correct fine 463/517 
fine class 4: fine acc 0.5933333333333334, correct fine 89/150 
fine class 5: fine acc 0.6782608695652174, correct fine 78/115 
fine class 6: fine acc 0.954653937947494, correct fine 800/838 
fine class 7: fine acc 0.7670682730923695, correct fine 191/249 
fine class 8: fine acc 0.6741573033707865, correct fine 60/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.6287878787878788, correct fine 83/132 
fine class 11: fine acc 0.9, correct fine 9/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.6538461538461539, correct fine 17/26 
Overall Accuracy: 0.8382

Val Set, val_loss: 1.8080, val_error: 0.5455, auc: 0.7590
class 0 clustering acc 0.9965165043290043: correct 29465/29568 
class 1 clustering acc 0.19554924242424243: correct 413/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5, correct fine 32/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.7019230769230769, correct fine 73/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.125, correct fine 2/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4545
Overall F1 Score: 0.1868

Training for fine level...
batch 100, loss: 0.3004, instance_loss: 0.1613, weighted_loss: 0.2587, label: 7, bag_size: 764
batch 200, loss: 0.0195, instance_loss: 0.0310, weighted_loss: 0.0229, label: 6, bag_size: 1023
batch 300, loss: 0.2098, instance_loss: 0.1705, weighted_loss: 0.1980, label: 10, bag_size: 65
batch 400, loss: 1.6741, instance_loss: 0.2180, weighted_loss: 1.2373, label: 10, bag_size: 228
batch 500, loss: 0.3231, instance_loss: 0.1591, weighted_loss: 0.2739, label: 6, bag_size: 658
batch 600, loss: 0.0074, instance_loss: 0.0155, weighted_loss: 0.0098, label: 6, bag_size: 139
batch 700, loss: 0.0262, instance_loss: 0.1085, weighted_loss: 0.0509, label: 6, bag_size: 1422
batch 800, loss: 0.0169, instance_loss: 0.0311, weighted_loss: 0.0211, label: 6, bag_size: 206
batch 900, loss: 1.6172, instance_loss: 0.1856, weighted_loss: 1.1877, label: 7, bag_size: 276
batch 1000, loss: 2.9503, instance_loss: 0.3804, weighted_loss: 2.1793, label: 3, bag_size: 641
batch 1100, loss: 0.8790, instance_loss: 0.1476, weighted_loss: 0.6596, label: 6, bag_size: 460
batch 1200, loss: 0.0057, instance_loss: 0.0123, weighted_loss: 0.0077, label: 6, bag_size: 442
batch 1300, loss: 1.3128, instance_loss: 0.1664, weighted_loss: 0.9689, label: 3, bag_size: 631
batch 1400, loss: 0.0590, instance_loss: 0.1515, weighted_loss: 0.0868, label: 3, bag_size: 332
batch 1500, loss: 1.0666, instance_loss: 0.2014, weighted_loss: 0.8070, label: 4, bag_size: 276
batch 1600, loss: 0.2450, instance_loss: 0.2645, weighted_loss: 0.2508, label: 5, bag_size: 201
batch 1700, loss: 0.9754, instance_loss: 0.2126, weighted_loss: 0.7465, label: 4, bag_size: 567
batch 1800, loss: 0.0009, instance_loss: 0.0275, weighted_loss: 0.0089, label: 6, bag_size: 185
batch 1900, loss: 0.0409, instance_loss: 0.0456, weighted_loss: 0.0423, label: 6, bag_size: 679
batch 2000, loss: 0.1581, instance_loss: 0.0715, weighted_loss: 0.1321, label: 6, bag_size: 618
batch 2100, loss: 0.2310, instance_loss: 0.0558, weighted_loss: 0.1784, label: 6, bag_size: 252

Instance Classifier Stats
class 0 clustering acc 0.9967083607636603: correct 242240/243040
class 1 clustering acc 0.23289170506912443: correct 4043/17360

Epoch: 52, train_loss: 0.5500, train_clustering_loss:  0.1452, train_error: 0.1682
fine class 0: fine acc 0.8333333333333334, correct fine 10/12 
fine class 1: fine acc 0.71875, correct fine 23/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8762088974854932, correct fine 453/517 
fine class 4: fine acc 0.5866666666666667, correct fine 88/150 
fine class 5: fine acc 0.6434782608695652, correct fine 74/115 
fine class 6: fine acc 0.9498806682577565, correct fine 796/838 
fine class 7: fine acc 0.7871485943775101, correct fine 196/249 
fine class 8: fine acc 0.7303370786516854, correct fine 65/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.5909090909090909, correct fine 78/132 
fine class 11: fine acc 0.8, correct fine 8/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.5384615384615384, correct fine 14/26 
Overall Accuracy: 0.8318

Val Set, val_loss: 1.8359, val_error: 0.5379, auc: 0.7600
class 0 clustering acc 0.9962121212121212: correct 29456/29568 
class 1 clustering acc 0.2012310606060606: correct 425/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7019230769230769, correct fine 73/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.125, correct fine 2/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4621
Overall F1 Score: 0.1766

Val error: 0.0000, ROC AUC: 0.5000
Test error: 0.0000, ROC AUC: 0.5000
fine class 0: fine acc None, correct fine 0/0 
fine class 1: fine acc None, correct fine 0/0 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc None, correct fine 0/0 
fine class 4: fine acc None, correct fine 0/0 
fine class 5: fine acc None, correct fine 0/0 
fine class 6: fine acc 1.0, correct fine 1/1 
fine class 7: fine acc None, correct fine 0/0 
fine class 8: fine acc None, correct fine 0/0 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc None, correct fine 0/0 
fine class 11: fine acc None, correct fine 0/0 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc None, correct fine 0/0 
