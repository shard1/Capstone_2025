Preparing data...
Training on 2170 samples
Validation on 264 samples
Test on 264 samples
Preparing model...
Done
Setting optimizer...
Done
Training for fine level...
batch 100, loss: 1.7212, instance_loss: 1.1773, weighted_loss: 1.5580, label: 6, bag_size: 358
batch 200, loss: 1.2920, instance_loss: 0.9757, weighted_loss: 1.1971, label: 6, bag_size: 483
batch 300, loss: 2.0278, instance_loss: 0.7353, weighted_loss: 1.6401, label: 3, bag_size: 57
batch 400, loss: 3.7346, instance_loss: 0.6046, weighted_loss: 2.7956, label: 1, bag_size: 207
batch 500, loss: 0.6493, instance_loss: 0.4265, weighted_loss: 0.5824, label: 6, bag_size: 498
batch 600, loss: 3.0389, instance_loss: 0.3984, weighted_loss: 2.2467, label: 5, bag_size: 483
batch 700, loss: 1.4542, instance_loss: 0.3556, weighted_loss: 1.1246, label: 3, bag_size: 182
batch 800, loss: 3.5473, instance_loss: 0.3295, weighted_loss: 2.5820, label: 8, bag_size: 444
batch 900, loss: 2.4436, instance_loss: 0.2945, weighted_loss: 1.7988, label: 4, bag_size: 1477
batch 1000, loss: 0.7551, instance_loss: 0.1991, weighted_loss: 0.5883, label: 6, bag_size: 376
batch 1100, loss: 3.2697, instance_loss: 0.2827, weighted_loss: 2.3736, label: 4, bag_size: 234
batch 1200, loss: 0.4929, instance_loss: 0.1702, weighted_loss: 0.3961, label: 6, bag_size: 206
batch 1300, loss: 1.1196, instance_loss: 0.2157, weighted_loss: 0.8484, label: 3, bag_size: 206
batch 1400, loss: 2.8297, instance_loss: 0.2659, weighted_loss: 2.0606, label: 10, bag_size: 486
batch 1500, loss: 2.1365, instance_loss: 0.2308, weighted_loss: 1.5648, label: 7, bag_size: 231
batch 1600, loss: 2.5092, instance_loss: 0.2474, weighted_loss: 1.8307, label: 10, bag_size: 245
batch 1700, loss: 2.3760, instance_loss: 0.2504, weighted_loss: 1.7383, label: 4, bag_size: 3011
batch 1800, loss: 3.6574, instance_loss: 0.2564, weighted_loss: 2.6371, label: 8, bag_size: 675
batch 1900, loss: 0.7556, instance_loss: 0.1979, weighted_loss: 0.5883, label: 3, bag_size: 757
batch 2000, loss: 4.4655, instance_loss: 0.2495, weighted_loss: 3.2007, label: 1, bag_size: 198
batch 2100, loss: 1.8589, instance_loss: 0.2322, weighted_loss: 1.3709, label: 7, bag_size: 477

Instance Classifier Stats
class 0 clustering acc 0.9754279131007242: correct 237068/243040
class 1 clustering acc 0.022119815668202765: correct 384/17360

Epoch: 1, train_loss: 1.7598, train_clustering_loss:  0.3878, train_error: 0.5774
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.30174081237911027, correct fine 156/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.0, correct fine 0/115 
fine class 6: fine acc 0.9069212410501193, correct fine 760/838 
fine class 7: fine acc 0.0, correct fine 0/249 
fine class 8: fine acc 0.0, correct fine 0/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.007575757575757576, correct fine 1/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4226

Val Set, val_loss: 1.5901, val_error: 0.5114, auc: 0.6749
class 0 clustering acc 1.0: correct 29568/29568 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.640625, correct fine 41/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.0, correct fine 0/14 
fine class 6: fine acc 0.8461538461538461, correct fine 88/104 
fine class 7: fine acc 0.0, correct fine 0/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4886
Overall F1 Score: 0.1050

Training for fine level...
batch 100, loss: 0.7697, instance_loss: 0.1936, weighted_loss: 0.5969, label: 3, bag_size: 988
batch 200, loss: 1.2087, instance_loss: 0.2166, weighted_loss: 0.9111, label: 3, bag_size: 1744
batch 300, loss: 1.4122, instance_loss: 0.1912, weighted_loss: 1.0459, label: 3, bag_size: 976
batch 400, loss: 0.8619, instance_loss: 0.1560, weighted_loss: 0.6501, label: 6, bag_size: 335
batch 500, loss: 1.7164, instance_loss: 0.2032, weighted_loss: 1.2625, label: 3, bag_size: 442
batch 600, loss: 2.2835, instance_loss: 0.2394, weighted_loss: 1.6703, label: 5, bag_size: 505
batch 700, loss: 1.0126, instance_loss: 0.1818, weighted_loss: 0.7634, label: 3, bag_size: 2658
batch 800, loss: 1.0738, instance_loss: 0.1244, weighted_loss: 0.7890, label: 6, bag_size: 1355
batch 900, loss: 1.4116, instance_loss: 0.1987, weighted_loss: 1.0477, label: 3, bag_size: 565
batch 1000, loss: 0.4069, instance_loss: 0.1245, weighted_loss: 0.3222, label: 6, bag_size: 221
batch 1100, loss: 1.8702, instance_loss: 0.1739, weighted_loss: 1.3613, label: 6, bag_size: 324
batch 1200, loss: 0.1158, instance_loss: 0.1134, weighted_loss: 0.1151, label: 6, bag_size: 223
batch 1300, loss: 0.3697, instance_loss: 0.1074, weighted_loss: 0.2910, label: 6, bag_size: 605
batch 1400, loss: 0.4997, instance_loss: 0.1057, weighted_loss: 0.3815, label: 6, bag_size: 234
batch 1500, loss: 2.0607, instance_loss: 0.2325, weighted_loss: 1.5122, label: 10, bag_size: 661
batch 1600, loss: 0.9483, instance_loss: 0.1517, weighted_loss: 0.7093, label: 6, bag_size: 223
batch 1700, loss: 1.7047, instance_loss: 0.2075, weighted_loss: 1.2556, label: 5, bag_size: 714
batch 1800, loss: 4.6109, instance_loss: 0.3095, weighted_loss: 3.3205, label: 13, bag_size: 335
batch 1900, loss: 0.6929, instance_loss: 0.1844, weighted_loss: 0.5403, label: 3, bag_size: 1231
batch 2000, loss: 2.4246, instance_loss: 0.2405, weighted_loss: 1.7694, label: 3, bag_size: 2059
batch 2100, loss: 0.6183, instance_loss: 0.1590, weighted_loss: 0.4805, label: 3, bag_size: 1470

Instance Classifier Stats
class 0 clustering acc 0.9999259381171823: correct 243022/243040
class 1 clustering acc 0.0032258064516129032: correct 56/17360

Epoch: 2, train_loss: 1.5618, train_clustering_loss:  0.1872, train_error: 0.5263
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6073500967117988, correct fine 314/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.0, correct fine 0/115 
fine class 6: fine acc 0.850835322195704, correct fine 713/838 
fine class 7: fine acc 0.004016064257028112, correct fine 1/249 
fine class 8: fine acc 0.0, correct fine 0/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4737

Val Set, val_loss: 1.5298, val_error: 0.5076, auc: 0.7130
class 0 clustering acc 1.0: correct 29568/29568 
class 1 clustering acc 0.0: correct 0/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.65625, correct fine 42/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.0, correct fine 0/14 
fine class 6: fine acc 0.8461538461538461, correct fine 88/104 
fine class 7: fine acc 0.0, correct fine 0/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1063

Training for fine level...
batch 100, loss: 0.3155, instance_loss: 0.1043, weighted_loss: 0.2522, label: 6, bag_size: 221
batch 200, loss: 1.6424, instance_loss: 0.2197, weighted_loss: 1.2156, label: 7, bag_size: 239
batch 300, loss: 0.2350, instance_loss: 0.0958, weighted_loss: 0.1932, label: 6, bag_size: 330
batch 400, loss: 2.9632, instance_loss: 0.2524, weighted_loss: 2.1500, label: 5, bag_size: 264
batch 500, loss: 0.5147, instance_loss: 0.1153, weighted_loss: 0.3949, label: 6, bag_size: 1874
batch 600, loss: 1.6294, instance_loss: 0.2724, weighted_loss: 1.2223, label: 7, bag_size: 328
batch 700, loss: 1.9278, instance_loss: 0.1908, weighted_loss: 1.4067, label: 3, bag_size: 559
batch 800, loss: 4.0335, instance_loss: 0.3413, weighted_loss: 2.9258, label: 13, bag_size: 310
batch 900, loss: 0.7820, instance_loss: 0.1471, weighted_loss: 0.5915, label: 3, bag_size: 354
batch 1000, loss: 0.2835, instance_loss: 0.0837, weighted_loss: 0.2235, label: 6, bag_size: 467
batch 1100, loss: 0.1523, instance_loss: 0.0815, weighted_loss: 0.1311, label: 6, bag_size: 488
batch 1200, loss: 1.4069, instance_loss: 0.1437, weighted_loss: 1.0280, label: 3, bag_size: 592
batch 1300, loss: 2.4381, instance_loss: 0.2473, weighted_loss: 1.7809, label: 4, bag_size: 755
batch 1400, loss: 1.9112, instance_loss: 0.2216, weighted_loss: 1.4043, label: 3, bag_size: 215
batch 1500, loss: 0.6679, instance_loss: 0.1184, weighted_loss: 0.5030, label: 6, bag_size: 360
batch 1600, loss: 1.5280, instance_loss: 0.1987, weighted_loss: 1.1292, label: 3, bag_size: 347
batch 1700, loss: 0.3820, instance_loss: 0.0856, weighted_loss: 0.2931, label: 6, bag_size: 765
batch 1800, loss: 2.2504, instance_loss: 0.2359, weighted_loss: 1.6461, label: 10, bag_size: 679
batch 1900, loss: 0.5059, instance_loss: 0.1268, weighted_loss: 0.3922, label: 3, bag_size: 1476
batch 2000, loss: 2.6017, instance_loss: 0.2898, weighted_loss: 1.9081, label: 8, bag_size: 778
batch 2100, loss: 4.0344, instance_loss: 0.3073, weighted_loss: 2.9163, label: 13, bag_size: 472

Instance Classifier Stats
class 0 clustering acc 0.9994980250164582: correct 242918/243040
class 1 clustering acc 0.036578341013824886: correct 635/17360

Epoch: 3, train_loss: 1.4972, train_clustering_loss:  0.1792, train_error: 0.5124
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6286266924564797, correct fine 325/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.02608695652173913, correct fine 3/115 
fine class 6: fine acc 0.863961813842482, correct fine 724/838 
fine class 7: fine acc 0.024096385542168676, correct fine 6/249 
fine class 8: fine acc 0.0, correct fine 0/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4876

Val Set, val_loss: 1.5075, val_error: 0.5417, auc: 0.7420
class 0 clustering acc 0.9997632575757576: correct 29561/29568 
class 1 clustering acc 0.026988636363636364: correct 57/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.671875, correct fine 43/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.0, correct fine 0/14 
fine class 6: fine acc 0.7403846153846154, correct fine 77/104 
fine class 7: fine acc 0.03333333333333333, correct fine 1/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4583
Overall F1 Score: 0.1062

Training for fine level...
batch 100, loss: 1.5799, instance_loss: 0.2194, weighted_loss: 1.1718, label: 7, bag_size: 453
batch 200, loss: 2.3541, instance_loss: 0.2386, weighted_loss: 1.7194, label: 8, bag_size: 111
batch 300, loss: 0.8819, instance_loss: 0.1368, weighted_loss: 0.6584, label: 6, bag_size: 258
batch 400, loss: 2.3019, instance_loss: 0.2363, weighted_loss: 1.6822, label: 8, bag_size: 438
batch 500, loss: 1.9033, instance_loss: 0.2235, weighted_loss: 1.3993, label: 5, bag_size: 904
batch 600, loss: 1.2789, instance_loss: 0.2235, weighted_loss: 0.9623, label: 7, bag_size: 244
batch 700, loss: 0.2168, instance_loss: 0.0622, weighted_loss: 0.1704, label: 6, bag_size: 628
batch 800, loss: 1.5172, instance_loss: 0.2065, weighted_loss: 1.1240, label: 7, bag_size: 247
batch 900, loss: 1.6006, instance_loss: 0.1903, weighted_loss: 1.1775, label: 6, bag_size: 338
batch 1000, loss: 0.9194, instance_loss: 0.1381, weighted_loss: 0.6850, label: 6, bag_size: 110
batch 1100, loss: 0.3615, instance_loss: 0.0959, weighted_loss: 0.2818, label: 6, bag_size: 601
batch 1200, loss: 0.3478, instance_loss: 0.1200, weighted_loss: 0.2794, label: 3, bag_size: 2121
batch 1300, loss: 1.3929, instance_loss: 0.2136, weighted_loss: 1.0391, label: 10, bag_size: 144
batch 1400, loss: 0.1040, instance_loss: 0.0465, weighted_loss: 0.0868, label: 6, bag_size: 705
batch 1500, loss: 2.2636, instance_loss: 0.2219, weighted_loss: 1.6511, label: 7, bag_size: 276
batch 1600, loss: 0.5241, instance_loss: 0.1197, weighted_loss: 0.4028, label: 6, bag_size: 1222
batch 1700, loss: 0.5640, instance_loss: 0.1039, weighted_loss: 0.4260, label: 6, bag_size: 358
batch 1800, loss: 1.6609, instance_loss: 0.2131, weighted_loss: 1.2266, label: 7, bag_size: 625
batch 1900, loss: 0.9705, instance_loss: 0.1721, weighted_loss: 0.7309, label: 3, bag_size: 459
batch 2000, loss: 3.2693, instance_loss: 0.2344, weighted_loss: 2.3588, label: 4, bag_size: 202
batch 2100, loss: 0.9190, instance_loss: 0.1135, weighted_loss: 0.6774, label: 6, bag_size: 599

Instance Classifier Stats
class 0 clustering acc 0.9984611586570112: correct 242666/243040
class 1 clustering acc 0.08870967741935484: correct 1540/17360

Epoch: 4, train_loss: 1.4490, train_clustering_loss:  0.1741, train_error: 0.5028
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6228239845261122, correct fine 322/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.17391304347826086, correct fine 20/115 
fine class 6: fine acc 0.8544152744630071, correct fine 716/838 
fine class 7: fine acc 0.05622489959839357, correct fine 14/249 
fine class 8: fine acc 0.0, correct fine 0/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.05303030303030303, correct fine 7/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4972

Val Set, val_loss: 1.4585, val_error: 0.5038, auc: 0.7606
class 0 clustering acc 0.9991883116883117: correct 29544/29568 
class 1 clustering acc 0.09422348484848485: correct 199/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.640625, correct fine 41/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.8365384615384616, correct fine 87/104 
fine class 7: fine acc 0.03333333333333333, correct fine 1/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1318

Training for fine level...
batch 100, loss: 1.8800, instance_loss: 0.2022, weighted_loss: 1.3767, label: 6, bag_size: 478
batch 200, loss: 0.2265, instance_loss: 0.0688, weighted_loss: 0.1792, label: 6, bag_size: 467
batch 300, loss: 1.5067, instance_loss: 0.1747, weighted_loss: 1.1071, label: 3, bag_size: 116
batch 400, loss: 0.6053, instance_loss: 0.1485, weighted_loss: 0.4682, label: 5, bag_size: 1380
batch 500, loss: 3.7836, instance_loss: 0.2547, weighted_loss: 2.7249, label: 10, bag_size: 527
batch 600, loss: 0.4546, instance_loss: 0.1022, weighted_loss: 0.3488, label: 3, bag_size: 1847
batch 700, loss: 0.1640, instance_loss: 0.0542, weighted_loss: 0.1311, label: 6, bag_size: 853
batch 800, loss: 2.3188, instance_loss: 0.2344, weighted_loss: 1.6935, label: 4, bag_size: 986
batch 900, loss: 0.7206, instance_loss: 0.1269, weighted_loss: 0.5425, label: 3, bag_size: 1523
batch 1000, loss: 0.4741, instance_loss: 0.0865, weighted_loss: 0.3578, label: 6, bag_size: 482
batch 1100, loss: 1.2932, instance_loss: 0.1637, weighted_loss: 0.9544, label: 6, bag_size: 235
batch 1200, loss: 0.5337, instance_loss: 0.0775, weighted_loss: 0.3969, label: 6, bag_size: 2663
batch 1300, loss: 3.7341, instance_loss: 0.3161, weighted_loss: 2.7087, label: 8, bag_size: 2158
batch 1400, loss: 2.2752, instance_loss: 0.2641, weighted_loss: 1.6719, label: 10, bag_size: 717
batch 1500, loss: 0.0707, instance_loss: 0.0542, weighted_loss: 0.0657, label: 6, bag_size: 360
batch 1600, loss: 1.8358, instance_loss: 0.2207, weighted_loss: 1.3513, label: 7, bag_size: 625
batch 1700, loss: 2.5792, instance_loss: 0.2252, weighted_loss: 1.8730, label: 7, bag_size: 285
batch 1800, loss: 0.0710, instance_loss: 0.0461, weighted_loss: 0.0635, label: 6, bag_size: 239
batch 1900, loss: 0.0546, instance_loss: 0.0495, weighted_loss: 0.0530, label: 6, bag_size: 629
batch 2000, loss: 0.6232, instance_loss: 0.1863, weighted_loss: 0.4921, label: 5, bag_size: 1204
batch 2100, loss: 1.2902, instance_loss: 0.2063, weighted_loss: 0.9651, label: 3, bag_size: 177

Instance Classifier Stats
class 0 clustering acc 0.9979303818301514: correct 242537/243040
class 1 clustering acc 0.12505760368663593: correct 2171/17360

Epoch: 5, train_loss: 1.4124, train_clustering_loss:  0.1715, train_error: 0.5028
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.586073500967118, correct fine 303/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.2608695652173913, correct fine 30/115 
fine class 6: fine acc 0.8627684964200477, correct fine 723/838 
fine class 7: fine acc 0.060240963855421686, correct fine 15/249 
fine class 8: fine acc 0.02247191011235955, correct fine 2/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.045454545454545456, correct fine 6/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.4972

Val Set, val_loss: 1.4397, val_error: 0.5000, auc: 0.7730
class 0 clustering acc 0.9984442640692641: correct 29522/29568 
class 1 clustering acc 0.14109848484848486: correct 298/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.65625, correct fine 42/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8461538461538461, correct fine 88/104 
fine class 7: fine acc 0.03333333333333333, correct fine 1/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5000
Overall F1 Score: 0.1244

Training for fine level...
batch 100, loss: 0.7746, instance_loss: 0.1019, weighted_loss: 0.5728, label: 6, bag_size: 1736
batch 200, loss: 2.5194, instance_loss: 0.2372, weighted_loss: 1.8347, label: 3, bag_size: 339
batch 300, loss: 3.4791, instance_loss: 0.2476, weighted_loss: 2.5097, label: 8, bag_size: 682
batch 400, loss: 0.1428, instance_loss: 0.0623, weighted_loss: 0.1186, label: 6, bag_size: 540
batch 500, loss: 2.1485, instance_loss: 0.2226, weighted_loss: 1.5707, label: 7, bag_size: 299
batch 600, loss: 2.4568, instance_loss: 0.2553, weighted_loss: 1.7964, label: 3, bag_size: 209
batch 700, loss: 0.0949, instance_loss: 0.0425, weighted_loss: 0.0792, label: 6, bag_size: 686
batch 800, loss: 1.5839, instance_loss: 0.2241, weighted_loss: 1.1760, label: 7, bag_size: 206
batch 900, loss: 0.9643, instance_loss: 0.1474, weighted_loss: 0.7192, label: 3, bag_size: 536
batch 1000, loss: 3.5366, instance_loss: 0.2862, weighted_loss: 2.5615, label: 8, bag_size: 166
batch 1100, loss: 2.3499, instance_loss: 0.2357, weighted_loss: 1.7157, label: 4, bag_size: 106
batch 1200, loss: 2.2815, instance_loss: 0.2619, weighted_loss: 1.6757, label: 7, bag_size: 132
batch 1300, loss: 1.3099, instance_loss: 0.1390, weighted_loss: 0.9586, label: 6, bag_size: 765
batch 1400, loss: 1.5480, instance_loss: 0.1716, weighted_loss: 1.1350, label: 3, bag_size: 405
batch 1500, loss: 0.5622, instance_loss: 0.0982, weighted_loss: 0.4230, label: 3, bag_size: 1771
batch 1600, loss: 1.3322, instance_loss: 0.2566, weighted_loss: 1.0095, label: 7, bag_size: 689
batch 1700, loss: 1.2826, instance_loss: 0.1442, weighted_loss: 0.9410, label: 6, bag_size: 352
batch 1800, loss: 1.5514, instance_loss: 0.2880, weighted_loss: 1.1724, label: 4, bag_size: 1404
batch 1900, loss: 0.7644, instance_loss: 0.0970, weighted_loss: 0.5642, label: 6, bag_size: 510
batch 2000, loss: 1.9980, instance_loss: 0.2154, weighted_loss: 1.4632, label: 7, bag_size: 268
batch 2100, loss: 0.8640, instance_loss: 0.1207, weighted_loss: 0.6410, label: 3, bag_size: 725

Instance Classifier Stats
class 0 clustering acc 0.9976423633969717: correct 242467/243040
class 1 clustering acc 0.1452188940092166: correct 2521/17360

Epoch: 6, train_loss: 1.3862, train_clustering_loss:  0.1689, train_error: 0.4848
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5996131528046421, correct fine 310/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.24347826086956523, correct fine 28/115 
fine class 6: fine acc 0.8818615751789977, correct fine 739/838 
fine class 7: fine acc 0.13654618473895583, correct fine 34/249 
fine class 8: fine acc 0.02247191011235955, correct fine 2/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.03787878787878788, correct fine 5/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5152

Val Set, val_loss: 1.4277, val_error: 0.4659, auc: 0.7771
class 0 clustering acc 0.9981737012987013: correct 29514/29568 
class 1 clustering acc 0.15577651515151514: correct 329/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9230769230769231, correct fine 96/104 
fine class 7: fine acc 0.16666666666666666, correct fine 5/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5341
Overall F1 Score: 0.1633

Training for fine level...
batch 100, loss: 0.1755, instance_loss: 0.0585, weighted_loss: 0.1404, label: 6, bag_size: 812
batch 200, loss: 0.3316, instance_loss: 0.0877, weighted_loss: 0.2584, label: 6, bag_size: 205
batch 300, loss: 2.0973, instance_loss: 0.2197, weighted_loss: 1.5341, label: 10, bag_size: 558
batch 400, loss: 1.1451, instance_loss: 0.2215, weighted_loss: 0.8680, label: 7, bag_size: 117
batch 500, loss: 1.3932, instance_loss: 0.2078, weighted_loss: 1.0376, label: 4, bag_size: 554
batch 600, loss: 1.5367, instance_loss: 0.1795, weighted_loss: 1.1296, label: 3, bag_size: 80
batch 700, loss: 0.6072, instance_loss: 0.1020, weighted_loss: 0.4557, label: 3, bag_size: 2523
batch 800, loss: 1.4787, instance_loss: 0.1069, weighted_loss: 1.0672, label: 6, bag_size: 746
batch 900, loss: 0.5790, instance_loss: 0.0960, weighted_loss: 0.4341, label: 6, bag_size: 396
batch 1000, loss: 0.9982, instance_loss: 0.1501, weighted_loss: 0.7438, label: 6, bag_size: 299
batch 1100, loss: 2.0723, instance_loss: 0.2502, weighted_loss: 1.5256, label: 8, bag_size: 658
batch 1200, loss: 1.2811, instance_loss: 0.2389, weighted_loss: 0.9685, label: 7, bag_size: 404
batch 1300, loss: 0.6311, instance_loss: 0.1997, weighted_loss: 0.5017, label: 5, bag_size: 542
batch 1400, loss: 0.3275, instance_loss: 0.0828, weighted_loss: 0.2541, label: 6, bag_size: 860
batch 1500, loss: 0.0862, instance_loss: 0.0399, weighted_loss: 0.0723, label: 6, bag_size: 437
batch 1600, loss: 1.4564, instance_loss: 0.2015, weighted_loss: 1.0799, label: 3, bag_size: 168
batch 1700, loss: 0.2377, instance_loss: 0.0603, weighted_loss: 0.1845, label: 6, bag_size: 665
batch 1800, loss: 0.0229, instance_loss: 0.0360, weighted_loss: 0.0268, label: 6, bag_size: 699
batch 1900, loss: 1.5996, instance_loss: 0.2292, weighted_loss: 1.1884, label: 5, bag_size: 183
batch 2000, loss: 2.0058, instance_loss: 0.2044, weighted_loss: 1.4654, label: 7, bag_size: 1836
batch 2100, loss: 0.3052, instance_loss: 0.1035, weighted_loss: 0.2447, label: 3, bag_size: 619

Instance Classifier Stats
class 0 clustering acc 0.9974860105332456: correct 242429/243040
class 1 clustering acc 0.1487327188940092: correct 2582/17360

Epoch: 7, train_loss: 1.3690, train_clustering_loss:  0.1681, train_error: 0.4802
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5822050290135397, correct fine 301/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.2782608695652174, correct fine 32/115 
fine class 6: fine acc 0.8866348448687351, correct fine 743/838 
fine class 7: fine acc 0.17269076305220885, correct fine 43/249 
fine class 8: fine acc 0.0449438202247191, correct fine 4/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.03787878787878788, correct fine 5/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5198

Val Set, val_loss: 1.4162, val_error: 0.4886, auc: 0.7834
class 0 clustering acc 0.9979707792207793: correct 29508/29568 
class 1 clustering acc 0.16287878787878787: correct 344/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.65625, correct fine 42/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.8461538461538461, correct fine 88/104 
fine class 7: fine acc 0.1, correct fine 3/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1446

Training for fine level...
batch 100, loss: 0.6426, instance_loss: 0.0945, weighted_loss: 0.4782, label: 6, bag_size: 511
batch 200, loss: 0.5882, instance_loss: 0.1322, weighted_loss: 0.4514, label: 6, bag_size: 1222
batch 300, loss: 0.7457, instance_loss: 0.0971, weighted_loss: 0.5511, label: 6, bag_size: 358
batch 400, loss: 0.4764, instance_loss: 0.1002, weighted_loss: 0.3635, label: 3, bag_size: 2047
batch 500, loss: 1.8621, instance_loss: 0.1911, weighted_loss: 1.3608, label: 3, bag_size: 393
batch 600, loss: 1.9243, instance_loss: 0.2035, weighted_loss: 1.4080, label: 3, bag_size: 983
batch 700, loss: 2.5619, instance_loss: 0.2443, weighted_loss: 1.8666, label: 10, bag_size: 876
batch 800, loss: 0.3673, instance_loss: 0.0844, weighted_loss: 0.2825, label: 3, bag_size: 1476
batch 900, loss: 1.9180, instance_loss: 0.2286, weighted_loss: 1.4112, label: 7, bag_size: 274
batch 1000, loss: 1.6519, instance_loss: 0.2155, weighted_loss: 1.2209, label: 10, bag_size: 313
batch 1100, loss: 0.9882, instance_loss: 0.1571, weighted_loss: 0.7389, label: 3, bag_size: 238
batch 1200, loss: 2.3438, instance_loss: 0.2406, weighted_loss: 1.7129, label: 8, bag_size: 417
batch 1300, loss: 0.4474, instance_loss: 0.0823, weighted_loss: 0.3379, label: 6, bag_size: 310
batch 1400, loss: 1.3636, instance_loss: 0.1536, weighted_loss: 1.0006, label: 6, bag_size: 95
batch 1500, loss: 1.2931, instance_loss: 0.2180, weighted_loss: 0.9706, label: 3, bag_size: 142
batch 1600, loss: 0.1827, instance_loss: 0.0562, weighted_loss: 0.1447, label: 6, bag_size: 467
batch 1700, loss: 0.6663, instance_loss: 0.2254, weighted_loss: 0.5341, label: 7, bag_size: 787
batch 1800, loss: 2.0064, instance_loss: 0.2153, weighted_loss: 1.4691, label: 10, bag_size: 371
batch 1900, loss: 0.0701, instance_loss: 0.0514, weighted_loss: 0.0645, label: 6, bag_size: 332
batch 2000, loss: 2.0265, instance_loss: 0.2049, weighted_loss: 1.4800, label: 3, bag_size: 237
batch 2100, loss: 0.8814, instance_loss: 0.1712, weighted_loss: 0.6683, label: 3, bag_size: 135

Instance Classifier Stats
class 0 clustering acc 0.9973131994733377: correct 242387/243040
class 1 clustering acc 0.15892857142857142: correct 2759/17360

Epoch: 8, train_loss: 1.3498, train_clustering_loss:  0.1668, train_error: 0.4811
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5764023210831721, correct fine 298/517 
fine class 4: fine acc 0.006666666666666667, correct fine 1/150 
fine class 5: fine acc 0.24347826086956523, correct fine 28/115 
fine class 6: fine acc 0.8854415274463007, correct fine 742/838 
fine class 7: fine acc 0.1927710843373494, correct fine 48/249 
fine class 8: fine acc 0.0449438202247191, correct fine 4/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.03787878787878788, correct fine 5/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5189

Val Set, val_loss: 1.4042, val_error: 0.4735, auc: 0.7848
class 0 clustering acc 0.9973958333333334: correct 29491/29568 
class 1 clustering acc 0.17518939393939395: correct 370/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9134615384615384, correct fine 95/104 
fine class 7: fine acc 0.1, correct fine 3/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1549

Training for fine level...
batch 100, loss: 0.1806, instance_loss: 0.0878, weighted_loss: 0.1528, label: 6, bag_size: 324
batch 200, loss: 0.1318, instance_loss: 0.0417, weighted_loss: 0.1048, label: 6, bag_size: 796
batch 300, loss: 1.2717, instance_loss: 0.1625, weighted_loss: 0.9389, label: 6, bag_size: 121
batch 400, loss: 1.6271, instance_loss: 0.1838, weighted_loss: 1.1942, label: 3, bag_size: 411
batch 500, loss: 0.0271, instance_loss: 0.0348, weighted_loss: 0.0294, label: 6, bag_size: 381
batch 600, loss: 0.3087, instance_loss: 0.1606, weighted_loss: 0.2643, label: 5, bag_size: 1204
batch 700, loss: 2.2556, instance_loss: 0.2353, weighted_loss: 1.6495, label: 3, bag_size: 165
batch 800, loss: 2.8493, instance_loss: 0.2552, weighted_loss: 2.0710, label: 5, bag_size: 295
batch 900, loss: 1.5761, instance_loss: 0.1436, weighted_loss: 1.1464, label: 6, bag_size: 153
batch 1000, loss: 1.8616, instance_loss: 0.2352, weighted_loss: 1.3737, label: 10, bag_size: 563
batch 1100, loss: 1.5124, instance_loss: 0.1767, weighted_loss: 1.1117, label: 6, bag_size: 309
batch 1200, loss: 3.4008, instance_loss: 0.2599, weighted_loss: 2.4585, label: 4, bag_size: 233
batch 1300, loss: 0.7171, instance_loss: 0.0833, weighted_loss: 0.5270, label: 6, bag_size: 703
batch 1400, loss: 1.0851, instance_loss: 0.1120, weighted_loss: 0.7931, label: 6, bag_size: 465
batch 1500, loss: 2.4548, instance_loss: 0.2321, weighted_loss: 1.7880, label: 4, bag_size: 510
batch 1600, loss: 4.0591, instance_loss: 0.2927, weighted_loss: 2.9292, label: 13, bag_size: 174
batch 1700, loss: 0.8871, instance_loss: 0.1369, weighted_loss: 0.6620, label: 6, bag_size: 569
batch 1800, loss: 0.5231, instance_loss: 0.1146, weighted_loss: 0.4005, label: 6, bag_size: 1736
batch 1900, loss: 1.7202, instance_loss: 0.1732, weighted_loss: 1.2561, label: 3, bag_size: 405
batch 2000, loss: 1.3391, instance_loss: 0.1782, weighted_loss: 0.9908, label: 6, bag_size: 596
batch 2100, loss: 1.8723, instance_loss: 0.2174, weighted_loss: 1.3758, label: 3, bag_size: 508

Instance Classifier Stats
class 0 clustering acc 0.9973214285714286: correct 242389/243040
class 1 clustering acc 0.16388248847926268: correct 2845/17360

Epoch: 9, train_loss: 1.3346, train_clustering_loss:  0.1659, train_error: 0.4700
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.0, correct fine 0/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5880077369439072, correct fine 304/517 
fine class 4: fine acc 0.0, correct fine 0/150 
fine class 5: fine acc 0.26956521739130435, correct fine 31/115 
fine class 6: fine acc 0.8842482100238663, correct fine 741/838 
fine class 7: fine acc 0.24497991967871485, correct fine 61/249 
fine class 8: fine acc 0.06741573033707865, correct fine 6/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.05303030303030303, correct fine 7/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5300

Val Set, val_loss: 1.3938, val_error: 0.4659, auc: 0.7849
class 0 clustering acc 0.9977002164502164: correct 29500/29568 
class 1 clustering acc 0.171875: correct 363/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9134615384615384, correct fine 95/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5341
Overall F1 Score: 0.1654

Training for fine level...
batch 100, loss: 1.1973, instance_loss: 0.2053, weighted_loss: 0.8997, label: 3, bag_size: 421
batch 200, loss: 1.7243, instance_loss: 0.1996, weighted_loss: 1.2669, label: 5, bag_size: 904
batch 300, loss: 0.9667, instance_loss: 0.1496, weighted_loss: 0.7215, label: 3, bag_size: 1205
batch 400, loss: 1.9584, instance_loss: 0.2392, weighted_loss: 1.4426, label: 4, bag_size: 1138
batch 500, loss: 1.8272, instance_loss: 0.2309, weighted_loss: 1.3483, label: 10, bag_size: 340
batch 600, loss: 1.9900, instance_loss: 0.1870, weighted_loss: 1.4491, label: 6, bag_size: 1863
batch 700, loss: 2.0074, instance_loss: 0.1889, weighted_loss: 1.4619, label: 7, bag_size: 1339
batch 800, loss: 0.2672, instance_loss: 0.0554, weighted_loss: 0.2037, label: 6, bag_size: 812
batch 900, loss: 2.0508, instance_loss: 0.2357, weighted_loss: 1.5063, label: 7, bag_size: 280
batch 1000, loss: 0.1214, instance_loss: 0.0417, weighted_loss: 0.0975, label: 6, bag_size: 238
batch 1100, loss: 0.6928, instance_loss: 0.1258, weighted_loss: 0.5227, label: 3, bag_size: 1659
batch 1200, loss: 0.3291, instance_loss: 0.1065, weighted_loss: 0.2623, label: 3, bag_size: 958
batch 1300, loss: 0.1819, instance_loss: 0.0481, weighted_loss: 0.1418, label: 6, bag_size: 1304
batch 1400, loss: 0.2427, instance_loss: 0.0692, weighted_loss: 0.1906, label: 6, bag_size: 498
batch 1500, loss: 0.7928, instance_loss: 0.1492, weighted_loss: 0.5997, label: 5, bag_size: 454
batch 1600, loss: 2.4911, instance_loss: 0.2478, weighted_loss: 1.8181, label: 10, bag_size: 105
batch 1700, loss: 0.7231, instance_loss: 0.1008, weighted_loss: 0.5364, label: 6, bag_size: 833
batch 1800, loss: 2.5567, instance_loss: 0.2658, weighted_loss: 1.8694, label: 4, bag_size: 1185
batch 1900, loss: 0.0639, instance_loss: 0.0364, weighted_loss: 0.0556, label: 6, bag_size: 1005
batch 2000, loss: 1.1816, instance_loss: 0.2286, weighted_loss: 0.8957, label: 7, bag_size: 701
batch 2100, loss: 1.8778, instance_loss: 0.2264, weighted_loss: 1.3824, label: 10, bag_size: 210

Instance Classifier Stats
class 0 clustering acc 0.9973173140223831: correct 242388/243040
class 1 clustering acc 0.1672811059907834: correct 2904/17360

Epoch: 10, train_loss: 1.3193, train_clustering_loss:  0.1649, train_error: 0.4673
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5705996131528046, correct fine 295/517 
fine class 4: fine acc 0.02666666666666667, correct fine 4/150 
fine class 5: fine acc 0.26956521739130435, correct fine 31/115 
fine class 6: fine acc 0.89618138424821, correct fine 751/838 
fine class 7: fine acc 0.23293172690763053, correct fine 58/249 
fine class 8: fine acc 0.0898876404494382, correct fine 8/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.06060606060606061, correct fine 8/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5327

Val Set, val_loss: 1.4078, val_error: 0.4886, auc: 0.7813
class 0 clustering acc 0.9979707792207793: correct 29508/29568 
class 1 clustering acc 0.15956439393939395: correct 337/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8461538461538461, correct fine 88/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1714

Training for fine level...
batch 100, loss: 1.4158, instance_loss: 0.1964, weighted_loss: 1.0500, label: 6, bag_size: 452
batch 200, loss: 1.3748, instance_loss: 0.2127, weighted_loss: 1.0261, label: 3, bag_size: 505
batch 300, loss: 1.1728, instance_loss: 0.2200, weighted_loss: 0.8870, label: 7, bag_size: 2443
batch 400, loss: 0.7362, instance_loss: 0.1118, weighted_loss: 0.5488, label: 6, bag_size: 494
batch 500, loss: 0.5227, instance_loss: 0.0970, weighted_loss: 0.3950, label: 3, bag_size: 418
batch 600, loss: 0.3165, instance_loss: 0.1501, weighted_loss: 0.2665, label: 5, bag_size: 714
batch 700, loss: 0.1038, instance_loss: 0.0440, weighted_loss: 0.0859, label: 6, bag_size: 624
batch 800, loss: 0.7959, instance_loss: 0.1388, weighted_loss: 0.5988, label: 3, bag_size: 2154
batch 900, loss: 1.2554, instance_loss: 0.2295, weighted_loss: 0.9476, label: 7, bag_size: 334
batch 1000, loss: 2.0540, instance_loss: 0.1894, weighted_loss: 1.4947, label: 6, bag_size: 280
batch 1100, loss: 1.3880, instance_loss: 0.2014, weighted_loss: 1.0320, label: 7, bag_size: 411
batch 1200, loss: 0.9884, instance_loss: 0.2240, weighted_loss: 0.7591, label: 7, bag_size: 346
batch 1300, loss: 2.9867, instance_loss: 0.1989, weighted_loss: 2.1504, label: 6, bag_size: 1830
batch 1400, loss: 0.0402, instance_loss: 0.0302, weighted_loss: 0.0372, label: 6, bag_size: 728
batch 1500, loss: 0.5771, instance_loss: 0.1162, weighted_loss: 0.4388, label: 3, bag_size: 2658
batch 1600, loss: 0.0764, instance_loss: 0.0434, weighted_loss: 0.0665, label: 6, bag_size: 596
batch 1700, loss: 1.3990, instance_loss: 0.1663, weighted_loss: 1.0292, label: 6, bag_size: 627
batch 1800, loss: 1.8335, instance_loss: 0.2293, weighted_loss: 1.3522, label: 7, bag_size: 523
batch 1900, loss: 0.2546, instance_loss: 0.0631, weighted_loss: 0.1972, label: 6, bag_size: 1062
batch 2000, loss: 1.5681, instance_loss: 0.2238, weighted_loss: 1.1648, label: 8, bag_size: 888
batch 2100, loss: 1.4588, instance_loss: 0.1564, weighted_loss: 1.0681, label: 3, bag_size: 298

Instance Classifier Stats
class 0 clustering acc 0.9973337722185649: correct 242392/243040
class 1 clustering acc 0.16993087557603687: correct 2950/17360

Epoch: 11, train_loss: 1.3069, train_clustering_loss:  0.1643, train_error: 0.4654
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5783365570599613, correct fine 299/517 
fine class 4: fine acc 0.03333333333333333, correct fine 5/150 
fine class 5: fine acc 0.2956521739130435, correct fine 34/115 
fine class 6: fine acc 0.8794749403341289, correct fine 737/838 
fine class 7: fine acc 0.26506024096385544, correct fine 66/249 
fine class 8: fine acc 0.056179775280898875, correct fine 5/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.09848484848484848, correct fine 13/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5346

Val Set, val_loss: 1.4102, val_error: 0.4811, auc: 0.7829
class 0 clustering acc 0.9976325757575758: correct 29498/29568 
class 1 clustering acc 0.17708333333333334: correct 374/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.671875, correct fine 43/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8269230769230769, correct fine 86/104 
fine class 7: fine acc 0.16666666666666666, correct fine 5/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5189
Overall F1 Score: 0.1694

Training for fine level...
batch 100, loss: 0.1541, instance_loss: 0.0505, weighted_loss: 0.1230, label: 6, bag_size: 475
batch 200, loss: 0.7951, instance_loss: 0.1101, weighted_loss: 0.5896, label: 6, bag_size: 465
batch 300, loss: 1.0221, instance_loss: 0.1394, weighted_loss: 0.7573, label: 6, bag_size: 106
batch 400, loss: 2.2963, instance_loss: 0.2079, weighted_loss: 1.6698, label: 10, bag_size: 531
batch 500, loss: 3.1168, instance_loss: 0.2215, weighted_loss: 2.2482, label: 5, bag_size: 201
batch 600, loss: 0.1005, instance_loss: 0.0344, weighted_loss: 0.0806, label: 6, bag_size: 467
batch 700, loss: 0.8637, instance_loss: 0.1606, weighted_loss: 0.6527, label: 6, bag_size: 125
batch 800, loss: 0.0288, instance_loss: 0.0239, weighted_loss: 0.0273, label: 6, bag_size: 255
batch 900, loss: 1.2256, instance_loss: 0.2059, weighted_loss: 0.9197, label: 4, bag_size: 554
batch 1000, loss: 0.8958, instance_loss: 0.1129, weighted_loss: 0.6609, label: 6, bag_size: 284
batch 1100, loss: 1.9643, instance_loss: 0.2159, weighted_loss: 1.4397, label: 10, bag_size: 430
batch 1200, loss: 0.0656, instance_loss: 0.0348, weighted_loss: 0.0563, label: 6, bag_size: 743
batch 1300, loss: 2.2668, instance_loss: 0.2632, weighted_loss: 1.6657, label: 7, bag_size: 565
batch 1400, loss: 1.5958, instance_loss: 0.1891, weighted_loss: 1.1738, label: 3, bag_size: 353
batch 1500, loss: 1.5446, instance_loss: 0.1836, weighted_loss: 1.1363, label: 3, bag_size: 119
batch 1600, loss: 1.4260, instance_loss: 0.1892, weighted_loss: 1.0549, label: 3, bag_size: 228
batch 1700, loss: 0.8464, instance_loss: 0.1196, weighted_loss: 0.6283, label: 6, bag_size: 232
batch 1800, loss: 1.2142, instance_loss: 0.1155, weighted_loss: 0.8846, label: 6, bag_size: 532
batch 1900, loss: 1.0106, instance_loss: 0.1746, weighted_loss: 0.7598, label: 6, bag_size: 548
batch 2000, loss: 0.6372, instance_loss: 0.1326, weighted_loss: 0.4858, label: 6, bag_size: 180
batch 2100, loss: 4.3315, instance_loss: 0.2959, weighted_loss: 3.1208, label: 10, bag_size: 233

Instance Classifier Stats
class 0 clustering acc 0.9973049703752469: correct 242385/243040
class 1 clustering acc 0.17263824884792628: correct 2997/17360

Epoch: 12, train_loss: 1.2932, train_clustering_loss:  0.1637, train_error: 0.4507
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6150870406189555, correct fine 318/517 
fine class 4: fine acc 0.04666666666666667, correct fine 7/150 
fine class 5: fine acc 0.3217391304347826, correct fine 37/115 
fine class 6: fine acc 0.8937947494033412, correct fine 749/838 
fine class 7: fine acc 0.24096385542168675, correct fine 60/249 
fine class 8: fine acc 0.10112359550561797, correct fine 9/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.08333333333333333, correct fine 11/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5493

Val Set, val_loss: 1.3996, val_error: 0.4659, auc: 0.7833
class 0 clustering acc 0.9974296536796536: correct 29492/29568 
class 1 clustering acc 0.18039772727272727: correct 381/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9038461538461539, correct fine 94/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5341
Overall F1 Score: 0.1703

Training for fine level...
batch 100, loss: 0.4073, instance_loss: 0.0754, weighted_loss: 0.3077, label: 6, bag_size: 324
batch 200, loss: 2.0283, instance_loss: 0.2414, weighted_loss: 1.4922, label: 8, bag_size: 618
batch 300, loss: 1.0589, instance_loss: 0.1461, weighted_loss: 0.7851, label: 6, bag_size: 373
batch 400, loss: 0.4586, instance_loss: 0.0864, weighted_loss: 0.3469, label: 3, bag_size: 983
batch 500, loss: 0.9414, instance_loss: 0.2327, weighted_loss: 0.7288, label: 7, bag_size: 570
batch 600, loss: 0.7343, instance_loss: 0.1296, weighted_loss: 0.5529, label: 6, bag_size: 129
batch 700, loss: 0.8984, instance_loss: 0.1344, weighted_loss: 0.6692, label: 3, bag_size: 848
batch 800, loss: 0.5338, instance_loss: 0.1751, weighted_loss: 0.4262, label: 7, bag_size: 843
batch 900, loss: 1.7391, instance_loss: 0.1820, weighted_loss: 1.2720, label: 3, bag_size: 529
batch 1000, loss: 1.7032, instance_loss: 0.2113, weighted_loss: 1.2556, label: 3, bag_size: 475
batch 1100, loss: 0.1180, instance_loss: 0.0429, weighted_loss: 0.0955, label: 6, bag_size: 1113
batch 1200, loss: 0.1765, instance_loss: 0.0689, weighted_loss: 0.1442, label: 6, bag_size: 390
batch 1300, loss: 0.0232, instance_loss: 0.0307, weighted_loss: 0.0254, label: 6, bag_size: 1044
batch 1400, loss: 0.7021, instance_loss: 0.1553, weighted_loss: 0.5380, label: 5, bag_size: 542
batch 1500, loss: 2.2850, instance_loss: 0.2271, weighted_loss: 1.6677, label: 10, bag_size: 371
batch 1600, loss: 0.0779, instance_loss: 0.0297, weighted_loss: 0.0635, label: 6, bag_size: 495
batch 1700, loss: 0.2208, instance_loss: 0.0372, weighted_loss: 0.1657, label: 6, bag_size: 859
batch 1800, loss: 0.7314, instance_loss: 0.1106, weighted_loss: 0.5451, label: 6, bag_size: 223
batch 1900, loss: 0.0570, instance_loss: 0.0297, weighted_loss: 0.0488, label: 6, bag_size: 779
batch 2000, loss: 1.1055, instance_loss: 0.0961, weighted_loss: 0.8027, label: 6, bag_size: 585
batch 2100, loss: 1.0106, instance_loss: 0.1636, weighted_loss: 0.7565, label: 6, bag_size: 194

Instance Classifier Stats
class 0 clustering acc 0.9972185648452929: correct 242364/243040
class 1 clustering acc 0.17304147465437789: correct 3004/17360

Epoch: 13, train_loss: 1.2786, train_clustering_loss:  0.1629, train_error: 0.4475
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.03125, correct fine 1/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6150870406189555, correct fine 318/517 
fine class 4: fine acc 0.06, correct fine 9/150 
fine class 5: fine acc 0.33043478260869563, correct fine 38/115 
fine class 6: fine acc 0.883054892601432, correct fine 740/838 
fine class 7: fine acc 0.27309236947791166, correct fine 68/249 
fine class 8: fine acc 0.10112359550561797, correct fine 9/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.12121212121212122, correct fine 16/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5525

Val Set, val_loss: 1.4006, val_error: 0.4508, auc: 0.7808
class 0 clustering acc 0.9981737012987013: correct 29514/29568 
class 1 clustering acc 0.15956439393939395: correct 337/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9134615384615384, correct fine 95/104 
fine class 7: fine acc 0.3, correct fine 9/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5492
Overall F1 Score: 0.1943

Training for fine level...
batch 100, loss: 0.7906, instance_loss: 0.1180, weighted_loss: 0.5888, label: 3, bag_size: 174
batch 200, loss: 1.2441, instance_loss: 0.1754, weighted_loss: 0.9235, label: 5, bag_size: 1400
batch 300, loss: 0.1734, instance_loss: 0.0564, weighted_loss: 0.1383, label: 6, bag_size: 475
batch 400, loss: 1.5819, instance_loss: 0.2035, weighted_loss: 1.1684, label: 3, bag_size: 271
batch 500, loss: 0.9256, instance_loss: 0.1318, weighted_loss: 0.6875, label: 6, bag_size: 644
batch 600, loss: 1.1568, instance_loss: 0.1797, weighted_loss: 0.8637, label: 10, bag_size: 249
batch 700, loss: 0.9764, instance_loss: 0.1496, weighted_loss: 0.7284, label: 6, bag_size: 258
batch 800, loss: 1.3358, instance_loss: 0.2137, weighted_loss: 0.9992, label: 10, bag_size: 478
batch 900, loss: 1.0939, instance_loss: 0.1747, weighted_loss: 0.8182, label: 3, bag_size: 565
batch 1000, loss: 0.8718, instance_loss: 0.1718, weighted_loss: 0.6618, label: 6, bag_size: 578
batch 1100, loss: 1.6115, instance_loss: 0.2104, weighted_loss: 1.1912, label: 7, bag_size: 248
batch 1200, loss: 1.3636, instance_loss: 0.1352, weighted_loss: 0.9951, label: 6, bag_size: 464
batch 1300, loss: 0.1994, instance_loss: 0.0839, weighted_loss: 0.1647, label: 6, bag_size: 433
batch 1400, loss: 0.2417, instance_loss: 0.0744, weighted_loss: 0.1915, label: 6, bag_size: 310
batch 1500, loss: 0.6069, instance_loss: 0.2369, weighted_loss: 0.4959, label: 7, bag_size: 1072
batch 1600, loss: 2.5928, instance_loss: 0.2849, weighted_loss: 1.9005, label: 8, bag_size: 1800
batch 1700, loss: 0.7860, instance_loss: 0.1349, weighted_loss: 0.5907, label: 6, bag_size: 344
batch 1800, loss: 0.4968, instance_loss: 0.1150, weighted_loss: 0.3823, label: 6, bag_size: 335
batch 1900, loss: 1.2115, instance_loss: 0.1588, weighted_loss: 0.8957, label: 6, bag_size: 378
batch 2000, loss: 1.2529, instance_loss: 0.2506, weighted_loss: 0.9522, label: 7, bag_size: 686
batch 2100, loss: 0.7930, instance_loss: 0.1397, weighted_loss: 0.5970, label: 6, bag_size: 309

Instance Classifier Stats
class 0 clustering acc 0.9973420013166557: correct 242394/243040
class 1 clustering acc 0.17551843317972352: correct 3047/17360

Epoch: 14, train_loss: 1.2631, train_clustering_loss:  0.1624, train_error: 0.4498
fine class 0: fine acc 0.0, correct fine 0/12 
fine class 1: fine acc 0.09375, correct fine 3/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5996131528046421, correct fine 310/517 
fine class 4: fine acc 0.04, correct fine 6/150 
fine class 5: fine acc 0.3217391304347826, correct fine 37/115 
fine class 6: fine acc 0.8782816229116945, correct fine 736/838 
fine class 7: fine acc 0.3092369477911647, correct fine 77/249 
fine class 8: fine acc 0.0898876404494382, correct fine 8/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.12878787878787878, correct fine 17/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5502

Val Set, val_loss: 1.4128, val_error: 0.4735, auc: 0.7765
class 0 clustering acc 0.9980045995670995: correct 29509/29568 
class 1 clustering acc 0.16098484848484848: correct 340/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8846153846153846, correct fine 92/104 
fine class 7: fine acc 0.16666666666666666, correct fine 5/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1788

Training for fine level...
batch 100, loss: 0.3602, instance_loss: 0.0688, weighted_loss: 0.2728, label: 6, bag_size: 1058
batch 200, loss: 1.6755, instance_loss: 0.2076, weighted_loss: 1.2352, label: 7, bag_size: 395
batch 300, loss: 0.6551, instance_loss: 0.1120, weighted_loss: 0.4922, label: 3, bag_size: 248
batch 400, loss: 0.5122, instance_loss: 0.1301, weighted_loss: 0.3976, label: 3, bag_size: 334
batch 500, loss: 2.0170, instance_loss: 0.2185, weighted_loss: 1.4774, label: 6, bag_size: 100
batch 600, loss: 0.0136, instance_loss: 0.0200, weighted_loss: 0.0155, label: 6, bag_size: 463
batch 700, loss: 1.6124, instance_loss: 0.2308, weighted_loss: 1.1980, label: 10, bag_size: 340
batch 800, loss: 0.6175, instance_loss: 0.0986, weighted_loss: 0.4618, label: 3, bag_size: 490
batch 900, loss: 0.7725, instance_loss: 0.1482, weighted_loss: 0.5852, label: 6, bag_size: 187
batch 1000, loss: 2.8118, instance_loss: 0.3703, weighted_loss: 2.0793, label: 7, bag_size: 1064
batch 1100, loss: 1.6512, instance_loss: 0.2102, weighted_loss: 1.2189, label: 3, bag_size: 2059
batch 1200, loss: 2.9806, instance_loss: 0.2951, weighted_loss: 2.1749, label: 5, bag_size: 621
batch 1300, loss: 0.2678, instance_loss: 0.1199, weighted_loss: 0.2235, label: 5, bag_size: 500
batch 1400, loss: 3.9647, instance_loss: 0.2761, weighted_loss: 2.8581, label: 8, bag_size: 682
batch 1500, loss: 0.3316, instance_loss: 0.1048, weighted_loss: 0.2635, label: 6, bag_size: 358
batch 1600, loss: 0.3334, instance_loss: 0.0778, weighted_loss: 0.2568, label: 3, bag_size: 2121
batch 1700, loss: 1.4087, instance_loss: 0.2006, weighted_loss: 1.0462, label: 7, bag_size: 276
batch 1800, loss: 1.8663, instance_loss: 0.1874, weighted_loss: 1.3626, label: 3, bag_size: 544
batch 1900, loss: 0.0513, instance_loss: 0.0240, weighted_loss: 0.0431, label: 6, bag_size: 711
batch 2000, loss: 2.0039, instance_loss: 0.2548, weighted_loss: 1.4792, label: 5, bag_size: 223
batch 2100, loss: 1.3169, instance_loss: 0.1694, weighted_loss: 0.9727, label: 3, bag_size: 1124

Instance Classifier Stats
class 0 clustering acc 0.9973131994733377: correct 242387/243040
class 1 clustering acc 0.17246543778801843: correct 2994/17360

Epoch: 15, train_loss: 1.2546, train_clustering_loss:  0.1622, train_error: 0.4410
fine class 0: fine acc 0.08333333333333333, correct fine 1/12 
fine class 1: fine acc 0.125, correct fine 4/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6112185686653772, correct fine 316/517 
fine class 4: fine acc 0.08666666666666667, correct fine 13/150 
fine class 5: fine acc 0.33043478260869563, correct fine 38/115 
fine class 6: fine acc 0.8782816229116945, correct fine 736/838 
fine class 7: fine acc 0.2971887550200803, correct fine 74/249 
fine class 8: fine acc 0.1797752808988764, correct fine 16/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.11363636363636363, correct fine 15/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5590

Val Set, val_loss: 1.4135, val_error: 0.4735, auc: 0.7761
class 0 clustering acc 0.9977340367965368: correct 29501/29568 
class 1 clustering acc 0.16714015151515152: correct 353/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8557692307692307, correct fine 89/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5265
Overall F1 Score: 0.1895

Training for fine level...
batch 100, loss: 1.4057, instance_loss: 0.1777, weighted_loss: 1.0373, label: 3, bag_size: 304
batch 200, loss: 2.4659, instance_loss: 0.2899, weighted_loss: 1.8131, label: 5, bag_size: 525
batch 300, loss: 4.3238, instance_loss: 0.3089, weighted_loss: 3.1193, label: 0, bag_size: 313
batch 400, loss: 0.3411, instance_loss: 0.0720, weighted_loss: 0.2604, label: 6, bag_size: 954
batch 500, loss: 1.1982, instance_loss: 0.1981, weighted_loss: 0.8981, label: 7, bag_size: 256
batch 600, loss: 0.6732, instance_loss: 0.1125, weighted_loss: 0.5050, label: 3, bag_size: 757
batch 700, loss: 0.0755, instance_loss: 0.0485, weighted_loss: 0.0674, label: 6, bag_size: 368
batch 800, loss: 0.8207, instance_loss: 0.1168, weighted_loss: 0.6095, label: 6, bag_size: 353
batch 900, loss: 1.2722, instance_loss: 0.1563, weighted_loss: 0.9374, label: 3, bag_size: 165
batch 1000, loss: 0.3389, instance_loss: 0.0740, weighted_loss: 0.2594, label: 6, bag_size: 341
batch 1100, loss: 2.4412, instance_loss: 0.2677, weighted_loss: 1.7891, label: 1, bag_size: 68
batch 1200, loss: 2.1161, instance_loss: 0.2379, weighted_loss: 1.5527, label: 4, bag_size: 106
batch 1300, loss: 5.6005, instance_loss: 0.3875, weighted_loss: 4.0366, label: 0, bag_size: 432
batch 1400, loss: 1.3208, instance_loss: 0.2025, weighted_loss: 0.9853, label: 3, bag_size: 399
batch 1500, loss: 0.7165, instance_loss: 0.1941, weighted_loss: 0.5598, label: 7, bag_size: 787
batch 1600, loss: 0.7630, instance_loss: 0.1085, weighted_loss: 0.5667, label: 3, bag_size: 1101
batch 1700, loss: 1.2891, instance_loss: 0.1723, weighted_loss: 0.9541, label: 6, bag_size: 431
batch 1800, loss: 0.6677, instance_loss: 0.0985, weighted_loss: 0.4969, label: 6, bag_size: 311
batch 1900, loss: 0.9226, instance_loss: 0.1388, weighted_loss: 0.6875, label: 3, bag_size: 858
batch 2000, loss: 2.9450, instance_loss: 0.2139, weighted_loss: 2.1256, label: 7, bag_size: 432
batch 2100, loss: 1.6638, instance_loss: 0.2210, weighted_loss: 1.2310, label: 8, bag_size: 590

Instance Classifier Stats
class 0 clustering acc 0.9973790322580646: correct 242403/243040
class 1 clustering acc 0.177073732718894: correct 3074/17360

Epoch: 16, train_loss: 1.2414, train_clustering_loss:  0.1615, train_error: 0.4387
fine class 0: fine acc 0.08333333333333333, correct fine 1/12 
fine class 1: fine acc 0.09375, correct fine 3/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.620889748549323, correct fine 321/517 
fine class 4: fine acc 0.08, correct fine 12/150 
fine class 5: fine acc 0.3652173913043478, correct fine 42/115 
fine class 6: fine acc 0.8770883054892601, correct fine 735/838 
fine class 7: fine acc 0.3092369477911647, correct fine 77/249 
fine class 8: fine acc 0.15730337078651685, correct fine 14/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.09848484848484848, correct fine 13/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5613

Val Set, val_loss: 1.4326, val_error: 0.4811, auc: 0.7798
class 0 clustering acc 0.9972943722943723: correct 29488/29568 
class 1 clustering acc 0.18039772727272727: correct 381/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8653846153846154, correct fine 90/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5189
Overall F1 Score: 0.1635

Training for fine level...
batch 100, loss: 2.3180, instance_loss: 0.2138, weighted_loss: 1.6867, label: 3, bag_size: 165
batch 200, loss: 0.0424, instance_loss: 0.0418, weighted_loss: 0.0423, label: 6, bag_size: 1044
batch 300, loss: 1.2791, instance_loss: 0.1720, weighted_loss: 0.9469, label: 3, bag_size: 531
batch 400, loss: 0.8537, instance_loss: 0.1544, weighted_loss: 0.6439, label: 7, bag_size: 362
batch 500, loss: 0.5650, instance_loss: 0.1249, weighted_loss: 0.4330, label: 6, bag_size: 337
batch 600, loss: 0.0199, instance_loss: 0.0147, weighted_loss: 0.0183, label: 6, bag_size: 455
batch 700, loss: 1.7503, instance_loss: 0.2984, weighted_loss: 1.3147, label: 7, bag_size: 278
batch 800, loss: 0.5343, instance_loss: 0.1081, weighted_loss: 0.4065, label: 3, bag_size: 198
batch 900, loss: 0.3735, instance_loss: 0.0991, weighted_loss: 0.2911, label: 6, bag_size: 310
batch 1000, loss: 0.5963, instance_loss: 0.1331, weighted_loss: 0.4573, label: 3, bag_size: 84
batch 1100, loss: 2.2001, instance_loss: 0.2202, weighted_loss: 1.6061, label: 3, bag_size: 123
batch 1200, loss: 4.1612, instance_loss: 0.3287, weighted_loss: 3.0114, label: 11, bag_size: 205
batch 1300, loss: 0.7783, instance_loss: 0.1345, weighted_loss: 0.5852, label: 6, bag_size: 363
batch 1400, loss: 0.9869, instance_loss: 0.1301, weighted_loss: 0.7298, label: 6, bag_size: 284
batch 1500, loss: 0.8550, instance_loss: 0.1474, weighted_loss: 0.6427, label: 6, bag_size: 275
batch 1600, loss: 1.4171, instance_loss: 0.2190, weighted_loss: 1.0577, label: 7, bag_size: 488
batch 1700, loss: 0.9180, instance_loss: 0.1342, weighted_loss: 0.6829, label: 3, bag_size: 193
batch 1800, loss: 1.7674, instance_loss: 0.2024, weighted_loss: 1.2979, label: 3, bag_size: 260
batch 1900, loss: 0.0730, instance_loss: 0.0370, weighted_loss: 0.0622, label: 6, bag_size: 353
batch 2000, loss: 1.2638, instance_loss: 0.2165, weighted_loss: 0.9496, label: 4, bag_size: 362
batch 2100, loss: 0.8888, instance_loss: 0.1349, weighted_loss: 0.6626, label: 3, bag_size: 252

Instance Classifier Stats
class 0 clustering acc 0.9973749177090191: correct 242402/243040
class 1 clustering acc 0.17644009216589862: correct 3063/17360

Epoch: 17, train_loss: 1.2293, train_clustering_loss:  0.1615, train_error: 0.4281
fine class 0: fine acc 0.16666666666666666, correct fine 2/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6441005802707931, correct fine 333/517 
fine class 4: fine acc 0.08, correct fine 12/150 
fine class 5: fine acc 0.34782608695652173, correct fine 40/115 
fine class 6: fine acc 0.8806682577565632, correct fine 738/838 
fine class 7: fine acc 0.3132530120481928, correct fine 78/249 
fine class 8: fine acc 0.19101123595505617, correct fine 17/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.12121212121212122, correct fine 16/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5719

Val Set, val_loss: 1.4325, val_error: 0.4848, auc: 0.7776
class 0 clustering acc 0.9970914502164502: correct 29482/29568 
class 1 clustering acc 0.18513257575757575: correct 391/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8846153846153846, correct fine 92/104 
fine class 7: fine acc 0.16666666666666666, correct fine 5/30 
fine class 8: fine acc 0.0, correct fine 0/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1424

Training for fine level...
batch 100, loss: 2.1670, instance_loss: 0.2664, weighted_loss: 1.5968, label: 7, bag_size: 424
batch 200, loss: 0.2364, instance_loss: 0.0980, weighted_loss: 0.1949, label: 3, bag_size: 1771
batch 300, loss: 0.9106, instance_loss: 0.1491, weighted_loss: 0.6822, label: 3, bag_size: 1174
batch 400, loss: 3.3822, instance_loss: 0.2752, weighted_loss: 2.4501, label: 10, bag_size: 233
batch 500, loss: 1.0548, instance_loss: 0.1705, weighted_loss: 0.7895, label: 3, bag_size: 641
batch 600, loss: 0.0066, instance_loss: 0.0113, weighted_loss: 0.0080, label: 6, bag_size: 210
batch 700, loss: 1.8937, instance_loss: 0.2281, weighted_loss: 1.3940, label: 8, bag_size: 258
batch 800, loss: 0.0157, instance_loss: 0.0234, weighted_loss: 0.0180, label: 6, bag_size: 228
batch 900, loss: 2.8670, instance_loss: 0.2737, weighted_loss: 2.0890, label: 8, bag_size: 166
batch 1000, loss: 3.0116, instance_loss: 0.2882, weighted_loss: 2.1946, label: 5, bag_size: 1061
batch 1100, loss: 1.3892, instance_loss: 0.1586, weighted_loss: 1.0200, label: 6, bag_size: 359
batch 1200, loss: 1.6541, instance_loss: 0.2101, weighted_loss: 1.2209, label: 4, bag_size: 202
batch 1300, loss: 0.5290, instance_loss: 0.1305, weighted_loss: 0.4094, label: 5, bag_size: 1079
batch 1400, loss: 0.8745, instance_loss: 0.1151, weighted_loss: 0.6467, label: 6, bag_size: 156
batch 1500, loss: 1.8722, instance_loss: 0.2619, weighted_loss: 1.3891, label: 7, bag_size: 600
batch 1600, loss: 0.9794, instance_loss: 0.1990, weighted_loss: 0.7453, label: 8, bag_size: 354
batch 1700, loss: 0.5783, instance_loss: 0.1888, weighted_loss: 0.4615, label: 3, bag_size: 265
batch 1800, loss: 0.8243, instance_loss: 0.1474, weighted_loss: 0.6212, label: 8, bag_size: 163
batch 1900, loss: 1.3305, instance_loss: 0.1555, weighted_loss: 0.9780, label: 6, bag_size: 148
batch 2000, loss: 0.6008, instance_loss: 0.1199, weighted_loss: 0.4566, label: 6, bag_size: 653
batch 2100, loss: 1.1527, instance_loss: 0.1338, weighted_loss: 0.8471, label: 6, bag_size: 317

Instance Classifier Stats
class 0 clustering acc 0.9973214285714286: correct 242389/243040
class 1 clustering acc 0.18317972350230416: correct 3180/17360

Epoch: 18, train_loss: 1.2140, train_clustering_loss:  0.1605, train_error: 0.4281
fine class 0: fine acc 0.25, correct fine 3/12 
fine class 1: fine acc 0.125, correct fine 4/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6421663442940039, correct fine 332/517 
fine class 4: fine acc 0.11333333333333333, correct fine 17/150 
fine class 5: fine acc 0.34782608695652173, correct fine 40/115 
fine class 6: fine acc 0.8794749403341289, correct fine 737/838 
fine class 7: fine acc 0.3092369477911647, correct fine 77/249 
fine class 8: fine acc 0.16853932584269662, correct fine 15/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.12121212121212122, correct fine 16/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5719

Val Set, val_loss: 1.4330, val_error: 0.4697, auc: 0.7787
class 0 clustering acc 0.9974296536796536: correct 29492/29568 
class 1 clustering acc 0.17850378787878787: correct 377/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.453125, correct fine 29/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9230769230769231, correct fine 96/104 
fine class 7: fine acc 0.3333333333333333, correct fine 10/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5303
Overall F1 Score: 0.1961

Training for fine level...
batch 100, loss: 0.8928, instance_loss: 0.1388, weighted_loss: 0.6666, label: 3, bag_size: 1897
batch 200, loss: 1.3609, instance_loss: 0.1957, weighted_loss: 1.0114, label: 3, bag_size: 421
batch 300, loss: 1.6869, instance_loss: 0.2292, weighted_loss: 1.2495, label: 7, bag_size: 325
batch 400, loss: 0.7211, instance_loss: 0.1004, weighted_loss: 0.5349, label: 6, bag_size: 546
batch 500, loss: 0.0309, instance_loss: 0.0307, weighted_loss: 0.0308, label: 6, bag_size: 506
batch 600, loss: 0.5320, instance_loss: 0.1613, weighted_loss: 0.4208, label: 3, bag_size: 1516
batch 700, loss: 0.1563, instance_loss: 0.0460, weighted_loss: 0.1232, label: 6, bag_size: 1081
batch 800, loss: 3.7051, instance_loss: 0.2337, weighted_loss: 2.6637, label: 6, bag_size: 150
batch 900, loss: 0.5479, instance_loss: 0.1111, weighted_loss: 0.4169, label: 6, bag_size: 369
batch 1000, loss: 0.5598, instance_loss: 0.1476, weighted_loss: 0.4361, label: 3, bag_size: 898
batch 1100, loss: 1.6444, instance_loss: 0.2166, weighted_loss: 1.2161, label: 5, bag_size: 584
batch 1200, loss: 0.0685, instance_loss: 0.0431, weighted_loss: 0.0609, label: 6, bag_size: 178
batch 1300, loss: 1.3594, instance_loss: 0.1884, weighted_loss: 1.0081, label: 10, bag_size: 65
batch 1400, loss: 2.2702, instance_loss: 0.2070, weighted_loss: 1.6512, label: 7, bag_size: 390
batch 1500, loss: 0.2977, instance_loss: 0.1018, weighted_loss: 0.2389, label: 6, bag_size: 249
batch 1600, loss: 0.5714, instance_loss: 0.1069, weighted_loss: 0.4321, label: 3, bag_size: 600
batch 1700, loss: 3.5059, instance_loss: 0.2936, weighted_loss: 2.5422, label: 10, bag_size: 328
batch 1800, loss: 0.8741, instance_loss: 0.1967, weighted_loss: 0.6709, label: 5, bag_size: 183
batch 1900, loss: 0.0514, instance_loss: 0.0373, weighted_loss: 0.0471, label: 6, bag_size: 658
batch 2000, loss: 2.5759, instance_loss: 0.2318, weighted_loss: 1.8727, label: 10, bag_size: 96
batch 2100, loss: 2.1272, instance_loss: 0.2213, weighted_loss: 1.5554, label: 7, bag_size: 409

Instance Classifier Stats
class 0 clustering acc 0.997325543120474: correct 242390/243040
class 1 clustering acc 0.18173963133640553: correct 3155/17360

Epoch: 19, train_loss: 1.2040, train_clustering_loss:  0.1600, train_error: 0.4147
fine class 0: fine acc 0.08333333333333333, correct fine 1/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.632495164410058, correct fine 327/517 
fine class 4: fine acc 0.14666666666666667, correct fine 22/150 
fine class 5: fine acc 0.3739130434782609, correct fine 43/115 
fine class 6: fine acc 0.8854415274463007, correct fine 742/838 
fine class 7: fine acc 0.36947791164658633, correct fine 92/249 
fine class 8: fine acc 0.19101123595505617, correct fine 17/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.1590909090909091, correct fine 21/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5853

Val Set, val_loss: 1.4496, val_error: 0.4886, auc: 0.7751
class 0 clustering acc 0.9975311147186147: correct 29495/29568 
class 1 clustering acc 0.17518939393939395: correct 370/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.625, correct fine 40/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.7884615384615384, correct fine 82/104 
fine class 7: fine acc 0.36666666666666664, correct fine 11/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5114
Overall F1 Score: 0.1707

Training for fine level...
batch 100, loss: 0.5329, instance_loss: 0.1447, weighted_loss: 0.4165, label: 3, bag_size: 1516
batch 200, loss: 0.6316, instance_loss: 0.0822, weighted_loss: 0.4668, label: 6, bag_size: 329
batch 300, loss: 2.7875, instance_loss: 0.2591, weighted_loss: 2.0290, label: 5, bag_size: 593
batch 400, loss: 1.8194, instance_loss: 0.2186, weighted_loss: 1.3392, label: 3, bag_size: 320
batch 500, loss: 0.4806, instance_loss: 0.1341, weighted_loss: 0.3766, label: 3, bag_size: 1659
batch 600, loss: 0.5986, instance_loss: 0.1189, weighted_loss: 0.4547, label: 3, bag_size: 936
batch 700, loss: 1.6106, instance_loss: 0.2182, weighted_loss: 1.1929, label: 7, bag_size: 979
batch 800, loss: 1.2197, instance_loss: 0.2121, weighted_loss: 0.9174, label: 5, bag_size: 1301
batch 900, loss: 0.5678, instance_loss: 0.1772, weighted_loss: 0.4506, label: 7, bag_size: 625
batch 1000, loss: 0.0140, instance_loss: 0.0275, weighted_loss: 0.0180, label: 6, bag_size: 1161
batch 1100, loss: 0.3189, instance_loss: 0.0954, weighted_loss: 0.2519, label: 3, bag_size: 2119
batch 1200, loss: 0.0124, instance_loss: 0.0210, weighted_loss: 0.0150, label: 6, bag_size: 629
batch 1300, loss: 1.9296, instance_loss: 0.2158, weighted_loss: 1.4155, label: 3, bag_size: 57
batch 1400, loss: 0.7077, instance_loss: 0.1135, weighted_loss: 0.5294, label: 6, bag_size: 889
batch 1500, loss: 1.5148, instance_loss: 0.1934, weighted_loss: 1.1183, label: 8, bag_size: 179
batch 1600, loss: 0.0422, instance_loss: 0.0347, weighted_loss: 0.0400, label: 6, bag_size: 369
batch 1700, loss: 0.0344, instance_loss: 0.0277, weighted_loss: 0.0324, label: 6, bag_size: 559
batch 1800, loss: 1.2381, instance_loss: 0.1740, weighted_loss: 0.9188, label: 3, bag_size: 242
batch 1900, loss: 0.8004, instance_loss: 0.1436, weighted_loss: 0.6033, label: 6, bag_size: 111
batch 2000, loss: 1.2664, instance_loss: 0.2132, weighted_loss: 0.9504, label: 5, bag_size: 1534
batch 2100, loss: 1.9653, instance_loss: 0.1783, weighted_loss: 1.4292, label: 3, bag_size: 267

Instance Classifier Stats
class 0 clustering acc 0.9973584595128374: correct 242398/243040
class 1 clustering acc 0.18277649769585252: correct 3173/17360

Epoch: 20, train_loss: 1.1942, train_clustering_loss:  0.1598, train_error: 0.4138
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.125, correct fine 4/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6634429400386848, correct fine 343/517 
fine class 4: fine acc 0.14, correct fine 21/150 
fine class 5: fine acc 0.3130434782608696, correct fine 36/115 
fine class 6: fine acc 0.8818615751789977, correct fine 739/838 
fine class 7: fine acc 0.3895582329317269, correct fine 97/249 
fine class 8: fine acc 0.16853932584269662, correct fine 15/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.09848484848484848, correct fine 13/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5862

Val Set, val_loss: 1.4417, val_error: 0.4773, auc: 0.7750
class 0 clustering acc 0.9970914502164502: correct 29482/29568 
class 1 clustering acc 0.18181818181818182: correct 384/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5, correct fine 32/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.9326923076923077, correct fine 97/104 
fine class 7: fine acc 0.13333333333333333, correct fine 4/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5227
Overall F1 Score: 0.1779

Training for fine level...
batch 100, loss: 1.0844, instance_loss: 0.2190, weighted_loss: 0.8248, label: 4, bag_size: 1313
batch 200, loss: 0.0188, instance_loss: 0.0250, weighted_loss: 0.0207, label: 6, bag_size: 866
batch 300, loss: 0.6535, instance_loss: 0.1249, weighted_loss: 0.4949, label: 6, bag_size: 599
batch 400, loss: 0.0831, instance_loss: 0.0374, weighted_loss: 0.0694, label: 6, bag_size: 323
batch 500, loss: 2.6743, instance_loss: 0.2653, weighted_loss: 1.9516, label: 4, bag_size: 276
batch 600, loss: 0.9044, instance_loss: 0.1306, weighted_loss: 0.6723, label: 6, bag_size: 485
batch 700, loss: 0.0911, instance_loss: 0.0570, weighted_loss: 0.0809, label: 6, bag_size: 242
batch 800, loss: 2.4656, instance_loss: 0.2091, weighted_loss: 1.7886, label: 7, bag_size: 566
batch 900, loss: 2.3781, instance_loss: 0.2469, weighted_loss: 1.7387, label: 4, bag_size: 427
batch 1000, loss: 1.0710, instance_loss: 0.1380, weighted_loss: 0.7911, label: 6, bag_size: 394
batch 1100, loss: 0.8367, instance_loss: 0.1175, weighted_loss: 0.6209, label: 3, bag_size: 1085
batch 1200, loss: 2.0403, instance_loss: 0.2095, weighted_loss: 1.4910, label: 3, bag_size: 237
batch 1300, loss: 0.0360, instance_loss: 0.0336, weighted_loss: 0.0353, label: 6, bag_size: 475
batch 1400, loss: 0.2222, instance_loss: 0.1228, weighted_loss: 0.1924, label: 3, bag_size: 673
batch 1500, loss: 0.9934, instance_loss: 0.1695, weighted_loss: 0.7462, label: 3, bag_size: 792
batch 1600, loss: 0.5093, instance_loss: 0.1227, weighted_loss: 0.3933, label: 3, bag_size: 1744
batch 1700, loss: 0.0108, instance_loss: 0.0098, weighted_loss: 0.0105, label: 6, bag_size: 241
batch 1800, loss: 0.5585, instance_loss: 0.1676, weighted_loss: 0.4412, label: 3, bag_size: 1516
batch 1900, loss: 2.3635, instance_loss: 0.3569, weighted_loss: 1.7615, label: 7, bag_size: 337
batch 2000, loss: 4.0679, instance_loss: 0.3392, weighted_loss: 2.9492, label: 10, bag_size: 435
batch 2100, loss: 1.0144, instance_loss: 0.1066, weighted_loss: 0.7421, label: 6, bag_size: 465

Instance Classifier Stats
class 0 clustering acc 0.9971774193548387: correct 242354/243040
class 1 clustering acc 0.18519585253456222: correct 3215/17360

Epoch: 21, train_loss: 1.1814, train_clustering_loss:  0.1595, train_error: 0.4106
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.125, correct fine 4/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.655705996131528, correct fine 339/517 
fine class 4: fine acc 0.16666666666666666, correct fine 25/150 
fine class 5: fine acc 0.3826086956521739, correct fine 44/115 
fine class 6: fine acc 0.8818615751789977, correct fine 739/838 
fine class 7: fine acc 0.3614457831325301, correct fine 90/249 
fine class 8: fine acc 0.23595505617977527, correct fine 21/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.09848484848484848, correct fine 13/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5894

Val Set, val_loss: 1.4454, val_error: 0.4924, auc: 0.7735
class 0 clustering acc 0.9972267316017316: correct 29486/29568 
class 1 clustering acc 0.18039772727272727: correct 381/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.07142857142857142, correct fine 1/14 
fine class 6: fine acc 0.8365384615384616, correct fine 87/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1608

Training for fine level...
batch 100, loss: 0.0376, instance_loss: 0.0780, weighted_loss: 0.0498, label: 6, bag_size: 1364
batch 200, loss: 0.0544, instance_loss: 0.0259, weighted_loss: 0.0459, label: 6, bag_size: 515
batch 300, loss: 0.3033, instance_loss: 0.0474, weighted_loss: 0.2265, label: 6, bag_size: 637
batch 400, loss: 0.0560, instance_loss: 0.0361, weighted_loss: 0.0500, label: 6, bag_size: 475
batch 500, loss: 1.8960, instance_loss: 0.2000, weighted_loss: 1.3872, label: 10, bag_size: 149
batch 600, loss: 3.5290, instance_loss: 0.3381, weighted_loss: 2.5717, label: 1, bag_size: 807
batch 700, loss: 1.8387, instance_loss: 0.2175, weighted_loss: 1.3523, label: 10, bag_size: 536
batch 800, loss: 2.3574, instance_loss: 0.2591, weighted_loss: 1.7279, label: 4, bag_size: 1477
batch 900, loss: 1.5076, instance_loss: 0.1375, weighted_loss: 1.0966, label: 6, bag_size: 1135
batch 1000, loss: 0.2261, instance_loss: 0.0873, weighted_loss: 0.1844, label: 3, bag_size: 680
batch 1100, loss: 1.3275, instance_loss: 0.1492, weighted_loss: 0.9740, label: 3, bag_size: 1293
batch 1200, loss: 1.8297, instance_loss: 0.1823, weighted_loss: 1.3355, label: 6, bag_size: 95
batch 1300, loss: 0.0943, instance_loss: 0.0354, weighted_loss: 0.0766, label: 6, bag_size: 834
batch 1400, loss: 5.2142, instance_loss: 0.4643, weighted_loss: 3.7892, label: 8, bag_size: 868
batch 1500, loss: 0.3906, instance_loss: 0.1053, weighted_loss: 0.3050, label: 3, bag_size: 206
batch 1600, loss: 0.8105, instance_loss: 0.1327, weighted_loss: 0.6072, label: 6, bag_size: 259
batch 1700, loss: 0.9595, instance_loss: 0.1568, weighted_loss: 0.7187, label: 6, bag_size: 462
batch 1800, loss: 1.6316, instance_loss: 0.2439, weighted_loss: 1.2153, label: 10, bag_size: 151
batch 1900, loss: 1.0436, instance_loss: 0.1624, weighted_loss: 0.7793, label: 3, bag_size: 2085
batch 2000, loss: 2.1431, instance_loss: 0.2338, weighted_loss: 1.5704, label: 10, bag_size: 450
batch 2100, loss: 1.3866, instance_loss: 0.2015, weighted_loss: 1.0311, label: 7, bag_size: 344

Instance Classifier Stats
class 0 clustering acc 0.9972555957867018: correct 242373/243040
class 1 clustering acc 0.1847926267281106: correct 3208/17360

Epoch: 22, train_loss: 1.1708, train_clustering_loss:  0.1593, train_error: 0.4018
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.1875, correct fine 6/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6537717601547389, correct fine 338/517 
fine class 4: fine acc 0.17333333333333334, correct fine 26/150 
fine class 5: fine acc 0.391304347826087, correct fine 45/115 
fine class 6: fine acc 0.883054892601432, correct fine 740/838 
fine class 7: fine acc 0.3895582329317269, correct fine 97/249 
fine class 8: fine acc 0.21348314606741572, correct fine 19/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.17424242424242425, correct fine 23/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.5982

Val Set, val_loss: 1.4520, val_error: 0.4848, auc: 0.7730
class 0 clustering acc 0.9971252705627706: correct 29483/29568 
class 1 clustering acc 0.18797348484848486: correct 397/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.8653846153846154, correct fine 90/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5152
Overall F1 Score: 0.1762

Training for fine level...
batch 100, loss: 0.0163, instance_loss: 0.0346, weighted_loss: 0.0218, label: 6, bag_size: 206
batch 200, loss: 0.1753, instance_loss: 0.0745, weighted_loss: 0.1450, label: 3, bag_size: 558
batch 300, loss: 0.0727, instance_loss: 0.0588, weighted_loss: 0.0685, label: 6, bag_size: 287
batch 400, loss: 0.9504, instance_loss: 0.1279, weighted_loss: 0.7036, label: 3, bag_size: 2037
batch 500, loss: 1.5230, instance_loss: 0.1872, weighted_loss: 1.1222, label: 3, bag_size: 116
batch 600, loss: 2.5247, instance_loss: 0.2362, weighted_loss: 1.8382, label: 10, bag_size: 96
batch 700, loss: 0.0304, instance_loss: 0.0394, weighted_loss: 0.0331, label: 6, bag_size: 819
batch 800, loss: 2.9588, instance_loss: 0.2448, weighted_loss: 2.1446, label: 3, bag_size: 115
batch 900, loss: 0.5016, instance_loss: 0.1088, weighted_loss: 0.3837, label: 3, bag_size: 199
batch 1000, loss: 0.2293, instance_loss: 0.0877, weighted_loss: 0.1868, label: 3, bag_size: 1359
batch 1100, loss: 1.4403, instance_loss: 0.1645, weighted_loss: 1.0575, label: 6, bag_size: 116
batch 1200, loss: 0.6706, instance_loss: 0.1160, weighted_loss: 0.5042, label: 6, bag_size: 269
batch 1300, loss: 0.0244, instance_loss: 0.0149, weighted_loss: 0.0216, label: 6, bag_size: 307
batch 1400, loss: 0.8575, instance_loss: 0.1814, weighted_loss: 0.6547, label: 10, bag_size: 120
batch 1500, loss: 3.7588, instance_loss: 0.3230, weighted_loss: 2.7281, label: 13, bag_size: 751
batch 1600, loss: 2.6317, instance_loss: 0.2448, weighted_loss: 1.9157, label: 4, bag_size: 347
batch 1700, loss: 0.2312, instance_loss: 0.0367, weighted_loss: 0.1729, label: 6, bag_size: 256
batch 1800, loss: 4.7720, instance_loss: 0.3282, weighted_loss: 3.4389, label: 13, bag_size: 372
batch 1900, loss: 1.9004, instance_loss: 0.2632, weighted_loss: 1.4093, label: 4, bag_size: 495
batch 2000, loss: 2.3418, instance_loss: 0.2138, weighted_loss: 1.7034, label: 10, bag_size: 253
batch 2100, loss: 3.1098, instance_loss: 0.2543, weighted_loss: 2.2531, label: 4, bag_size: 401

Instance Classifier Stats
class 0 clustering acc 0.9973214285714286: correct 242389/243040
class 1 clustering acc 0.18502304147465437: correct 3212/17360

Epoch: 23, train_loss: 1.1575, train_clustering_loss:  0.1586, train_error: 0.3977
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.1875, correct fine 6/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.655705996131528, correct fine 339/517 
fine class 4: fine acc 0.15333333333333332, correct fine 23/150 
fine class 5: fine acc 0.3652173913043478, correct fine 42/115 
fine class 6: fine acc 0.8878281622911695, correct fine 744/838 
fine class 7: fine acc 0.42570281124497994, correct fine 106/249 
fine class 8: fine acc 0.2696629213483146, correct fine 24/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.14393939393939395, correct fine 19/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.6023

Val Set, val_loss: 1.4692, val_error: 0.5076, auc: 0.7671
class 0 clustering acc 0.997463474025974: correct 29493/29568 
class 1 clustering acc 0.16761363636363635: correct 354/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.671875, correct fine 43/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7211538461538461, correct fine 75/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1847

Training for fine level...
batch 100, loss: 1.0314, instance_loss: 0.2630, weighted_loss: 0.8009, label: 7, bag_size: 686
batch 200, loss: 0.0672, instance_loss: 0.0688, weighted_loss: 0.0677, label: 6, bag_size: 342
batch 300, loss: 1.2538, instance_loss: 0.1659, weighted_loss: 0.9274, label: 10, bag_size: 384
batch 400, loss: 1.1782, instance_loss: 0.1873, weighted_loss: 0.8809, label: 10, bag_size: 65
batch 500, loss: 2.8666, instance_loss: 0.2313, weighted_loss: 2.0760, label: 4, bag_size: 1299
batch 600, loss: 1.1081, instance_loss: 0.1482, weighted_loss: 0.8202, label: 6, bag_size: 125
batch 700, loss: 0.8236, instance_loss: 0.1586, weighted_loss: 0.6241, label: 6, bag_size: 91
batch 800, loss: 0.0461, instance_loss: 0.0335, weighted_loss: 0.0423, label: 6, bag_size: 789
batch 900, loss: 1.5525, instance_loss: 0.1678, weighted_loss: 1.1371, label: 3, bag_size: 1627
batch 1000, loss: 0.2204, instance_loss: 0.0857, weighted_loss: 0.1800, label: 3, bag_size: 872
batch 1100, loss: 0.0275, instance_loss: 0.0361, weighted_loss: 0.0301, label: 6, bag_size: 1005
batch 1200, loss: 0.6249, instance_loss: 0.1431, weighted_loss: 0.4803, label: 6, bag_size: 1678
batch 1300, loss: 0.8569, instance_loss: 0.1361, weighted_loss: 0.6407, label: 3, bag_size: 2019
batch 1400, loss: 1.1458, instance_loss: 0.2091, weighted_loss: 0.8648, label: 4, bag_size: 755
batch 1500, loss: 0.0857, instance_loss: 0.0610, weighted_loss: 0.0782, label: 6, bag_size: 1304
batch 1600, loss: 0.2567, instance_loss: 0.0762, weighted_loss: 0.2025, label: 3, bag_size: 2086
batch 1700, loss: 0.1126, instance_loss: 0.0324, weighted_loss: 0.0885, label: 6, bag_size: 761
batch 1800, loss: 0.2806, instance_loss: 0.0724, weighted_loss: 0.2181, label: 3, bag_size: 2107
batch 1900, loss: 0.0220, instance_loss: 0.0337, weighted_loss: 0.0255, label: 6, bag_size: 2141
batch 2000, loss: 0.1534, instance_loss: 0.1154, weighted_loss: 0.1420, label: 3, bag_size: 177
batch 2100, loss: 2.8778, instance_loss: 0.2770, weighted_loss: 2.0976, label: 13, bag_size: 174

Instance Classifier Stats
class 0 clustering acc 0.9972514812376564: correct 242372/243040
class 1 clustering acc 0.19055299539170506: correct 3308/17360

Epoch: 24, train_loss: 1.1464, train_clustering_loss:  0.1586, train_error: 0.3922
fine class 0: fine acc 0.25, correct fine 3/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6750483558994197, correct fine 349/517 
fine class 4: fine acc 0.18666666666666668, correct fine 28/150 
fine class 5: fine acc 0.40869565217391307, correct fine 47/115 
fine class 6: fine acc 0.8747016706443914, correct fine 733/838 
fine class 7: fine acc 0.42971887550200805, correct fine 107/249 
fine class 8: fine acc 0.2808988764044944, correct fine 25/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.16666666666666666, correct fine 22/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.6078

Val Set, val_loss: 1.4578, val_error: 0.4924, auc: 0.7681
class 0 clustering acc 0.9972943722943723: correct 29488/29568 
class 1 clustering acc 0.1747159090909091: correct 369/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8365384615384616, correct fine 87/104 
fine class 7: fine acc 0.13333333333333333, correct fine 4/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5076
Overall F1 Score: 0.1724

Training for fine level...
batch 100, loss: 1.3816, instance_loss: 0.1444, weighted_loss: 1.0104, label: 6, bag_size: 575
batch 200, loss: 1.5292, instance_loss: 0.2094, weighted_loss: 1.1332, label: 3, bag_size: 364
batch 300, loss: 1.2916, instance_loss: 0.2092, weighted_loss: 0.9669, label: 7, bag_size: 243
batch 400, loss: 1.7946, instance_loss: 0.2274, weighted_loss: 1.3244, label: 7, bag_size: 79
batch 500, loss: 0.8092, instance_loss: 0.1344, weighted_loss: 0.6068, label: 6, bag_size: 770
batch 600, loss: 2.7002, instance_loss: 0.2363, weighted_loss: 1.9610, label: 10, bag_size: 195
batch 700, loss: 5.5519, instance_loss: 0.3360, weighted_loss: 3.9871, label: 11, bag_size: 464
batch 800, loss: 1.5361, instance_loss: 0.1642, weighted_loss: 1.1246, label: 3, bag_size: 389
batch 900, loss: 0.9055, instance_loss: 0.1631, weighted_loss: 0.6828, label: 3, bag_size: 162
batch 1000, loss: 0.9380, instance_loss: 0.1547, weighted_loss: 0.7030, label: 6, bag_size: 314
batch 1100, loss: 0.4399, instance_loss: 0.1756, weighted_loss: 0.3606, label: 7, bag_size: 740
batch 1200, loss: 0.2707, instance_loss: 0.0914, weighted_loss: 0.2169, label: 3, bag_size: 3615
batch 1300, loss: 1.3297, instance_loss: 0.1780, weighted_loss: 0.9842, label: 3, bag_size: 1627
batch 1400, loss: 0.0421, instance_loss: 0.0427, weighted_loss: 0.0423, label: 6, bag_size: 409
batch 1500, loss: 2.8888, instance_loss: 0.3125, weighted_loss: 2.1159, label: 7, bag_size: 1239
batch 1600, loss: 3.7419, instance_loss: 0.2747, weighted_loss: 2.7018, label: 11, bag_size: 237
batch 1700, loss: 1.5477, instance_loss: 0.1739, weighted_loss: 1.1356, label: 6, bag_size: 853
batch 1800, loss: 0.0504, instance_loss: 0.0488, weighted_loss: 0.0499, label: 6, bag_size: 817
batch 1900, loss: 1.2083, instance_loss: 0.1704, weighted_loss: 0.8969, label: 8, bag_size: 321
batch 2000, loss: 0.8000, instance_loss: 0.2370, weighted_loss: 0.6311, label: 1, bag_size: 119
batch 2100, loss: 1.9917, instance_loss: 0.1714, weighted_loss: 1.4456, label: 8, bag_size: 209

Instance Classifier Stats
class 0 clustering acc 0.9973584595128374: correct 242398/243040
class 1 clustering acc 0.18755760368663593: correct 3256/17360

Epoch: 25, train_loss: 1.1292, train_clustering_loss:  0.1578, train_error: 0.3857
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.1875, correct fine 6/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.688588007736944, correct fine 356/517 
fine class 4: fine acc 0.18, correct fine 27/150 
fine class 5: fine acc 0.40869565217391307, correct fine 47/115 
fine class 6: fine acc 0.8949880668257757, correct fine 750/838 
fine class 7: fine acc 0.39759036144578314, correct fine 99/249 
fine class 8: fine acc 0.2696629213483146, correct fine 24/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.14393939393939395, correct fine 19/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.038461538461538464, correct fine 1/26 
Overall Accuracy: 0.6143

Val Set, val_loss: 1.4583, val_error: 0.5038, auc: 0.7728
class 0 clustering acc 0.9967532467532467: correct 29472/29568 
class 1 clustering acc 0.19318181818181818: correct 408/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.8365384615384616, correct fine 87/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1652

Training for fine level...
batch 100, loss: 2.6819, instance_loss: 0.2907, weighted_loss: 1.9645, label: 10, bag_size: 838
batch 200, loss: 1.2980, instance_loss: 0.1869, weighted_loss: 0.9646, label: 3, bag_size: 681
batch 300, loss: 2.7277, instance_loss: 0.2700, weighted_loss: 1.9904, label: 1, bag_size: 474
batch 400, loss: 0.4056, instance_loss: 0.0966, weighted_loss: 0.3129, label: 3, bag_size: 1512
batch 500, loss: 2.3523, instance_loss: 0.1875, weighted_loss: 1.7029, label: 10, bag_size: 435
batch 600, loss: 0.4820, instance_loss: 0.1160, weighted_loss: 0.3722, label: 3, bag_size: 862
batch 700, loss: 0.3300, instance_loss: 0.1191, weighted_loss: 0.2667, label: 6, bag_size: 202
batch 800, loss: 0.1837, instance_loss: 0.1083, weighted_loss: 0.1611, label: 6, bag_size: 376
batch 900, loss: 0.9020, instance_loss: 0.2204, weighted_loss: 0.6975, label: 7, bag_size: 325
batch 1000, loss: 0.7587, instance_loss: 0.1717, weighted_loss: 0.5826, label: 5, bag_size: 1279
batch 1100, loss: 2.3125, instance_loss: 0.3130, weighted_loss: 1.7126, label: 3, bag_size: 2625
batch 1200, loss: 3.1453, instance_loss: 0.2672, weighted_loss: 2.2819, label: 8, bag_size: 542
batch 1300, loss: 0.0047, instance_loss: 0.0121, weighted_loss: 0.0069, label: 6, bag_size: 210
batch 1400, loss: 1.1520, instance_loss: 0.2067, weighted_loss: 0.8684, label: 3, bag_size: 940
batch 1500, loss: 0.2771, instance_loss: 0.1238, weighted_loss: 0.2311, label: 6, bag_size: 232
batch 1600, loss: 0.3376, instance_loss: 0.0780, weighted_loss: 0.2597, label: 6, bag_size: 225
batch 1700, loss: 0.1618, instance_loss: 0.1729, weighted_loss: 0.1651, label: 7, bag_size: 307
batch 1800, loss: 0.6159, instance_loss: 0.2304, weighted_loss: 0.5002, label: 7, bag_size: 570
batch 1900, loss: 3.0334, instance_loss: 0.2589, weighted_loss: 2.2011, label: 7, bag_size: 2033
batch 2000, loss: 0.1050, instance_loss: 0.1091, weighted_loss: 0.1063, label: 6, bag_size: 174
batch 2100, loss: 1.2830, instance_loss: 0.1823, weighted_loss: 0.9528, label: 10, bag_size: 201

Instance Classifier Stats
class 0 clustering acc 0.9971733048057932: correct 242353/243040
class 1 clustering acc 0.19043778801843317: correct 3306/17360

Epoch: 26, train_loss: 1.1179, train_clustering_loss:  0.1577, train_error: 0.3839
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.1875, correct fine 6/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6943907156673114, correct fine 359/517 
fine class 4: fine acc 0.14, correct fine 21/150 
fine class 5: fine acc 0.41739130434782606, correct fine 48/115 
fine class 6: fine acc 0.883054892601432, correct fine 740/838 
fine class 7: fine acc 0.43373493975903615, correct fine 108/249 
fine class 8: fine acc 0.30337078651685395, correct fine 27/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.18181818181818182, correct fine 24/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.6161

Val Set, val_loss: 1.4726, val_error: 0.5038, auc: 0.7679
class 0 clustering acc 0.9969899891774892: correct 29479/29568 
class 1 clustering acc 0.18418560606060605: correct 389/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.8076923076923077, correct fine 84/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4962
Overall F1 Score: 0.1806

Training for fine level...
batch 100, loss: 0.3316, instance_loss: 0.0557, weighted_loss: 0.2488, label: 6, bag_size: 1798
batch 200, loss: 0.4766, instance_loss: 0.0984, weighted_loss: 0.3632, label: 3, bag_size: 1311
batch 300, loss: 0.5912, instance_loss: 0.1132, weighted_loss: 0.4478, label: 3, bag_size: 1099
batch 400, loss: 0.0139, instance_loss: 0.0855, weighted_loss: 0.0354, label: 6, bag_size: 235
batch 500, loss: 3.9724, instance_loss: 0.2558, weighted_loss: 2.8574, label: 4, bag_size: 933
batch 600, loss: 0.4116, instance_loss: 0.0837, weighted_loss: 0.3132, label: 6, bag_size: 728
batch 700, loss: 0.0358, instance_loss: 0.0371, weighted_loss: 0.0362, label: 6, bag_size: 353
batch 800, loss: 0.5085, instance_loss: 0.1090, weighted_loss: 0.3886, label: 6, bag_size: 315
batch 900, loss: 0.1642, instance_loss: 0.1114, weighted_loss: 0.1484, label: 3, bag_size: 1527
batch 1000, loss: 0.4822, instance_loss: 0.1368, weighted_loss: 0.3786, label: 3, bag_size: 1516
batch 1100, loss: 0.1128, instance_loss: 0.0293, weighted_loss: 0.0877, label: 6, bag_size: 200
batch 1200, loss: 0.4027, instance_loss: 0.1119, weighted_loss: 0.3155, label: 6, bag_size: 1262
batch 1300, loss: 1.7006, instance_loss: 0.2064, weighted_loss: 1.2524, label: 5, bag_size: 1534
batch 1400, loss: 0.1908, instance_loss: 0.0772, weighted_loss: 0.1567, label: 3, bag_size: 673
batch 1500, loss: 1.2788, instance_loss: 0.2539, weighted_loss: 0.9714, label: 4, bag_size: 1632
batch 1600, loss: 0.3490, instance_loss: 0.0417, weighted_loss: 0.2568, label: 6, bag_size: 996
batch 1700, loss: 1.1210, instance_loss: 0.1783, weighted_loss: 0.8382, label: 3, bag_size: 454
batch 1800, loss: 0.4537, instance_loss: 0.1110, weighted_loss: 0.3509, label: 3, bag_size: 2214
batch 1900, loss: 0.0337, instance_loss: 0.0205, weighted_loss: 0.0298, label: 6, bag_size: 467
batch 2000, loss: 0.2873, instance_loss: 0.0869, weighted_loss: 0.2272, label: 6, bag_size: 812
batch 2100, loss: 0.4255, instance_loss: 0.0569, weighted_loss: 0.3149, label: 6, bag_size: 256

Instance Classifier Stats
class 0 clustering acc 0.9972432521395656: correct 242370/243040
class 1 clustering acc 0.19366359447004608: correct 3362/17360

Epoch: 27, train_loss: 1.1028, train_clustering_loss:  0.1571, train_error: 0.3793
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.1875, correct fine 6/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.6982591876208898, correct fine 361/517 
fine class 4: fine acc 0.21333333333333335, correct fine 32/150 
fine class 5: fine acc 0.4, correct fine 46/115 
fine class 6: fine acc 0.8854415274463007, correct fine 742/838 
fine class 7: fine acc 0.42971887550200805, correct fine 107/249 
fine class 8: fine acc 0.24719101123595505, correct fine 22/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.19696969696969696, correct fine 26/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.6207

Val Set, val_loss: 1.4928, val_error: 0.5265, auc: 0.7666
class 0 clustering acc 0.9969561688311688: correct 29478/29568 
class 1 clustering acc 0.18418560606060605: correct 389/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.640625, correct fine 41/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.7115384615384616, correct fine 74/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4735
Overall F1 Score: 0.1700

Training for fine level...
batch 100, loss: 0.7419, instance_loss: 0.1171, weighted_loss: 0.5545, label: 6, bag_size: 532
batch 200, loss: 1.4166, instance_loss: 0.1437, weighted_loss: 1.0347, label: 6, bag_size: 193
batch 300, loss: 0.2188, instance_loss: 0.0900, weighted_loss: 0.1802, label: 6, bag_size: 482
batch 400, loss: 1.4180, instance_loss: 0.2475, weighted_loss: 1.0669, label: 4, bag_size: 1336
batch 500, loss: 0.0142, instance_loss: 0.0221, weighted_loss: 0.0166, label: 6, bag_size: 261
batch 600, loss: 1.5269, instance_loss: 0.1812, weighted_loss: 1.1232, label: 3, bag_size: 187
batch 700, loss: 0.7766, instance_loss: 0.1838, weighted_loss: 0.5987, label: 5, bag_size: 1424
batch 800, loss: 1.7721, instance_loss: 0.2017, weighted_loss: 1.3010, label: 10, bag_size: 415
batch 900, loss: 1.4262, instance_loss: 0.2252, weighted_loss: 1.0659, label: 10, bag_size: 367
batch 1000, loss: 0.1666, instance_loss: 0.0931, weighted_loss: 0.1445, label: 5, bag_size: 500
batch 1100, loss: 0.0542, instance_loss: 0.0372, weighted_loss: 0.0491, label: 6, bag_size: 323
batch 1200, loss: 0.3638, instance_loss: 0.1102, weighted_loss: 0.2878, label: 3, bag_size: 1817
batch 1300, loss: 1.4183, instance_loss: 0.1508, weighted_loss: 1.0380, label: 6, bag_size: 376
batch 1400, loss: 0.3378, instance_loss: 0.0987, weighted_loss: 0.2661, label: 6, bag_size: 243
batch 1500, loss: 0.6449, instance_loss: 0.1565, weighted_loss: 0.4984, label: 6, bag_size: 391
batch 1600, loss: 2.1599, instance_loss: 0.2961, weighted_loss: 1.6007, label: 5, bag_size: 2056
batch 1700, loss: 1.0425, instance_loss: 0.1612, weighted_loss: 0.7781, label: 6, bag_size: 466
batch 1800, loss: 0.0068, instance_loss: 0.0187, weighted_loss: 0.0104, label: 6, bag_size: 635
batch 1900, loss: 2.7417, instance_loss: 0.2685, weighted_loss: 1.9998, label: 13, bag_size: 174
batch 2000, loss: 0.0491, instance_loss: 0.2037, weighted_loss: 0.0955, label: 5, bag_size: 160
batch 2100, loss: 1.4129, instance_loss: 0.1755, weighted_loss: 1.0417, label: 3, bag_size: 762

Instance Classifier Stats
class 0 clustering acc 0.9971445029624754: correct 242346/243040
class 1 clustering acc 0.1963709677419355: correct 3409/17360

Epoch: 28, train_loss: 1.0925, train_clustering_loss:  0.1571, train_error: 0.3719
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7176015473887815, correct fine 371/517 
fine class 4: fine acc 0.18666666666666668, correct fine 28/150 
fine class 5: fine acc 0.40869565217391307, correct fine 47/115 
fine class 6: fine acc 0.8926014319809069, correct fine 748/838 
fine class 7: fine acc 0.4497991967871486, correct fine 112/249 
fine class 8: fine acc 0.29213483146067415, correct fine 26/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.14393939393939395, correct fine 19/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.6281

Val Set, val_loss: 1.4989, val_error: 0.5076, auc: 0.7617
class 0 clustering acc 0.9969561688311688: correct 29478/29568 
class 1 clustering acc 0.18039772727272727: correct 381/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.7788461538461539, correct fine 81/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1805

Training for fine level...
batch 100, loss: 2.8452, instance_loss: 0.3285, weighted_loss: 2.0902, label: 8, bag_size: 1529
batch 200, loss: 2.2799, instance_loss: 0.1917, weighted_loss: 1.6534, label: 6, bag_size: 506
batch 300, loss: 2.8131, instance_loss: 0.2448, weighted_loss: 2.0426, label: 7, bag_size: 710
batch 400, loss: 1.3206, instance_loss: 0.1509, weighted_loss: 0.9697, label: 6, bag_size: 577
batch 500, loss: 1.9557, instance_loss: 0.2600, weighted_loss: 1.4470, label: 10, bag_size: 151
batch 600, loss: 1.7807, instance_loss: 0.1957, weighted_loss: 1.3052, label: 3, bag_size: 575
batch 700, loss: 0.9470, instance_loss: 0.1384, weighted_loss: 0.7044, label: 3, bag_size: 84
batch 800, loss: 0.6902, instance_loss: 0.1326, weighted_loss: 0.5229, label: 6, bag_size: 422
batch 900, loss: 2.5744, instance_loss: 0.2669, weighted_loss: 1.8822, label: 10, bag_size: 278
batch 1000, loss: 0.0235, instance_loss: 0.0466, weighted_loss: 0.0305, label: 6, bag_size: 1023
batch 1100, loss: 0.0091, instance_loss: 0.0301, weighted_loss: 0.0154, label: 6, bag_size: 206
batch 1200, loss: 1.3434, instance_loss: 0.2145, weighted_loss: 1.0047, label: 10, bag_size: 478
batch 1300, loss: 0.2478, instance_loss: 0.0915, weighted_loss: 0.2009, label: 6, bag_size: 364
batch 1400, loss: 1.9142, instance_loss: 0.2601, weighted_loss: 1.4180, label: 13, bag_size: 451
batch 1500, loss: 2.1374, instance_loss: 0.1874, weighted_loss: 1.5524, label: 7, bag_size: 338
batch 1600, loss: 1.3480, instance_loss: 0.1816, weighted_loss: 0.9981, label: 3, bag_size: 551
batch 1700, loss: 0.5684, instance_loss: 0.1101, weighted_loss: 0.4310, label: 3, bag_size: 1981
batch 1800, loss: 2.0521, instance_loss: 0.2534, weighted_loss: 1.5125, label: 7, bag_size: 565
batch 1900, loss: 1.9601, instance_loss: 0.2275, weighted_loss: 1.4403, label: 10, bag_size: 1555
batch 2000, loss: 0.2884, instance_loss: 0.1166, weighted_loss: 0.2368, label: 6, bag_size: 41
batch 2100, loss: 0.1427, instance_loss: 0.1013, weighted_loss: 0.1303, label: 3, bag_size: 1700

Instance Classifier Stats
class 0 clustering acc 0.9971527320605662: correct 242348/243040
class 1 clustering acc 0.19752304147465438: correct 3429/17360

Epoch: 29, train_loss: 1.0802, train_clustering_loss:  0.1568, train_error: 0.3645
fine class 0: fine acc 0.3333333333333333, correct fine 4/12 
fine class 1: fine acc 0.15625, correct fine 5/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7292069632495164, correct fine 377/517 
fine class 4: fine acc 0.18, correct fine 27/150 
fine class 5: fine acc 0.41739130434782606, correct fine 48/115 
fine class 6: fine acc 0.8914081145584726, correct fine 747/838 
fine class 7: fine acc 0.46987951807228917, correct fine 117/249 
fine class 8: fine acc 0.3146067415730337, correct fine 28/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.19696969696969696, correct fine 26/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.6355

Val Set, val_loss: 1.5096, val_error: 0.5076, auc: 0.7664
class 0 clustering acc 0.9966856060606061: correct 29470/29568 
class 1 clustering acc 0.19412878787878787: correct 410/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5, correct fine 32/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.875, correct fine 91/104 
fine class 7: fine acc 0.06666666666666667, correct fine 2/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1620

Training for fine level...
batch 100, loss: 2.4971, instance_loss: 0.2327, weighted_loss: 1.8178, label: 7, bag_size: 409
batch 200, loss: 1.1400, instance_loss: 0.1945, weighted_loss: 0.8564, label: 3, bag_size: 228
batch 300, loss: 0.0275, instance_loss: 0.0486, weighted_loss: 0.0339, label: 6, bag_size: 857
batch 400, loss: 2.4155, instance_loss: 0.2374, weighted_loss: 1.7620, label: 4, bag_size: 1441
batch 500, loss: 0.2273, instance_loss: 0.1539, weighted_loss: 0.2053, label: 5, bag_size: 728
batch 600, loss: 0.9840, instance_loss: 0.1819, weighted_loss: 0.7434, label: 3, bag_size: 664
batch 700, loss: 2.2045, instance_loss: 0.2471, weighted_loss: 1.6173, label: 13, bag_size: 309
batch 800, loss: 0.5893, instance_loss: 0.0628, weighted_loss: 0.4314, label: 6, bag_size: 517
batch 900, loss: 0.9548, instance_loss: 0.1563, weighted_loss: 0.7152, label: 6, bag_size: 1077
batch 1000, loss: 0.7712, instance_loss: 0.1918, weighted_loss: 0.5974, label: 4, bag_size: 836
batch 1100, loss: 1.0344, instance_loss: 0.1814, weighted_loss: 0.7785, label: 3, bag_size: 1049
batch 1200, loss: 1.0599, instance_loss: 0.2190, weighted_loss: 0.8077, label: 4, bag_size: 2302
batch 1300, loss: 0.4143, instance_loss: 0.1945, weighted_loss: 0.3483, label: 7, bag_size: 1687
batch 1400, loss: 0.0737, instance_loss: 0.0429, weighted_loss: 0.0644, label: 6, bag_size: 424
batch 1500, loss: 4.2339, instance_loss: 0.3036, weighted_loss: 3.0548, label: 4, bag_size: 1134
batch 1600, loss: 1.9219, instance_loss: 0.2181, weighted_loss: 1.4108, label: 7, bag_size: 416
batch 1700, loss: 0.1310, instance_loss: 0.0554, weighted_loss: 0.1084, label: 6, bag_size: 875
batch 1800, loss: 3.6205, instance_loss: 0.2743, weighted_loss: 2.6166, label: 1, bag_size: 207
batch 1900, loss: 0.3854, instance_loss: 0.1062, weighted_loss: 0.3017, label: 6, bag_size: 510
batch 2000, loss: 1.0951, instance_loss: 0.1727, weighted_loss: 0.8184, label: 6, bag_size: 986
batch 2100, loss: 2.9520, instance_loss: 0.2591, weighted_loss: 2.1442, label: 4, bag_size: 167

Instance Classifier Stats
class 0 clustering acc 0.997189763001975: correct 242357/243040
class 1 clustering acc 0.19671658986175114: correct 3415/17360

Epoch: 30, train_loss: 1.0604, train_clustering_loss:  0.1564, train_error: 0.3521
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7195357833655706, correct fine 372/517 
fine class 4: fine acc 0.24, correct fine 36/150 
fine class 5: fine acc 0.4608695652173913, correct fine 53/115 
fine class 6: fine acc 0.9045346062052506, correct fine 758/838 
fine class 7: fine acc 0.4497991967871486, correct fine 112/249 
fine class 8: fine acc 0.34831460674157305, correct fine 31/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.24242424242424243, correct fine 32/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.6479

Val Set, val_loss: 1.5209, val_error: 0.4962, auc: 0.7632
class 0 clustering acc 0.9970238095238095: correct 29480/29568 
class 1 clustering acc 0.17803030303030304: correct 376/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.0, correct fine 0/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7788461538461539, correct fine 81/104 
fine class 7: fine acc 0.36666666666666664, correct fine 11/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.5038
Overall F1 Score: 0.1828

Training for fine level...
batch 100, loss: 0.0221, instance_loss: 0.0456, weighted_loss: 0.0291, label: 6, bag_size: 318
batch 200, loss: 0.8549, instance_loss: 0.1952, weighted_loss: 0.6570, label: 3, bag_size: 618
batch 300, loss: 0.2614, instance_loss: 0.0351, weighted_loss: 0.1935, label: 6, bag_size: 256
batch 400, loss: 1.4072, instance_loss: 0.1547, weighted_loss: 1.0314, label: 6, bag_size: 463
batch 500, loss: 0.1986, instance_loss: 0.0640, weighted_loss: 0.1582, label: 6, bag_size: 256
batch 600, loss: 2.4126, instance_loss: 0.2575, weighted_loss: 1.7661, label: 11, bag_size: 307
batch 700, loss: 0.6003, instance_loss: 0.1295, weighted_loss: 0.4591, label: 6, bag_size: 229
batch 800, loss: 0.7108, instance_loss: 0.1805, weighted_loss: 0.5518, label: 4, bag_size: 1967
batch 900, loss: 0.1936, instance_loss: 0.0845, weighted_loss: 0.1609, label: 6, bag_size: 1214
batch 1000, loss: 0.9634, instance_loss: 0.1193, weighted_loss: 0.7102, label: 6, bag_size: 316
batch 1100, loss: 0.8598, instance_loss: 0.1679, weighted_loss: 0.6522, label: 3, bag_size: 605
batch 1200, loss: 0.1507, instance_loss: 0.0478, weighted_loss: 0.1198, label: 6, bag_size: 217
batch 1300, loss: 0.2011, instance_loss: 0.1157, weighted_loss: 0.1755, label: 6, bag_size: 350
batch 1400, loss: 1.7447, instance_loss: 0.2570, weighted_loss: 1.2984, label: 4, bag_size: 495
batch 1500, loss: 1.3411, instance_loss: 0.1993, weighted_loss: 0.9986, label: 10, bag_size: 241
batch 1600, loss: 3.9179, instance_loss: 0.3323, weighted_loss: 2.8422, label: 1, bag_size: 807
batch 1700, loss: 3.8025, instance_loss: 0.3065, weighted_loss: 2.7537, label: 10, bag_size: 715
batch 1800, loss: 1.0951, instance_loss: 0.1862, weighted_loss: 0.8224, label: 10, bag_size: 110
batch 1900, loss: 3.1336, instance_loss: 0.2707, weighted_loss: 2.2747, label: 4, bag_size: 185
batch 2000, loss: 0.3397, instance_loss: 0.1203, weighted_loss: 0.2739, label: 3, bag_size: 480
batch 2100, loss: 0.6358, instance_loss: 0.1230, weighted_loss: 0.4819, label: 6, bag_size: 735

Instance Classifier Stats
class 0 clustering acc 0.9971691902567479: correct 242352/243040
class 1 clustering acc 0.19890552995391705: correct 3453/17360

Epoch: 31, train_loss: 1.0529, train_clustering_loss:  0.1560, train_error: 0.3530
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.1875, correct fine 6/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7311411992263056, correct fine 378/517 
fine class 4: fine acc 0.21333333333333335, correct fine 32/150 
fine class 5: fine acc 0.4434782608695652, correct fine 51/115 
fine class 6: fine acc 0.8926014319809069, correct fine 748/838 
fine class 7: fine acc 0.4979919678714859, correct fine 124/249 
fine class 8: fine acc 0.34831460674157305, correct fine 31/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.2196969696969697, correct fine 29/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.6470

Val Set, val_loss: 1.5278, val_error: 0.5114, auc: 0.7631
class 0 clustering acc 0.9970576298701299: correct 29481/29568 
class 1 clustering acc 0.17897727272727273: correct 378/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7980769230769231, correct fine 83/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4886
Overall F1 Score: 0.1751

Training for fine level...
batch 100, loss: 0.0370, instance_loss: 0.0487, weighted_loss: 0.0405, label: 6, bag_size: 364
batch 200, loss: 1.9715, instance_loss: 0.2214, weighted_loss: 1.4464, label: 10, bag_size: 79
batch 300, loss: 0.6128, instance_loss: 0.1108, weighted_loss: 0.4622, label: 6, bag_size: 2209
batch 400, loss: 1.4291, instance_loss: 0.2071, weighted_loss: 1.0625, label: 7, bag_size: 274
batch 500, loss: 1.2639, instance_loss: 0.1643, weighted_loss: 0.9340, label: 7, bag_size: 284
batch 600, loss: 0.2680, instance_loss: 0.1104, weighted_loss: 0.2207, label: 6, bag_size: 414
batch 700, loss: 0.6349, instance_loss: 0.1352, weighted_loss: 0.4850, label: 3, bag_size: 536
batch 800, loss: 0.6145, instance_loss: 0.1537, weighted_loss: 0.4762, label: 6, bag_size: 202
batch 900, loss: 0.1383, instance_loss: 0.0935, weighted_loss: 0.1249, label: 6, bag_size: 249
batch 1000, loss: 0.0702, instance_loss: 0.0363, weighted_loss: 0.0600, label: 6, bag_size: 853
batch 1100, loss: 1.6065, instance_loss: 0.1917, weighted_loss: 1.1821, label: 7, bag_size: 744
batch 1200, loss: 1.7112, instance_loss: 0.2156, weighted_loss: 1.2625, label: 5, bag_size: 344
batch 1300, loss: 1.7020, instance_loss: 0.1495, weighted_loss: 1.2362, label: 3, bag_size: 1618
batch 1400, loss: 1.2971, instance_loss: 0.1755, weighted_loss: 0.9606, label: 3, bag_size: 371
batch 1500, loss: 0.4195, instance_loss: 0.2199, weighted_loss: 0.3596, label: 7, bag_size: 1072
batch 1600, loss: 3.6173, instance_loss: 0.2995, weighted_loss: 2.6220, label: 1, bag_size: 440
batch 1700, loss: 1.7475, instance_loss: 0.1954, weighted_loss: 1.2819, label: 6, bag_size: 452
batch 1800, loss: 0.6410, instance_loss: 0.1168, weighted_loss: 0.4838, label: 6, bag_size: 466
batch 1900, loss: 5.5931, instance_loss: 0.3858, weighted_loss: 4.0309, label: 10, bag_size: 1875
batch 2000, loss: 0.1012, instance_loss: 0.1061, weighted_loss: 0.1027, label: 3, bag_size: 177
batch 2100, loss: 0.8692, instance_loss: 0.1634, weighted_loss: 0.6575, label: 6, bag_size: 214

Instance Classifier Stats
class 0 clustering acc 0.9971568466096116: correct 242349/243040
class 1 clustering acc 0.20034562211981566: correct 3478/17360

Epoch: 32, train_loss: 1.0323, train_clustering_loss:  0.1556, train_error: 0.3479
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7311411992263056, correct fine 378/517 
fine class 4: fine acc 0.25333333333333335, correct fine 38/150 
fine class 5: fine acc 0.4608695652173913, correct fine 53/115 
fine class 6: fine acc 0.8914081145584726, correct fine 747/838 
fine class 7: fine acc 0.4979919678714859, correct fine 124/249 
fine class 8: fine acc 0.3258426966292135, correct fine 29/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.25757575757575757, correct fine 34/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/26 
Overall Accuracy: 0.6521

Val Set, val_loss: 1.5617, val_error: 0.5455, auc: 0.7589
class 0 clustering acc 0.9967870670995671: correct 29473/29568 
class 1 clustering acc 0.171875: correct 363/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.625, correct fine 40/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.6442307692307693, correct fine 67/104 
fine class 7: fine acc 0.3, correct fine 9/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4545
Overall F1 Score: 0.1683

Training for fine level...
batch 100, loss: 2.7125, instance_loss: 0.3007, weighted_loss: 1.9889, label: 1, bag_size: 439
batch 200, loss: 1.3152, instance_loss: 0.1592, weighted_loss: 0.9684, label: 3, bag_size: 965
batch 300, loss: 0.2386, instance_loss: 0.0599, weighted_loss: 0.1850, label: 6, bag_size: 310
batch 400, loss: 0.7274, instance_loss: 0.1429, weighted_loss: 0.5520, label: 3, bag_size: 496
batch 500, loss: 1.7893, instance_loss: 0.2332, weighted_loss: 1.3225, label: 7, bag_size: 542
batch 600, loss: 0.7630, instance_loss: 0.1562, weighted_loss: 0.5810, label: 3, bag_size: 162
batch 700, loss: 0.3775, instance_loss: 0.1133, weighted_loss: 0.2983, label: 6, bag_size: 585
batch 800, loss: 0.1508, instance_loss: 0.0964, weighted_loss: 0.1345, label: 6, bag_size: 655
batch 900, loss: 0.0436, instance_loss: 0.0228, weighted_loss: 0.0373, label: 6, bag_size: 1257
batch 1000, loss: 1.1326, instance_loss: 0.1251, weighted_loss: 0.8304, label: 6, bag_size: 1068
batch 1100, loss: 0.2516, instance_loss: 0.0831, weighted_loss: 0.2011, label: 3, bag_size: 558
batch 1200, loss: 0.0500, instance_loss: 0.0314, weighted_loss: 0.0444, label: 6, bag_size: 424
batch 1300, loss: 1.1229, instance_loss: 0.1743, weighted_loss: 0.8383, label: 6, bag_size: 3051
batch 1400, loss: 2.0557, instance_loss: 0.2553, weighted_loss: 1.5156, label: 4, bag_size: 406
batch 1500, loss: 0.0667, instance_loss: 0.0466, weighted_loss: 0.0606, label: 6, bag_size: 502
batch 1600, loss: 1.7279, instance_loss: 0.2015, weighted_loss: 1.2700, label: 3, bag_size: 1627
batch 1700, loss: 0.1880, instance_loss: 0.1378, weighted_loss: 0.1730, label: 6, bag_size: 480
batch 1800, loss: 0.5468, instance_loss: 0.1100, weighted_loss: 0.4158, label: 3, bag_size: 313
batch 1900, loss: 1.1916, instance_loss: 0.1438, weighted_loss: 0.8772, label: 6, bag_size: 1744
batch 2000, loss: 1.1784, instance_loss: 0.2286, weighted_loss: 0.8935, label: 3, bag_size: 456
batch 2100, loss: 1.5472, instance_loss: 0.2472, weighted_loss: 1.1572, label: 7, bag_size: 395

Instance Classifier Stats
class 0 clustering acc 0.9972597103357472: correct 242374/243040
class 1 clustering acc 0.20420506912442396: correct 3545/17360

Epoch: 33, train_loss: 1.0184, train_clustering_loss:  0.1551, train_error: 0.3392
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7504835589941973, correct fine 388/517 
fine class 4: fine acc 0.24666666666666667, correct fine 37/150 
fine class 5: fine acc 0.46956521739130436, correct fine 54/115 
fine class 6: fine acc 0.8890214797136038, correct fine 745/838 
fine class 7: fine acc 0.5341365461847389, correct fine 133/249 
fine class 8: fine acc 0.33707865168539325, correct fine 30/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.25757575757575757, correct fine 34/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.038461538461538464, correct fine 1/26 
Overall Accuracy: 0.6608

Val Set, val_loss: 1.5358, val_error: 0.5152, auc: 0.7624
class 0 clustering acc 0.9970576298701299: correct 29481/29568 
class 1 clustering acc 0.18418560606060605: correct 389/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.53125, correct fine 34/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7884615384615384, correct fine 82/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4848
Overall F1 Score: 0.1781

Training for fine level...
batch 100, loss: 0.1089, instance_loss: 0.1135, weighted_loss: 0.1103, label: 6, bag_size: 888
batch 200, loss: 0.1377, instance_loss: 0.0489, weighted_loss: 0.1111, label: 6, bag_size: 607
batch 300, loss: 2.0324, instance_loss: 0.2140, weighted_loss: 1.4869, label: 3, bag_size: 646
batch 400, loss: 1.3909, instance_loss: 0.1606, weighted_loss: 1.0218, label: 6, bag_size: 309
batch 500, loss: 0.1065, instance_loss: 0.1091, weighted_loss: 0.1073, label: 6, bag_size: 228
batch 600, loss: 0.6550, instance_loss: 0.1312, weighted_loss: 0.4979, label: 8, bag_size: 163
batch 700, loss: 0.0344, instance_loss: 0.0309, weighted_loss: 0.0333, label: 6, bag_size: 905
batch 800, loss: 0.1686, instance_loss: 0.1225, weighted_loss: 0.1548, label: 5, bag_size: 758
batch 900, loss: 1.3379, instance_loss: 0.2016, weighted_loss: 0.9970, label: 8, bag_size: 338
batch 1000, loss: 1.6089, instance_loss: 0.1483, weighted_loss: 1.1707, label: 6, bag_size: 290
batch 1100, loss: 0.7097, instance_loss: 0.1136, weighted_loss: 0.5309, label: 3, bag_size: 476
batch 1200, loss: 2.0770, instance_loss: 0.2236, weighted_loss: 1.5210, label: 3, bag_size: 217
batch 1300, loss: 2.3678, instance_loss: 0.3616, weighted_loss: 1.7659, label: 7, bag_size: 337
batch 1400, loss: 1.7380, instance_loss: 0.2627, weighted_loss: 1.2954, label: 13, bag_size: 451
batch 1500, loss: 0.4835, instance_loss: 0.1535, weighted_loss: 0.3845, label: 3, bag_size: 248
batch 1600, loss: 1.0301, instance_loss: 0.1431, weighted_loss: 0.7640, label: 6, bag_size: 677
batch 1700, loss: 0.2574, instance_loss: 0.1073, weighted_loss: 0.2124, label: 6, bag_size: 115
batch 1800, loss: 0.4824, instance_loss: 0.2035, weighted_loss: 0.3987, label: 7, bag_size: 581
batch 1900, loss: 0.5745, instance_loss: 0.1328, weighted_loss: 0.4420, label: 6, bag_size: 249
batch 2000, loss: 0.5823, instance_loss: 0.1200, weighted_loss: 0.4436, label: 3, bag_size: 818
batch 2100, loss: 1.0619, instance_loss: 0.1452, weighted_loss: 0.7869, label: 3, bag_size: 1257

Instance Classifier Stats
class 0 clustering acc 0.9970786701777485: correct 242330/243040
class 1 clustering acc 0.2015552995391705: correct 3499/17360

Epoch: 34, train_loss: 1.0062, train_clustering_loss:  0.1559, train_error: 0.3387
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7446808510638298, correct fine 385/517 
fine class 4: fine acc 0.25333333333333335, correct fine 38/150 
fine class 5: fine acc 0.41739130434782606, correct fine 48/115 
fine class 6: fine acc 0.9009546539379475, correct fine 755/838 
fine class 7: fine acc 0.5100401606425703, correct fine 127/249 
fine class 8: fine acc 0.3707865168539326, correct fine 33/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.26515151515151514, correct fine 35/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.07692307692307693, correct fine 2/26 
Overall Accuracy: 0.6613

Val Set, val_loss: 1.5506, val_error: 0.5265, auc: 0.7585
class 0 clustering acc 0.9967870670995671: correct 29473/29568 
class 1 clustering acc 0.18229166666666666: correct 385/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.75, correct fine 78/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4735
Overall F1 Score: 0.1748

Training for fine level...
batch 100, loss: 0.8784, instance_loss: 0.1616, weighted_loss: 0.6633, label: 6, bag_size: 873
batch 200, loss: 1.8304, instance_loss: 0.1980, weighted_loss: 1.3407, label: 3, bag_size: 646
batch 300, loss: 1.3131, instance_loss: 0.2245, weighted_loss: 0.9865, label: 4, bag_size: 510
batch 400, loss: 0.3938, instance_loss: 0.1352, weighted_loss: 0.3162, label: 5, bag_size: 2272
batch 500, loss: 1.6856, instance_loss: 0.2240, weighted_loss: 1.2471, label: 7, bag_size: 802
batch 600, loss: 1.6614, instance_loss: 0.2186, weighted_loss: 1.2286, label: 1, bag_size: 244
batch 700, loss: 0.9784, instance_loss: 0.2489, weighted_loss: 0.7595, label: 7, bag_size: 375
batch 800, loss: 1.9194, instance_loss: 0.2441, weighted_loss: 1.4168, label: 5, bag_size: 118
batch 900, loss: 0.1513, instance_loss: 0.1748, weighted_loss: 0.1584, label: 6, bag_size: 968
batch 1000, loss: 2.4017, instance_loss: 0.2621, weighted_loss: 1.7599, label: 10, bag_size: 288
batch 1100, loss: 3.2227, instance_loss: 0.2742, weighted_loss: 2.3381, label: 4, bag_size: 1046
batch 1200, loss: 2.3669, instance_loss: 0.1976, weighted_loss: 1.7161, label: 6, bag_size: 477
batch 1300, loss: 0.8813, instance_loss: 0.1754, weighted_loss: 0.6695, label: 3, bag_size: 1049
batch 1400, loss: 1.2774, instance_loss: 0.2064, weighted_loss: 0.9561, label: 3, bag_size: 448
batch 1500, loss: 2.1403, instance_loss: 0.2573, weighted_loss: 1.5754, label: 10, bag_size: 567
batch 1600, loss: 0.0771, instance_loss: 0.0468, weighted_loss: 0.0680, label: 6, bag_size: 607
batch 1700, loss: 1.4252, instance_loss: 0.2864, weighted_loss: 1.0836, label: 3, bag_size: 835
batch 1800, loss: 1.7719, instance_loss: 0.2273, weighted_loss: 1.3086, label: 4, bag_size: 775
batch 1900, loss: 0.4758, instance_loss: 0.1893, weighted_loss: 0.3899, label: 6, bag_size: 621
batch 2000, loss: 0.1425, instance_loss: 0.0730, weighted_loss: 0.1216, label: 3, bag_size: 214
batch 2100, loss: 0.6248, instance_loss: 0.1982, weighted_loss: 0.4968, label: 0, bag_size: 419

Instance Classifier Stats
class 0 clustering acc 0.997053982883476: correct 242324/243040
class 1 clustering acc 0.20449308755760368: correct 3550/17360

Epoch: 35, train_loss: 0.9876, train_clustering_loss:  0.1552, train_error: 0.3258
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.3125, correct fine 10/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7620889748549323, correct fine 394/517 
fine class 4: fine acc 0.24, correct fine 36/150 
fine class 5: fine acc 0.4434782608695652, correct fine 51/115 
fine class 6: fine acc 0.9009546539379475, correct fine 755/838 
fine class 7: fine acc 0.5461847389558233, correct fine 136/249 
fine class 8: fine acc 0.4157303370786517, correct fine 37/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.2803030303030303, correct fine 37/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.07692307692307693, correct fine 2/26 
Overall Accuracy: 0.6742

Val Set, val_loss: 1.5829, val_error: 0.5076, auc: 0.7564
class 0 clustering acc 0.9965165043290043: correct 29465/29568 
class 1 clustering acc 0.19176136363636365: correct 405/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.53125, correct fine 34/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7980769230769231, correct fine 83/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4924
Overall F1 Score: 0.1818

Training for fine level...
batch 100, loss: 0.0434, instance_loss: 0.0266, weighted_loss: 0.0384, label: 6, bag_size: 414
batch 200, loss: 1.4426, instance_loss: 0.2095, weighted_loss: 1.0727, label: 10, bag_size: 212
batch 300, loss: 0.2104, instance_loss: 0.1457, weighted_loss: 0.1910, label: 6, bag_size: 348
batch 400, loss: 1.1221, instance_loss: 0.1765, weighted_loss: 0.8384, label: 10, bag_size: 415
batch 500, loss: 0.8778, instance_loss: 0.1847, weighted_loss: 0.6699, label: 5, bag_size: 2080
batch 600, loss: 0.0451, instance_loss: 0.0708, weighted_loss: 0.0528, label: 6, bag_size: 599
batch 700, loss: 0.5062, instance_loss: 0.1857, weighted_loss: 0.4101, label: 7, bag_size: 171
batch 800, loss: 0.8552, instance_loss: 0.1989, weighted_loss: 0.6583, label: 7, bag_size: 1550
batch 900, loss: 0.0057, instance_loss: 0.0387, weighted_loss: 0.0156, label: 6, bag_size: 338
batch 1000, loss: 0.5740, instance_loss: 0.1283, weighted_loss: 0.4403, label: 3, bag_size: 587
batch 1100, loss: 0.0259, instance_loss: 0.0297, weighted_loss: 0.0271, label: 6, bag_size: 841
batch 1200, loss: 0.0299, instance_loss: 0.0719, weighted_loss: 0.0425, label: 6, bag_size: 359
batch 1300, loss: 0.4865, instance_loss: 0.0935, weighted_loss: 0.3686, label: 3, bag_size: 1762
batch 1400, loss: 1.8992, instance_loss: 0.2169, weighted_loss: 1.3945, label: 10, bag_size: 371
batch 1500, loss: 0.1364, instance_loss: 0.0331, weighted_loss: 0.1054, label: 6, bag_size: 902
batch 1600, loss: 0.4782, instance_loss: 0.1226, weighted_loss: 0.3715, label: 3, bag_size: 692
batch 1700, loss: 0.8492, instance_loss: 0.2341, weighted_loss: 0.6647, label: 4, bag_size: 1642
batch 1800, loss: 0.1436, instance_loss: 0.1504, weighted_loss: 0.1456, label: 7, bag_size: 444
batch 1900, loss: 0.1040, instance_loss: 0.0849, weighted_loss: 0.0983, label: 6, bag_size: 364
batch 2000, loss: 0.4365, instance_loss: 0.1765, weighted_loss: 0.3585, label: 6, bag_size: 224
batch 2100, loss: 4.6232, instance_loss: 0.3228, weighted_loss: 3.3331, label: 10, bag_size: 527

Instance Classifier Stats
class 0 clustering acc 0.9970046082949309: correct 242312/243040
class 1 clustering acc 0.20420506912442396: correct 3545/17360

Epoch: 36, train_loss: 0.9688, train_clustering_loss:  0.1547, train_error: 0.3189
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7620889748549323, correct fine 394/517 
fine class 4: fine acc 0.2733333333333333, correct fine 41/150 
fine class 5: fine acc 0.46956521739130436, correct fine 54/115 
fine class 6: fine acc 0.9093078758949881, correct fine 762/838 
fine class 7: fine acc 0.5742971887550201, correct fine 143/249 
fine class 8: fine acc 0.3707865168539326, correct fine 33/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.2727272727272727, correct fine 36/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.11538461538461539, correct fine 3/26 
Overall Accuracy: 0.6811

Val Set, val_loss: 1.5829, val_error: 0.5644, auc: 0.7501
class 0 clustering acc 0.9974296536796536: correct 29492/29568 
class 1 clustering acc 0.16856060606060605: correct 356/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6346153846153846, correct fine 66/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4356
Overall F1 Score: 0.1672

Training for fine level...
batch 100, loss: 0.4244, instance_loss: 0.1715, weighted_loss: 0.3485, label: 6, bag_size: 40
batch 200, loss: 0.0123, instance_loss: 0.0241, weighted_loss: 0.0158, label: 6, bag_size: 353
batch 300, loss: 0.8827, instance_loss: 0.1431, weighted_loss: 0.6608, label: 6, bag_size: 469
batch 400, loss: 0.8682, instance_loss: 0.1669, weighted_loss: 0.6578, label: 6, bag_size: 113
batch 500, loss: 0.9817, instance_loss: 0.1570, weighted_loss: 0.7343, label: 3, bag_size: 762
batch 600, loss: 0.6294, instance_loss: 0.1592, weighted_loss: 0.4883, label: 6, bag_size: 373
batch 700, loss: 0.0948, instance_loss: 0.0359, weighted_loss: 0.0771, label: 6, bag_size: 1105
batch 800, loss: 1.1793, instance_loss: 0.2389, weighted_loss: 0.8972, label: 8, bag_size: 478
batch 900, loss: 0.5745, instance_loss: 0.0964, weighted_loss: 0.4310, label: 3, bag_size: 936
batch 1000, loss: 0.0299, instance_loss: 0.0743, weighted_loss: 0.0433, label: 6, bag_size: 359
batch 1100, loss: 1.6035, instance_loss: 0.2248, weighted_loss: 1.1899, label: 1, bag_size: 352
batch 1200, loss: 1.3029, instance_loss: 0.2263, weighted_loss: 0.9799, label: 3, bag_size: 320
batch 1300, loss: 1.1291, instance_loss: 0.1747, weighted_loss: 0.8428, label: 7, bag_size: 519
batch 1400, loss: 0.0042, instance_loss: 0.0156, weighted_loss: 0.0076, label: 6, bag_size: 432
batch 1500, loss: 0.2081, instance_loss: 0.0773, weighted_loss: 0.1688, label: 6, bag_size: 368
batch 1600, loss: 0.2301, instance_loss: 0.0791, weighted_loss: 0.1848, label: 3, bag_size: 1234
batch 1700, loss: 2.3812, instance_loss: 0.2328, weighted_loss: 1.7367, label: 5, bag_size: 308
batch 1800, loss: 0.3337, instance_loss: 0.1671, weighted_loss: 0.2838, label: 7, bag_size: 182
batch 1900, loss: 0.5244, instance_loss: 0.1829, weighted_loss: 0.4220, label: 8, bag_size: 149
batch 2000, loss: 0.9505, instance_loss: 0.2195, weighted_loss: 0.7312, label: 4, bag_size: 605
batch 2100, loss: 0.4336, instance_loss: 0.2317, weighted_loss: 0.3730, label: 7, bag_size: 346

Instance Classifier Stats
class 0 clustering acc 0.997160961158657: correct 242350/243040
class 1 clustering acc 0.20529953917050692: correct 3564/17360

Epoch: 37, train_loss: 0.9510, train_clustering_loss:  0.1541, train_error: 0.3147
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.781431334622824, correct fine 404/517 
fine class 4: fine acc 0.28, correct fine 42/150 
fine class 5: fine acc 0.46956521739130436, correct fine 54/115 
fine class 6: fine acc 0.9105011933174224, correct fine 763/838 
fine class 7: fine acc 0.5542168674698795, correct fine 138/249 
fine class 8: fine acc 0.39325842696629215, correct fine 35/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.26515151515151514, correct fine 35/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.11538461538461539, correct fine 3/26 
Overall Accuracy: 0.6853

Val Set, val_loss: 1.5996, val_error: 0.5303, auc: 0.7536
class 0 clustering acc 0.9969899891774892: correct 29479/29568 
class 1 clustering acc 0.17566287878787878: correct 371/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.53125, correct fine 34/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7115384615384616, correct fine 74/104 
fine class 7: fine acc 0.36666666666666664, correct fine 11/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4697
Overall F1 Score: 0.1817

Training for fine level...
batch 100, loss: 0.4012, instance_loss: 0.1356, weighted_loss: 0.3215, label: 5, bag_size: 2272
batch 200, loss: 0.2911, instance_loss: 0.1536, weighted_loss: 0.2498, label: 7, bag_size: 182
batch 300, loss: 0.3463, instance_loss: 0.1362, weighted_loss: 0.2833, label: 3, bag_size: 1516
batch 400, loss: 2.2272, instance_loss: 0.1944, weighted_loss: 1.6173, label: 3, bag_size: 254
batch 500, loss: 0.0159, instance_loss: 0.0308, weighted_loss: 0.0204, label: 6, bag_size: 779
batch 600, loss: 1.9565, instance_loss: 0.2366, weighted_loss: 1.4406, label: 10, bag_size: 531
batch 700, loss: 2.1891, instance_loss: 0.2197, weighted_loss: 1.5983, label: 7, bag_size: 739
batch 800, loss: 2.6364, instance_loss: 0.2342, weighted_loss: 1.9158, label: 10, bag_size: 1105
batch 900, loss: 0.6316, instance_loss: 0.1888, weighted_loss: 0.4988, label: 7, bag_size: 247
batch 1000, loss: 0.2909, instance_loss: 0.1441, weighted_loss: 0.2469, label: 6, bag_size: 108
batch 1100, loss: 0.9121, instance_loss: 0.1623, weighted_loss: 0.6871, label: 7, bag_size: 362
batch 1200, loss: 1.3834, instance_loss: 0.2165, weighted_loss: 1.0333, label: 10, bag_size: 679
batch 1300, loss: 0.6246, instance_loss: 0.1245, weighted_loss: 0.4745, label: 6, bag_size: 2114
batch 1400, loss: 0.0234, instance_loss: 0.0697, weighted_loss: 0.0373, label: 6, bag_size: 377
batch 1500, loss: 0.3499, instance_loss: 0.0821, weighted_loss: 0.2696, label: 3, bag_size: 298
batch 1600, loss: 0.8929, instance_loss: 0.2021, weighted_loss: 0.6857, label: 3, bag_size: 435
batch 1700, loss: 0.4431, instance_loss: 0.0982, weighted_loss: 0.3396, label: 3, bag_size: 1767
batch 1800, loss: 0.8909, instance_loss: 0.2006, weighted_loss: 0.6838, label: 7, bag_size: 464
batch 1900, loss: 0.8960, instance_loss: 0.1175, weighted_loss: 0.6624, label: 6, bag_size: 245
batch 2000, loss: 2.4087, instance_loss: 0.2648, weighted_loss: 1.7655, label: 7, bag_size: 523
batch 2100, loss: 1.4767, instance_loss: 0.1678, weighted_loss: 1.0840, label: 6, bag_size: 233

Instance Classifier Stats
class 0 clustering acc 0.9969470046082949: correct 242298/243040
class 1 clustering acc 0.20558755760368663: correct 3569/17360

Epoch: 38, train_loss: 0.9430, train_clustering_loss:  0.1544, train_error: 0.3134
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7736943907156673, correct fine 400/517 
fine class 4: fine acc 0.25333333333333335, correct fine 38/150 
fine class 5: fine acc 0.46956521739130436, correct fine 54/115 
fine class 6: fine acc 0.9093078758949881, correct fine 762/838 
fine class 7: fine acc 0.5903614457831325, correct fine 147/249 
fine class 8: fine acc 0.4044943820224719, correct fine 36/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.2727272727272727, correct fine 36/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.15384615384615385, correct fine 4/26 
Overall Accuracy: 0.6866

Val Set, val_loss: 1.6044, val_error: 0.5227, auc: 0.7547
class 0 clustering acc 0.9967532467532467: correct 29472/29568 
class 1 clustering acc 0.18797348484848486: correct 397/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.46875, correct fine 30/64 
fine class 4: fine acc 0.1111111111111111, correct fine 2/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7692307692307693, correct fine 80/104 
fine class 7: fine acc 0.3333333333333333, correct fine 10/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4773
Overall F1 Score: 0.1849

Training for fine level...
batch 100, loss: 0.7470, instance_loss: 0.1472, weighted_loss: 0.5671, label: 6, bag_size: 72
batch 200, loss: 0.2487, instance_loss: 0.1264, weighted_loss: 0.2121, label: 3, bag_size: 333
batch 300, loss: 1.2450, instance_loss: 0.2317, weighted_loss: 0.9410, label: 10, bag_size: 541
batch 400, loss: 0.9487, instance_loss: 0.1016, weighted_loss: 0.6945, label: 6, bag_size: 291
batch 500, loss: 2.7833, instance_loss: 0.2207, weighted_loss: 2.0145, label: 7, bag_size: 246
batch 600, loss: 0.3423, instance_loss: 0.1169, weighted_loss: 0.2747, label: 6, bag_size: 322
batch 700, loss: 1.7043, instance_loss: 0.2283, weighted_loss: 1.2615, label: 3, bag_size: 73
batch 800, loss: 0.7345, instance_loss: 0.1693, weighted_loss: 0.5649, label: 3, bag_size: 394
batch 900, loss: 3.9582, instance_loss: 0.3234, weighted_loss: 2.8678, label: 13, bag_size: 574
batch 1000, loss: 1.4034, instance_loss: 0.1914, weighted_loss: 1.0398, label: 10, bag_size: 1555
batch 1100, loss: 0.0090, instance_loss: 0.0128, weighted_loss: 0.0101, label: 6, bag_size: 312
batch 1200, loss: 0.0735, instance_loss: 0.0428, weighted_loss: 0.0643, label: 6, bag_size: 273
batch 1300, loss: 0.0015, instance_loss: 0.0269, weighted_loss: 0.0091, label: 6, bag_size: 338
batch 1400, loss: 0.0523, instance_loss: 0.0882, weighted_loss: 0.0631, label: 6, bag_size: 280
batch 1500, loss: 0.3843, instance_loss: 0.1004, weighted_loss: 0.2992, label: 3, bag_size: 425
batch 1600, loss: 0.0828, instance_loss: 0.0827, weighted_loss: 0.0828, label: 6, bag_size: 123
batch 1700, loss: 0.4675, instance_loss: 0.1781, weighted_loss: 0.3807, label: 7, bag_size: 2023
batch 1800, loss: 1.9104, instance_loss: 0.2565, weighted_loss: 1.4142, label: 4, bag_size: 775
batch 1900, loss: 1.6205, instance_loss: 0.1747, weighted_loss: 1.1868, label: 3, bag_size: 437
batch 2000, loss: 0.8390, instance_loss: 0.1411, weighted_loss: 0.6296, label: 6, bag_size: 795
batch 2100, loss: 0.6858, instance_loss: 0.1176, weighted_loss: 0.5154, label: 3, bag_size: 691

Instance Classifier Stats
class 0 clustering acc 0.9970663265306122: correct 242327/243040
class 1 clustering acc 0.2129032258064516: correct 3696/17360

Epoch: 39, train_loss: 0.9317, train_clustering_loss:  0.1537, train_error: 0.3111
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7543520309477756, correct fine 390/517 
fine class 4: fine acc 0.31333333333333335, correct fine 47/150 
fine class 5: fine acc 0.5043478260869565, correct fine 58/115 
fine class 6: fine acc 0.9152744630071599, correct fine 767/838 
fine class 7: fine acc 0.5783132530120482, correct fine 144/249 
fine class 8: fine acc 0.39325842696629215, correct fine 35/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.2878787878787879, correct fine 38/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.11538461538461539, correct fine 3/26 
Overall Accuracy: 0.6889

Val Set, val_loss: 1.6064, val_error: 0.5455, auc: 0.7557
class 0 clustering acc 0.9962121212121212: correct 29456/29568 
class 1 clustering acc 0.19412878787878787: correct 410/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6826923076923077, correct fine 71/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4545
Overall F1 Score: 0.1721

Training for fine level...
batch 100, loss: 0.0132, instance_loss: 0.0210, weighted_loss: 0.0155, label: 6, bag_size: 699
batch 200, loss: 1.6418, instance_loss: 0.1984, weighted_loss: 1.2088, label: 10, bag_size: 388
batch 300, loss: 0.1062, instance_loss: 0.0640, weighted_loss: 0.0936, label: 3, bag_size: 680
batch 400, loss: 1.6159, instance_loss: 0.2186, weighted_loss: 1.1967, label: 7, bag_size: 304
batch 500, loss: 0.5614, instance_loss: 0.1271, weighted_loss: 0.4311, label: 3, bag_size: 496
batch 600, loss: 0.3951, instance_loss: 0.1327, weighted_loss: 0.3164, label: 6, bag_size: 704
batch 700, loss: 1.1001, instance_loss: 0.1953, weighted_loss: 0.8286, label: 10, bag_size: 229
batch 800, loss: 1.4185, instance_loss: 0.2136, weighted_loss: 1.0570, label: 7, bag_size: 566
batch 900, loss: 0.9106, instance_loss: 0.2125, weighted_loss: 0.7012, label: 4, bag_size: 813
batch 1000, loss: 0.0457, instance_loss: 0.0721, weighted_loss: 0.0536, label: 6, bag_size: 434
batch 1100, loss: 4.2982, instance_loss: 0.3196, weighted_loss: 3.1046, label: 0, bag_size: 313
batch 1200, loss: 0.4854, instance_loss: 0.1648, weighted_loss: 0.3892, label: 8, bag_size: 132
batch 1300, loss: 0.3908, instance_loss: 0.1488, weighted_loss: 0.3182, label: 6, bag_size: 838
batch 1400, loss: 0.0945, instance_loss: 0.1622, weighted_loss: 0.1148, label: 6, bag_size: 40
batch 1500, loss: 0.3163, instance_loss: 0.0809, weighted_loss: 0.2457, label: 3, bag_size: 389
batch 1600, loss: 0.2460, instance_loss: 0.1067, weighted_loss: 0.2042, label: 3, bag_size: 768
batch 1700, loss: 0.7671, instance_loss: 0.2410, weighted_loss: 0.6092, label: 4, bag_size: 3112
batch 1800, loss: 0.2479, instance_loss: 0.0793, weighted_loss: 0.1973, label: 6, bag_size: 345
batch 1900, loss: 2.1656, instance_loss: 0.2584, weighted_loss: 1.5935, label: 1, bag_size: 554
batch 2000, loss: 0.3310, instance_loss: 0.0907, weighted_loss: 0.2589, label: 3, bag_size: 3530
batch 2100, loss: 0.0631, instance_loss: 0.0690, weighted_loss: 0.0649, label: 6, bag_size: 1058

Instance Classifier Stats
class 0 clustering acc 0.996860599078341: correct 242277/243040
class 1 clustering acc 0.21428571428571427: correct 3720/17360

Epoch: 40, train_loss: 0.9121, train_clustering_loss:  0.1540, train_error: 0.2945
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.21875, correct fine 7/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.804642166344294, correct fine 416/517 
fine class 4: fine acc 0.31333333333333335, correct fine 47/150 
fine class 5: fine acc 0.4434782608695652, correct fine 51/115 
fine class 6: fine acc 0.9248210023866349, correct fine 775/838 
fine class 7: fine acc 0.6024096385542169, correct fine 150/249 
fine class 8: fine acc 0.39325842696629215, correct fine 35/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3106060606060606, correct fine 41/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.15384615384615385, correct fine 4/26 
Overall Accuracy: 0.7055

Val Set, val_loss: 1.6522, val_error: 0.5189, auc: 0.7500
class 0 clustering acc 0.9967194264069265: correct 29471/29568 
class 1 clustering acc 0.18229166666666666: correct 385/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.453125, correct fine 29/64 
fine class 4: fine acc 0.1111111111111111, correct fine 2/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7788461538461539, correct fine 81/104 
fine class 7: fine acc 0.36666666666666664, correct fine 11/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4811
Overall F1 Score: 0.1835

Training for fine level...
batch 100, loss: 0.2305, instance_loss: 0.0816, weighted_loss: 0.1858, label: 3, bag_size: 631
batch 200, loss: 0.3482, instance_loss: 0.1103, weighted_loss: 0.2768, label: 6, bag_size: 463
batch 300, loss: 0.4653, instance_loss: 0.2004, weighted_loss: 0.3858, label: 4, bag_size: 685
batch 400, loss: 1.4969, instance_loss: 0.2617, weighted_loss: 1.1264, label: 4, bag_size: 2842
batch 500, loss: 0.2697, instance_loss: 0.2038, weighted_loss: 0.2500, label: 7, bag_size: 330
batch 600, loss: 1.2517, instance_loss: 0.1854, weighted_loss: 0.9318, label: 3, bag_size: 622
batch 700, loss: 1.0999, instance_loss: 0.2098, weighted_loss: 0.8329, label: 7, bag_size: 304
batch 800, loss: 0.2849, instance_loss: 0.1125, weighted_loss: 0.2332, label: 6, bag_size: 1555
batch 900, loss: 0.3911, instance_loss: 0.1059, weighted_loss: 0.3056, label: 3, bag_size: 1279
batch 1000, loss: 0.3361, instance_loss: 0.2358, weighted_loss: 0.3060, label: 7, bag_size: 325
batch 1100, loss: 1.5857, instance_loss: 0.2282, weighted_loss: 1.1784, label: 3, bag_size: 407
batch 1200, loss: 3.3972, instance_loss: 0.3142, weighted_loss: 2.4723, label: 4, bag_size: 1134
batch 1300, loss: 0.6529, instance_loss: 0.1407, weighted_loss: 0.4993, label: 3, bag_size: 605
batch 1400, loss: 1.0626, instance_loss: 0.1639, weighted_loss: 0.7930, label: 3, bag_size: 190
batch 1500, loss: 1.3413, instance_loss: 0.1602, weighted_loss: 0.9870, label: 6, bag_size: 555
batch 1600, loss: 0.1542, instance_loss: 0.1075, weighted_loss: 0.1402, label: 6, bag_size: 270
batch 1700, loss: 0.3652, instance_loss: 0.1162, weighted_loss: 0.2905, label: 6, bag_size: 358
batch 1800, loss: 0.2008, instance_loss: 0.1259, weighted_loss: 0.1783, label: 6, bag_size: 746
batch 1900, loss: 0.2920, instance_loss: 0.0764, weighted_loss: 0.2273, label: 6, bag_size: 706
batch 2000, loss: 2.2330, instance_loss: 0.2072, weighted_loss: 1.6253, label: 10, bag_size: 720
batch 2100, loss: 0.8847, instance_loss: 0.2196, weighted_loss: 0.6852, label: 7, bag_size: 288

Instance Classifier Stats
class 0 clustering acc 0.9970622119815669: correct 242326/243040
class 1 clustering acc 0.21152073732718893: correct 3672/17360

Epoch: 41, train_loss: 0.8982, train_clustering_loss:  0.1532, train_error: 0.2876
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.25, correct fine 8/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7969052224371374, correct fine 412/517 
fine class 4: fine acc 0.37333333333333335, correct fine 56/150 
fine class 5: fine acc 0.4782608695652174, correct fine 55/115 
fine class 6: fine acc 0.9212410501193318, correct fine 772/838 
fine class 7: fine acc 0.606425702811245, correct fine 151/249 
fine class 8: fine acc 0.4157303370786517, correct fine 37/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3333333333333333, correct fine 44/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.23076923076923078, correct fine 6/26 
Overall Accuracy: 0.7124

Val Set, val_loss: 1.6743, val_error: 0.5682, auc: 0.7471
class 0 clustering acc 0.9962121212121212: correct 29456/29568 
class 1 clustering acc 0.1875: correct 396/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.625, correct fine 40/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.14285714285714285, correct fine 2/14 
fine class 6: fine acc 0.6057692307692307, correct fine 63/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4318
Overall F1 Score: 0.1591

Training for fine level...
batch 100, loss: 0.1907, instance_loss: 0.1634, weighted_loss: 0.1825, label: 7, bag_size: 334
batch 200, loss: 1.4166, instance_loss: 0.1771, weighted_loss: 1.0448, label: 3, bag_size: 127
batch 300, loss: 0.0746, instance_loss: 0.0519, weighted_loss: 0.0678, label: 6, bag_size: 505
batch 400, loss: 1.2900, instance_loss: 0.1905, weighted_loss: 0.9601, label: 3, bag_size: 1170
batch 500, loss: 1.8766, instance_loss: 0.1656, weighted_loss: 1.3633, label: 6, bag_size: 113
batch 600, loss: 0.0205, instance_loss: 0.0743, weighted_loss: 0.0366, label: 6, bag_size: 726
batch 700, loss: 0.0995, instance_loss: 0.0846, weighted_loss: 0.0950, label: 3, bag_size: 748
batch 800, loss: 0.0979, instance_loss: 0.1648, weighted_loss: 0.1180, label: 6, bag_size: 770
batch 900, loss: 0.9933, instance_loss: 0.1885, weighted_loss: 0.7518, label: 10, bag_size: 207
batch 1000, loss: 1.3681, instance_loss: 0.1619, weighted_loss: 1.0063, label: 3, bag_size: 541
batch 1100, loss: 2.1327, instance_loss: 0.2139, weighted_loss: 1.5570, label: 6, bag_size: 663
batch 1200, loss: 0.3365, instance_loss: 0.1135, weighted_loss: 0.2696, label: 3, bag_size: 2612
batch 1300, loss: 0.9410, instance_loss: 0.1965, weighted_loss: 0.7176, label: 10, bag_size: 2076
batch 1400, loss: 0.8330, instance_loss: 0.1395, weighted_loss: 0.6249, label: 3, bag_size: 174
batch 1500, loss: 0.0423, instance_loss: 0.0530, weighted_loss: 0.0455, label: 6, bag_size: 387
batch 1600, loss: 0.2228, instance_loss: 0.0722, weighted_loss: 0.1776, label: 3, bag_size: 1231
batch 1700, loss: 0.0057, instance_loss: 0.0177, weighted_loss: 0.0093, label: 6, bag_size: 779
batch 1800, loss: 0.0556, instance_loss: 0.0540, weighted_loss: 0.0551, label: 6, bag_size: 518
batch 1900, loss: 2.0750, instance_loss: 0.2518, weighted_loss: 1.5281, label: 3, bag_size: 123
batch 2000, loss: 0.0015, instance_loss: 0.0282, weighted_loss: 0.0095, label: 6, bag_size: 658
batch 2100, loss: 1.2621, instance_loss: 0.1708, weighted_loss: 0.9347, label: 7, bag_size: 242

Instance Classifier Stats
class 0 clustering acc 0.9970128373930217: correct 242314/243040
class 1 clustering acc 0.21578341013824884: correct 3746/17360

Epoch: 42, train_loss: 0.8805, train_clustering_loss:  0.1529, train_error: 0.2834
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.3125, correct fine 10/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7911025145067698, correct fine 409/517 
fine class 4: fine acc 0.3333333333333333, correct fine 50/150 
fine class 5: fine acc 0.5217391304347826, correct fine 60/115 
fine class 6: fine acc 0.9295942720763724, correct fine 779/838 
fine class 7: fine acc 0.6265060240963856, correct fine 156/249 
fine class 8: fine acc 0.39325842696629215, correct fine 35/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3484848484848485, correct fine 46/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.19230769230769232, correct fine 5/26 
Overall Accuracy: 0.7166

Val Set, val_loss: 1.6645, val_error: 0.5303, auc: 0.7463
class 0 clustering acc 0.9959753787878788: correct 29449/29568 
class 1 clustering acc 0.19318181818181818: correct 408/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7692307692307693, correct fine 80/104 
fine class 7: fine acc 0.06666666666666667, correct fine 2/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4697
Overall F1 Score: 0.1588

Training for fine level...
batch 100, loss: 0.1156, instance_loss: 0.1494, weighted_loss: 0.1257, label: 5, bag_size: 507
batch 200, loss: 0.7033, instance_loss: 0.2158, weighted_loss: 0.5570, label: 1, bag_size: 132
batch 300, loss: 0.2977, instance_loss: 0.1718, weighted_loss: 0.2599, label: 7, bag_size: 1865
batch 400, loss: 1.3001, instance_loss: 0.1988, weighted_loss: 0.9698, label: 3, bag_size: 456
batch 500, loss: 0.1737, instance_loss: 0.0738, weighted_loss: 0.1438, label: 3, bag_size: 1549
batch 600, loss: 0.0258, instance_loss: 0.0741, weighted_loss: 0.0403, label: 6, bag_size: 861
batch 700, loss: 0.0173, instance_loss: 0.0315, weighted_loss: 0.0216, label: 6, bag_size: 658
batch 800, loss: 1.1296, instance_loss: 0.1577, weighted_loss: 0.8380, label: 6, bag_size: 596
batch 900, loss: 0.0354, instance_loss: 0.0385, weighted_loss: 0.0363, label: 6, bag_size: 235
batch 1000, loss: 0.0497, instance_loss: 0.1221, weighted_loss: 0.0715, label: 3, bag_size: 177
batch 1100, loss: 1.7437, instance_loss: 0.2205, weighted_loss: 1.2867, label: 10, bag_size: 313
batch 1200, loss: 0.0026, instance_loss: 0.0180, weighted_loss: 0.0072, label: 6, bag_size: 893
batch 1300, loss: 0.5799, instance_loss: 0.1316, weighted_loss: 0.4454, label: 6, bag_size: 277
batch 1400, loss: 1.2637, instance_loss: 0.2044, weighted_loss: 0.9459, label: 10, bag_size: 679
batch 1500, loss: 0.2759, instance_loss: 0.0840, weighted_loss: 0.2184, label: 3, bag_size: 2239
batch 1600, loss: 0.0628, instance_loss: 0.0309, weighted_loss: 0.0532, label: 6, bag_size: 676
batch 1700, loss: 0.0104, instance_loss: 0.0413, weighted_loss: 0.0197, label: 6, bag_size: 324
batch 1800, loss: 0.1534, instance_loss: 0.0351, weighted_loss: 0.1179, label: 6, bag_size: 97
batch 1900, loss: 0.0810, instance_loss: 0.0868, weighted_loss: 0.0828, label: 5, bag_size: 260
batch 2000, loss: 0.3582, instance_loss: 0.1741, weighted_loss: 0.3029, label: 10, bag_size: 130
batch 2100, loss: 1.1966, instance_loss: 0.2127, weighted_loss: 0.9015, label: 8, bag_size: 417

Instance Classifier Stats
class 0 clustering acc 0.9969099736668862: correct 242289/243040
class 1 clustering acc 0.21203917050691246: correct 3681/17360

Epoch: 43, train_loss: 0.8629, train_clustering_loss:  0.1529, train_error: 0.2797
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7891682785299806, correct fine 408/517 
fine class 4: fine acc 0.34, correct fine 51/150 
fine class 5: fine acc 0.4782608695652174, correct fine 55/115 
fine class 6: fine acc 0.9367541766109785, correct fine 785/838 
fine class 7: fine acc 0.6666666666666666, correct fine 166/249 
fine class 8: fine acc 0.4606741573033708, correct fine 41/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.29545454545454547, correct fine 39/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.15384615384615385, correct fine 4/26 
Overall Accuracy: 0.7203

Val Set, val_loss: 1.6702, val_error: 0.5303, auc: 0.7528
class 0 clustering acc 0.9968208874458875: correct 29474/29568 
class 1 clustering acc 0.18039772727272727: correct 381/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.1111111111111111, correct fine 2/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6923076923076923, correct fine 72/104 
fine class 7: fine acc 0.3, correct fine 9/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4697
Overall F1 Score: 0.1979

Training for fine level...
batch 100, loss: 0.2780, instance_loss: 0.0634, weighted_loss: 0.2136, label: 6, bag_size: 310
batch 200, loss: 0.0011, instance_loss: 0.0366, weighted_loss: 0.0117, label: 6, bag_size: 1364
batch 300, loss: 0.0393, instance_loss: 0.0154, weighted_loss: 0.0321, label: 6, bag_size: 515
batch 400, loss: 0.2315, instance_loss: 0.1293, weighted_loss: 0.2009, label: 3, bag_size: 265
batch 500, loss: 0.0376, instance_loss: 0.2161, weighted_loss: 0.0912, label: 7, bag_size: 247
batch 600, loss: 0.0271, instance_loss: 0.0576, weighted_loss: 0.0363, label: 6, bag_size: 712
batch 700, loss: 0.6545, instance_loss: 0.1778, weighted_loss: 0.5115, label: 7, bag_size: 1655
batch 800, loss: 2.7039, instance_loss: 0.2764, weighted_loss: 1.9757, label: 13, bag_size: 472
batch 900, loss: 0.1535, instance_loss: 0.1504, weighted_loss: 0.1526, label: 6, bag_size: 385
batch 1000, loss: 0.0341, instance_loss: 0.0246, weighted_loss: 0.0313, label: 6, bag_size: 827
batch 1100, loss: 0.0088, instance_loss: 0.0170, weighted_loss: 0.0112, label: 6, bag_size: 1301
batch 1200, loss: 0.0967, instance_loss: 0.1279, weighted_loss: 0.1060, label: 7, bag_size: 521
batch 1300, loss: 0.3111, instance_loss: 0.1147, weighted_loss: 0.2522, label: 5, bag_size: 260
batch 1400, loss: 0.4220, instance_loss: 0.2560, weighted_loss: 0.3722, label: 3, bag_size: 306
batch 1500, loss: 0.1671, instance_loss: 0.0381, weighted_loss: 0.1284, label: 6, bag_size: 359
batch 1600, loss: 1.7084, instance_loss: 0.2392, weighted_loss: 1.2676, label: 3, bag_size: 317
batch 1700, loss: 0.8812, instance_loss: 0.2038, weighted_loss: 0.6779, label: 10, bag_size: 501
batch 1800, loss: 0.2256, instance_loss: 0.0746, weighted_loss: 0.1803, label: 3, bag_size: 2692
batch 1900, loss: 0.0946, instance_loss: 0.0299, weighted_loss: 0.0752, label: 6, bag_size: 331
batch 2000, loss: 0.8354, instance_loss: 0.2014, weighted_loss: 0.6452, label: 8, bag_size: 312
batch 2100, loss: 0.0299, instance_loss: 0.0839, weighted_loss: 0.0461, label: 5, bag_size: 723

Instance Classifier Stats
class 0 clustering acc 0.9969470046082949: correct 242298/243040
class 1 clustering acc 0.21705069124423962: correct 3768/17360

Epoch: 44, train_loss: 0.8518, train_clustering_loss:  0.1523, train_error: 0.2779
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.3125, correct fine 10/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.7794970986460348, correct fine 403/517 
fine class 4: fine acc 0.37333333333333335, correct fine 56/150 
fine class 5: fine acc 0.48695652173913045, correct fine 56/115 
fine class 6: fine acc 0.931980906921241, correct fine 781/838 
fine class 7: fine acc 0.6586345381526104, correct fine 164/249 
fine class 8: fine acc 0.48314606741573035, correct fine 43/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3181818181818182, correct fine 42/132 
fine class 11: fine acc 0.1, correct fine 1/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.23076923076923078, correct fine 6/26 
Overall Accuracy: 0.7221

Val Set, val_loss: 1.6978, val_error: 0.5455, auc: 0.7472
class 0 clustering acc 0.9966179653679653: correct 29468/29568 
class 1 clustering acc 0.18181818181818182: correct 384/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.1111111111111111, correct fine 2/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6923076923076923, correct fine 72/104 
fine class 7: fine acc 0.06666666666666667, correct fine 2/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4545
Overall F1 Score: 0.1688

Training for fine level...
batch 100, loss: 0.3895, instance_loss: 0.1332, weighted_loss: 0.3126, label: 6, bag_size: 355
batch 200, loss: 0.1942, instance_loss: 0.1062, weighted_loss: 0.1678, label: 3, bag_size: 206
batch 300, loss: 1.2204, instance_loss: 0.2565, weighted_loss: 0.9312, label: 4, bag_size: 926
batch 400, loss: 2.5430, instance_loss: 0.2693, weighted_loss: 1.8609, label: 8, bag_size: 435
batch 500, loss: 0.0036, instance_loss: 0.0124, weighted_loss: 0.0062, label: 6, bag_size: 679
batch 600, loss: 0.0242, instance_loss: 0.0344, weighted_loss: 0.0273, label: 6, bag_size: 902
batch 700, loss: 0.7130, instance_loss: 0.1308, weighted_loss: 0.5384, label: 6, bag_size: 332
batch 800, loss: 1.0659, instance_loss: 0.1971, weighted_loss: 0.8052, label: 10, bag_size: 207
batch 900, loss: 0.0900, instance_loss: 0.1723, weighted_loss: 0.1147, label: 4, bag_size: 202
batch 1000, loss: 3.2097, instance_loss: 0.2694, weighted_loss: 2.3276, label: 8, bag_size: 462
batch 1100, loss: 0.2664, instance_loss: 0.0543, weighted_loss: 0.2028, label: 3, bag_size: 3550
batch 1200, loss: 0.0593, instance_loss: 0.0466, weighted_loss: 0.0555, label: 3, bag_size: 873
batch 1300, loss: 1.7031, instance_loss: 0.2073, weighted_loss: 1.2544, label: 10, bag_size: 307
batch 1400, loss: 0.2560, instance_loss: 0.0878, weighted_loss: 0.2055, label: 3, bag_size: 2186
batch 1500, loss: 1.1742, instance_loss: 0.3153, weighted_loss: 0.9165, label: 8, bag_size: 393
batch 1600, loss: 1.2513, instance_loss: 0.2599, weighted_loss: 0.9539, label: 13, bag_size: 481
batch 1700, loss: 1.3144, instance_loss: 0.2270, weighted_loss: 0.9882, label: 10, bag_size: 368
batch 1800, loss: 0.0207, instance_loss: 0.0652, weighted_loss: 0.0341, label: 6, bag_size: 434
batch 1900, loss: 2.6181, instance_loss: 0.2486, weighted_loss: 1.9073, label: 7, bag_size: 497
batch 2000, loss: 0.9494, instance_loss: 0.1801, weighted_loss: 0.7186, label: 3, bag_size: 65
batch 2100, loss: 4.7061, instance_loss: 0.3151, weighted_loss: 3.3888, label: 5, bag_size: 317

Instance Classifier Stats
class 0 clustering acc 0.9969223173140224: correct 242292/243040
class 1 clustering acc 0.21549539170506912: correct 3741/17360

Epoch: 45, train_loss: 0.8414, train_clustering_loss:  0.1522, train_error: 0.2733
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8104448742746615, correct fine 419/517 
fine class 4: fine acc 0.3466666666666667, correct fine 52/150 
fine class 5: fine acc 0.5304347826086957, correct fine 61/115 
fine class 6: fine acc 0.9295942720763724, correct fine 779/838 
fine class 7: fine acc 0.6184738955823293, correct fine 154/249 
fine class 8: fine acc 0.48314606741573035, correct fine 43/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3712121212121212, correct fine 49/132 
fine class 11: fine acc 0.1, correct fine 1/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.19230769230769232, correct fine 5/26 
Overall Accuracy: 0.7267

Val Set, val_loss: 1.7186, val_error: 0.5455, auc: 0.7494
class 0 clustering acc 0.9959077380952381: correct 29447/29568 
class 1 clustering acc 0.19460227272727273: correct 411/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.1111111111111111, correct fine 2/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6730769230769231, correct fine 70/104 
fine class 7: fine acc 0.3, correct fine 9/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4545
Overall F1 Score: 0.1802

Training for fine level...
batch 100, loss: 2.1082, instance_loss: 0.1889, weighted_loss: 1.5324, label: 8, bag_size: 159
batch 200, loss: 0.3118, instance_loss: 0.1864, weighted_loss: 0.2742, label: 6, bag_size: 552
batch 300, loss: 0.5676, instance_loss: 0.1232, weighted_loss: 0.4343, label: 3, bag_size: 1523
batch 400, loss: 4.1209, instance_loss: 0.2619, weighted_loss: 2.9632, label: 8, bag_size: 981
batch 500, loss: 0.8096, instance_loss: 0.1722, weighted_loss: 0.6183, label: 6, bag_size: 359
batch 600, loss: 0.4057, instance_loss: 0.1170, weighted_loss: 0.3191, label: 5, bag_size: 260
batch 700, loss: 1.2917, instance_loss: 0.2642, weighted_loss: 0.9835, label: 8, bag_size: 256
batch 800, loss: 0.3914, instance_loss: 0.2252, weighted_loss: 0.3415, label: 3, bag_size: 540
batch 900, loss: 0.0018, instance_loss: 0.1053, weighted_loss: 0.0329, label: 6, bag_size: 721
batch 1000, loss: 6.0239, instance_loss: 0.3337, weighted_loss: 4.3168, label: 13, bag_size: 625
batch 1100, loss: 0.3346, instance_loss: 0.1413, weighted_loss: 0.2766, label: 3, bag_size: 225
batch 1200, loss: 1.2463, instance_loss: 0.2677, weighted_loss: 0.9527, label: 13, bag_size: 837
batch 1300, loss: 0.7362, instance_loss: 0.1762, weighted_loss: 0.5682, label: 3, bag_size: 84
batch 1400, loss: 0.3491, instance_loss: 0.1892, weighted_loss: 0.3011, label: 10, bag_size: 22
batch 1500, loss: 0.0301, instance_loss: 0.0676, weighted_loss: 0.0414, label: 6, bag_size: 341
batch 1600, loss: 0.3927, instance_loss: 0.1368, weighted_loss: 0.3160, label: 6, bag_size: 223
batch 1700, loss: 0.0460, instance_loss: 0.1608, weighted_loss: 0.0804, label: 6, bag_size: 466
batch 1800, loss: 0.6722, instance_loss: 0.1866, weighted_loss: 0.5265, label: 7, bag_size: 220
batch 1900, loss: 0.1343, instance_loss: 0.0679, weighted_loss: 0.1144, label: 3, bag_size: 1359
batch 2000, loss: 1.0111, instance_loss: 0.2189, weighted_loss: 0.7734, label: 3, bag_size: 823
batch 2100, loss: 0.0368, instance_loss: 0.0400, weighted_loss: 0.0377, label: 6, bag_size: 318

Instance Classifier Stats
class 0 clustering acc 0.9969017445687952: correct 242287/243040
class 1 clustering acc 0.22004608294930875: correct 3820/17360

Epoch: 46, train_loss: 0.8193, train_clustering_loss:  0.1522, train_error: 0.2599
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8239845261121856, correct fine 426/517 
fine class 4: fine acc 0.37333333333333335, correct fine 56/150 
fine class 5: fine acc 0.5304347826086957, correct fine 61/115 
fine class 6: fine acc 0.9284009546539379, correct fine 778/838 
fine class 7: fine acc 0.6867469879518072, correct fine 171/249 
fine class 8: fine acc 0.449438202247191, correct fine 40/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.4015151515151515, correct fine 53/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.2692307692307692, correct fine 7/26 
Overall Accuracy: 0.7401

Val Set, val_loss: 1.7336, val_error: 0.5720, auc: 0.7431
class 0 clustering acc 0.9960430194805194: correct 29451/29568 
class 1 clustering acc 0.1865530303030303: correct 394/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.625, correct fine 40/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.5769230769230769, correct fine 60/104 
fine class 7: fine acc 0.26666666666666666, correct fine 8/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4280
Overall F1 Score: 0.1683

Training for fine level...
batch 100, loss: 1.3547, instance_loss: 0.2164, weighted_loss: 1.0133, label: 8, bag_size: 111
batch 200, loss: 0.1301, instance_loss: 0.1187, weighted_loss: 0.1267, label: 6, bag_size: 217
batch 300, loss: 0.8785, instance_loss: 0.1596, weighted_loss: 0.6628, label: 3, bag_size: 365
batch 400, loss: 1.2376, instance_loss: 0.1684, weighted_loss: 0.9168, label: 3, bag_size: 613
batch 500, loss: 2.2833, instance_loss: 0.2357, weighted_loss: 1.6690, label: 4, bag_size: 248
batch 600, loss: 0.3645, instance_loss: 0.1216, weighted_loss: 0.2916, label: 6, bag_size: 558
batch 700, loss: 0.0638, instance_loss: 0.1038, weighted_loss: 0.0758, label: 6, bag_size: 511
batch 800, loss: 0.6185, instance_loss: 0.2351, weighted_loss: 0.5035, label: 7, bag_size: 600
batch 900, loss: 0.3849, instance_loss: 0.1333, weighted_loss: 0.3094, label: 6, bag_size: 369
batch 1000, loss: 2.7090, instance_loss: 0.2606, weighted_loss: 1.9745, label: 8, bag_size: 435
batch 1100, loss: 0.4315, instance_loss: 0.2296, weighted_loss: 0.3710, label: 7, bag_size: 1248
batch 1200, loss: 0.2233, instance_loss: 0.1192, weighted_loss: 0.1921, label: 3, bag_size: 235
batch 1300, loss: 0.1694, instance_loss: 0.0889, weighted_loss: 0.1453, label: 3, bag_size: 309
batch 1400, loss: 0.3368, instance_loss: 0.1736, weighted_loss: 0.2878, label: 7, bag_size: 344
batch 1500, loss: 1.1108, instance_loss: 0.2086, weighted_loss: 0.8401, label: 10, bag_size: 707
batch 1600, loss: 0.0373, instance_loss: 0.0867, weighted_loss: 0.0521, label: 6, bag_size: 665
batch 1700, loss: 0.0046, instance_loss: 0.0296, weighted_loss: 0.0121, label: 6, bag_size: 555
batch 1800, loss: 1.5013, instance_loss: 0.2525, weighted_loss: 1.1266, label: 4, bag_size: 1138
batch 1900, loss: 0.4527, instance_loss: 0.1515, weighted_loss: 0.3623, label: 5, bag_size: 786
batch 2000, loss: 0.0911, instance_loss: 0.0909, weighted_loss: 0.0910, label: 6, bag_size: 521
batch 2100, loss: 1.2466, instance_loss: 0.1706, weighted_loss: 0.9238, label: 8, bag_size: 431

Instance Classifier Stats
class 0 clustering acc 0.9968852863726135: correct 242283/243040
class 1 clustering acc 0.21682027649769586: correct 3764/17360

Epoch: 47, train_loss: 0.8045, train_clustering_loss:  0.1521, train_error: 0.2571
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.34375, correct fine 11/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8239845261121856, correct fine 426/517 
fine class 4: fine acc 0.4066666666666667, correct fine 61/150 
fine class 5: fine acc 0.4956521739130435, correct fine 57/115 
fine class 6: fine acc 0.9331742243436754, correct fine 782/838 
fine class 7: fine acc 0.6947791164658634, correct fine 173/249 
fine class 8: fine acc 0.4606741573033708, correct fine 41/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3787878787878788, correct fine 50/132 
fine class 11: fine acc 0.0, correct fine 0/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.23076923076923078, correct fine 6/26 
Overall Accuracy: 0.7429

Val Set, val_loss: 1.7289, val_error: 0.5455, auc: 0.7468
class 0 clustering acc 0.9962121212121212: correct 29456/29568 
class 1 clustering acc 0.19602272727272727: correct 414/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.546875, correct fine 35/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6923076923076923, correct fine 72/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.2, correct fine 2/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4545
Overall F1 Score: 0.1762

Training for fine level...
batch 100, loss: 0.7268, instance_loss: 0.1354, weighted_loss: 0.5494, label: 6, bag_size: 562
batch 200, loss: 0.5607, instance_loss: 0.1843, weighted_loss: 0.4478, label: 3, bag_size: 161
batch 300, loss: 0.0803, instance_loss: 0.0384, weighted_loss: 0.0677, label: 6, bag_size: 827
batch 400, loss: 0.3007, instance_loss: 0.0896, weighted_loss: 0.2374, label: 3, bag_size: 1090
batch 500, loss: 0.0272, instance_loss: 0.0619, weighted_loss: 0.0376, label: 6, bag_size: 788
batch 600, loss: 1.5395, instance_loss: 0.2584, weighted_loss: 1.1552, label: 8, bag_size: 945
batch 700, loss: 0.0025, instance_loss: 0.0407, weighted_loss: 0.0140, label: 6, bag_size: 817
batch 800, loss: 2.3632, instance_loss: 0.2308, weighted_loss: 1.7235, label: 10, bag_size: 378
batch 900, loss: 2.2024, instance_loss: 0.2658, weighted_loss: 1.6214, label: 5, bag_size: 793
batch 1000, loss: 1.5964, instance_loss: 0.2177, weighted_loss: 1.1828, label: 10, bag_size: 1555
batch 1100, loss: 0.0625, instance_loss: 0.1211, weighted_loss: 0.0801, label: 6, bag_size: 784
batch 1200, loss: 0.9957, instance_loss: 0.2113, weighted_loss: 0.7604, label: 10, bag_size: 707
batch 1300, loss: 0.4036, instance_loss: 0.1868, weighted_loss: 0.3386, label: 3, bag_size: 1860
batch 1400, loss: 0.6847, instance_loss: 0.1279, weighted_loss: 0.5177, label: 6, bag_size: 596
batch 1500, loss: 1.1428, instance_loss: 0.2317, weighted_loss: 0.8695, label: 4, bag_size: 1404
batch 1600, loss: 1.0742, instance_loss: 0.2043, weighted_loss: 0.8132, label: 10, bag_size: 178
batch 1700, loss: 1.4459, instance_loss: 0.1709, weighted_loss: 1.0634, label: 3, bag_size: 471
batch 1800, loss: 0.0993, instance_loss: 0.1283, weighted_loss: 0.1080, label: 6, bag_size: 867
batch 1900, loss: 0.6637, instance_loss: 0.1182, weighted_loss: 0.5001, label: 6, bag_size: 232
batch 2000, loss: 0.0148, instance_loss: 0.0217, weighted_loss: 0.0169, label: 6, bag_size: 485
batch 2100, loss: 0.0105, instance_loss: 0.0183, weighted_loss: 0.0128, label: 6, bag_size: 455

Instance Classifier Stats
class 0 clustering acc 0.9970210664911126: correct 242316/243040
class 1 clustering acc 0.22091013824884792: correct 3835/17360

Epoch: 48, train_loss: 0.7964, train_clustering_loss:  0.1517, train_error: 0.2585
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.3125, correct fine 10/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8143133462282398, correct fine 421/517 
fine class 4: fine acc 0.38, correct fine 57/150 
fine class 5: fine acc 0.5391304347826087, correct fine 62/115 
fine class 6: fine acc 0.9307875894988067, correct fine 780/838 
fine class 7: fine acc 0.6706827309236948, correct fine 167/249 
fine class 8: fine acc 0.5056179775280899, correct fine 45/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.4166666666666667, correct fine 55/132 
fine class 11: fine acc 0.1, correct fine 1/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.23076923076923078, correct fine 6/26 
Overall Accuracy: 0.7415

Val Set, val_loss: 1.7680, val_error: 0.5379, auc: 0.7468
class 0 clustering acc 0.9962459415584416: correct 29457/29568 
class 1 clustering acc 0.18702651515151514: correct 395/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.609375, correct fine 39/64 
fine class 4: fine acc 0.1111111111111111, correct fine 2/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6442307692307693, correct fine 67/104 
fine class 7: fine acc 0.23333333333333334, correct fine 7/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4621
Overall F1 Score: 0.2036

Training for fine level...
batch 100, loss: 0.3218, instance_loss: 0.1207, weighted_loss: 0.2615, label: 3, bag_size: 1772
batch 200, loss: 1.4866, instance_loss: 0.2014, weighted_loss: 1.1010, label: 10, bag_size: 1555
batch 300, loss: 0.2863, instance_loss: 0.1540, weighted_loss: 0.2466, label: 5, bag_size: 542
batch 400, loss: 1.6305, instance_loss: 0.2465, weighted_loss: 1.2153, label: 4, bag_size: 188
batch 500, loss: 0.1032, instance_loss: 0.1438, weighted_loss: 0.1154, label: 6, bag_size: 12
batch 600, loss: 0.2390, instance_loss: 0.1584, weighted_loss: 0.2148, label: 3, bag_size: 1536
batch 700, loss: 0.4286, instance_loss: 0.1184, weighted_loss: 0.3355, label: 3, bag_size: 224
batch 800, loss: 0.1244, instance_loss: 0.0287, weighted_loss: 0.0957, label: 6, bag_size: 507
batch 900, loss: 0.2075, instance_loss: 0.1160, weighted_loss: 0.1800, label: 6, bag_size: 552
batch 1000, loss: 0.0911, instance_loss: 0.1539, weighted_loss: 0.1100, label: 7, bag_size: 861
batch 1100, loss: 0.2019, instance_loss: 0.1523, weighted_loss: 0.1870, label: 6, bag_size: 378
batch 1200, loss: 0.0288, instance_loss: 0.1201, weighted_loss: 0.0562, label: 6, bag_size: 534
batch 1300, loss: 0.1593, instance_loss: 0.1279, weighted_loss: 0.1499, label: 3, bag_size: 480
batch 1400, loss: 0.9350, instance_loss: 0.1474, weighted_loss: 0.6987, label: 7, bag_size: 242
batch 1500, loss: 1.1746, instance_loss: 0.2061, weighted_loss: 0.8840, label: 5, bag_size: 1147
batch 1600, loss: 0.0180, instance_loss: 0.0790, weighted_loss: 0.0363, label: 6, bag_size: 599
batch 1700, loss: 0.0334, instance_loss: 0.0782, weighted_loss: 0.0468, label: 6, bag_size: 358
batch 1800, loss: 0.0399, instance_loss: 0.0442, weighted_loss: 0.0412, label: 6, bag_size: 273
batch 1900, loss: 0.5120, instance_loss: 0.2201, weighted_loss: 0.4244, label: 4, bag_size: 2069
batch 2000, loss: 1.0577, instance_loss: 0.1977, weighted_loss: 0.7997, label: 3, bag_size: 308
batch 2100, loss: 0.0576, instance_loss: 0.0970, weighted_loss: 0.0694, label: 3, bag_size: 177

Instance Classifier Stats
class 0 clustering acc 0.9969428900592495: correct 242297/243040
class 1 clustering acc 0.2222926267281106: correct 3859/17360

Epoch: 49, train_loss: 0.7797, train_clustering_loss:  0.1512, train_error: 0.2456
fine class 0: fine acc 0.5, correct fine 6/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8181818181818182, correct fine 423/517 
fine class 4: fine acc 0.4533333333333333, correct fine 68/150 
fine class 5: fine acc 0.5478260869565217, correct fine 63/115 
fine class 6: fine acc 0.9391408114558473, correct fine 787/838 
fine class 7: fine acc 0.6987951807228916, correct fine 174/249 
fine class 8: fine acc 0.5168539325842697, correct fine 46/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.38636363636363635, correct fine 51/132 
fine class 11: fine acc 0.2, correct fine 2/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.3076923076923077, correct fine 8/26 
Overall Accuracy: 0.7544

Val Set, val_loss: 1.7712, val_error: 0.5530, auc: 0.7429
class 0 clustering acc 0.9960430194805194: correct 29451/29568 
class 1 clustering acc 0.19886363636363635: correct 420/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.59375, correct fine 38/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6826923076923077, correct fine 71/104 
fine class 7: fine acc 0.13333333333333333, correct fine 4/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4470
Overall F1 Score: 0.1576

Training for fine level...
batch 100, loss: 0.0956, instance_loss: 0.0912, weighted_loss: 0.0943, label: 6, bag_size: 376
batch 200, loss: 1.5541, instance_loss: 0.2495, weighted_loss: 1.1627, label: 8, bag_size: 269
batch 300, loss: 1.7182, instance_loss: 0.2334, weighted_loss: 1.2728, label: 10, bag_size: 435
batch 400, loss: 1.7776, instance_loss: 0.2155, weighted_loss: 1.3090, label: 7, bag_size: 614
batch 500, loss: 0.1529, instance_loss: 0.0369, weighted_loss: 0.1181, label: 6, bag_size: 761
batch 600, loss: 0.4644, instance_loss: 0.1553, weighted_loss: 0.3717, label: 6, bag_size: 480
batch 700, loss: 1.0283, instance_loss: 0.2104, weighted_loss: 0.7829, label: 10, bag_size: 178
batch 800, loss: 0.0635, instance_loss: 0.1042, weighted_loss: 0.0757, label: 6, bag_size: 253
batch 900, loss: 1.2824, instance_loss: 0.1814, weighted_loss: 0.9521, label: 5, bag_size: 904
batch 1000, loss: 2.0407, instance_loss: 0.1732, weighted_loss: 1.4805, label: 6, bag_size: 353
batch 1100, loss: 0.0003, instance_loss: 0.0323, weighted_loss: 0.0099, label: 6, bag_size: 185
batch 1200, loss: 1.0912, instance_loss: 0.2278, weighted_loss: 0.8322, label: 10, bag_size: 563
batch 1300, loss: 0.3302, instance_loss: 0.2042, weighted_loss: 0.2924, label: 3, bag_size: 228
batch 1400, loss: 0.0150, instance_loss: 0.0321, weighted_loss: 0.0201, label: 6, bag_size: 2402
batch 1500, loss: 1.0135, instance_loss: 0.1309, weighted_loss: 0.7487, label: 3, bag_size: 1918
batch 1600, loss: 0.0612, instance_loss: 0.0759, weighted_loss: 0.0656, label: 3, bag_size: 673
batch 1700, loss: 0.6147, instance_loss: 0.2060, weighted_loss: 0.4921, label: 4, bag_size: 836
batch 1800, loss: 0.0028, instance_loss: 0.1131, weighted_loss: 0.0359, label: 6, bag_size: 396
batch 1900, loss: 1.3715, instance_loss: 0.2424, weighted_loss: 1.0327, label: 3, bag_size: 764
batch 2000, loss: 7.5615, instance_loss: 0.5577, weighted_loss: 5.4603, label: 4, bag_size: 477
batch 2100, loss: 0.1295, instance_loss: 0.1252, weighted_loss: 0.1282, label: 5, bag_size: 454

Instance Classifier Stats
class 0 clustering acc 0.9969470046082949: correct 242298/243040
class 1 clustering acc 0.22119815668202766: correct 3840/17360

Epoch: 50, train_loss: 0.7651, train_clustering_loss:  0.1514, train_error: 0.2452
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.28125, correct fine 9/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8297872340425532, correct fine 429/517 
fine class 4: fine acc 0.3933333333333333, correct fine 59/150 
fine class 5: fine acc 0.5565217391304348, correct fine 64/115 
fine class 6: fine acc 0.9439140811455847, correct fine 791/838 
fine class 7: fine acc 0.6867469879518072, correct fine 171/249 
fine class 8: fine acc 0.5056179775280899, correct fine 45/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.4166666666666667, correct fine 55/132 
fine class 11: fine acc 0.3, correct fine 3/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.2692307692307692, correct fine 7/26 
Overall Accuracy: 0.7548

Val Set, val_loss: 1.7891, val_error: 0.5455, auc: 0.7395
class 0 clustering acc 0.9956709956709957: correct 29440/29568 
class 1 clustering acc 0.19886363636363635: correct 420/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.7307692307692307, correct fine 76/104 
fine class 7: fine acc 0.1, correct fine 3/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4545
Overall F1 Score: 0.1547

Training for fine level...
batch 100, loss: 0.4455, instance_loss: 0.1989, weighted_loss: 0.3715, label: 6, bag_size: 154
batch 200, loss: 1.8856, instance_loss: 0.3084, weighted_loss: 1.4124, label: 13, bag_size: 310
batch 300, loss: 0.9879, instance_loss: 0.1863, weighted_loss: 0.7475, label: 3, bag_size: 592
batch 400, loss: 0.0834, instance_loss: 0.1107, weighted_loss: 0.0916, label: 6, bag_size: 352
batch 500, loss: 0.0707, instance_loss: 0.1168, weighted_loss: 0.0845, label: 6, bag_size: 814
batch 600, loss: 0.0401, instance_loss: 0.1665, weighted_loss: 0.0780, label: 7, bag_size: 629
batch 700, loss: 5.1306, instance_loss: 0.3547, weighted_loss: 3.6979, label: 5, bag_size: 402
batch 800, loss: 0.4061, instance_loss: 0.1213, weighted_loss: 0.3206, label: 6, bag_size: 290
batch 900, loss: 0.8230, instance_loss: 0.1528, weighted_loss: 0.6219, label: 6, bag_size: 1678
batch 1000, loss: 0.6983, instance_loss: 0.1498, weighted_loss: 0.5338, label: 3, bag_size: 1084
batch 1100, loss: 0.0339, instance_loss: 0.0713, weighted_loss: 0.0451, label: 6, bag_size: 436
batch 1200, loss: 0.7836, instance_loss: 0.3084, weighted_loss: 0.6410, label: 7, bag_size: 1239
batch 1300, loss: 0.2040, instance_loss: 0.1019, weighted_loss: 0.1733, label: 3, bag_size: 1110
batch 1400, loss: 0.3702, instance_loss: 0.1138, weighted_loss: 0.2933, label: 6, bag_size: 311
batch 1500, loss: 0.1463, instance_loss: 0.1131, weighted_loss: 0.1363, label: 7, bag_size: 453
batch 1600, loss: 0.3306, instance_loss: 0.1432, weighted_loss: 0.2744, label: 3, bag_size: 2019
batch 1700, loss: 0.9224, instance_loss: 0.1446, weighted_loss: 0.6891, label: 3, bag_size: 84
batch 1800, loss: 0.6185, instance_loss: 0.1259, weighted_loss: 0.4707, label: 3, bag_size: 2433
batch 1900, loss: 1.7651, instance_loss: 0.1977, weighted_loss: 1.2949, label: 3, bag_size: 170
batch 2000, loss: 2.1493, instance_loss: 0.2097, weighted_loss: 1.5675, label: 10, bag_size: 615
batch 2100, loss: 0.5266, instance_loss: 0.2053, weighted_loss: 0.4302, label: 3, bag_size: 250

Instance Classifier Stats
class 0 clustering acc 0.9967165898617512: correct 242242/243040
class 1 clustering acc 0.2220622119815668: correct 3855/17360

Epoch: 51, train_loss: 0.7439, train_clustering_loss:  0.1514, train_error: 0.2258
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.375, correct fine 12/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8491295938104448, correct fine 439/517 
fine class 4: fine acc 0.44666666666666666, correct fine 67/150 
fine class 5: fine acc 0.5826086956521739, correct fine 67/115 
fine class 6: fine acc 0.9522673031026253, correct fine 798/838 
fine class 7: fine acc 0.7108433734939759, correct fine 177/249 
fine class 8: fine acc 0.5617977528089888, correct fine 50/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.4166666666666667, correct fine 55/132 
fine class 11: fine acc 0.2, correct fine 2/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.3076923076923077, correct fine 8/26 
Overall Accuracy: 0.7742

Val Set, val_loss: 1.7878, val_error: 0.5644, auc: 0.7447
class 0 clustering acc 0.9963812229437229: correct 29461/29568 
class 1 clustering acc 0.18087121212121213: correct 382/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.5625, correct fine 36/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6442307692307693, correct fine 67/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.1, correct fine 1/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0625, correct fine 1/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4356
Overall F1 Score: 0.1657

Training for fine level...
batch 100, loss: 1.0601, instance_loss: 0.1917, weighted_loss: 0.7995, label: 1, bag_size: 352
batch 200, loss: 0.5820, instance_loss: 0.2088, weighted_loss: 0.4700, label: 4, bag_size: 160
batch 300, loss: 1.1276, instance_loss: 0.1933, weighted_loss: 0.8473, label: 3, bag_size: 764
batch 400, loss: 0.6064, instance_loss: 0.1093, weighted_loss: 0.4573, label: 3, bag_size: 496
batch 500, loss: 0.6392, instance_loss: 0.2114, weighted_loss: 0.5109, label: 4, bag_size: 2537
batch 600, loss: 1.4385, instance_loss: 0.1904, weighted_loss: 1.0641, label: 7, bag_size: 608
batch 700, loss: 0.8074, instance_loss: 0.1625, weighted_loss: 0.6139, label: 6, bag_size: 1364
batch 800, loss: 2.2590, instance_loss: 0.2516, weighted_loss: 1.6568, label: 8, bag_size: 435
batch 900, loss: 0.0061, instance_loss: 0.0769, weighted_loss: 0.0274, label: 6, bag_size: 624
batch 1000, loss: 1.7834, instance_loss: 0.2324, weighted_loss: 1.3181, label: 4, bag_size: 567
batch 1100, loss: 0.6558, instance_loss: 0.1613, weighted_loss: 0.5075, label: 3, bag_size: 641
batch 1200, loss: 0.0609, instance_loss: 0.0720, weighted_loss: 0.0642, label: 3, bag_size: 680
batch 1300, loss: 0.0347, instance_loss: 0.0744, weighted_loss: 0.0466, label: 6, bag_size: 194
batch 1400, loss: 0.1105, instance_loss: 0.0613, weighted_loss: 0.0957, label: 3, bag_size: 1075
batch 1500, loss: 0.1058, instance_loss: 0.0919, weighted_loss: 0.1016, label: 3, bag_size: 1767
batch 1600, loss: 0.2432, instance_loss: 0.1116, weighted_loss: 0.2037, label: 6, bag_size: 1564
batch 1700, loss: 0.0015, instance_loss: 0.0320, weighted_loss: 0.0107, label: 6, bag_size: 483
batch 1800, loss: 0.0064, instance_loss: 0.0655, weighted_loss: 0.0241, label: 6, bag_size: 597
batch 1900, loss: 1.7678, instance_loss: 0.2253, weighted_loss: 1.3050, label: 10, bag_size: 79
batch 2000, loss: 1.4452, instance_loss: 0.2215, weighted_loss: 1.0781, label: 10, bag_size: 486
batch 2100, loss: 1.1799, instance_loss: 0.2075, weighted_loss: 0.8882, label: 3, bag_size: 399

Instance Classifier Stats
class 0 clustering acc 0.9969305464121132: correct 242294/243040
class 1 clustering acc 0.2216589861751152: correct 3848/17360

Epoch: 52, train_loss: 0.7363, train_clustering_loss:  0.1513, train_error: 0.2290
fine class 0: fine acc 0.4166666666666667, correct fine 5/12 
fine class 1: fine acc 0.40625, correct fine 13/32 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.8317214700193424, correct fine 430/517 
fine class 4: fine acc 0.4533333333333333, correct fine 68/150 
fine class 5: fine acc 0.6, correct fine 69/115 
fine class 6: fine acc 0.951073985680191, correct fine 797/838 
fine class 7: fine acc 0.7389558232931727, correct fine 184/249 
fine class 8: fine acc 0.5280898876404494, correct fine 47/89 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.3787878787878788, correct fine 50/132 
fine class 11: fine acc 0.3, correct fine 3/10 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.2692307692307692, correct fine 7/26 
Overall Accuracy: 0.7710

Val Set, val_loss: 1.7972, val_error: 0.5455, auc: 0.7451
class 0 clustering acc 0.9958062770562771: correct 29444/29568 
class 1 clustering acc 0.19365530303030304: correct 409/2112 
fine class 0: fine acc 0.0, correct fine 0/1 
fine class 1: fine acc 0.0, correct fine 0/3 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc 0.578125, correct fine 37/64 
fine class 4: fine acc 0.05555555555555555, correct fine 1/18 
fine class 5: fine acc 0.21428571428571427, correct fine 3/14 
fine class 6: fine acc 0.6730769230769231, correct fine 70/104 
fine class 7: fine acc 0.2, correct fine 6/30 
fine class 8: fine acc 0.3, correct fine 3/10 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc 0.0, correct fine 0/16 
fine class 11: fine acc 0.0, correct fine 0/1 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc 0.0, correct fine 0/3 
Overall Accuracy: 0.4545
Overall F1 Score: 0.1846

Val error: 0.0000, ROC AUC: 0.5000
Test error: 0.0000, ROC AUC: 0.5000
fine class 0: fine acc None, correct fine 0/0 
fine class 1: fine acc None, correct fine 0/0 
fine class 2: fine acc None, correct fine 0/0 
fine class 3: fine acc None, correct fine 0/0 
fine class 4: fine acc None, correct fine 0/0 
fine class 5: fine acc None, correct fine 0/0 
fine class 6: fine acc 1.0, correct fine 1/1 
fine class 7: fine acc None, correct fine 0/0 
fine class 8: fine acc None, correct fine 0/0 
fine class 9: fine acc None, correct fine 0/0 
fine class 10: fine acc None, correct fine 0/0 
fine class 11: fine acc None, correct fine 0/0 
fine class 12: fine acc None, correct fine 0/0 
fine class 13: fine acc None, correct fine 0/0 
