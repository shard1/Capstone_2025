/home/user/anaconda3/envs/engdesign/bin/python /home/user/lib/Capstone_2025/train_clam.py 
/home/user/anaconda3/envs/engdesign/lib/python3.13/site-packages/torch/cuda/__init__.py:129: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 804: forward compatibility was attempted on non supported HW (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() > 0
Preparing data...

Training on 2170 samples

Validation on 264 samples

Test on 264 samples


Preparing model...

Setting tau to 1.0
Setting tau to 1.0
Setting tau to 1.0
Setting tau to 1.0
Done

Setting optimizer...
Done

Training for coarse level...

batch 99, loss: 0.3028, instance_loss: 0.3583, weighted_loss: 0.3195, label: 2, bag_size: 330 

batch 199, loss: 0.3811, instance_loss: 0.3172, weighted_loss: 0.3620, label: 2, bag_size: 541 

batch 299, loss: 0.2491, instance_loss: 0.2308, weighted_loss: 0.2436, label: 1, bag_size: 831 

batch 399, loss: 0.5363, instance_loss: 0.5290, weighted_loss: 0.5341, label: 2, bag_size: 311 

batch 499, loss: 0.8009, instance_loss: 0.5858, weighted_loss: 0.7364, label: 1, bag_size: 149 

batch 599, loss: 0.6911, instance_loss: 0.2468, weighted_loss: 0.5578, label: 2, bag_size: 345 

batch 699, loss: 0.0383, instance_loss: 0.0603, weighted_loss: 0.0449, label: 2, bag_size: 651 

batch 799, loss: 0.3920, instance_loss: 0.2853, weighted_loss: 0.3600, label: 2, bag_size: 861 

batch 899, loss: 1.3071, instance_loss: 0.5794, weighted_loss: 1.0888, label: 1, bag_size: 433 

batch 999, loss: 1.7306, instance_loss: 0.6695, weighted_loss: 1.4123, label: 3, bag_size: 278 

batch 1099, loss: 0.0466, instance_loss: 0.0600, weighted_loss: 0.0506, label: 2, bag_size: 246 

batch 1199, loss: 1.4858, instance_loss: 0.7199, weighted_loss: 1.2560, label: 1, bag_size: 347 

batch 1299, loss: 1.2265, instance_loss: 0.8322, weighted_loss: 1.1082, label: 2, bag_size: 658 

batch 1399, loss: 0.1944, instance_loss: 0.2857, weighted_loss: 0.2218, label: 2, bag_size: 1048 

batch 1499, loss: 0.6657, instance_loss: 0.3451, weighted_loss: 0.5695, label: 2, bag_size: 850 

batch 1599, loss: 1.2796, instance_loss: 0.6560, weighted_loss: 1.0925, label: 1, bag_size: 308 

batch 1699, loss: 0.0644, instance_loss: 0.1688, weighted_loss: 0.0957, label: 2, bag_size: 293 

batch 1799, loss: 0.0576, instance_loss: 0.1746, weighted_loss: 0.0927, label: 1, bag_size: 490 

batch 1899, loss: 0.3119, instance_loss: 0.2390, weighted_loss: 0.2900, label: 1, bag_size: 1172 

batch 1999, loss: 0.6450, instance_loss: 0.3628, weighted_loss: 0.5604, label: 2, bag_size: 449 

batch 2099, loss: 1.5385, instance_loss: 0.7370, weighted_loss: 1.2981, label: 1, bag_size: 622 

Instance Classifier Stats

class 0 clustering acc 0.9825604838709677: correct 68229/69440

class 1 clustering acc 0.33565668202764976: correct 5827/17360


Epoch: 0, train_loss: 0.8651, train_clustering_loss:  0.4445

class 0: acc 0.0, correct 0/44 

class 1: acc 0.5652173913043478, correct 442/782 

class 2: acc 0.8390064397424103, correct 912/1087 

class 3: acc 0.08949416342412451, correct 23/257 


Val Set, val_loss: 0.7733, auc: 0.7755 

class 0 clustering acc 0.98828125: correct 8349/8448 

class 1 clustering acc 0.3939393939393939: correct 832/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.59375, correct 57/96 

class 2: acc 0.835820895522388, correct 112/134 

class 3: acc 0.3, correct 9/30 

Overall Accuracy: 0.6742

Overall F1 Score: 0.4419

Training for coarse level...

batch 99, loss: 0.0227, instance_loss: 0.0393, weighted_loss: 0.0277, label: 2, bag_size: 488 

batch 199, loss: 0.7207, instance_loss: 0.3520, weighted_loss: 0.6101, label: 2, bag_size: 654 

batch 299, loss: 1.4852, instance_loss: 0.9275, weighted_loss: 1.3179, label: 0, bag_size: 1736 

batch 399, loss: 0.2486, instance_loss: 0.1361, weighted_loss: 0.2149, label: 2, bag_size: 1586 

batch 499, loss: 0.4155, instance_loss: 0.3321, weighted_loss: 0.3905, label: 1, bag_size: 1293 

batch 599, loss: 0.4802, instance_loss: 0.3286, weighted_loss: 0.4347, label: 2, bag_size: 436 

batch 699, loss: 1.1619, instance_loss: 0.6407, weighted_loss: 1.0056, label: 3, bag_size: 239 

batch 799, loss: 0.7091, instance_loss: 0.3896, weighted_loss: 0.6133, label: 2, bag_size: 756 

batch 899, loss: 0.4841, instance_loss: 0.3721, weighted_loss: 0.4505, label: 1, bag_size: 1256 

batch 999, loss: 1.1027, instance_loss: 0.6440, weighted_loss: 0.9650, label: 1, bag_size: 415 

batch 1099, loss: 0.0834, instance_loss: 0.0855, weighted_loss: 0.0840, label: 2, bag_size: 874 

batch 1199, loss: 0.8783, instance_loss: 0.4531, weighted_loss: 0.7507, label: 2, bag_size: 347 

batch 1299, loss: 0.9208, instance_loss: 0.6419, weighted_loss: 0.8371, label: 1, bag_size: 762 

batch 1399, loss: 1.1757, instance_loss: 0.6404, weighted_loss: 1.0151, label: 1, bag_size: 187 

batch 1499, loss: 0.0854, instance_loss: 0.1263, weighted_loss: 0.0977, label: 1, bag_size: 2239 

batch 1599, loss: 0.0554, instance_loss: 0.1038, weighted_loss: 0.0699, label: 2, bag_size: 1064 

batch 1699, loss: 0.0189, instance_loss: 0.0216, weighted_loss: 0.0197, label: 2, bag_size: 448 

batch 1799, loss: 1.0572, instance_loss: 0.5107, weighted_loss: 0.8933, label: 2, bag_size: 225 

batch 1899, loss: 1.6370, instance_loss: 0.7307, weighted_loss: 1.3651, label: 3, bag_size: 581 

batch 1999, loss: 0.3970, instance_loss: 0.4607, weighted_loss: 0.4161, label: 1, bag_size: 1860 

batch 2099, loss: 1.3230, instance_loss: 0.5628, weighted_loss: 1.0950, label: 1, bag_size: 298 

Instance Classifier Stats

class 0 clustering acc 0.9832373271889401: correct 68276/69440

class 1 clustering acc 0.3837557603686636: correct 6662/17360


Epoch: 1, train_loss: 0.7945, train_clustering_loss:  0.4161

class 0: acc 0.0, correct 0/44 

class 1: acc 0.5907928388746803, correct 462/782 

class 2: acc 0.874885004599816, correct 951/1087 

class 3: acc 0.05058365758754864, correct 13/257 


Val Set, val_loss: 0.7816, auc: 0.7716 

class 0 clustering acc 0.974905303030303: correct 8236/8448 

class 1 clustering acc 0.4649621212121212: correct 982/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.5729166666666666, correct 55/96 

class 2: acc 0.835820895522388, correct 112/134 

class 3: acc 0.4666666666666667, correct 14/30 

Overall Accuracy: 0.6856

Overall F1 Score: 0.4710

Training for coarse level...

batch 99, loss: 0.2392, instance_loss: 0.2395, weighted_loss: 0.2393, label: 1, bag_size: 567 

batch 199, loss: 0.9022, instance_loss: 0.4373, weighted_loss: 0.7628, label: 2, bag_size: 317 

batch 299, loss: 1.0751, instance_loss: 0.5487, weighted_loss: 0.9172, label: 1, bag_size: 381 

batch 399, loss: 0.1319, instance_loss: 0.1056, weighted_loss: 0.1240, label: 1, bag_size: 981 

batch 499, loss: 1.5677, instance_loss: 0.5787, weighted_loss: 1.2710, label: 1, bag_size: 389 

batch 599, loss: 1.2614, instance_loss: 0.9878, weighted_loss: 1.1793, label: 3, bag_size: 829 

batch 699, loss: 0.0600, instance_loss: 0.0546, weighted_loss: 0.0584, label: 2, bag_size: 217 

batch 799, loss: 1.1659, instance_loss: 0.5610, weighted_loss: 0.9844, label: 1, bag_size: 365 

batch 899, loss: 1.4082, instance_loss: 0.6141, weighted_loss: 1.1699, label: 1, bag_size: 851 

batch 999, loss: 0.0549, instance_loss: 0.0842, weighted_loss: 0.0637, label: 2, bag_size: 353 

batch 1099, loss: 0.6381, instance_loss: 0.3429, weighted_loss: 0.5495, label: 2, bag_size: 129 

batch 1199, loss: 0.2537, instance_loss: 0.1574, weighted_loss: 0.2248, label: 2, bag_size: 449 

batch 1299, loss: 0.2622, instance_loss: 0.1295, weighted_loss: 0.2224, label: 1, bag_size: 2056 

batch 1399, loss: 1.0490, instance_loss: 0.4608, weighted_loss: 0.8725, label: 2, bag_size: 847 

batch 1499, loss: 0.6046, instance_loss: 0.3565, weighted_loss: 0.5302, label: 1, bag_size: 354 

batch 1599, loss: 0.3211, instance_loss: 0.2274, weighted_loss: 0.2930, label: 1, bag_size: 725 

batch 1699, loss: 0.0314, instance_loss: 0.0701, weighted_loss: 0.0430, label: 2, bag_size: 364 

batch 1799, loss: 2.2879, instance_loss: 0.8542, weighted_loss: 1.8578, label: 2, bag_size: 506 

batch 1899, loss: 0.0936, instance_loss: 0.0429, weighted_loss: 0.0784, label: 1, bag_size: 1867 

batch 1999, loss: 0.4420, instance_loss: 0.4008, weighted_loss: 0.4296, label: 2, bag_size: 350 

batch 2099, loss: 4.6552, instance_loss: 1.2164, weighted_loss: 3.6235, label: 0, bag_size: 1452 

Instance Classifier Stats

class 0 clustering acc 0.9828052995391705: correct 68246/69440

class 1 clustering acc 0.3980414746543779: correct 6910/17360


Epoch: 2, train_loss: 0.7628, train_clustering_loss:  0.4085

class 0: acc 0.045454545454545456, correct 2/44 

class 1: acc 0.5882352941176471, correct 460/782 

class 2: acc 0.8629254829806807, correct 938/1087 

class 3: acc 0.15953307392996108, correct 41/257 


Val Set, val_loss: 0.8041, auc: 0.7610 

class 0 clustering acc 0.986032196969697: correct 8330/8448 

class 1 clustering acc 0.4043560606060606: correct 854/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.59375, correct 57/96 

class 2: acc 0.8880597014925373, correct 119/134 

class 3: acc 0.13333333333333333, correct 4/30 

Overall Accuracy: 0.6818

Overall F1 Score: 0.4124

Training for coarse level...

batch 99, loss: 0.0078, instance_loss: 0.0091, weighted_loss: 0.0082, label: 1, bag_size: 260 

batch 199, loss: 1.8969, instance_loss: 0.6858, weighted_loss: 1.5336, label: 0, bag_size: 37 

batch 299, loss: 0.0355, instance_loss: 0.0426, weighted_loss: 0.0376, label: 1, bag_size: 1767 

batch 399, loss: 0.0108, instance_loss: 0.0223, weighted_loss: 0.0143, label: 2, bag_size: 743 

batch 499, loss: 1.8697, instance_loss: 0.6936, weighted_loss: 1.5169, label: 3, bag_size: 249 

batch 599, loss: 0.3553, instance_loss: 0.3590, weighted_loss: 0.3564, label: 1, bag_size: 1114 

batch 699, loss: 2.4286, instance_loss: 0.8886, weighted_loss: 1.9666, label: 0, bag_size: 207 

batch 799, loss: 0.0892, instance_loss: 0.1347, weighted_loss: 0.1029, label: 1, bag_size: 1522 

batch 899, loss: 0.7515, instance_loss: 0.5598, weighted_loss: 0.6940, label: 1, bag_size: 792 

batch 999, loss: 0.3128, instance_loss: 0.1904, weighted_loss: 0.2761, label: 2, bag_size: 661 

batch 1099, loss: 0.2213, instance_loss: 0.2090, weighted_loss: 0.2177, label: 2, bag_size: 1364 

batch 1199, loss: 0.2997, instance_loss: 0.2732, weighted_loss: 0.2918, label: 2, bag_size: 249 

batch 1299, loss: 0.0269, instance_loss: 0.0747, weighted_loss: 0.0412, label: 1, bag_size: 826 

batch 1399, loss: 0.0265, instance_loss: 0.1007, weighted_loss: 0.0488, label: 2, bag_size: 667 

batch 1499, loss: 0.0046, instance_loss: 0.0383, weighted_loss: 0.0147, label: 2, bag_size: 686 

batch 1599, loss: 0.0790, instance_loss: 0.0582, weighted_loss: 0.0727, label: 1, bag_size: 1867 

batch 1699, loss: 0.0134, instance_loss: 0.0442, weighted_loss: 0.0226, label: 2, bag_size: 956 

batch 1799, loss: 1.0738, instance_loss: 0.4900, weighted_loss: 0.8986, label: 2, bag_size: 125 

batch 1899, loss: 2.1605, instance_loss: 0.9721, weighted_loss: 1.8040, label: 1, bag_size: 360 

batch 1999, loss: 0.8505, instance_loss: 0.5175, weighted_loss: 0.7506, label: 2, bag_size: 235 

batch 2099, loss: 1.3486, instance_loss: 0.5535, weighted_loss: 1.1100, label: 2, bag_size: 1149 

Instance Classifier Stats

class 0 clustering acc 0.9851382488479262: correct 68408/69440

class 1 clustering acc 0.40420506912442394: correct 7017/17360


Epoch: 3, train_loss: 0.7209, train_clustering_loss:  0.3990

class 0: acc 0.13636363636363635, correct 6/44 

class 1: acc 0.6445012787723785, correct 504/782 

class 2: acc 0.8666053357865685, correct 942/1087 

class 3: acc 0.17120622568093385, correct 44/257 


Val Set, val_loss: 0.9130, auc: 0.7691 

class 0 clustering acc 0.9841382575757576: correct 8314/8448 

class 1 clustering acc 0.32859848484848486: correct 694/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.90625, correct 87/96 

class 2: acc 0.48507462686567165, correct 65/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.5985

Overall F1 Score: 0.3873

Training for coarse level...

batch 99, loss: 0.9683, instance_loss: 0.5979, weighted_loss: 0.8572, label: 1, bag_size: 517 

batch 199, loss: 0.7238, instance_loss: 0.2952, weighted_loss: 0.5952, label: 2, bag_size: 1422 

batch 299, loss: 0.0377, instance_loss: 0.0702, weighted_loss: 0.0475, label: 2, bag_size: 835 

batch 399, loss: 0.7018, instance_loss: 0.4343, weighted_loss: 0.6215, label: 2, bag_size: 1004 

batch 499, loss: 0.0430, instance_loss: 0.0285, weighted_loss: 0.0387, label: 1, bag_size: 2186 

batch 599, loss: 0.0423, instance_loss: 0.1142, weighted_loss: 0.0639, label: 2, bag_size: 517 

batch 699, loss: 0.1315, instance_loss: 0.3710, weighted_loss: 0.2033, label: 1, bag_size: 177 

batch 799, loss: 2.3669, instance_loss: 1.4204, weighted_loss: 2.0829, label: 1, bag_size: 234 

batch 899, loss: 0.1073, instance_loss: 0.1684, weighted_loss: 0.1256, label: 1, bag_size: 1087 

batch 999, loss: 3.9517, instance_loss: 2.0717, weighted_loss: 3.3877, label: 3, bag_size: 1875 

batch 1099, loss: 0.0060, instance_loss: 0.1245, weighted_loss: 0.0415, label: 2, bag_size: 342 

batch 1199, loss: 0.3954, instance_loss: 0.4821, weighted_loss: 0.4214, label: 2, bag_size: 565 

batch 1299, loss: 0.6159, instance_loss: 0.5000, weighted_loss: 0.5811, label: 2, bag_size: 344 

batch 1399, loss: 1.0968, instance_loss: 0.4423, weighted_loss: 0.9004, label: 2, bag_size: 243 

batch 1499, loss: 1.2060, instance_loss: 0.6675, weighted_loss: 1.0445, label: 1, bag_size: 348 

batch 1599, loss: 0.3277, instance_loss: 0.6543, weighted_loss: 0.4257, label: 2, bag_size: 1796 

batch 1699, loss: 1.3940, instance_loss: 0.8289, weighted_loss: 1.2245, label: 1, bag_size: 1667 

batch 1799, loss: 1.6641, instance_loss: 0.6344, weighted_loss: 1.3552, label: 2, bag_size: 276 

batch 1899, loss: 0.5579, instance_loss: 0.2794, weighted_loss: 0.4744, label: 2, bag_size: 770 

batch 1999, loss: 0.0110, instance_loss: 0.0332, weighted_loss: 0.0177, label: 2, bag_size: 312 

batch 2099, loss: 0.0434, instance_loss: 0.0450, weighted_loss: 0.0439, label: 2, bag_size: 365 

Instance Classifier Stats

class 0 clustering acc 0.9853974654377881: correct 68426/69440

class 1 clustering acc 0.4051267281105991: correct 7033/17360


Epoch: 4, train_loss: 0.6738, train_clustering_loss:  0.3936

class 0: acc 0.29545454545454547, correct 13/44 

class 1: acc 0.6982097186700768, correct 546/782 

class 2: acc 0.8518859245630175, correct 926/1087 

class 3: acc 0.26848249027237353, correct 69/257 


Val Set, val_loss: 0.7756, auc: 0.7917 

class 0 clustering acc 0.9849668560606061: correct 8321/8448 

class 1 clustering acc 0.39820075757575757: correct 841/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.5729166666666666, correct 55/96 

class 2: acc 0.8955223880597015, correct 120/134 

class 3: acc 0.13333333333333333, correct 4/30 

Overall Accuracy: 0.6780

Overall F1 Score: 0.4075

Training for coarse level...

batch 99, loss: 1.5224, instance_loss: 0.6195, weighted_loss: 1.2515, label: 1, bag_size: 696 

batch 199, loss: 0.0029, instance_loss: 0.0272, weighted_loss: 0.0102, label: 2, bag_size: 463 

batch 299, loss: 0.4683, instance_loss: 0.4840, weighted_loss: 0.4730, label: 3, bag_size: 149 

batch 399, loss: 0.2354, instance_loss: 0.2915, weighted_loss: 0.2522, label: 2, bag_size: 461 

batch 499, loss: 0.1951, instance_loss: 0.1169, weighted_loss: 0.1717, label: 1, bag_size: 988 

batch 599, loss: 0.1197, instance_loss: 0.1916, weighted_loss: 0.1413, label: 2, bag_size: 795 

batch 699, loss: 0.0097, instance_loss: 0.1082, weighted_loss: 0.0392, label: 1, bag_size: 700 

batch 799, loss: 0.9103, instance_loss: 0.5203, weighted_loss: 0.7933, label: 2, bag_size: 232 

batch 899, loss: 0.9948, instance_loss: 0.3409, weighted_loss: 0.7986, label: 2, bag_size: 367 

batch 999, loss: 0.8886, instance_loss: 0.6335, weighted_loss: 0.8121, label: 3, bag_size: 490 

batch 1099, loss: 1.5763, instance_loss: 0.7000, weighted_loss: 1.3134, label: 1, bag_size: 262 

batch 1199, loss: 0.3033, instance_loss: 0.2516, weighted_loss: 0.2878, label: 2, bag_size: 302 

batch 1299, loss: 0.2749, instance_loss: 0.4389, weighted_loss: 0.3241, label: 3, bag_size: 1274 

batch 1399, loss: 0.5734, instance_loss: 0.4956, weighted_loss: 0.5500, label: 2, bag_size: 310 

batch 1499, loss: 0.0618, instance_loss: 0.1147, weighted_loss: 0.0776, label: 2, bag_size: 1110 

batch 1599, loss: 0.8605, instance_loss: 0.7699, weighted_loss: 0.8333, label: 0, bag_size: 482 

batch 1699, loss: 0.0414, instance_loss: 0.0849, weighted_loss: 0.0544, label: 1, bag_size: 3332 

batch 1799, loss: 2.1832, instance_loss: 0.7007, weighted_loss: 1.7385, label: 2, bag_size: 853 

batch 1899, loss: 0.0049, instance_loss: 0.0183, weighted_loss: 0.0089, label: 2, bag_size: 318 

batch 1999, loss: 0.0106, instance_loss: 0.0690, weighted_loss: 0.0281, label: 2, bag_size: 632 

batch 2099, loss: 0.1873, instance_loss: 0.2906, weighted_loss: 0.2183, label: 2, bag_size: 380 

Instance Classifier Stats

class 0 clustering acc 0.9861031105990783: correct 68475/69440

class 1 clustering acc 0.41826036866359445: correct 7261/17360


Epoch: 5, train_loss: 0.6149, train_clustering_loss:  0.3846

class 0: acc 0.3409090909090909, correct 15/44 

class 1: acc 0.7186700767263428, correct 562/782 

class 2: acc 0.8666053357865685, correct 942/1087 

class 3: acc 0.32684824902723736, correct 84/257 


Val Set, val_loss: 0.8670, auc: 0.7641 

class 0 clustering acc 0.9810606060606061: correct 8288/8448 

class 1 clustering acc 0.40672348484848486: correct 859/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.7291666666666666, correct 70/96 

class 2: acc 0.7388059701492538, correct 99/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6667

Overall F1 Score: 0.4293

Training for coarse level...

batch 99, loss: 0.0635, instance_loss: 0.1842, weighted_loss: 0.0997, label: 1, bag_size: 1667 

batch 199, loss: 0.8119, instance_loss: 0.4174, weighted_loss: 0.6936, label: 2, bag_size: 472 

batch 299, loss: 2.3020, instance_loss: 0.9440, weighted_loss: 1.8946, label: 1, bag_size: 657 

batch 399, loss: 0.1662, instance_loss: 0.2452, weighted_loss: 0.1899, label: 2, bag_size: 954 

batch 499, loss: 0.0221, instance_loss: 0.0648, weighted_loss: 0.0349, label: 2, bag_size: 265 

batch 599, loss: 0.0466, instance_loss: 0.0448, weighted_loss: 0.0460, label: 1, bag_size: 633 

batch 699, loss: 0.0044, instance_loss: 0.0669, weighted_loss: 0.0232, label: 2, bag_size: 502 

batch 799, loss: 0.0062, instance_loss: 0.0546, weighted_loss: 0.0207, label: 2, bag_size: 304 

batch 899, loss: 1.0800, instance_loss: 0.6414, weighted_loss: 0.9484, label: 3, bag_size: 105 

batch 999, loss: 0.0715, instance_loss: 0.1781, weighted_loss: 0.1035, label: 2, bag_size: 335 

batch 1099, loss: 0.1685, instance_loss: 0.3873, weighted_loss: 0.2341, label: 2, bag_size: 174 

batch 1199, loss: 0.0028, instance_loss: 0.0403, weighted_loss: 0.0140, label: 1, bag_size: 631 

batch 1299, loss: 0.0758, instance_loss: 0.3672, weighted_loss: 0.1632, label: 2, bag_size: 252 

batch 1399, loss: 0.5086, instance_loss: 0.4558, weighted_loss: 0.4928, label: 2, bag_size: 1426 

batch 1499, loss: 2.6167, instance_loss: 1.5412, weighted_loss: 2.2941, label: 2, bag_size: 1331 

batch 1599, loss: 2.3319, instance_loss: 0.7307, weighted_loss: 1.8516, label: 1, bag_size: 179 

batch 1699, loss: 0.0084, instance_loss: 0.0462, weighted_loss: 0.0197, label: 2, bag_size: 679 

batch 1799, loss: 0.0268, instance_loss: 0.1056, weighted_loss: 0.0504, label: 2, bag_size: 887 

batch 1899, loss: 1.7250, instance_loss: 0.8009, weighted_loss: 1.4478, label: 3, bag_size: 79 

batch 1999, loss: 0.0598, instance_loss: 0.0905, weighted_loss: 0.0690, label: 2, bag_size: 544 

batch 2099, loss: 0.0114, instance_loss: 0.1154, weighted_loss: 0.0426, label: 2, bag_size: 409 

Instance Classifier Stats

class 0 clustering acc 0.9859302995391706: correct 68463/69440

class 1 clustering acc 0.433294930875576: correct 7522/17360


Epoch: 6, train_loss: 0.5444, train_clustering_loss:  0.3769

class 0: acc 0.45454545454545453, correct 20/44 

class 1: acc 0.7838874680306905, correct 613/782 

class 2: acc 0.8730450781968722, correct 949/1087 

class 3: acc 0.41245136186770426, correct 106/257 


Val Set, val_loss: 0.8247, auc: 0.7912 

class 0 clustering acc 0.9790482954545454: correct 8271/8448 

class 1 clustering acc 0.40388257575757575: correct 853/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6666666666666666, correct 64/96 

class 2: acc 0.8582089552238806, correct 115/134 

class 3: acc 0.1, correct 3/30 

Overall Accuracy: 0.6894

Overall F1 Score: 0.4047

Training for coarse level...

batch 99, loss: 1.4551, instance_loss: 0.7443, weighted_loss: 1.2419, label: 1, bag_size: 168 

batch 199, loss: 0.2043, instance_loss: 0.4907, weighted_loss: 0.2902, label: 1, bag_size: 473 

batch 299, loss: 0.1724, instance_loss: 0.5317, weighted_loss: 0.2802, label: 2, bag_size: 563 

batch 399, loss: 0.4680, instance_loss: 0.5685, weighted_loss: 0.4981, label: 1, bag_size: 356 

batch 499, loss: 0.3184, instance_loss: 0.5149, weighted_loss: 0.3773, label: 2, bag_size: 325 

batch 599, loss: 1.8738, instance_loss: 0.6012, weighted_loss: 1.4920, label: 1, bag_size: 347 

batch 699, loss: 1.7185, instance_loss: 0.7125, weighted_loss: 1.4167, label: 3, bag_size: 483 

batch 799, loss: 0.1084, instance_loss: 0.3396, weighted_loss: 0.1778, label: 1, bag_size: 663 

batch 899, loss: 0.0398, instance_loss: 0.5181, weighted_loss: 0.1833, label: 2, bag_size: 276 

batch 999, loss: 0.2884, instance_loss: 0.5032, weighted_loss: 0.3528, label: 1, bag_size: 344 

batch 1099, loss: 0.6439, instance_loss: 0.3803, weighted_loss: 0.5648, label: 2, bag_size: 294 

batch 1199, loss: 1.2857, instance_loss: 0.7300, weighted_loss: 1.1190, label: 3, bag_size: 481 

batch 1299, loss: 0.1573, instance_loss: 0.3062, weighted_loss: 0.2020, label: 2, bag_size: 422 

batch 1399, loss: 0.0069, instance_loss: 0.0328, weighted_loss: 0.0146, label: 1, bag_size: 724 

batch 1499, loss: 0.0169, instance_loss: 0.0646, weighted_loss: 0.0312, label: 1, bag_size: 1460 

batch 1599, loss: 0.0113, instance_loss: 0.0868, weighted_loss: 0.0340, label: 1, bag_size: 889 

batch 1699, loss: 0.0106, instance_loss: 0.0365, weighted_loss: 0.0184, label: 2, bag_size: 359 

batch 1799, loss: 0.0029, instance_loss: 0.0846, weighted_loss: 0.0274, label: 1, bag_size: 182 

batch 1899, loss: 0.8175, instance_loss: 0.4504, weighted_loss: 0.7074, label: 2, bag_size: 129 

batch 1999, loss: 0.1681, instance_loss: 0.4743, weighted_loss: 0.2600, label: 0, bag_size: 129 

batch 2099, loss: 0.0309, instance_loss: 0.0715, weighted_loss: 0.0431, label: 2, bag_size: 334 

Instance Classifier Stats

class 0 clustering acc 0.9866215437788018: correct 68511/69440

class 1 clustering acc 0.4475806451612903: correct 7770/17360


Epoch: 7, train_loss: 0.4599, train_clustering_loss:  0.3648

class 0: acc 0.5909090909090909, correct 26/44 

class 1: acc 0.8069053708439897, correct 631/782 

class 2: acc 0.8932842686292548, correct 971/1087 

class 3: acc 0.4980544747081712, correct 128/257 


Val Set, val_loss: 0.9157, auc: 0.7760 

class 0 clustering acc 0.9775094696969697: correct 8258/8448 

class 1 clustering acc 0.44365530303030304: correct 937/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6770833333333334, correct 65/96 

class 2: acc 0.8283582089552238, correct 111/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6894

Overall F1 Score: 0.4309

Training for coarse level...

batch 99, loss: 0.0273, instance_loss: 0.3750, weighted_loss: 0.1316, label: 1, bag_size: 1616 

batch 199, loss: 0.0045, instance_loss: 0.2992, weighted_loss: 0.0929, label: 2, bag_size: 290 

batch 299, loss: 0.2251, instance_loss: 0.3560, weighted_loss: 0.2644, label: 1, bag_size: 592 

batch 399, loss: 0.1653, instance_loss: 0.2446, weighted_loss: 0.1891, label: 2, bag_size: 732 

batch 499, loss: 0.0326, instance_loss: 0.1839, weighted_loss: 0.0780, label: 2, bag_size: 229 

batch 599, loss: 0.6844, instance_loss: 0.5212, weighted_loss: 0.6355, label: 2, bag_size: 635 

batch 699, loss: 0.0424, instance_loss: 0.1482, weighted_loss: 0.0741, label: 1, bag_size: 1803 

batch 799, loss: 0.1678, instance_loss: 0.7672, weighted_loss: 0.3476, label: 0, bag_size: 258 

batch 899, loss: 0.6071, instance_loss: 0.5536, weighted_loss: 0.5911, label: 1, bag_size: 621 

batch 999, loss: 0.0031, instance_loss: 0.0451, weighted_loss: 0.0157, label: 1, bag_size: 2086 

batch 1099, loss: 0.0428, instance_loss: 0.0972, weighted_loss: 0.0592, label: 2, bag_size: 905 

batch 1199, loss: 2.8018, instance_loss: 0.8313, weighted_loss: 2.2106, label: 3, bag_size: 435 

batch 1299, loss: 0.0903, instance_loss: 0.1845, weighted_loss: 0.1186, label: 1, bag_size: 1739 

batch 1399, loss: 0.0509, instance_loss: 0.5462, weighted_loss: 0.1995, label: 2, bag_size: 405 

batch 1499, loss: 0.0005, instance_loss: 0.0389, weighted_loss: 0.0120, label: 2, bag_size: 1161 

batch 1599, loss: 0.1232, instance_loss: 0.1772, weighted_loss: 0.1394, label: 1, bag_size: 1067 

batch 1699, loss: 0.0002, instance_loss: 0.1189, weighted_loss: 0.0358, label: 1, bag_size: 1460 

batch 1799, loss: 0.9402, instance_loss: 0.5598, weighted_loss: 0.8260, label: 2, bag_size: 708 

batch 1899, loss: 0.0316, instance_loss: 0.2555, weighted_loss: 0.0988, label: 1, bag_size: 774 

batch 1999, loss: 0.0011, instance_loss: 0.0315, weighted_loss: 0.0102, label: 1, bag_size: 542 

batch 2099, loss: 0.3116, instance_loss: 0.3820, weighted_loss: 0.3327, label: 2, bag_size: 124 

Instance Classifier Stats

class 0 clustering acc 0.9850086405529954: correct 68399/69440

class 1 clustering acc 0.46434331797235023: correct 8061/17360


Epoch: 8, train_loss: 0.3754, train_clustering_loss:  0.3577

class 0: acc 0.5909090909090909, correct 26/44 

class 1: acc 0.8516624040920716, correct 666/782 

class 2: acc 0.9153633854645814, correct 995/1087 

class 3: acc 0.6070038910505836, correct 156/257 


Val Set, val_loss: 1.0976, auc: 0.7583 

class 0 clustering acc 0.9778645833333334: correct 8261/8448 

class 1 clustering acc 0.4275568181818182: correct 903/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6979166666666666, correct 67/96 

class 2: acc 0.753731343283582, correct 101/134 

class 3: acc 0.13333333333333333, correct 4/30 

Overall Accuracy: 0.6515

Overall F1 Score: 0.3977

Training for coarse level...

batch 99, loss: 0.2541, instance_loss: 0.5227, weighted_loss: 0.3347, label: 3, bag_size: 661 

batch 199, loss: 0.4031, instance_loss: 0.2473, weighted_loss: 0.3563, label: 2, bag_size: 492 

batch 299, loss: 0.0038, instance_loss: 0.8111, weighted_loss: 0.2460, label: 1, bag_size: 472 

batch 399, loss: 0.0920, instance_loss: 0.2948, weighted_loss: 0.1529, label: 2, bag_size: 253 

batch 499, loss: 0.0128, instance_loss: 0.0318, weighted_loss: 0.0185, label: 1, bag_size: 762 

batch 599, loss: 0.0001, instance_loss: 0.0305, weighted_loss: 0.0092, label: 1, bag_size: 333 

batch 699, loss: 0.0002, instance_loss: 0.0260, weighted_loss: 0.0079, label: 2, bag_size: 456 

batch 799, loss: 0.0037, instance_loss: 0.0513, weighted_loss: 0.0180, label: 1, bag_size: 484 

batch 899, loss: 0.6821, instance_loss: 0.6656, weighted_loss: 0.6772, label: 1, bag_size: 224 

batch 999, loss: 0.0093, instance_loss: 0.4924, weighted_loss: 0.1542, label: 1, bag_size: 50 

batch 1099, loss: 0.6678, instance_loss: 0.3429, weighted_loss: 0.5703, label: 2, bag_size: 339 

batch 1199, loss: 0.0327, instance_loss: 0.2305, weighted_loss: 0.0920, label: 2, bag_size: 743 

batch 1299, loss: 0.0011, instance_loss: 0.1097, weighted_loss: 0.0337, label: 1, bag_size: 1313 

batch 1399, loss: 0.0419, instance_loss: 0.1147, weighted_loss: 0.0637, label: 2, bag_size: 202 

batch 1499, loss: 0.0173, instance_loss: 0.0934, weighted_loss: 0.0401, label: 1, bag_size: 755 

batch 1599, loss: 0.2048, instance_loss: 0.4122, weighted_loss: 0.2670, label: 3, bag_size: 152 

batch 1699, loss: 0.0026, instance_loss: 0.0743, weighted_loss: 0.0241, label: 2, bag_size: 875 

batch 1799, loss: 1.4237, instance_loss: 1.7209, weighted_loss: 1.5129, label: 3, bag_size: 328 

batch 1899, loss: 0.1443, instance_loss: 0.4283, weighted_loss: 0.2295, label: 1, bag_size: 851 

batch 1999, loss: 0.0313, instance_loss: 0.3831, weighted_loss: 0.1368, label: 3, bag_size: 619 

batch 2099, loss: 0.3342, instance_loss: 0.5705, weighted_loss: 0.4051, label: 1, bag_size: 454 

Instance Classifier Stats

class 0 clustering acc 0.9855270737327189: correct 68435/69440

class 1 clustering acc 0.4773041474654378: correct 8286/17360


Epoch: 9, train_loss: 0.3006, train_clustering_loss:  0.3500

class 0: acc 0.7045454545454546, correct 31/44 

class 1: acc 0.8785166240409207, correct 687/782 

class 2: acc 0.9291628334866605, correct 1010/1087 

class 3: acc 0.688715953307393, correct 177/257 


Val Set, val_loss: 1.0976, auc: 0.7543 

class 0 clustering acc 0.9707623106060606: correct 8201/8448 

class 1 clustering acc 0.4460227272727273: correct 942/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6979166666666666, correct 67/96 

class 2: acc 0.7089552238805971, correct 95/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6402

Overall F1 Score: 0.4113

Training for coarse level...

batch 99, loss: 0.9236, instance_loss: 0.4646, weighted_loss: 0.7859, label: 2, bag_size: 595 

batch 199, loss: 0.0482, instance_loss: 0.2756, weighted_loss: 0.1164, label: 2, bag_size: 206 

batch 299, loss: 0.0608, instance_loss: 0.2569, weighted_loss: 0.1196, label: 2, bag_size: 309 

batch 399, loss: 0.2786, instance_loss: 0.5361, weighted_loss: 0.3558, label: 1, bag_size: 193 

batch 499, loss: 0.0203, instance_loss: 0.1389, weighted_loss: 0.0559, label: 1, bag_size: 873 

batch 599, loss: 0.2426, instance_loss: 0.7680, weighted_loss: 0.4002, label: 1, bag_size: 167 

batch 699, loss: 0.0003, instance_loss: 0.0307, weighted_loss: 0.0094, label: 1, bag_size: 758 

batch 799, loss: 0.2417, instance_loss: 0.7365, weighted_loss: 0.3902, label: 1, bag_size: 191 

batch 899, loss: 0.1886, instance_loss: 0.3033, weighted_loss: 0.2230, label: 2, bag_size: 1049 

batch 999, loss: 0.0376, instance_loss: 0.2860, weighted_loss: 0.1121, label: 2, bag_size: 364 

batch 1099, loss: 0.0024, instance_loss: 0.1166, weighted_loss: 0.0367, label: 2, bag_size: 706 

batch 1199, loss: 0.0380, instance_loss: 0.1305, weighted_loss: 0.0658, label: 1, bag_size: 1211 

batch 1299, loss: 0.8059, instance_loss: 0.5864, weighted_loss: 0.7401, label: 1, bag_size: 242 

batch 1399, loss: 0.3479, instance_loss: 0.7050, weighted_loss: 0.4550, label: 1, bag_size: 435 

batch 1499, loss: 0.0083, instance_loss: 0.1309, weighted_loss: 0.0451, label: 2, bag_size: 834 

batch 1599, loss: 0.0064, instance_loss: 0.0229, weighted_loss: 0.0113, label: 2, bag_size: 210 

batch 1699, loss: 0.0395, instance_loss: 0.0565, weighted_loss: 0.0446, label: 1, bag_size: 2627 

batch 1799, loss: 0.1142, instance_loss: 0.6617, weighted_loss: 0.2785, label: 1, bag_size: 309 

batch 1899, loss: 0.0931, instance_loss: 0.3225, weighted_loss: 0.1619, label: 1, bag_size: 84 

batch 1999, loss: 0.0001, instance_loss: 0.0085, weighted_loss: 0.0026, label: 2, bag_size: 414 

batch 2099, loss: 0.0460, instance_loss: 0.3588, weighted_loss: 0.1399, label: 2, bag_size: 259 

Instance Classifier Stats

class 0 clustering acc 0.9845622119815668: correct 68368/69440

class 1 clustering acc 0.49326036866359446: correct 8563/17360


Epoch: 10, train_loss: 0.2358, train_clustering_loss:  0.3441

class 0: acc 0.8181818181818182, correct 36/44 

class 1: acc 0.9181585677749361, correct 718/782 

class 2: acc 0.9475620975160993, correct 1030/1087 

class 3: acc 0.77431906614786, correct 199/257 


Val Set, val_loss: 1.2557, auc: 0.7224 

class 0 clustering acc 0.9778645833333334: correct 8261/8448 

class 1 clustering acc 0.4090909090909091: correct 864/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.59375, correct 57/96 

class 2: acc 0.7910447761194029, correct 106/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6439

Overall F1 Score: 0.4094

Training for coarse level...

batch 99, loss: 0.0080, instance_loss: 0.3277, weighted_loss: 0.1039, label: 2, bag_size: 533 

batch 199, loss: 0.0001, instance_loss: 0.0062, weighted_loss: 0.0020, label: 2, bag_size: 1044 

batch 299, loss: 2.6510, instance_loss: 0.7690, weighted_loss: 2.0864, label: 3, bag_size: 345 

batch 399, loss: 0.5227, instance_loss: 0.7127, weighted_loss: 0.5797, label: 1, bag_size: 115 

batch 499, loss: 0.4863, instance_loss: 0.3825, weighted_loss: 0.4552, label: 2, bag_size: 833 

batch 599, loss: 0.0834, instance_loss: 0.1937, weighted_loss: 0.1165, label: 1, bag_size: 1150 

batch 699, loss: 0.0252, instance_loss: 0.2301, weighted_loss: 0.0867, label: 1, bag_size: 1767 

batch 799, loss: 1.2495, instance_loss: 0.8721, weighted_loss: 1.1363, label: 2, bag_size: 444 

batch 899, loss: 0.0093, instance_loss: 0.7496, weighted_loss: 0.2314, label: 1, bag_size: 127 

batch 999, loss: 0.4800, instance_loss: 0.4312, weighted_loss: 0.4654, label: 2, bag_size: 655 

batch 1099, loss: 0.0293, instance_loss: 0.2202, weighted_loss: 0.0866, label: 2, bag_size: 466 

batch 1199, loss: 0.0935, instance_loss: 0.1021, weighted_loss: 0.0961, label: 2, bag_size: 113 

batch 1299, loss: 2.6239, instance_loss: 2.0348, weighted_loss: 2.4472, label: 3, bag_size: 1009 

batch 1399, loss: 0.0528, instance_loss: 0.5482, weighted_loss: 0.2014, label: 1, bag_size: 675 

batch 1499, loss: 0.2667, instance_loss: 0.7132, weighted_loss: 0.4007, label: 1, bag_size: 57 

batch 1599, loss: 0.0045, instance_loss: 0.1167, weighted_loss: 0.0381, label: 2, bag_size: 515 

batch 1699, loss: 0.0085, instance_loss: 0.3515, weighted_loss: 0.1114, label: 2, bag_size: 482 

batch 1799, loss: 0.0023, instance_loss: 0.1609, weighted_loss: 0.0499, label: 1, bag_size: 1973 

batch 1899, loss: 0.0019, instance_loss: 0.1559, weighted_loss: 0.0481, label: 1, bag_size: 235 

batch 1999, loss: 0.0043, instance_loss: 0.1243, weighted_loss: 0.0403, label: 2, bag_size: 280 

batch 2099, loss: 0.0109, instance_loss: 0.4788, weighted_loss: 0.1513, label: 1, bag_size: 287 

Instance Classifier Stats

class 0 clustering acc 0.9843029953917051: correct 68350/69440

class 1 clustering acc 0.5046082949308756: correct 8760/17360


Epoch: 11, train_loss: 0.1930, train_clustering_loss:  0.3376

class 0: acc 0.8863636363636364, correct 39/44 

class 1: acc 0.9232736572890026, correct 722/782 

class 2: acc 0.9595216191352346, correct 1043/1087 

class 3: acc 0.8365758754863813, correct 215/257 


Val Set, val_loss: 1.2046, auc: 0.7537 

class 0 clustering acc 0.9754971590909091: correct 8241/8448 

class 1 clustering acc 0.421875: correct 891/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6770833333333334, correct 65/96 

class 2: acc 0.7388059701492538, correct 99/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6439

Overall F1 Score: 0.4024

Training for coarse level...

batch 99, loss: 0.0586, instance_loss: 0.6063, weighted_loss: 0.2229, label: 3, bag_size: 132 

batch 199, loss: 0.0006, instance_loss: 0.0340, weighted_loss: 0.0107, label: 1, bag_size: 728 

batch 299, loss: 0.0004, instance_loss: 0.0327, weighted_loss: 0.0101, label: 2, bag_size: 1064 

batch 399, loss: 0.1751, instance_loss: 0.5065, weighted_loss: 0.2745, label: 2, bag_size: 401 

batch 499, loss: 0.0149, instance_loss: 0.2846, weighted_loss: 0.0958, label: 1, bag_size: 165 

batch 599, loss: 0.0007, instance_loss: 0.5849, weighted_loss: 0.1760, label: 1, bag_size: 1666 

batch 699, loss: 0.2507, instance_loss: 0.1232, weighted_loss: 0.2124, label: 1, bag_size: 389 

batch 799, loss: 0.0231, instance_loss: 0.0601, weighted_loss: 0.0342, label: 2, bag_size: 238 

batch 899, loss: 0.0080, instance_loss: 0.3385, weighted_loss: 0.1071, label: 2, bag_size: 334 

batch 999, loss: 0.0043, instance_loss: 0.0284, weighted_loss: 0.0115, label: 1, bag_size: 334 

batch 1099, loss: 0.0020, instance_loss: 0.5183, weighted_loss: 0.1569, label: 1, bag_size: 262 

batch 1199, loss: 0.0061, instance_loss: 0.1738, weighted_loss: 0.0564, label: 2, bag_size: 336 

batch 1299, loss: 0.0010, instance_loss: 0.1855, weighted_loss: 0.0563, label: 2, bag_size: 376 

batch 1399, loss: 0.0653, instance_loss: 0.7709, weighted_loss: 0.2770, label: 1, bag_size: 657 

batch 1499, loss: 0.0002, instance_loss: 0.0230, weighted_loss: 0.0070, label: 1, bag_size: 666 

batch 1599, loss: 0.0112, instance_loss: 0.2599, weighted_loss: 0.0858, label: 2, bag_size: 466 

batch 1699, loss: 0.1656, instance_loss: 0.3872, weighted_loss: 0.2321, label: 2, bag_size: 361 

batch 1799, loss: 1.7207, instance_loss: 0.4667, weighted_loss: 1.3445, label: 2, bag_size: 548 

batch 1899, loss: 0.0000, instance_loss: 0.0756, weighted_loss: 0.0227, label: 2, bag_size: 369 

batch 1999, loss: 0.0824, instance_loss: 0.8520, weighted_loss: 0.3133, label: 1, bag_size: 317 

batch 2099, loss: 0.0674, instance_loss: 0.7724, weighted_loss: 0.2789, label: 2, bag_size: 1206 

Instance Classifier Stats

class 0 clustering acc 0.9839717741935484: correct 68327/69440

class 1 clustering acc 0.5111175115207374: correct 8873/17360


Epoch: 12, train_loss: 0.1545, train_clustering_loss:  0.3344

class 0: acc 0.8636363636363636, correct 38/44 

class 1: acc 0.9514066496163683, correct 744/782 

class 2: acc 0.968721251149954, correct 1053/1087 

class 3: acc 0.8404669260700389, correct 216/257 


Val Set, val_loss: 1.4685, auc: 0.7378 

class 0 clustering acc 0.9737215909090909: correct 8226/8448 

class 1 clustering acc 0.43323863636363635: correct 915/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6458333333333334, correct 62/96 

class 2: acc 0.7761194029850746, correct 104/134 

class 3: acc 0.4666666666666667, correct 14/30 

Overall Accuracy: 0.6818

Overall F1 Score: 0.4637

Training for coarse level...

batch 99, loss: 0.0271, instance_loss: 0.3415, weighted_loss: 0.1214, label: 1, bag_size: 354 

batch 199, loss: 0.0009, instance_loss: 0.6543, weighted_loss: 0.1969, label: 3, bag_size: 168 

batch 299, loss: 0.0026, instance_loss: 0.0975, weighted_loss: 0.0310, label: 2, bag_size: 328 

batch 399, loss: 0.0303, instance_loss: 0.2761, weighted_loss: 0.1040, label: 1, bag_size: 347 

batch 499, loss: 0.0218, instance_loss: 0.5166, weighted_loss: 0.1703, label: 3, bag_size: 450 

batch 599, loss: 0.0000, instance_loss: 0.0252, weighted_loss: 0.0076, label: 1, bag_size: 2219 

batch 699, loss: 0.0056, instance_loss: 0.7318, weighted_loss: 0.2235, label: 1, bag_size: 121 

batch 799, loss: 0.0178, instance_loss: 0.5463, weighted_loss: 0.1763, label: 1, bag_size: 618 

batch 899, loss: 0.0022, instance_loss: 0.0789, weighted_loss: 0.0252, label: 2, bag_size: 393 

batch 999, loss: 0.0030, instance_loss: 0.7394, weighted_loss: 0.2239, label: 3, bag_size: 628 

batch 1099, loss: 0.1714, instance_loss: 0.2424, weighted_loss: 0.1927, label: 2, bag_size: 523 

batch 1199, loss: 0.0143, instance_loss: 0.3555, weighted_loss: 0.1167, label: 1, bag_size: 559 

batch 1299, loss: 0.3537, instance_loss: 0.4460, weighted_loss: 0.3814, label: 2, bag_size: 387 

batch 1399, loss: 0.3044, instance_loss: 0.4114, weighted_loss: 0.3365, label: 2, bag_size: 317 

batch 1499, loss: 0.0351, instance_loss: 0.7228, weighted_loss: 0.2414, label: 2, bag_size: 1796 

batch 1599, loss: 0.0263, instance_loss: 0.3069, weighted_loss: 0.1105, label: 2, bag_size: 206 

batch 1699, loss: 0.0000, instance_loss: 0.0111, weighted_loss: 0.0033, label: 1, bag_size: 563 

batch 1799, loss: 0.5132, instance_loss: 0.4680, weighted_loss: 0.4996, label: 2, bag_size: 247 

batch 1899, loss: 0.0017, instance_loss: 0.1572, weighted_loss: 0.0484, label: 2, bag_size: 712 

batch 1999, loss: 0.0394, instance_loss: 0.3441, weighted_loss: 0.1308, label: 2, bag_size: 703 

batch 2099, loss: 0.0000, instance_loss: 0.0318, weighted_loss: 0.0096, label: 2, bag_size: 525 

Instance Classifier Stats

class 0 clustering acc 0.9829925115207373: correct 68259/69440

class 1 clustering acc 0.5123847926267281: correct 8895/17360


Epoch: 13, train_loss: 0.1361, train_clustering_loss:  0.3362

class 0: acc 0.8409090909090909, correct 37/44 

class 1: acc 0.9514066496163683, correct 744/782 

class 2: acc 0.9714811407543699, correct 1056/1087 

class 3: acc 0.8871595330739299, correct 228/257 


Val Set, val_loss: 1.5296, auc: 0.7079 

class 0 clustering acc 0.9779829545454546: correct 8262/8448 

class 1 clustering acc 0.3953598484848485: correct 835/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.7083333333333334, correct 68/96 

class 2: acc 0.6940298507462687, correct 93/134 

class 3: acc 0.16666666666666666, correct 5/30 

Overall Accuracy: 0.6288

Overall F1 Score: 0.3891

Training for coarse level...

batch 99, loss: 0.0001, instance_loss: 0.0165, weighted_loss: 0.0051, label: 1, bag_size: 788 

batch 199, loss: 0.0022, instance_loss: 0.6443, weighted_loss: 0.1949, label: 3, bag_size: 235 

batch 299, loss: 0.1205, instance_loss: 1.4225, weighted_loss: 0.5111, label: 1, bag_size: 2625 

batch 399, loss: 0.2727, instance_loss: 0.5208, weighted_loss: 0.3471, label: 1, bag_size: 676 

batch 499, loss: 0.0510, instance_loss: 0.4870, weighted_loss: 0.1818, label: 1, bag_size: 2107 

batch 599, loss: 0.0870, instance_loss: 0.3247, weighted_loss: 0.1583, label: 2, bag_size: 337 

batch 699, loss: 0.0003, instance_loss: 0.3416, weighted_loss: 0.1027, label: 2, bag_size: 325 

batch 799, loss: 0.0020, instance_loss: 0.3517, weighted_loss: 0.1069, label: 2, bag_size: 288 

batch 899, loss: 0.0020, instance_loss: 0.2182, weighted_loss: 0.0669, label: 2, bag_size: 436 

batch 999, loss: 0.0167, instance_loss: 0.2148, weighted_loss: 0.0761, label: 2, bag_size: 243 

batch 1099, loss: 0.0004, instance_loss: 0.2350, weighted_loss: 0.0708, label: 2, bag_size: 741 

batch 1199, loss: 0.0471, instance_loss: 0.4040, weighted_loss: 0.1541, label: 1, bag_size: 421 

batch 1299, loss: 0.0000, instance_loss: 0.0089, weighted_loss: 0.0027, label: 2, bag_size: 525 

batch 1399, loss: 0.0214, instance_loss: 0.6427, weighted_loss: 0.2078, label: 3, bag_size: 876 

batch 1499, loss: 0.0018, instance_loss: 0.2596, weighted_loss: 0.0792, label: 2, bag_size: 1214 

batch 1599, loss: 0.0093, instance_loss: 0.3373, weighted_loss: 0.1077, label: 2, bag_size: 316 

batch 1699, loss: 0.0001, instance_loss: 0.0260, weighted_loss: 0.0079, label: 1, bag_size: 2154 

batch 1799, loss: 0.0118, instance_loss: 0.7267, weighted_loss: 0.2262, label: 1, bag_size: 356 

batch 1899, loss: 0.0061, instance_loss: 0.1545, weighted_loss: 0.0506, label: 1, bag_size: 659 

batch 1999, loss: 0.0413, instance_loss: 0.8172, weighted_loss: 0.2740, label: 2, bag_size: 814 

batch 2099, loss: 0.6243, instance_loss: 0.6874, weighted_loss: 0.6432, label: 3, bag_size: 625 

Instance Classifier Stats

class 0 clustering acc 0.9838709677419355: correct 68320/69440

class 1 clustering acc 0.5194124423963133: correct 9017/17360


Epoch: 14, train_loss: 0.1093, train_clustering_loss:  0.3316

class 0: acc 0.9545454545454546, correct 42/44 

class 1: acc 0.9680306905370843, correct 757/782 

class 2: acc 0.9742410303587856, correct 1059/1087 

class 3: acc 0.9105058365758755, correct 234/257 


Val Set, val_loss: 1.4840, auc: 0.7391 

class 0 clustering acc 0.9739583333333334: correct 8228/8448 

class 1 clustering acc 0.43323863636363635: correct 915/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.71875, correct 69/96 

class 2: acc 0.7164179104477612, correct 96/134 

class 3: acc 0.16666666666666666, correct 5/30 

Overall Accuracy: 0.6439

Overall F1 Score: 0.3975

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.2958, weighted_loss: 0.0888, label: 2, bag_size: 290 

batch 199, loss: 0.0000, instance_loss: 0.7293, weighted_loss: 0.2188, label: 1, bag_size: 835 

batch 299, loss: 0.0012, instance_loss: 0.3271, weighted_loss: 0.0990, label: 2, bag_size: 562 

batch 399, loss: 0.4009, instance_loss: 0.6321, weighted_loss: 0.4703, label: 3, bag_size: 368 

batch 499, loss: 3.8516, instance_loss: 0.6603, weighted_loss: 2.8942, label: 2, bag_size: 708 

batch 599, loss: 0.0002, instance_loss: 0.1552, weighted_loss: 0.0467, label: 2, bag_size: 1853 

batch 699, loss: 0.1667, instance_loss: 0.7357, weighted_loss: 0.3374, label: 0, bag_size: 113 

batch 799, loss: 0.0064, instance_loss: 0.7371, weighted_loss: 0.2256, label: 2, bag_size: 444 

batch 899, loss: 0.0000, instance_loss: 0.0232, weighted_loss: 0.0070, label: 1, bag_size: 1628 

batch 999, loss: 0.0168, instance_loss: 0.2357, weighted_loss: 0.0825, label: 2, bag_size: 367 

batch 1099, loss: 0.0278, instance_loss: 0.5433, weighted_loss: 0.1825, label: 2, bag_size: 112 

batch 1199, loss: 0.0002, instance_loss: 0.0532, weighted_loss: 0.0161, label: 2, bag_size: 364 

batch 1299, loss: 0.0020, instance_loss: 0.2940, weighted_loss: 0.0896, label: 1, bag_size: 510 

batch 1399, loss: 0.0004, instance_loss: 0.0386, weighted_loss: 0.0118, label: 1, bag_size: 1333 

batch 1499, loss: 0.0001, instance_loss: 0.2599, weighted_loss: 0.0780, label: 2, bag_size: 291 

batch 1599, loss: 3.7588, instance_loss: 0.8295, weighted_loss: 2.8800, label: 3, bag_size: 568 

batch 1699, loss: 0.8166, instance_loss: 0.4392, weighted_loss: 0.7034, label: 2, bag_size: 193 

batch 1799, loss: 0.0140, instance_loss: 0.4938, weighted_loss: 0.1580, label: 1, bag_size: 378 

batch 1899, loss: 0.0031, instance_loss: 0.3966, weighted_loss: 0.1211, label: 2, bag_size: 526 

batch 1999, loss: 0.0015, instance_loss: 0.3102, weighted_loss: 0.0941, label: 2, bag_size: 362 

batch 2099, loss: 0.0040, instance_loss: 0.6998, weighted_loss: 0.2127, label: 0, bag_size: 244 

Instance Classifier Stats

class 0 clustering acc 0.983309331797235: correct 68281/69440

class 1 clustering acc 0.521889400921659: correct 9060/17360


Epoch: 15, train_loss: 0.1132, train_clustering_loss:  0.3291

class 0: acc 0.9545454545454546, correct 42/44 

class 1: acc 0.9629156010230179, correct 753/782 

class 2: acc 0.9733210671573137, correct 1058/1087 

class 3: acc 0.914396887159533, correct 235/257 


Val Set, val_loss: 1.5379, auc: 0.7359 

class 0 clustering acc 0.9656723484848485: correct 8158/8448 

class 1 clustering acc 0.4498106060606061: correct 950/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6458333333333334, correct 62/96 

class 2: acc 0.7686567164179104, correct 103/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6477

Overall F1 Score: 0.4037

Training for coarse level...

batch 99, loss: 0.0118, instance_loss: 0.1392, weighted_loss: 0.0501, label: 2, bag_size: 322 

batch 199, loss: 0.0710, instance_loss: 0.6044, weighted_loss: 0.2310, label: 3, bag_size: 837 

batch 299, loss: 0.0062, instance_loss: 0.2635, weighted_loss: 0.0834, label: 2, bag_size: 269 

batch 399, loss: 0.0000, instance_loss: 0.0967, weighted_loss: 0.0290, label: 2, bag_size: 640 

batch 499, loss: 0.0042, instance_loss: 0.1259, weighted_loss: 0.0407, label: 1, bag_size: 555 

batch 599, loss: 1.0155, instance_loss: 0.4381, weighted_loss: 0.8423, label: 2, bag_size: 317 

batch 699, loss: 0.0085, instance_loss: 0.2775, weighted_loss: 0.0892, label: 2, bag_size: 266 

batch 799, loss: 0.0010, instance_loss: 0.3095, weighted_loss: 0.0936, label: 1, bag_size: 343 

batch 899, loss: 0.0001, instance_loss: 0.6376, weighted_loss: 0.1913, label: 1, bag_size: 542 

batch 999, loss: 0.1127, instance_loss: 0.4115, weighted_loss: 0.2023, label: 1, bag_size: 568 

batch 1099, loss: 0.0002, instance_loss: 0.5139, weighted_loss: 0.1543, label: 2, bag_size: 1246 

batch 1199, loss: 0.0535, instance_loss: 0.4986, weighted_loss: 0.1870, label: 1, bag_size: 407 

batch 1299, loss: 0.0000, instance_loss: 0.0507, weighted_loss: 0.0152, label: 2, bag_size: 700 

batch 1399, loss: 0.0101, instance_loss: 0.2810, weighted_loss: 0.0914, label: 1, bag_size: 248 

batch 1499, loss: 0.0444, instance_loss: 0.0730, weighted_loss: 0.0530, label: 2, bag_size: 619 

batch 1599, loss: 0.0437, instance_loss: 0.7871, weighted_loss: 0.2667, label: 2, bag_size: 2344 

batch 1699, loss: 0.0295, instance_loss: 0.0254, weighted_loss: 0.0283, label: 2, bag_size: 210 

batch 1799, loss: 5.7155, instance_loss: 0.4657, weighted_loss: 4.1406, label: 2, bag_size: 422 

batch 1899, loss: 0.0015, instance_loss: 0.4322, weighted_loss: 0.1307, label: 2, bag_size: 338 

batch 1999, loss: 0.1877, instance_loss: 0.5752, weighted_loss: 0.3040, label: 1, bag_size: 371 

batch 2099, loss: 1.6585, instance_loss: 0.8439, weighted_loss: 1.4141, label: 1, bag_size: 2059 

Instance Classifier Stats

class 0 clustering acc 0.9835109447004609: correct 68295/69440

class 1 clustering acc 0.530184331797235: correct 9204/17360


Epoch: 16, train_loss: 0.0975, train_clustering_loss:  0.3256

class 0: acc 0.9318181818181818, correct 41/44 

class 1: acc 0.9757033248081841, correct 763/782 

class 2: acc 0.9779208831646734, correct 1063/1087 

class 3: acc 0.8988326848249028, correct 231/257 


Val Set, val_loss: 1.6288, auc: 0.7225 

class 0 clustering acc 0.9685132575757576: correct 8182/8448 

class 1 clustering acc 0.45359848484848486: correct 958/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.65625, correct 63/96 

class 2: acc 0.7313432835820896, correct 98/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6326

Overall F1 Score: 0.4002

Training for coarse level...

batch 99, loss: 0.0665, instance_loss: 0.2969, weighted_loss: 0.1356, label: 2, bag_size: 524 

batch 199, loss: 0.3277, instance_loss: 0.6669, weighted_loss: 0.4294, label: 1, bag_size: 304 

batch 299, loss: 0.0003, instance_loss: 0.3742, weighted_loss: 0.1124, label: 2, bag_size: 338 

batch 399, loss: 0.0003, instance_loss: 0.1021, weighted_loss: 0.0308, label: 2, bag_size: 691 

batch 499, loss: 0.0019, instance_loss: 0.5858, weighted_loss: 0.1770, label: 1, bag_size: 250 

batch 599, loss: 0.0009, instance_loss: 0.0693, weighted_loss: 0.0214, label: 1, bag_size: 1534 

batch 699, loss: 0.0005, instance_loss: 0.5991, weighted_loss: 0.1801, label: 1, bag_size: 407 

batch 799, loss: 0.0034, instance_loss: 0.1568, weighted_loss: 0.0494, label: 2, bag_size: 576 

batch 899, loss: 0.0018, instance_loss: 0.3239, weighted_loss: 0.0984, label: 2, bag_size: 595 

batch 999, loss: 0.0004, instance_loss: 0.2935, weighted_loss: 0.0884, label: 2, bag_size: 1032 

batch 1099, loss: 0.3107, instance_loss: 0.4502, weighted_loss: 0.3526, label: 1, bag_size: 248 

batch 1199, loss: 0.0128, instance_loss: 0.1552, weighted_loss: 0.0555, label: 2, bag_size: 244 

batch 1299, loss: 0.0000, instance_loss: 0.0201, weighted_loss: 0.0061, label: 2, bag_size: 1064 

batch 1399, loss: 0.0085, instance_loss: 0.2779, weighted_loss: 0.0893, label: 2, bag_size: 174 

batch 1499, loss: 0.0004, instance_loss: 0.6462, weighted_loss: 0.1941, label: 1, bag_size: 472 

batch 1599, loss: 0.0014, instance_loss: 0.0824, weighted_loss: 0.0257, label: 2, bag_size: 607 

batch 1699, loss: 0.0000, instance_loss: 0.0122, weighted_loss: 0.0037, label: 1, bag_size: 1263 

batch 1799, loss: 0.0000, instance_loss: 0.1005, weighted_loss: 0.0302, label: 1, bag_size: 483 

batch 1899, loss: 0.0000, instance_loss: 0.0621, weighted_loss: 0.0186, label: 1, bag_size: 490 

batch 1999, loss: 0.1060, instance_loss: 0.2018, weighted_loss: 0.1347, label: 1, bag_size: 1627 

batch 2099, loss: 0.0522, instance_loss: 0.6599, weighted_loss: 0.2345, label: 0, bag_size: 440 

Instance Classifier Stats

class 0 clustering acc 0.9834821428571429: correct 68293/69440

class 1 clustering acc 0.5301267281105991: correct 9203/17360


Epoch: 17, train_loss: 0.0746, train_clustering_loss:  0.3263

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9769820971867008, correct 764/782 

class 2: acc 0.9816007359705612, correct 1067/1087 

class 3: acc 0.9494163424124513, correct 244/257 


Val Set, val_loss: 1.8070, auc: 0.7304 

class 0 clustering acc 0.9734848484848485: correct 8224/8448 

class 1 clustering acc 0.42613636363636365: correct 900/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.625, correct 60/96 

class 2: acc 0.664179104477612, correct 89/134 

class 3: acc 0.36666666666666664, correct 11/30 

Overall Accuracy: 0.6061

Overall F1 Score: 0.4077

Training for coarse level...

batch 99, loss: 0.1029, instance_loss: 0.4051, weighted_loss: 0.1936, label: 1, bag_size: 65 

batch 199, loss: 0.0034, instance_loss: 0.4970, weighted_loss: 0.1515, label: 2, bag_size: 220 

batch 299, loss: 0.0006, instance_loss: 0.8673, weighted_loss: 0.2606, label: 1, bag_size: 792 

batch 399, loss: 0.0402, instance_loss: 0.3722, weighted_loss: 0.1398, label: 1, bag_size: 1223 

batch 499, loss: 0.0000, instance_loss: 0.0254, weighted_loss: 0.0076, label: 2, bag_size: 658 

batch 599, loss: 0.0093, instance_loss: 0.3080, weighted_loss: 0.0989, label: 2, bag_size: 1555 

batch 699, loss: 0.3051, instance_loss: 0.4539, weighted_loss: 0.3497, label: 2, bag_size: 229 

batch 799, loss: 0.0000, instance_loss: 0.0294, weighted_loss: 0.0088, label: 2, bag_size: 921 

batch 899, loss: 0.0012, instance_loss: 0.4739, weighted_loss: 0.1430, label: 3, bag_size: 259 

batch 999, loss: 0.0024, instance_loss: 0.6074, weighted_loss: 0.1839, label: 3, bag_size: 119 

batch 1099, loss: 0.0028, instance_loss: 0.6721, weighted_loss: 0.2036, label: 3, bag_size: 663 

batch 1199, loss: 0.0000, instance_loss: 0.0207, weighted_loss: 0.0062, label: 1, bag_size: 2131 

batch 1299, loss: 0.0000, instance_loss: 0.1552, weighted_loss: 0.0465, label: 2, bag_size: 393 

batch 1399, loss: 0.0017, instance_loss: 0.0223, weighted_loss: 0.0079, label: 1, bag_size: 378 

batch 1499, loss: 0.0239, instance_loss: 0.4615, weighted_loss: 0.1551, label: 2, bag_size: 368 

batch 1599, loss: 0.0032, instance_loss: 0.4173, weighted_loss: 0.1275, label: 1, bag_size: 223 

batch 1699, loss: 0.0000, instance_loss: 0.1998, weighted_loss: 0.0599, label: 2, bag_size: 1547 

batch 1799, loss: 0.0002, instance_loss: 0.1458, weighted_loss: 0.0439, label: 2, bag_size: 448 

batch 1899, loss: 0.1246, instance_loss: 0.3036, weighted_loss: 0.1783, label: 2, bag_size: 365 

batch 1999, loss: 0.0000, instance_loss: 0.0240, weighted_loss: 0.0072, label: 1, bag_size: 537 

batch 2099, loss: 0.3107, instance_loss: 0.6055, weighted_loss: 0.3991, label: 3, bag_size: 720 

Instance Classifier Stats

class 0 clustering acc 0.9836549539170507: correct 68305/69440

class 1 clustering acc 0.5467165898617512: correct 9491/17360


Epoch: 18, train_loss: 0.0641, train_clustering_loss:  0.3169

class 0: acc 0.8863636363636364, correct 39/44 

class 1: acc 0.9833759590792839, correct 769/782 

class 2: acc 0.9880404783808647, correct 1074/1087 

class 3: acc 0.9649805447470817, correct 248/257 


Val Set, val_loss: 1.8537, auc: 0.7607 

class 0 clustering acc 0.9585700757575758: correct 8098/8448 

class 1 clustering acc 0.4630681818181818: correct 978/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.5625, correct 54/96 

class 2: acc 0.8134328358208955, correct 109/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6439

Overall F1 Score: 0.4078

Training for coarse level...

batch 99, loss: 0.0071, instance_loss: 0.2157, weighted_loss: 0.0697, label: 2, bag_size: 214 

batch 199, loss: 0.0001, instance_loss: 0.1626, weighted_loss: 0.0488, label: 2, bag_size: 533 

batch 299, loss: 0.0036, instance_loss: 0.2100, weighted_loss: 0.0655, label: 2, bag_size: 1214 

batch 399, loss: 0.0000, instance_loss: 0.9111, weighted_loss: 0.2733, label: 1, bag_size: 564 

batch 499, loss: 0.0000, instance_loss: 0.6798, weighted_loss: 0.2040, label: 1, bag_size: 265 

batch 599, loss: 0.0000, instance_loss: 0.0283, weighted_loss: 0.0085, label: 1, bag_size: 1204 

batch 699, loss: 0.0205, instance_loss: 0.3469, weighted_loss: 0.1184, label: 2, bag_size: 286 

batch 799, loss: 0.0001, instance_loss: 0.4963, weighted_loss: 0.1489, label: 1, bag_size: 241 

batch 899, loss: 0.0007, instance_loss: 0.2061, weighted_loss: 0.0623, label: 2, bag_size: 706 

batch 999, loss: 0.0024, instance_loss: 0.5176, weighted_loss: 0.1569, label: 3, bag_size: 450 

batch 1099, loss: 0.0000, instance_loss: 0.2978, weighted_loss: 0.0893, label: 3, bag_size: 338 

batch 1199, loss: 0.0017, instance_loss: 1.2786, weighted_loss: 0.3847, label: 0, bag_size: 554 

batch 1299, loss: 0.0002, instance_loss: 0.0145, weighted_loss: 0.0045, label: 2, bag_size: 965 

batch 1399, loss: 0.1472, instance_loss: 0.7361, weighted_loss: 0.3238, label: 1, bag_size: 421 

batch 1499, loss: 0.0224, instance_loss: 0.3335, weighted_loss: 0.1157, label: 2, bag_size: 288 

batch 1599, loss: 0.0079, instance_loss: 0.1713, weighted_loss: 0.0569, label: 2, bag_size: 394 

batch 1699, loss: 0.0036, instance_loss: 0.7131, weighted_loss: 0.2165, label: 1, bag_size: 442 

batch 1799, loss: 0.0001, instance_loss: 0.0380, weighted_loss: 0.0114, label: 2, bag_size: 312 

batch 1899, loss: 0.0046, instance_loss: 0.3093, weighted_loss: 0.0960, label: 3, bag_size: 481 

batch 1999, loss: 0.0001, instance_loss: 0.1135, weighted_loss: 0.0341, label: 2, bag_size: 573 

batch 2099, loss: 0.0343, instance_loss: 0.4869, weighted_loss: 0.1701, label: 2, bag_size: 729 

Instance Classifier Stats

class 0 clustering acc 0.9822292626728111: correct 68206/69440

class 1 clustering acc 0.5387672811059908: correct 9353/17360


Epoch: 19, train_loss: 0.0767, train_clustering_loss:  0.3250

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9757033248081841, correct 763/782 

class 2: acc 0.983440662373505, correct 1069/1087 

class 3: acc 0.9571984435797666, correct 246/257 


Val Set, val_loss: 1.8387, auc: 0.7201 

class 0 clustering acc 0.974313446969697: correct 8231/8448 

class 1 clustering acc 0.4256628787878788: correct 899/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.71875, correct 69/96 

class 2: acc 0.6716417910447762, correct 90/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6288

Overall F1 Score: 0.4049

Training for coarse level...

batch 99, loss: 0.0107, instance_loss: 0.7130, weighted_loss: 0.2214, label: 3, bag_size: 386 

batch 199, loss: 0.0000, instance_loss: 0.3432, weighted_loss: 0.1030, label: 1, bag_size: 193 

batch 299, loss: 0.0000, instance_loss: 0.8730, weighted_loss: 0.2619, label: 3, bag_size: 388 

batch 399, loss: 0.0000, instance_loss: 0.0341, weighted_loss: 0.0102, label: 2, bag_size: 712 

batch 499, loss: 0.0000, instance_loss: 0.0599, weighted_loss: 0.0180, label: 2, bag_size: 665 

batch 599, loss: 0.0001, instance_loss: 0.3150, weighted_loss: 0.0946, label: 3, bag_size: 327 

batch 699, loss: 0.0228, instance_loss: 0.5094, weighted_loss: 0.1688, label: 1, bag_size: 155 

batch 799, loss: 0.0491, instance_loss: 0.4630, weighted_loss: 0.1733, label: 3, bag_size: 309 

batch 899, loss: 0.0003, instance_loss: 0.1418, weighted_loss: 0.0428, label: 2, bag_size: 229 

batch 999, loss: 0.0000, instance_loss: 0.0103, weighted_loss: 0.0031, label: 1, bag_size: 826 

batch 1099, loss: 0.0003, instance_loss: 0.5908, weighted_loss: 0.1774, label: 3, bag_size: 430 

batch 1199, loss: 0.0002, instance_loss: 0.1864, weighted_loss: 0.0561, label: 2, bag_size: 276 

batch 1299, loss: 0.0007, instance_loss: 0.2691, weighted_loss: 0.0813, label: 2, bag_size: 377 

batch 1399, loss: 0.0001, instance_loss: 0.0539, weighted_loss: 0.0162, label: 1, bag_size: 2121 

batch 1499, loss: 0.0030, instance_loss: 0.1643, weighted_loss: 0.0514, label: 2, bag_size: 433 

batch 1599, loss: 0.0000, instance_loss: 0.0541, weighted_loss: 0.0162, label: 1, bag_size: 2948 

batch 1699, loss: 0.0000, instance_loss: 0.6315, weighted_loss: 0.1894, label: 1, bag_size: 161 

batch 1799, loss: 0.0000, instance_loss: 0.1878, weighted_loss: 0.0563, label: 2, bag_size: 701 

batch 1899, loss: 0.0063, instance_loss: 0.3147, weighted_loss: 0.0988, label: 2, bag_size: 371 

batch 1999, loss: 0.0000, instance_loss: 0.1222, weighted_loss: 0.0367, label: 2, bag_size: 905 

batch 2099, loss: 0.0001, instance_loss: 0.2574, weighted_loss: 0.0773, label: 2, bag_size: 422 

Instance Classifier Stats

class 0 clustering acc 0.9821140552995392: correct 68198/69440

class 1 clustering acc 0.5516705069124423: correct 9577/17360


Epoch: 20, train_loss: 0.0669, train_clustering_loss:  0.3172

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9757033248081841, correct 763/782 

class 2: acc 0.9825206991720331, correct 1068/1087 

class 3: acc 0.9494163424124513, correct 244/257 


Val Set, val_loss: 2.0395, auc: 0.7276 

class 0 clustering acc 0.9615293560606061: correct 8123/8448 

class 1 clustering acc 0.4630681818181818: correct 978/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.53125, correct 51/96 

class 2: acc 0.753731343283582, correct 101/134 

class 3: acc 0.26666666666666666, correct 8/30 

Overall Accuracy: 0.6061

Overall F1 Score: 0.3886

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.3243, weighted_loss: 0.0973, label: 2, bag_size: 661 

batch 199, loss: 0.0000, instance_loss: 0.0499, weighted_loss: 0.0150, label: 2, bag_size: 576 

batch 299, loss: 0.0016, instance_loss: 0.0952, weighted_loss: 0.0297, label: 1, bag_size: 1333 

batch 399, loss: 0.0022, instance_loss: 0.4430, weighted_loss: 0.1345, label: 1, bag_size: 326 

batch 499, loss: 0.0023, instance_loss: 0.3278, weighted_loss: 0.0999, label: 2, bag_size: 555 

batch 599, loss: 0.0001, instance_loss: 0.4270, weighted_loss: 0.1282, label: 2, bag_size: 301 

batch 699, loss: 0.0001, instance_loss: 0.3338, weighted_loss: 0.1002, label: 1, bag_size: 405 

batch 799, loss: 0.0000, instance_loss: 0.0230, weighted_loss: 0.0069, label: 2, bag_size: 180 

batch 899, loss: 0.0003, instance_loss: 0.0449, weighted_loss: 0.0137, label: 2, bag_size: 620 

batch 999, loss: 0.0007, instance_loss: 0.2494, weighted_loss: 0.0753, label: 2, bag_size: 308 

batch 1099, loss: 0.0002, instance_loss: 0.1672, weighted_loss: 0.0503, label: 1, bag_size: 1727 

batch 1199, loss: 0.0000, instance_loss: 0.0077, weighted_loss: 0.0023, label: 1, bag_size: 409 

batch 1299, loss: 0.0003, instance_loss: 0.1794, weighted_loss: 0.0540, label: 2, bag_size: 333 

batch 1399, loss: 0.0267, instance_loss: 0.1613, weighted_loss: 0.0671, label: 1, bag_size: 1523 

batch 1499, loss: 0.0000, instance_loss: 0.4132, weighted_loss: 0.1240, label: 1, bag_size: 317 

batch 1599, loss: 0.1094, instance_loss: 0.4893, weighted_loss: 0.2233, label: 1, bag_size: 454 

batch 1699, loss: 0.0014, instance_loss: 0.0754, weighted_loss: 0.0236, label: 2, bag_size: 448 

batch 1799, loss: 0.0574, instance_loss: 0.7674, weighted_loss: 0.2704, label: 1, bag_size: 2085 

batch 1899, loss: 0.0018, instance_loss: 1.0377, weighted_loss: 0.3126, label: 3, bag_size: 378 

batch 1999, loss: 0.0020, instance_loss: 0.2799, weighted_loss: 0.0854, label: 2, bag_size: 552 

batch 2099, loss: 0.0027, instance_loss: 0.2143, weighted_loss: 0.0662, label: 2, bag_size: 854 

Instance Classifier Stats

class 0 clustering acc 0.9824308755760369: correct 68220/69440

class 1 clustering acc 0.5484447004608295: correct 9521/17360


Epoch: 21, train_loss: 0.0490, train_clustering_loss:  0.3158

class 0: acc 0.9318181818181818, correct 41/44 

class 1: acc 0.9872122762148338, correct 772/782 

class 2: acc 0.9908003679852806, correct 1077/1087 

class 3: acc 0.9610894941634242, correct 247/257 


Val Set, val_loss: 2.0374, auc: 0.7177 

class 0 clustering acc 0.9660274621212122: correct 8161/8448 

class 1 clustering acc 0.4512310606060606: correct 953/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6354166666666666, correct 61/96 

class 2: acc 0.7014925373134329, correct 94/134 

class 3: acc 0.26666666666666666, correct 8/30 

Overall Accuracy: 0.6174

Overall F1 Score: 0.4018

Training for coarse level...

batch 99, loss: 0.0003, instance_loss: 0.3062, weighted_loss: 0.0921, label: 1, bag_size: 250 

batch 199, loss: 0.0000, instance_loss: 0.1002, weighted_loss: 0.0301, label: 1, bag_size: 600 

batch 299, loss: 0.0000, instance_loss: 0.0805, weighted_loss: 0.0242, label: 1, bag_size: 1767 

batch 399, loss: 0.0002, instance_loss: 0.0435, weighted_loss: 0.0132, label: 2, bag_size: 368 

batch 499, loss: 1.5925, instance_loss: 0.7073, weighted_loss: 1.3269, label: 1, bag_size: 119 

batch 599, loss: 0.0000, instance_loss: 0.3192, weighted_loss: 0.0958, label: 2, bag_size: 352 

batch 699, loss: 0.0087, instance_loss: 0.3607, weighted_loss: 0.1143, label: 3, bag_size: 13 

batch 799, loss: 0.0261, instance_loss: 0.6356, weighted_loss: 0.2090, label: 1, bag_size: 185 

batch 899, loss: 1.3820, instance_loss: 0.2678, weighted_loss: 1.0477, label: 1, bag_size: 389 

batch 999, loss: 0.0003, instance_loss: 0.6225, weighted_loss: 0.1869, label: 1, bag_size: 540 

batch 1099, loss: 0.0375, instance_loss: 0.4285, weighted_loss: 0.1548, label: 2, bag_size: 575 

batch 1199, loss: 0.0005, instance_loss: 0.4990, weighted_loss: 0.1501, label: 2, bag_size: 310 

batch 1299, loss: 3.5695, instance_loss: 0.7090, weighted_loss: 2.7114, label: 1, bag_size: 374 

batch 1399, loss: 0.0000, instance_loss: 0.0372, weighted_loss: 0.0112, label: 2, bag_size: 733 

batch 1499, loss: 0.2306, instance_loss: 0.6805, weighted_loss: 0.3656, label: 2, bag_size: 75 

batch 1599, loss: 0.0314, instance_loss: 0.6709, weighted_loss: 0.2232, label: 1, bag_size: 622 

batch 1699, loss: 0.0006, instance_loss: 0.1682, weighted_loss: 0.0509, label: 1, bag_size: 1632 

batch 1799, loss: 0.0000, instance_loss: 0.3066, weighted_loss: 0.0920, label: 2, bag_size: 235 

batch 1899, loss: 0.0065, instance_loss: 0.2802, weighted_loss: 0.0886, label: 1, bag_size: 2069 

batch 1999, loss: 0.0007, instance_loss: 1.0274, weighted_loss: 0.3087, label: 3, bag_size: 527 

batch 2099, loss: 0.0004, instance_loss: 0.0840, weighted_loss: 0.0255, label: 2, bag_size: 789 

Instance Classifier Stats

class 0 clustering acc 0.9824164746543779: correct 68219/69440

class 1 clustering acc 0.5561059907834102: correct 9654/17360


Epoch: 22, train_loss: 0.0668, train_clustering_loss:  0.3142

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9744245524296675, correct 762/782 

class 2: acc 0.9825206991720331, correct 1068/1087 

class 3: acc 0.9571984435797666, correct 246/257 


Val Set, val_loss: 1.8373, auc: 0.7275 

class 0 clustering acc 0.9701704545454546: correct 8196/8448 

class 1 clustering acc 0.4180871212121212: correct 883/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6770833333333334, correct 65/96 

class 2: acc 0.6865671641791045, correct 92/134 

class 3: acc 0.26666666666666666, correct 8/30 

Overall Accuracy: 0.6250

Overall F1 Score: 0.4082

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.1183, weighted_loss: 0.0355, label: 2, bag_size: 1064 

batch 199, loss: 0.0049, instance_loss: 0.4044, weighted_loss: 0.1247, label: 2, bag_size: 293 

batch 299, loss: 0.0003, instance_loss: 0.0642, weighted_loss: 0.0195, label: 2, bag_size: 629 

batch 399, loss: 0.0000, instance_loss: 0.1107, weighted_loss: 0.0332, label: 2, bag_size: 1161 

batch 499, loss: 0.0000, instance_loss: 0.1629, weighted_loss: 0.0489, label: 2, bag_size: 468 

batch 599, loss: 0.0002, instance_loss: 0.0996, weighted_loss: 0.0300, label: 1, bag_size: 589 

batch 699, loss: 0.0000, instance_loss: 0.0874, weighted_loss: 0.0262, label: 2, bag_size: 221 

batch 799, loss: 0.0000, instance_loss: 0.0745, weighted_loss: 0.0224, label: 1, bag_size: 1663 

batch 899, loss: 0.0000, instance_loss: 0.0598, weighted_loss: 0.0179, label: 2, bag_size: 475 

batch 999, loss: 0.0001, instance_loss: 0.3175, weighted_loss: 0.0953, label: 2, bag_size: 129 

batch 1099, loss: 0.0004, instance_loss: 0.1955, weighted_loss: 0.0590, label: 2, bag_size: 473 

batch 1199, loss: 0.0001, instance_loss: 0.4772, weighted_loss: 0.1432, label: 2, bag_size: 1865 

batch 1299, loss: 0.0021, instance_loss: 0.7574, weighted_loss: 0.2287, label: 1, bag_size: 393 

batch 1399, loss: 0.0000, instance_loss: 0.3628, weighted_loss: 0.1088, label: 1, bag_size: 343 

batch 1499, loss: 0.0000, instance_loss: 0.0171, weighted_loss: 0.0051, label: 1, bag_size: 1490 

batch 1599, loss: 0.0000, instance_loss: 0.2003, weighted_loss: 0.0601, label: 2, bag_size: 604 

batch 1699, loss: 0.0000, instance_loss: 0.1594, weighted_loss: 0.0478, label: 2, bag_size: 875 

batch 1799, loss: 0.0002, instance_loss: 0.6265, weighted_loss: 0.1881, label: 1, bag_size: 303 

batch 1899, loss: 0.0002, instance_loss: 0.0484, weighted_loss: 0.0147, label: 2, bag_size: 515 

batch 1999, loss: 0.0000, instance_loss: 0.0580, weighted_loss: 0.0174, label: 2, bag_size: 1547 

batch 2099, loss: 0.2009, instance_loss: 0.4431, weighted_loss: 0.2735, label: 1, bag_size: 142 

Instance Classifier Stats

class 0 clustering acc 0.9828341013824885: correct 68248/69440

class 1 clustering acc 0.559389400921659: correct 9711/17360


Epoch: 23, train_loss: 0.0549, train_clustering_loss:  0.3111

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9833759590792839, correct 769/782 

class 2: acc 0.985280588776449, correct 1071/1087 

class 3: acc 0.9649805447470817, correct 248/257 


Val Set, val_loss: 1.9155, auc: 0.7453 

class 0 clustering acc 0.9636600378787878: correct 8141/8448 

class 1 clustering acc 0.4384469696969697: correct 926/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.5, correct 48/96 

class 2: acc 0.7985074626865671, correct 107/134 

class 3: acc 0.4, correct 12/30 

Overall Accuracy: 0.6326

Overall F1 Score: 0.4161

Training for coarse level...

batch 99, loss: 0.0002, instance_loss: 0.4486, weighted_loss: 0.1348, label: 3, bag_size: 172 

batch 199, loss: 0.0001, instance_loss: 0.4947, weighted_loss: 0.1485, label: 3, bag_size: 665 

batch 299, loss: 0.0252, instance_loss: 0.6477, weighted_loss: 0.2119, label: 3, bag_size: 829 

batch 399, loss: 0.0002, instance_loss: 0.3620, weighted_loss: 0.1088, label: 2, bag_size: 248 

batch 499, loss: 0.0000, instance_loss: 0.0267, weighted_loss: 0.0080, label: 2, bag_size: 246 

batch 599, loss: 0.0003, instance_loss: 0.6339, weighted_loss: 0.1904, label: 1, bag_size: 675 

batch 699, loss: 0.0000, instance_loss: 0.4009, weighted_loss: 0.1203, label: 3, bag_size: 830 

batch 799, loss: 0.0000, instance_loss: 0.1281, weighted_loss: 0.0384, label: 2, bag_size: 739 

batch 899, loss: 0.0001, instance_loss: 0.4220, weighted_loss: 0.1267, label: 2, bag_size: 431 

batch 999, loss: 0.0004, instance_loss: 0.2329, weighted_loss: 0.0702, label: 2, bag_size: 209 

batch 1099, loss: 0.0012, instance_loss: 0.3169, weighted_loss: 0.0959, label: 2, bag_size: 729 

batch 1199, loss: 0.0000, instance_loss: 0.0113, weighted_loss: 0.0034, label: 1, bag_size: 872 

batch 1299, loss: 0.0000, instance_loss: 0.1721, weighted_loss: 0.0516, label: 3, bag_size: 1342 

batch 1399, loss: 0.0016, instance_loss: 0.3737, weighted_loss: 0.1132, label: 3, bag_size: 120 

batch 1499, loss: 0.0000, instance_loss: 0.1027, weighted_loss: 0.0308, label: 2, bag_size: 1064 

batch 1599, loss: 0.0004, instance_loss: 0.0964, weighted_loss: 0.0292, label: 2, bag_size: 902 

batch 1699, loss: 0.0001, instance_loss: 0.3847, weighted_loss: 0.1155, label: 2, bag_size: 740 

batch 1799, loss: 0.0002, instance_loss: 0.5102, weighted_loss: 0.1532, label: 2, bag_size: 220 

batch 1899, loss: 0.0001, instance_loss: 0.2672, weighted_loss: 0.0802, label: 2, bag_size: 334 

batch 1999, loss: 0.0001, instance_loss: 0.1154, weighted_loss: 0.0347, label: 2, bag_size: 456 

batch 2099, loss: 1.4780, instance_loss: 0.3904, weighted_loss: 1.1517, label: 2, bag_size: 460 

Instance Classifier Stats

class 0 clustering acc 0.9818836405529954: correct 68182/69440

class 1 clustering acc 0.5554147465437788: correct 9642/17360


Epoch: 24, train_loss: 0.0472, train_clustering_loss:  0.3154

class 0: acc 0.9545454545454546, correct 42/44 

class 1: acc 0.9884910485933504, correct 773/782 

class 2: acc 0.9889604415823368, correct 1075/1087 

class 3: acc 0.9649805447470817, correct 248/257 


Val Set, val_loss: 1.9584, auc: 0.7362 

class 0 clustering acc 0.9682765151515151: correct 8180/8448 

class 1 clustering acc 0.44886363636363635: correct 948/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.65625, correct 63/96 

class 2: acc 0.6940298507462687, correct 93/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6174

Overall F1 Score: 0.3942

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.1862, weighted_loss: 0.0559, label: 1, bag_size: 1204 

batch 199, loss: 0.0010, instance_loss: 0.1788, weighted_loss: 0.0543, label: 1, bag_size: 643 

batch 299, loss: 0.0026, instance_loss: 0.3910, weighted_loss: 0.1191, label: 2, bag_size: 2046 

batch 399, loss: 0.1071, instance_loss: 0.6715, weighted_loss: 0.2764, label: 3, bag_size: 361 

batch 499, loss: 0.0003, instance_loss: 0.0301, weighted_loss: 0.0092, label: 2, bag_size: 455 

batch 599, loss: 0.0004, instance_loss: 0.2084, weighted_loss: 0.0628, label: 2, bag_size: 597 

batch 699, loss: 0.0000, instance_loss: 0.1136, weighted_loss: 0.0341, label: 2, bag_size: 665 

batch 799, loss: 0.0024, instance_loss: 0.5305, weighted_loss: 0.1609, label: 3, bag_size: 681 

batch 899, loss: 0.0000, instance_loss: 0.2220, weighted_loss: 0.0666, label: 2, bag_size: 843 

batch 999, loss: 0.0000, instance_loss: 0.1917, weighted_loss: 0.0575, label: 1, bag_size: 2104 

batch 1099, loss: 2.5219, instance_loss: 0.3488, weighted_loss: 1.8700, label: 2, bag_size: 518 

batch 1199, loss: 0.0001, instance_loss: 0.4598, weighted_loss: 0.1380, label: 3, bag_size: 249 

batch 1299, loss: 0.0068, instance_loss: 0.3025, weighted_loss: 0.0955, label: 2, bag_size: 1897 

batch 1399, loss: 0.0000, instance_loss: 0.1274, weighted_loss: 0.0382, label: 2, bag_size: 182 

batch 1499, loss: 0.0000, instance_loss: 0.1162, weighted_loss: 0.0349, label: 2, bag_size: 788 

batch 1599, loss: 0.0011, instance_loss: 0.2589, weighted_loss: 0.0785, label: 2, bag_size: 235 

batch 1699, loss: 0.0001, instance_loss: 0.0840, weighted_loss: 0.0253, label: 2, bag_size: 541 

batch 1799, loss: 0.0000, instance_loss: 0.0155, weighted_loss: 0.0047, label: 1, bag_size: 1445 

batch 1899, loss: 0.0001, instance_loss: 0.3781, weighted_loss: 0.1135, label: 2, bag_size: 283 

batch 1999, loss: 0.0000, instance_loss: 0.5356, weighted_loss: 0.1607, label: 3, bag_size: 2813 

batch 2099, loss: 0.0000, instance_loss: 0.3028, weighted_loss: 0.0909, label: 2, bag_size: 608 

Instance Classifier Stats

class 0 clustering acc 0.9817396313364055: correct 68172/69440

class 1 clustering acc 0.5673387096774194: correct 9849/17360


Epoch: 25, train_loss: 0.0441, train_clustering_loss:  0.3096

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9872122762148338, correct 772/782 

class 2: acc 0.9862005519779209, correct 1072/1087 

class 3: acc 0.9649805447470817, correct 248/257 


Val Set, val_loss: 1.9169, auc: 0.7384 

class 0 clustering acc 0.9667376893939394: correct 8167/8448 

class 1 clustering acc 0.44176136363636365: correct 933/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6041666666666666, correct 58/96 

class 2: acc 0.7761194029850746, correct 104/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6364

Overall F1 Score: 0.3950

Training for coarse level...

batch 99, loss: 0.0012, instance_loss: 0.3170, weighted_loss: 0.0959, label: 3, bag_size: 152 

batch 199, loss: 0.0207, instance_loss: 0.6969, weighted_loss: 0.2236, label: 1, bag_size: 304 

batch 299, loss: 0.0000, instance_loss: 0.1198, weighted_loss: 0.0359, label: 2, bag_size: 330 

batch 399, loss: 0.0002, instance_loss: 0.5761, weighted_loss: 0.1730, label: 3, bag_size: 388 

batch 499, loss: 0.0000, instance_loss: 0.2368, weighted_loss: 0.0710, label: 2, bag_size: 1004 

batch 599, loss: 0.0000, instance_loss: 0.3591, weighted_loss: 0.1077, label: 2, bag_size: 396 

batch 699, loss: 0.0003, instance_loss: 0.5301, weighted_loss: 0.1592, label: 2, bag_size: 649 

batch 799, loss: 0.0000, instance_loss: 0.2170, weighted_loss: 0.0651, label: 1, bag_size: 204 

batch 899, loss: 0.0001, instance_loss: 0.1520, weighted_loss: 0.0457, label: 2, bag_size: 271 

batch 999, loss: 0.0000, instance_loss: 0.0431, weighted_loss: 0.0129, label: 1, bag_size: 3615 

batch 1099, loss: 0.0059, instance_loss: 0.3933, weighted_loss: 0.1221, label: 2, bag_size: 480 

batch 1199, loss: 0.0000, instance_loss: 0.0012, weighted_loss: 0.0004, label: 1, bag_size: 1104 

batch 1299, loss: 0.0001, instance_loss: 0.4357, weighted_loss: 0.1308, label: 3, bag_size: 716 

batch 1399, loss: 0.0043, instance_loss: 0.0391, weighted_loss: 0.0147, label: 2, bag_size: 225 

batch 1499, loss: 0.0031, instance_loss: 0.2159, weighted_loss: 0.0669, label: 1, bag_size: 1323 

batch 1599, loss: 0.0004, instance_loss: 0.0962, weighted_loss: 0.0292, label: 2, bag_size: 361 

batch 1699, loss: 0.0000, instance_loss: 0.0576, weighted_loss: 0.0173, label: 1, bag_size: 2272 

batch 1799, loss: 0.0175, instance_loss: 0.0188, weighted_loss: 0.0179, label: 2, bag_size: 424 

batch 1899, loss: 0.0000, instance_loss: 0.4350, weighted_loss: 0.1305, label: 2, bag_size: 843 

batch 1999, loss: 0.0001, instance_loss: 0.5029, weighted_loss: 0.1510, label: 3, bag_size: 172 

batch 2099, loss: 0.0007, instance_loss: 0.0622, weighted_loss: 0.0192, label: 2, bag_size: 295 

Instance Classifier Stats

class 0 clustering acc 0.9813076036866359: correct 68142/69440

class 1 clustering acc 0.5775345622119815: correct 10026/17360


Epoch: 26, train_loss: 0.0355, train_clustering_loss:  0.3068

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9872122762148338, correct 772/782 

class 2: acc 0.9935602575896965, correct 1080/1087 

class 3: acc 0.9766536964980544, correct 251/257 


Val Set, val_loss: 2.1448, auc: 0.7263 

class 0 clustering acc 0.9607007575757576: correct 8116/8448 

class 1 clustering acc 0.4720643939393939: correct 997/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.59375, correct 57/96 

class 2: acc 0.746268656716418, correct 100/134 

class 3: acc 0.16666666666666666, correct 5/30 

Overall Accuracy: 0.6136

Overall F1 Score: 0.3754

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0541, weighted_loss: 0.0162, label: 1, bag_size: 1628 

batch 199, loss: 0.0041, instance_loss: 0.7449, weighted_loss: 0.2263, label: 3, bag_size: 345 

batch 299, loss: 0.0000, instance_loss: 0.1194, weighted_loss: 0.0358, label: 2, bag_size: 412 

batch 399, loss: 0.0000, instance_loss: 0.0170, weighted_loss: 0.0051, label: 2, bag_size: 658 

batch 499, loss: 0.0001, instance_loss: 0.1646, weighted_loss: 0.0494, label: 2, bag_size: 1048 

batch 599, loss: 0.0001, instance_loss: 0.2355, weighted_loss: 0.0707, label: 2, bag_size: 396 

batch 699, loss: 0.0000, instance_loss: 0.4464, weighted_loss: 0.1339, label: 1, bag_size: 241 

batch 799, loss: 0.0000, instance_loss: 0.0077, weighted_loss: 0.0023, label: 1, bag_size: 778 

batch 899, loss: 0.0000, instance_loss: 0.2220, weighted_loss: 0.0666, label: 2, bag_size: 1347 

batch 999, loss: 0.0000, instance_loss: 0.3460, weighted_loss: 0.1038, label: 3, bag_size: 444 

batch 1099, loss: 0.0003, instance_loss: 0.5540, weighted_loss: 0.1664, label: 3, bag_size: 1529 

batch 1199, loss: 0.0012, instance_loss: 0.1125, weighted_loss: 0.0346, label: 2, bag_size: 192 

batch 1299, loss: 0.0000, instance_loss: 0.0551, weighted_loss: 0.0165, label: 1, bag_size: 53 

batch 1399, loss: 0.0011, instance_loss: 0.0441, weighted_loss: 0.0140, label: 2, bag_size: 462 

batch 1499, loss: 0.0014, instance_loss: 0.4486, weighted_loss: 0.1355, label: 0, bag_size: 101 

batch 1599, loss: 0.0000, instance_loss: 0.2405, weighted_loss: 0.0721, label: 2, bag_size: 483 

batch 1699, loss: 0.0002, instance_loss: 0.0199, weighted_loss: 0.0061, label: 1, bag_size: 504 

batch 1799, loss: 0.0013, instance_loss: 0.6365, weighted_loss: 0.1918, label: 3, bag_size: 462 

batch 1899, loss: 0.0010, instance_loss: 0.0763, weighted_loss: 0.0236, label: 1, bag_size: 1536 

batch 1999, loss: 0.0008, instance_loss: 0.4314, weighted_loss: 0.1299, label: 3, bag_size: 288 

batch 2099, loss: 0.0001, instance_loss: 0.3735, weighted_loss: 0.1122, label: 2, bag_size: 614 

Instance Classifier Stats

class 0 clustering acc 0.9826900921658986: correct 68238/69440

class 1 clustering acc 0.5663594470046083: correct 9832/17360


Epoch: 27, train_loss: 0.0556, train_clustering_loss:  0.3054

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9808184143222506, correct 767/782 

class 2: acc 0.984360625574977, correct 1070/1087 

class 3: acc 0.9688715953307393, correct 249/257 


Val Set, val_loss: 2.1983, auc: 0.7113 

class 0 clustering acc 0.9633049242424242: correct 8138/8448 

class 1 clustering acc 0.4346590909090909: correct 918/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.71875, correct 69/96 

class 2: acc 0.7089552238805971, correct 95/134 

class 3: acc 0.1, correct 3/30 

Overall Accuracy: 0.6326

Overall F1 Score: 0.3748

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.3680, weighted_loss: 0.1104, label: 2, bag_size: 206 

batch 199, loss: 0.0003, instance_loss: 0.5279, weighted_loss: 0.1585, label: 1, bag_size: 172 

batch 299, loss: 0.0001, instance_loss: 0.0163, weighted_loss: 0.0049, label: 2, bag_size: 859 

batch 399, loss: 0.0003, instance_loss: 0.1040, weighted_loss: 0.0314, label: 2, bag_size: 601 

batch 499, loss: 0.0003, instance_loss: 0.2602, weighted_loss: 0.0783, label: 1, bag_size: 2601 

batch 599, loss: 0.1269, instance_loss: 0.2528, weighted_loss: 0.1647, label: 1, bag_size: 1150 

batch 699, loss: 0.0001, instance_loss: 0.5417, weighted_loss: 0.1626, label: 1, bag_size: 317 

batch 799, loss: 0.0000, instance_loss: 0.0020, weighted_loss: 0.0006, label: 1, bag_size: 496 

batch 899, loss: 0.0000, instance_loss: 0.5804, weighted_loss: 0.1741, label: 1, bag_size: 933 

batch 999, loss: 0.0000, instance_loss: 0.0813, weighted_loss: 0.0244, label: 2, bag_size: 414 

batch 1099, loss: 0.0001, instance_loss: 0.3697, weighted_loss: 0.1110, label: 0, bag_size: 1736 

batch 1199, loss: 0.0000, instance_loss: 0.0796, weighted_loss: 0.0239, label: 1, bag_size: 848 

batch 1299, loss: 0.0000, instance_loss: 0.0415, weighted_loss: 0.0125, label: 2, bag_size: 761 

batch 1399, loss: 0.0000, instance_loss: 0.0239, weighted_loss: 0.0072, label: 1, bag_size: 1067 

batch 1499, loss: 0.0316, instance_loss: 0.9078, weighted_loss: 0.2944, label: 1, bag_size: 98 

batch 1599, loss: 0.0000, instance_loss: 0.0327, weighted_loss: 0.0098, label: 1, bag_size: 2154 

batch 1699, loss: 0.0000, instance_loss: 0.1338, weighted_loss: 0.0401, label: 1, bag_size: 685 

batch 1799, loss: 0.2379, instance_loss: 0.3006, weighted_loss: 0.2567, label: 2, bag_size: 246 

batch 1899, loss: 0.0029, instance_loss: 0.1501, weighted_loss: 0.0471, label: 2, bag_size: 113 

batch 1999, loss: 0.0000, instance_loss: 0.1036, weighted_loss: 0.0311, label: 2, bag_size: 821 

batch 2099, loss: 0.0001, instance_loss: 0.3411, weighted_loss: 0.1024, label: 1, bag_size: 187 

Instance Classifier Stats

class 0 clustering acc 0.9823732718894009: correct 68216/69440

class 1 clustering acc 0.5783410138248848: correct 10040/17360


Epoch: 28, train_loss: 0.0400, train_clustering_loss:  0.3041

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9872122762148338, correct 772/782 

class 2: acc 0.9926402943882244, correct 1079/1087 

class 3: acc 0.953307392996109, correct 245/257 


Val Set, val_loss: 2.1143, auc: 0.7306 

class 0 clustering acc 0.9668560606060606: correct 8168/8448 

class 1 clustering acc 0.42234848484848486: correct 892/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.7083333333333334, correct 68/96 

class 2: acc 0.6343283582089553, correct 85/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6061

Overall F1 Score: 0.3878

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.1024, weighted_loss: 0.0307, label: 1, bag_size: 189 

batch 199, loss: 0.0025, instance_loss: 0.0623, weighted_loss: 0.0205, label: 1, bag_size: 467 

batch 299, loss: 0.0000, instance_loss: 0.0063, weighted_loss: 0.0019, label: 1, bag_size: 488 

batch 399, loss: 0.0002, instance_loss: 0.0749, weighted_loss: 0.0226, label: 1, bag_size: 2692 

batch 499, loss: 0.0000, instance_loss: 0.4155, weighted_loss: 0.1247, label: 2, bag_size: 473 

batch 599, loss: 0.0030, instance_loss: 0.5950, weighted_loss: 0.1806, label: 2, bag_size: 375 

batch 699, loss: 0.0001, instance_loss: 0.2661, weighted_loss: 0.0799, label: 2, bag_size: 253 

batch 799, loss: 0.0001, instance_loss: 0.0552, weighted_loss: 0.0166, label: 2, bag_size: 381 

batch 899, loss: 0.0000, instance_loss: 0.2377, weighted_loss: 0.0713, label: 1, bag_size: 531 

batch 999, loss: 0.0064, instance_loss: 0.1317, weighted_loss: 0.0440, label: 1, bag_size: 2170 

batch 1099, loss: 0.0004, instance_loss: 0.0463, weighted_loss: 0.0142, label: 2, bag_size: 587 

batch 1199, loss: 0.0001, instance_loss: 0.5327, weighted_loss: 0.1599, label: 3, bag_size: 478 

batch 1299, loss: 0.0007, instance_loss: 0.0735, weighted_loss: 0.0226, label: 2, bag_size: 225 

batch 1399, loss: 0.0213, instance_loss: 0.1840, weighted_loss: 0.0701, label: 2, bag_size: 168 

batch 1499, loss: 0.0031, instance_loss: 0.0658, weighted_loss: 0.0219, label: 2, bag_size: 794 

batch 1599, loss: 0.0000, instance_loss: 0.0265, weighted_loss: 0.0079, label: 2, bag_size: 274 

batch 1699, loss: 0.0197, instance_loss: 0.8040, weighted_loss: 0.2550, label: 1, bag_size: 666 

batch 1799, loss: 0.0006, instance_loss: 0.1481, weighted_loss: 0.0448, label: 2, bag_size: 389 

batch 1899, loss: 0.0003, instance_loss: 0.6312, weighted_loss: 0.1896, label: 0, bag_size: 220 

batch 1999, loss: 0.0000, instance_loss: 0.3705, weighted_loss: 0.1111, label: 3, bag_size: 84 

batch 2099, loss: 0.0001, instance_loss: 0.4930, weighted_loss: 0.1480, label: 0, bag_size: 37 

Instance Classifier Stats

class 0 clustering acc 0.9830357142857142: correct 68262/69440

class 1 clustering acc 0.590668202764977: correct 10254/17360


Epoch: 29, train_loss: 0.0312, train_clustering_loss:  0.2967

class 0: acc 1.0, correct 44/44 

class 1: acc 0.989769820971867, correct 774/782 

class 2: acc 0.9944802207911684, correct 1081/1087 

class 3: acc 0.9883268482490273, correct 254/257 


Val Set, val_loss: 2.2257, auc: 0.7049 

class 0 clustering acc 0.9646070075757576: correct 8149/8448 

class 1 clustering acc 0.4498106060606061: correct 950/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.65625, correct 63/96 

class 2: acc 0.746268656716418, correct 100/134 

class 3: acc 0.26666666666666666, correct 8/30 

Overall Accuracy: 0.6477

Overall F1 Score: 0.4179

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0596, weighted_loss: 0.0179, label: 2, bag_size: 1058 

batch 199, loss: 0.0000, instance_loss: 0.0530, weighted_loss: 0.0159, label: 2, bag_size: 888 

batch 299, loss: 0.0000, instance_loss: 0.0343, weighted_loss: 0.0103, label: 1, bag_size: 270 

batch 399, loss: 0.0141, instance_loss: 0.3957, weighted_loss: 0.1286, label: 2, bag_size: 509 

batch 499, loss: 0.0555, instance_loss: 0.6235, weighted_loss: 0.2259, label: 2, bag_size: 921 

batch 599, loss: 0.0000, instance_loss: 0.1678, weighted_loss: 0.0504, label: 3, bag_size: 22 

batch 699, loss: 0.0000, instance_loss: 0.2716, weighted_loss: 0.0815, label: 1, bag_size: 356 

batch 799, loss: 0.0004, instance_loss: 0.3372, weighted_loss: 0.1015, label: 3, bag_size: 756 

batch 899, loss: 0.0001, instance_loss: 0.5363, weighted_loss: 0.1609, label: 3, bag_size: 338 

batch 999, loss: 0.0000, instance_loss: 0.0314, weighted_loss: 0.0094, label: 1, bag_size: 897 

batch 1099, loss: 0.0000, instance_loss: 0.2759, weighted_loss: 0.0828, label: 2, bag_size: 316 

batch 1199, loss: 0.0000, instance_loss: 0.2893, weighted_loss: 0.0868, label: 2, bag_size: 735 

batch 1299, loss: 0.0000, instance_loss: 0.0676, weighted_loss: 0.0203, label: 1, bag_size: 1460 

batch 1399, loss: 0.0007, instance_loss: 0.1762, weighted_loss: 0.0533, label: 2, bag_size: 422 

batch 1499, loss: 0.0005, instance_loss: 0.0685, weighted_loss: 0.0209, label: 2, bag_size: 789 

batch 1599, loss: 0.0022, instance_loss: 0.1728, weighted_loss: 0.0534, label: 1, bag_size: 607 

batch 1699, loss: 0.0000, instance_loss: 0.0762, weighted_loss: 0.0229, label: 2, bag_size: 287 

batch 1799, loss: 0.0000, instance_loss: 0.2547, weighted_loss: 0.0764, label: 2, bag_size: 394 

batch 1899, loss: 0.0056, instance_loss: 0.4737, weighted_loss: 0.1461, label: 2, bag_size: 1549 

batch 1999, loss: 0.0000, instance_loss: 0.0130, weighted_loss: 0.0039, label: 1, bag_size: 480 

batch 2099, loss: 0.0000, instance_loss: 0.0196, weighted_loss: 0.0059, label: 2, bag_size: 635 

Instance Classifier Stats

class 0 clustering acc 0.9829349078341014: correct 68255/69440

class 1 clustering acc 0.591705069124424: correct 10272/17360


Epoch: 30, train_loss: 0.0259, train_clustering_loss:  0.2942

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9936061381074168, correct 777/782 

class 2: acc 0.9935602575896965, correct 1080/1087 

class 3: acc 0.980544747081712, correct 252/257 


Val Set, val_loss: 2.4473, auc: 0.7169 

class 0 clustering acc 0.9646070075757576: correct 8149/8448 

class 1 clustering acc 0.4431818181818182: correct 936/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6979166666666666, correct 67/96 

class 2: acc 0.6865671641791045, correct 92/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6250

Overall F1 Score: 0.3955

Training for coarse level...

batch 99, loss: 0.0403, instance_loss: 0.6365, weighted_loss: 0.2192, label: 1, bag_size: 186 

batch 199, loss: 0.0280, instance_loss: 0.3800, weighted_loss: 0.1336, label: 1, bag_size: 2059 

batch 299, loss: 0.0000, instance_loss: 0.0362, weighted_loss: 0.0109, label: 2, bag_size: 333 

batch 399, loss: 0.0000, instance_loss: 0.1014, weighted_loss: 0.0304, label: 2, bag_size: 129 

batch 499, loss: 0.0031, instance_loss: 0.4247, weighted_loss: 0.1296, label: 2, bag_size: 850 

batch 599, loss: 0.0004, instance_loss: 0.2510, weighted_loss: 0.0756, label: 1, bag_size: 1223 

batch 699, loss: 0.0017, instance_loss: 0.1260, weighted_loss: 0.0390, label: 1, bag_size: 1727 

batch 799, loss: 0.0000, instance_loss: 0.1117, weighted_loss: 0.0335, label: 2, bag_size: 875 

batch 899, loss: 0.0011, instance_loss: 0.1609, weighted_loss: 0.0490, label: 2, bag_size: 232 

batch 999, loss: 0.0000, instance_loss: 0.4982, weighted_loss: 0.1495, label: 3, bag_size: 201 

batch 1099, loss: 0.0001, instance_loss: 0.4209, weighted_loss: 0.1263, label: 3, bag_size: 829 

batch 1199, loss: 0.0000, instance_loss: 0.4229, weighted_loss: 0.1269, label: 1, bag_size: 377 

batch 1299, loss: 0.0000, instance_loss: 0.3320, weighted_loss: 0.0996, label: 3, bag_size: 452 

batch 1399, loss: 0.0000, instance_loss: 0.2954, weighted_loss: 0.0886, label: 2, bag_size: 929 

batch 1499, loss: 0.0000, instance_loss: 0.0478, weighted_loss: 0.0143, label: 2, bag_size: 495 

batch 1599, loss: 0.0000, instance_loss: 0.0556, weighted_loss: 0.0167, label: 2, bag_size: 645 

batch 1699, loss: 0.0008, instance_loss: 0.4852, weighted_loss: 0.1461, label: 1, bag_size: 394 

batch 1799, loss: 0.0000, instance_loss: 0.1953, weighted_loss: 0.0586, label: 2, bag_size: 362 

batch 1899, loss: 0.0002, instance_loss: 0.1641, weighted_loss: 0.0494, label: 1, bag_size: 1535 

batch 1999, loss: 0.0000, instance_loss: 0.0843, weighted_loss: 0.0253, label: 2, bag_size: 574 

batch 2099, loss: 0.0000, instance_loss: 0.5254, weighted_loss: 0.1576, label: 2, bag_size: 276 

Instance Classifier Stats

class 0 clustering acc 0.9819412442396314: correct 68186/69440

class 1 clustering acc 0.5796082949308756: correct 10062/17360


Epoch: 31, train_loss: 0.0418, train_clustering_loss:  0.3026

class 0: acc 0.9545454545454546, correct 42/44 

class 1: acc 0.9846547314578005, correct 770/782 

class 2: acc 0.9871205151793928, correct 1073/1087 

class 3: acc 0.9766536964980544, correct 251/257 


Val Set, val_loss: 2.4641, auc: 0.7154 

class 0 clustering acc 0.9679214015151515: correct 8177/8448 

class 1 clustering acc 0.43797348484848486: correct 925/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6458333333333334, correct 62/96 

class 2: acc 0.7014925373134329, correct 94/134 

class 3: acc 0.26666666666666666, correct 8/30 

Overall Accuracy: 0.6212

Overall F1 Score: 0.4018

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0460, weighted_loss: 0.0138, label: 1, bag_size: 873 

batch 199, loss: 0.0000, instance_loss: 0.3940, weighted_loss: 0.1182, label: 2, bag_size: 243 

batch 299, loss: 0.0054, instance_loss: 0.2632, weighted_loss: 0.0827, label: 2, bag_size: 636 

batch 399, loss: 0.0000, instance_loss: 0.0465, weighted_loss: 0.0140, label: 1, bag_size: 1323 

batch 499, loss: 0.0000, instance_loss: 0.2386, weighted_loss: 0.0716, label: 1, bag_size: 975 

batch 599, loss: 0.0000, instance_loss: 0.3340, weighted_loss: 0.1002, label: 1, bag_size: 568 

batch 699, loss: 0.0000, instance_loss: 0.0718, weighted_loss: 0.0216, label: 2, bag_size: 208 

batch 799, loss: 0.0000, instance_loss: 0.1033, weighted_loss: 0.0310, label: 2, bag_size: 352 

batch 899, loss: 0.0007, instance_loss: 0.0368, weighted_loss: 0.0115, label: 2, bag_size: 563 

batch 999, loss: 0.0001, instance_loss: 0.1721, weighted_loss: 0.0517, label: 2, bag_size: 621 

batch 1099, loss: 0.0214, instance_loss: 0.1584, weighted_loss: 0.0625, label: 2, bag_size: 667 

batch 1199, loss: 0.0000, instance_loss: 0.0116, weighted_loss: 0.0035, label: 2, bag_size: 246 

batch 1299, loss: 0.0000, instance_loss: 0.0340, weighted_loss: 0.0102, label: 1, bag_size: 2086 

batch 1399, loss: 0.0000, instance_loss: 0.4138, weighted_loss: 0.1241, label: 1, bag_size: 1860 

batch 1499, loss: 0.0000, instance_loss: 0.0786, weighted_loss: 0.0236, label: 2, bag_size: 576 

batch 1599, loss: 0.0030, instance_loss: 0.3976, weighted_loss: 0.1214, label: 2, bag_size: 106 

batch 1699, loss: 0.0003, instance_loss: 0.2171, weighted_loss: 0.0653, label: 2, bag_size: 266 

batch 1799, loss: 0.0000, instance_loss: 0.0116, weighted_loss: 0.0035, label: 2, bag_size: 290 

batch 1899, loss: 2.6183, instance_loss: 0.7966, weighted_loss: 2.0718, label: 3, bag_size: 383 

batch 1999, loss: 0.0000, instance_loss: 0.0927, weighted_loss: 0.0278, label: 0, bag_size: 119 

batch 2099, loss: 0.0000, instance_loss: 0.2998, weighted_loss: 0.0899, label: 2, bag_size: 483 

Instance Classifier Stats

class 0 clustering acc 0.9827908986175116: correct 68245/69440

class 1 clustering acc 0.583352534562212: correct 10127/17360


Epoch: 32, train_loss: 0.0388, train_clustering_loss:  0.2983

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9872122762148338, correct 772/782 

class 2: acc 0.9926402943882244, correct 1079/1087 

class 3: acc 0.9844357976653697, correct 253/257 


Val Set, val_loss: 2.4470, auc: 0.6921 

class 0 clustering acc 0.9682765151515151: correct 8180/8448 

class 1 clustering acc 0.40767045454545453: correct 861/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6875, correct 66/96 

class 2: acc 0.6716417910447762, correct 90/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6136

Overall F1 Score: 0.3881

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.2177, weighted_loss: 0.0653, label: 2, bag_size: 216 

batch 199, loss: 0.0002, instance_loss: 0.2582, weighted_loss: 0.0776, label: 1, bag_size: 1744 

batch 299, loss: 0.0026, instance_loss: 0.5257, weighted_loss: 0.1595, label: 1, bag_size: 347 

batch 399, loss: 0.0001, instance_loss: 0.3097, weighted_loss: 0.0930, label: 2, bag_size: 115 

batch 499, loss: 0.1867, instance_loss: 0.2299, weighted_loss: 0.1997, label: 2, bag_size: 589 

batch 599, loss: 0.0052, instance_loss: 0.2087, weighted_loss: 0.0663, label: 2, bag_size: 108 

batch 699, loss: 0.0000, instance_loss: 0.0195, weighted_loss: 0.0059, label: 1, bag_size: 379 

batch 799, loss: 0.0344, instance_loss: 0.5194, weighted_loss: 0.1799, label: 1, bag_size: 471 

batch 899, loss: 0.0000, instance_loss: 0.0323, weighted_loss: 0.0097, label: 1, bag_size: 897 

batch 999, loss: 0.0003, instance_loss: 0.6756, weighted_loss: 0.2029, label: 1, bag_size: 356 

batch 1099, loss: 0.0226, instance_loss: 0.8891, weighted_loss: 0.2825, label: 3, bag_size: 328 

batch 1199, loss: 0.0004, instance_loss: 0.3347, weighted_loss: 0.1007, label: 0, bag_size: 198 

batch 1299, loss: 0.0000, instance_loss: 0.4843, weighted_loss: 0.1453, label: 2, bag_size: 687 

batch 1399, loss: 0.0106, instance_loss: 0.4107, weighted_loss: 0.1306, label: 2, bag_size: 808 

batch 1499, loss: 0.0000, instance_loss: 0.4192, weighted_loss: 0.1257, label: 1, bag_size: 749 

batch 1599, loss: 0.0000, instance_loss: 0.0203, weighted_loss: 0.0061, label: 2, bag_size: 1015 

batch 1699, loss: 0.0000, instance_loss: 0.0730, weighted_loss: 0.0219, label: 2, bag_size: 1140 

batch 1799, loss: 0.0000, instance_loss: 0.0283, weighted_loss: 0.0085, label: 2, bag_size: 559 

batch 1899, loss: 0.0001, instance_loss: 0.0331, weighted_loss: 0.0100, label: 2, bag_size: 318 

batch 1999, loss: 0.0000, instance_loss: 0.2032, weighted_loss: 0.0610, label: 2, bag_size: 677 

batch 2099, loss: 0.0000, instance_loss: 0.4196, weighted_loss: 0.1259, label: 1, bag_size: 746 

Instance Classifier Stats

class 0 clustering acc 0.9828629032258065: correct 68250/69440

class 1 clustering acc 0.5884216589861752: correct 10215/17360


Epoch: 33, train_loss: 0.0419, train_clustering_loss:  0.2945

class 0: acc 0.9545454545454546, correct 42/44 

class 1: acc 0.989769820971867, correct 774/782 

class 2: acc 0.9898804047838087, correct 1076/1087 

class 3: acc 0.9727626459143969, correct 250/257 


Val Set, val_loss: 2.1858, auc: 0.7373 

class 0 clustering acc 0.9598721590909091: correct 8109/8448 

class 1 clustering acc 0.4715909090909091: correct 996/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.65625, correct 63/96 

class 2: acc 0.7686567164179104, correct 103/134 

class 3: acc 0.16666666666666666, correct 5/30 

Overall Accuracy: 0.6477

Overall F1 Score: 0.3967

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.2065, weighted_loss: 0.0620, label: 2, bag_size: 403 

batch 199, loss: 0.0034, instance_loss: 0.2346, weighted_loss: 0.0728, label: 2, bag_size: 802 

batch 299, loss: 0.0012, instance_loss: 0.4406, weighted_loss: 0.1330, label: 2, bag_size: 228 

batch 399, loss: 0.0000, instance_loss: 0.2865, weighted_loss: 0.0860, label: 1, bag_size: 749 

batch 499, loss: 0.0002, instance_loss: 0.0473, weighted_loss: 0.0143, label: 2, bag_size: 1049 

batch 599, loss: 0.0000, instance_loss: 0.2714, weighted_loss: 0.0814, label: 1, bag_size: 927 

batch 699, loss: 0.0000, instance_loss: 0.3725, weighted_loss: 0.1118, label: 2, bag_size: 369 

batch 799, loss: 0.0000, instance_loss: 0.5537, weighted_loss: 0.1661, label: 3, bag_size: 710 

batch 899, loss: 0.0002, instance_loss: 1.0303, weighted_loss: 0.3092, label: 0, bag_size: 260 

batch 999, loss: 0.0000, instance_loss: 0.6166, weighted_loss: 0.1850, label: 1, bag_size: 622 

batch 1099, loss: 0.0000, instance_loss: 0.0249, weighted_loss: 0.0075, label: 2, bag_size: 1222 

batch 1199, loss: 0.0002, instance_loss: 0.0539, weighted_loss: 0.0163, label: 1, bag_size: 309 

batch 1299, loss: 0.0000, instance_loss: 0.3738, weighted_loss: 0.1122, label: 2, bag_size: 926 

batch 1399, loss: 0.0000, instance_loss: 0.0140, weighted_loss: 0.0042, label: 1, bag_size: 941 

batch 1499, loss: 0.0218, instance_loss: 0.4229, weighted_loss: 0.1421, label: 2, bag_size: 471 

batch 1599, loss: 0.0000, instance_loss: 0.2434, weighted_loss: 0.0730, label: 2, bag_size: 896 

batch 1699, loss: 0.0000, instance_loss: 0.2458, weighted_loss: 0.0737, label: 2, bag_size: 201 

batch 1799, loss: 0.0000, instance_loss: 0.0184, weighted_loss: 0.0055, label: 1, bag_size: 2213 

batch 1899, loss: 0.0002, instance_loss: 0.3069, weighted_loss: 0.0922, label: 2, bag_size: 890 

batch 1999, loss: 0.0000, instance_loss: 0.0375, weighted_loss: 0.0112, label: 1, bag_size: 298 

batch 2099, loss: 0.0000, instance_loss: 0.0137, weighted_loss: 0.0041, label: 1, bag_size: 1981 

Instance Classifier Stats

class 0 clustering acc 0.9830501152073733: correct 68263/69440

class 1 clustering acc 0.5934331797235023: correct 10302/17360


Epoch: 34, train_loss: 0.0241, train_clustering_loss:  0.2895

class 0: acc 1.0, correct 44/44 

class 1: acc 0.9910485933503836, correct 775/782 

class 2: acc 0.9926402943882244, correct 1079/1087 

class 3: acc 0.9844357976653697, correct 253/257 


Val Set, val_loss: 2.3811, auc: 0.7043 

class 0 clustering acc 0.9578598484848485: correct 8092/8448 

class 1 clustering acc 0.4715909090909091: correct 996/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6979166666666666, correct 67/96 

class 2: acc 0.7313432835820896, correct 98/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6477

Overall F1 Score: 0.4095

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.3439, weighted_loss: 0.1032, label: 3, bag_size: 464 

batch 199, loss: 0.0021, instance_loss: 0.0836, weighted_loss: 0.0266, label: 1, bag_size: 1189 

batch 299, loss: 0.0001, instance_loss: 0.2167, weighted_loss: 0.0650, label: 2, bag_size: 328 

batch 399, loss: 0.0074, instance_loss: 0.1037, weighted_loss: 0.0363, label: 2, bag_size: 601 

batch 499, loss: 0.0000, instance_loss: 0.3603, weighted_loss: 0.1081, label: 1, bag_size: 483 

batch 599, loss: 0.0000, instance_loss: 0.0119, weighted_loss: 0.0036, label: 1, bag_size: 447 

batch 699, loss: 0.0051, instance_loss: 0.4849, weighted_loss: 0.1490, label: 1, bag_size: 167 

batch 799, loss: 0.0001, instance_loss: 0.2709, weighted_loss: 0.0813, label: 2, bag_size: 620 

batch 899, loss: 0.0345, instance_loss: 1.1871, weighted_loss: 0.3803, label: 1, bag_size: 486 

batch 999, loss: 0.0000, instance_loss: 0.0759, weighted_loss: 0.0228, label: 1, bag_size: 1692 

batch 1099, loss: 0.0000, instance_loss: 0.0287, weighted_loss: 0.0086, label: 2, bag_size: 323 

batch 1199, loss: 0.0001, instance_loss: 0.0854, weighted_loss: 0.0257, label: 2, bag_size: 209 

batch 1299, loss: 0.0003, instance_loss: 0.7798, weighted_loss: 0.2341, label: 0, bag_size: 207 

batch 1399, loss: 0.0000, instance_loss: 0.5137, weighted_loss: 0.1541, label: 1, bag_size: 427 

batch 1499, loss: 0.0763, instance_loss: 0.3364, weighted_loss: 0.1543, label: 2, bag_size: 718 

batch 1599, loss: 0.0001, instance_loss: 0.7095, weighted_loss: 0.2129, label: 1, bag_size: 78 

batch 1699, loss: 0.0000, instance_loss: 0.6210, weighted_loss: 0.1863, label: 3, bag_size: 868 

batch 1799, loss: 0.0000, instance_loss: 0.0052, weighted_loss: 0.0015, label: 1, bag_size: 847 

batch 1899, loss: 0.0003, instance_loss: 0.3545, weighted_loss: 0.1066, label: 2, bag_size: 770 

batch 1999, loss: 0.0000, instance_loss: 0.0647, weighted_loss: 0.0194, label: 2, bag_size: 310 

batch 2099, loss: 0.0005, instance_loss: 0.7686, weighted_loss: 0.2309, label: 2, bag_size: 1836 

Instance Classifier Stats

class 0 clustering acc 0.9824020737327189: correct 68218/69440

class 1 clustering acc 0.602073732718894: correct 10452/17360


Epoch: 35, train_loss: 0.0281, train_clustering_loss:  0.2919

class 0: acc 1.0, correct 44/44 

class 1: acc 0.9910485933503836, correct 775/782 

class 2: acc 0.9917203311867525, correct 1078/1087 

class 3: acc 0.9610894941634242, correct 247/257 


Val Set, val_loss: 2.5880, auc: 0.7212 

class 0 clustering acc 0.9685132575757576: correct 8182/8448 

class 1 clustering acc 0.4237689393939394: correct 895/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6458333333333334, correct 62/96 

class 2: acc 0.7238805970149254, correct 97/134 

class 3: acc 0.26666666666666666, correct 8/30 

Overall Accuracy: 0.6326

Overall F1 Score: 0.4052

Training for coarse level...

batch 99, loss: 0.0002, instance_loss: 0.3814, weighted_loss: 0.1145, label: 2, bag_size: 2114 

batch 199, loss: 0.0000, instance_loss: 0.0532, weighted_loss: 0.0160, label: 1, bag_size: 298 

batch 299, loss: 0.0004, instance_loss: 0.0702, weighted_loss: 0.0213, label: 2, bag_size: 679 

batch 399, loss: 0.0001, instance_loss: 0.1609, weighted_loss: 0.0483, label: 1, bag_size: 570 

batch 499, loss: 0.0239, instance_loss: 0.6457, weighted_loss: 0.2105, label: 3, bag_size: 901 

batch 599, loss: 0.0000, instance_loss: 0.1752, weighted_loss: 0.0526, label: 1, bag_size: 673 

batch 699, loss: 0.0000, instance_loss: 0.1543, weighted_loss: 0.0463, label: 2, bag_size: 308 

batch 799, loss: 0.0014, instance_loss: 0.1502, weighted_loss: 0.0460, label: 2, bag_size: 1217 

batch 899, loss: 0.0000, instance_loss: 0.0686, weighted_loss: 0.0206, label: 1, bag_size: 2219 

batch 999, loss: 0.0006, instance_loss: 0.1450, weighted_loss: 0.0439, label: 2, bag_size: 298 

batch 1099, loss: 0.0000, instance_loss: 0.3509, weighted_loss: 0.1053, label: 3, bag_size: 179 

batch 1199, loss: 0.0332, instance_loss: 0.5530, weighted_loss: 0.1891, label: 1, bag_size: 37 

batch 1299, loss: 0.0047, instance_loss: 0.3089, weighted_loss: 0.0959, label: 1, bag_size: 1061 

batch 1399, loss: 0.0000, instance_loss: 0.0172, weighted_loss: 0.0052, label: 2, bag_size: 987 

batch 1499, loss: 0.0007, instance_loss: 0.2946, weighted_loss: 0.0889, label: 1, bag_size: 258 

batch 1599, loss: 0.0003, instance_loss: 0.5946, weighted_loss: 0.1786, label: 1, bag_size: 381 

batch 1699, loss: 0.0001, instance_loss: 0.4137, weighted_loss: 0.1242, label: 2, bag_size: 1364 

batch 1799, loss: 0.0000, instance_loss: 0.0508, weighted_loss: 0.0153, label: 2, bag_size: 341 

batch 1899, loss: 0.0002, instance_loss: 0.3448, weighted_loss: 0.1036, label: 0, bag_size: 101 

batch 1999, loss: 0.0000, instance_loss: 0.7557, weighted_loss: 0.2267, label: 0, bag_size: 1452 

batch 2099, loss: 0.0095, instance_loss: 0.0839, weighted_loss: 0.0318, label: 2, bag_size: 336 

Instance Classifier Stats

class 0 clustering acc 0.9823732718894009: correct 68216/69440

class 1 clustering acc 0.6061059907834101: correct 10522/17360


Epoch: 36, train_loss: 0.0228, train_clustering_loss:  0.2868

class 0: acc 0.9545454545454546, correct 42/44 

class 1: acc 0.9910485933503836, correct 775/782 

class 2: acc 0.9972401103955841, correct 1084/1087 

class 3: acc 0.9844357976653697, correct 253/257 


Val Set, val_loss: 2.3627, auc: 0.7258 

class 0 clustering acc 0.9661458333333334: correct 8162/8448 

class 1 clustering acc 0.44886363636363635: correct 948/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6770833333333334, correct 65/96 

class 2: acc 0.7089552238805971, correct 95/134 

class 3: acc 0.26666666666666666, correct 8/30 

Overall Accuracy: 0.6364

Overall F1 Score: 0.4159

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.1950, weighted_loss: 0.0585, label: 1, bag_size: 1860 

batch 199, loss: 0.0001, instance_loss: 0.4666, weighted_loss: 0.1400, label: 1, bag_size: 1061 

batch 299, loss: 0.0000, instance_loss: 0.1096, weighted_loss: 0.0329, label: 1, bag_size: 244 

batch 399, loss: 0.0000, instance_loss: 0.0723, weighted_loss: 0.0217, label: 1, bag_size: 410 

batch 499, loss: 0.0000, instance_loss: 0.3016, weighted_loss: 0.0905, label: 1, bag_size: 566 

batch 599, loss: 0.0219, instance_loss: 0.3190, weighted_loss: 0.1110, label: 2, bag_size: 376 

batch 699, loss: 0.0018, instance_loss: 0.4844, weighted_loss: 0.1466, label: 1, bag_size: 305 

batch 799, loss: 0.0000, instance_loss: 0.1665, weighted_loss: 0.0499, label: 2, bag_size: 274 

batch 899, loss: 0.0227, instance_loss: 0.5340, weighted_loss: 0.1761, label: 1, bag_size: 298 

batch 999, loss: 0.0000, instance_loss: 0.2557, weighted_loss: 0.0767, label: 1, bag_size: 1323 

batch 1099, loss: 0.0000, instance_loss: 0.0482, weighted_loss: 0.0144, label: 2, bag_size: 518 

batch 1199, loss: 0.0000, instance_loss: 0.0322, weighted_loss: 0.0097, label: 2, bag_size: 389 

batch 1299, loss: 0.0003, instance_loss: 0.2199, weighted_loss: 0.0662, label: 2, bag_size: 206 

batch 1399, loss: 0.0458, instance_loss: 0.4010, weighted_loss: 0.1524, label: 2, bag_size: 344 

batch 1499, loss: 0.0000, instance_loss: 0.2786, weighted_loss: 0.0836, label: 1, bag_size: 517 

batch 1599, loss: 0.0000, instance_loss: 0.0159, weighted_loss: 0.0048, label: 2, bag_size: 475 

batch 1699, loss: 0.0000, instance_loss: 0.1000, weighted_loss: 0.0300, label: 2, bag_size: 844 

batch 1799, loss: 0.0251, instance_loss: 0.3710, weighted_loss: 0.1289, label: 1, bag_size: 575 

batch 1899, loss: 0.0012, instance_loss: 0.3399, weighted_loss: 0.1028, label: 2, bag_size: 270 

batch 1999, loss: 0.0000, instance_loss: 0.2432, weighted_loss: 0.0730, label: 3, bag_size: 417 

batch 2099, loss: 0.0000, instance_loss: 0.5930, weighted_loss: 0.1779, label: 2, bag_size: 304 

Instance Classifier Stats

class 0 clustering acc 0.9837413594470046: correct 68311/69440

class 1 clustering acc 0.6016129032258064: correct 10444/17360


Epoch: 37, train_loss: 0.0378, train_clustering_loss:  0.2913

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9936061381074168, correct 777/782 

class 2: acc 0.9880404783808647, correct 1074/1087 

class 3: acc 0.9766536964980544, correct 251/257 


Val Set, val_loss: 2.2098, auc: 0.7331 

class 0 clustering acc 0.9585700757575758: correct 8098/8448 

class 1 clustering acc 0.48295454545454547: correct 1020/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.7291666666666666, correct 70/96 

class 2: acc 0.7313432835820896, correct 98/134 

class 3: acc 0.3, correct 9/30 

Overall Accuracy: 0.6705

Overall F1 Score: 0.4374

Training for coarse level...

batch 99, loss: 0.0006, instance_loss: 0.3193, weighted_loss: 0.0962, label: 1, bag_size: 65 

batch 199, loss: 0.0000, instance_loss: 0.9305, weighted_loss: 0.2791, label: 0, bag_size: 220 

batch 299, loss: 0.0000, instance_loss: 0.0326, weighted_loss: 0.0098, label: 2, bag_size: 216 

batch 399, loss: 0.0013, instance_loss: 0.6521, weighted_loss: 0.1966, label: 1, bag_size: 339 

batch 499, loss: 0.0005, instance_loss: 0.2441, weighted_loss: 0.0736, label: 2, bag_size: 267 

batch 599, loss: 0.0007, instance_loss: 0.5240, weighted_loss: 0.1577, label: 2, bag_size: 333 

batch 699, loss: 0.1746, instance_loss: 0.9042, weighted_loss: 0.3935, label: 1, bag_size: 738 

batch 799, loss: 0.0121, instance_loss: 0.3554, weighted_loss: 0.1151, label: 2, bag_size: 235 

batch 899, loss: 0.0000, instance_loss: 0.0535, weighted_loss: 0.0160, label: 2, bag_size: 605 

batch 999, loss: 0.3987, instance_loss: 1.0292, weighted_loss: 0.5879, label: 1, bag_size: 983 

batch 1099, loss: 0.0000, instance_loss: 0.5130, weighted_loss: 0.1539, label: 2, bag_size: 243 

batch 1199, loss: 0.0000, instance_loss: 0.0827, weighted_loss: 0.0248, label: 1, bag_size: 457 

batch 1299, loss: 0.0003, instance_loss: 1.0766, weighted_loss: 0.3232, label: 1, bag_size: 953 

batch 1399, loss: 0.0004, instance_loss: 0.3480, weighted_loss: 0.1046, label: 2, bag_size: 463 

batch 1499, loss: 0.0007, instance_loss: 0.2069, weighted_loss: 0.0626, label: 2, bag_size: 290 

batch 1599, loss: 0.0015, instance_loss: 0.4159, weighted_loss: 0.1258, label: 1, bag_size: 1211 

batch 1699, loss: 0.0000, instance_loss: 0.2180, weighted_loss: 0.0654, label: 2, bag_size: 714 

batch 1799, loss: 0.0009, instance_loss: 0.3414, weighted_loss: 0.1031, label: 1, bag_size: 119 

batch 1899, loss: 0.0005, instance_loss: 0.4146, weighted_loss: 0.1247, label: 2, bag_size: 497 

batch 1999, loss: 0.0000, instance_loss: 0.4748, weighted_loss: 0.1425, label: 2, bag_size: 850 

batch 2099, loss: 0.0000, instance_loss: 0.0634, weighted_loss: 0.0190, label: 2, bag_size: 712 

Instance Classifier Stats

class 0 clustering acc 0.9820564516129032: correct 68194/69440

class 1 clustering acc 0.605241935483871: correct 10507/17360


Epoch: 38, train_loss: 0.0297, train_clustering_loss:  0.2858

class 0: acc 1.0, correct 44/44 

class 1: acc 0.9923273657289002, correct 776/782 

class 2: acc 0.9926402943882244, correct 1079/1087 

class 3: acc 0.9844357976653697, correct 253/257 


Val Set, val_loss: 2.2416, auc: 0.7186 

class 0 clustering acc 0.9637784090909091: correct 8142/8448 

class 1 clustering acc 0.4659090909090909: correct 984/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.7083333333333334, correct 68/96 

class 2: acc 0.6940298507462687, correct 93/134 

class 3: acc 0.3333333333333333, correct 10/30 

Overall Accuracy: 0.6477

Overall F1 Score: 0.4322

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0949, weighted_loss: 0.0285, label: 2, bag_size: 521 

batch 199, loss: 0.0000, instance_loss: 0.1923, weighted_loss: 0.0577, label: 2, bag_size: 1479 

batch 299, loss: 0.0032, instance_loss: 0.1635, weighted_loss: 0.0513, label: 2, bag_size: 326 

batch 399, loss: 0.0000, instance_loss: 0.0966, weighted_loss: 0.0290, label: 2, bag_size: 532 

batch 499, loss: 0.0453, instance_loss: 0.5467, weighted_loss: 0.1957, label: 1, bag_size: 168 

batch 599, loss: 0.0000, instance_loss: 0.3251, weighted_loss: 0.0975, label: 1, bag_size: 1616 

batch 699, loss: 0.0001, instance_loss: 0.1908, weighted_loss: 0.0573, label: 3, bag_size: 574 

batch 799, loss: 0.0001, instance_loss: 0.4543, weighted_loss: 0.1364, label: 3, bag_size: 333 

batch 899, loss: 0.0000, instance_loss: 0.0790, weighted_loss: 0.0237, label: 2, bag_size: 346 

batch 999, loss: 0.0424, instance_loss: 0.4673, weighted_loss: 0.1699, label: 1, bag_size: 190 

batch 1099, loss: 0.0007, instance_loss: 0.3624, weighted_loss: 0.1092, label: 3, bag_size: 1274 

batch 1199, loss: 0.0115, instance_loss: 0.1315, weighted_loss: 0.0475, label: 2, bag_size: 619 

batch 1299, loss: 0.0006, instance_loss: 0.3899, weighted_loss: 0.1174, label: 1, bag_size: 287 

batch 1399, loss: 0.0001, instance_loss: 0.4763, weighted_loss: 0.1429, label: 2, bag_size: 489 

batch 1499, loss: 0.0015, instance_loss: 0.3051, weighted_loss: 0.0926, label: 2, bag_size: 643 

batch 1599, loss: 0.0000, instance_loss: 0.0388, weighted_loss: 0.0116, label: 2, bag_size: 605 

batch 1699, loss: 0.0000, instance_loss: 0.1333, weighted_loss: 0.0400, label: 2, bag_size: 366 

batch 1799, loss: 0.0000, instance_loss: 0.0568, weighted_loss: 0.0171, label: 2, bag_size: 1064 

batch 1899, loss: 0.0000, instance_loss: 0.4629, weighted_loss: 0.1389, label: 3, bag_size: 344 

batch 1999, loss: 0.0001, instance_loss: 0.0788, weighted_loss: 0.0237, label: 1, bag_size: 457 

batch 2099, loss: 0.0000, instance_loss: 0.5207, weighted_loss: 0.1562, label: 3, bag_size: 710 

Instance Classifier Stats

class 0 clustering acc 0.9834677419354839: correct 68292/69440

class 1 clustering acc 0.6220622119815669: correct 10799/17360


Epoch: 39, train_loss: 0.0140, train_clustering_loss:  0.2755

class 0: acc 1.0, correct 44/44 

class 1: acc 0.9948849104859335, correct 778/782 

class 2: acc 0.9963201471941122, correct 1083/1087 

class 3: acc 0.9883268482490273, correct 254/257 


Val Set, val_loss: 2.3809, auc: 0.7404 

class 0 clustering acc 0.9583333333333334: correct 8096/8448 

class 1 clustering acc 0.47490530303030304: correct 1003/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.71875, correct 69/96 

class 2: acc 0.6716417910447762, correct 90/134 

class 3: acc 0.43333333333333335, correct 13/30 

Overall Accuracy: 0.6515

Overall F1 Score: 0.4479

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.1159, weighted_loss: 0.0348, label: 2, bag_size: 339 

batch 199, loss: 0.0000, instance_loss: 0.1163, weighted_loss: 0.0349, label: 1, bag_size: 88 

batch 299, loss: 0.0000, instance_loss: 0.4473, weighted_loss: 0.1342, label: 1, bag_size: 308 

batch 399, loss: 0.0000, instance_loss: 0.0045, weighted_loss: 0.0013, label: 1, bag_size: 848 

batch 499, loss: 0.0000, instance_loss: 0.0028, weighted_loss: 0.0008, label: 1, bag_size: 836 

batch 599, loss: 0.0000, instance_loss: 0.0114, weighted_loss: 0.0034, label: 2, bag_size: 432 

batch 699, loss: 0.0011, instance_loss: 0.2323, weighted_loss: 0.0705, label: 1, bag_size: 1124 

batch 799, loss: 0.0038, instance_loss: 0.3385, weighted_loss: 0.1042, label: 2, bag_size: 435 

batch 899, loss: 0.0002, instance_loss: 0.2879, weighted_loss: 0.0865, label: 0, bag_size: 153 

batch 999, loss: 0.0184, instance_loss: 0.6231, weighted_loss: 0.1998, label: 1, bag_size: 1009 

batch 1099, loss: 0.0011, instance_loss: 1.2780, weighted_loss: 0.3841, label: 1, bag_size: 209 

batch 1199, loss: 0.0283, instance_loss: 0.2036, weighted_loss: 0.0809, label: 2, bag_size: 393 

batch 1299, loss: 0.0066, instance_loss: 0.7220, weighted_loss: 0.2212, label: 1, bag_size: 696 

batch 1399, loss: 0.0000, instance_loss: 0.1794, weighted_loss: 0.0538, label: 3, bag_size: 118 

batch 1499, loss: 0.0287, instance_loss: 0.2758, weighted_loss: 0.1028, label: 2, bag_size: 259 

batch 1599, loss: 0.0000, instance_loss: 0.0717, weighted_loss: 0.0215, label: 1, bag_size: 1692 

batch 1699, loss: 0.0006, instance_loss: 0.7736, weighted_loss: 0.2325, label: 3, bag_size: 558 

batch 1799, loss: 0.0000, instance_loss: 0.5810, weighted_loss: 0.1743, label: 1, bag_size: 965 

batch 1899, loss: 0.0000, instance_loss: 0.1342, weighted_loss: 0.0402, label: 1, bag_size: 1181 

batch 1999, loss: 0.0000, instance_loss: 0.1583, weighted_loss: 0.0475, label: 2, bag_size: 519 

batch 2099, loss: 0.0007, instance_loss: 0.3442, weighted_loss: 0.1038, label: 3, bag_size: 628 

Instance Classifier Stats

class 0 clustering acc 0.9830789170506913: correct 68265/69440

class 1 clustering acc 0.6203341013824885: correct 10769/17360


Epoch: 40, train_loss: 0.0254, train_clustering_loss:  0.2796

class 0: acc 0.9545454545454546, correct 42/44 

class 1: acc 0.9961636828644501, correct 779/782 

class 2: acc 0.9944802207911684, correct 1081/1087 

class 3: acc 0.9844357976653697, correct 253/257 


Val Set, val_loss: 2.4371, auc: 0.7445 

class 0 clustering acc 0.9610558712121212: correct 8119/8448 

class 1 clustering acc 0.47490530303030304: correct 1003/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.78125, correct 75/96 

class 2: acc 0.7014925373134329, correct 94/134 

class 3: acc 0.26666666666666666, correct 8/30 

Overall Accuracy: 0.6705

Overall F1 Score: 0.4365

Training for coarse level...

batch 99, loss: 0.0001, instance_loss: 0.0946, weighted_loss: 0.0285, label: 1, bag_size: 333 

batch 199, loss: 0.0000, instance_loss: 0.2041, weighted_loss: 0.0612, label: 1, bag_size: 265 

batch 299, loss: 0.0012, instance_loss: 0.2741, weighted_loss: 0.0831, label: 2, bag_size: 422 

batch 399, loss: 0.0000, instance_loss: 0.4428, weighted_loss: 0.1328, label: 2, bag_size: 2046 

batch 499, loss: 0.0000, instance_loss: 0.2501, weighted_loss: 0.0751, label: 1, bag_size: 267 

batch 599, loss: 0.0013, instance_loss: 0.4039, weighted_loss: 0.1221, label: 0, bag_size: 901 

batch 699, loss: 0.0000, instance_loss: 0.7946, weighted_loss: 0.2384, label: 3, bag_size: 94 

batch 799, loss: 0.0047, instance_loss: 0.5679, weighted_loss: 0.1736, label: 1, bag_size: 927 

batch 899, loss: 0.0000, instance_loss: 0.0044, weighted_loss: 0.0013, label: 1, bag_size: 936 

batch 999, loss: 0.0031, instance_loss: 0.8931, weighted_loss: 0.2701, label: 3, bag_size: 328 

batch 1099, loss: 0.0124, instance_loss: 0.5249, weighted_loss: 0.1662, label: 2, bag_size: 405 

batch 1199, loss: 0.0000, instance_loss: 0.0334, weighted_loss: 0.0100, label: 1, bag_size: 1313 

batch 1299, loss: 0.0000, instance_loss: 0.1891, weighted_loss: 0.0567, label: 2, bag_size: 643 

batch 1399, loss: 0.0000, instance_loss: 0.7120, weighted_loss: 0.2136, label: 3, bag_size: 367 

batch 1499, loss: 0.0000, instance_loss: 0.6163, weighted_loss: 0.1849, label: 1, bag_size: 1667 

batch 1599, loss: 0.0608, instance_loss: 0.6554, weighted_loss: 0.2392, label: 3, bag_size: 2244 

batch 1699, loss: 0.0000, instance_loss: 0.1251, weighted_loss: 0.0375, label: 2, bag_size: 518 

batch 1799, loss: 0.0010, instance_loss: 0.3240, weighted_loss: 0.0979, label: 1, bag_size: 477 

batch 1899, loss: 0.0020, instance_loss: 0.1171, weighted_loss: 0.0366, label: 2, bag_size: 265 

batch 1999, loss: 0.0000, instance_loss: 0.1376, weighted_loss: 0.0413, label: 3, bag_size: 778 

batch 2099, loss: 0.0000, instance_loss: 0.2631, weighted_loss: 0.0789, label: 2, bag_size: 1897 

Instance Classifier Stats

class 0 clustering acc 0.9833237327188941: correct 68282/69440

class 1 clustering acc 0.6225806451612903: correct 10808/17360


Epoch: 41, train_loss: 0.0245, train_clustering_loss:  0.2760

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9948849104859335, correct 778/782 

class 2: acc 0.9917203311867525, correct 1078/1087 

class 3: acc 0.9766536964980544, correct 251/257 


Val Set, val_loss: 2.7552, auc: 0.7349 

class 0 clustering acc 0.9577414772727273: correct 8091/8448 

class 1 clustering acc 0.48863636363636365: correct 1032/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.59375, correct 57/96 

class 2: acc 0.8582089552238806, correct 115/134 

class 3: acc 0.16666666666666666, correct 5/30 

Overall Accuracy: 0.6705

Overall F1 Score: 0.4073

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.1515, weighted_loss: 0.0455, label: 2, bag_size: 1214 

batch 199, loss: 0.0104, instance_loss: 0.8372, weighted_loss: 0.2584, label: 1, bag_size: 738 

batch 299, loss: 0.0004, instance_loss: 0.7274, weighted_loss: 0.2185, label: 1, bag_size: 2139 

batch 399, loss: 0.0066, instance_loss: 0.3472, weighted_loss: 0.1088, label: 2, bag_size: 245 

batch 499, loss: 0.0000, instance_loss: 0.0157, weighted_loss: 0.0047, label: 2, bag_size: 505 

batch 599, loss: 0.0004, instance_loss: 0.2142, weighted_loss: 0.0646, label: 2, bag_size: 472 

batch 699, loss: 0.0000, instance_loss: 0.0667, weighted_loss: 0.0200, label: 1, bag_size: 476 

batch 799, loss: 0.0001, instance_loss: 1.0773, weighted_loss: 0.3233, label: 0, bag_size: 807 

batch 899, loss: 0.0000, instance_loss: 0.0451, weighted_loss: 0.0135, label: 2, bag_size: 969 

batch 999, loss: 0.0000, instance_loss: 0.7790, weighted_loss: 0.2337, label: 1, bag_size: 472 

batch 1099, loss: 0.0000, instance_loss: 0.1633, weighted_loss: 0.0490, label: 1, bag_size: 558 

batch 1199, loss: 0.0017, instance_loss: 0.4745, weighted_loss: 0.1436, label: 2, bag_size: 178 

batch 1299, loss: 0.0001, instance_loss: 0.5503, weighted_loss: 0.1652, label: 1, bag_size: 349 

batch 1399, loss: 0.0000, instance_loss: 0.0285, weighted_loss: 0.0086, label: 1, bag_size: 788 

batch 1499, loss: 0.0003, instance_loss: 0.1639, weighted_loss: 0.0494, label: 2, bag_size: 365 

batch 1599, loss: 0.0000, instance_loss: 0.3330, weighted_loss: 0.0999, label: 1, bag_size: 641 

batch 1699, loss: 0.0000, instance_loss: 0.0623, weighted_loss: 0.0187, label: 2, bag_size: 732 

batch 1799, loss: 0.0000, instance_loss: 0.2241, weighted_loss: 0.0672, label: 2, bag_size: 608 

batch 1899, loss: 0.0000, instance_loss: 0.0646, weighted_loss: 0.0194, label: 2, bag_size: 506 

batch 1999, loss: 0.0000, instance_loss: 0.1104, weighted_loss: 0.0331, label: 2, bag_size: 108 

batch 2099, loss: 0.0254, instance_loss: 0.7350, weighted_loss: 0.2383, label: 1, bag_size: 268 

Instance Classifier Stats

class 0 clustering acc 0.9825172811059908: correct 68226/69440

class 1 clustering acc 0.6123271889400922: correct 10630/17360


Epoch: 42, train_loss: 0.0503, train_clustering_loss:  0.2810

class 0: acc 0.9545454545454546, correct 42/44 

class 1: acc 0.9884910485933504, correct 773/782 

class 2: acc 0.9898804047838087, correct 1076/1087 

class 3: acc 0.9688715953307393, correct 249/257 


Val Set, val_loss: 2.4992, auc: 0.7286 

class 0 clustering acc 0.9673295454545454: correct 8172/8448 

class 1 clustering acc 0.43513257575757575: correct 919/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6875, correct 66/96 

class 2: acc 0.6940298507462687, correct 93/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6250

Overall F1 Score: 0.3926

Training for coarse level...

batch 99, loss: 0.0108, instance_loss: 0.3631, weighted_loss: 0.1165, label: 1, bag_size: 142 

batch 199, loss: 0.0000, instance_loss: 0.0738, weighted_loss: 0.0221, label: 2, bag_size: 765 

batch 299, loss: 0.0000, instance_loss: 0.1056, weighted_loss: 0.0317, label: 1, bag_size: 204 

batch 399, loss: 0.0000, instance_loss: 0.0452, weighted_loss: 0.0136, label: 2, bag_size: 289 

batch 499, loss: 0.0000, instance_loss: 0.0633, weighted_loss: 0.0190, label: 2, bag_size: 271 

batch 599, loss: 0.0001, instance_loss: 0.1087, weighted_loss: 0.0327, label: 1, bag_size: 687 

batch 699, loss: 0.0021, instance_loss: 0.0720, weighted_loss: 0.0230, label: 2, bag_size: 902 

batch 799, loss: 0.0000, instance_loss: 0.0211, weighted_loss: 0.0064, label: 2, bag_size: 448 

batch 899, loss: 0.0001, instance_loss: 0.3164, weighted_loss: 0.0950, label: 2, bag_size: 268 

batch 999, loss: 0.0000, instance_loss: 0.0119, weighted_loss: 0.0036, label: 2, bag_size: 543 

batch 1099, loss: 0.0000, instance_loss: 0.0175, weighted_loss: 0.0053, label: 1, bag_size: 298 

batch 1199, loss: 0.0000, instance_loss: 0.2444, weighted_loss: 0.0733, label: 2, bag_size: 866 

batch 1299, loss: 0.0000, instance_loss: 0.6796, weighted_loss: 0.2039, label: 0, bag_size: 260 

batch 1399, loss: 0.0063, instance_loss: 0.2964, weighted_loss: 0.0933, label: 2, bag_size: 1049 

batch 1499, loss: 0.0011, instance_loss: 0.0236, weighted_loss: 0.0078, label: 2, bag_size: 475 

batch 1599, loss: 0.0000, instance_loss: 0.1307, weighted_loss: 0.0392, label: 2, bag_size: 714 

batch 1699, loss: 0.0011, instance_loss: 0.5226, weighted_loss: 0.1575, label: 3, bag_size: 372 

batch 1799, loss: 0.0000, instance_loss: 0.1172, weighted_loss: 0.0351, label: 1, bag_size: 1632 

batch 1899, loss: 0.0000, instance_loss: 0.7247, weighted_loss: 0.2174, label: 3, bag_size: 175 

batch 1999, loss: 0.0004, instance_loss: 0.3994, weighted_loss: 0.1201, label: 3, bag_size: 1167 

batch 2099, loss: 0.0000, instance_loss: 0.1638, weighted_loss: 0.0491, label: 1, bag_size: 685 

Instance Classifier Stats

class 0 clustering acc 0.983366935483871: correct 68285/69440

class 1 clustering acc 0.6236175115207373: correct 10826/17360


Epoch: 43, train_loss: 0.0195, train_clustering_loss:  0.2754

class 0: acc 1.0, correct 44/44 

class 1: acc 0.9961636828644501, correct 779/782 

class 2: acc 0.9944802207911684, correct 1081/1087 

class 3: acc 0.9766536964980544, correct 251/257 


Val Set, val_loss: 2.6881, auc: 0.7234 

class 0 clustering acc 0.9612926136363636: correct 8121/8448 

class 1 clustering acc 0.4678030303030303: correct 988/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6354166666666666, correct 61/96 

class 2: acc 0.753731343283582, correct 101/134 

class 3: acc 0.2, correct 6/30 

Overall Accuracy: 0.6364

Overall F1 Score: 0.4001

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.1472, weighted_loss: 0.0442, label: 2, bag_size: 279 

batch 199, loss: 0.0000, instance_loss: 0.2675, weighted_loss: 0.0803, label: 2, bag_size: 658 

batch 299, loss: 0.0001, instance_loss: 0.5748, weighted_loss: 0.1725, label: 1, bag_size: 402 

batch 399, loss: 0.0000, instance_loss: 0.0620, weighted_loss: 0.0186, label: 1, bag_size: 428 

batch 499, loss: 0.0003, instance_loss: 0.0237, weighted_loss: 0.0073, label: 2, bag_size: 162 

batch 599, loss: 0.0000, instance_loss: 0.4247, weighted_loss: 0.1274, label: 1, bag_size: 440 

batch 699, loss: 0.0000, instance_loss: 0.1280, weighted_loss: 0.0384, label: 2, bag_size: 359 

batch 799, loss: 0.0000, instance_loss: 0.0358, weighted_loss: 0.0107, label: 2, bag_size: 505 

batch 899, loss: 0.0000, instance_loss: 0.0191, weighted_loss: 0.0057, label: 1, bag_size: 666 

batch 999, loss: 0.0001, instance_loss: 0.0676, weighted_loss: 0.0203, label: 1, bag_size: 1892 

batch 1099, loss: 0.0000, instance_loss: 0.0302, weighted_loss: 0.0091, label: 1, bag_size: 1404 

batch 1199, loss: 0.0000, instance_loss: 0.2690, weighted_loss: 0.0807, label: 2, bag_size: 427 

batch 1299, loss: 0.0000, instance_loss: 0.0724, weighted_loss: 0.0217, label: 2, bag_size: 368 

batch 1399, loss: 0.0000, instance_loss: 0.3414, weighted_loss: 0.1024, label: 2, bag_size: 216 

batch 1499, loss: 0.0000, instance_loss: 0.3196, weighted_loss: 0.0959, label: 1, bag_size: 567 

batch 1599, loss: 0.0002, instance_loss: 0.1373, weighted_loss: 0.0413, label: 2, bag_size: 834 

batch 1699, loss: 0.1267, instance_loss: 0.7077, weighted_loss: 0.3010, label: 1, bag_size: 175 

batch 1799, loss: 0.0000, instance_loss: 0.3023, weighted_loss: 0.0907, label: 3, bag_size: 245 

batch 1899, loss: 0.0024, instance_loss: 0.6574, weighted_loss: 0.1989, label: 1, bag_size: 295 

batch 1999, loss: 0.0000, instance_loss: 0.0281, weighted_loss: 0.0084, label: 1, bag_size: 1104 

batch 2099, loss: 0.0000, instance_loss: 0.1373, weighted_loss: 0.0412, label: 1, bag_size: 574 

Instance Classifier Stats

class 0 clustering acc 0.9834821428571429: correct 68293/69440

class 1 clustering acc 0.6246543778801843: correct 10844/17360


Epoch: 44, train_loss: 0.0245, train_clustering_loss:  0.2734

class 0: acc 1.0, correct 44/44 

class 1: acc 0.9936061381074168, correct 777/782 

class 2: acc 0.9963201471941122, correct 1083/1087 

class 3: acc 0.980544747081712, correct 252/257 


Val Set, val_loss: 2.4585, auc: 0.7346 

class 0 clustering acc 0.9577414772727273: correct 8091/8448 

class 1 clustering acc 0.4881628787878788: correct 1031/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6458333333333334, correct 62/96 

class 2: acc 0.7761194029850746, correct 104/134 

class 3: acc 0.13333333333333333, correct 4/30 

Overall Accuracy: 0.6439

Overall F1 Score: 0.3875

Training for coarse level...

batch 99, loss: 0.5323, instance_loss: 0.6302, weighted_loss: 0.5616, label: 1, bag_size: 37 

batch 199, loss: 0.0002, instance_loss: 0.0919, weighted_loss: 0.0277, label: 2, bag_size: 622 

batch 299, loss: 0.0000, instance_loss: 0.3321, weighted_loss: 0.0996, label: 2, bag_size: 714 

batch 399, loss: 0.0000, instance_loss: 0.0319, weighted_loss: 0.0096, label: 1, bag_size: 848 

batch 499, loss: 0.0019, instance_loss: 0.4068, weighted_loss: 0.1234, label: 2, bag_size: 599 

batch 599, loss: 0.0042, instance_loss: 0.3707, weighted_loss: 0.1141, label: 1, bag_size: 311 

batch 699, loss: 0.0000, instance_loss: 0.1537, weighted_loss: 0.0461, label: 3, bag_size: 388 

batch 799, loss: 0.0000, instance_loss: 0.7448, weighted_loss: 0.2235, label: 1, bag_size: 215 

batch 899, loss: 0.0000, instance_loss: 0.1126, weighted_loss: 0.0338, label: 0, bag_size: 119 

batch 999, loss: 0.0001, instance_loss: 0.0149, weighted_loss: 0.0045, label: 1, bag_size: 476 

batch 1099, loss: 0.0000, instance_loss: 0.0181, weighted_loss: 0.0054, label: 1, bag_size: 388 

batch 1199, loss: 0.0009, instance_loss: 0.1150, weighted_loss: 0.0351, label: 2, bag_size: 198 

batch 1299, loss: 0.0000, instance_loss: 0.1832, weighted_loss: 0.0550, label: 2, bag_size: 1549 

batch 1399, loss: 0.0000, instance_loss: 0.2685, weighted_loss: 0.0806, label: 2, bag_size: 112 

batch 1499, loss: 0.0000, instance_loss: 0.2115, weighted_loss: 0.0634, label: 2, bag_size: 297 

batch 1599, loss: 0.0000, instance_loss: 0.2612, weighted_loss: 0.0784, label: 2, bag_size: 294 

batch 1699, loss: 0.0000, instance_loss: 0.2104, weighted_loss: 0.0631, label: 2, bag_size: 444 

batch 1799, loss: 0.0000, instance_loss: 0.0184, weighted_loss: 0.0055, label: 1, bag_size: 1079 

batch 1899, loss: 0.0000, instance_loss: 0.0491, weighted_loss: 0.0148, label: 1, bag_size: 3332 

batch 1999, loss: 0.4428, instance_loss: 0.9856, weighted_loss: 0.6057, label: 1, bag_size: 359 

batch 2099, loss: 0.0010, instance_loss: 0.2139, weighted_loss: 0.0649, label: 2, bag_size: 266 

Instance Classifier Stats

class 0 clustering acc 0.9845478110599079: correct 68367/69440

class 1 clustering acc 0.6448156682027649: correct 11194/17360


Epoch: 45, train_loss: 0.0071, train_clustering_loss:  0.2604

class 0: acc 1.0, correct 44/44 

class 1: acc 0.9987212276214834, correct 781/782 

class 2: acc 0.9981600735970562, correct 1085/1087 

class 3: acc 0.9961089494163424, correct 256/257 


Val Set, val_loss: 2.4754, auc: 0.7133 

class 0 clustering acc 0.9534801136363636: correct 8055/8448 

class 1 clustering acc 0.48863636363636365: correct 1032/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6666666666666666, correct 64/96 

class 2: acc 0.7089552238805971, correct 95/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6288

Overall F1 Score: 0.3996

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.4829, weighted_loss: 0.1449, label: 3, bag_size: 347 

batch 199, loss: 0.0000, instance_loss: 0.6404, weighted_loss: 0.1921, label: 3, bag_size: 457 

batch 299, loss: 0.0000, instance_loss: 0.0164, weighted_loss: 0.0049, label: 2, bag_size: 1222 

batch 399, loss: 0.0000, instance_loss: 0.1873, weighted_loss: 0.0562, label: 2, bag_size: 414 

batch 499, loss: 0.0000, instance_loss: 0.0115, weighted_loss: 0.0035, label: 1, bag_size: 2219 

batch 599, loss: 0.0000, instance_loss: 0.1732, weighted_loss: 0.0520, label: 2, bag_size: 847 

batch 699, loss: 0.0000, instance_loss: 0.1322, weighted_loss: 0.0397, label: 2, bag_size: 422 

batch 799, loss: 0.0000, instance_loss: 0.3714, weighted_loss: 0.1114, label: 3, bag_size: 483 

batch 899, loss: 0.0000, instance_loss: 0.5847, weighted_loss: 0.1754, label: 1, bag_size: 333 

batch 999, loss: 0.0000, instance_loss: 0.0614, weighted_loss: 0.0184, label: 1, bag_size: 1706 

batch 1099, loss: 0.0001, instance_loss: 0.6679, weighted_loss: 0.2005, label: 3, bag_size: 276 

batch 1199, loss: 0.0000, instance_loss: 0.0551, weighted_loss: 0.0165, label: 2, bag_size: 1211 

batch 1299, loss: 0.0000, instance_loss: 0.2248, weighted_loss: 0.0675, label: 1, bag_size: 3773 

batch 1399, loss: 0.0001, instance_loss: 0.4043, weighted_loss: 0.1213, label: 3, bag_size: 208 

batch 1499, loss: 0.0010, instance_loss: 0.3721, weighted_loss: 0.1123, label: 1, bag_size: 328 

batch 1599, loss: 0.0000, instance_loss: 0.0136, weighted_loss: 0.0041, label: 2, bag_size: 250 

batch 1699, loss: 0.0000, instance_loss: 0.4530, weighted_loss: 0.1359, label: 2, bag_size: 527 

batch 1799, loss: 0.0000, instance_loss: 0.8117, weighted_loss: 0.2435, label: 3, bag_size: 565 

batch 1899, loss: 0.0000, instance_loss: 0.3336, weighted_loss: 0.1001, label: 3, bag_size: 486 

batch 1999, loss: 0.0010, instance_loss: 0.2163, weighted_loss: 0.0656, label: 2, bag_size: 472 

batch 2099, loss: 0.0000, instance_loss: 0.3036, weighted_loss: 0.0911, label: 1, bag_size: 354 

Instance Classifier Stats

class 0 clustering acc 0.9832085253456221: correct 68274/69440

class 1 clustering acc 0.6321428571428571: correct 10974/17360


Epoch: 46, train_loss: 0.0262, train_clustering_loss:  0.2748

class 0: acc 0.9545454545454546, correct 42/44 

class 1: acc 0.9936061381074168, correct 777/782 

class 2: acc 0.9935602575896965, correct 1080/1087 

class 3: acc 0.980544747081712, correct 252/257 


Val Set, val_loss: 2.6033, auc: 0.7170 

class 0 clustering acc 0.9595170454545454: correct 8106/8448 

class 1 clustering acc 0.4758522727272727: correct 1005/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6875, correct 66/96 

class 2: acc 0.7835820895522388, correct 105/134 

class 3: acc 0.13333333333333333, correct 4/30 

Overall Accuracy: 0.6629

Overall F1 Score: 0.4015

Training for coarse level...

batch 99, loss: 0.0000, instance_loss: 0.0673, weighted_loss: 0.0202, label: 2, bag_size: 753 

batch 199, loss: 0.0004, instance_loss: 0.3594, weighted_loss: 0.1081, label: 3, bag_size: 159 

batch 299, loss: 0.1290, instance_loss: 0.5932, weighted_loss: 0.2682, label: 1, bag_size: 224 

batch 399, loss: 0.0000, instance_loss: 0.1382, weighted_loss: 0.0415, label: 2, bag_size: 796 

batch 499, loss: 0.0000, instance_loss: 0.4434, weighted_loss: 0.1330, label: 1, bag_size: 1616 

batch 599, loss: 0.0001, instance_loss: 0.0494, weighted_loss: 0.0149, label: 1, bag_size: 1046 

batch 699, loss: 0.0000, instance_loss: 0.1439, weighted_loss: 0.0432, label: 2, bag_size: 622 

batch 799, loss: 0.0008, instance_loss: 0.5204, weighted_loss: 0.1566, label: 3, bag_size: 139 

batch 899, loss: 0.0000, instance_loss: 0.2480, weighted_loss: 0.0744, label: 2, bag_size: 409 

batch 999, loss: 0.0000, instance_loss: 0.1429, weighted_loss: 0.0429, label: 2, bag_size: 686 

batch 1099, loss: 0.0000, instance_loss: 0.0043, weighted_loss: 0.0013, label: 1, bag_size: 862 

batch 1199, loss: 0.0661, instance_loss: 0.8215, weighted_loss: 0.2928, label: 1, bag_size: 376 

batch 1299, loss: 0.0003, instance_loss: 0.2676, weighted_loss: 0.0805, label: 2, bag_size: 11 

batch 1399, loss: 0.0052, instance_loss: 0.8826, weighted_loss: 0.2684, label: 1, bag_size: 393 

batch 1499, loss: 0.0000, instance_loss: 0.4558, weighted_loss: 0.1368, label: 3, bag_size: 216 

batch 1599, loss: 0.0001, instance_loss: 0.4195, weighted_loss: 0.1259, label: 1, bag_size: 792 

batch 1699, loss: 0.0019, instance_loss: 0.1109, weighted_loss: 0.0346, label: 2, bag_size: 465 

batch 1799, loss: 0.0433, instance_loss: 0.3578, weighted_loss: 0.1376, label: 2, bag_size: 509 

batch 1899, loss: 0.0000, instance_loss: 0.0890, weighted_loss: 0.0267, label: 2, bag_size: 733 

batch 1999, loss: 0.0000, instance_loss: 0.2574, weighted_loss: 0.0772, label: 2, bag_size: 239 

batch 2099, loss: 0.0000, instance_loss: 0.4644, weighted_loss: 0.1393, label: 3, bag_size: 609 

Instance Classifier Stats

class 0 clustering acc 0.9837989631336406: correct 68315/69440

class 1 clustering acc 0.6382488479262672: correct 11080/17360


Epoch: 47, train_loss: 0.0188, train_clustering_loss:  0.2676

class 0: acc 0.9772727272727273, correct 43/44 

class 1: acc 0.9961636828644501, correct 779/782 

class 2: acc 0.9954001839926403, correct 1082/1087 

class 3: acc 0.9883268482490273, correct 254/257 


Val Set, val_loss: 2.6417, auc: 0.7007 

class 0 clustering acc 0.9567945075757576: correct 8083/8448 

class 1 clustering acc 0.4928977272727273: correct 1041/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.6041666666666666, correct 58/96 

class 2: acc 0.7388059701492538, correct 99/134 

class 3: acc 0.3333333333333333, correct 10/30 

Overall Accuracy: 0.6326

Overall F1 Score: 0.4213

Training for coarse level...

batch 99, loss: 0.0164, instance_loss: 0.3730, weighted_loss: 0.1233, label: 1, bag_size: 169 

batch 199, loss: 0.0509, instance_loss: 0.6695, weighted_loss: 0.2365, label: 1, bag_size: 2625 

batch 299, loss: 0.0000, instance_loss: 0.0720, weighted_loss: 0.0216, label: 1, bag_size: 123 

batch 399, loss: 0.0000, instance_loss: 0.0651, weighted_loss: 0.0195, label: 2, bag_size: 308 

batch 499, loss: 0.0017, instance_loss: 0.0820, weighted_loss: 0.0258, label: 2, bag_size: 239 

batch 599, loss: 0.0003, instance_loss: 0.5551, weighted_loss: 0.1667, label: 1, bag_size: 201 

batch 699, loss: 0.0001, instance_loss: 0.3306, weighted_loss: 0.0993, label: 0, bag_size: 419 

batch 799, loss: 0.0000, instance_loss: 0.1825, weighted_loss: 0.0547, label: 2, bag_size: 609 

batch 899, loss: 0.0001, instance_loss: 0.4542, weighted_loss: 0.1364, label: 3, bag_size: 501 

batch 999, loss: 0.0002, instance_loss: 0.4294, weighted_loss: 0.1289, label: 2, bag_size: 545 

batch 1099, loss: 0.0000, instance_loss: 0.4214, weighted_loss: 0.1264, label: 3, bag_size: 450 

batch 1199, loss: 0.0005, instance_loss: 0.3427, weighted_loss: 0.1031, label: 1, bag_size: 161 

batch 1299, loss: 0.0153, instance_loss: 0.5705, weighted_loss: 0.1819, label: 3, bag_size: 681 

batch 1399, loss: 0.0000, instance_loss: 0.0130, weighted_loss: 0.0039, label: 2, bag_size: 511 

batch 1499, loss: 0.0465, instance_loss: 0.6813, weighted_loss: 0.2370, label: 2, bag_size: 1364 

batch 1599, loss: 0.0000, instance_loss: 0.0843, weighted_loss: 0.0253, label: 2, bag_size: 592 

batch 1699, loss: 0.0658, instance_loss: 0.5672, weighted_loss: 0.2162, label: 2, bag_size: 746 

batch 1799, loss: 0.0011, instance_loss: 1.0120, weighted_loss: 0.3044, label: 3, bag_size: 1875 

batch 1899, loss: 0.0000, instance_loss: 0.1803, weighted_loss: 0.0541, label: 2, bag_size: 416 

batch 1999, loss: 0.0002, instance_loss: 0.4000, weighted_loss: 0.1201, label: 1, bag_size: 332 

batch 2099, loss: 0.0000, instance_loss: 0.3591, weighted_loss: 0.1077, label: 2, bag_size: 12 

Instance Classifier Stats

class 0 clustering acc 0.9826036866359447: correct 68232/69440

class 1 clustering acc 0.6420506912442396: correct 11146/17360


Epoch: 48, train_loss: 0.0264, train_clustering_loss:  0.2703

class 0: acc 1.0, correct 44/44 

class 1: acc 0.9910485933503836, correct 775/782 

class 2: acc 0.9935602575896965, correct 1080/1087 

class 3: acc 0.9727626459143969, correct 250/257 


Val Set, val_loss: 2.5189, auc: 0.7167 

class 0 clustering acc 0.9627130681818182: correct 8133/8448 

class 1 clustering acc 0.45454545454545453: correct 960/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.65625, correct 63/96 

class 2: acc 0.7238805970149254, correct 97/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6326

Overall F1 Score: 0.4018

Training for coarse level...

batch 99, loss: 0.3595, instance_loss: 0.6738, weighted_loss: 0.4538, label: 3, bag_size: 542 

batch 199, loss: 0.0000, instance_loss: 0.0549, weighted_loss: 0.0165, label: 1, bag_size: 793 

batch 299, loss: 0.0000, instance_loss: 0.1225, weighted_loss: 0.0368, label: 2, bag_size: 681 

batch 399, loss: 0.0004, instance_loss: 0.0966, weighted_loss: 0.0293, label: 1, bag_size: 1847 

batch 499, loss: 0.0015, instance_loss: 0.2503, weighted_loss: 0.0762, label: 2, bag_size: 333 

batch 599, loss: 0.0271, instance_loss: 0.4194, weighted_loss: 0.1447, label: 3, bag_size: 139 

batch 699, loss: 0.0000, instance_loss: 0.0173, weighted_loss: 0.0052, label: 2, bag_size: 451 

batch 799, loss: 0.0000, instance_loss: 0.6693, weighted_loss: 0.2008, label: 1, bag_size: 646 

batch 899, loss: 0.0000, instance_loss: 0.2674, weighted_loss: 0.0802, label: 2, bag_size: 630 

batch 999, loss: 0.0000, instance_loss: 0.0016, weighted_loss: 0.0005, label: 2, bag_size: 676 

batch 1099, loss: 0.0103, instance_loss: 0.3264, weighted_loss: 0.1051, label: 3, bag_size: 116 

batch 1199, loss: 0.0000, instance_loss: 0.1366, weighted_loss: 0.0410, label: 3, bag_size: 243 

batch 1299, loss: 0.0000, instance_loss: 0.0229, weighted_loss: 0.0069, label: 2, bag_size: 424 

batch 1399, loss: 0.0000, instance_loss: 0.3193, weighted_loss: 0.0958, label: 2, bag_size: 247 

batch 1499, loss: 0.0000, instance_loss: 0.1300, weighted_loss: 0.0390, label: 2, bag_size: 154 

batch 1599, loss: 0.0000, instance_loss: 0.1610, weighted_loss: 0.0483, label: 2, bag_size: 679 

batch 1699, loss: 0.0000, instance_loss: 0.0019, weighted_loss: 0.0006, label: 1, bag_size: 1967 

batch 1799, loss: 0.0000, instance_loss: 0.0804, weighted_loss: 0.0241, label: 2, bag_size: 336 

batch 1899, loss: 0.0000, instance_loss: 0.0400, weighted_loss: 0.0120, label: 2, bag_size: 542 

batch 1999, loss: 0.0000, instance_loss: 0.1020, weighted_loss: 0.0306, label: 2, bag_size: 596 

batch 2099, loss: 0.0000, instance_loss: 0.0214, weighted_loss: 0.0064, label: 1, bag_size: 778 

Instance Classifier Stats

class 0 clustering acc 0.9841157834101383: correct 68337/69440

class 1 clustering acc 0.6573732718894009: correct 11412/17360


Epoch: 49, train_loss: 0.0076, train_clustering_loss:  0.2523

class 0: acc 1.0, correct 44/44 

class 1: acc 1.0, correct 782/782 

class 2: acc 0.9981600735970562, correct 1085/1087 

class 3: acc 0.9961089494163424, correct 256/257 


Val Set, val_loss: 2.6447, auc: 0.7104 

class 0 clustering acc 0.9601089015151515: correct 8111/8448 

class 1 clustering acc 0.4853219696969697: correct 1025/2112 

class 0: acc 0.0, correct 0/4 

class 1: acc 0.71875, correct 69/96 

class 2: acc 0.7164179104477612, correct 96/134 

class 3: acc 0.23333333333333334, correct 7/30 

Overall Accuracy: 0.6515

Overall F1 Score: 0.4175


Process finished with exit code 0

